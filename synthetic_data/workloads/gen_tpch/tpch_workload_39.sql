SELECT r.r_name AS region_name, COUNT(DISTINCT c.c_custkey) AS number_of_customers, AVG(c.c_acctbal) AS average_account_balance, COUNT(DISTINCT p.p_partkey) AS number_of_parts, SUM(ps.ps_availqty) AS total_available_quantity, AVG(ps.ps_supplycost) AS average_supply_cost, SUM(ps.ps_supplycost * ps.ps_availqty) AS total_inventory_value FROM region r JOIN customer c ON r.r_regionkey = c.c_nationkey JOIN partsupp ps ON c.c_custkey = ps.ps_suppkey JOIN part p ON ps.ps_partkey = p.p_partkey WHERE r.r_regionkey IN (1, 4, 0, 2, 3) AND p.p_mfgr IN ('Manufacturer#5', 'Manufacturer#4', 'Manufacturer#2', 'Manufacturer#1', 'Manufacturer#3') AND c.c_nationkey = 0 AND c.c_comment IN ( 'ely: bravely regular accounts acr', 'y ironic pinto beans cajole deposits.', 'lyly silent platelets sleep epitaphs. f', 'lay boldly? blithely final deposits are', 'le quickly. quickly enticing excu' ) AND ps.ps_supplycost IN (184.83, 329.63, 916.51, 486.89) GROUP BY r.r_name ORDER BY total_inventory_value DESC;
SELECT n.n_name AS nation, c.c_mktsegment AS market_segment, COUNT(DISTINCT o.o_orderkey) AS total_orders, AVG(o.o_totalprice) AS average_order_amount, SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_spend, AVG(l.l_discount) AS average_discount FROM customer c JOIN orders o ON c.c_custkey = o.o_custkey JOIN lineitem l ON o.o_orderkey = l.l_orderkey JOIN nation n ON c.c_nationkey = n.n_nationkey WHERE o.o_orderdate >= date '1994-01-01' AND o.o_orderdate < date '1995-01-01' GROUP BY nation, market_segment ORDER BY total_spend DESC;
SELECT r.r_name AS region_name, COUNT(DISTINCT s.s_suppkey) AS supplier_count, COUNT(DISTINCT p.p_partkey) AS part_count, COUNT(DISTINCT o.o_orderkey) AS order_count, SUM(l.l_quantity) AS total_quantity, AVG(l.l_extendedprice) AS avg_price, SUM(l.l_extendedprice * (1 - l_discount)) AS revenue, AVG(l.l_discount) AS avg_discount FROM region r JOIN supplier s ON s.s_nationkey = r.r_regionkey JOIN lineitem l ON l.l_suppkey = s.s_suppkey JOIN orders o ON l.l_orderkey = o.o_orderkey JOIN part p ON l.l_partkey = p.p_partkey WHERE r.r_regionkey IN (1, 4, 0, 2, 3) AND p.p_size IN (47, 6, 29, 28) AND s.s_comment LIKE '%deas are slyly regular sheaves. ideas a%' AND l.l_returnflag IN ('N', 'A', 'R') AND o.o_orderdate BETWEEN '1994-01-01' AND '1995-01-01' GROUP BY r.r_name ORDER BY revenue DESC;
SELECT r.r_name AS region, n.n_name AS nation, COUNT(DISTINCT s.s_suppkey) AS number_of_suppliers, AVG(s.s_acctbal) AS average_account_balance, SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_sales_value, AVG(p.p_retailprice) AS average_part_retail_price, COUNT(DISTINCT o.o_orderkey) AS number_of_orders FROM region r JOIN nation n ON r.r_regionkey = n.n_regionkey JOIN supplier s ON n.n_nationkey = s.s_nationkey JOIN partsupp ps ON s.s_suppkey = ps.ps_suppkey JOIN part p ON ps.ps_partkey = p.p_partkey JOIN lineitem l ON ps.ps_partkey = l.l_partkey AND ps.ps_suppkey = l.l_suppkey JOIN orders o ON l.l_orderkey = o.o_orderkey WHERE o.o_orderdate BETWEEN date '1995-01-01' AND date '1995-12-31' AND l.l_shipdate > o.o_orderdate AND ps.ps_suppkey <> 60835 GROUP BY region, nation ORDER BY total_sales_value DESC, region, nation;
SELECT r.r_name AS region, COUNT(DISTINCT s.s_suppkey) AS number_of_suppliers, COUNT(DISTINCT c.c_custkey) AS number_of_customers, COUNT(DISTINCT p.p_partkey) AS number_of_parts, SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_revenue, AVG(l.l_quantity) AS average_quantity, AVG(l.l_extendedprice) AS average_extendedprice, AVG(l.l_discount) AS average_discount FROM region r JOIN supplier s ON r.r_regionkey = s.s_nationkey JOIN partsupp ps ON s.s_suppkey = ps.ps_suppkey JOIN part p ON ps.ps_partkey = p.p_partkey JOIN lineitem l ON p.p_partkey = l.l_partkey AND ps.ps_suppkey = l.l_suppkey JOIN orders o ON l.l_orderkey = o.o_orderkey JOIN customer c ON o.o_custkey = c.c_custkey AND s.s_nationkey = c.c_nationkey GROUP BY r.r_name ORDER BY total_revenue DESC;
