SELECT n.n_name, p.p_brand, p.p_type, p.p_size, AVG(p.p_retailprice) AS avg_retail_price, SUM(ps.ps_availqty) AS total_avail_qty, AVG(ps.ps_supplycost) AS avg_supply_cost, COUNT(DISTINCT ps.ps_suppkey) AS supplier_count FROM nation n JOIN partsupp ps ON n.n_nationkey = ps.ps_suppkey JOIN part p ON ps.ps_partkey = p.p_partkey WHERE p.p_brand IN ('Brand#24', 'Brand#45', 'Brand#12', 'Brand#33') GROUP BY n.n_name, p.p_brand, p.p_type, p.p_size ORDER BY avg_retail_price DESC, total_avail_qty DESC;
SELECT r_name AS region, n_name AS nation, c_mktsegment AS market_segment, COUNT(DISTINCT c_custkey) AS num_customers, SUM(o_totalprice) AS total_sales, AVG(l_quantity) AS average_quantity, AVG(l_extendedprice * (1 - l_discount)) AS average_discounted_price FROM customer JOIN orders ON c_custkey = o_custkey JOIN lineitem ON o_orderkey = l_orderkey JOIN nation ON c_nationkey = n_nationkey JOIN region ON n_regionkey = r_regionkey WHERE o_orderstatus = 'F' AND l_returnflag = 'R' AND o_shippriority = 0 AND o_orderdate BETWEEN '1994-01-01' AND '1994-12-31' GROUP BY region, nation, market_segment ORDER BY total_sales DESC, average_discounted_price DESC;
SELECT r.r_name AS region_name, c.c_mktsegment AS market_segment, AVG(c.c_acctbal) AS avg_account_balance, COUNT(c.c_custkey) AS customer_count, SUM(c.c_acctbal) AS total_account_balance FROM customer c JOIN nation n ON c.c_nationkey = n.n_nationkey JOIN region r ON n.n_regionkey = r.r_regionkey GROUP BY r.r_name, c.c_mktsegment ORDER BY region_name, market_segment;
SELECT r.r_name AS region_name, COUNT(c.c_custkey) AS total_customers, AVG(c.c_acctbal) AS average_account_balance, SUM(ps.ps_availqty) AS total_available_parts, AVG(ps.ps_supplycost) AS average_supply_cost FROM region r JOIN customer c ON c.c_nationkey = r.r_regionkey JOIN partsupp ps ON ps.ps_suppkey = c.c_custkey GROUP BY r.r_name ORDER BY total_customers DESC;
SELECT r.r_name AS region_name, AVG(ps.ps_supplycost) AS average_supply_cost, SUM(ps.ps_availqty) AS total_available_quantity, COUNT(DISTINCT n.n_nationkey) AS number_of_nations FROM region r LEFT JOIN nation n ON n.n_regionkey = r.r_regionkey LEFT JOIN partsupp ps ON ps.ps_suppkey = n.n_nationkey GROUP BY r.r_name ORDER BY average_supply_cost DESC;
SELECT r.r_name AS region_name, n.n_name AS nation_name, COUNT(DISTINCT s.s_suppkey) AS number_of_suppliers, COUNT(DISTINCT c.c_custkey) AS number_of_customers, SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_sales_value, AVG(l.l_quantity) AS average_quantity_sold, AVG(ps.ps_supplycost) AS average_supply_cost FROM region r JOIN nation n ON r.r_regionkey = n.n_regionkey JOIN supplier s ON n.n_nationkey = s.s_nationkey JOIN customer c ON n.n_nationkey = c.c_nationkey JOIN partsupp ps ON s.s_suppkey = ps.ps_suppkey JOIN lineitem l ON ps.ps_partkey = l.l_partkey AND ps.ps_suppkey = l.l_suppkey WHERE r.r_name IN ('MIDDLE EAST', 'ASIA', 'EUROPE', 'AMERICA', 'AFRICA') AND l.l_shipdate BETWEEN '1992-01-01' AND '1994-12-31' AND l.l_returnflag = 'N' GROUP BY region_name, nation_name ORDER BY total_sales_value DESC;
SELECT s.s_nationkey, COUNT(DISTINCT s.s_suppkey) AS total_suppliers, COUNT(DISTINCT c.c_custkey) AS total_customers, COUNT(DISTINCT p.p_partkey) AS total_parts, AVG(ps.ps_availqty) AS average_available_quantity, SUM(ps.ps_supplycost) AS total_supply_cost, AVG(ps.ps_supplycost) AS average_supply_cost FROM supplier s JOIN partsupp ps ON s.s_suppkey = ps.ps_suppkey JOIN part p ON ps.ps_partkey = p.p_partkey JOIN customer c ON s.s_nationkey = c.c_nationkey WHERE p.p_size = 27 AND p.p_name IN ('saddle moccasin navy tan lace', 'cornflower rose slate forest black', 'peru floral burnished goldenrod salmon', 'navajo linen mint sandy cream', 'floral black orange snow steel', 'medium blue azure tomato aquamarine') AND ps.ps_comment IN ('s are blithely around the final, quiet platelets.', 'c packages mold. carefully regular excuses along', 's cajole alongside of the express instructions. u', 'ly. ideas cajole ironic deposits. bold deposits a', 'old ideas. quickly final accounts nag above the q', 'longside of the slyly bold sheaves! packages wake') AND ps.ps_suppkey IN ('180562', '180707', '180598', '171', '120438') GROUP BY s.s_nationkey ORDER BY total_supply_cost DESC;
SELECT r.r_name AS region, n.n_name AS nation, c.c_name AS customer_name, c.c_mktsegment AS market_segment, COUNT(o.o_orderkey) AS number_of_orders, AVG(o.o_totalprice) AS average_order_value, SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_revenue, AVG(l.l_quantity) AS average_quantity_ordered FROM region r JOIN nation n ON r.r_regionkey = n.n_regionkey JOIN customer c ON n.n_nationkey = c.c_nationkey JOIN orders o ON c.c_custkey = o.o_custkey JOIN lineitem l ON o.o_orderkey = l.l_orderkey WHERE r.r_name IN ('AFRICA', 'EUROPE', 'AMERICA', 'MIDDLE EAST') AND c.c_mktsegment IN ('HOUSEHOLD', 'AUTOMOBILE', 'BUILDING', 'MACHINERY', 'FURNITURE') AND l.l_shipdate BETWEEN '1995-01-01' AND '1996-12-31' GROUP BY region, nation, customer_name, market_segment ORDER BY total_revenue DESC, average_order_value DESC LIMIT 100;
SELECT r_name AS region, n_name AS nation, COUNT(DISTINCT s_suppkey) AS total_suppliers, COUNT(DISTINCT c_custkey) AS total_customers, SUM(l_extendedprice * (1 - l_discount)) AS total_sales, AVG(l_quantity) AS average_quantity, AVG(s_acctbal) AS average_supplier_account_balance, AVG(c_acctbal) AS average_customer_account_balance FROM region JOIN nation ON n_regionkey = r_regionkey JOIN supplier ON s_nationkey = n_nationkey JOIN customer ON c_nationkey = n_nationkey JOIN orders ON o_custkey = c_custkey JOIN lineitem ON l_orderkey = o_orderkey WHERE r_name IN ('EUROPE', 'ASIA') AND o_orderdate BETWEEN date '2022-01-01' AND date '2022-12-31' AND l_shipdate > o_orderdate GROUP BY r_name, n_name ORDER BY total_sales DESC, region, nation;
SELECT r.r_name AS region_name, n.n_name AS nation_name, c.c_mktsegment AS market_segment, COUNT(DISTINCT o.o_orderkey) AS order_count, AVG(c.c_acctbal) AS avg_customer_acct_balance, SUM(o.o_totalprice) AS total_order_value FROM region r JOIN nation n ON r.r_regionkey = n.n_regionkey JOIN customer c ON n.n_nationkey = c.c_nationkey JOIN orders o ON c.c_custkey = o.o_custkey GROUP BY r.r_name, n.n_name, c.c_mktsegment ORDER BY r.r_name, n.n_name, c.c_mktsegment, total_order_value DESC;
SELECT r.r_name AS region_name, n.n_name AS nation_name, COUNT(DISTINCT s.s_suppkey) AS total_suppliers, COUNT(DISTINCT c.c_custkey) AS total_customers, ROUND(AVG(s.s_acctbal), 2) AS avg_supplier_acctbal, ROUND(AVG(c.c_acctbal), 2) AS avg_customer_acctbal, SUM(o.o_totalprice) AS total_order_value, COUNT(DISTINCT o.o_orderkey) AS total_orders FROM region r JOIN nation n ON r.r_regionkey = n.n_regionkey JOIN supplier s ON n.n_nationkey = s.s_nationkey JOIN customer c ON c.c_nationkey = n.n_nationkey JOIN orders o ON c.c_custkey = o.o_custkey WHERE r.r_name IN ('AMERICA', 'EUROPE') AND o.o_orderpriority IN ('1-URGENT', '3-MEDIUM') AND c.c_address IN ('jyIxl9h6Y7wvYTY', 'G20AFhZXIqAi0Cpvw', 'P2tTIy0dj4Xy2YeXlzC,NZlNG0jpFMB7cp', 'svYKhcj9Y992alo') GROUP BY region_name, nation_name ORDER BY total_order_value DESC, total_orders DESC;
SELECT r_name AS region, n_name AS nation, COUNT(DISTINCT ps_partkey) AS num_parts, SUM(ps_availqty) AS total_available_quantity, AVG(ps_supplycost) AS average_supply_cost, SUM(ps_supplycost * ps_availqty) AS total_value FROM partsupp JOIN nation ON partsupp.ps_suppkey = nation.n_nationkey JOIN region ON nation.n_regionkey = region.r_regionkey GROUP BY region, nation ORDER BY total_value DESC;
SELECT n_name AS nation, AVG(c_acctbal) AS avg_customer_balance, SUM(s_acctbal) AS total_supplier_balance, COUNT(DISTINCT o_orderkey) AS total_orders, SUM(l_extendedprice * (1 - l_discount)) AS revenue, AVG(p_retailprice) AS avg_part_retail_price FROM nation JOIN supplier ON n_nationkey = s_nationkey JOIN customer ON n_nationkey = c_nationkey JOIN orders ON o_custkey = c_custkey JOIN lineitem ON l_orderkey = o_orderkey JOIN part ON l_partkey = p_partkey JOIN partsupp ON ps_partkey = l_partkey AND ps_suppkey = l_suppkey WHERE n_regionkey IN (1, 4, 0, 2, 3) AND n_nationkey IN (18, 7, 17, 13) AND s_acctbal > 0 AND p_brand IN ('Brand#24', 'Brand#44') AND ps_suppkey IN (60452, 180565, 120646, 376, 920, 61065) AND ps_availqty > 4500 AND l_shipdate BETWEEN '1994-01-01' AND '1995-01-01' GROUP BY nation ORDER BY revenue DESC, avg_customer_balance DESC;
SELECT s_name, c_mktsegment, p_brand, p_type, SUM(ps_availqty) AS total_available_quantity, AVG(ps_supplycost) AS average_supply_cost, COUNT(DISTINCT l_orderkey) AS total_orders, SUM(l_extendedprice * (1 - l_discount)) AS total_revenue, MAX(o_totalprice) AS max_order_total_price FROM supplier JOIN partsupp ON s_suppkey = ps_suppkey JOIN part ON ps_partkey = p_partkey JOIN lineitem ON l_partkey = p_partkey AND l_suppkey = s_suppkey JOIN orders ON l_orderkey = o_orderkey JOIN customer ON o_custkey = c_custkey AND s_nationkey = c_nationkey WHERE l_shipmode = 'RAIL' AND c_nationkey IN (21, 0, 17, 23, 14) AND (o_comment LIKE '%unusual%' OR o_comment LIKE '%final%') GROUP BY s_name, c_mktsegment, p_brand, p_type ORDER BY total_revenue DESC, total_available_quantity DESC LIMIT 10;
SELECT p.p_brand, r.r_name AS region_name, SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_sales, AVG(l.l_discount) AS average_discount, COUNT(*) AS total_items_sold FROM part p JOIN lineitem l ON p.p_partkey = l.l_partkey JOIN region r ON r.r_regionkey = p.p_partkey % 5 WHERE l.l_shipdate > date '1992-01-01' AND l.l_quantity > 30 GROUP BY p.p_brand, r.r_name ORDER BY total_sales DESC, region_name, p.p_brand;
SELECT c.c_name, p.p_brand, COUNT(DISTINCT o.o_orderkey) AS total_orders, SUM(l.l_quantity) AS total_quantity, AVG(l.l_extendedprice * (1 - l.l_discount)) AS avg_discounted_price, SUM(CASE WHEN l.l_returnflag = 'R' THEN l.l_quantity ELSE 0 END) AS returned_quantity FROM customer c JOIN orders o ON c.c_custkey = o.o_custkey JOIN lineitem l ON o.o_orderkey = l.l_orderkey JOIN part p ON l.l_partkey = p.p_partkey WHERE c.c_nationkey IN (3, 9, 15, 8, 6, 17) AND o.o_orderdate BETWEEN '1994-01-01' AND '1996-12-31' AND p.p_brand = 'Brand#31' GROUP BY c.c_name, p.p_brand ORDER BY avg_discounted_price DESC, total_orders DESC, c.c_name LIMIT 10;
SELECT r.r_name AS region, c.c_mktsegment AS market_segment, COUNT(DISTINCT c.c_custkey) AS number_of_customers, AVG(c.c_acctbal) AS average_customer_account_balance, SUM(o.o_totalprice) AS total_sales FROM customer c JOIN orders o ON c.c_custkey = o.o_custkey JOIN nation n ON c.c_nationkey = n.n_nationkey JOIN region r ON n.n_regionkey = r.r_regionkey GROUP BY r.r_name, c.c_mktsegment ORDER BY total_sales DESC, average_customer_account_balance DESC;
SELECT r_name AS region, n_name AS nation, c_mktsegment AS market_segment, COUNT(DISTINCT c_custkey) AS number_of_customers, AVG(c_acctbal) AS avg_account_balance, SUM(l_extendedprice * (1 - l_discount)) AS total_sales FROM customer JOIN nation ON c_nationkey = n_nationkey JOIN region ON n_regionkey = r_regionkey JOIN lineitem ON c_custkey = l_orderkey WHERE r_comment LIKE '%final%' AND n_comment LIKE '%final, express gifts cajole a%' AND c_acctbal > 0 AND l_shipdate BETWEEN '1995-01-01' AND '1995-12-31' GROUP BY region, nation, market_segment ORDER BY total_sales DESC, avg_account_balance DESC;
SELECT r.r_name AS region, c.c_mktsegment AS market_segment, COUNT(DISTINCT c.c_custkey) AS number_of_customers, SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_revenue, AVG(l.l_quantity) AS average_quantity_sold, AVG(ps.ps_supplycost) AS average_supply_cost, MAX(c.c_acctbal) AS max_customer_balance FROM region r JOIN customer c ON r.r_regionkey = c.c_nationkey JOIN lineitem l ON c.c_custkey = l.l_orderkey JOIN partsupp ps ON l.l_partkey = ps.ps_partkey AND l.l_suppkey = ps.ps_suppkey WHERE l.l_receiptdate BETWEEN '1993-01-01' AND '1998-12-31' GROUP BY r.r_name, c.c_mktsegment ORDER BY total_revenue DESC, average_quantity_sold DESC;
SELECT r.r_name AS region_name, n.n_name AS nation_name, COUNT(DISTINCT s.s_suppkey) AS number_of_suppliers, COUNT(DISTINCT c.c_custkey) AS number_of_customers, SUM(l.l_extendedprice) AS total_sales_value, AVG(l.l_quantity) AS average_quantity_sold, SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_revenue_after_discount, AVG(l.l_discount) AS average_discount_given FROM region r JOIN nation n ON r.r_regionkey = n.n_regionkey JOIN supplier s ON n.n_nationkey = s.s_nationkey JOIN customer c ON n.n_nationkey = c.c_nationkey JOIN orders o ON c.c_custkey = o.o_custkey JOIN lineitem l ON o.o_orderkey = l.l_orderkey WHERE r.r_regionkey = 2 AND n.n_comment LIKE '%ven packages wake quickly. regu%' AND ( s.s_comment LIKE '%t the closely ironic packages. fluff%' OR s.s_comment LIKE '%accounts after the furious%' OR s.s_comment LIKE '%ecial deposits cajole slyly even ideas. furious%' OR s.s_comment LIKE '%ns. ironic ideas cajole. sl%' OR s.s_comment LIKE '%nto beans. stealthily final%' ) GROUP BY r.r_name, n.n_name ORDER BY total_sales_value DESC;
SELECT r.r_name AS region_name, COUNT(DISTINCT o.o_orderkey) AS number_of_orders, SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_sales, AVG(l.l_extendedprice * (1 - l.l_discount)) AS avg_sales FROM region r JOIN nation n ON r.r_regionkey = n.n_regionkey JOIN supplier s ON n.n_nationkey = s.s_nationkey JOIN partsupp ps ON s.s_suppkey = ps.ps_suppkey JOIN part p ON ps.ps_partkey = p.p_partkey AND p.p_brand = 'Brand#32' JOIN lineitem l ON p.p_partkey = l.l_partkey AND ps.ps_suppkey = l.l_suppkey JOIN orders o ON l.l_orderkey = o.o_orderkey WHERE o.o_orderdate >= '2020-01-01' AND o.o_orderdate <= '2020-12-31' AND l.l_shipinstruct = 'DELIVER IN PERSON' GROUP BY r.r_name ORDER BY total_sales DESC;
