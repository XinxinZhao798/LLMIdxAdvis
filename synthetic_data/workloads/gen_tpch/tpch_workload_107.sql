SELECT r_name AS region, c_mktsegment AS market_segment, COUNT(DISTINCT o_orderkey) AS num_orders, SUM(l_quantity) AS total_quantity, AVG(l_extendedprice) AS avg_price, SUM(l_extendedprice * (1 - l_discount)) AS revenue FROM region JOIN supplier ON s_nationkey = r_regionkey JOIN partsupp ON ps_suppkey = s_suppkey JOIN lineitem ON l_suppkey = s_suppkey AND l_partkey = ps_partkey JOIN orders ON o_orderkey = l_orderkey JOIN customer ON c_custkey = o_custkey AND c_nationkey = s_nationkey WHERE c_acctbal > 8117.27 AND c_nationkey IN (20, 0) GROUP BY r_name, c_mktsegment ORDER BY revenue DESC, avg_price DESC;
SELECT r.r_name AS region_name, COUNT(DISTINCT s.s_suppkey) AS number_of_suppliers, COUNT(DISTINCT c.c_custkey) AS number_of_customers, AVG(s.s_acctbal) AS avg_supplier_acctbal, AVG(c.c_acctbal) AS avg_customer_acctbal, SUM(o.o_totalprice) AS total_sales, COUNT(o.o_orderkey) AS number_of_orders, AVG(o.o_totalprice) AS avg_order_value, MAX(o.o_totalprice) AS max_order_value, MIN(o.o_totalprice) AS min_order_value FROM region r JOIN supplier s ON s.s_nationkey = r.r_regionkey JOIN customer c ON c.c_nationkey = r.r_regionkey JOIN orders o ON o.o_custkey = c.c_custkey WHERE r.r_regionkey IN (1, 4, 0, 2, 3) AND o.o_orderdate BETWEEN '2020-01-01' AND '2020-12-31' AND o.o_orderstatus = 'F' GROUP BY r.r_name ORDER BY total_sales DESC;
SELECT c.c_mktsegment, EXTRACT(YEAR FROM o.o_orderdate) AS order_year, COUNT(DISTINCT o.o_orderkey) AS total_orders, SUM(l.l_quantity) AS total_quantity, AVG(l.l_extendedprice * (1 - l.l_discount)) AS avg_discounted_price, SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_revenue, AVG(ps.ps_supplycost) AS avg_supply_cost FROM customer c JOIN orders o ON c.c_custkey = o.o_custkey JOIN lineitem l ON o.o_orderkey = l.l_orderkey JOIN partsupp ps ON l.l_partkey = ps.ps_partkey AND l.l_suppkey = ps.ps_suppkey WHERE o.o_orderdate BETWEEN '1994-01-01' AND '1997-12-31' AND o.o_clerk IN ('Clerk#000013110', 'Clerk#000019634', 'Clerk#000022938', 'Clerk#000000992') GROUP BY c.c_mktsegment, order_year ORDER BY c.c_mktsegment, order_year;
SELECT r.r_name AS region, n.n_name AS nation, COUNT(DISTINCT s.s_suppkey) AS total_suppliers, COUNT(DISTINCT c.c_custkey) AS total_customers, COUNT(DISTINCT p.p_partkey) AS total_parts, SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_revenue, AVG(l.l_quantity) AS average_quantity, AVG(l.l_extendedprice) AS average_extended_price, AVG(ps.ps_supplycost) AS average_supply_cost FROM region r JOIN nation n ON n.n_regionkey = r.r_regionkey JOIN supplier s ON s.s_nationkey = n.n_nationkey JOIN customer c ON c.c_nationkey = n.n_nationkey JOIN orders o ON o.o_custkey = c.c_custkey JOIN lineitem l ON l.l_orderkey = o.o_orderkey JOIN partsupp ps ON ps.ps_suppkey = l.l_suppkey AND ps.ps_partkey = l.l_partkey JOIN part p ON p.p_partkey = l.l_partkey WHERE l.l_shipmode IN ('RAIL', 'SHIP') AND p.p_type IN ('STANDARD ANODIZED NICKEL', 'SMALL ANODIZED COPPER', 'SMALL BRUSHED COPPER', 'STANDARD PLATED TIN') AND l.l_shipdate BETWEEN '1993-01-01' AND '1993-12-31' GROUP BY r.r_name, n.n_name ORDER BY total_revenue DESC, total_suppliers DESC;
SELECT r.r_name AS region_name, COUNT(DISTINCT s.s_suppkey) AS number_of_suppliers, AVG(s.s_acctbal) AS average_account_balance, SUM(ps.ps_availqty) AS total_available_quantity, AVG(ps.ps_supplycost) AS average_supply_cost, COUNT(DISTINCT o.o_orderkey) AS number_of_orders, SUM(o.o_totalprice) AS total_order_value, AVG(o.o_totalprice) AS average_order_value FROM region r JOIN supplier s ON r.r_regionkey = s.s_nationkey JOIN partsupp ps ON s.s_suppkey = ps.ps_suppkey LEFT JOIN orders o ON s.s_nationkey = o.o_custkey GROUP BY r.r_name ORDER BY r.r_name;
