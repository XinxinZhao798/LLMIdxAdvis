SELECT r.r_name AS region_name, c.c_mktsegment AS market_segment, COUNT(DISTINCT o.o_orderkey) AS number_of_orders, SUM(l.l_extendedprice) AS total_sales, AVG(l.l_quantity) AS average_quantity, AVG(l.l_extendedprice * (1 - l.l_discount)) AS average_discounted_price FROM region r JOIN customer c ON c.c_nationkey = r.r_regionkey JOIN orders o ON o.o_custkey = c.c_custkey JOIN lineitem l ON l.l_orderkey = o.o_orderkey GROUP BY r.r_name, c.c_mktsegment ORDER BY total_sales DESC, r.r_name, c.c_mktsegment;
SELECT r.r_name AS region, p.p_brand AS brand, p.p_type AS type, COUNT(DISTINCT l.l_orderkey) AS total_orders, SUM(l.l_quantity) AS total_quantity, AVG(l.l_extendedprice) AS avg_price, SUM(l.l_extendedprice * (1 - l_discount)) AS discounted_total_price, SUM(CASE WHEN l.l_returnflag = 'R' THEN l.l_quantity ELSE 0 END) AS returned_quantity, AVG(l.l_discount) AS avg_discount FROM region r JOIN lineitem l ON r.r_regionkey = l.l_suppkey JOIN part p ON l.l_partkey = p.p_partkey WHERE p.p_mfgr IN ('Manufacturer#1', 'Manufacturer#4') AND p.p_brand IN ('Brand#25', 'Brand#34', 'Brand#43', 'Brand#13') AND l.l_shipmode IN ('AIR', 'RAIL', 'FOB') AND l.l_shipdate BETWEEN '1997-01-01' AND '1997-12-31' GROUP BY region, brand, type ORDER BY total_orders DESC, total_quantity DESC, avg_price;
SELECT r.r_name AS region_name, COUNT(DISTINCT s.s_suppkey) AS number_of_suppliers, AVG(s.s_acctbal) AS avg_supplier_acct_balance, AVG(p.p_size) AS avg_part_size FROM supplier s JOIN nation n ON s.s_nationkey = n.n_nationkey JOIN region r ON n.n_regionkey = r.r_regionkey JOIN lineitem li ON s.s_suppkey = li.l_suppkey JOIN part p ON li.l_partkey = p.p_partkey WHERE li.l_shipmode IN ('AIR', 'REG AIR') GROUP BY r.r_name ORDER BY avg_supplier_acct_balance DESC, number_of_suppliers DESC;
SELECT r.r_name, p.p_type, COUNT(DISTINCT l.l_orderkey) AS number_of_orders, SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_revenue, AVG(l.l_quantity) AS average_quantity, AVG(l.l_extendedprice) AS average_price, AVG(l.l_discount) AS average_discount FROM region r JOIN partsupp ps ON ps.ps_suppkey = r.r_regionkey JOIN part p ON ps.ps_partkey = p.p_partkey JOIN lineitem l ON l.l_partkey = p.p_partkey AND l.l_suppkey = ps.ps_suppkey WHERE r.r_regionkey IN (0, 3, 4) AND l.l_shipdate BETWEEN '1995-01-01' AND '1995-12-31' GROUP BY r.r_name, p.p_type ORDER BY total_revenue DESC, r.r_name, p.p_type;
SELECT r.r_name AS region_name, COUNT(DISTINCT s.s_suppkey) AS supplier_count, COUNT(DISTINCT c.c_custkey) AS customer_count, SUM(l.l_extendedprice) AS total_sales, AVG(l.l_discount) AS average_discount, SUM(ps.ps_availqty) AS total_available_parts FROM region r JOIN supplier s ON r.r_regionkey = s.s_nationkey JOIN partsupp ps ON s.s_suppkey = ps.ps_suppkey JOIN lineitem l ON ps.ps_suppkey = l.l_suppkey AND ps.ps_partkey = l.l_partkey JOIN orders o ON l.l_orderkey = o.o_orderkey JOIN customer c ON o.o_custkey = c.c_custkey WHERE l.l_shipdate BETWEEN '1994-01-01' AND '1994-12-31' AND l.l_linestatus = 'F' GROUP BY r.r_name ORDER BY total_sales DESC;
SELECT r.r_name AS region, n.n_name AS nation, COUNT(DISTINCT c.c_custkey) AS number_of_customers, SUM(o.o_totalprice) AS total_sales, AVG(ps.ps_supplycost) AS average_supply_cost, SUM(l.l_quantity) AS total_quantity_sold, AVG(l.l_extendedprice * (1 - l_discount)) AS average_discounted_price FROM region r JOIN nation n ON r.r_regionkey = n.n_regionkey JOIN supplier s ON s.s_nationkey = n.n_nationkey JOIN partsupp ps ON ps.ps_suppkey = s.s_suppkey JOIN part p ON ps.ps_partkey = p.p_partkey JOIN lineitem l ON p.p_partkey = l.l_partkey AND ps.ps_suppkey = l.l_suppkey JOIN orders o ON l.l_orderkey = o.o_orderkey JOIN customer c ON o.o_custkey = c.c_custkey WHERE p.p_container IN ('JUMBO CAN', 'SM BOX', 'SM PACK', 'MED BAG', 'JUMBO PACK', 'JUMBO CASE') AND o.o_orderdate BETWEEN '1995-01-01' AND '1995-12-31' AND r.r_name IN ('MIDDLE EAST', 'ASIA', 'EUROPE', 'AMERICA', 'AFRICA') GROUP BY r.r_name, n.n_name ORDER BY total_sales DESC;
SELECT r.r_name AS region_name, n.n_name AS nation_name, COUNT(DISTINCT o.o_orderkey) AS number_of_orders, AVG(c.c_acctbal) AS average_customer_account_balance, SUM(o.o_totalprice) AS total_sales_value FROM region r JOIN nation n ON r.r_regionkey = n.n_regionkey JOIN customer c ON n.n_nationkey = c.c_nationkey JOIN orders o ON c.c_custkey = o.o_custkey WHERE o.o_totalprice > ( SELECT AVG(o2.o_totalprice) FROM orders o2 ) GROUP BY r.r_name, n.n_name ORDER BY r.r_name, total_sales_value DESC;
