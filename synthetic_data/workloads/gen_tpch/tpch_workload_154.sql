SELECT r.r_name AS region, COUNT(DISTINCT c.c_custkey) AS number_of_customers, AVG(c.c_acctbal) AS average_account_balance, SUM(o.o_totalprice) AS total_order_value, COUNT(DISTINCT o.o_orderkey) AS number_of_orders, SUM(l.l_quantity) AS total_parts_ordered, AVG(l.l_extendedprice * (1 - l_discount)) AS average_discounted_price FROM region r JOIN customer c ON c.c_nationkey = r.r_regionkey JOIN orders o ON o.o_custkey = c.c_custkey JOIN lineitem l ON l.l_orderkey = o.o_orderkey WHERE c.c_acctbal > 0 AND o.o_totalprice > 100000 AND l.l_shipdate BETWEEN '1995-01-01' AND '1995-12-31' GROUP BY region ORDER BY total_order_value DESC, average_account_balance DESC;
SELECT r_name AS region, n_name AS nation, count(DISTINCT s_suppkey) AS num_suppliers, count(DISTINCT c_custkey) AS num_customers, sum(l_extendedprice) AS total_sales, avg(l_extendedprice * (1 - l_discount)) AS avg_discounted_sales, count(DISTINCT o_orderkey) AS num_orders FROM region JOIN nation ON n_regionkey = r_regionkey JOIN supplier ON s_nationkey = n_nationkey JOIN customer ON c_nationkey = n_nationkey JOIN orders ON o_custkey = c_custkey JOIN lineitem ON l_orderkey = o_orderkey AND l_suppkey = s_suppkey GROUP BY region, nation ORDER BY total_sales DESC, region, nation;
SELECT r.r_name AS region_name, COUNT(DISTINCT o.o_orderkey) AS total_orders, SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_sales, AVG(l.l_discount) AS average_discount FROM region r JOIN nation n ON r.r_regionkey = n.n_regionkey JOIN orders o ON o.o_custkey = n.n_nationkey JOIN lineitem l ON o.o_orderkey = l.l_orderkey JOIN part p ON l.l_partkey = p.p_partkey WHERE p.p_retailprice > 1300.00 AND EXTRACT(YEAR FROM o.o_orderdate) = 2023 GROUP BY r.r_name ORDER BY total_sales DESC;
SELECT s_name, s_address, p_type, AVG(l_quantity) AS average_quantity, SUM(l_extendedprice) AS total_sales, COUNT(DISTINCT l_orderkey) AS number_of_orders, SUM(CASE WHEN l_discount > 0 THEN l_extendedprice * (1 - l_discount) ELSE 0 END) AS discounted_sales FROM supplier JOIN lineitem ON supplier.s_suppkey = lineitem.l_suppkey JOIN part ON lineitem.l_partkey = part.p_partkey WHERE s_acctbal > 5000 AND p_mfgr = 'Manufacturer#5' AND l_shipdate BETWEEN '2022-01-01' AND '2022-12-31' GROUP BY s_name, s_address, p_type ORDER BY total_sales DESC, s_name LIMIT 10;
SELECT r_name AS region, n_name AS nation, COUNT(DISTINCT l_orderkey) AS total_orders, SUM(l_quantity) AS total_quantity, AVG(l_extendedprice) AS avg_price, SUM(l_extendedprice * (1 - l_discount)) AS total_discounted_price, SUM(CASE WHEN l_tax = '0.00' THEN l_extendedprice * (1 - l_discount) END) AS total_tax_free_sales, SUM(CASE WHEN l_tax > '0.00' THEN l_extendedprice * (1 - l_discount) END) AS total_taxed_sales, COUNT(CASE WHEN l_returnflag = 'R' THEN 1 END) AS returns_count FROM region JOIN nation ON n_regionkey = r_regionkey JOIN lineitem ON l_suppkey = n_nationkey WHERE n_name IN ('ROMANIA', 'UNITED KINGDOM', 'UNITED STATES', 'ALGERIA') AND (l_shipdate BETWEEN '1995-01-01' AND '1996-12-31' OR l_receiptdate BETWEEN '1995-01-01' AND '1996-12-31') GROUP BY r_name, n_name ORDER BY total_orders DESC, total_quantity DESC;
SELECT s.s_nationkey, COUNT(DISTINCT s.s_suppkey) AS total_suppliers, COUNT(DISTINCT c.c_custkey) AS total_customers, COUNT(DISTINCT p.p_partkey) AS total_parts, AVG(ps.ps_availqty) AS average_available_quantity, SUM(ps.ps_supplycost) AS total_supply_cost, AVG(ps.ps_supplycost) AS average_supply_cost FROM supplier s JOIN partsupp ps ON s.s_suppkey = ps.ps_suppkey JOIN part p ON ps.ps_partkey = p.p_partkey JOIN customer c ON s.s_nationkey = c.c_nationkey WHERE p.p_size = 27 AND p.p_name IN ('saddle moccasin navy tan lace', 'cornflower rose slate forest black', 'peru floral burnished goldenrod salmon', 'navajo linen mint sandy cream', 'floral black orange snow steel', 'medium blue azure tomato aquamarine') AND ps.ps_comment IN ('s are blithely around the final, quiet platelets.', 'c packages mold. carefully regular excuses along', 's cajole alongside of the express instructions. u', 'ly. ideas cajole ironic deposits. bold deposits a', 'old ideas. quickly final accounts nag above the q', 'longside of the slyly bold sheaves! packages wake') AND ps.ps_suppkey IN ('180562', '180707', '180598', '171', '120438') GROUP BY s.s_nationkey ORDER BY total_supply_cost DESC;
SELECT r.r_name as Region, n.n_name as Nation, COUNT(p.p_partkey) as TotalParts, AVG(p.p_retailprice) as AvgRetailPrice, SUM(o.o_totalprice) as TotalOrderPrice, COUNT(DISTINCT o.o_orderkey) as TotalOrders, MAX(o.o_totalprice) as MaxOrderPrice, MIN(o.o_totalprice) as MinOrderPrice FROM region r JOIN nation n ON r.r_regionkey = n.n_regionkey JOIN orders o ON o.o_orderdate BETWEEN '2020-01-01' AND '2020-12-31' JOIN part p ON p.p_size BETWEEN 30 AND 50 GROUP BY r.r_name, n.n_name ORDER BY TotalOrderPrice DESC, AvgRetailPrice DESC;
SELECT r_name AS region_name, n_name AS nation_name, COUNT(DISTINCT c_custkey) AS number_of_customers, COUNT(DISTINCT s_suppkey) AS number_of_suppliers, SUM(l_extendedprice) AS total_sales, AVG(l_extendedprice * (1 - l_discount)) AS avg_discounted_sales, SUM(l_quantity) AS total_quantity_sold FROM region JOIN nation ON n_regionkey = r_regionkey JOIN supplier ON s_nationkey = n_nationkey JOIN customer ON c_nationkey = n_nationkey JOIN lineitem ON s_suppkey = l_suppkey WHERE l_shipdate BETWEEN '2023-01-01' AND '2023-12-31' GROUP BY r_name, n_name ORDER BY total_sales DESC, region_name, nation_name;
SELECT n.n_name AS nation, COUNT(DISTINCT o.o_orderkey) AS num_of_orders, COUNT(DISTINCT l.l_orderkey) AS num_of_lineitems, SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_revenue, AVG(l.l_quantity) AS avg_quantity, AVG(l.l_extendedprice) AS avg_price, AVG(l.l_discount) AS avg_discount, MAX(l.l_extendedprice) AS max_price, MIN(l.l_extendedprice) AS min_price FROM nation n JOIN supplier s ON n.n_nationkey = s.s_nationkey JOIN customer c ON n.n_nationkey = c.c_nationkey JOIN orders o ON c.c_custkey = o.o_custkey JOIN lineitem l ON o.o_orderkey = l.l_orderkey WHERE n.n_name IN ('ETHIOPIA', 'ROMANIA') AND o.o_clerk IN ('Clerk#000008851', 'Clerk#000013378', 'Clerk#000001659', 'Clerk#000003983') GROUP BY n.n_name ORDER BY total_revenue DESC;
SELECT r.r_name AS region_name, EXTRACT(YEAR FROM o.o_orderdate) AS order_year, COUNT(distinct o.o_orderkey) AS total_orders, AVG(o.o_totalprice) AS average_order_price, SUM(p.p_size) AS total_parts_size, AVG(p.p_retailprice) AS average_part_price FROM region r JOIN orders o ON r.r_regionkey = o.o_orderkey % 5 JOIN part p ON o.o_orderkey = p.p_partkey % 5 WHERE r.r_name LIKE 'E%' AND o.o_orderstatus = 'F' AND p.p_name IN ( 'coral magenta orange powder cyan', 'navy blanched cornflower medium drab', 'tomato misty almond cornflower papaya', 'firebrick tomato midnight violet thistle', 'medium aquamarine drab dark azure' ) GROUP BY region_name, order_year ORDER BY total_orders DESC, average_order_price DESC;
SELECT r.r_name AS region_name, n.n_name AS nation_name, EXTRACT(YEAR FROM o.o_orderdate) AS order_year, AVG(o.o_totalprice) AS avg_sales, COUNT(DISTINCT o.o_orderkey) AS total_orders, SUM(c.c_acctbal) AS total_customer_balance FROM region r JOIN nation n ON r.r_regionkey = n.n_regionkey JOIN customer c ON n.n_nationkey = c.c_nationkey JOIN orders o ON c.c_custkey = o.o_custkey GROUP BY region_name, nation_name, order_year ORDER BY region_name, nation_name, order_year;
SELECT r.r_name AS region_name, EXTRACT(YEAR FROM o.o_orderdate) AS order_year, COUNT(DISTINCT c.c_custkey) AS number_of_customers, SUM(l.l_quantity) AS total_quantity_sold, AVG(l.l_extendedprice) AS average_price, SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_revenue_after_discount, AVG((l.l_extendedprice * (1 - l.l_discount)) / l.l_quantity) AS average_price_per_unit FROM region r JOIN customer c ON c.c_nationkey = r.r_regionkey JOIN orders o ON o.o_custkey = c.c_custkey JOIN lineitem l ON l.l_orderkey = o.o_orderkey WHERE r.r_name IN ('AMERICA', 'EUROPE') AND o.o_orderdate BETWEEN '1995-01-01' AND '1996-12-31' AND c.c_mktsegment = 'AUTOMOBILE' GROUP BY region_name, order_year ORDER BY region_name, order_year;
SELECT r.r_name AS region_name, COUNT(DISTINCT o.o_orderkey) AS number_of_orders, SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_sales, AVG(l.l_extendedprice * (1 - l.l_discount)) AS avg_sales FROM region r JOIN nation n ON r.r_regionkey = n.n_regionkey JOIN supplier s ON n.n_nationkey = s.s_nationkey JOIN partsupp ps ON s.s_suppkey = ps.ps_suppkey JOIN part p ON ps.ps_partkey = p.p_partkey AND p.p_brand = 'Brand#32' JOIN lineitem l ON p.p_partkey = l.l_partkey AND ps.ps_suppkey = l.l_suppkey JOIN orders o ON l.l_orderkey = o.o_orderkey WHERE o.o_orderdate >= '2020-01-01' AND o.o_orderdate <= '2020-12-31' AND l.l_shipinstruct = 'DELIVER IN PERSON' GROUP BY r.r_name ORDER BY total_sales DESC;
SELECT c.c_mktsegment, r.r_name AS region, SUM(l.l_extendedprice * (1 - l.l_discount)) AS revenue, AVG(l.l_quantity) AS avg_quantity, AVG(l.l_extendedprice) AS avg_price, AVG(l.l_discount) AS avg_discount, COUNT(DISTINCT c.c_custkey) AS num_customers, COUNT(DISTINCT o.o_orderkey) AS num_orders FROM customer c JOIN orders o ON c.c_custkey = o.o_custkey JOIN lineitem l ON o.o_orderkey = l.l_orderkey JOIN supplier s ON l.l_suppkey = s.s_suppkey JOIN region r ON s.s_nationkey = c.c_nationkey GROUP BY c.c_mktsegment, region ORDER BY revenue DESC;
SELECT r.r_name AS region_name, COUNT(DISTINCT n.n_nationkey) AS total_nations, SUM(ps.ps_availqty) AS total_available_quantity, AVG(ps.ps_supplycost) AS average_supply_cost, MIN(ps.ps_supplycost) AS minimum_supply_cost, MAX(ps.ps_supplycost) AS maximum_supply_cost FROM region r JOIN nation n ON r.r_regionkey = n.n_regionkey JOIN partsupp ps ON ps.ps_suppkey = n.n_nationkey GROUP BY r.r_name ORDER BY total_available_quantity DESC;
SELECT r.r_name AS region, n.n_name AS nation, c.c_mktsegment AS market_segment, COUNT(DISTINCT o.o_orderkey) AS total_orders, SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_revenue, AVG(l.l_quantity) AS average_quantity, AVG(c.c_acctbal) AS average_account_balance FROM region r JOIN nation n ON r.r_regionkey = n.n_regionkey JOIN customer c ON n.n_nationkey = c.c_nationkey JOIN orders o ON c.c_custkey = o.o_custkey JOIN lineitem l ON o.o_orderkey = l.l_orderkey WHERE r.r_name IN ('EUROPE', 'ASIA', 'MIDDLE EAST') AND o.o_orderdate >= date '1995-01-01' AND o.o_orderdate < date '1996-01-01' AND c.c_acctbal > 0 AND l.l_shipdate <= o.o_orderdate + interval '90 days' GROUP BY r.r_name, n.n_name, c.c_mktsegment ORDER BY total_revenue DESC, average_account_balance DESC LIMIT 10;
SELECT c.c_mktsegment, o.o_orderpriority, SUM(l.l_extendedprice * (1 - l.l_discount)) AS revenue, AVG(l.l_quantity) AS average_quantity, AVG(l.l_extendedprice) AS average_extendedprice, AVG(l.l_discount) AS average_discount, COUNT(*) AS count_orders FROM customer c JOIN orders o ON c.c_custkey = o.o_custkey JOIN lineitem l ON o.o_orderkey = l.l_orderkey WHERE c.c_acctbal > 4000.00 AND o.o_orderdate >= DATE '2023-01-01' AND o.o_orderdate < DATE '2023-01-01' + INTERVAL '3 months' AND l.l_returnflag = 'N' GROUP BY c.c_mktsegment, o.o_orderpriority ORDER BY revenue DESC, c.c_mktsegment, o.o_orderpriority;
