SELECT cn.name AS character_name, COUNT(DISTINCT cl.movie_id) AS total_linked_movies, COUNT(ci.person_id) AS total_roles_played, AVG(ci.nr_order) AS average_role_order FROM char_name AS cn JOIN cast_info AS ci ON cn.id = ci.person_id JOIN movie_link AS cl ON ci.movie_id = cl.movie_id WHERE cn.name IN ('Boy Negro''s Gang', 'Lazoglu', 'Paco Hernández Gil', 'Tedddy Hart', 'Funcionario prisión', 'Make Up Man') GROUP BY cn.name ORDER BY total_linked_movies DESC, total_roles_played DESC;
SELECT AVG(mc.company_id) AS average_company_id, COUNT(DISTINCT ml.movie_id) AS linked_movies_count, SUM(CASE WHEN mi.info = 'Tatar' THEN 1 ELSE 0 END) AS tatar_movies_count, SUM(CASE WHEN mi.info = 'Hebrew' THEN 1 ELSE 0 END) AS hebrew_movies_count, SUM(CASE WHEN mi.info = 'Inuktitut' THEN 1 ELSE 0 END) AS inuktitut_movies_count, COUNT(DISTINCT an.person_id) AS unique_actors_count FROM movie_companies AS mc JOIN movie_link AS ml ON mc.movie_id = ml.movie_id JOIN movie_info AS mi ON mc.movie_id = mi.movie_id LEFT JOIN aka_name AS an ON an.surname_pcode = mi.info WHERE an.name_pcode_cf IN ('V3415', 'A5163', 'B6525') AND mi.info IN ('Tatar', 'Hebrew', 'Inuktitut') GROUP BY mc.company_type_id;
SELECT COUNT(DISTINCT mk.movie_id) AS number_of_movies_with_keywords, AVG(sub.avg_keywords_per_movie) AS average_keywords_per_movie, SUM(sub.keyword_count) AS total_keywords, COUNT(DISTINCT pi.person_id) AS number_of_people_with_info FROM movie_keyword AS mk JOIN keyword AS k ON mk.keyword_id = k.id JOIN (SELECT mk.movie_id, COUNT(mk.keyword_id) AS keyword_count, AVG(COUNT(mk.keyword_id)) OVER () AS avg_keywords_per_movie FROM movie_keyword AS mk GROUP BY mk.movie_id) AS sub ON mk.movie_id = sub.movie_id LEFT JOIN person_info AS pi ON pi.info = k.keyword WHERE k.phonetic_code IN ('G2532', 'R232');
SELECT AVG(ak.production_year) AS average_production_year, COUNT(DISTINCT ci.movie_id) AS number_of_movies_casted, COUNT(DISTINCT cn.id) AS number_of_companies, SUM(CASE WHEN mi.info = 'Color' THEN 1 ELSE 0 END) AS color_movie_count, COUNT(DISTINCT ml.linked_movie_id) AS number_of_linked_movies FROM aka_title AS ak JOIN cast_info AS ci ON ak.movie_id = ci.movie_id JOIN company_name AS cn ON cn.md5sum IN ('6596ca830de5c8b7ec94b67c784e1a83', '0ad6c9035d400a497468ec039779ec3a', '6bca80dc1d9813e39427976f934f43bf', '37fac2d56e57bccc911e51e0e7830631', 'f8ebe23c1526539a4a78e7d7a3d8511e') JOIN movie_info_idx AS mi ON ak.movie_id = mi.movie_id AND mi.id = 2825 JOIN movie_link AS ml ON ak.movie_id = ml.movie_id AND ml.link_type_id = 15 WHERE ak.note IN ('(USA) (alternative spelling)', '(Finland: Swedish title) (alternative title)') GROUP BY ak.kind_id;
SELECT ct.kind AS company_type, AVG(CAST(mi.info AS NUMERIC)) AS average_rating, COUNT(DISTINCT mk.movie_id) AS movie_count, COUNT(k.id) AS keyword_count, SUM(CASE WHEN it.info = 'LD official retail price' THEN CAST(mi.info AS NUMERIC) ELSE 0 END) AS total_official_retail_price FROM company_type ct JOIN movie_info mi ON ct.id = mi.info_type_id JOIN movie_keyword mk ON mi.movie_id = mk.movie_id JOIN keyword k ON mk.keyword_id = k.id JOIN info_type it ON mi.info_type_id = it.id WHERE mk.keyword_id IN (2506, 2862, 589, 3476, 4237) AND k.phonetic_code IN ('D1653', 'H532', 'M6321', 'H4326', 'F2426', 'A3513') AND it.id IN (15, 16, 18, 76, 39, 111) AND mi.movie_id IN (9091, 13237, 927238) AND (mi.note ILIKE '%(English subtitles)%' OR mi.note ILIKE '%(Original version)%') GROUP BY ct.kind;
SELECT kt.kind AS movie_kind, COUNT(DISTINCT ci.movie_id) AS num_movies, COUNT(DISTINCT ci.person_id) AS num_people_involved, AVG(ci.nr_order) AS avg_cast_order, SUM(case when mi_idx.info_type_id = '100' THEN 1 ELSE 0 END) AS count_type_100, SUM(case when mi_idx.info_type_id = '101' THEN 1 ELSE 0 END) AS count_type_101, SUM(case when mi_idx.info_type_id = '99' THEN 1 ELSE 0 END) AS count_type_99 FROM cast_info ci JOIN kind_type kt ON ci.role_id = kt.id JOIN movie_info_idx mi_idx ON ci.movie_id = mi_idx.movie_id WHERE mi_idx.info_type_id IN ('100', '101', '99') AND ci.person_role_id = (SELECT id FROM info_type WHERE id = '94') GROUP BY kt.kind;
SELECT rt.ROLE, COUNT(DISTINCT ci.person_id) AS number_of_people, COUNT(DISTINCT ci.movie_id) AS number_of_movies, AVG(ci.nr_order) AS average_order, MIN(t.production_year) AS earliest_production_year, MAX(t.production_year) AS latest_production_year, SUM(CASE WHEN ml.link_type_id = 1 THEN 1 ELSE 0 END) AS total_prequels_linked, SUM(CASE WHEN ml.link_type_id = 4 THEN 1 ELSE 0 END) AS total_sequels_linked, cn.name AS company_name, COUNT(DISTINCT cn.country_code) AS number_of_country_codes FROM role_type rt LEFT JOIN cast_info ci ON rt.id = ci.role_id LEFT JOIN title t ON ci.movie_id = t.id LEFT JOIN movie_link ml ON t.id = ml.movie_id LEFT JOIN company_name cn ON t.id = cn.imdb_id WHERE rt.id IN (1, 4) AND ci.nr_order <= 20 AND cn.name IN ('RQB Group', 'HKK Film Company', 'Digital Media Production House', 'Film i Jönköpings län') GROUP BY rt.ROLE, cn.name ORDER BY rt.ROLE, cn.name;
SELECT cn.country_code, kt.kind AS title_kind, t.production_year AS year_of_production, COUNT(DISTINCT t.id) AS total_titles, SUM(CASE WHEN n.gender = 'M' THEN 1 ELSE 0 END) AS male_names_count, SUM(CASE WHEN n.gender = 'F' THEN 1 ELSE 0 END) AS female_names_count FROM title t INNER JOIN kind_type kt ON t.kind_id = kt.id LEFT JOIN company_name cn ON t.id = cn.imdb_id LEFT JOIN name n ON t.id = n.imdb_id WHERE t.production_year IS NOT NULL AND (n.gender = 'M' OR n.gender = 'F') GROUP BY cn.country_code, kt.kind, t.production_year ORDER BY cn.country_code, total_titles DESC, t.production_year DESC;
SELECT AVG(mc.movie_id) AS average_movie_id, COUNT(DISTINCT cn.id) AS number_of_companies, SUM(CASE WHEN mi.info_type_id = 4 THEN 1 ELSE 0 END) AS info_type_count, cct.kind AS cast_type_kind, COUNT(DISTINCT k.id) AS unique_keywords_used, MAX(cn.name) AS largest_company_name FROM movie_companies AS mc JOIN company_name AS cn ON mc.company_id = cn.id JOIN company_type AS ct ON mc.company_type_id = ct.id JOIN comp_cast_type AS cct ON mc.company_type_id = cct.id JOIN movie_info AS mi ON mc.movie_id = mi.movie_id JOIN keyword AS k ON mi.info = k.keyword WHERE cn.country_code = '[py]' AND (mi.info = 'Urdu' OR mi.info = 'Turkish' OR mi.info = 'Vietnamese' OR mi.info = 'Estonian') AND (cct.kind = 'complete+verified' OR cct.kind = 'cast' OR cct.kind = 'crew' OR cct.kind = 'complete') AND (k.id IN (2454, 1707, 7050, 8101)) GROUP BY cct.kind;
SELECT lt.LINK AS link_type, COUNT(DISTINCT ml.movie_id) AS num_movies, COUNT(DISTINCT ml.linked_movie_id) AS num_linked_movies, AVG(kw.keyword_count) AS avg_keywords_per_movie, SUM(case when ct.kind LIKE '%Ltd%' THEN 1 ELSE 0 END) AS num_ltd_companies, SUM(case when ct.kind LIKE '%Inc%' THEN 1 ELSE 0 END) AS num_inc_companies FROM movie_link AS ml INNER JOIN link_type AS lt ON ml.link_type_id = lt.id LEFT JOIN ( SELECT movie_id, COUNT(keyword_id) AS keyword_count FROM movie_keyword GROUP BY movie_id ) AS kw ON ml.movie_id = kw.movie_id LEFT JOIN ( SELECT mc.movie_id, ct.kind FROM movie_companies AS mc INNER JOIN company_type AS ct ON mc.company_type_id = ct.id ) AS ct ON ml.movie_id = ct.movie_id GROUP BY lt.LINK ORDER BY num_movies DESC, avg_keywords_per_movie DESC;
SELECT cct.kind, COUNT(DISTINCT mi_idx.movie_id) AS number_of_movies, AVG(CAST(mi_idx.info AS INTEGER)) AS average_votes, COUNT(DISTINCT pi.person_id) AS number_of_people, SUM(CASE WHEN pi.info LIKE '%1971%' THEN 1 ELSE 0 END) AS count_people_born_1971, SUM(CASE WHEN pi.info LIKE '%O-chan%' THEN 1 ELSE 0 END) AS count_people_with_Ochan_info FROM comp_cast_type cct JOIN movie_info_idx mi_idx ON cct.id = mi_idx.info_type_id JOIN person_info pi ON pi.info_type_id = mi_idx.info_type_id WHERE cct.kind = 'crew' GROUP BY cct.kind;
SELECT k.keyword, COUNT(DISTINCT t.id) AS number_of_movies, AVG(t.production_year) AS average_production_year, COUNT(DISTINCT n.id) AS number_of_persons, SUM(CASE WHEN n.gender = 'm' THEN 1 ELSE 0 END) AS male_count, SUM(CASE WHEN n.gender = 'f' THEN 1 ELSE 0 END) AS female_count, COUNT(DISTINCT at.title) AS number_of_alternate_titles FROM keyword AS k JOIN movie_keyword AS mk ON k.id = mk.keyword_id JOIN title AS t ON mk.movie_id = t.id LEFT JOIN aka_title AS at ON t.id = at.movie_id LEFT JOIN aka_name AS an ON t.id = an.person_id LEFT JOIN name AS n ON an.person_id = n.id WHERE k.phonetic_code IN ('F4235', 'I626') AND t.production_year > 2000 GROUP BY k.keyword ORDER BY number_of_movies DESC;
SELECT it.info AS info_category, COUNT(DISTINCT mi.movie_id) AS total_movies, AVG(CASE WHEN n.gender = 'm' THEN 1.0 ELSE NULL END) AS avg_male_involvement, AVG(CASE WHEN n.gender = 'f' THEN 1.0 ELSE NULL END) AS avg_female_involvement, COUNT(DISTINCT an.person_id) AS unique_aka_names, SUM(CASE WHEN mi.info_type_id = 4 THEN 1 ELSE 0 END) AS count_info_type_4 FROM movie_info mi INNER JOIN info_type it ON mi.info_type_id = it.id LEFT JOIN aka_name an ON an.person_id = mi.movie_id LEFT JOIN name n ON n.id = mi.movie_id WHERE mi.info LIKE '%Mandarin%' OR mi.info_type_id IN ('47', '5', '7') OR n.surname_pcode IN ('A432', 'A416', 'A414') OR n.imdb_index IN ('VI', 'XVII', 'XIV', 'I') GROUP BY it.info;
SELECT n.name AS actor_name, COUNT(DISTINCT ci.movie_id) AS movies_participated, AVG(mi_idx_nr_order.avg_nr_order) AS average_cast_order, SUM(CASE WHEN mi_info.info LIKE '%budget%' THEN 1 ELSE 0 END) AS budget_movies_count, MAX(CASE WHEN mi_info.info_type_id = (SELECT id FROM movie_info_idx WHERE info = 'release dates') THEN mi_info.info ELSE NULL END) AS latest_release_date FROM name n JOIN cast_info ci ON ci.person_id = n.id LEFT JOIN (SELECT movie_id, AVG(nr_order) AS avg_nr_order FROM cast_info GROUP BY movie_id) mi_idx_nr_order ON mi_idx_nr_order.movie_id = ci.movie_id LEFT JOIN movie_info mi_info ON mi_info.movie_id = ci.movie_id WHERE n.gender = 'm' AND n.surname_pcode IN ('A416', 'A43', 'A413', 'A462') GROUP BY n.name ORDER BY movies_participated DESC, average_cast_order;
SELECT ml.movie_id, COUNT(DISTINCT ml.linked_movie_id) AS number_of_linked_movies, AVG(COUNT(ml.linked_movie_id)) OVER () AS average_links_per_movie, COUNT(DISTINCT mk.keyword_id) AS total_distinct_keywords FROM movie_link AS ml INNER JOIN movie_info AS mi ON ml.movie_id = mi.movie_id INNER JOIN movie_keyword AS mk ON ml.movie_id = mk.movie_id GROUP BY ml.movie_id ORDER BY number_of_linked_movies DESC, total_distinct_keywords DESC;
SELECT cct.kind AS cast_type, AVG(t.production_year) AS average_production_year, COUNT(DISTINCT k.id) AS unique_keywords_count, SUM(CASE WHEN t.kind_id = cct.id AND cct.kind = 'complete+verified' THEN 1 ELSE 0 END) AS total_complete_verified_titles, COUNT(*) AS total_titles FROM title t LEFT JOIN comp_cast_type cct ON t.kind_id = cct.id LEFT JOIN keyword k ON k.phonetic_code = t.phonetic_code GROUP BY cct.kind ORDER BY total_complete_verified_titles DESC;
SELECT AVG(cast_info.nr_order) AS average_cast_order, COUNT(DISTINCT name.id) AS total_actors, COUNT(DISTINCT movie_keyword.movie_id) AS total_movies_with_keywords, SUM(CASE WHEN comp_cast_type.kind = 'complete+verified' THEN 1 ELSE 0 END) AS total_verified_casts, COUNT(DISTINCT movie_link.movie_id) AS total_movie_links, MAX(aka_title.production_year) AS latest_production_year FROM cast_info JOIN name ON cast_info.person_id = name.id JOIN movie_keyword ON cast_info.movie_id = movie_keyword.movie_id JOIN comp_cast_type ON cast_info.role_id = comp_cast_type.id JOIN aka_title ON cast_info.movie_id = aka_title.movie_id JOIN movie_link ON cast_info.movie_id = movie_link.movie_id WHERE comp_cast_type.kind IN ('complete+verified', 'cast', 'crew', 'complete') AND movie_keyword.keyword_id IN (3208, 869, 3853, 1657) AND aka_title.production_year BETWEEN 1990 AND 2020 GROUP BY aka_title.kind_id ORDER BY total_movies_with_keywords DESC, latest_production_year DESC;
SELECT COUNT(DISTINCT mi.movie_id) AS number_of_movies, AVG(CAST(mi.info AS DECIMAL)) AS average_info_rating, SUM(CASE WHEN mi.info_type_id = 101 THEN CAST(mi.info AS BIGINT) ELSE 0 END) AS total_info_type_101, MAX(t.production_year) AS latest_production_year, MIN(t.production_year) AS earliest_production_year, COUNT(DISTINCT mk.keyword_id) AS distinct_keywords, COUNT(DISTINCT t.id) FILTER (WHERE t.production_year BETWEEN 2000 AND 2010) AS movies_between_2000_and_2010 FROM movie_info_idx mi JOIN title t ON mi.movie_id = t.id LEFT JOIN movie_keyword mk ON t.id = mk.movie_id WHERE mi.info SIMILAR TO '%(4.4|0100111101|36|6000000001|1.0..10113)%' AND mi.movie_id IN (19624, 8384) GROUP BY t.kind_id ORDER BY total_info_type_101 DESC;
