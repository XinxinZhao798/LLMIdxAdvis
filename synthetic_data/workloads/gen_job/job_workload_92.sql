SELECT kt.kind AS movie_kind, AVG(at.production_year) AS average_production_year, COUNT(DISTINCT at.movie_id) AS total_movies, COUNT(DISTINCT mk.keyword_id) AS distinct_keywords FROM aka_title at INNER JOIN kind_type kt ON at.kind_id = kt.id LEFT JOIN movie_keyword mk ON at.movie_id = mk.movie_id GROUP BY kt.kind ORDER BY total_movies DESC, average_production_year DESC;
SELECT rt.ROLE, COUNT(DISTINCT ci.person_id) AS total_persons, COUNT(DISTINCT ci.movie_id) AS total_movies, AVG(ci.nr_order) AS average_order, COUNT(DISTINCT mc.company_id) AS total_companies, COUNT(DISTINCT ml.linked_movie_id) AS total_linked_movies FROM cast_info AS ci JOIN role_type AS rt ON ci.role_id = rt.id JOIN movie_companies AS mc ON ci.movie_id = mc.movie_id JOIN movie_link AS ml ON ci.movie_id = ml.movie_id WHERE rt.ROLE IN ('cinematographer', 'actress', 'costume designer') AND ml.link_type_id IN (10, 8, 11, 13, 7, 6) AND (mc.note LIKE '%(1993) (UK) (all media)%' OR mc.note LIKE '%(1952-1960) (UK) (TV)%') GROUP BY rt.ROLE ORDER BY total_persons DESC;
SELECT kt.kind, COUNT(DISTINCT t.id) AS total_movies, AVG(t.production_year) AS average_production_year, SUM(CASE WHEN ci.role_id = 1 THEN 1 ELSE 0 END) AS total_actors, SUM(CASE WHEN ci.role_id = 2 THEN 1 ELSE 0 END) AS total_directors, COUNT(DISTINCT mc.company_id) AS total_companies_involved, COUNT(DISTINCT k.id) AS total_unique_keywords FROM title t JOIN kind_type kt ON t.kind_id = kt.id LEFT JOIN cast_info ci ON t.id = ci.movie_id LEFT JOIN movie_companies mc ON t.id = mc.movie_id LEFT JOIN keyword k ON t.id = k.id WHERE t.production_year > 2000 AND kt.id = 5 AND ci.note LIKE '%(20%' AND ci.role_id IN (1, 2) GROUP BY kt.kind ORDER BY total_movies DESC;
SELECT cn.name AS company_name, COUNT(DISTINCT mk.movie_id) AS number_of_movies_with_keywords, COUNT(DISTINCT ml.movie_id) AS number_of_linked_movies, COUNT(DISTINCT ml.linked_movie_id) AS number_of_movies_linked_to, AVG(cn.imdb_id) AS average_imdb_id FROM company_name cn LEFT JOIN movie_companies mc ON cn.id = mc.company_id LEFT JOIN movie_keyword mk ON mc.movie_id = mk.movie_id LEFT JOIN movie_link ml ON mc.movie_id = ml.movie_id OR mc.movie_id = ml.linked_movie_id WHERE cn.country_code NOT IN ('[pl]') AND cn.name_pcode_sf IN ('V6251', 'D1253', 'A4562', 'D5351', 'T5626') AND (ml.link_type_id IN (5, 3, 13) OR ml.link_type_id IS NULL) GROUP BY cn.name ORDER BY number_of_movies_with_keywords DESC, number_of_linked_movies DESC, number_of_movies_linked_to DESC, average_imdb_id DESC LIMIT 10;
SELECT rt.ROLE, COUNT(DISTINCT mi.movie_id) AS number_of_movies, AVG(CAST(mi_idx.info AS DOUBLE PRECISION)) AS average_rating, SUM(CASE WHEN mi.note IN ('(some dialogue)', '(only a few lines)', '(Original Version)', '(a few words)', '(a few lines)', '(English version)') THEN 1 ELSE 0 END) AS dialogue_mentions_count FROM movie_info_idx AS mi_idx JOIN movie_info AS mi ON mi_idx.movie_id = mi.movie_id JOIN person_info AS pi ON mi.movie_id = pi.info_type_id JOIN role_type AS rt ON pi.info_type_id = rt.id WHERE mi_idx.info_type_id = 3 AND mi.info_type_id IN (24, 36) AND rt.id IN ('8', '10', '3') AND rt.role IN ('costume designer', 'miscellaneous crew', 'writer', 'composer') GROUP BY rt.ROLE ORDER BY average_rating DESC, number_of_movies DESC;
SELECT ct.kind AS cast_type, AVG(mc.company_id) AS average_company_id, SUM(CASE WHEN mi.info_type_id = 1 THEN 1 ELSE 0 END) AS count_genre_info, COUNT(DISTINCT k.id) AS unique_keyword_count, MAX(mi.movie_id) AS max_movie_id FROM comp_cast_type ct JOIN complete_cast cc ON ct.id = cc.subject_id JOIN movie_companies mc ON cc.movie_id = mc.movie_id JOIN movie_info mi ON mc.movie_id = mi.movie_id JOIN keyword k ON k.id = ANY(ARRAY[6997, 6526]) WHERE mc.company_type_id BETWEEN 1 AND 5 AND mi.info_type_id IN (1, 2, 3, 4) AND mi.note IS NOT NULL AND cc.status_id IN (SELECT id FROM link_type WHERE id IN (4, 8, 12)) GROUP BY ct.kind ORDER BY unique_keyword_count DESC, average_company_id;
SELECT it.info AS genre, COUNT(mi.movie_id) AS number_of_movies, AVG(LENGTH(mi.info)) AS average_info_length, SUM(CASE WHEN an.name_pcode_cf IN ('A5143', 'F2162', 'B362', 'M2462') THEN 1 ELSE 0 END) AS count_actors_with_pcode FROM movie_info mi JOIN info_type it ON mi.info_type_id = it.id LEFT JOIN aka_name an ON an.person_id = mi.movie_id WHERE it.id = 40 AND mi.info IN ('Tagalog', 'Persian') GROUP BY it.info;
SELECT k.keyword AS keyword, COUNT(DISTINCT mk.movie_id) AS number_of_movies, AVG(CAST(mi.info AS FLOAT)) AS average_movie_length, COUNT(DISTINCT n.id) AS number_of_actors FROM movie_keyword AS mk INNER JOIN keyword AS k ON mk.keyword_id = k.id INNER JOIN movie_info AS mi ON mk.movie_id = mi.movie_id AND mi.info_type_id = 4 INNER JOIN name AS n ON mi.movie_id = n.imdb_id WHERE mk.keyword_id IN (3881, 2089, 3415, 3648) GROUP BY k.keyword ORDER BY number_of_movies DESC, average_movie_length DESC;
SELECT COUNT(DISTINCT ci.movie_id) AS num_movies, AVG(ci.nr_order) AS avg_cast_position, COUNT(DISTINCT cn.id) AS num_companies, AVG(complete_cast.status_id) AS avg_status_id, SUM(CASE WHEN pi.info_type_id = 19 THEN 1 ELSE 0 END) AS count_info_type_19, SUM(CASE WHEN pi.info_type_id = 20 THEN 1 ELSE 0 END) AS count_info_type_20, COUNT(DISTINCT mk.keyword_id) AS num_keywords FROM cast_info ci JOIN movie_keyword mk ON ci.movie_id = mk.movie_id JOIN company_name cn ON cn.imdb_id = ci.movie_id JOIN complete_cast ON complete_cast.movie_id = ci.movie_id JOIN person_info pi ON pi.person_id = ci.person_id WHERE ci.note NOT LIKE '%(archive footage)%' AND cn.country_code = 'US' AND complete_cast.subject_id = 1 AND (pi.info LIKE '%Stage:%' OR pi.info LIKE '%AIDS%') GROUP BY cn.country_code;
SELECT c.id AS company_id, c.name AS company_name, COUNT(DISTINCT m.id) AS number_of_movies, AVG(mi_numeric.info::FLOAT) AS average_movie_length, SUM(CASE WHEN ci.role_id = 1 THEN 1 ELSE 0 END) AS number_of_actors, COUNT(DISTINCT k.id) AS number_of_unique_keywords, MAX(ci.nr_order) AS max_cast_order, MIN(mc.note) AS earliest_production_note FROM movie_companies mc JOIN company_name c ON mc.company_id = c.id JOIN title m ON mc.movie_id = m.id LEFT JOIN movie_info mi ON m.id = mi.movie_id LEFT JOIN movie_info_idx mi_idx ON m.id = mi_idx.movie_id LEFT JOIN info_type it1 ON mi.info_type_id = it1.id AND it1.info = 'running time' LEFT JOIN cast_info ci ON m.id = ci.movie_id LEFT JOIN movie_keyword mk ON m.id = mk.movie_id LEFT JOIN keyword k ON mk.keyword_id = k.id LEFT JOIN movie_info mi_numeric ON m.id = mi_numeric.movie_id AND mi_numeric.info_type_id = it1.id WHERE c.country_code = '[us]' AND mi_numeric.info ~ '^[0-9]+(\.[0-9]+)?$' GROUP BY c.id, c.name ORDER BY number_of_movies DESC, average_movie_length DESC LIMIT 10;
SELECT COUNT(DISTINCT a.id) AS total_aka_titles, AVG(a.production_year) AS average_production_year, COUNT(DISTINCT m.company_id) AS total_companies_involved, COUNT(DISTINCT n.id) AS total_unique_names, COUNT(DISTINCT ml.movie_id) AS total_movies_with_links, SUM(CASE WHEN a.production_year BETWEEN 1990 AND 2000 THEN 1 ELSE 0 END) AS titles_from_90s FROM aka_title AS a JOIN movie_companies AS m ON a.movie_id = m.movie_id JOIN name AS n ON n.md5sum = a.md5sum LEFT JOIN movie_link AS ml ON a.movie_id = ml.movie_id WHERE a.production_year IS NOT NULL AND m.note IS NOT NULL AND n.gender IN ('F', 'M') GROUP BY n.gender ORDER BY total_aka_titles DESC;
SELECT ct.kind AS company_kind, COUNT(DISTINCT ci.movie_id) AS total_movies, AVG(ci.nr_order) AS average_cast_order, SUM(CASE WHEN ci.note LIKE '%(as %' THEN 1 ELSE 0 END) AS total_alias_credits, COUNT(DISTINCT mc.company_id) AS total_companies_involved, COUNT(DISTINCT ci.person_id) AS unique_cast_members FROM cast_info ci JOIN movie_companies mc ON ci.movie_id = mc.movie_id JOIN company_type ct ON mc.company_type_id = ct.id WHERE ct.kind IN ('distributors', 'miscellaneous companies', 'special effects companies') AND ci.note IS NOT NULL GROUP BY ct.kind ORDER BY total_movies DESC;
SELECT kt.kind AS kind_of_title, AVG(t.production_year) AS average_production_year, COUNT(DISTINCT t.id) AS number_of_titles, SUM(CASE WHEN mi.info_type_id = 2 THEN 1 ELSE 0 END) AS count_of_info_type_2, MAX(t.episode_nr) AS highest_episode_number FROM title t JOIN kind_type kt ON t.kind_id = kt.id LEFT JOIN movie_info mi ON t.id = mi.movie_id WHERE t.kind_id IN (2, 7) AND kt.id IN (4, 7, 6, 1) AND kt.kind IN ('video game', 'movie', 'video movie', 'tv series') GROUP BY kt.kind ORDER BY average_production_year DESC;
SELECT ct.id AS company_type_id, ct.kind AS company_type_kind, COUNT(*) AS total_companies, kt.id AS kind_type_id, kt.kind AS kind_type_kind, AVG(chn.imdb_id) AS average_imdb_id, SUM(chn.imdb_id) AS total_imdb_id_sum FROM company_type AS ct JOIN kind_type AS kt ON ct.id = kt.id LEFT JOIN char_name AS chn ON chn.id = ct.id GROUP BY ct.id, kt.id ORDER BY total_companies DESC, average_imdb_id ASC;
SELECT COUNT(DISTINCT akat.movie_id) AS total_movies, AVG(CAST(akat.production_year AS DECIMAL)) AS average_production_year, SUM(CASE WHEN mi.note IS NOT NULL THEN 1 ELSE 0 END) AS total_movies_with_notes, COUNT(DISTINCT mk.keyword_id) AS unique_keywords_used, COUNT(DISTINCT mc.company_id) AS total_companies_involved, SUM(CASE WHEN it.info = 'English' THEN 1 ELSE 0 END) AS total_english_language_movies FROM aka_title akat JOIN movie_info mi ON akat.movie_id = mi.movie_id JOIN movie_info_idx miidx ON akat.movie_id = miidx.movie_id JOIN movie_keyword mk ON akat.movie_id = mk.movie_id JOIN movie_companies mc ON akat.movie_id = mc.movie_id JOIN info_type it ON mi.info_type_id = it.id WHERE akat.production_year IN (1979, 1966) AND mc.company_type_id IN (SELECT id FROM link_type WHERE id = 7) AND mk.id IN (3803, 847) GROUP BY akat.kind_id;
SELECT kt.kind AS movie_kind, AVG(akat.production_year) AS average_production_year, COUNT(DISTINCT cn.id) AS number_of_actors, COUNT(DISTINCT kn.id) AS number_of_keywords, SUM(CASE WHEN cn.name LIKE 'A%' THEN 1 ELSE 0 END) AS actors_starting_with_a, COUNT(DISTINCT cmn.id) AS number_of_companies, MAX(akat.episode_nr) AS max_episode_number FROM aka_title akat JOIN kind_type kt ON akat.kind_id = kt.id LEFT JOIN complete_cast cc ON akat.movie_id = cc.movie_id LEFT JOIN char_name cn ON cn.id = cc.subject_id LEFT JOIN movie_keyword mk ON akat.movie_id = mk.movie_id LEFT JOIN keyword kn ON mk.keyword_id = kn.id AND kn.phonetic_code IN ('D525', 'G6431', 'T2623', 'S1425', 'M4165', 'G5123') LEFT JOIN movie_companies mc ON akat.movie_id = mc.movie_id LEFT JOIN company_name cmn ON mc.company_id = cmn.id WHERE akat.production_year >= 2000 GROUP BY kt.kind
SELECT n.name AS actor_name, COUNT(DISTINCT ci.movie_id) AS movie_count, AVG(mi_idx.info::NUMERIC) AS average_movie_rating, SUM(CASE WHEN m_info.info = 'Tagalog' THEN 1 ELSE 0 END) AS tagalog_movie_count FROM name AS n JOIN cast_info AS ci ON n.id = ci.person_id JOIN movie_info_idx AS mi_idx ON ci.movie_id = mi_idx.movie_id AND mi_idx.info_type_id = (SELECT id FROM info_type WHERE info = 'rating') JOIN movie_info AS m_info ON ci.movie_id = m_info.movie_id AND m_info.info_type_id = (SELECT id FROM info_type WHERE info = 'language') JOIN aka_name AS an ON n.id = an.person_id WHERE n.md5sum IN ('5c62d56f20103365a0051ebfd83ddd52', '4fbdca492f6b2ca9c6ee41602f4c8105', 'b19cb2bb887743bd4f33ed7c2b452ef6', '11f7d599980f6d97b7059ab1819ac294', 'd8d7be4935447c9e30dce0605179162d', 'e788144eeed55c07f730effca4f3cb55') AND n.surname_pcode = 'A4' GROUP BY n.name HAVING COUNT(DISTINCT ci.movie_id) > 5 ORDER BY average_movie_rating DESC;
SELECT AVG(akat.production_year) AS average_movie_year, COUNT(DISTINCT n.id) AS unique_actor_count, COUNT(DISTINCT akat.id) AS total_movie_aliases, SUM(CASE WHEN lt.link = 'remake of' THEN 1 ELSE 0 END) AS total_remake_links, SUM(CASE WHEN lt.link = 'edited from' THEN 1 ELSE 0 END) AS total_edited_from_links FROM aka_title akat JOIN name n ON akat.movie_id = n.id JOIN link_type lt ON lt.id = akat.movie_id WHERE akat.phonetic_code IN ('K2545', 'R5321', 'S1232', 'S3425', 'B5314') AND n.name_pcode_cf IN ('A465', 'A4634', 'A5212', 'A2516', 'A5261', 'A3561') AND akat.production_year BETWEEN 1990 AND 2020 AND n.gender = 'M' GROUP BY n.gender;
SELECT AVG(CAST(mi_idx.info AS FLOAT)) AS average_rating, COUNT(DISTINCT ci.movie_id) AS count_movies, COUNT(DISTINCT ci.person_id) AS count_actors, SUM(CASE WHEN ct.kind = 'producer' THEN 1 ELSE 0 END) AS count_producer_companies, SUM(CASE WHEN ct.kind = 'distributor' THEN 1 ELSE 0 END) AS count_distributor_companies, COUNT(DISTINCT mk.keyword_id) AS count_unique_keywords FROM movie_info_idx mi_idx JOIN cast_info ci ON mi_idx.movie_id = ci.movie_id JOIN movie_keyword mk ON ci.movie_id = mk.movie_id JOIN company_type ct ON ct.id = ci.role_id WHERE mi_idx.info_type_id = 1 AND ci.person_role_id IS NOT NULL AND ct.id IN (1, 4, 2) GROUP BY ct.kind;
SELECT kt.kind, it.info AS genre, AVG(LENGTH(mi.info)) AS avg_info_length, COUNT(DISTINCT ml.movie_id) AS movie_count, COUNT(DISTINCT ml.link_type_id) AS link_type_count FROM kind_type kt JOIN movie_info mi ON mi.info IN ('Persian', 'Korean', 'Swedish', 'Kalmyk-Oirat', 'Cantonese', 'Estonian') JOIN info_type it ON it.id = mi.info_type_id AND it.info = 'genres' JOIN movie_link ml ON ml.movie_id = mi.movie_id JOIN link_type lt ON lt.id = ml.link_type_id AND lt.id IN ('3', '6', '13', '5', '10') WHERE kt.kind IN ('episode', 'tv series') AND mi.movie_id IN ('924200', '924460', '929898', '929803', '926981') GROUP BY kt.kind, it.info;
SELECT ct.kind AS company_type, AVG(mi_idx.info::numeric) AS average_rating, COUNT(DISTINCT cn.id) AS number_of_companies, COUNT(DISTINCT t.id) AS number_of_titles, SUM(CASE WHEN t.production_year >= 2000 THEN 1 ELSE 0 END) AS titles_since_2000 FROM company_name AS cn JOIN movie_companies AS mc ON cn.id = mc.company_id JOIN title AS t ON mc.movie_id = t.id JOIN movie_info_idx AS mi_idx ON t.id = mi_idx.movie_id JOIN company_type AS ct ON mc.company_type_id = ct.id JOIN info_type AS it ON mi_idx.info_type_id = it.id WHERE cn.name IN ('SalviNET SIA', 'IconNicholson', 'Globe TV') AND it.info = 'rating' AND ct.kind IN ('production companies', 'distributors') GROUP BY ct.kind;
SELECT at.title AS alternate_title, COUNT(DISTINCT an.id) AS number_of_alternate_names, AVG(CAST(cc.status_id AS DECIMAL)) AS average_status_id, SUM(CASE WHEN n.gender = 'm' THEN 1 ELSE 0 END) AS male_count, SUM(CASE WHEN n.gender <> 'm' THEN 1 ELSE 0 END) AS female_count, COUNT(DISTINCT cc.id) AS complete_cast_count, MIN(at.production_year) AS earliest_production_year, MAX(at.production_year) AS latest_production_year FROM aka_title at JOIN aka_name an ON at.movie_id = an.person_id JOIN complete_cast cc ON at.movie_id = cc.movie_id JOIN name n ON an.person_id = n.id WHERE cc.subject_id = 1 AND cc.status_id IN (3, 4) AND n.gender = 'm' AND n.imdb_index IN ('V', 'VI', 'II') AND an.md5sum = 'f20a817147ce1df99c8e3b5614dbee2f' AND at.season_nr IN (28, 2, 5, 14, 37, 9) AND at.movie_id IN (1701837, 1248358, 1697981, 1674394, 1633043) GROUP BY at.title;
SELECT it.info AS info_category, COUNT(DISTINCT mi.movie_id) AS number_of_movies, AVG(at.production_year) AS average_production_year, SUM(CASE WHEN at.kind_id = 1 THEN 1 ELSE 0 END) AS number_of_feature_films, SUM(CASE WHEN at.kind_id <> 1 THEN 1 ELSE 0 END) AS number_of_nonfeature_films FROM movie_info mi JOIN info_type it ON mi.info_type_id = it.id JOIN aka_title at ON mi.movie_id = at.movie_id WHERE it.info IN ('sound mix', 'LD quality program', 'taglines') GROUP BY it.info ORDER BY number_of_movies DESC;
SELECT COUNT(DISTINCT ci.person_id) AS total_actors, AVG(mi_idx.info::numeric) AS average_rating, SUM(CASE WHEN mc.note LIKE '%(USA)%' THEN 1 ELSE 0 END) AS total_usa_productions, t.production_year, t.kind_id FROM cast_info AS ci JOIN movie_info_idx AS mi_idx ON ci.movie_id = mi_idx.movie_id JOIN movie_companies AS mc ON ci.movie_id = mc.movie_id JOIN title AS t ON ci.movie_id = t.id WHERE mi_idx.info_type_id = (SELECT id FROM info_type WHERE info = 'rating') AND mc.company_type_id = (SELECT id FROM company_type WHERE kind = 'production') AND t.production_year IS NOT NULL GROUP BY t.production_year, t.kind_id ORDER BY t.production_year DESC, average_rating DESC;
SELECT COUNT(DISTINCT ci.movie_id) AS number_of_movies, AVG(title.production_year) AS average_production_year, SUM(CASE WHEN n.gender = 'F' THEN 1 ELSE 0 END) AS female_cast_count, SUM(CASE WHEN n.gender = 'M' THEN 1 ELSE 0 END) AS male_cast_count, COUNT(DISTINCT n.id) AS total_cast_members, MIN(title.title) AS earliest_movie_title FROM cast_info ci INNER JOIN name n ON ci.person_id = n.id INNER JOIN title ON ci.movie_id = title.id INNER JOIN movie_info_idx mii ON title.id = mii.movie_id WHERE mii.info LIKE '1000111100' OR mii.info LIKE '....0213.2' OR mii.info LIKE '.....8...2' GROUP BY title.kind_id HAVING COUNT(DISTINCT ci.movie_id) > 5 ORDER BY average_production_year DESC;
SELECT rt.ROLE, COUNT(*) AS role_count, AVG(ci.nr_order) AS average_order, SUM(ci.nr_order) AS total_order, MAX(ci.nr_order) AS max_order, MIN(ci.nr_order) AS min_order FROM cast_info ci JOIN role_type rt ON ci.role_id = rt.id JOIN movie_keyword mk ON ci.movie_id = mk.movie_id JOIN movie_info mi ON ci.movie_id = mi.movie_id JOIN movie_link ml ON ci.movie_id = ml.movie_id WHERE mk.keyword_id IN (3544, 4170, 355, 3797, 2901) AND ci.movie_id IN (14730, 8894, 18741, 18773, 15355, 12280, 2069434, 2317758, 2267299) GROUP BY rt.ROLE ORDER BY role_count DESC, average_order;
SELECT AVG(title.production_year) AS average_production_year, COUNT(DISTINCT name.id) AS number_of_actors, COUNT(DISTINCT title.id) AS number_of_movies, SUM(CASE WHEN name.gender = 'M' THEN 1 ELSE 0 END) AS number_of_male_actors, SUM(CASE WHEN name.gender = 'F' THEN 1 ELSE 0 END) AS number_of_female_actors, MAX(title.production_year) AS latest_production_year, MIN(title.production_year) AS earliest_production_year FROM title JOIN aka_title ON title.id = aka_title.movie_id JOIN person_info ON aka_title.movie_id = person_info.person_id JOIN name ON person_info.person_id = name.id WHERE title.production_year BETWEEN 2000 AND 2020 AND name.name_pcode_nf IN ('N4532', 'H6341', 'M2164') GROUP BY title.kind_id HAVING COUNT(DISTINCT title.id) > 10 ORDER BY average_production_year DESC, number_of_movies DESC;
