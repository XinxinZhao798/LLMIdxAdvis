SELECT ct.kind AS company_type, AVG(kw.id) AS average_keyword_id, COUNT(DISTINCT mc.movie_id) AS total_movies, SUM(mc.company_id) AS sum_company_id FROM movie_companies mc JOIN company_type ct ON mc.company_type_id = ct.id JOIN movie_link ml ON mc.movie_id = ml.movie_id JOIN keyword kw ON CAST(ml.link_type_id AS INTEGER) = kw.id JOIN name n ON mc.movie_id = n.id WHERE n.gender = 'm' AND kw.keyword IN ('Black Rick', 'Joel Gonzalez', 'TNI Soldier', 'ESPN', 'Newsroom Martian') GROUP BY ct.kind ORDER BY total_movies DESC, average_keyword_id;
SELECT kt.kind AS movie_type, avg(akat.production_year) AS average_production_year, count(DISTINCT akat.movie_id) AS number_of_movies, count(DISTINCT mc.company_id) AS number_of_companies_involved, sum(CASE WHEN rt.role = 'director' THEN 1 ELSE 0 END) AS number_of_directors, sum(CASE WHEN rt.role = 'actress' THEN 1 ELSE 0 END) AS number_of_actresses, sum(CASE WHEN rt.role = 'cinematographer' THEN 1 ELSE 0 END) AS number_of_cinematographers, sum(CASE WHEN rt.role = 'composer' THEN 1 ELSE 0 END) AS number_of_composers FROM kind_type kt JOIN aka_title akat ON kt.id = akat.kind_id JOIN movie_companies mc ON akat.movie_id = mc.movie_id JOIN company_type ct ON mc.company_type_id = ct.id JOIN movie_link mlink ON akat.movie_id = mlink.movie_id JOIN role_type rt ON mlink.link_type_id = rt.id GROUP BY kt.kind ORDER BY number_of_movies DESC;
SELECT cn.country_code, COUNT(DISTINCT cn.id) AS num_companies, AVG(mi_idx.id) AS avg_movie_info_idx_id, SUM(CASE WHEN mi.info_type_id = mi_idx.info_type_id THEN 1 ELSE 0 END) AS sum_matching_info_types, COUNT(DISTINCT pi.person_id) AS num_people FROM company_name AS cn LEFT JOIN movie_info_idx AS mi_idx ON cn.imdb_id = mi_idx.movie_id LEFT JOIN movie_info AS mi ON mi.movie_id = mi_idx.movie_id LEFT JOIN person_info AS pi ON pi.info_type_id = mi.info_type_id WHERE cn.country_code = '[be]' AND mi_idx.movie_id IN ('925666', '929198', '939783', '925877', '930515', '925116') AND cn.md5sum IN ('6490953d16a7d7a36b9daafe4a9e84b6', 'b68f1bd9708e765d511e6e251f56419a', '11b8906a4c994a2996176bba270124ac', '8eb39544eea1fca12f1a46d1747c807c') GROUP BY cn.country_code;
SELECT kt.kind AS movie_kind, rt.ROLE AS role_type, COUNT(DISTINCT ci.movie_id) AS total_movies, COUNT(DISTINCT ci.person_id) AS total_people, AVG(ci.nr_order) AS average_cast_position, SUM(CASE WHEN rt.ROLE = 'producer' THEN 1 ELSE 0 END) AS total_producers, SUM(CASE WHEN rt.ROLE = 'actor' THEN 1 ELSE 0 END) AS total_actors FROM cast_info ci JOIN role_type rt ON ci.role_id = rt.id JOIN kind_type kt ON kt.id = (SELECT id FROM kind_type WHERE id = ci.person_role_id) JOIN movie_companies mc ON mc.movie_id = ci.movie_id JOIN company_name cn ON cn.id = mc.company_id WHERE rt.id IN (4, 5) GROUP BY kt.kind, rt.ROLE ORDER BY total_movies DESC, average_cast_position ASC;
SELECT rt.ROLE, COUNT(DISTINCT ml.movie_id) AS num_movies, AVG(cn.imdb_id) AS avg_imdb_id, COUNT(DISTINCT k.id) AS num_keywords FROM role_type rt LEFT JOIN cast_info ci ON rt.id = ci.role_id LEFT JOIN char_name cn ON ci.person_role_id = cn.id LEFT JOIN movie_link ml ON ci.movie_id = ml.movie_id LEFT JOIN movie_keyword mk ON ml.movie_id = mk.movie_id LEFT JOIN keyword k ON mk.keyword_id = k.id GROUP BY rt.ROLE ORDER BY num_movies DESC, avg_imdb_id DESC;
SELECT lt.LINK AS link_type, COUNT(DISTINCT ml.movie_id) AS num_movies, COUNT(ml.id) AS total_links, AVG(sub_ml.movie_links_count) AS average_links_per_movie FROM movie_link AS ml JOIN link_type AS lt ON ml.link_type_id = lt.id JOIN movie_info_idx AS miidx ON ml.movie_id = miidx.movie_id JOIN (SELECT movie_id, COUNT(id) AS movie_links_count FROM movie_link GROUP BY movie_id) AS sub_ml ON sub_ml.movie_id = ml.movie_id WHERE miidx.info_type_id IN (SELECT id FROM company_type WHERE kind = 'special effects companies') GROUP BY lt.LINK;
SELECT cc.movie_id, COUNT(DISTINCT chn.id) AS number_of_characters, COUNT(DISTINCT cn.id) AS number_of_companies_involved, AVG(cn.country_code::int) AS average_country_code_numeric, SUM(CASE WHEN cn.name = 'Circuit Films' THEN 1 ELSE 0 END) AS count_circuit_films, SUM(CASE WHEN cn.name = 'Wild East Productions' THEN 1 ELSE 0 END) AS count_wild_east_productions, SUM(CASE WHEN cn.name = 'LÃ©o & Compagnie' THEN 1 ELSE 0 END) AS count_leo_and_compagnie, SUM(CASE WHEN cn.name = 'C3Studios' THEN 1 ELSE 0 END) AS count_c3studios, SUM(CASE WHEN cn.name = 'M.A. Marcondes' THEN 1 ELSE 0 END) AS count_ma_marcondes FROM complete_cast cc JOIN char_name chn ON cc.subject_id = chn.id JOIN company_name cn ON cc.movie_id = cn.imdb_id GROUP BY cc.movie_id;
SELECT it.info AS genre, COUNT(DISTINCT mi.movie_id) AS number_of_movies, AVG(CAST(mi.info AS INTEGER)) AS average_votes, COUNT(DISTINCT ml.movie_id) AS number_of_linked_movies, COUNT(DISTINCT pi.person_id) AS number_of_persons_with_info, COUNT(DISTINCT mk.keyword_id) AS number_of_unique_keywords FROM movie_info mi JOIN info_type it ON mi.info_type_id = it.id AND it.info = 'genres' LEFT JOIN movie_link ml ON mi.movie_id = ml.movie_id AND ml.link_type_id IN (12, 16, 13, 8) LEFT JOIN person_info pi ON pi.info_type_id = 89 LEFT JOIN movie_keyword mk ON mi.movie_id = mk.movie_id WHERE mi.note NOT LIKE '%(interviews)%' AND mi.note NOT LIKE '%(some dialogue)%' AND mi.note NOT LIKE '%(English subtitles)%' AND mi.note NOT LIKE '%(Ukrainian)%' AND mi.note NOT LIKE '%(Original version)%' AND mi.note NOT LIKE '%(English Subtitles)%' GROUP BY genre;
SELECT c.name AS company_name, COUNT(DISTINCT t.id) AS number_of_movies, AVG(t.production_year) AS average_production_year, COUNT(DISTINCT k.keyword_id) AS distinct_keywords, COUNT(DISTINCT ml.linked_movie_id) AS linked_movies_count, COUNT(DISTINCT n.id) AS number_of_cast_members, SUM(CASE WHEN t.kind_id = 1 THEN 1 ELSE 0 END) AS number_of_feature_films, SUM(CASE WHEN t.kind_id = 2 THEN 1 ELSE 0 END) AS number_of_tv_shows, SUM(CASE WHEN t.kind_id = 3 THEN 1 ELSE 0 END) AS number_of_video_games FROM company_name c LEFT JOIN movie_keyword mk ON mk.movie_id = c.imdb_id LEFT JOIN movie_link ml ON ml.movie_id = c.imdb_id LEFT JOIN complete_cast cc ON cc.movie_id = c.imdb_id LEFT JOIN title t ON t.id = c.imdb_id LEFT JOIN name n ON n.imdb_id = c.imdb_id LEFT JOIN movie_keyword k ON k.movie_id = t.id WHERE c.name IN ('Crown International Pictures', 'Hisa-Film-Vertrieb GmbH', 'Quality Special Products', 'Hem Films', 'H & H Warranted Productions') GROUP BY c.name ORDER BY number_of_movies DESC;
SELECT ct.kind AS company_type, AVG(t.production_year) AS average_production_year, COUNT(DISTINCT mc.movie_id) AS total_movies, COUNT(DISTINCT ml.movie_id) AS total_movie_links, SUM(CASE WHEN t.kind_id = 2 THEN 1 ELSE 0 END) AS count_of_series, COUNT(DISTINCT t.id) FILTER (WHERE t.title = 'It Came from the Nightosphere' OR t.title = 'Wes Craven Presents Don''t Look Down') AS specific_titles_count FROM title t JOIN movie_companies mc ON t.id = mc.movie_id JOIN comp_cast_type ct ON mc.company_type_id = ct.id LEFT JOIN movie_link ml ON t.id = ml.movie_id WHERE ct.id IN (2, 3) AND mc.company_type_id = 1 AND (ml.link_type_id IN (12, 1, 13, 15) OR ml.link_type_id IS NULL) GROUP BY ct.kind
SELECT COUNT(DISTINCT ml.movie_id) AS linked_movies_count, AVG(CAST(pi.info AS NUMERIC)) AS average_rating, SUM(CASE WHEN it.info = 'opening weekend' THEN CAST(pi.info AS NUMERIC) ELSE 0 END) AS total_opening_weekend_revenue, lt.LINK AS link_type, cct.kind AS company_type FROM movie_link AS ml JOIN link_type AS lt ON ml.link_type_id = lt.id JOIN movie_companies AS mc ON ml.movie_id = mc.movie_id JOIN comp_cast_type AS cct ON mc.company_type_id = cct.id JOIN person_info AS pi ON ml.movie_id = pi.person_id JOIN info_type AS it ON pi.info_type_id = it.id WHERE it.info IN ('LD language', 'opening weekend', 'LD digital sound') AND it.id IN ('58', '108', '37', '73', '112') AND pi.info ~ '^[0-9]+(\.[0-9]+)?$' GROUP BY lt.LINK, cct.kind ORDER BY total_opening_weekend_revenue DESC;
SELECT n.name AS actor_name, COUNT(DISTINCT ci.movie_id) AS number_of_movies, AVG(mi_idx.info::numeric) AS average_movie_rating, SUM(CASE WHEN ci.role_id = 1 THEN 1 ELSE 0 END) AS number_of_lead_roles, COUNT(DISTINCT mc.company_id) AS number_of_companies_worked_with FROM cast_info ci JOIN name n ON ci.person_id = n.id JOIN movie_info_idx mi_idx ON ci.movie_id = mi_idx.movie_id AND mi_idx.info_type_id = 101 JOIN movie_companies mc ON ci.movie_id = mc.movie_id WHERE ci.nr_order <= 51 AND mi_idx.info::numeric >= 5.0 GROUP BY n.name HAVING COUNT(DISTINCT ci.movie_id) > 5 ORDER BY average_movie_rating DESC, number_of_movies DESC LIMIT 10;
SELECT it.info AS info_category, COUNT(DISTINCT mc.movie_id) AS number_of_movies, AVG(CAST(mi_idx.info AS INTEGER)) AS average_rating, SUM(CASE WHEN mc.company_type_id = 1 THEN 1 ELSE 0 END) AS number_of_production_companies, SUM(CASE WHEN mc.company_type_id = 2 THEN 1 ELSE 0 END) AS number_of_distributors, COUNT(DISTINCT pi.person_id) AS number_of_people_involved, COUNT(DISTINCT ml.linked_movie_id) AS number_of_linked_movies FROM movie_info_idx AS mi_idx JOIN info_type AS it ON mi_idx.info_type_id = it.id JOIN movie_companies AS mc ON mi_idx.movie_id = mc.movie_id JOIN person_info AS pi ON mi_idx.movie_id = pi.person_id JOIN movie_link AS ml ON mi_idx.movie_id = ml.movie_id WHERE it.id IN (18, 57, 72, 5, 81) AND mc.id = 1085 AND mi_idx.id = 21 AND mc.note IS NOT NULL AND mi_idx.movie_id IN (8975, 19179, 18832, 8413, 9810) GROUP BY it.info ORDER BY number_of_movies DESC;
SELECT kt.kind AS movie_kind, AVG(t.production_year) AS avg_production_year, SUM(CASE WHEN rt.role = 'actress' THEN 1 ELSE 0 END) AS total_actress_roles, SUM(CASE WHEN rt.role = 'producer' THEN 1 ELSE 0 END) AS total_producer_roles, COUNT(DISTINCT mc.company_id) AS number_of_companies_involved FROM title AS t JOIN kind_type AS kt ON t.kind_id = kt.id LEFT JOIN movie_companies AS mc ON t.id = mc.movie_id LEFT JOIN movie_info AS mi ON t.id = mi.movie_id LEFT JOIN role_type AS rt ON mi.info_type_id = rt.id AND rt.role IN ('actress', 'producer') GROUP BY kt.kind ORDER BY number_of_companies_involved DESC, avg_production_year;
SELECT t.kind_id, min(k.kind) AS movie_kind, avg(t.production_year) AS average_production_year, count(DISTINCT mc.company_id) AS number_of_companies, count(DISTINCT ml.id) AS number_of_movie_links, count(DISTINCT mc.company_type_id) AS number_of_company_types FROM title AS t LEFT JOIN movie_companies AS mc ON t.id = mc.movie_id LEFT JOIN comp_cast_type AS k ON mc.company_type_id = k.id LEFT JOIN movie_link AS ml ON t.id = ml.movie_id AND ml.link_type_id IN ('16', '10') WHERE t.kind_id IN ('2', '7') GROUP BY t.kind_id;
SELECT AVG(cast_info.nr_order) AS average_cast_order, COUNT(DISTINCT name.id) AS total_actors, COUNT(DISTINCT movie_keyword.movie_id) AS total_movies_with_keywords, SUM(CASE WHEN comp_cast_type.kind = 'complete+verified' THEN 1 ELSE 0 END) AS total_verified_casts, COUNT(DISTINCT movie_link.movie_id) AS total_movie_links, MAX(aka_title.production_year) AS latest_production_year FROM cast_info JOIN name ON cast_info.person_id = name.id JOIN movie_keyword ON cast_info.movie_id = movie_keyword.movie_id JOIN comp_cast_type ON cast_info.role_id = comp_cast_type.id JOIN aka_title ON cast_info.movie_id = aka_title.movie_id JOIN movie_link ON cast_info.movie_id = movie_link.movie_id WHERE comp_cast_type.kind IN ('complete+verified', 'cast', 'crew', 'complete') AND movie_keyword.keyword_id IN (3208, 869, 3853, 1657) AND aka_title.production_year BETWEEN 1990 AND 2020 GROUP BY aka_title.kind_id ORDER BY total_movies_with_keywords DESC, latest_production_year DESC;
SELECT it.info AS info_type, AVG(CAST(mi.info AS INTEGER)) AS average_info, COUNT(DISTINCT mk.movie_id) AS count_movies, COUNT(DISTINCT at.id) AS count_alternative_titles, SUM(CASE WHEN at.episode_of_id = 15436 THEN 1 ELSE 0 END) AS count_episodes_of_show_15436 FROM movie_info mi JOIN info_type it ON mi.info_type_id = it.id JOIN movie_keyword mk ON mk.movie_id = mi.movie_id LEFT JOIN aka_title at ON at.movie_id = mi.movie_id WHERE it.id IN (112, 107) AND mi.info ~ '^\d+$' GROUP BY it.info HAVING COUNT(DISTINCT mk.movie_id) > 5;
SELECT kt.kind AS movie_kind, COUNT(DISTINCT ci.movie_id) AS number_of_movies, AVG(ci.nr_order) AS average_cast_order, SUM(CASE WHEN ci.nr_order IS NOT NULL THEN 1 ELSE 0 END) AS total_cast_positions_filled, COUNT(DISTINCT an.id) AS unique_aka_names, COUNT(DISTINCT chn.id) AS unique_character_names, AVG(mii.info::NUMERIC) AS average_movie_info_numeric_value FROM kind_type AS kt JOIN movie_info_idx AS mii ON kt.id = mii.info_type_id LEFT JOIN cast_info AS ci ON mii.movie_id = ci.movie_id LEFT JOIN aka_name AS an ON ci.person_id = an.person_id LEFT JOIN char_name AS chn ON ci.person_id = chn.imdb_id WHERE kt.id IN (1, 2, 4, 7) AND mii.info SIMILAR TO '(26|00..001212|1\.00101100|...0\.110\.6)%' AND ci.nr_order IN (20, 33, 65, 75, 87, 93) AND an.name_pcode_cf IN ('A42', 'W4526', 'F6165', 'S5152', 'A641', 'M2626') GROUP BY kt.kind ORDER BY number_of_movies DESC;
SELECT COUNT(DISTINCT t.id) AS number_of_movies, AVG(t.production_year) AS average_production_year, SUM(CASE WHEN at.episode_of_id IS NOT NULL THEN 1 ELSE 0 END) AS number_of_episodes, it.info AS info_type_description, COUNT(DISTINCT an.person_id) AS number_of_actors, COUNT(DISTINCT at.movie_id) AS number_of_aka_titles FROM title AS t LEFT JOIN aka_title AS at ON t.id = at.movie_id LEFT JOIN movie_info_idx AS mi_idx ON t.id = mi_idx.movie_id LEFT JOIN info_type AS it ON mi_idx.info_type_id = it.id LEFT JOIN aka_name AS an ON an.id = mi_idx.movie_id WHERE t.production_year BETWEEN 1990 AND 2020 AND (mi_idx.info_type_id IN (100, 101, 99) OR mi_idx.info IS NOT NULL) AND (at.episode_of_id IN (24960, 8508, 3016, 7633) OR at.episode_of_id IS NULL) AND an.surname_pcode IN ('T653', 'E164', 'H56', 'A526') GROUP BY it.info;
SELECT COUNT(DISTINCT akat.movie_id) AS total_movies, AVG(CAST(akat.production_year AS DECIMAL)) AS average_production_year, SUM(CASE WHEN mi.note IS NOT NULL THEN 1 ELSE 0 END) AS total_movies_with_notes, COUNT(DISTINCT mk.keyword_id) AS unique_keywords_used, COUNT(DISTINCT mc.company_id) AS total_companies_involved, SUM(CASE WHEN it.info = 'English' THEN 1 ELSE 0 END) AS total_english_language_movies FROM aka_title akat JOIN movie_info mi ON akat.movie_id = mi.movie_id JOIN movie_info_idx miidx ON akat.movie_id = miidx.movie_id JOIN movie_keyword mk ON akat.movie_id = mk.movie_id JOIN movie_companies mc ON akat.movie_id = mc.movie_id JOIN info_type it ON mi.info_type_id = it.id WHERE akat.production_year IN (1979, 1966) AND mc.company_type_id IN (SELECT id FROM link_type WHERE id = 7) AND mk.id IN (3803, 847) GROUP BY akat.kind_id;
SELECT ct.kind AS cast_type, COUNT(ci.id) AS total_cast_entries, AVG(ci.nr_order) AS average_order, SUM(CASE WHEN ml.link_type_id = 1 THEN 1 ELSE 0 END) AS total_sequel_links, COUNT(DISTINCT ci.movie_id) AS unique_movies, COUNT(DISTINCT ci.person_id) AS unique_persons FROM cast_info ci JOIN comp_cast_type ct ON ci.role_id = ct.id LEFT JOIN movie_link ml ON ci.movie_id = ml.movie_id AND ml.linked_movie_id = 9108 WHERE ci.movie_id IN (2348393, 1843055, 2354998, 2143306, 1326354, 1589480) AND ci.nr_order IN (75, 20, 2, 35) GROUP BY ct.kind ORDER BY total_cast_entries DESC;
