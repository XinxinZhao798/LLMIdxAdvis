SELECT CT.kind AS company_type, COUNT(DISTINCT ML.movie_id) AS total_movies_linked, AVG(CAST(MI.info AS NUMERIC)) AS average_rating, SUM(CASE WHEN ML.linked_movie_id IN ('583610', '1639457', '20479', '2056353', '346879') THEN 1 ELSE 0 END) AS specific_links_count FROM movie_link ML JOIN movie_info MI ON ML.movie_id = MI.movie_id AND MI.info_type_id = '4' JOIN company_name CN ON CN.imdb_id = ML.movie_id JOIN company_type CT ON CN.id = CT.id WHERE ML.link_type_id IN ('1', '2') GROUP BY CT.kind HAVING COUNT(DISTINCT ML.movie_id) > 10 ORDER BY average_rating DESC;
SELECT rt.ROLE, COUNT(DISTINCT n.id) AS Total_People, AVG(mi.id) AS Average_Movie_Info_Id, SUM(CASE WHEN ml.linked_movie_id IN ('2454993', '1779499', '763084', '1938935', '188175', '1915458') THEN 1 ELSE 0 END) AS Linked_Movies_Count FROM role_type rt JOIN name n ON n.surname_pcode = CAST(rt.id AS CHARACTER VARYING) JOIN movie_info mi ON mi.info_type_id = rt.id LEFT JOIN movie_link ml ON ml.movie_id = mi.movie_id WHERE rt.id = 12 AND rt.ROLE IN ('writer', 'producer', 'actress', 'actor', 'director', 'composer') AND n.surname_pcode IN ('A432', 'A4', 'A465', 'A456') AND ml.movie_id IN ('10538', '16743', '7369', '5520', '14521') GROUP BY rt.ROLE;
SELECT kt.kind AS movie_genre, COUNT(DISTINCT mi_idx.movie_id) AS number_of_movies, AVG(CAST(mi_idx.info AS INTEGER)) AS average_rating, SUM(CAST(person_info.info AS INTEGER)) AS total_movie_budget, COUNT(DISTINCT name.id) AS number_of_actors, COUNT(DISTINCT mk.keyword_id) AS number_of_unique_keywords FROM movie_info_idx mi_idx JOIN kind_type kt ON mi_idx.info_type_id = kt.id JOIN movie_keyword mk ON mi_idx.movie_id = mk.movie_id JOIN movie_info_idx budget_idx ON mi_idx.movie_id = budget_idx.movie_id AND budget_idx.info_type_id = (SELECT id FROM kind_type WHERE kind = 'budget') JOIN person_info ON mi_idx.movie_id = person_info.person_id JOIN name ON person_info.person_id = name.id WHERE kt.id IN ('6', '3', '5', '7', '2', '1') AND name.name_pcode_cf IN ('A2545', 'A2651', 'A4236', 'A4341', 'A2456', 'A2632') GROUP BY movie_genre ORDER BY number_of_movies DESC, average_rating DESC;
SELECT n.name AS actor_name, COUNT(DISTINCT ci.movie_id) AS number_of_movies, AVG(t.production_year) AS average_production_year, SUM(CASE WHEN lt.id = 3 THEN 1 ELSE 0 END) AS count_of_sequels, SUM(CASE WHEN lt.id = 4 THEN 1 ELSE 0 END) AS count_of_prequels FROM cast_info ci JOIN name n ON ci.person_id = n.id JOIN title t ON ci.movie_id = t.id LEFT JOIN movie_link ml ON t.id = ml.movie_id LEFT JOIN link_type lt ON ml.link_type_id = lt.id WHERE n.gender = 'F' AND t.kind_id IN (2, 7) AND t.production_year BETWEEN 1990 AND 2000 GROUP BY n.name HAVING COUNT(DISTINCT ci.movie_id) > 5 ORDER BY number_of_movies DESC, average_production_year DESC;
SELECT ct.kind AS company_kind, AVG(t.production_year) AS average_production_year, COUNT(DISTINCT t.id) AS number_of_movies, SUM(COUNT(DISTINCT mk.keyword_id)) OVER (PARTITION BY mc.company_type_id) AS total_keywords FROM title t JOIN movie_companies mc ON t.id = mc.movie_id JOIN company_type ct ON mc.company_type_id = ct.id LEFT JOIN movie_keyword mk ON t.id = mk.movie_id GROUP BY ct.kind, mc.company_type_id ORDER BY average_production_year DESC, number_of_movies DESC;
SELECT tk.kind, AVG(t.production_year) AS average_production_year, SUM(t.production_year) AS total_production_year_sum, COUNT(DISTINCT t.id) AS number_of_movies, COUNT(DISTINCT mc.company_type_id) AS distinct_company_types_involved FROM title AS t JOIN movie_companies AS mc ON t.id = mc.movie_id JOIN company_type AS ct ON mc.company_type_id = ct.id JOIN (SELECT id, 'Drama' AS kind FROM title WHERE kind_id = 1 UNION ALL SELECT id, 'Comedy' AS kind FROM title WHERE kind_id = 2 ) AS tk ON t.id = tk.id GROUP BY tk.kind ORDER BY number_of_movies DESC, average_production_year DESC;
SELECT n.name AS actor_name, COUNT(DISTINCT cn.id) AS character_count, AVG(mk.keyword_id) AS average_keyword_id, SUM(CASE WHEN ml.link_type_id = 1 THEN 1 ELSE 0 END) AS direct_movie_links, COUNT(DISTINCT ml.movie_id) AS linked_movies_count FROM name n JOIN aka_name an ON n.id = an.person_id JOIN char_name cn ON an.id = cn.imdb_id JOIN movie_keyword mk ON cn.id = mk.movie_id JOIN movie_link ml ON mk.movie_id = ml.movie_id WHERE n.gender = 'm' GROUP BY n.name;
SELECT ct.kind AS company_kind, COUNT(DISTINCT t.id) AS number_of_movies, AVG(t.production_year) AS average_production_year, COUNT(DISTINCT cc.subject_id) AS number_of_subjects, SUM(CASE WHEN t.kind_id = 1 THEN 1 ELSE 0 END) AS number_of_feature_films, SUM(CASE WHEN t.kind_id = 2 THEN 1 ELSE 0 END) AS number_of_tv_shows, SUM(CASE WHEN t.kind_id = 4 THEN 1 ELSE 0 END) AS number_of_documentaries FROM title t JOIN complete_cast cc ON t.id = cc.movie_id JOIN company_type ct ON t.kind_id = ct.id GROUP BY ct.kind ORDER BY number_of_movies DESC;
SELECT t.production_year, COUNT(DISTINCT t.id) AS total_titles, AVG(t.production_year) AS avg_production_year, SUM(CASE WHEN k.keyword = 'medical-emergency' THEN 1 ELSE 0 END) AS count_medical_emergency, COUNT(DISTINCT cc.movie_id) AS total_movies_with_complete_cast, COUNT(DISTINCT char_name.name) AS total_character_names FROM title AS t LEFT JOIN keyword AS k ON t.phonetic_code = k.phonetic_code LEFT JOIN complete_cast AS cc ON t.id = cc.movie_id LEFT JOIN char_name ON char_name.surname_pcode = t.md5sum WHERE t.production_year BETWEEN 1990 AND 2000 AND cc.status_id IN (3, 4) AND (k.keyword = 'audi-rs5' OR k.keyword = 'second-chance' OR k.keyword = 'little-boy') GROUP BY t.production_year ORDER BY total_titles DESC;
SELECT kt.kind, it.info AS genre, AVG(LENGTH(mi.info)) AS avg_info_length, COUNT(DISTINCT ml.movie_id) AS movie_count, COUNT(DISTINCT ml.link_type_id) AS link_type_count FROM kind_type kt JOIN movie_info mi ON mi.info IN ('Persian', 'Korean', 'Swedish', 'Kalmyk-Oirat', 'Cantonese', 'Estonian') JOIN info_type it ON it.id = mi.info_type_id AND it.info = 'genres' JOIN movie_link ml ON ml.movie_id = mi.movie_id JOIN link_type lt ON lt.id = ml.link_type_id AND lt.id IN ('3', '6', '13', '5', '10') WHERE kt.kind IN ('episode', 'tv series') AND mi.movie_id IN ('924200', '924460', '929898', '929803', '926981') GROUP BY kt.kind, it.info;
SELECT rt.ROLE, COUNT(*) AS role_count, AVG(ci.nr_order) AS average_order, SUM(ci.nr_order) AS total_order, MAX(ci.nr_order) AS max_order, MIN(ci.nr_order) AS min_order FROM cast_info ci JOIN role_type rt ON ci.role_id = rt.id JOIN movie_keyword mk ON ci.movie_id = mk.movie_id JOIN movie_info mi ON ci.movie_id = mi.movie_id JOIN movie_link ml ON ci.movie_id = ml.movie_id WHERE mk.keyword_id IN (3544, 4170, 355, 3797, 2901) AND ci.movie_id IN (14730, 8894, 18741, 18773, 15355, 12280, 2069434, 2317758, 2267299) GROUP BY rt.ROLE ORDER BY role_count DESC, average_order;
SELECT kt.kind AS kind_of_production, COUNT(DISTINCT mk.movie_id) AS number_of_movies, COUNT(DISTINCT mk.keyword_id) AS number_of_unique_keywords, AVG(sub.movie_keyword_count) AS average_keywords_per_movie, COUNT(DISTINCT an.person_id) AS number_of_distinct_persons FROM kind_type kt JOIN movie_keyword mk ON mk.id = ANY(ARRAY[3853, 448, 3514, 4583, 3985]) JOIN (SELECT movie_id, COUNT(keyword_id) AS movie_keyword_count FROM movie_keyword GROUP BY movie_id) AS sub ON sub.movie_id = mk.movie_id LEFT JOIN aka_name an ON an.id = mk.movie_id AND an.name IS NOT NULL WHERE kt.kind IN ('video game', 'tv series', 'tv mini series', 'episode', 'video movie') GROUP BY kt.kind ORDER BY number_of_movies DESC;
SELECT ct.kind AS company_type, AVG(t.production_year) AS average_production_year, COUNT(DISTINCT t.id) AS number_of_titles, SUM(CASE WHEN cn.country_code = '[us]' THEN 1 ELSE 0 END) AS number_of_us_companies, MAX(pi.info) AS latest_info_entry FROM title AS t JOIN company_name AS cn ON t.id = cn.imdb_id JOIN company_type AS ct ON cn.id = ct.id LEFT JOIN person_info AS pi ON pi.info LIKE '%USA%' WHERE t.production_year BETWEEN 1980 AND 1990 AND cn.country_code IN ('[us]', '[ca]') GROUP BY ct.kind ORDER BY number_of_titles DESC;
SELECT AVG(mi_idx.info::integer) AS average_movie_rating, COUNT(DISTINCT k.id) AS total_unique_keywords, COUNT(DISTINCT cn.id) AS total_companies_involved, COUNT(DISTINCT pi.person_id) AS total_people_with_info, MAX(cn.name) AS largest_company_name FROM keyword AS k, movie_keyword AS mk, movie_info_idx AS mi_idx, company_name AS cn, movie_companies AS mc, person_info AS pi, comp_cast_type AS cct WHERE k.keyword IN ('hang-gliding', 'stubbornness', 'porch-swing', 'cereal', 'identical-twins') AND k.id = mk.keyword_id AND mk.movie_id = mi_idx.movie_id AND mc.movie_id = mi_idx.movie_id AND mc.company_id = cn.id AND pi.info_type_id = cct.id AND cct.kind IN ('complete+verified', 'cast', 'crew', 'complete') GROUP BY cct.kind;
SELECT ct.kind AS company_type, AVG(CASE WHEN n.gender = 'f' THEN 1 ELSE 0 END) AS avg_female_cast, AVG(CASE WHEN n.gender = 'm' THEN 1 ELSE 0 END) AS avg_male_cast, COUNT(DISTINCT mc.movie_id) AS num_movies, COUNT(DISTINCT mc.company_id) AS num_companies, SUM(CASE WHEN mc.note LIKE '%worldwide%' THEN 1 ELSE 0 END) AS worldwide_releases FROM movie_companies AS mc JOIN comp_cast_type AS ct ON mc.company_type_id = ct.id JOIN name AS n ON mc.company_id = n.id GROUP BY ct.kind HAVING COUNT(DISTINCT mc.movie_id) > 10 ORDER BY num_movies DESC;
SELECT AVG(a.production_year) AS average_production_year, COUNT(DISTINCT c.id) AS total_unique_casts, SUM(CASE WHEN l.id IN (7, 8) THEN 1 ELSE 0 END) AS total_edited_or_spin_off_links, COUNT(DISTINCT cn.id) AS total_unique_characters, COUNT(*) AS total_titles FROM aka_title AS a JOIN complete_cast AS c ON a.movie_id = c.movie_id JOIN char_name AS cn ON cn.id = ANY(ARRAY[54785, 4119, 86783, 28862]) JOIN link_type AS l ON l.id = ANY(ARRAY[7, 8, 6, 3]) WHERE a.production_year IS NOT NULL AND c.status_id IN (3, 4) AND a.episode_of_id IS NOT NULL AND a.episode_of_id IN (15984, 4570, 5164, 247, 20256, 15791) AND l.link IN ('edited from', 'spin off') GROUP BY c.subject_id;
SELECT COUNT(DISTINCT ci.movie_id) AS number_of_movies, AVG(mi_idx.info::numeric) AS average_movie_rating, SUM(CASE WHEN ci.note LIKE '%(producer)%' THEN 1 ELSE 0 END) AS total_producer_mentions, cct.kind AS cast_type_kind, MIN(cn.name) AS company_name, MAX(ci.nr_order) AS highest_cast_order FROM cast_info AS ci JOIN comp_cast_type AS cct ON ci.person_role_id = cct.id JOIN company_name AS cn ON cn.id = ci.person_id JOIN movie_keyword AS mk ON ci.movie_id = mk.movie_id JOIN person_info AS pi ON ci.person_id = pi.person_id JOIN link_type AS lt ON ci.role_id = lt.id LEFT JOIN movie_info_idx AS mi_idx ON mi_idx.movie_id = ci.movie_id WHERE cct.kind IN ('complete', 'complete+verified') AND cn.name_pcode_sf IN ('C6532', 'L2653', 'U53', 'D252') AND (ci.note LIKE '%(producer)%' OR ci.note IS NULL) AND lt.id IN ('7', '15') GROUP BY cct.kind ORDER BY average_movie_rating DESC;
SELECT COUNT(DISTINCT n.id) AS total_people, AVG(CAST(mi.info AS NUMERIC)) AS average_movie_rating, SUM(CASE WHEN mi.info_type_id = 45 THEN 1 ELSE 0 END) AS count_of_genre_science_fiction, COUNT(DISTINCT pi.person_id) AS total_people_with_additional_info, MAX(n.name) AS last_person_name FROM name AS n LEFT JOIN movie_info AS mi ON n.id = mi.movie_id AND mi.info_type_id = 7 LEFT JOIN person_info AS pi ON n.id = pi.person_id WHERE n.gender = 'm' AND EXISTS (SELECT 1 FROM movie_info_idx AS mi_idx WHERE mi_idx.movie_id = n.id AND mi_idx.info_type_id IN (45, 71, 75, 30, 7, 84)) GROUP BY n.gender;
SELECT pi.person_id, COUNT(DISTINCT ci.movie_id) AS number_of_movies, AVG(ci.nr_order) AS average_cast_order, SUM(CASE WHEN ci.note LIKE '%(as %' THEN 1 ELSE 0 END) AS number_of_alias_roles, COUNT(DISTINCT pi.info_type_id) AS distinct_info_types FROM person_info pi JOIN cast_info ci ON pi.person_id = ci.person_id JOIN company_type ct ON ci.role_id = ct.id WHERE ci.person_id IN (1575, 1003, 1034, 1127, 1520, 1048) AND ci.note SIMILAR TO '%(\(pelotari\)|\(as [^)]+\)|\(2011\))%' GROUP BY pi.person_id ORDER BY number_of_movies DESC;
SELECT kt.kind AS movie_kind, COUNT(DISTINCT ci.movie_id) AS total_movies, AVG(CAST(ci.nr_order AS DECIMAL)) AS average_cast_order, COUNT(DISTINCT ci.person_id) AS total_actors, MAX(t.production_year) AS latest_production_year, MIN(t.production_year) AS earliest_production_year, COUNT(DISTINCT n.id) AS total_directors FROM cast_info ci JOIN title t ON ci.movie_id = t.id JOIN kind_type kt ON t.kind_id = kt.id JOIN role_type rt ON ci.role_id = rt.id LEFT JOIN name n ON ci.person_id = n.id AND rt.role = 'director' WHERE kt.id IN (6, 7) AND rt.role IN ('actor', 'actress', 'director') AND t.series_years LIKE '____-____' GROUP BY kt.kind ORDER BY total_movies DESC;
SELECT kt.kind, t.production_year AS production_year, COUNT(DISTINCT t.id) AS number_of_titles, AVG(CAST(mi_idx.info AS FLOAT)) FILTER (WHERE mi_idx.info_type_id = 101) AS average_rating, COUNT(cc.id) AS complete_cast_count FROM title AS t LEFT JOIN kind_type AS kt ON t.kind_id = kt.id LEFT JOIN movie_info_idx AS mi_idx ON t.id = mi_idx.movie_id LEFT JOIN complete_cast AS cc ON t.id = cc.movie_id WHERE t.kind_id IN (2, 7) GROUP BY kt.kind, production_year ORDER BY kt.kind, production_year DESC;
SELECT c.name AS company_name, c.country_code, kt.kind AS movie_type, COUNT(DISTINCT mi.movie_id) AS number_of_movies, AVG(CAST(mi_num.info AS DECIMAL)) AS average_rating, SUM(CASE WHEN mk.keyword_id = 3569 THEN 1 ELSE 0 END) AS count_of_keyword_3569, SUM(CASE WHEN mk.keyword_id = 3677 THEN 1 ELSE 0 END) AS count_of_keyword_3677, COUNT(DISTINCT ml.id) AS number_of_movie_links, COUNT(DISTINCT mi.id) AS number_of_movie_infos FROM company_name c JOIN movie_info mi ON c.imdb_id = mi.movie_id JOIN info_type it ON mi.info_type_id = it.id JOIN movie_keyword mk ON mi.movie_id = mk.movie_id JOIN movie_link ml ON mi.movie_id = ml.movie_id JOIN kind_type kt ON it.id = kt.id LEFT JOIN movie_info mi_num ON mi.movie_id = mi_num.movie_id AND mi_num.info_type_id = ( SELECT id FROM info_type WHERE info = 'rating' ) WHERE c.country_code = 'US' AND it.info = 'countries' AND kt.kind = 'movie' GROUP BY c.name, c.country_code, kt.kind ORDER BY number_of_movies DESC;
SELECT COUNT(DISTINCT cn.id) AS num_companies, AVG(t.production_year) AS avg_production_year, SUM(CASE WHEN rt.ROLE = 'actor' THEN 1 ELSE 0 END) AS total_actor_roles, SUM(CASE WHEN rt.ROLE = 'actress' THEN 1 ELSE 0 END) AS total_actress_roles, COUNT(DISTINCT n.id) AS num_actors, COUNT(DISTINCT t.id) AS num_titles FROM name AS n JOIN char_name AS chn ON n.name_pcode_nf = chn.name_pcode_nf JOIN role_type AS rt ON n.id = chn.id JOIN title AS t ON t.phonetic_code IN ('A1265', 'M3151', 'R5434') JOIN movie_companies AS mc ON mc.movie_id = t.id JOIN company_name AS cn ON cn.id = mc.company_id WHERE t.production_year BETWEEN 1990 AND 2000 AND chn.md5sum IN ('c8d3a477c4092e8d35d54ee4e2a854a7', '7887e4403fb219782fde01f150e22f05', 'b90077cfb2486002f9581b5cd2a1a04b', 'b6658816fc7029718e649600b2cc328e') GROUP BY t.production_year;
SELECT cc.kind AS cast_kind, AVG(cc.id) AS average_cast_id, CN.name AS company_name, COUNT(*) AS number_of_movies, SUM(MI.id) AS sum_movie_info_id, AVG(MI.info_type_id) AS average_info_type_id FROM cast_info CI JOIN comp_cast_type CC ON CI.person_role_id = CC.id JOIN company_name CN ON CN.country_code = CI.note JOIN movie_info_idx MI ON CI.movie_id = MI.movie_id WHERE CI.nr_order IN (56, 62, 2, 74) AND CI.movie_id IN (1884275, 2284142, 1084092) AND CN.country_code IN ('[xyu]', '[suhh]', '[lv]', '[nl]', '[cn]') AND CN.name_pcode_sf IN ('W4216', 'A4526', 'S4163', 'C1616') GROUP BY cc.kind, CN.name ORDER BY number_of_movies DESC, company_name;
SELECT kt.kind AS movie_kind, COUNT(DISTINCT ml.movie_id) AS number_of_movies, COUNT(DISTINCT ml.linked_movie_id) AS number_of_linked_movies, AVG(ml.link_type_id) AS average_link_type_id, SUM(CASE WHEN rt.role = 'producer' THEN 1 ELSE 0 END) AS producer_roles_count, SUM(CASE WHEN rt.role = 'actress' THEN 1 ELSE 0 END) AS actress_roles_count FROM movie_link AS ml JOIN kind_type AS kt ON ml.movie_id = kt.id JOIN role_type AS rt ON ml.link_type_id = rt.id WHERE kt.kind IN ('movie', 'tv mini series', 'episode') AND rt.role IN ('guest', 'cinematographer', 'producer', 'actress') GROUP BY kt.kind;
