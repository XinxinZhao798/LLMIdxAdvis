SELECT ak.production_year, COUNT(DISTINCT mk.movie_id) AS number_of_movies, COUNT(DISTINCT ci.person_id) AS number_of_actors, COUNT(DISTINCT mk.keyword_id) AS number_of_unique_keywords, AVG(ci.nr_order) AS average_cast_order FROM movie_keyword mk INNER JOIN aka_title ak ON mk.movie_id = ak.movie_id INNER JOIN cast_info ci ON mk.movie_id = ci.movie_id INNER JOIN movie_info_idx mi ON mk.movie_id = mi.movie_id WHERE mk.keyword_id IN (3815, 3067) AND ak.production_year BETWEEN 1980 AND 1990 GROUP BY ak.production_year ORDER BY ak.production_year;
SELECT AT.production_year, CT.kind AS company_kind, IT.info AS info_type, AVG(CI.nr_order) AS average_cast_order, COUNT(DISTINCT MK.keyword_id) AS number_of_keywords, COUNT(DISTINCT ML.link_type_id) AS number_of_link_types, SUM(CASE WHEN AT.episode_nr IS NOT NULL THEN 1 ELSE 0 END) AS total_episodes FROM aka_title AT JOIN movie_keyword MK ON AT.movie_id = MK.movie_id JOIN movie_link ML ON AT.movie_id = ML.movie_id JOIN cast_info CI ON AT.movie_id = CI.movie_id JOIN company_type CT ON AT.kind_id = CT.id JOIN info_type IT ON MK.keyword_id = IT.id WHERE AT.production_year BETWEEN 2000 AND 2020 AND CT.kind = 'production' AND IT.info LIKE '%genre%' GROUP BY AT.production_year, CT.kind, IT.info ORDER BY AT.production_year, number_of_keywords DESC;
SELECT ct.kind AS company_kind, COUNT(DISTINCT an.id) AS number_of_aka_names, AVG(cn.imdb_id) AS average_char_imdb_id, SUM(CASE WHEN lt.id IN (5, 7) THEN 1 ELSE 0 END) AS count_link_type_5_or_7 FROM aka_name an JOIN char_name cn ON an.person_id = cn.id JOIN company_type ct ON ct.kind LIKE '%companies' JOIN link_type lt ON lt.id = an.id % 10 WHERE an.person_id = 2704491 AND an.name IN ('Allaudin', 'McKean, Scott', 'Alles, J.') AND cn.id IN ('99259', '3288', '99679', '23104', '45337') AND ct.kind IN ('special effects companies', 'miscellaneous companies', 'production companies', 'distributors') AND lt.id IN (12, 17, 9, 8, 5, 7) GROUP BY ct.kind;
SELECT kt.kind, COUNT(DISTINCT cn.id) AS num_companies, COUNT(DISTINCT mi.movie_id) AS num_movies, AVG(CAST(mi.info AS NUMERIC)) FILTER (WHERE it1.info = 'rating') AS avg_rating, SUM(CAST(mi.info AS NUMERIC)) FILTER (WHERE it1.info = 'budget') AS total_budget FROM kind_type AS kt JOIN movie_info AS mi ON mi.info_type_id = kt.id JOIN company_name AS cn ON cn.imdb_id = mi.movie_id JOIN movie_info AS it1 ON mi.movie_id = it1.movie_id AND it1.info_type_id = kt.id WHERE kt.id IN ('4', '5', '1') AND kt.kind IN ('episode', 'tv series', 'video game') AND mi.info_type_id IN (SELECT id FROM info_type WHERE info IN ('rating', 'budget')) GROUP BY kt.kind;
SELECT rt.ROLE, COUNT(DISTINCT ci.person_id) AS num_of_people, AVG(ci.nr_order) AS average_order, SUM(CASE WHEN cct.kind = 'complete+verified' THEN 1 ELSE 0 END) AS num_complete_verified, cn.country_code, COUNT(DISTINCT mk.keyword_id) AS num_of_keywords, AVG(CASE WHEN mi.info SIMILAR TO '[0-9]+\.[0-9]' THEN CAST(mi.info AS FLOAT) ELSE NULL END) AS average_info_numeric FROM cast_info ci INNER JOIN role_type rt ON ci.role_id = rt.id LEFT JOIN comp_cast_type cct ON ci.person_role_id = cct.id LEFT JOIN company_name cn ON ci.person_id = cn.imdb_id LEFT JOIN movie_keyword mk ON ci.movie_id = mk.movie_id LEFT JOIN movie_info_idx mi ON ci.movie_id = mi.movie_id WHERE mi.movie_id::VARCHAR LIKE '%19410%' AND mi.info SIMILAR TO '(0|84|349|11\.7)%' AND mk.id IN (1932, 3564, 2558, 997, 3482, 1435) GROUP BY rt.ROLE, cn.country_code ORDER BY num_of_people DESC, average_order ASC;
SELECT rt.ROLE, COUNT(ci.id) AS total_roles, AVG(ci.nr_order) AS average_order, SUM(mc.company_id) AS total_company_involvement FROM cast_info ci JOIN role_type rt ON ci.role_id = rt.id JOIN movie_companies mc ON ci.movie_id = mc.movie_id JOIN char_name cn ON ci.person_id = cn.id JOIN link_type lt ON cn.imdb_id = lt.id WHERE cn.surname_pcode IN ('M252', 'E4253', 'S3626', 'D535', 'K6524', 'P3625') AND cn.md5sum IN ('9e82cce9eed474fa357bbbdcdb9e9f99', '808e4e20a938e31d406296247307a377', '314b308705241e3843cfa0f420a3d71d', '161ebf33e0bbb8c7a20bed4ba04289b5') AND lt.link IN ('alternate language version of', 'spin off', 'referenced in', 'remade as', 'references', 'version of') AND lt.id IN ('17', '8', '6') GROUP BY rt.ROLE ORDER BY total_roles DESC;
SELECT t.title AS movie_title, ct.kind AS company_type, COUNT(DISTINCT cc.id) AS number_of_complete_casts, AVG(t.production_year) AS average_production_year, SUM(CASE WHEN cc.status_id = 1 THEN 1 ELSE 0 END) AS count_completed_casts, MIN(t.production_year) AS earliest_production_year, MAX(t.production_year) AS latest_production_year FROM title AS t JOIN complete_cast AS cc ON t.id = cc.movie_id JOIN company_type AS ct ON ct.kind = 'production companies' JOIN comp_cast_type AS cct ON cc.subject_id = cct.id WHERE t.kind_id = 1 AND cct.kind IN ('complete', 'complete+verified') AND t.production_year BETWEEN 1990 AND 2020 GROUP BY t.title, ct.kind ORDER BY number_of_complete_casts DESC, average_production_year DESC;
SELECT mi_genre.info AS genre, COUNT(DISTINCT mi.movie_id) AS total_movies, AVG(cast_member_count) AS avg_cast_members_per_movie, SUM(company_count) AS total_companies_involved FROM movie_info mi_genre INNER JOIN movie_info mi ON mi.movie_id = mi_genre.movie_id AND mi_genre.info_type_id = 1 LEFT JOIN (SELECT movie_id, COUNT(DISTINCT person_id) AS cast_member_count FROM cast_info GROUP BY movie_id) AS ci_sub ON ci_sub.movie_id = mi.movie_id LEFT JOIN (SELECT movie_id, COUNT(DISTINCT company_id) AS company_count FROM movie_companies GROUP BY movie_id) AS mc_sub ON mc_sub.movie_id = mi.movie_id GROUP BY mi_genre.info ORDER BY total_movies DESC, avg_cast_members_per_movie DESC;
SELECT COUNT(DISTINCT ci.movie_id) AS num_movies, AVG(ci.nr_order) AS avg_cast_position, COUNT(DISTINCT cn.id) AS num_companies, AVG(complete_cast.status_id) AS avg_status_id, SUM(CASE WHEN pi.info_type_id = 19 THEN 1 ELSE 0 END) AS count_info_type_19, SUM(CASE WHEN pi.info_type_id = 20 THEN 1 ELSE 0 END) AS count_info_type_20, COUNT(DISTINCT mk.keyword_id) AS num_keywords FROM cast_info ci JOIN movie_keyword mk ON ci.movie_id = mk.movie_id JOIN company_name cn ON cn.imdb_id = ci.movie_id JOIN complete_cast ON complete_cast.movie_id = ci.movie_id JOIN person_info pi ON pi.person_id = ci.person_id WHERE ci.note NOT LIKE '%(archive footage)%' AND cn.country_code = 'US' AND complete_cast.subject_id = 1 AND (pi.info LIKE '%Stage:%' OR pi.info LIKE '%AIDS%') GROUP BY cn.country_code;
SELECT AVG(t.production_year) AS average_production_year, COUNT(DISTINCT t.id) AS total_movies, COUNT(DISTINCT pi.person_id) AS total_people, SUM(CASE WHEN ct.kind = 'complete+verified' THEN 1 ELSE 0 END) AS complete_verified_casts, COUNT(DISTINCT pi.person_id) FILTER (WHERE pi.note IN ('AJ Addo', 'tina ansah', 'Fan Club President')) AS noted_persons FROM title AS t LEFT JOIN complete_cast AS cc ON t.id = cc.movie_id LEFT JOIN comp_cast_type AS ct ON cc.status_id = ct.id LEFT JOIN role_type AS rt ON cc.subject_id = rt.id LEFT JOIN person_info AS pi ON pi.person_id = t.id WHERE t.kind_id = 1 AND t.production_year BETWEEN 1990 AND 2005 AND (ct.id IN (2, 1, 4, 3) OR ct.id IS NULL) AND (pi.person_id IN (904, 1963, 736, 1740234, 1741102) OR pi.person_id IS NULL) GROUP BY t.kind_id;
SELECT kt.kind AS movie_kind, AVG(mk.keyword_id) AS average_keyword_id, COUNT(DISTINCT mc.movie_id) AS number_of_movies, COUNT(DISTINCT cn.id) AS number_of_companies_involved, SUM(CASE WHEN cct.kind = 'crew' THEN 1 ELSE 0 END) AS total_crew_companies, MAX(cn.name) AS largest_company_name FROM movie_keyword AS mk JOIN movie_companies AS mc ON mk.movie_id = mc.movie_id JOIN company_name AS cn ON mc.company_id = cn.id JOIN comp_cast_type AS cct ON mc.company_type_id = cct.id JOIN movie_link AS ml ON mk.movie_id = ml.movie_id JOIN kind_type AS kt ON ml.link_type_id = kt.id WHERE ml.link_type_id IN ('7', '8') AND cct.id IN ('2', '1', '4', '3') GROUP BY kt.kind ORDER BY number_of_movies DESC, average_keyword_id;
SELECT mc.company_id, COUNT(DISTINCT mc.movie_id) AS number_of_movies, cs.status_id, AVG(CAST(pi.info AS FLOAT)) FILTER (WHERE pi.info_type_id = 10) AS average_rating FROM movie_companies AS mc JOIN complete_cast AS cs ON mc.movie_id = cs.movie_id JOIN person_info AS pi ON cs.subject_id = pi.person_id GROUP BY mc.company_id, cs.status_id ORDER BY number_of_movies DESC, average_rating DESC;
SELECT n.name AS actor_name, COUNT(ci.person_id) AS total_movies, AVG(t.production_year) AS average_production_year, SUM(CASE WHEN ct.kind = 'distributors' THEN 1 ELSE 0 END) AS total_distributions, COUNT(DISTINCT k.id) AS unique_keywords_used FROM name AS n JOIN cast_info AS ci ON n.id = ci.person_id JOIN title AS t ON ci.movie_id = t.id JOIN movie_companies AS mc ON t.id = mc.movie_id JOIN company_type AS ct ON mc.company_type_id = ct.id LEFT JOIN keyword AS k ON t.id = k.id WHERE n.name IN ('Anderson, Adisa', 'Amer, Hammomi', 'Anderson, Franklyn J.') GROUP BY n.name ORDER BY total_movies DESC, average_production_year DESC;
SELECT rt.ROLE as role_type, COUNT(DISTINCT ci.person_id) as num_people, AVG(ci.nr_order) as average_order, SUM(CASE WHEN lt.link = 'referenced in' THEN 1 ELSE 0 END) as num_referenced_in, COUNT(DISTINCT cc.subject_id) as num_unique_subjects FROM cast_info ci JOIN role_type rt ON ci.role_id = rt.id LEFT JOIN complete_cast cc ON ci.movie_id = cc.movie_id LEFT JOIN link_type lt ON lt.id = cc.status_id WHERE rt.ROLE IN ('actress', 'writer') AND (lt.link = 'referenced in' OR lt.link = 'edited from') GROUP BY rt.ROLE ORDER BY num_people DESC;
SELECT link_type.LINK AS link_type, COUNT(DISTINCT movie_link.movie_id) AS total_movies, AVG(aka_title.production_year) AS average_production_year, SUM(CASE WHEN aka_title.kind_id = 1 THEN 1 ELSE 0 END) AS total_full_length_movies, COUNT(DISTINCT company_name.id) AS total_different_companies, COUNT(DISTINCT movie_companies.company_type_id) AS total_company_types, MAX(aka_title.season_nr) AS max_season_number, MIN(aka_title.episode_nr) AS min_episode_number, COUNT(DISTINCT info_type.id) AS total_info_types FROM movie_link JOIN link_type ON movie_link.link_type_id = link_type.id JOIN aka_title ON movie_link.movie_id = aka_title.movie_id JOIN movie_companies ON aka_title.movie_id = movie_companies.movie_id JOIN company_name ON movie_companies.company_id = company_name.id JOIN info_type ON 1=1 WHERE link_type.LINK IN ('features', 'alternate language version of', 'featured in', 'edited into', 'remade as') AND aka_title.kind_id IN (1, 4, 3, 7, 2, 6) AND aka_title.md5sum IN ('1b81d95ddc7a645727ec6e01c28ec5be', 'de1cedb89a8eeb93cc5cba31a251e0f8', 'b4e6ea5bd996a24faacd0571b2f495dd') AND company_name.country_code = '[tr]' GROUP BY link_type.LINK;
SELECT kt.kind, COUNT(DISTINCT mk.movie_id) AS total_movies, COUNT(DISTINCT mk.keyword_id) AS unique_keywords, AVG(subquery.avg_keyword_count) AS average_keywords_per_movie FROM kind_type kt JOIN movie_keyword mk ON mk.movie_id = kt.id JOIN (SELECT movie_id, AVG(keyword_count) AS avg_keyword_count FROM (SELECT movie_id, COUNT(keyword_id) AS keyword_count FROM movie_keyword GROUP BY movie_id) AS sub GROUP BY movie_id) AS subquery ON subquery.movie_id = mk.movie_id WHERE kt.id IN (4, 3, 7) AND mk.keyword_id = 1463 GROUP BY kt.kind;
SELECT COUNT(DISTINCT t.id) AS total_movies, AVG(t.production_year) AS average_production_year, COUNT(DISTINCT k.id) AS total_keywords, COUNT(DISTINCT p.person_id) AS total_persons_involved, COUNT(DISTINCT c.company_id) AS total_companies_involved, SUM(CASE WHEN k.keyword = 'sherlock-holmes' THEN 1 ELSE 0 END) AS sherlock_holmes_keyword_count, MAX(t.production_year) AS latest_movie_year, MIN(t.production_year) AS oldest_movie_year FROM title AS t JOIN movie_companies AS c ON t.id = c.movie_id JOIN complete_cast AS cc ON t.id = cc.movie_id JOIN keyword AS k ON k.id = ANY(ARRAY[4287, 1968]) JOIN person_info AS p ON p.info_type_id = ANY(ARRAY[34, 28, 32, 33]) JOIN link_type AS lt ON lt.id = ANY(ARRAY[4821, 4781, 1175]) AND lt.link IN ('spoofs', 'featured in', 'edited from') WHERE t.kind_id != 0 GROUP BY t.kind_id;
SELECT kt.kind AS movie_kind, AVG(t.production_year) AS avg_production_year, SUM(CASE WHEN rt.role = 'actress' THEN 1 ELSE 0 END) AS total_actress_roles, SUM(CASE WHEN rt.role = 'producer' THEN 1 ELSE 0 END) AS total_producer_roles, COUNT(DISTINCT mc.company_id) AS number_of_companies_involved FROM title AS t JOIN kind_type AS kt ON t.kind_id = kt.id LEFT JOIN movie_companies AS mc ON t.id = mc.movie_id LEFT JOIN movie_info AS mi ON t.id = mi.movie_id LEFT JOIN role_type AS rt ON mi.info_type_id = rt.id AND rt.role IN ('actress', 'producer') GROUP BY kt.kind ORDER BY number_of_companies_involved DESC, avg_production_year;
SELECT AVG(at.production_year) AS avg_production_year, COUNT(DISTINCT at.movie_id) AS total_movies, SUM(CASE WHEN mc.company_type_id = 2 THEN 1 ELSE 0 END) AS total_distributors, COUNT(DISTINCT pi.person_id) AS total_people, AVG(CASE WHEN pi.info_type_id = 17 THEN CAST(pi.info AS INTEGER) ELSE NULL END) AS avg_salary FROM movie_companies mc JOIN aka_title at ON mc.movie_id = at.movie_id JOIN person_info pi ON mc.movie_id = pi.person_id JOIN keyword k ON at.id = k.id WHERE mc.company_id IN (643, 838, 877) AND pi.info_type_id IN (17, 25, 35, 28, 26) AND at.kind_id IN (SELECT id FROM comp_cast_type WHERE kind IN ('complete+verified', 'cast', 'crew', 'complete')) AND k.id IN (2792, 548, 6394, 3958) GROUP BY mc.company_type_id;
