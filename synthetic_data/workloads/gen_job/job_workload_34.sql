SELECT ct.kind AS company_kind, COUNT(DISTINCT mc.movie_id) AS number_of_movies, AVG(CAST(mi_idx.info AS numeric)) AS average_rating, SUM(CASE WHEN cct.kind = 'complete+verified' THEN 1 ELSE 0 END) AS complete_verified_casts, COUNT(DISTINCT cn.id) AS number_of_actors FROM movie_companies AS mc JOIN company_type AS ct ON mc.company_type_id = ct.id LEFT JOIN movie_info_idx AS mi_idx ON mc.movie_id = mi_idx.movie_id LEFT JOIN complete_cast AS cc ON mc.movie_id = cc.movie_id LEFT JOIN comp_cast_type AS cct ON cc.status_id = cct.id LEFT JOIN char_name AS cn ON cc.subject_id = cn.id WHERE mc.movie_id IN (27359, 1639517, 1663098) AND mc.company_id IN (SELECT company_id FROM movie_companies WHERE company_type_id IN (1, 2)) GROUP BY ct.kind HAVING COUNT(DISTINCT mc.movie_id) > 1 ORDER BY number_of_movies DESC, average_rating DESC;
SELECT mi_genre.info AS genre, COUNT(DISTINCT mi.movie_id) AS total_movies, AVG(cast_member_count) AS avg_cast_members_per_movie, SUM(company_count) AS total_companies_involved FROM movie_info mi_genre INNER JOIN movie_info mi ON mi.movie_id = mi_genre.movie_id AND mi_genre.info_type_id = 1 LEFT JOIN (SELECT movie_id, COUNT(DISTINCT person_id) AS cast_member_count FROM cast_info GROUP BY movie_id) AS ci_sub ON ci_sub.movie_id = mi.movie_id LEFT JOIN (SELECT movie_id, COUNT(DISTINCT company_id) AS company_count FROM movie_companies GROUP BY movie_id) AS mc_sub ON mc_sub.movie_id = mi.movie_id GROUP BY mi_genre.info ORDER BY total_movies DESC, avg_cast_members_per_movie DESC;
SELECT AVG(keyword_summary.keyword_count) AS average_movie_keywords, SUM(role_summary.total_roles) AS sum_total_roles, COUNT(DISTINCT cct.kind) AS distinct_cast_types, AVG(CAST(mi_idx.info AS integer)) AS average_movie_votes FROM (SELECT mk.movie_id, COUNT(mk.keyword_id) AS keyword_count FROM movie_keyword AS mk GROUP BY mk.movie_id) AS keyword_summary JOIN (SELECT ci.movie_id, ci.person_role_id, COUNT(ci.id) AS total_roles FROM cast_info AS ci GROUP BY ci.movie_id, ci.person_role_id) AS role_summary ON keyword_summary.movie_id = role_summary.movie_id JOIN movie_info_idx AS mi_idx ON keyword_summary.movie_id = mi_idx.movie_id AND mi_idx.info_type_id = 1 JOIN comp_cast_type AS cct ON role_summary.person_role_id = cct.id WHERE CAST(mi_idx.info AS integer) > 10000 GROUP BY mi_idx.info_type_id;
SELECT lt.LINK AS link_type, COUNT(DISTINCT cc.movie_id) AS num_movies, AVG(mi.info_type_id) AS avg_info_type_id, SUM(CASE WHEN mi.info = 'Spanish' THEN 1 ELSE 0 END) AS num_spanish_movies, SUM(CASE WHEN mi.info = 'Kazakh' THEN 1 ELSE 0 END) AS num_kazakh_movies, SUM(CASE WHEN mi.info = 'Hebrew' THEN 1 ELSE 0 END) AS num_hebrew_movies, COUNT(DISTINCT pi.person_id) AS num_people, AVG(pi.info_type_id) AS avg_person_info_type_id FROM link_type lt LEFT JOIN complete_cast cc ON lt.id = cc.status_id LEFT JOIN movie_info mi ON cc.movie_id = mi.movie_id LEFT JOIN person_info pi ON cc.subject_id = pi.person_id WHERE cc.status_id IN (3, 4) AND mi.id IN (7269695, 7270501) GROUP BY lt.LINK;
SELECT AVG(mc.movie_id) AS average_movie_id, COUNT(DISTINCT cn.id) AS number_of_companies, SUM(CASE WHEN mi.info_type_id = 4 THEN 1 ELSE 0 END) AS info_type_count, cct.kind AS cast_type_kind, COUNT(DISTINCT k.id) AS unique_keywords_used, MAX(cn.name) AS largest_company_name FROM movie_companies AS mc JOIN company_name AS cn ON mc.company_id = cn.id JOIN company_type AS ct ON mc.company_type_id = ct.id JOIN comp_cast_type AS cct ON mc.company_type_id = cct.id JOIN movie_info AS mi ON mc.movie_id = mi.movie_id JOIN keyword AS k ON mi.info = k.keyword WHERE cn.country_code = '[py]' AND (mi.info = 'Urdu' OR mi.info = 'Turkish' OR mi.info = 'Vietnamese' OR mi.info = 'Estonian') AND (cct.kind = 'complete+verified' OR cct.kind = 'cast' OR cct.kind = 'crew' OR cct.kind = 'complete') AND (k.id IN (2454, 1707, 7050, 8101)) GROUP BY cct.kind;
SELECT ct.kind AS company_type, AVG(t.production_year) AS average_production_year, COUNT(DISTINCT t.id) AS number_of_titles, SUM(CASE WHEN t.kind_id = 3 THEN 1 ELSE 0 END) AS number_of_distributors_titles, SUM(CASE WHEN t.kind_id = 4 THEN 1 ELSE 0 END) AS number_of_special_effects_titles FROM title AS t JOIN company_type AS ct ON t.kind_id = ct.id GROUP BY ct.kind HAVING COUNT(DISTINCT t.id) > 0 ORDER BY number_of_titles DESC;
SELECT kt.kind AS kind_of_movie, AVG(mi_idx.info::NUMERIC) AS average_rating, COUNT(DISTINCT t.id) AS number_of_movies, SUM(CASE WHEN mi.info = 'color' THEN 1 ELSE 0 END) AS number_of_color_movies, SUM(CASE WHEN mi.info = 'black and white' THEN 1 ELSE 0 END) AS number_of_black_and_white_movies, COUNT(DISTINCT mk.keyword_id) AS number_of_unique_keywords FROM title AS t JOIN kind_type AS kt ON t.kind_id = kt.id JOIN movie_info AS mi ON t.id = mi.movie_id JOIN movie_info_idx AS mi_idx ON t.id = mi_idx.movie_id JOIN movie_keyword AS mk ON t.id = mk.movie_id WHERE t.production_year IN (1976, 1989, 1952, 1990, 1959, 1967) AND mi.info_type_id IN (SELECT id FROM info_type WHERE info IN ('color', 'black and white')) AND mi_idx.info_type_id = (SELECT id FROM info_type WHERE info = 'rating') GROUP BY kt.kind ORDER BY average_rating DESC;
SELECT kt.kind AS movie_kind, AVG(t.production_year) AS average_production_year, COUNT(DISTINCT an.person_id) AS unique_actors_with_alternate_names, COUNT(DISTINCT cn.id) AS number_of_companies, SUM(CASE WHEN t.production_year > 2000 THEN 1 ELSE 0 END) AS movies_produced_after_2000 FROM aka_name an INNER JOIN name n ON an.person_id = n.id INNER JOIN aka_title at ON n.id = at.movie_id INNER JOIN title t ON at.movie_id = t.id INNER JOIN kind_type kt ON t.kind_id = kt.id INNER JOIN company_name cn ON t.id = cn.imdb_id LEFT JOIN char_name chn ON an.person_id = chn.id WHERE (chn.name = 'Clarkson' OR chn.name = 'Miguelito' OR chn.name = 'Basket coach') GROUP BY kt.kind;
SELECT it.info AS info_type, COUNT(DISTINCT cn.id) AS unique_character_names, AVG(cn.imdb_id) AS average_imdb_id, SUM(CASE WHEN cc.status_id = '4' THEN 1 ELSE 0 END) AS count_complete_status, SUM(CASE WHEN cc.status_id = '3' THEN 1 ELSE 0 END) AS count_incomplete_status, COUNT(DISTINCT lt.id) AS count_link_types FROM char_name AS cn JOIN complete_cast AS cc ON cn.id = cc.movie_id JOIN info_type AS it ON it.id = cn.imdb_index::integer JOIN link_type AS lt ON lt.id = cn.surname_pcode::integer WHERE cn.imdb_index IN ('10', '21') AND lt.id IN (13, 8, 5, 18) AND cc.status_id IN ('4', '3') GROUP BY it.info;
SELECT ct.kind AS company_type, AVG(kw.id) AS average_keyword_id, COUNT(DISTINCT mc.movie_id) AS total_movies, SUM(mc.company_id) AS sum_company_id FROM movie_companies mc JOIN company_type ct ON mc.company_type_id = ct.id JOIN movie_link ml ON mc.movie_id = ml.movie_id JOIN keyword kw ON CAST(ml.link_type_id AS INTEGER) = kw.id JOIN name n ON mc.movie_id = n.id WHERE n.gender = 'm' AND kw.keyword IN ('Black Rick', 'Joel Gonzalez', 'TNI Soldier', 'ESPN', 'Newsroom Martian') GROUP BY ct.kind ORDER BY total_movies DESC, average_keyword_id;
SELECT AVG(at.production_year) AS avg_production_year, COUNT(DISTINCT at.movie_id) AS total_movies, SUM(CASE WHEN mc.company_type_id = 2 THEN 1 ELSE 0 END) AS total_distributors, COUNT(DISTINCT pi.person_id) AS total_people, AVG(CASE WHEN pi.info_type_id = 17 THEN CAST(pi.info AS INTEGER) ELSE NULL END) AS avg_salary FROM movie_companies mc JOIN aka_title at ON mc.movie_id = at.movie_id JOIN person_info pi ON mc.movie_id = pi.person_id JOIN keyword k ON at.id = k.id WHERE mc.company_id IN (643, 838, 877) AND pi.info_type_id IN (17, 25, 35, 28, 26) AND at.kind_id IN (SELECT id FROM comp_cast_type WHERE kind IN ('complete+verified', 'cast', 'crew', 'complete')) AND k.id IN (2792, 548, 6394, 3958) GROUP BY mc.company_type_id;
SELECT akn.surname_pcode, COUNT(DISTINCT akn.person_id) AS number_of_people_with_surname, AVG(cast_tbl.status_id) AS average_status_id, SUM(CASE WHEN mk.keyword_id IS NOT NULL THEN 1 ELSE 0 END) AS total_movies_with_keywords, COUNT(DISTINCT mk.movie_id) AS unique_movie_count FROM aka_name akn LEFT JOIN complete_cast cast_tbl ON akn.person_id = cast_tbl.subject_id LEFT JOIN movie_keyword mk ON cast_tbl.movie_id = mk.movie_id WHERE cast_tbl.status_id = 4 AND akn.surname_pcode IN ('P245', 'F25', 'A126', 'F6') GROUP BY akn.surname_pcode ORDER BY number_of_people_with_surname DESC;
SELECT AVG(CASE WHEN mc.company_type_id = 1 THEN mi_box_office.info::NUMERIC ELSE NULL END) AS avg_box_office_producer, AVG(CASE WHEN mc.company_type_id = 2 THEN mi_box_office.info::NUMERIC ELSE NULL END) AS avg_box_office_distributor, COUNT(DISTINCT mc.movie_id) FILTER (WHERE mc.company_type_id = 1) AS num_movies_produced, COUNT(DISTINCT mc.movie_id) FILTER (WHERE mc.company_type_id = 2) AS num_movies_distributed, COUNT(DISTINCT cn.id) AS num_companies, COUNT(DISTINCT an.person_id) AS num_persons_with_aka FROM movie_companies mc JOIN company_name cn ON mc.company_id = cn.id JOIN movie_info mi_box_office ON mc.movie_id = mi_box_office.movie_id AND mi_box_office.info_type_id = 107 LEFT JOIN aka_name an ON cn.id = an.person_id WHERE cn.country_code = 'US' AND mi_box_office.info ~ '^\d+$' GROUP BY cn.country_code;
SELECT lt.LINK AS link_type, COUNT(ml.movie_id) AS total_movies, AVG(mi_idx.info::numeric) AS average_rating, SUM(CASE WHEN p.info = 'actor' THEN 1 ELSE 0 END) AS total_actors, SUM(CASE WHEN p.info = 'director' THEN 1 ELSE 0 END) AS total_directors FROM movie_link AS ml JOIN link_type AS lt ON ml.link_type_id = lt.id JOIN movie_info AS mi ON ml.movie_id = mi.movie_id JOIN movie_info AS mi_idx ON ml.movie_id = mi_idx.movie_id AND mi_idx.info_type_id = 101 JOIN person_info AS p ON ml.movie_id = p.person_id WHERE lt.id IN (9, 3, 18, 8, 15) AND mi.info_type_id = 3 AND ml.linked_movie_id = 2439274 AND p.info IN ('actor', 'director') GROUP BY lt.LINK ORDER BY total_movies DESC, average_rating DESC;
