SELECT ct.kind AS company_kind, COUNT(DISTINCT cc.id) AS total_complete_casts, COUNT(DISTINCT ml.id) AS total_movie_links, AVG(cc.status_id) AS average_status_id, SUM(CASE WHEN cc.subject_id = 1 THEN 1 ELSE 0 END) AS subject_1_cast_count FROM company_type ct LEFT JOIN complete_cast cc ON cc.subject_id = ct.id LEFT JOIN movie_link ml ON ml.movie_id = cc.movie_id GROUP BY ct.kind ORDER BY total_complete_casts DESC;
SELECT ct.kind AS company_type, COUNT(DISTINCT mc.movie_id) AS total_movies, AVG(at.production_year) AS average_production_year, SUM(CASE WHEN at.season_nr IN ('6', '22', '9', '1') THEN 1 ELSE 0 END) AS total_seasonal_titles, COUNT(DISTINCT ml.movie_id) AS total_movies_with_links, COUNT(DISTINCT pi.person_id) AS total_people_with_info FROM company_type AS ct JOIN movie_companies AS mc ON ct.id = mc.company_type_id LEFT JOIN aka_title AS at ON mc.movie_id = at.movie_id LEFT JOIN movie_link AS ml ON mc.movie_id = ml.movie_id LEFT JOIN person_info AS pi ON pi.person_id = mc.movie_id WHERE ct.kind IN ('special effects companies', 'miscellaneous companies', 'production companies', 'distributors') GROUP BY ct.kind ORDER BY total_movies DESC;
SELECT kt.kind AS content_type, COUNT(*) AS total_titles, AVG(cn.imdb_id) AS average_imdb_id, COUNT(DISTINCT cn.country_code) AS unique_country_codes, SUM(CASE WHEN an.imdb_index = 'I' THEN 1 ELSE 0 END) AS count_primary_aka_names FROM kind_type AS kt JOIN company_name AS cn ON cn.id = kt.id LEFT JOIN aka_name AS an ON an.person_id = cn.id WHERE kt.id IN ('4', '3', '5', '6', '1', '2') GROUP BY kt.kind ORDER BY total_titles DESC;
SELECT it.info AS cast_completeness, COUNT(DISTINCT cc.movie_id) AS number_of_movies, AVG(ci.person_count) AS average_roles_per_person FROM (SELECT movie_id, COUNT(DISTINCT person_id) AS person_count FROM cast_info GROUP BY movie_id) ci JOIN complete_cast cc ON ci.movie_id = cc.movie_id JOIN info_type it ON cc.status_id = it.id GROUP BY it.info;
SELECT kt.kind AS movie_kind, AVG(akat.production_year) AS average_production_year, COUNT(DISTINCT cn.id) AS number_of_actors, COUNT(DISTINCT kn.id) AS number_of_keywords, SUM(CASE WHEN cn.name LIKE 'A%' THEN 1 ELSE 0 END) AS actors_starting_with_a, COUNT(DISTINCT cmn.id) AS number_of_companies, MAX(akat.episode_nr) AS max_episode_number FROM aka_title akat JOIN kind_type kt ON akat.kind_id = kt.id LEFT JOIN complete_cast cc ON akat.movie_id = cc.movie_id LEFT JOIN char_name cn ON cn.id = cc.subject_id LEFT JOIN movie_keyword mk ON akat.movie_id = mk.movie_id LEFT JOIN keyword kn ON mk.keyword_id = kn.id AND kn.phonetic_code IN ('D525', 'G6431', 'T2623', 'S1425', 'M4165', 'G5123') LEFT JOIN movie_companies mc ON akat.movie_id = mc.movie_id LEFT JOIN company_name cmn ON mc.company_id = cmn.id WHERE akat.production_year >= 2000 GROUP BY kt.kind
SELECT MIN(t.title) AS movie_title, AVG(t.production_year) AS average_production_year, COUNT(DISTINCT n.id) AS total_actors, SUM(CASE WHEN pi.info = 'New Kensington, Pennsylvania, USA' THEN 1 ELSE 0 END) AS actors_from_new_kensington, COUNT(DISTINCT k.id) AS total_keywords_used FROM title AS t JOIN complete_cast AS cc ON t.id = cc.movie_id JOIN name AS n ON cc.subject_id = n.id JOIN person_info AS pi ON n.id = pi.person_id JOIN keyword AS k ON k.phonetic_code = t.phonetic_code WHERE t.imdb_index IN ('V', 'I', 'II') AND n.surname_pcode IN ('A434', 'A414') AND pi.info IN ('New Kensington, Pennsylvania, USA', '5'' 6"', 'Czech Republic') AND pi.note IN ('Bobbie Merritt/THE ENTERTAINMENT GROUP', 'Be Free Films', 'isabelleadriani@yahoo.it', 'Autor', 'Quincy Johnson', 'MSC') GROUP BY t.id;
SELECT AVG(at.production_year) AS average_production_year, COUNT(DISTINCT at.movie_id) AS total_unique_movies, SUM(CASE WHEN at.kind_id = 1 THEN 1 ELSE 0 END) AS total_regular_movies, SUM(CASE WHEN at.kind_id > 1 THEN 1 ELSE 0 END) AS total_special_movies, COUNT(DISTINCT cn.id) AS total_unique_characters, MAX(pi.info) AS most_recent_person_info FROM aka_title AS at JOIN movie_info AS mi ON at.movie_id = mi.movie_id JOIN complete_cast AS cc ON at.movie_id = cc.movie_id JOIN char_name AS cn ON cn.id = cc.subject_id JOIN person_info AS pi ON pi.person_id = cn.id WHERE at.phonetic_code = 'D35' AND at.imdb_index IN ('III', 'IV', 'I', 'II') AND pi.id IN ('1502', '3072', '4836') AND pi.person_id IN ('2127', '823', '3169', '4061999') AND mi.movie_id IN ('927236', '926899', '924318') AND mi.note IN ('(only a few lines)', '(interviews)') AND EXISTS ( SELECT 1 FROM link_type AS lt WHERE lt.id IN ('14', '10') AND lt.link = 'unknown link' ) GROUP BY at.kind_id;
SELECT lt.LINK AS link_type, COUNT(ml.id) AS total_movie_links, AVG(pi.person_id) AS average_person_id, SUM(cc.status_id) AS sum_status_id FROM movie_link AS ml JOIN link_type AS lt ON ml.link_type_id = lt.id JOIN complete_cast AS cc ON ml.movie_id = cc.movie_id JOIN person_info AS pi ON cc.subject_id = pi.person_id WHERE ml.link_type_id IN (6, 5, 15, 16, 10, 17) AND ml.id IN (3372, 310) AND cc.id = 2124 GROUP BY lt.LINK ORDER BY total_movie_links DESC;
SELECT AVG(CAST(mi.info AS NUMERIC)) AS average_rating, COUNT(DISTINCT ci.movie_id) AS number_of_movies, SUM(CASE WHEN k.keyword = 'sugar' THEN 1 ELSE 0 END) AS sugar_keyword_count, SUM(CASE WHEN k.keyword = 'chair' THEN 1 ELSE 0 END) AS chair_keyword_count, COUNT(DISTINCT akn.person_id) AS unique_actors_with_alternate_names, MAX(mi.note) AS longest_note FROM movie_info mi JOIN info_type it ON mi.info_type_id = it.id AND it.info = 'rating' JOIN cast_info ci ON mi.movie_id = ci.movie_id JOIN movie_keyword mk ON ci.movie_id = mk.movie_id JOIN keyword k ON mk.keyword_id = k.id AND k.id IN ('5046', '3865') LEFT JOIN aka_name akn ON ci.person_id = akn.person_id WHERE mi.movie_id IN (SELECT movie_id FROM movie_keyword WHERE keyword_id IN ('5046', '3865')) GROUP BY it.info;
SELECT kt.kind AS movie_kind, MIN(t.title) AS movie_title, AVG(t.production_year) AS average_production_year, COUNT(DISTINCT ml.movie_id) AS total_linked_movies, COUNT(DISTINCT mi_idx.movie_id) AS total_movies_with_info, SUM(CASE WHEN cc.status_id = 1 THEN 1 ELSE 0 END) AS sum_complete_status FROM title AS t INNER JOIN kind_type AS kt ON t.kind_id = kt.id LEFT JOIN movie_link AS ml ON t.id = ml.movie_id LEFT JOIN movie_info_idx AS mi_idx ON t.id = mi_idx.movie_id LEFT JOIN complete_cast AS cc ON t.id = cc.movie_id GROUP BY kt.kind ORDER BY total_linked_movies DESC;
SELECT ct.kind AS company_type, COUNT(*) AS total_movies, AVG(CAST(mi.info AS FLOAT)) FILTER (WHERE mi.info_type_id = 101) AS average_rating, SUM(CASE WHEN ml.link_type_id = 1 THEN 1 ELSE 0 END) AS total_prequels, SUM(CASE WHEN ml.link_type_id = 2 THEN 1 ELSE 0 END) AS total_sequels, COUNT(DISTINCT ml.movie_id) FILTER (WHERE ml.linked_movie_id IN (10496, 260662, 2464253, 553702, 58480, 2087155)) AS movies_with_specific_links FROM company_type ct JOIN movie_info mi ON mi.info ~ ct.kind JOIN movie_link ml ON mi.movie_id = ml.movie_id GROUP BY ct.kind ORDER BY total_movies DESC;
SELECT AVG(CASE WHEN mc.company_type_id = 1 THEN mi_box_office.info::NUMERIC ELSE NULL END) AS avg_box_office_producer, AVG(CASE WHEN mc.company_type_id = 2 THEN mi_box_office.info::NUMERIC ELSE NULL END) AS avg_box_office_distributor, COUNT(DISTINCT mc.movie_id) FILTER (WHERE mc.company_type_id = 1) AS num_movies_produced, COUNT(DISTINCT mc.movie_id) FILTER (WHERE mc.company_type_id = 2) AS num_movies_distributed, COUNT(DISTINCT cn.id) AS num_companies, COUNT(DISTINCT an.person_id) AS num_persons_with_aka FROM movie_companies mc JOIN company_name cn ON mc.company_id = cn.id JOIN movie_info mi_box_office ON mc.movie_id = mi_box_office.movie_id AND mi_box_office.info_type_id = 107 LEFT JOIN aka_name an ON cn.id = an.person_id WHERE cn.country_code = 'US' AND mi_box_office.info ~ '^\d+$' GROUP BY cn.country_code;
SELECT i.info AS genre, COUNT(DISTINCT k.keyword) AS number_of_keywords, AVG(m.production_year) AS average_production_year, SUM(CASE WHEN n.gender = 'M' THEN 1 ELSE 0 END) AS number_of_male_actors, SUM(CASE WHEN n.gender = 'F' THEN 1 ELSE 0 END) AS number_of_female_actors FROM movie_link AS ml JOIN keyword AS k ON ml.movie_id = k.id JOIN aka_title AS m ON ml.movie_id = m.movie_id JOIN name AS n ON n.surname_pcode = m.phonetic_code JOIN person_info AS pi ON pi.person_id = n.id AND pi.info_type_id IN ('21', '24', '35', '17', '27') JOIN info_type AS i ON pi.info_type_id = i.id WHERE ml.linked_movie_id IN ('1928558', '571140', '1683460', '1635656', '1308096') AND ml.movie_id IN ('11141', '2036', '14524', '6636') AND n.surname_pcode IN ('A426', 'A436', 'A465', 'A453') GROUP BY i.info;
SELECT COUNT(DISTINCT t.id) AS number_of_movies, AVG(t.production_year) AS average_production_year, SUM(CASE WHEN at.episode_of_id IS NOT NULL THEN 1 ELSE 0 END) AS number_of_episodes, it.info AS info_type_description, COUNT(DISTINCT an.person_id) AS number_of_actors, COUNT(DISTINCT at.movie_id) AS number_of_aka_titles FROM title AS t LEFT JOIN aka_title AS at ON t.id = at.movie_id LEFT JOIN movie_info_idx AS mi_idx ON t.id = mi_idx.movie_id LEFT JOIN info_type AS it ON mi_idx.info_type_id = it.id LEFT JOIN aka_name AS an ON an.id = mi_idx.movie_id WHERE t.production_year BETWEEN 1990 AND 2020 AND (mi_idx.info_type_id IN (100, 101, 99) OR mi_idx.info IS NOT NULL) AND (at.episode_of_id IN (24960, 8508, 3016, 7633) OR at.episode_of_id IS NULL) AND an.surname_pcode IN ('T653', 'E164', 'H56', 'A526') GROUP BY it.info;
SELECT AVG(a.production_year) AS average_production_year, COUNT(DISTINCT l.id) AS total_link_types, COUNT(DISTINCT a.id) AS total_aka_titles, SUM(CASE WHEN a.episode_nr = 23 THEN 1 ELSE 0 END) AS count_episode_23, SUM(CASE WHEN a.episode_nr = 2 THEN 1 ELSE 0 END) AS count_episode_2, SUM(CASE WHEN a.episode_nr = 198 THEN 1 ELSE 0 END) AS count_episode_198 FROM aka_title AS a JOIN comp_cast_type AS c ON a.kind_id = c.id JOIN link_type AS l ON a.id = l.id WHERE a.production_year IS NOT NULL AND a.md5sum IN ('fb468fe5a2dd6cbadb547cbfcc31fe6e', 'aebc712f90712d70c4098b641cecc92c', 'f13da07aa2abf77454bb4a2209a5fc0d') GROUP BY a.kind_id;
SELECT COUNT(DISTINCT ci.id) AS total_cast_members, AVG(ci.nr_order) AS average_cast_order, COUNT(DISTINCT mk.id) AS total_movie_keywords, MAX(t.production_year) AS latest_production_year, MIN(t.production_year) AS earliest_production_year, AVG(t.production_year) AS average_production_year, COUNT(DISTINCT mi.id) AS total_movie_info_records, ct.kind AS company_kind, COUNT(DISTINCT n.id) AS total_people FROM cast_info ci JOIN movie_keyword mk ON ci.movie_id = mk.movie_id JOIN title t ON ci.movie_id = t.id JOIN movie_info mi ON mi.movie_id = t.id JOIN company_type ct ON ct.id = mi.info_type_id JOIN name n ON n.id = ci.person_id WHERE ci.role_id = 1 AND ct.kind IN ('special effects companies', 'miscellaneous companies', 'production companies', 'distributors') AND ci.nr_order IN (36, 47, 23, 39) AND mk.movie_id IN (14906, 12662, 17516, 17625) GROUP BY ct.kind ORDER BY total_movie_keywords DESC;
SELECT AVG(at.production_year) AS average_production_year, COUNT(DISTINCT mk.movie_id) AS number_of_unique_movies, SUM(CASE WHEN at.kind_id = 1 THEN 1 ELSE 0 END) AS number_of_feature_films, COUNT(DISTINCT mi.id) AS total_movie_info_records FROM aka_title at JOIN movie_keyword mk ON at.movie_id = mk.movie_id JOIN movie_info mi ON at.movie_id = mi.movie_id WHERE mi.info_type_id = 4 AND at.production_year IS NOT NULL GROUP BY at.kind_id ORDER BY average_production_year DESC;
SELECT kt.kind AS movie_kind, COUNT(DISTINCT n.id) AS number_of_actors, AVG(mi.info::numeric) AS average_movie_length, SUM(CASE WHEN n.gender = 'm' THEN 1 ELSE 0 END) AS male_actors_count, SUM(CASE WHEN n.gender != 'm' THEN 1 ELSE 0 END) AS non_male_actors_count, MAX(cn.name) AS biggest_production_company, COUNT(DISTINCT mk.keyword_id) AS unique_keyword_count FROM movie_info mi JOIN movie_companies mc ON mi.movie_id = mc.movie_id JOIN kind_type kt ON kt.id = mi.info_type_id JOIN movie_keyword mk ON mk.movie_id = mi.movie_id JOIN company_name cn ON cn.id = mc.company_id JOIN name n ON n.imdb_id = mc.company_id WHERE mi.info_type_id = 3 AND kt.kind IN ('movie', 'tv') AND cn.country_code IN ('[us]', '[uk]') AND mi.note NOT LIKE '%(English Subtitles)%' GROUP BY kt.kind ORDER BY average_movie_length DESC;
SELECT COUNT(DISTINCT mc.movie_id) AS number_of_movies, AVG(t.production_year) AS average_production_year, SUM(CASE WHEN t.series_years LIKE '1990-1991' THEN 1 ELSE 0 END) AS count_1990_1991_series, COUNT(DISTINCT k.id) AS unique_keywords, lt.LINK AS link_type, AVG(t.episode_nr) AS average_episode_number FROM movie_companies mc JOIN title t ON mc.movie_id = t.id LEFT JOIN keyword k ON t.id = k.id JOIN link_type lt ON lt.id = mc.company_type_id WHERE t.production_year > 1980 AND (t.series_years LIKE '1990-1991' OR t.series_years LIKE '2005-2006') AND mc.company_id IN (SELECT company_id FROM movie_companies WHERE movie_id = 22464) AND lt.id IN (2, 10) GROUP BY lt.LINK ORDER BY number_of_movies DESC;
SELECT AVG(pi.id) AS average_person_info_id, COUNT(DISTINCT an.person_id) AS unique_aka_person_count, COUNT(DISTINCT lt.id) AS link_type_count, SUM(CASE WHEN an.name IS NOT NULL THEN 1 ELSE 0 END) AS not_null_aka_names, MAX(an.id) AS max_aka_name_id FROM aka_name AS an JOIN person_info AS pi ON an.person_id = pi.person_id JOIN link_type AS lt ON pi.info LIKE '%' || lt.link || '%' GROUP BY an.person_id HAVING COUNT(DISTINCT pi.info_type_id) > 1 ORDER BY unique_aka_person_count DESC, average_person_info_id ASC;
SELECT rt.role, COUNT(DISTINCT akn.person_id) AS distinct_person_count, COUNT(DISTINCT mk.movie_id) AS distinct_movie_count, AVG(LENGTH(akn.name)) AS average_name_length, SUM(CASE WHEN mk.id IN (2147, 3674, 4385, 278, 891, 2589) THEN 1 ELSE 0 END) AS specific_keyword_movie_count FROM role_type rt LEFT JOIN aka_name akn ON rt.id = akn.id LEFT JOIN movie_keyword mk ON mk.movie_id = akn.person_id WHERE rt.role IN ('production designer', 'composer', 'producer', 'cinematographer', 'actor') AND rt.id IN ('6', '4') AND akn.name IN ('Aldave, Damie', 'Alkhovskaya, V.', 'Allen, Flanagan and', 'Allum, Dan', 'Rando, Jesús Alvaide', 'Allen, Eric') AND mk.movie_id IN ('7272', '8946', '15394', '15484', '7641') GROUP BY rt.role;
SELECT kt.kind AS movie_type, COUNT(t.id) AS total_movies, AVG(t.production_year) AS avg_production_year, MIN(t.production_year) AS earliest_production_year, MAX(t.production_year) AS latest_production_year FROM title t JOIN (SELECT id, kind FROM comp_cast_type WHERE kind IN ('director', 'actor')) cct ON t.kind_id = cct.id LEFT JOIN (SELECT id, kind FROM kind_type) kt ON t.kind_id = kt.id GROUP BY kt.kind ORDER BY total_movies DESC;
SELECT cc.movie_id, COUNT(DISTINCT chn.id) AS number_of_characters, COUNT(DISTINCT cn.id) AS number_of_companies_involved, AVG(cn.country_code::int) AS average_country_code_numeric, SUM(CASE WHEN cn.name = 'Circuit Films' THEN 1 ELSE 0 END) AS count_circuit_films, SUM(CASE WHEN cn.name = 'Wild East Productions' THEN 1 ELSE 0 END) AS count_wild_east_productions, SUM(CASE WHEN cn.name = 'Léo & Compagnie' THEN 1 ELSE 0 END) AS count_leo_and_compagnie, SUM(CASE WHEN cn.name = 'C3Studios' THEN 1 ELSE 0 END) AS count_c3studios, SUM(CASE WHEN cn.name = 'M.A. Marcondes' THEN 1 ELSE 0 END) AS count_ma_marcondes FROM complete_cast cc JOIN char_name chn ON cc.subject_id = chn.id JOIN company_name cn ON cc.movie_id = cn.imdb_id GROUP BY cc.movie_id;
SELECT mi_genre.info AS genre, COUNT(DISTINCT mi.movie_id) AS total_movies, AVG(cast_member_count) AS avg_cast_members_per_movie, SUM(company_count) AS total_companies_involved FROM movie_info mi_genre INNER JOIN movie_info mi ON mi.movie_id = mi_genre.movie_id AND mi_genre.info_type_id = 1 LEFT JOIN (SELECT movie_id, COUNT(DISTINCT person_id) AS cast_member_count FROM cast_info GROUP BY movie_id) AS ci_sub ON ci_sub.movie_id = mi.movie_id LEFT JOIN (SELECT movie_id, COUNT(DISTINCT company_id) AS company_count FROM movie_companies GROUP BY movie_id) AS mc_sub ON mc_sub.movie_id = mi.movie_id GROUP BY mi_genre.info ORDER BY total_movies DESC, avg_cast_members_per_movie DESC;
SELECT kt.kind AS movie_kind, COUNT(DISTINCT mi.movie_id) AS total_movies, AVG(CAST(mi.info AS NUMERIC)) AS average_movie_length, SUM(CASE WHEN mi_idx.info_type_id = 26 THEN 1 ELSE 0 END) AS total_movies_with_votes, COUNT(DISTINCT mk.keyword_id) AS unique_keywords_used, COUNT(DISTINCT an.person_id) AS number_of_aka_names FROM movie_info mi JOIN kind_type kt ON mi.info_type_id = kt.id LEFT JOIN movie_info_idx mi_idx ON mi.movie_id = mi_idx.movie_id AND mi_idx.info_type_id IN (26, 41, 27, 80, 87) LEFT JOIN movie_keyword mk ON mi.movie_id = mk.movie_id LEFT JOIN aka_name an ON mi.movie_id = an.person_id WHERE mi.info_type_id = 1 AND mi_idx.movie_id = '8945' AND an.md5sum IN ('536004f9d825a8468fbfa85cb0221d0c', '5126b143aa05c2a7a362057c4543038b') GROUP BY kt.kind ORDER BY total_movies DESC;
SELECT kt.kind AS movie_type, MIN(at.title) AS example_movie, COUNT(DISTINCT mk.movie_id) AS total_movies_with_keywords, AVG(at.production_year) AS average_production_year, SUM(CASE WHEN at.note LIKE '%(imdb display title)%' THEN 1 ELSE 0 END) AS imdb_display_title_count FROM aka_title at JOIN kind_type kt ON at.kind_id = kt.id JOIN movie_keyword mk ON at.movie_id = mk.movie_id JOIN movie_info mi ON at.movie_id = mi.movie_id WHERE at.production_year BETWEEN 1990 AND 2020 AND at.note LIKE '%(imdb display title)%' AND mi.movie_id IN ('931220', '926777', '925133') GROUP BY kt.kind HAVING COUNT(DISTINCT at.movie_id) > 10 ORDER BY total_movies_with_keywords DESC;
SELECT n.gender, COUNT(DISTINCT n.id) AS number_of_people, AVG(mi_idx.info::numeric) AS average_movie_rating, SUM(CASE WHEN lt.LINK = 'sequel' THEN 1 ELSE 0 END) AS count_sequel_links, COUNT(DISTINCT k.id) AS number_of_keywords, COUNT(DISTINCT an.id) AS number_of_aka_names FROM name AS n LEFT JOIN aka_name AS an ON n.id = an.person_id LEFT JOIN movie_link AS ml ON ml.movie_id IN (SELECT movie_id FROM movie_info_idx WHERE id IN (1031, 375, 3321, 4177, 537)) LEFT JOIN link_type AS lt ON ml.link_type_id = lt.id LEFT JOIN movie_info_idx AS mi_idx ON ml.movie_id = mi_idx.movie_id AND mi_idx.info_type_id = 101 LEFT JOIN movie_keyword AS mk ON ml.movie_id = mk.movie_id LEFT JOIN keyword AS k ON mk.keyword_id = k.id GROUP BY n.gender HAVING COUNT(DISTINCT k.id) > 5 ORDER BY average_movie_rating DESC;
