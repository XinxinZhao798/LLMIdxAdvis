SELECT kt.kind AS movie_kind, AVG(t.production_year) AS avg_production_year, SUM(CASE WHEN rt.role = 'actress' THEN 1 ELSE 0 END) AS total_actress_roles, SUM(CASE WHEN rt.role = 'producer' THEN 1 ELSE 0 END) AS total_producer_roles, COUNT(DISTINCT mc.company_id) AS number_of_companies_involved FROM title AS t JOIN kind_type AS kt ON t.kind_id = kt.id LEFT JOIN movie_companies AS mc ON t.id = mc.movie_id LEFT JOIN movie_info AS mi ON t.id = mi.movie_id LEFT JOIN role_type AS rt ON mi.info_type_id = rt.id AND rt.role IN ('actress', 'producer') GROUP BY kt.kind ORDER BY number_of_companies_involved DESC, avg_production_year;
SELECT kt.kind AS movie_type, COUNT(DISTINCT at.movie_id) AS number_of_titles, AVG(at.production_year) AS average_production_year, SUM(CASE WHEN cc.status_id = '4' THEN 1 ELSE 0 END) AS count_completed_status_4, SUM(CASE WHEN cc.status_id = '3' THEN 1 ELSE 0 END) AS count_completed_status_3 FROM aka_title at JOIN kind_type kt ON at.kind_id = kt.id LEFT JOIN complete_cast cc ON at.movie_id = cc.movie_id GROUP BY kt.kind ORDER BY number_of_titles DESC;
SELECT ct.kind AS company_kind, AVG(at.production_year) AS average_production_year, COUNT(DISTINCT k.id) AS unique_keywords_count, COUNT(DISTINCT at.id) AS alternate_titles_count, SUM(CASE WHEN mic.info_type_id = '100' THEN 1 ELSE 0 END) AS count_info_type_100, SUM(CASE WHEN mic.info_type_id = '101' THEN 1 ELSE 0 END) AS count_info_type_101, SUM(CASE WHEN mic.info_type_id = '99' THEN 1 ELSE 0 END) AS count_info_type_99 FROM movie_companies AS mc JOIN company_type AS ct ON mc.company_type_id = ct.id JOIN aka_title AS at ON mc.movie_id = at.movie_id JOIN movie_info_idx AS mic ON mc.movie_id = mic.movie_id LEFT JOIN keyword AS k ON at.movie_id = k.id WHERE ct.kind = 'miscellaneous companies' AND mc.id IN ('1733', '1292', '472', '1920', '683', '4338') GROUP BY ct.kind;
SELECT kt.kind AS movie_kind, AVG(mi.info::numeric) AS average_rating, COUNT(DISTINCT t.id) AS total_movies, COUNT(DISTINCT an.id) AS total_actors, SUM(CASE WHEN cn.country_code = '[us]' THEN 1 ELSE 0 END) AS total_us_production_companies FROM title t JOIN kind_type kt ON t.kind_id = kt.id JOIN movie_info mi ON t.id = mi.movie_id JOIN info_type it ON mi.info_type_id = it.id AND it.info = 'rating' LEFT JOIN movie_companies mc ON t.id = mc.movie_id LEFT JOIN company_name cn ON mc.company_id = cn.id LEFT JOIN complete_cast cc ON t.id = cc.movie_id LEFT JOIN complete_cast an ON cc.id = an.id WHERE kt.kind IN ('video game', 'episode', 'tv series', 'tv mini series') AND t.production_year > 2000 GROUP BY kt.kind HAVING AVG(mi.info::numeric) > 5.0 ORDER BY average_rating DESC;
SELECT cct.kind, COUNT(*) AS count_cast_types, AVG(cn.imdb_id) AS average_imdb_id, SUM(cn.imdb_id) AS sum_imdb_id, cn.country_code, COUNT(DISTINCT cn.name) AS distinct_company_names, COUNT(DISTINCT mi.movie_id) AS distinct_movies FROM comp_cast_type cct JOIN company_name cn ON cct.id = cn.id JOIN movie_info_idx mi ON cn.id = mi.info_type_id WHERE cn.country_code IN ('[cu]', '[se]', '[dk]', '[ar]', '[al]') AND cn.name_pcode_nf IN ('M2531', 'A6254', 'M6341', 'K3256') AND cct.kind IN ('complete+verified', 'cast', 'crew', 'complete') GROUP BY cct.kind, cn.country_code ORDER BY count_cast_types DESC;
SELECT rt.ROLE as role_type, AVG(title.production_year) as average_production_year, COUNT(DISTINCT title.id) as total_movies, COUNT(DISTINCT cast_info.person_id) as total_actors, SUM(case when title.production_year BETWEEN 1970 AND 1980 then 1 else 0 end) as movies_1970s, SUM(case when title.production_year BETWEEN 1981 AND 1990 then 1 else 0 end) as movies_1980s FROM title JOIN cast_info ON title.id = cast_info.movie_id JOIN role_type rt ON cast_info.role_id = rt.id WHERE title.phonetic_code = 'C6123' AND title.production_year IN ('1974', '1969', '1987', '1957') GROUP BY rt.ROLE ORDER BY average_production_year DESC;
SELECT kt.kind AS kind_of_title, AVG(t.production_year) AS average_production_year, COUNT(DISTINCT t.id) AS number_of_titles, SUM(CASE WHEN mi.info_type_id = 2 THEN 1 ELSE 0 END) AS count_of_info_type_2, MAX(t.episode_nr) AS highest_episode_number FROM title t JOIN kind_type kt ON t.kind_id = kt.id LEFT JOIN movie_info mi ON t.id = mi.movie_id WHERE t.kind_id IN (2, 7) AND kt.id IN (4, 7, 6, 1) AND kt.kind IN ('video game', 'movie', 'video movie', 'tv series') GROUP BY kt.kind ORDER BY average_production_year DESC;
SELECT AVG(CAST(mi_idx.info AS decimal)) AS average_rating, COUNT(DISTINCT ci.movie_id) AS number_of_movies, COUNT(DISTINCT ci.person_id) AS number_of_actors, SUM(CASE WHEN mc.company_type_id = 2 THEN 1 ELSE 0 END) AS number_of_distributors, n.gender, ki.keyword FROM cast_info AS ci JOIN movie_info_idx AS mi_idx ON ci.movie_id = mi_idx.movie_id JOIN movie_companies AS mc ON ci.movie_id = mc.movie_id JOIN name AS n ON ci.person_id = n.id JOIN keyword AS ki ON mi_idx.info_type_id = ki.id WHERE ci.role_id = 1 AND n.gender IS NOT NULL AND mi_idx.info_type_id = (SELECT id FROM info_type WHERE info = 'rating') AND mc.company_type_id = (SELECT id FROM company_type WHERE kind = 'distributor') GROUP BY n.gender, ki.keyword HAVING COUNT(DISTINCT ci.movie_id) > 10 ORDER BY average_rating DESC, number_of_movies DESC;
SELECT n.gender, COUNT(DISTINCT n.id) AS total_people, AVG(ci.nr_order) AS average_credit_order FROM name AS n JOIN cast_info AS ci ON n.id = ci.person_id WHERE n.gender IN ('M', 'F') AND ci.note LIKE '%(2000)%' GROUP BY n.gender;
SELECT kt.kind AS movie_type, COUNT(DISTINCT mi.movie_id) AS total_movies, AVG(CAST(mi_idx.info AS FLOAT)) AS average_rating, SUM(CASE WHEN k.keyword = 'disco-ball' THEN 1 ELSE 0 END) AS disco_ball_keyword_count, SUM(CASE WHEN k.keyword = 'bandana' THEN 1 ELSE 0 END) AS bandana_keyword_count, STRING_AGG(DISTINCT ct.kind, ', ') AS involved_company_types FROM movie_info mi JOIN movie_info_idx mi_idx ON mi.movie_id = mi_idx.movie_id AND mi.info_type_id = mi_idx.info_type_id JOIN kind_type kt ON kt.id = mi.info_type_id JOIN movie_info mii ON mii.movie_id = mi.movie_id JOIN link_type lt ON lt.id = mi_idx.id JOIN keyword k ON k.id = mi_idx.id JOIN company_type ct ON ct.id = mi_idx.id WHERE mi.id IN ('7268657', '7271065', '7267731') AND mi.movie_id IN ('924506', '925955', '929745', '938512', '930430') AND ct.kind IN ('special effects companies', 'miscellaneous companies', 'production companies', 'distributors') AND mi_idx.info SIMILAR TO '(%...[0-9]*[0-9].[0-9]*[0-9]%)' GROUP BY kt.kind;
SELECT AVG(CASE WHEN mc.company_type_id = 1 THEN mi_box_office.info::NUMERIC ELSE NULL END) AS avg_box_office_producer, AVG(CASE WHEN mc.company_type_id = 2 THEN mi_box_office.info::NUMERIC ELSE NULL END) AS avg_box_office_distributor, COUNT(DISTINCT mc.movie_id) FILTER (WHERE mc.company_type_id = 1) AS num_movies_produced, COUNT(DISTINCT mc.movie_id) FILTER (WHERE mc.company_type_id = 2) AS num_movies_distributed, COUNT(DISTINCT cn.id) AS num_companies, COUNT(DISTINCT an.person_id) AS num_persons_with_aka FROM movie_companies mc JOIN company_name cn ON mc.company_id = cn.id JOIN movie_info mi_box_office ON mc.movie_id = mi_box_office.movie_id AND mi_box_office.info_type_id = 107 LEFT JOIN aka_name an ON cn.id = an.person_id WHERE cn.country_code = 'US' AND mi_box_office.info ~ '^\d+$' GROUP BY cn.country_code;
SELECT rt.ROLE, COUNT(DISTINCT ci.person_id) AS number_of_people, AVG(mc.id) AS average_movie_company_id, SUM(CASE WHEN cn.country_code = 'US' THEN 1 ELSE 0 END) AS number_of_us_companies, COUNT(DISTINCT ml.movie_id) AS number_of_linked_movies FROM role_type rt LEFT JOIN cast_info ci ON rt.id = ci.role_id LEFT JOIN movie_companies mc ON ci.movie_id = mc.movie_id LEFT JOIN company_name cn ON mc.company_id = cn.id LEFT JOIN movie_link ml ON ci.movie_id = ml.movie_id GROUP BY rt.ROLE ORDER BY number_of_people DESC;
SELECT kt.kind, COUNT(DISTINCT mc.movie_id) AS number_of_movies, COUNT(DISTINCT mk.keyword_id) AS number_of_keywords, AVG(n.imdb_id) AS average_imdb_id, SUM(CASE WHEN n.gender = 'M' THEN 1 ELSE 0 END) AS number_of_male_contributors, SUM(CASE WHEN n.gender = 'F' THEN 1 ELSE 0 END) AS number_of_female_contributors FROM movie_companies AS mc JOIN kind_type AS kt ON mc.company_type_id = kt.id JOIN movie_keyword AS mk ON mc.movie_id = mk.movie_id JOIN name AS n ON mc.company_id = n.id GROUP BY kt.kind HAVING COUNT(DISTINCT mc.movie_id) > 5 ORDER BY number_of_movies DESC;
SELECT ct.kind AS company_kind, COUNT(DISTINCT t.id) AS number_of_movies, AVG(t.production_year) AS average_production_year, COUNT(DISTINCT cc.subject_id) AS number_of_subjects, SUM(CASE WHEN t.kind_id = 1 THEN 1 ELSE 0 END) AS number_of_feature_films, SUM(CASE WHEN t.kind_id = 2 THEN 1 ELSE 0 END) AS number_of_tv_shows, SUM(CASE WHEN t.kind_id = 4 THEN 1 ELSE 0 END) AS number_of_documentaries FROM title t JOIN complete_cast cc ON t.id = cc.movie_id JOIN company_type ct ON t.kind_id = ct.id GROUP BY ct.kind ORDER BY number_of_movies DESC;
SELECT kt.kind AS movie_type, AVG(akat.production_year) AS average_production_year, COUNT(DISTINCT akat.movie_id) AS total_movies, SUM(CASE WHEN akat.imdb_index IS NOT NULL THEN 1 ELSE 0 END) AS indexed_movies_count, COUNT(mk.keyword_id) AS total_keywords FROM aka_title akat JOIN kind_type kt ON akat.kind_id = kt.id LEFT JOIN movie_keyword mk ON akat.movie_id = mk.movie_id GROUP BY kt.kind ORDER BY total_movies DESC;
SELECT AVG(at.production_year) AS average_production_year, COUNT(DISTINCT at.movie_id) AS number_of_movies, COUNT(DISTINCT ml.linked_movie_id) AS number_of_linked_movies, SUM(CASE WHEN lt.link = 'similar to' THEN 1 ELSE 0 END) AS count_similar_movies, rt.role AS role_type, COUNT(DISTINCT cct.id) AS count_of_cast_types FROM aka_title at JOIN movie_link ml ON at.movie_id = ml.movie_id JOIN link_type lt ON ml.link_type_id = lt.id JOIN role_type rt ON rt.id = 4 JOIN comp_cast_type cct ON cct.kind IN ('complete+verified', 'cast', 'crew', 'complete') WHERE at.md5sum IN ('efba398a3a676bcdd49811cf868754d9', '532902abff1e92fb97a2eef43fb530a6', '803eb3353f2aeb81555223391ef4de88', 'eaf5b1adddabc3742e27581d5b19c2ac') GROUP BY rt.role;
SELECT t.title AS Movie_Title, t.production_year AS Production_Year, COUNT(DISTINCT mk.keyword_id) AS Number_of_Keywords, COUNT(DISTINCT mc.company_id) AS Number_of_Companies_Involved, AVG(t.production_year) OVER () AS Average_Production_Year, COUNT(*) OVER () AS Total_Movies_Analyzed FROM title AS t JOIN movie_keyword AS mk ON t.id = mk.movie_id JOIN movie_companies AS mc ON t.id = mc.movie_id JOIN movie_link AS ml ON t.id = ml.movie_id WHERE ml.link_type_id IN ('12', '11', '13', '6') AND t.series_years IN ('1985-????', '2004-????', '2013-????', '1988-????', '2010-2010') AND t.production_year > (SELECT AVG(production_year) FROM title) GROUP BY t.id HAVING COUNT(DISTINCT mk.keyword_id) > 5 ORDER BY Number_of_Keywords DESC, Production_Year DESC;
SELECT ct.kind AS company_type, AVG(pi.info::NUMERIC) AS average_salary, SUM(CASE WHEN cn.country_code = 'US' THEN 1 ELSE 0 END) AS number_of_us_companies, COUNT(DISTINCT cn.id) AS total_companies FROM company_name AS cn JOIN company_type AS ct ON cn.id = ct.id LEFT JOIN person_info AS pi ON cn.imdb_id = pi.person_id WHERE pi.info_type_id = 2 AND ct.kind = 'Production' GROUP BY ct.kind ORDER BY average_salary DESC;
SELECT AVG(at.production_year) AS average_production_year, COUNT(DISTINCT comp.id) AS number_of_companies, SUM(CASE WHEN cc.status_id = 4 THEN 1 ELSE 0 END) AS full_cast_movies, COUNT(DISTINCT mk.id) AS number_of_keywords, MAX(pi.id) AS max_person_info_id FROM aka_title AS at JOIN movie_companies AS mc ON mc.movie_id = at.movie_id JOIN company_name AS comp ON mc.company_id = comp.id JOIN complete_cast AS cc ON at.movie_id = cc.movie_id JOIN movie_keyword AS mk ON at.movie_id = mk.movie_id LEFT JOIN person_info AS pi ON pi.person_id = at.movie_id WHERE at.kind_id = 1 AND mc.company_type_id IN (1, 2) AND cc.status_id IN (3, 4) AND at.production_year BETWEEN 1990 AND 2000 GROUP BY at.production_year ORDER BY average_production_year DESC;
SELECT kt.kind, COUNT(DISTINCT mc.movie_id) AS number_of_movies, COUNT(DISTINCT ci.person_id) AS number_of_people, AVG(mc.company_id) AS average_company_id, SUM(CASE WHEN ct.kind = 'producer' THEN 1 ELSE 0 END) AS number_of_producers, MAX(ci.nr_order) AS max_cast_order FROM movie_companies mc JOIN company_type ct ON mc.company_type_id = ct.id JOIN kind_type kt ON ct.id = kt.id LEFT JOIN cast_info ci ON mc.movie_id = ci.movie_id WHERE kt.kind IN ('movie', 'tv series', 'tv movie') AND ct.kind IN ('distributor', 'producer') GROUP BY kt.kind ORDER BY number_of_movies DESC;
SELECT t.production_year, COUNT(DISTINCT t.id) AS total_titles, AVG(t.production_year) AS avg_production_year, SUM(CASE WHEN k.keyword = 'medical-emergency' THEN 1 ELSE 0 END) AS count_medical_emergency, COUNT(DISTINCT cc.movie_id) AS total_movies_with_complete_cast, COUNT(DISTINCT char_name.name) AS total_character_names FROM title AS t LEFT JOIN keyword AS k ON t.phonetic_code = k.phonetic_code LEFT JOIN complete_cast AS cc ON t.id = cc.movie_id LEFT JOIN char_name ON char_name.surname_pcode = t.md5sum WHERE t.production_year BETWEEN 1990 AND 2000 AND cc.status_id IN (3, 4) AND (k.keyword = 'audi-rs5' OR k.keyword = 'second-chance' OR k.keyword = 'little-boy') GROUP BY t.production_year ORDER BY total_titles DESC;
SELECT ct.kind AS company_type, AVG(at.production_year) AS avg_production_year, COUNT(DISTINCT ci.movie_id) AS num_movies_casted, SUM(CASE WHEN at.season_nr IS NOT NULL THEN 1 ELSE 0 END) AS total_seasons, COUNT(DISTINCT k.id) AS unique_keywords FROM movie_companies AS mc JOIN company_type AS ct ON mc.company_type_id = ct.id JOIN aka_title AS at ON mc.movie_id = at.movie_id JOIN cast_info AS ci ON ci.movie_id = mc.movie_id LEFT JOIN keyword AS k ON k.id = at.movie_id WHERE mc.note LIKE '%(20%)%' AND ci.nr_order IN (44, 146, 15, 7, 47) AND ci.role_id = 1 AND at.movie_id IN (879100, 610270, 1241825, 1678396, 1699805, 549252) GROUP BY ct.kind;
SELECT n.name AS actor_name, COUNT(a.id) AS aka_name_count, AVG(n.imdb_id) AS average_imdb_id, SUM(mc.movie_id) AS sum_movie_ids, MAX(mc.note) AS latest_production_note FROM name n LEFT JOIN aka_name a ON n.id = a.person_id INNER JOIN movie_companies mc ON n.id = mc.company_id WHERE n.imdb_index IN ('IX', 'XVI', 'I', 'XI', 'XIX') AND a.name_pcode_nf IN ('N1312', 'A6236', 'W5653', 'A5463', 'K52', 'B5415') AND mc.company_type_id = '1' GROUP BY n.name;
SELECT it.info AS info_category, COUNT(DISTINCT mc.movie_id) AS number_of_movies, COUNT(DISTINCT mc.company_id) AS number_of_companies, AVG(CAST(mi_idx.info AS numeric)) AS average_movie_info, SUM(CAST(mi_idx.info AS numeric)) AS total_movie_info FROM movie_companies mc JOIN movie_info_idx mi_idx ON mc.movie_id = mi_idx.movie_id JOIN info_type it ON mi_idx.info_type_id = it.id WHERE mc.id IN (2842, 2303, 4675, 3814) AND mi_idx.movie_id IN (14671, 8865) AND mi_idx.note IS NOT NULL GROUP BY it.info;
SELECT c.name AS company_name, COUNT(DISTINCT t.id) AS number_of_movies, AVG(t.production_year) AS average_production_year, SUM(CASE WHEN t.kind_id = 1 THEN 1 ELSE 0 END) AS total_feature_films, SUM(CASE WHEN t.kind_id = 2 THEN 1 ELSE 0 END) AS total_tv_shows, COUNT(DISTINCT mk.keyword_id) AS total_unique_keywords FROM company_name c JOIN movie_keyword mk ON c.id = mk.keyword_id JOIN title t ON mk.movie_id = t.id WHERE c.country_code IN ('US', 'GB') AND t.production_year BETWEEN 1990 AND 2000 GROUP BY c.name HAVING COUNT(DISTINCT t.id) > 10 ORDER BY total_feature_films DESC, total_tv_shows DESC;
SELECT ct.kind AS company_type, AVG(t.production_year) AS average_production_year, COUNT(DISTINCT t.id) AS number_of_movies, SUM(CASE WHEN mi.info_type_id = 1 THEN 1 ELSE 0 END) AS number_of_top_ranked_movies FROM company_type AS ct JOIN movie_companies AS mc ON ct.id = mc.company_type_id JOIN title AS t ON mc.movie_id = t.id JOIN movie_info AS mi ON t.id = mi.movie_id WHERE ct.kind IN ('special effects companies', 'miscellaneous companies', 'production companies', 'distributors') AND t.production_year >= 2000 GROUP BY ct.kind ORDER BY number_of_movies DESC;
