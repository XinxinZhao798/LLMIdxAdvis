SELECT kt.kind, COUNT(DISTINCT cc.movie_id) AS number_of_movies, AVG(CAST(mi_idx.info AS NUMERIC)) AS average_movie_info, SUM(CASE WHEN mi_idx.note = 'Y' THEN 1 ELSE 0 END) AS count_noted_info FROM complete_cast cc JOIN kind_type kt ON cc.subject_id = kt.id JOIN movie_info_idx mi_idx ON cc.movie_id = mi_idx.movie_id WHERE cc.status_id IN (1, 2, 3) AND mi_idx.info_type_id BETWEEN 10 AND 20 AND mi_idx.id NOT IN (4072, 3466, 2096, 1652, 1371) AND cc.id NOT IN (3672, 620) GROUP BY kt.kind HAVING COUNT(DISTINCT cc.movie_id) > 5 ORDER BY average_movie_info DESC;
SELECT AVG(mi_idx.info::integer) AS average_movie_rating, COUNT(DISTINCT k.id) AS total_unique_keywords, COUNT(DISTINCT cn.id) AS total_companies_involved, COUNT(DISTINCT pi.person_id) AS total_people_with_info, MAX(cn.name) AS largest_company_name FROM keyword AS k, movie_keyword AS mk, movie_info_idx AS mi_idx, company_name AS cn, movie_companies AS mc, person_info AS pi, comp_cast_type AS cct WHERE k.keyword IN ('hang-gliding', 'stubbornness', 'porch-swing', 'cereal', 'identical-twins') AND k.id = mk.keyword_id AND mk.movie_id = mi_idx.movie_id AND mc.movie_id = mi_idx.movie_id AND mc.company_id = cn.id AND pi.info_type_id = cct.id AND cct.kind IN ('complete+verified', 'cast', 'crew', 'complete') GROUP BY cct.kind;
SELECT t.production_year, COUNT(DISTINCT t.id) as total_movies, AVG(mcc.count_companies) as average_companies_per_movie, SUM(cast_members.total_cast) as total_cast_members FROM title t LEFT JOIN ( SELECT movie_id, COUNT(company_id) as count_companies FROM movie_companies GROUP BY movie_id ) mcc ON mcc.movie_id = t.id LEFT JOIN ( SELECT movie_id, COUNT(id) as total_cast FROM complete_cast GROUP BY movie_id ) cast_members ON cast_members.movie_id = t.id WHERE t.production_year IS NOT NULL GROUP BY t.production_year ORDER BY t.production_year;
SELECT rt.ROLE, COUNT(DISTINCT ci.person_id) AS num_of_people, AVG(ci.nr_order) AS average_order, SUM(CASE WHEN cct.kind = 'complete+verified' THEN 1 ELSE 0 END) AS num_complete_verified, cn.country_code, COUNT(DISTINCT mk.keyword_id) AS num_of_keywords, AVG(CASE WHEN mi.info SIMILAR TO '[0-9]+\.[0-9]' THEN CAST(mi.info AS FLOAT) ELSE NULL END) AS average_info_numeric FROM cast_info ci INNER JOIN role_type rt ON ci.role_id = rt.id LEFT JOIN comp_cast_type cct ON ci.person_role_id = cct.id LEFT JOIN company_name cn ON ci.person_id = cn.imdb_id LEFT JOIN movie_keyword mk ON ci.movie_id = mk.movie_id LEFT JOIN movie_info_idx mi ON ci.movie_id = mi.movie_id WHERE mi.movie_id::VARCHAR LIKE '%19410%' AND mi.info SIMILAR TO '(0|84|349|11\.7)%' AND mk.id IN (1932, 3564, 2558, 997, 3482, 1435) GROUP BY rt.ROLE, cn.country_code ORDER BY num_of_people DESC, average_order ASC;
SELECT ct.kind AS company_type, COUNT(DISTINCT mi_idx.movie_id) AS number_of_movies, AVG(CASE WHEN mi_idx.info_type_id = 100 THEN CAST(mi_idx.info AS FLOAT) END) AS average_rating, SUM(CASE WHEN mi_idx.info_type_id = 101 THEN CAST(mi_idx.info AS INTEGER) END) AS total_budget, COUNT(DISTINCT pi.person_id) AS number_of_persons_involved FROM movie_info_idx mi_idx JOIN company_type ct ON mi_idx.info_type_id = ct.id LEFT JOIN person_info pi ON mi_idx.movie_id = pi.person_id WHERE mi_idx.info_type_id IN (100, 101, 99) GROUP BY ct.kind;
SELECT ct.kind AS company_type, AVG(at.production_year) AS average_production_year, COUNT(DISTINCT k.id) AS number_of_keywords, SUM(CASE WHEN at.episode_of_id IS NOT NULL THEN 1 ELSE 0 END) AS number_of_episodes, COUNT(DISTINCT n.id) AS number_of_names, COUNT(DISTINCT cc.id) AS number_of_complete_cast_records FROM movie_companies AS mc JOIN company_type AS ct ON mc.company_type_id = ct.id JOIN aka_title AS at ON mc.movie_id = at.movie_id JOIN complete_cast AS cc ON at.movie_id = cc.movie_id JOIN keyword AS k ON at.id = k.id JOIN name AS n ON at.id = n.id WHERE mc.note LIKE '%(TV)%' AND at.production_year > 1990 AND (at.episode_nr IN (37, 566, 13, 606, 41) OR at.episode_of_id IN (12586, 2536, 13063, 16867, 21471)) GROUP BY ct.kind;
SELECT kt.kind AS movie_type, AVG(at.production_year) AS average_production_year, COUNT(DISTINCT ci.movie_id) AS total_movies, COUNT(DISTINCT ci.person_id) AS total_actors, SUM(CASE WHEN mc.note LIKE '%(TV)%' THEN 1 ELSE 0 END) AS total_tv_movies, SUM(CASE WHEN mc.note LIKE '%(DVD)%' THEN 1 ELSE 0 END) AS total_dvd_movies, SUM(CASE WHEN mc.note LIKE '%(VHS)%' THEN 1 ELSE 0 END) AS total_vhs_movies FROM kind_type kt JOIN aka_title at ON kt.id = at.kind_id JOIN movie_companies mc ON at.movie_id = mc.movie_id JOIN cast_info ci ON at.movie_id = ci.movie_id GROUP BY kt.kind;
SELECT cct.kind AS movie_kind, AVG(at.production_year) AS average_production_year, COUNT(at.id) AS number_of_titles, MAX(at.production_year) AS latest_production_year, MIN(at.production_year) AS earliest_production_year FROM aka_title at JOIN comp_cast_type cct ON at.kind_id = cct.id GROUP BY cct.kind ORDER BY average_production_year DESC;
SELECT ct.kind AS company_kind, COUNT(DISTINCT mc.company_id) AS number_of_companies, COUNT(DISTINCT t.id) AS number_of_movies, AVG(t.production_year) AS average_production_year, SUM(CASE WHEN mi.info = 'Norwegian' THEN 1 ELSE 0 END) AS norwegian_movies_count, SUM(CASE WHEN mi.info = 'Arabic' THEN 1 ELSE 0 END) AS arabic_movies_count, SUM(CASE WHEN mi.info = 'Serbian' THEN 1 ELSE 0 END) AS serbian_movies_count, SUM(CASE WHEN mi.info = 'Portuguese' THEN 1 ELSE 0 END) AS portuguese_movies_count FROM company_type AS ct JOIN movie_companies AS mc ON ct.id = mc.company_type_id JOIN title AS t ON mc.movie_id = t.id LEFT JOIN movie_info AS mi ON t.id = mi.movie_id AND mi.info_type_id = '4' WHERE ct.kind IN ('special effects companies', 'miscellaneous companies', 'production companies', 'distributors') GROUP BY ct.kind ORDER BY number_of_companies DESC;
SELECT kt.kind AS movie_type, AVG(at.production_year) AS average_production_year, COUNT(DISTINCT ci.movie_id) AS number_of_movies, COUNT(DISTINCT ci.person_id) AS number_of_actors, SUM(CASE WHEN at.id IS NOT NULL THEN 1 ELSE 0 END) AS number_of_alternate_titles, MAX(ci.nr_order) AS max_cast_order FROM cast_info AS ci LEFT JOIN aka_title AS at ON ci.movie_id = at.movie_id JOIN kind_type AS kt ON at.kind_id = kt.id GROUP BY kt.kind HAVING AVG(at.production_year) > 1990 AND COUNT(DISTINCT ci.movie_id) > 10;
SELECT kt.kind AS company_type, COUNT(DISTINCT mc.movie_id) AS number_of_movies, AVG(mc.company_id) AS average_company_id, SUM(mc.company_type_id) AS sum_company_type_ids FROM movie_companies mc JOIN kind_type kt ON mc.company_type_id = kt.id GROUP BY kt.kind ORDER BY number_of_movies DESC;
SELECT k.keyword, AVG(at.production_year) AS avg_production_year, COUNT(DISTINCT at.movie_id) AS total_movies, COUNT(DISTINCT at.kind_id) AS different_kinds FROM keyword AS k JOIN movie_info AS mi ON mi.info LIKE '%' || k.keyword || '%' JOIN aka_title AS at ON at.movie_id = mi.movie_id WHERE k.keyword IN ('stewardess', 'lost-film', 'reality', 'honeymoon', 'murder-mystery') AND at.note LIKE '%lost film%' GROUP BY k.keyword;
SELECT cn.country_code, k.keyword, COUNT(DISTINCT mc.movie_id) AS num_movies, AVG(CAST(NULLIF(REGEXP_REPLACE(mi_duration.info, '[^\d.]', '', 'g'), '') AS NUMERIC)) AS average_movie_duration, SUM(CASE WHEN mi_release.info_type_id = 4 THEN 1 ELSE 0 END) AS count_movie_releases FROM company_name AS cn JOIN movie_companies AS mc ON cn.id = mc.company_id JOIN movie_keyword AS mk ON mc.movie_id = mk.movie_id JOIN keyword AS k ON mk.keyword_id = k.id LEFT JOIN movie_info AS mi_release ON mc.movie_id = mi_release.movie_id AND mi_release.info_type_id = 4 LEFT JOIN movie_info AS mi_duration ON mc.movie_id = mi_duration.movie_id AND mi_duration.info_type_id = 3 WHERE k.keyword IN ('dead-mother', 'manipulation') AND mi_release.note IN ('(some dialogue)', '(none)', '(only a few lines)', '(a few lines)', '(a few words)') GROUP BY cn.country_code, k.keyword ORDER BY cn.country_code, k.keyword;
SELECT ct.kind AS company_kind, COUNT(DISTINCT t.id) AS total_titles, AVG(t.production_year) AS average_production_year, COUNT(DISTINCT k.id) AS distinct_keywords_count FROM company_type AS ct JOIN title AS t ON t.kind_id = ct.id LEFT JOIN keyword AS k ON k.phonetic_code = t.phonetic_code WHERE t.production_year IS NOT NULL AND ct.id IN (SELECT kind_id FROM title WHERE id IN (175843, 103199, 50713, 123396, 75890)) GROUP BY ct.kind ORDER BY total_titles DESC;
SELECT t.title, COUNT(DISTINCT mk.keyword_id) AS total_keywords, AVG(CAST(mi.info AS NUMERIC)) AS average_rating, COUNT(DISTINCT ml.movie_id) AS total_linked_movies, SUM(CASE WHEN mi_idx.info_type_id = 3 THEN 1 ELSE 0 END) AS count_of_type_3_infos FROM title t JOIN movie_info mi ON t.id = mi.movie_id JOIN movie_info_idx mi_idx ON t.id = mi_idx.movie_id JOIN movie_keyword mk ON t.id = mk.movie_id LEFT JOIN movie_link ml ON t.id = ml.movie_id WHERE t.production_year BETWEEN 2000 AND 2020 AND mi.info_type_id = 101 AND mk.keyword_id IN ('3774', '2749', '3382', '2831', '1138') AND mi_idx.info_type_id IN ('3', '5', '7') GROUP BY t.title ORDER BY average_rating DESC, total_linked_movies DESC;
