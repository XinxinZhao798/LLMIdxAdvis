SELECT cn.name AS company_name, cn.country_code, COUNT(t.id) AS total_movies_produced, AVG(t.production_year) AS average_production_year FROM company_name AS cn JOIN movie_info AS mi ON cn.imdb_id = mi.movie_id JOIN title AS t ON mi.movie_id = t.id GROUP BY cn.name, cn.country_code ORDER BY total_movies_produced DESC, average_production_year DESC;
SELECT COUNT(DISTINCT at.id) AS number_of_titles, AVG(at.production_year) AS average_production_year, rt.role AS role_type, COUNT(DISTINCT mi.id) AS number_of_movie_infos, SUM(CASE WHEN at.kind_id = '1' THEN 1 ELSE 0 END) AS number_of_movies, SUM(CASE WHEN at.kind_id = '2' THEN 1 ELSE 0 END) AS number_of_tv_shows, COUNT(DISTINCT at.episode_of_id) AS number_of_unique_series, MAX(at.season_nr) AS max_season_number, MAX(at.episode_nr) AS max_episode_number FROM aka_title at JOIN movie_info mi ON at.movie_id = mi.movie_id JOIN role_type rt ON mi.info_type_id = rt.id WHERE at.production_year BETWEEN 1990 AND 2020 AND mi.info LIKE '%color%' GROUP BY rt.role ORDER BY number_of_titles DESC, average_production_year;
SELECT t.kind_id, AVG(CASE WHEN mi.info_type_id = 101 THEN CAST(mi.info AS NUMERIC) ELSE NULL END) AS avg_budget, SUM(CASE WHEN at.title LIKE '%Finnish%' THEN 1 ELSE 0 END) AS finnish_title_count, COUNT(DISTINCT t.id) AS total_movies, MIN(t.production_year) AS earliest_production_year, MAX(t.production_year) AS latest_production_year FROM title t LEFT JOIN movie_info mi ON t.id = mi.movie_id LEFT JOIN aka_title at ON t.id = at.movie_id LEFT JOIN complete_cast cc ON t.id = cc.movie_id WHERE (t.kind_id = 2 OR t.kind_id = 7) AND (at.phonetic_code IN ('C4231', 'U4351', 'D5353') OR t.phonetic_code = 'F635') AND (at.season_nr IN (30, 7, 9) OR t.production_year BETWEEN 2005 AND 2015) AND (mi.info = 'Finnish' OR mi.info = 'Serbo-Croatian') GROUP BY t.kind_id ORDER BY total_movies DESC;
SELECT t.title AS movie_title, COUNT(ci.id) AS total_cast_members, AVG(t.production_year) AS average_production_year, SUM(CASE WHEN t.imdb_index IN ('I', 'II') THEN 1 ELSE 0 END) AS count_sequels, mi.info AS movie_info, COUNT(DISTINCT k.id) AS distinct_keywords FROM title AS t JOIN cast_info AS ci ON ci.movie_id = t.id JOIN comp_cast_type AS cct ON ci.role_id = cct.id JOIN movie_info AS mi ON mi.movie_id = t.id LEFT JOIN keyword AS k ON mi.info = k.keyword WHERE ci.person_role_id = 619 AND t.production_year > 2005 GROUP BY t.title, mi.info ORDER BY total_cast_members DESC, average_production_year;
SELECT CT.kind AS company_kind, AVG(CAST(MI.info AS FLOAT)) AS average_rating, COUNT(DISTINCT CI.person_id) AS total_cast_members, COUNT(DISTINCT MC.movie_id) AS number_of_movies FROM movie_companies AS MC JOIN company_type AS CT ON MC.company_type_id = CT.id JOIN movie_info AS MI ON MC.movie_id = MI.movie_id AND MI.info_type_id = 101 JOIN cast_info AS CI ON MC.movie_id = CI.movie_id WHERE (MC.note LIKE '%(TV)' OR MC.note IS NULL) AND CT.kind IN ('special effects companies', 'miscellaneous companies', 'production companies', 'distributors') AND CI.role_id = 1 GROUP BY CT.kind ORDER BY average_rating DESC;
SELECT lt.LINK AS link_type, COUNT(DISTINCT ml.movie_id) AS number_of_movies, AVG(t.production_year) AS average_production_year, COUNT(DISTINCT t.episode_of_id) AS number_of_series, SUM(CASE WHEN t.season_nr IS NOT NULL THEN 1 ELSE 0 END) AS total_seasons_count, SUM(CASE WHEN t.production_year > 2000 THEN 1 ELSE 0 END) AS movies_since_2001 FROM movie_link AS ml JOIN link_type AS lt ON ml.link_type_id = lt.id JOIN title AS t ON ml.movie_id = t.id WHERE t.production_year BETWEEN 1980 AND 2023 AND lt.link IN ('remade as', 'edited from', 'referenced in') GROUP BY lt.LINK ORDER BY number_of_movies DESC;
SELECT AVG(ml.link_type_id) AS average_link_type, COUNT(DISTINCT cn.id) AS total_unique_characters, SUM(CASE WHEN mi.info_type_id = 2 THEN 1 ELSE 0 END) AS total_drama_movies, MIN(cn.name) AS first_character_name FROM char_name cn JOIN movie_link ml ON cn.imdb_id = ml.movie_id JOIN movie_info mi ON ml.movie_id = mi.movie_id WHERE cn.imdb_index = 'tt' AND mi.info LIKE '%Drama%' GROUP BY cn.imdb_id HAVING COUNT(DISTINCT ml.id) > 3;
SELECT ct.kind AS company_type, COUNT(DISTINCT cn.name) AS distinct_company_names, COUNT(DISTINCT cn.country_code) AS distinct_country_codes, AVG(cc.movie_id) AS average_movie_id, SUM(CASE WHEN rt.role = 'producer' THEN 1 ELSE 0 END) AS total_producers, SUM(CASE WHEN rt.role = 'editor' THEN 1 ELSE 0 END) AS total_editors, COUNT(DISTINCT cc.movie_id) AS distinct_movies_with_complete_cast, MAX(cc.status_id) AS max_status_id FROM company_name cn JOIN company_type ct ON cn.id = ct.id JOIN complete_cast cc ON cc.movie_id = cn.imdb_id JOIN role_type rt ON rt.id = cc.subject_id WHERE cn.country_code != 'US' AND rt.role IN ('guest', 'actress', 'editor', 'producer') GROUP BY ct.kind ORDER BY total_producers DESC;
