SELECT cn.name AS character_name, COUNT(DISTINCT ci.movie_id) AS number_of_movies, AVG(ci.nr_order) AS average_cast_position, SUM(CASE WHEN ml.link_type_id = 1 THEN 1 ELSE 0 END) AS number_of_sequels, MAX(pi.info) AS latest_actor_information FROM char_name cn JOIN cast_info ci ON cn.id = ci.person_role_id JOIN movie_link ml ON ci.movie_id = ml.movie_id JOIN person_info pi ON ci.person_id = pi.person_id WHERE cn.surname_pcode IN ('A', 'T61', 'E153', 'A13', 'C2', 'B6353') AND ci.role_id = (SELECT id FROM role_type WHERE role = 'actor') AND pi.info_type_id = (SELECT id FROM info_type WHERE info = 'biography') GROUP BY cn.name;
SELECT kt.kind, COUNT(DISTINCT ml.movie_id) AS total_movies, COUNT(DISTINCT ml.linked_movie_id) AS total_linked_movies, COUNT(DISTINCT cn.id) AS total_companies, AVG(pi.person_id) AS average_person_id, SUM(cc.subject_id) AS sum_subject_ids FROM movie_link AS ml JOIN kind_type AS kt ON ml.link_type_id = kt.id JOIN complete_cast AS cc ON ml.movie_id = cc.movie_id JOIN company_name AS cn ON cn.country_code NOT LIKE '%[pl]%' JOIN person_info AS pi ON pi.person_id = cc.subject_id WHERE kt.kind IN ('episode', 'movie', 'video movie', 'video game') AND cc.subject_id = '1' AND cn.name_pcode_sf IN ('J2316', 'F4131', 'N2314', 'S1526', 'D2346', 'J6123') GROUP BY kt.kind;
SELECT AVG(akat.production_year) AS average_production_year, COUNT(DISTINCT akat.movie_id) AS number_of_movies, cct.kind, k.keyword, SUM(CASE WHEN akat.season_nr IS NOT NULL THEN 1 ELSE 0 END) AS total_seasons, SUM(CASE WHEN akat.episode_nr IS NOT NULL THEN 1 ELSE 0 END) AS total_episodes FROM aka_title akat JOIN comp_cast_type cct ON akat.kind_id = cct.id JOIN keyword k ON k.id IN (58, 8642, 3881, 5552, 5846) WHERE akat.production_year > 1990 AND cct.kind IN ('complete+verified', 'cast', 'crew', 'complete') GROUP BY cct.kind, k.keyword ORDER BY average_production_year DESC, number_of_movies DESC;
SELECT it.info AS info_category, COUNT(DISTINCT mk.movie_id) AS number_of_movies, COUNT(mk.keyword_id) AS total_keyword_mentions, AVG(sub_query.avg_keyword_per_movie) AS average_keywords_per_movie FROM movie_keyword AS mk INNER JOIN keyword AS k ON mk.keyword_id = k.id INNER JOIN info_type AS it ON it.id = ANY(ARRAY[107, 103, 84, 8, 113]) LEFT JOIN (SELECT movie_id, AVG(keyword_count) AS avg_keyword_per_movie FROM (SELECT mk.movie_id, COUNT(mk.keyword_id) AS keyword_count FROM movie_keyword AS mk GROUP BY mk.movie_id) AS sub_query_1 GROUP BY movie_id) AS sub_query ON mk.movie_id = sub_query.movie_id WHERE mk.id IN (1632, 3030, 4546, 1918, 3771, 1414) AND mk.movie_id IN (15503, 12271, 9141) GROUP BY it.info;
SELECT a_t.title AS alternate_title, COUNT(c_i.id) AS total_cast_members, AVG(mi_idx.info::numeric) AS average_movie_rating, SUM(CASE WHEN a_t.production_year > 2000 THEN 1 ELSE 0 END) AS post_2000_titles_count FROM aka_title AS a_t JOIN cast_info AS c_i ON a_t.movie_id = c_i.movie_id JOIN movie_info_idx AS mi_idx ON a_t.movie_id = mi_idx.movie_id WHERE mi_idx.info_type_id = 100 AND a_t.movie_id IN ('8428', '19659') GROUP BY a_t.title;
SELECT COUNT(DISTINCT cn.id) AS num_companies, COUNT(DISTINCT chn.id) AS num_characters, AVG(CAST(mi_idx.info AS DECIMAL)) AS average_movie_rating, SUM(CASE WHEN kt.id = '4' THEN 1 ELSE 0 END) AS num_tv_series, COUNT(DISTINCT cc.movie_id) AS num_movies_with_complete_cast FROM company_name cn LEFT JOIN movie_companies mc ON cn.id = mc.company_id LEFT JOIN char_name chn ON chn.surname_pcode IN ('O416', 'M65', 'L5163') LEFT JOIN complete_cast cc ON mc.movie_id = cc.movie_id LEFT JOIN movie_info_idx mi_idx ON mc.movie_id = mi_idx.movie_id LEFT JOIN kind_type kt ON cc.subject_id = kt.id LEFT JOIN info_type it ON mi_idx.info_type_id = it.id AND it.info = 'rating' WHERE cn.name_pcode_nf IN ('L2416', 'A2321') AND ( cn.id = '152' OR kt.id = '4' OR it.id IN ('29', '49', '97', '78') ) GROUP BY cn.country_code;
SELECT AVG(mi_idx.info::numeric) AS average_movie_rating, COUNT(DISTINCT cn.id) AS number_of_companies, COUNT(DISTINCT k.id) AS number_of_unique_keywords, MAX(cn.name) AS largest_company_name, ct.kind AS company_type, MIN(lt.link) AS link_type_description, STRING_AGG(DISTINCT k.keyword, ', ') AS keywords_list FROM movie_info_idx mi_idx JOIN movie_keyword mk ON mi_idx.movie_id = mk.movie_id JOIN keyword k ON mk.keyword_id = k.id JOIN company_name cn ON cn.country_code = '[lv]' OR cn.country_code = '[by]' JOIN company_type ct ON cn.id = ct.id JOIN link_type lt ON lt.id = mi_idx.info_type_id WHERE mi_idx.info_type_id = (SELECT id FROM link_type WHERE link = 'edited from') AND (k.keyword = 'blind-woman' OR k.keyword = 'weather-forecasting') AND cn.name_pcode_sf IN ('O2163', 'G4214', 'A4314') GROUP BY ct.kind ORDER BY average_movie_rating DESC;
SELECT AVG(CAST(mi_idx.info AS decimal)) AS average_rating, COUNT(DISTINCT ci.movie_id) AS number_of_movies, COUNT(DISTINCT ci.person_id) AS number_of_actors, SUM(CASE WHEN mc.company_type_id = 2 THEN 1 ELSE 0 END) AS number_of_distributors, n.gender, ki.keyword FROM cast_info AS ci JOIN movie_info_idx AS mi_idx ON ci.movie_id = mi_idx.movie_id JOIN movie_companies AS mc ON ci.movie_id = mc.movie_id JOIN name AS n ON ci.person_id = n.id JOIN keyword AS ki ON mi_idx.info_type_id = ki.id WHERE ci.role_id = 1 AND n.gender IS NOT NULL AND mi_idx.info_type_id = (SELECT id FROM info_type WHERE info = 'rating') AND mc.company_type_id = (SELECT id FROM company_type WHERE kind = 'distributor') GROUP BY n.gender, ki.keyword HAVING COUNT(DISTINCT ci.movie_id) > 10 ORDER BY average_rating DESC, number_of_movies DESC;
SELECT cn.country_code, COUNT(DISTINCT cn.id) AS num_companies, AVG(mi_idx.id) AS avg_movie_info_idx_id, SUM(CASE WHEN mi.info_type_id = mi_idx.info_type_id THEN 1 ELSE 0 END) AS sum_matching_info_types, COUNT(DISTINCT pi.person_id) AS num_people FROM company_name AS cn LEFT JOIN movie_info_idx AS mi_idx ON cn.imdb_id = mi_idx.movie_id LEFT JOIN movie_info AS mi ON mi.movie_id = mi_idx.movie_id LEFT JOIN person_info AS pi ON pi.info_type_id = mi.info_type_id WHERE cn.country_code = '[be]' AND mi_idx.movie_id IN ('925666', '929198', '939783', '925877', '930515', '925116') AND cn.md5sum IN ('6490953d16a7d7a36b9daafe4a9e84b6', 'b68f1bd9708e765d511e6e251f56419a', '11b8906a4c994a2996176bba270124ac', '8eb39544eea1fca12f1a46d1747c807c') GROUP BY cn.country_code;
SELECT kt.kind, COUNT(DISTINCT at.movie_id) AS number_of_movies, COUNT(at.id) AS number_of_alt_titles, AVG(at.production_year) AS average_production_year, SUM(CASE WHEN at.episode_of_id IS NOT NULL THEN 1 ELSE 0 END) AS number_of_episodes FROM aka_title at INNER JOIN comp_cast_type kt ON at.kind_id = kt.id GROUP BY kt.kind ORDER BY number_of_movies DESC;
SELECT kt.kind AS movie_kind, COUNT(DISTINCT at.id) AS total_titles, COUNT(DISTINCT al.id) AS total_links, AVG(at.production_year) AS average_production_year, SUM(CASE WHEN at.kind_id = kt.id AND kt.kind = 'movie' THEN 1 ELSE 0 END) AS total_movies, SUM(CASE WHEN at.kind_id = kt.id AND kt.kind = 'tv series' THEN 1 ELSE 0 END) AS total_tv_series FROM aka_title AS at JOIN kind_type AS kt ON at.kind_id = kt.id LEFT JOIN movie_link AS al ON at.movie_id = al.movie_id GROUP BY kt.kind ORDER BY total_titles DESC;
SELECT ct.kind AS company_type, AVG(at.production_year) AS average_production_year, COUNT(DISTINCT at.id) AS total_alternate_titles, COUNT(DISTINCT cn.id) AS total_companies, SUM(CASE WHEN at.kind_id = 1 THEN 1 ELSE 0 END) AS feature_films, SUM(CASE WHEN at.kind_id = 2 THEN 1 ELSE 0 END) AS short_films, SUM(CASE WHEN at.kind_id = 3 THEN 1 ELSE 0 END) AS tv_movies, COUNT(DISTINCT pi.person_id) AS total_individual_contributors FROM company_type ct JOIN company_name cn ON cn.country_code = 'US' JOIN movie_companies mc ON mc.company_id = cn.id AND mc.company_type_id = ct.id JOIN aka_title at ON at.movie_id = mc.movie_id LEFT JOIN person_info pi ON pi.info LIKE '%@%' WHERE at.kind_id IN (1, 2, 3, 4, 7) AND at.production_year BETWEEN 1990 AND 2020 GROUP BY ct.kind;
