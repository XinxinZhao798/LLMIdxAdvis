SELECT n.name AS actor_name, COUNT(ci.person_id) AS total_movies, AVG(t.production_year) AS average_production_year, SUM(CASE WHEN ct.kind = 'distributors' THEN 1 ELSE 0 END) AS total_distributions, COUNT(DISTINCT k.id) AS unique_keywords_used FROM name AS n JOIN cast_info AS ci ON n.id = ci.person_id JOIN title AS t ON ci.movie_id = t.id JOIN movie_companies AS mc ON t.id = mc.movie_id JOIN company_type AS ct ON mc.company_type_id = ct.id LEFT JOIN keyword AS k ON t.id = k.id WHERE n.name IN ('Anderson, Adisa', 'Amer, Hammomi', 'Anderson, Franklyn J.') GROUP BY n.name ORDER BY total_movies DESC, average_production_year DESC;
SELECT CT.kind AS cast_type, COUNT(DISTINCT ml.movie_id) AS total_movies, AVG(CASE WHEN mi.info_type_id = 4 THEN CAST(mi.info AS INTEGER) END) AS avg_movie_length, SUM(CASE WHEN mi.info_type_id = 2 THEN CAST(mi.info AS NUMERIC) END) AS total_budget, COUNT(DISTINCT an.person_id) AS total_unique_actors FROM movie_link AS ml JOIN comp_cast_type AS CT ON ml.link_type_id = CT.id LEFT JOIN movie_info AS mi ON ml.movie_id = mi.movie_id LEFT JOIN aka_name AS an ON an.person_id = ml.linked_movie_id WHERE ml.link_type_id IN ('11', '17', '1', '16', '3') AND ml.movie_id IN ('16168', '2666', '6637', '12189') AND an.name_pcode_nf = 'Y2462' AND CT.kind = 'complete' GROUP BY CT.kind;
SELECT kt.kind AS movie_type, COUNT(t.id) AS total_movies, AVG(t.production_year) AS avg_production_year, MIN(t.production_year) AS earliest_production_year, MAX(t.production_year) AS latest_production_year FROM title t JOIN (SELECT id, kind FROM comp_cast_type WHERE kind IN ('director', 'actor')) cct ON t.kind_id = cct.id LEFT JOIN (SELECT id, kind FROM kind_type) kt ON t.kind_id = kt.id GROUP BY kt.kind ORDER BY total_movies DESC;
SELECT ct.kind AS company_kind, AVG(mi.info::numeric) AS average_movie_length, COUNT(DISTINCT ci.person_id) AS number_of_actors, COUNT(DISTINCT mc.movie_id) AS number_of_movies, COUNT(DISTINCT ml.link_type_id) AS distinct_link_types, SUM(CASE WHEN pi.info_type_id = '26' THEN 1 ELSE 0 END) AS count_info_type_26, SUM(CASE WHEN pi.info_type_id = '23' THEN 1 ELSE 0 END) AS count_info_type_23, SUM(CASE WHEN pi.info_type_id = '34' THEN 1 ELSE 0 END) AS count_info_type_34 FROM movie_companies AS mc JOIN comp_cast_type AS ct ON mc.company_type_id = ct.id JOIN movie_info AS mi ON mc.movie_id = mi.movie_id JOIN cast_info AS ci ON mc.movie_id = ci.movie_id JOIN movie_link AS ml ON mc.movie_id = ml.movie_id JOIN person_info AS pi ON ci.person_id = pi.person_id WHERE mi.info_type_id = (SELECT id FROM info_type WHERE info = 'runtime') AND mc.note NOT LIKE '%(TV)%' AND mc.note LIKE '%(USA)%' AND pi.person_id IN ('2159', '1740245', '2140') GROUP BY ct.kind HAVING COUNT(DISTINCT ci.person_id) > 10;
SELECT kt.kind AS movie_kind, AVG(t.production_year) AS average_production_year, COUNT(DISTINCT t.id) AS total_movies, COUNT(DISTINCT mi.info) AS unique_info_types, SUM(CASE WHEN t.season_nr IN ('8', '20', '12', '24', '33') THEN 1 ELSE 0 END) AS count_specific_seasons, COUNT(DISTINCT pi.person_id) AS total_persons_involved FROM title AS t JOIN kind_type AS kt ON t.kind_id = kt.id LEFT JOIN movie_info_idx AS mi ON t.id = mi.movie_id LEFT JOIN person_info AS pi ON pi.person_id = t.id GROUP BY kt.kind ORDER BY total_movies DESC;
SELECT COUNT(*) AS total_movies, AVG(aka_title.production_year) AS average_production_year, SUM(CASE WHEN comp_cast_type.kind = 'complete' THEN 1 ELSE 0 END) AS total_complete_cast_movies, SUM(CASE WHEN comp_cast_type.kind = 'complete+verified' THEN 1 ELSE 0 END) AS total_verified_cast_movies, COUNT(DISTINCT char_name.name) AS distinct_character_names, COUNT(DISTINCT keyword.id) AS total_keywords, MAX(movie_companies.company_type_id) AS max_company_type_id FROM aka_title JOIN movie_keyword ON aka_title.movie_id = movie_keyword.movie_id JOIN keyword ON movie_keyword.keyword_id = keyword.id JOIN movie_companies ON aka_title.movie_id = movie_companies.movie_id JOIN comp_cast_type ON movie_companies.company_type_id = comp_cast_type.id JOIN char_name ON char_name.name = aka_title.note WHERE aka_title.production_year BETWEEN 1990 AND 2000 AND movie_companies.company_type_id = 1 AND aka_title.kind_id = 1 AND (char_name.name IN ('Vereshchagin', 'Old Man on Street', 'Hadhod', 'Uncle Carl Ã…kerblom') OR movie_keyword.movie_id IN ('15386', '18793')) GROUP BY aka_title.kind_id ORDER BY total_movies DESC;
SELECT COUNT(DISTINCT at.id) AS total_titles, AVG(at.production_year) AS average_production_year, COUNT(DISTINCT at.episode_of_id) AS total_series, SUM(CASE WHEN at.kind_id = 1 THEN 1 ELSE 0 END) AS total_movies, SUM(CASE WHEN at.kind_id = 3 THEN 1 ELSE 0 END) AS total_tv_shows, SUM(CASE WHEN at.kind_id = 4 THEN 1 ELSE 0 END) AS total_videos, COUNT(DISTINCT ct.id) AS total_company_types, COUNT(DISTINCT cct.id) AS total_cast_types, COUNT(DISTINCT lt.id) AS total_link_types FROM aka_title at LEFT JOIN company_type ct ON at.movie_id = ct.id LEFT JOIN comp_cast_type cct ON at.kind_id = cct.id LEFT JOIN link_type lt ON at.id = lt.id WHERE at.production_year BETWEEN 1990 AND 2000 AND at.phonetic_code IN ('S1232', 'W5165') AND ct.id IS NOT NULL AND cct.id IN (1) AND lt.id IN (12, 2, 4, 15);
SELECT it.info AS info_category, COUNT(DISTINCT mc.movie_id) AS number_of_movies, COUNT(DISTINCT mc.company_id) AS number_of_companies, AVG(n.imdb_id) AS average_imdb_id, SUM(CASE WHEN n.gender = 'M' THEN 1 ELSE 0 END) AS male_count, SUM(CASE WHEN n.gender = 'F' THEN 1 ELSE 0 END) AS female_count, MAX(n.name) AS max_name FROM movie_companies mc JOIN person_info pi ON mc.company_id = pi.person_id JOIN info_type it ON pi.info_type_id = it.id JOIN name n ON pi.person_id = n.id GROUP BY it.info ORDER BY number_of_movies DESC, number_of_companies DESC;
SELECT AVG(mc.company_id) AS average_company_id, COUNT(DISTINCT ml.movie_id) AS linked_movies_count, SUM(CASE WHEN mi.info = 'Tatar' THEN 1 ELSE 0 END) AS tatar_movies_count, SUM(CASE WHEN mi.info = 'Hebrew' THEN 1 ELSE 0 END) AS hebrew_movies_count, SUM(CASE WHEN mi.info = 'Inuktitut' THEN 1 ELSE 0 END) AS inuktitut_movies_count, COUNT(DISTINCT an.person_id) AS unique_actors_count FROM movie_companies AS mc JOIN movie_link AS ml ON mc.movie_id = ml.movie_id JOIN movie_info AS mi ON mc.movie_id = mi.movie_id LEFT JOIN aka_name AS an ON an.surname_pcode = mi.info WHERE an.name_pcode_cf IN ('V3415', 'A5163', 'B6525') AND mi.info IN ('Tatar', 'Hebrew', 'Inuktitut') GROUP BY mc.company_type_id;
SELECT kt.kind AS movie_kind, COUNT(DISTINCT t.movie_id) AS total_movies, AVG(CASE WHEN mc.note LIKE '%(worldwide) (all media)%' THEN 1 ELSE NULL END) * 100 AS percentage_worldwide_distribution, COUNT(DISTINCT lt.id) FILTER (WHERE lt.link LIKE '%remake of%') AS total_remakes, AVG(t.production_year) AS average_production_year, COUNT(DISTINCT ml.linked_movie_id) FILTER (WHERE ml.link_type_id IN ('17', '16')) AS total_sequel_or_prequels, COUNT(DISTINCT n.id) AS total_actors_involved FROM kind_type AS kt JOIN aka_title AS t ON kt.id = t.kind_id LEFT JOIN movie_companies AS mc ON t.movie_id = mc.movie_id LEFT JOIN link_type AS lt ON lt.id = mc.company_type_id LEFT JOIN movie_link AS ml ON t.movie_id = ml.movie_id LEFT JOIN movie_info AS mi ON t.movie_id = mi.movie_id AND mi.info_type_id = '4' LEFT JOIN name AS n ON n.imdb_id = t.movie_id GROUP BY kt.kind;
SELECT COUNT(DISTINCT t.id) AS total_movies, SUM(mc.company_id) AS total_companies_involved, link_typ.LINK AS link_type, COUNT(DISTINCT mk.keyword_id) AS unique_keywords_used, COUNT(DISTINCT ml.linked_movie_id) AS total_linked_movies FROM title AS t JOIN movie_companies AS mc ON t.id = mc.movie_id JOIN movie_keyword AS mk ON t.id = mk.movie_id JOIN movie_link AS ml ON t.id = ml.movie_id JOIN link_type AS link_typ ON link_typ.id = ml.link_type_id WHERE t.production_year BETWEEN 2000 AND 2020 AND mc.company_type_id = 2 AND link_typ.id IN (3, 10, 6, 15, 11) AND mk.movie_id IN (13936, 8886, 13347, 7802, 15519, 18796) GROUP BY link_typ.LINK ORDER BY total_movies DESC;
SELECT rt.ROLE, COUNT(ci.id) AS total_roles, AVG(ci.nr_order) AS average_order, SUM(mc.company_id) AS total_company_involvement FROM cast_info ci JOIN role_type rt ON ci.role_id = rt.id JOIN movie_companies mc ON ci.movie_id = mc.movie_id JOIN char_name cn ON ci.person_id = cn.id JOIN link_type lt ON cn.imdb_id = lt.id WHERE cn.surname_pcode IN ('M252', 'E4253', 'S3626', 'D535', 'K6524', 'P3625') AND cn.md5sum IN ('9e82cce9eed474fa357bbbdcdb9e9f99', '808e4e20a938e31d406296247307a377', '314b308705241e3843cfa0f420a3d71d', '161ebf33e0bbb8c7a20bed4ba04289b5') AND lt.link IN ('alternate language version of', 'spin off', 'referenced in', 'remade as', 'references', 'version of') AND lt.id IN ('17', '8', '6') GROUP BY rt.ROLE ORDER BY total_roles DESC;
SELECT AVG(ak.production_year) AS average_production_year, COUNT(DISTINCT ci.movie_id) AS number_of_movies_casted, COUNT(DISTINCT cn.id) AS number_of_companies, SUM(CASE WHEN mi.info = 'Color' THEN 1 ELSE 0 END) AS color_movie_count, COUNT(DISTINCT ml.linked_movie_id) AS number_of_linked_movies FROM aka_title AS ak JOIN cast_info AS ci ON ak.movie_id = ci.movie_id JOIN company_name AS cn ON cn.md5sum IN ('6596ca830de5c8b7ec94b67c784e1a83', '0ad6c9035d400a497468ec039779ec3a', '6bca80dc1d9813e39427976f934f43bf', '37fac2d56e57bccc911e51e0e7830631', 'f8ebe23c1526539a4a78e7d7a3d8511e') JOIN movie_info_idx AS mi ON ak.movie_id = mi.movie_id AND mi.id = 2825 JOIN movie_link AS ml ON ak.movie_id = ml.movie_id AND ml.link_type_id = 15 WHERE ak.note IN ('(USA) (alternative spelling)', '(Finland: Swedish title) (alternative title)') GROUP BY ak.kind_id;
SELECT it.info AS info_type, COUNT(*) AS total_titles, AVG(t.production_year) AS average_production_year, SUM(CASE WHEN lt.link = 'followed by' THEN 1 ELSE 0 END) AS followed_by_count, SUM(CASE WHEN lt.link = 'similar to' THEN 1 ELSE 0 END) AS similar_to_count, SUM(CASE WHEN lt.link = 'unknown link' THEN 1 ELSE 0 END) AS unknown_link_count FROM title t JOIN movie_info mi ON t.id = mi.movie_id JOIN info_type it ON mi.info_type_id = it.id JOIN movie_link ml ON t.id = ml.movie_id JOIN link_type lt ON ml.link_type_id = lt.id WHERE t.production_year > 1990 GROUP BY it.info ORDER BY total_titles DESC, average_production_year;
