SELECT COUNT(DISTINCT t.id) AS number_of_movies, AVG(t.production_year) AS average_production_year, SUM(CASE WHEN t.kind_id = 1 THEN 1 ELSE 0 END) AS number_of_feature_films, SUM(CASE WHEN t.kind_id = 2 THEN 1 ELSE 0 END) AS number_of_tv_shows, COUNT(DISTINCT n.id) AS number_of_cast_members, COUNT(DISTINCT cc.subject_id) AS number_of_cast_types, AVG(cc.status_id) AS average_status_id FROM title AS t JOIN complete_cast AS cc ON t.id = cc.movie_id JOIN name AS n ON cc.subject_id = n.id WHERE cc.status_id = 4 AND t.production_year > 1990 GROUP BY t.kind_id ORDER BY number_of_movies DESC, average_production_year DESC;
SELECT kt.kind AS movie_genre, AVG(mi_idx.note::int) AS average_rating, COUNT(DISTINCT k.id) AS unique_keywords, SUM(CASE WHEN cct.kind = 'complete' THEN 1 ELSE 0 END) AS complete_cast_movies, SUM(CASE WHEN cct.kind = 'complete+verified' THEN 1 ELSE 0 END) AS verified_cast_movies FROM movie_info_idx mi_idx JOIN movie_link ml ON mi_idx.movie_id = ml.movie_id JOIN keyword k ON ml.link_type_id = k.id JOIN kind_type kt ON mi_idx.info_type_id = kt.id JOIN complete_cast cc ON mi_idx.movie_id = cc.movie_id JOIN comp_cast_type cct ON cc.status_id = cct.id WHERE kt.kind IN ('drama', 'comedy', 'action') AND mi_idx.info LIKE '%rating%' AND k.keyword IN ('epic', 'cult', 'thriller', 'romance') GROUP BY kt.kind ORDER BY average_rating DESC;
SELECT it.info AS info_type, COUNT(DISTINCT mi.id) AS movie_count, AVG(mc.company_id) AS average_company_id, SUM(mc.company_id) AS sum_company_id, COUNT(DISTINCT ak.id) AS alias_count, rt.ROLE, COUNT(DISTINCT kw.id) AS keyword_count FROM movie_info_idx AS mi JOIN info_type AS it ON mi.info_type_id = it.id JOIN movie_companies AS mc ON mi.movie_id = mc.movie_id JOIN role_type AS rt ON mc.company_type_id = rt.id JOIN aka_name AS ak ON mi.movie_id = ak.person_id JOIN keyword AS kw ON ak.surname_pcode = kw.phonetic_code GROUP BY it.info, rt.ROLE ORDER BY movie_count DESC, average_company_id;
SELECT kt.kind AS movie_kind, COUNT(DISTINCT mc.movie_id) AS total_movies, COUNT(DISTINCT mc.company_id) AS total_companies_involved, AVG(CAST(an.id AS NUMERIC)) AS average_aka_name_id, SUM(CASE WHEN cn.country_code = 'US' THEN 1 ELSE 0 END) AS total_us_based_companies FROM movie_companies AS mc JOIN company_name AS cn ON mc.company_id = cn.id JOIN kind_type AS kt ON kt.id = mc.company_type_id LEFT JOIN aka_name AS an ON an.person_id = mc.id WHERE mc.movie_id IN ('23623', '12089', '22009', '20658', '18570', '31165') GROUP BY kt.kind;
SELECT COUNT(DISTINCT ci.movie_id) AS total_movies, AVG(ci.nr_order) AS average_cast_order, SUM(CASE WHEN ci.person_role_id IN (56, 1326) THEN 1 ELSE 0 END) AS count_special_roles, COUNT(DISTINCT cn.id) AS total_unique_characters, COUNT(DISTINCT k.id) AS total_unique_keywords, MAX(mi.info) AS longest_movie_info FROM cast_info ci JOIN char_name cn ON ci.person_id = cn.id JOIN movie_info mi ON ci.movie_id = mi.movie_id JOIN keyword k ON k.phonetic_code = 'O16' WHERE mi.info <> 'None' AND mi.info LIKE '%Czech%' GROUP BY ci.movie_id;
SELECT kt.kind AS movie_kind, AVG(aka.production_year) AS avg_production_year, COUNT(DISTINCT aka.movie_id) AS total_movies, COUNT(DISTINCT mc.company_id) AS total_companies_involved, SUM(CASE WHEN aka.kind_id = 4 THEN 1 ELSE 0 END) AS total_tv_series FROM aka_title aka JOIN kind_type kt ON aka.kind_id = kt.id LEFT JOIN movie_companies mc ON aka.movie_id = mc.movie_id GROUP BY kt.kind HAVING COUNT(DISTINCT aka.movie_id) > 100 ORDER BY avg_production_year DESC, total_movies;
SELECT k.keyword, ci.person_role_id, COUNT(DISTINCT ci.person_id) AS unique_person_count, COUNT(ci.movie_id) AS movie_count, AVG(ci.nr_order) AS average_cast_order FROM cast_info ci JOIN movie_keyword mk ON ci.movie_id = mk.movie_id JOIN keyword k ON mk.keyword_id = k.id WHERE k.phonetic_code IN ('V315', 'G2324') GROUP BY k.keyword, ci.person_role_id ORDER BY unique_person_count DESC, movie_count DESC;
SELECT kt.kind AS genre, COUNT(DISTINCT t.id) AS total_movies, ROUND(AVG(t.production_year)) AS average_production_year, COUNT(DISTINCT mk.keyword_id) AS total_keywords FROM title t INNER JOIN kind_type kt ON t.kind_id = kt.id LEFT JOIN movie_keyword mk ON t.id = mk.movie_id GROUP BY kt.kind ORDER BY total_movies DESC, average_production_year DESC;
SELECT AVG(acast.cnt) AS average_cast_per_movie, AVG(alink.link_cnt) AS average_links_per_movie, SUM(kw.keyword_count) AS total_keyword_occurrences, COUNT(DISTINCT atitle.movie_id) AS count_distinct_movies FROM (SELECT movie_id, COUNT(*) AS cnt FROM cast_info GROUP BY movie_id) AS acast JOIN aka_title atitle ON acast.movie_id = atitle.movie_id LEFT JOIN (SELECT movie_id, COUNT(*) AS link_cnt FROM movie_link GROUP BY movie_id) AS alink ON atitle.movie_id = alink.movie_id LEFT JOIN (SELECT movie_id, COUNT(*) AS keyword_count FROM keyword INNER JOIN movie_keyword ON keyword.id = movie_keyword.keyword_id GROUP BY movie_id) AS kw ON atitle.movie_id = kw.movie_id WHERE atitle.production_year IS NOT NULL AND atitle.production_year >= 2000 AND atitle.kind_id = 1 AND (atitle.note LIKE '%(International: English title)%' OR atitle.note LIKE '%(Hong Kong: Mandarin title)%') AND EXISTS (SELECT 1 FROM cast_info WHERE cast_info.movie_id = atitle.movie_id AND person_role_id IN (1210, 1072, 1419)) AND EXISTS (SELECT 1 FROM info_type WHERE id IN (68, 61)) AND EXISTS (SELECT 1 FROM keyword WHERE keyword IN ('assumed-identity', 'midnight-snack', 'dyslexia') AND id IN (SELECT keyword_id FROM movie_keyword WHERE movie_id = atitle.movie_id)) GROUP BY atitle.production_year ORDER BY atitle.production_year DESC;
SELECT nt.info AS movie_genre, COUNT(DISTINCT cn.id) AS num_of_actors, AVG((n.gender = 'M')::int) AS avg_male_actors, AVG((n.gender = 'F')::int) AS avg_female_actors, SUM(CASE WHEN cn.id IN ('75924', '37156', '79891', '61423', '79360') THEN 1 ELSE 0 END) AS special_char_count, cname.name AS frequent_production_company, MAX(mi_idx.info) AS longest_movie_description FROM char_name cn JOIN name n ON cn.id = n.id JOIN movie_info_idx mi_idx ON n.id = mi_idx.movie_id JOIN info_type nt ON mi_idx.info_type_id = nt.id JOIN movie_companies mc ON mi_idx.movie_id = mc.movie_id JOIN company_name cname ON mc.company_id = cname.id WHERE n.md5sum IN ('5867f236efd2a49e525e28170e53884f', 'e30d31437d0cc24a549ebe11e068d91c', '103b12a2a1f067552d1582f217894732', '937aa89fd20c81ec429381d29296632e', 'b19e28f6480e3653f20f36528b67ddfd', 'ee97cefd84759ed4ec46f94d2e8962ed') AND cname.name IN ('Jamtown Films', 'Ovie Entertainment', 'Canibal Friends', 'Rocket Sheep Boom', 'Yarnmaker', 'Toko-Tokuma') AND nt.info IN ('LD dialogue intellegibility', 'book', 'tech info') GROUP BY nt.info, cname.name ORDER BY num_of_actors DESC, avg_male_actors DESC;
SELECT COUNT(ci.id) AS total_cast_entries, AVG(t.production_year) AS average_production_year, SUM(CASE WHEN ci.note LIKE '%(as %' THEN 1 ELSE 0 END) AS total_alias_castings, MIN(t.title) AS earliest_title_alphabetically, MAX(t.production_year) AS latest_production_year, AVG(mi_idx.info::NUMERIC) AS avg_info_numeric_value FROM cast_info AS ci JOIN title AS t ON ci.movie_id = t.id JOIN movie_info_idx AS mi_idx ON t.id = mi_idx.movie_id WHERE ci.person_id IN (1095, 1184, 1812, 1636) AND mi_idx.info LIKE '...%' GROUP BY ci.person_id
SELECT COUNT(DISTINCT a.id) AS total_aka_titles, AVG(a.production_year) AS average_production_year, COUNT(DISTINCT m.company_id) AS total_companies_involved, COUNT(DISTINCT n.id) AS total_unique_names, COUNT(DISTINCT ml.movie_id) AS total_movies_with_links, SUM(CASE WHEN a.production_year BETWEEN 1990 AND 2000 THEN 1 ELSE 0 END) AS titles_from_90s FROM aka_title AS a JOIN movie_companies AS m ON a.movie_id = m.movie_id JOIN name AS n ON n.md5sum = a.md5sum LEFT JOIN movie_link AS ml ON a.movie_id = ml.movie_id WHERE a.production_year IS NOT NULL AND m.note IS NOT NULL AND n.gender IN ('F', 'M') GROUP BY n.gender ORDER BY total_aka_titles DESC;
SELECT ct.kind AS company_kind, AVG(t.production_year) AS average_production_year, COUNT(DISTINCT t.id) AS number_of_movies, SUM(CASE WHEN t.production_year >= 2000 THEN 1 ELSE 0 END) AS movies_since_2000 FROM title AS t JOIN movie_keyword AS mk ON t.id = mk.movie_id JOIN company_type AS ct ON t.kind_id = ct.id WHERE ct.kind IN ('special effects companies', 'distributors') AND t.production_year IS NOT NULL GROUP BY ct.kind;
SELECT k.keyword, COUNT(mk.movie_id) AS movie_count FROM keyword AS k JOIN movie_info_idx AS mk ON k.id = mk.info_type_id WHERE k.id IN (6020, 8681, 8319, 3964, 4363, 7683) GROUP BY k.keyword ORDER BY movie_count DESC;
SELECT kt.kind AS movie_type, COUNT(DISTINCT mk.movie_id) AS num_movies, AVG(cn.imdb_id::NUMERIC) AS average_imdb_id, SUM(CASE WHEN cn.country_code = 'us' THEN 1 ELSE 0 END) AS num_us_companies, COUNT(DISTINCT cn.id) AS num_companies_involved FROM movie_keyword AS mk JOIN movie_info AS mi ON mk.movie_id = mi.movie_id JOIN kind_type AS kt ON mi.info_type_id = kt.id AND kt.id IN ('2', '3', '4', '5', '6') JOIN company_name AS cn ON mk.movie_id = cn.imdb_id WHERE (mk.keyword_id IN ('3195', '2832', '4019', '2965', '3002') OR mi.info IN ('Albanian', 'Norwegian', 'Ladino', 'Filipino', 'Estonian')) AND cn.name_pcode_nf IN ('R5365', 'C514', 'E5314', 'L532') AND cn.id IN ('23278', '44380', '28077', '6858', '43412', '27250') GROUP BY kt.kind;
SELECT cc.kind AS cast_kind, AVG(cc.id) AS average_cast_id, CN.name AS company_name, COUNT(*) AS number_of_movies, SUM(MI.id) AS sum_movie_info_id, AVG(MI.info_type_id) AS average_info_type_id FROM cast_info CI JOIN comp_cast_type CC ON CI.person_role_id = CC.id JOIN company_name CN ON CN.country_code = CI.note JOIN movie_info_idx MI ON CI.movie_id = MI.movie_id WHERE CI.nr_order IN (56, 62, 2, 74) AND CI.movie_id IN (1884275, 2284142, 1084092) AND CN.country_code IN ('[xyu]', '[suhh]', '[lv]', '[nl]', '[cn]') AND CN.name_pcode_sf IN ('W4216', 'A4526', 'S4163', 'C1616') GROUP BY cc.kind, CN.name ORDER BY number_of_movies DESC, company_name;
SELECT kt.kind AS movie_kind, COUNT(DISTINCT ci.movie_id) AS number_of_movies, COUNT(DISTINCT ci.person_id) AS number_of_actors, AVG(ci.nr_order) AS average_cast_position, SUM(CASE WHEN ci.role_id = 1 THEN 1 ELSE 0 END) AS number_of_lead_roles FROM cast_info ci JOIN kind_type kt ON ci.role_id = kt.id JOIN char_name cn ON ci.person_role_id = cn.id WHERE ci.person_id IN (1097, 1215) AND ci.role_id = 1 AND kt.id = 7 GROUP BY kt.kind;
SELECT mc.company_id, COUNT(DISTINCT mc.movie_id) AS total_movies_produced, AVG(subquery.keyword_count) AS avg_keywords_per_movie, COUNT(DISTINCT pi.person_id) AS unique_roles_involved FROM movie_companies AS mc LEFT JOIN (SELECT mk.movie_id, COUNT(mk.keyword_id) AS keyword_count FROM movie_keyword AS mk GROUP BY mk.movie_id) AS subquery ON mc.movie_id = subquery.movie_id LEFT JOIN person_info AS pi ON mc.movie_id = pi.person_id WHERE mc.company_id = 947 GROUP BY mc.company_id;
SELECT n.gender, COUNT(DISTINCT ci.person_id) AS total_actors, AVG(ci.nr_order) AS avg_cast_order, COUNT(DISTINCT mc.movie_id) AS total_movies, COUNT(DISTINCT mc.company_id) AS total_companies, SUM(CASE WHEN ct.kind = 'production' THEN 1 ELSE 0 END) AS total_production_roles, SUM(CASE WHEN ct.kind = 'distributors' THEN 1 ELSE 0 END) AS total_distributor_roles FROM name AS n JOIN cast_info AS ci ON n.id = ci.person_id JOIN movie_companies AS mc ON ci.movie_id = mc.movie_id JOIN company_type AS ct ON mc.company_type_id = ct.id WHERE n.gender = 'm' AND ci.role_id = 1 AND mc.company_id IN (1057, 946, 317, 31, 1181, 84) AND ci.note NOT LIKE '%(voice)%' GROUP BY n.gender;
