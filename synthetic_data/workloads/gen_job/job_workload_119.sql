SELECT rt.ROLE AS role_type, COUNT(DISTINCT ci.id) AS total_actors, AVG(at.production_year) AS average_production_year, SUM(mc.company_id) AS total_companies_involved, COUNT(DISTINCT cn.id) AS total_character_names, COUNT(DISTINCT at.id) AS total_alternative_titles FROM cast_info ci JOIN role_type rt ON ci.role_id = rt.id JOIN aka_title at ON ci.movie_id = at.movie_id JOIN movie_companies mc ON ci.movie_id = mc.movie_id JOIN char_name cn ON ci.person_id = cn.id WHERE rt.ROLE = 'director' AND mc.company_type_id = 1 AND cn.md5sum IN ('4ddcdcf6282d436a10b411b7016b9fb2', '4e926214a66707706c1fe2bb2f000f18') AND at.note LIKE '%(video box title)%' GROUP BY rt.ROLE;
SELECT lt.LINK AS link_type, COUNT(DISTINCT ml.movie_id) AS number_of_movies, AVG(mi_idx_rank.info::FLOAT) AS average_movie_rank, COUNT(DISTINCT pi.person_id) AS number_of_people_involved, COUNT(DISTINCT mc.company_id) AS number_of_companies_involved FROM link_type AS lt JOIN movie_link AS ml ON lt.id = ml.link_type_id LEFT JOIN movie_info AS mi_idx_rank ON mi_idx_rank.movie_id = ml.movie_id AND mi_idx_rank.info_type_id = (SELECT id FROM info_type WHERE info = 'rank') LEFT JOIN movie_companies AS mc ON mc.movie_id = ml.movie_id LEFT JOIN person_info AS pi ON pi.info_type_id = (SELECT id FROM info_type WHERE info = 'biography') AND pi.info LIKE '%actor%' WHERE lt.link IN ('follows', 'edited from') AND (mc.note LIKE '(2009)%' OR mc.note LIKE '(2012)%' OR mc.note LIKE '(2000-????)%') AND ml.movie_id IN ('7361', '14633') GROUP BY lt.LINK ORDER BY average_movie_rank DESC;
SELECT c.name AS company_name, COUNT(DISTINCT t.id) AS number_of_movies, AVG(t.production_year) AS average_production_year, SUM(CASE WHEN t.kind_id = 1 THEN 1 ELSE 0 END) AS total_feature_films, SUM(CASE WHEN t.kind_id = 2 THEN 1 ELSE 0 END) AS total_tv_shows, COUNT(DISTINCT mk.keyword_id) AS total_unique_keywords FROM company_name c JOIN movie_keyword mk ON c.id = mk.keyword_id JOIN title t ON mk.movie_id = t.id WHERE c.country_code IN ('US', 'GB') AND t.production_year BETWEEN 1990 AND 2000 GROUP BY c.name HAVING COUNT(DISTINCT t.id) > 10 ORDER BY total_feature_films DESC, total_tv_shows DESC;
SELECT mi.info AS genre, COUNT(DISTINCT t.id) AS number_of_movies, AVG(mi_idx.info::numeric) AS average_rating, COUNT(DISTINCT p.id) AS number_of_cast_members, SUM(CASE WHEN t.production_year BETWEEN 2000 AND 2010 THEN 1 ELSE 0 END) AS movies_2000_2010 FROM movie_info mi JOIN title t ON mi.movie_id = t.id LEFT JOIN movie_info mi_idx ON t.id = mi_idx.movie_id AND mi_idx.info_type_id = 4 JOIN complete_cast cc ON t.id = cc.movie_id JOIN person_info p ON cc.subject_id = p.person_id JOIN movie_companies mc ON t.id = mc.movie_id WHERE mi.info_type_id = 3 AND cc.status_id = 1 AND mc.company_type_id = 2 GROUP BY mi.info ORDER BY number_of_movies DESC, average_rating DESC;
SELECT mk.keyword_id, COUNT(DISTINCT ci.movie_id) AS number_of_movies, COUNT(ci.person_id) AS total_cast_members, AVG(CAST(ci.nr_order AS DECIMAL)) AS average_cast_order FROM movie_keyword AS mk INNER JOIN cast_info AS ci ON mk.movie_id = ci.movie_id INNER JOIN link_type AS lt ON ci.person_role_id = lt.id WHERE lt.link IN ('followed by', 'edited into', 'similar to') GROUP BY mk.keyword_id ORDER BY number_of_movies DESC, average_cast_order ASC;
SELECT AVG(title.production_year) AS average_production_year, COUNT(DISTINCT name.id) AS number_of_actors, COUNT(DISTINCT title.id) AS number_of_movies, SUM(CASE WHEN name.gender = 'M' THEN 1 ELSE 0 END) AS number_of_male_actors, SUM(CASE WHEN name.gender = 'F' THEN 1 ELSE 0 END) AS number_of_female_actors, MAX(title.production_year) AS latest_production_year, MIN(title.production_year) AS earliest_production_year FROM title JOIN aka_title ON title.id = aka_title.movie_id JOIN person_info ON aka_title.movie_id = person_info.person_id JOIN name ON person_info.person_id = name.id WHERE title.production_year BETWEEN 2000 AND 2020 AND name.name_pcode_nf IN ('N4532', 'H6341', 'M2164') GROUP BY title.kind_id HAVING COUNT(DISTINCT title.id) > 10 ORDER BY average_production_year DESC, number_of_movies DESC;
SELECT kind.kind as cast_type, avg(mi_idx.info::numeric) as average_rating, count(distinct mk.movie_id) as number_of_movies_with_keywords, count(distinct pi.person_id) as number_of_persons_associated, sum(case when at.production_year > 2000 then 1 else 0 end) as movies_after_2000 FROM movie_info_idx mi_idx JOIN info_type it ON mi_idx.info_type_id = it.id AND it.id = 48 JOIN movie_keyword mk ON mi_idx.movie_id = mk.movie_id JOIN aka_title at ON mi_idx.movie_id = at.movie_id JOIN comp_cast_type kind ON at.kind_id = kind.id LEFT JOIN person_info pi ON mi_idx.movie_id = pi.person_id WHERE at.production_year IS NOT NULL AND at.production_year >= 1990 AND mi_idx.info::numeric > 2.0 GROUP BY kind.kind ORDER BY average_rating DESC;
SELECT COUNT(DISTINCT ci.person_id) AS total_actors, AVG(ci.nr_order) AS average_cast_order, SUM(CASE WHEN ci.role_id = 1 THEN 1 ELSE 0 END) AS total_leading_roles, COUNT(DISTINCT mk.movie_id) AS total_movies_with_keywords, COUNT(DISTINCT mc.company_id) AS total_production_companies_involved, COUNT(DISTINCT cc.movie_id) AS total_movies_with_complete_cast FROM cast_info ci LEFT JOIN movie_keyword mk ON ci.movie_id = mk.movie_id LEFT JOIN movie_companies mc ON ci.movie_id = mc.movie_id LEFT JOIN complete_cast cc ON ci.movie_id = cc.movie_id WHERE ci.note NOT LIKE '%(uncredited)%' AND mk.keyword_id IN (3630, 3933, 2868, 3441, 70) AND ci.role_id = 1;
