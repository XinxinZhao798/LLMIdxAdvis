SELECT COUNT(DISTINCT mc.movie_id) AS number_of_movies, AVG(CAST(mi_idx.info AS NUMERIC)) AS average_rating, COUNT(DISTINCT ml.linked_movie_id) AS linked_movies_count, SUM(CASE WHEN n.gender = 'F' THEN 1 ELSE 0 END) AS female_participants_count, SUM(CASE WHEN n.gender = 'M' THEN 1 ELSE 0 END) AS male_participants_count, MAX(t.production_year) AS latest_movie_year, MIN(t.production_year) AS oldest_movie_year FROM movie_companies AS mc JOIN title AS t ON mc.movie_id = t.id JOIN movie_info_idx AS mi_idx ON t.id = mi_idx.movie_id AND mi_idx.info_type_id = 101 LEFT JOIN movie_link AS ml ON t.id = ml.movie_id LEFT JOIN name AS n ON t.id = n.id WHERE mc.company_type_id = 1 GROUP BY mc.company_id ORDER BY number_of_movies DESC, average_rating DESC;
SELECT kt.kind AS movie_kind, AVG(t.production_year) AS avg_production_year, SUM(CASE WHEN rt.role = 'actress' THEN 1 ELSE 0 END) AS total_actress_roles, SUM(CASE WHEN rt.role = 'producer' THEN 1 ELSE 0 END) AS total_producer_roles, COUNT(DISTINCT mc.company_id) AS number_of_companies_involved FROM title AS t JOIN kind_type AS kt ON t.kind_id = kt.id LEFT JOIN movie_companies AS mc ON t.id = mc.movie_id LEFT JOIN movie_info AS mi ON t.id = mi.movie_id LEFT JOIN role_type AS rt ON mi.info_type_id = rt.id AND rt.role IN ('actress', 'producer') GROUP BY kt.kind ORDER BY number_of_companies_involved DESC, avg_production_year;
SELECT COUNT(DISTINCT ci.person_id) AS total_actors, COUNT(DISTINCT mc.company_id) AS total_production_companies, AVG(COUNT(mi.id)) OVER (PARTITION BY mc.movie_id) AS average_info_per_movie FROM movie_companies mc INNER JOIN cast_info ci ON mc.movie_id = ci.movie_id AND ci.role_id = (SELECT id FROM comp_cast_type WHERE kind = 'actor') INNER JOIN movie_info mi ON mc.movie_id = mi.movie_id WHERE mc.company_type_id = (SELECT id FROM company_type WHERE kind = 'production companies') GROUP BY mc.movie_id;
SELECT t.production_year, COUNT(DISTINCT t.id) AS total_movies, COUNT(DISTINCT mc.company_id) AS total_production_companies, AVG(CAST(mi_idx.info AS NUMERIC)) AS average_rating, SUM(CASE WHEN t.kind_id = 2 THEN 1 ELSE 0 END) AS total_movies_kind_2, SUM(CASE WHEN t.kind_id = 7 THEN 1 ELSE 0 END) AS total_movies_kind_7 FROM title AS t LEFT JOIN movie_companies AS mc ON t.id = mc.movie_id LEFT JOIN movie_info_idx AS mi_idx ON t.id = mi_idx.movie_id AND mi_idx.info_type_id = ( SELECT id FROM info_type WHERE info = 'rating' ) WHERE t.production_year BETWEEN 2000 AND 2010 AND (mc.note LIKE '%(USA) (TV)%' OR mc.note LIKE '%(UK) (TV)%') GROUP BY t.production_year ORDER BY t.production_year;
SELECT SUM(mc.company_id) AS total_company_ids, AVG(CASE WHEN mc.company_type_id = 1 THEN mc.movie_id ELSE NULL END) AS average_movie_id_for_type_1, COUNT(DISTINCT ml.link_type_id) AS unique_link_types, COUNT(DISTINCT pi.person_id) AS unique_person_count, AVG(CASE WHEN pi.info_type_id = 5 THEN LENGTH(pi.info) ELSE NULL END) AS average_info_length_for_type_5 FROM movie_companies mc FULL OUTER JOIN movie_link ml ON mc.movie_id = ml.movie_id FULL OUTER JOIN person_info pi ON mc.company_id = pi.person_id GROUP BY mc.company_type_id;
SELECT mi.info AS genre, COUNT(DISTINCT t.id) AS number_of_movies, AVG(mi_idx.info::numeric) AS average_rating, COUNT(DISTINCT p.id) AS number_of_cast_members, SUM(CASE WHEN t.production_year BETWEEN 2000 AND 2010 THEN 1 ELSE 0 END) AS movies_2000_2010 FROM movie_info mi JOIN title t ON mi.movie_id = t.id LEFT JOIN movie_info mi_idx ON t.id = mi_idx.movie_id AND mi_idx.info_type_id = 4 JOIN complete_cast cc ON t.id = cc.movie_id JOIN person_info p ON cc.subject_id = p.person_id JOIN movie_companies mc ON t.id = mc.movie_id WHERE mi.info_type_id = 3 AND cc.status_id = 1 AND mc.company_type_id = 2 GROUP BY mi.info ORDER BY number_of_movies DESC, average_rating DESC;
SELECT COUNT(DISTINCT cn.id) AS total_characters, AVG(mii.movie_id) AS average_movie_id, SUM(CASE WHEN kt.keyword_id IS NOT NULL THEN 1 ELSE 0 END) AS total_keywords_linked, COUNT(DISTINCT cc.movie_id) AS total_movies_with_complete_cast, MAX(mii_idx.info) AS max_movie_votes FROM char_name cn LEFT JOIN movie_info_idx mii_idx ON cn.id = mii_idx.movie_id LEFT JOIN complete_cast cc ON cc.movie_id = mii_idx.movie_id LEFT JOIN movie_info_idx mii ON mii.movie_id = cc.movie_id LEFT JOIN keyword k ON k.phonetic_code LIKE 'A%' LEFT JOIN ( SELECT mk.movie_id, mk.keyword_id FROM movie_keyword mk INNER JOIN keyword k ON k.id = mk.keyword_id WHERE k.phonetic_code = 'A323' OR k.phonetic_code = 'B124' ) AS kt ON kt.movie_id = mii.movie_id WHERE cn.name_pcode_nf IN ('C614', 'J525', 'C6346', 'A4152') AND cc.id IN ('2966', '2652', '3214', '2072', '724', '2015') GROUP BY cn.surname_pcode;
SELECT kt.kind, AVG(CAST(mi.info AS NUMERIC)) AS average_rating, COUNT(DISTINCT t.id) AS total_movies, COUNT(DISTINCT n.id) AS total_directors, MAX(t.production_year) AS latest_movie_year FROM title AS t JOIN kind_type AS kt ON t.kind_id = kt.id JOIN movie_info AS mi ON t.id = mi.movie_id LEFT JOIN person_info AS pi ON pi.person_id = t.id AND pi.info_type_id = mi.info_type_id JOIN name AS n ON n.id = pi.person_id WHERE mi.info_type_id = 4 AND kt.id IN (4, 5, 1, 6, 3) AND ( mi.note IS NULL OR mi.note IN ('(Original version)', '(none)', '(some dialogue)') ) GROUP BY kt.kind ORDER BY average_rating DESC, total_movies DESC;
