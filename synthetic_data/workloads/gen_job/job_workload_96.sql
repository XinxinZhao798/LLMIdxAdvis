SELECT rt.role, AVG(t.production_year) AS average_production_year, COUNT(DISTINCT t.id) AS movie_count FROM role_type rt JOIN movie_info_idx mii ON rt.id = mii.info_type_id JOIN title t ON mii.movie_id = t.id JOIN info_type it ON mii.info_type_id = it.id WHERE it.info = 'LD contrast' AND it.id IN ('74', '69') GROUP BY rt.role ORDER BY movie_count DESC, average_production_year DESC;
SELECT mc.company_type_id, COUNT(DISTINCT mc.movie_id) AS total_movies, COUNT(DISTINCT mc.company_id) AS total_companies, AVG(k.id) AS average_keyword_id, COUNT(DISTINCT n.id) AS total_unique_cast_members, MAX(n.name) AS most_recent_cast_member_name FROM movie_companies mc JOIN keyword k ON mc.movie_id = k.id JOIN name n ON n.id = mc.company_id WHERE mc.company_type_id = '1' AND mc.note LIKE '%(TV)%' AND k.keyword IN ('training', 'mad-scientist', 'war-memorial') AND n.name_pcode_cf IN ('A6136', 'A2353', 'A6515', 'A4564', 'A2352', 'A265') GROUP BY mc.company_type_id;
SELECT ct.kind AS company_kind, AVG(at.production_year) AS average_production_year, COUNT(DISTINCT cn.id) AS number_of_companies, COUNT(DISTINCT ci.movie_id) AS number_of_movies, SUM(CASE WHEN ci.role_id = 1 THEN 1 ELSE 0 END) AS number_of_actors FROM company_type ct JOIN company_name cn ON ct.id = cn.id JOIN aka_title at ON cn.id = at.movie_id JOIN cast_info ci ON at.movie_id = ci.movie_id WHERE ct.kind IN ('production companies', 'distributors') AND ci.nr_order IN (11, 62, 22) AND cn.name_pcode_nf IN ('N6214', 'B4263') AND cn.md5sum IN ('ec9d8d7a9004a112bae37eeaa713f720', 'e3b51733585b9ffda062455d1c1d931a', '889e39831602fcefe7e09958d99eccf4', '38b6724efdb892c18b995c2eacc91c81', '3eb507f50c90ec123e409938f571725d') GROUP BY ct.kind;
SELECT lt.link AS link_type, COUNT(DISTINCT ml.movie_id) AS total_movies, COUNT(DISTINCT ml.linked_movie_id) AS total_linked_movies, AVG(pi.info_type_id) AS average_info_type_id, SUM(CASE WHEN it.info = 'LD quality of source' THEN 1 ELSE 0 END) AS ld_quality_count FROM movie_link AS ml JOIN link_type AS lt ON ml.link_type_id = lt.id LEFT JOIN movie_keyword AS mk ON ml.movie_id = mk.movie_id LEFT JOIN person_info AS pi ON mk.movie_id = pi.person_id LEFT JOIN info_type AS it ON pi.info_type_id = it.id WHERE lt.id IN ('4', '9', '11') AND it.id IN ('29', '89', '46') GROUP BY lt.link ORDER BY total_movies DESC;
SELECT kt.kind AS kind_of_production, COUNT(DISTINCT mk.movie_id) AS number_of_movies, COUNT(DISTINCT mk.keyword_id) AS number_of_unique_keywords, AVG(sub.movie_keyword_count) AS average_keywords_per_movie, COUNT(DISTINCT an.person_id) AS number_of_distinct_persons FROM kind_type kt JOIN movie_keyword mk ON mk.id = ANY(ARRAY[3853, 448, 3514, 4583, 3985]) JOIN (SELECT movie_id, COUNT(keyword_id) AS movie_keyword_count FROM movie_keyword GROUP BY movie_id) AS sub ON sub.movie_id = mk.movie_id LEFT JOIN aka_name an ON an.id = mk.movie_id AND an.name IS NOT NULL WHERE kt.kind IN ('video game', 'tv series', 'tv mini series', 'episode', 'video movie') GROUP BY kt.kind ORDER BY number_of_movies DESC;
SELECT ml.movie_id, COUNT(DISTINCT ml.linked_movie_id) AS number_of_linked_movies, AVG(COUNT(ml.linked_movie_id)) OVER () AS average_links_per_movie, COUNT(DISTINCT mk.keyword_id) AS total_distinct_keywords FROM movie_link AS ml INNER JOIN movie_info AS mi ON ml.movie_id = mi.movie_id INNER JOIN movie_keyword AS mk ON ml.movie_id = mk.movie_id GROUP BY ml.movie_id ORDER BY number_of_linked_movies DESC, total_distinct_keywords DESC;
SELECT AVG(a.production_year) AS average_production_year, COUNT(DISTINCT a.movie_id) AS number_of_movies, SUM(CASE WHEN cct.kind = 'actor' THEN 1 ELSE 0 END) AS total_actors, MAX(mic.info) AS max_movie_info FROM aka_title AS a INNER JOIN complete_cast AS cc ON a.movie_id = cc.movie_id INNER JOIN comp_cast_type AS cct ON cc.subject_id = cct.id INNER JOIN movie_companies AS mc ON a.movie_id = mc.movie_id INNER JOIN movie_info_idx AS mic ON a.movie_id = mic.movie_id WHERE a.production_year > 2000 AND mc.company_id IN (910, 1073) AND mic.info_type_id IN (100, 99) AND (a.season_nr IS NULL OR a.season_nr = 27) AND a.kind_id = 1 GROUP BY a.kind_id HAVING COUNT(DISTINCT a.movie_id) > 10;
SELECT ct.kind AS company_type, COUNT(DISTINCT cn.id) AS number_of_companies, COUNT(DISTINCT mc.movie_id) AS number_of_movies, AVG(mi_idx.avg_movie_score) AS average_movie_score, SUM(CASE WHEN mi.info = '(Original Version)' THEN 1 ELSE 0 END) AS original_version_count, SUM(CASE WHEN mi.info = '(English subtitles)' THEN 1 ELSE 0 END) AS english_subtitles_count FROM movie_companies AS mc JOIN company_name AS cn ON mc.company_id = cn.id JOIN company_type AS ct ON mc.company_type_id = ct.id JOIN (SELECT movie_id, AVG(CAST(info AS DOUBLE PRECISION)) AS avg_movie_score FROM movie_info_idx WHERE info_type_id = 101 GROUP BY movie_id) AS mi_idx ON mc.movie_id = mi_idx.movie_id LEFT JOIN movie_info AS mi ON mc.movie_id = mi.movie_id WHERE ct.kind IN ('special effects companies', 'miscellaneous companies', 'production companies', 'distributors') GROUP BY ct.kind;
SELECT ct.kind AS company_type, AVG(t.production_year) AS average_production_year, COUNT(DISTINCT mc.movie_id) AS total_movies, COUNT(DISTINCT ml.movie_id) AS total_movie_links, SUM(CASE WHEN t.kind_id = 2 THEN 1 ELSE 0 END) AS count_of_series, COUNT(DISTINCT t.id) FILTER (WHERE t.title = 'It Came from the Nightosphere' OR t.title = 'Wes Craven Presents Don''t Look Down') AS specific_titles_count FROM title t JOIN movie_companies mc ON t.id = mc.movie_id JOIN comp_cast_type ct ON mc.company_type_id = ct.id LEFT JOIN movie_link ml ON t.id = ml.movie_id WHERE ct.id IN (2, 3) AND mc.company_type_id = 1 AND (ml.link_type_id IN (12, 1, 13, 15) OR ml.link_type_id IS NULL) GROUP BY ct.kind
SELECT AVG(at.production_year) AS average_production_year, COUNT(DISTINCT n.id) AS number_of_actors, SUM(CASE WHEN pi.info_type_id = 38 THEN 1 ELSE 0 END) AS total_awards_won, COUNT(DISTINCT at.id) AS number_of_alternative_titles FROM name AS n JOIN person_info AS pi ON n.id = pi.person_id LEFT JOIN aka_name AS an ON n.id = an.person_id LEFT JOIN aka_title AS at ON at.movie_id = an.person_id WHERE pi.info_type_id IN (34, 35, 38) AND n.gender = 'M' AND (at.season_nr = 28 OR at.season_nr IS NULL) GROUP BY n.gender;
SELECT kt.kind AS movie_kind, COUNT(DISTINCT ci.person_id) AS total_unique_actors, AVG(CAST(t.production_year AS DECIMAL)) AS average_production_year, AVG(CAST(sub.nr_roles AS DECIMAL)) AS average_roles_per_movie FROM title t INNER JOIN kind_type kt ON t.kind_id = kt.id LEFT JOIN ( SELECT movie_id, COUNT(*) AS nr_roles FROM cast_info GROUP BY movie_id ) sub ON t.id = sub.movie_id LEFT JOIN cast_info ci ON t.id = ci.movie_id WHERE t.production_year IS NOT NULL AND t.id IN ('19580', '17102', '17123', '10072') GROUP BY kt.kind;
SELECT COUNT(DISTINCT mc.movie_id) AS total_movies, AVG(t.production_year) AS average_production_year, COUNT(DISTINCT n.id) AS total_companies_involved, SUM(CASE WHEN t.kind_id = 1 THEN 1 ELSE 0 END) AS feature_films, SUM(CASE WHEN t.kind_id = 2 THEN 1 ELSE 0 END) AS short_films, SUM(CASE WHEN t.kind_id = 3 THEN 1 ELSE 0 END) AS documentaries, MAX(t.production_year) AS most_recent_production_year FROM movie_companies mc JOIN title t ON mc.movie_id = t.id JOIN name n ON mc.company_id = n.id WHERE t.production_year BETWEEN 2000 AND 2020 GROUP BY mc.company_type_id ORDER BY total_movies DESC;
SELECT COUNT(DISTINCT cn.id) AS total_companies, COUNT(DISTINCT k.id) AS total_keywords, COUNT(DISTINCT pi.person_id) AS total_people, COUNT(DISTINCT at.id) AS total_titles, AVG(cc.status_id) AS average_cast_status, SUM(CASE WHEN cn.country_code = 'US' THEN 1 ELSE 0 END) AS total_us_companies, MAX(at.production_year) AS latest_production_year, MIN(at.production_year) AS earliest_production_year FROM company_name AS cn JOIN aka_title AS at ON cn.id = at.kind_id JOIN complete_cast AS cc ON at.movie_id = cc.movie_id JOIN person_info AS pi ON cc.subject_id = pi.person_id JOIN keyword AS k ON at.id = k.id WHERE cn.name IN ('Sunset Productions (II)', 'Coming Soon TV', 'Tucker Film', 'Windfall Films', 'NMK') AND k.keyword IN ('lavatory', 'society') AND at.production_year BETWEEN 2000 AND 2023 GROUP BY cn.country_code ORDER BY total_us_companies DESC, latest_production_year DESC;
SELECT COUNT(DISTINCT t.id) AS total_movies, AVG(t.production_year) AS average_production_year, SUM(CASE WHEN ct.kind = 'production companies' THEN 1 ELSE 0 END) AS total_production_companies, COUNT(DISTINCT ml.movie_id) AS total_movie_links, SUM(CASE WHEN at.note LIKE '%working title%' THEN 1 ELSE 0 END) AS total_working_titles, AVG(mi_idx.info::NUMERIC) AS average_movie_info_numeric FROM title AS t LEFT JOIN movie_info_idx AS mi_idx ON t.id = mi_idx.movie_id AND mi_idx.info ~ '^\d+(\.\d+)?$' LEFT JOIN movie_link AS ml ON t.id = ml.movie_id LEFT JOIN aka_title AS at ON t.id = at.movie_id LEFT JOIN movie_companies AS mc ON t.id = mc.movie_id LEFT JOIN company_type AS ct ON mc.company_type_id = ct.id WHERE t.production_year BETWEEN 1990 AND 2020 AND (ml.linked_movie_id IN (10537, 19940, 11149) OR ml.movie_id IN (10537, 19940, 11149)) AND mi_idx.movie_id IN (9646, 11233, 12272, 6743) AND at.movie_id IN (1373539, 255849, 1707841, 1665513) GROUP BY ct.kind;
SELECT AVG(mi_idx.info::numeric) AS average_rating, COUNT(DISTINCT k.id) AS total_unique_keywords, COUNT(DISTINCT n.id) AS total_unique_writers, SUM(CASE WHEN cn.surname_pcode = 'M1236' THEN 1 ELSE 0 END) AS count_of_m1236_surname_writers FROM keyword AS k LEFT JOIN movie_keyword AS mk ON k.id = mk.keyword_id LEFT JOIN movie_info_idx AS mi_idx ON mk.movie_id = mi_idx.movie_id AND mi_idx.info_type_id = 101 LEFT JOIN cast_info AS ci ON mk.movie_id = ci.movie_id LEFT JOIN char_name AS cn ON ci.person_id = cn.id AND ci.role_id = 2 LEFT JOIN name AS n ON ci.person_id = n.id AND n.gender = 'm' WHERE k.keyword IN ('airforce-one', 'mexican-revolutionary', 'full-house', 'gay-hollywood', 'overactive-imagination') AND cn.surname_pcode IN ('M1236', 'H3245', 'Z12', 'F236') AND ci.role_id IN (SELECT id FROM comp_cast_type WHERE kind = 'writer') GROUP BY ci.movie_id;
SELECT kt.kind AS movie_kind, COUNT(DISTINCT ci.movie_id) AS number_of_movies, AVG(ci.nr_order) AS average_cast_order, SUM(CASE WHEN ci.person_role_id IS NOT NULL THEN 1 ELSE 0 END) AS number_of_characters, COUNT(DISTINCT mk.keyword_id) AS number_of_unique_keywords, COUNT(DISTINCT cn.id) AS number_of_companies_involved, STRING_AGG(DISTINCT cn.country_code, ', ') AS countries_involved FROM cast_info ci JOIN movie_keyword mk ON ci.movie_id = mk.movie_id JOIN movie_companies mc ON ci.movie_id = mc.movie_id JOIN company_name cn ON mc.company_id = cn.id JOIN kind_type kt ON kt.id IN (6, 4) WHERE ci.nr_order = 39 AND mk.id IN (337, 1460, 1468, 4397, 4374, 1643) AND mk.keyword_id = 3554 AND kt.kind IN ('tv movie', 'tv mini series', 'video game', 'episode') GROUP BY kt.kind;
SELECT kt.kind AS movie_kind, COUNT(DISTINCT at.id) AS total_titles, COUNT(DISTINCT at.movie_id) AS unique_movies, AVG(at.production_year) AS avg_production_year, SUM(CASE WHEN lt.link = 'alternate language version of' THEN 1 ELSE 0 END) AS alt_lang_versions, SUM(CASE WHEN lt.link = 'version of' THEN 1 ELSE 0 END) AS versions, SUM(CASE WHEN lt.link = 'features' THEN 1 ELSE 0 END) AS features_count FROM aka_title at JOIN kind_type kt ON at.kind_id = kt.id JOIN movie_info_idx mii ON at.movie_id = mii.movie_id JOIN link_type lt ON mii.id = lt.id WHERE at.imdb_index = 'IV' AND at.episode_of_id IN ('11942', '6153', '1980', '7480', '8274') AND kt.kind IN ('tv series', 'video movie', 'video game', 'tv mini series') AND mii.info_type_id IN (SELECT id FROM info_type WHERE info LIKE '%0..11202%' OR info LIKE '.0..002212') GROUP BY kt.kind;
SELECT COUNT(DISTINCT ml.movie_id) AS num_movies, COUNT(DISTINCT ml.linked_movie_id) AS num_linked_movies, AVG(sub.num_keywords) AS avg_keywords_per_movie, SUM(CASE WHEN pi.info_type_id = '34' THEN 1 ELSE 0 END) AS count_info_type_34, SUM(CASE WHEN pi.info_type_id = '25' THEN 1 ELSE 0 END) AS count_info_type_25 FROM movie_link AS ml JOIN (SELECT mk.movie_id, COUNT(mk.keyword_id) AS num_keywords FROM movie_keyword AS mk GROUP BY mk.movie_id) AS sub ON ml.movie_id = sub.movie_id LEFT JOIN person_info AS pi ON ml.movie_id = pi.person_id GROUP BY ml.link_type_id;
SELECT cn.name AS company_name, ct.kind AS cast_type, COUNT(ml.id) AS total_movie_links, AVG(ml.linked_movie_id) AS average_linked_movie_imdb_id, COUNT(DISTINCT chn.id) AS total_characters FROM company_name cn JOIN movie_link ml ON cn.id = ml.movie_id JOIN comp_cast_type ct ON ml.link_type_id = ct.id LEFT JOIN char_name chn ON ml.movie_id = chn.id WHERE cn.country_code = 'US' AND cn.name_pcode_sf BETWEEN 'A0000' AND 'Z9999' GROUP BY cn.name, ct.kind ORDER BY total_movie_links DESC, average_linked_movie_imdb_id;
SELECT COUNT(DISTINCT ci.movie_id) AS number_of_movies, AVG(ci.nr_order) AS average_cast_order, SUM(CASE WHEN cc.status_id = 4 THEN 1 ELSE 0 END) AS count_completed_status_4, SUM(CASE WHEN cc.status_id = 3 THEN 1 ELSE 0 END) AS count_completed_status_3, pi.info_type_id, it.info AS info_type_description, COUNT(DISTINCT pi.person_id) AS number_of_people_with_info, AVG(t.production_year) AS average_movie_production_year, COUNT(DISTINCT n.id) AS number_of_actors, MAX(t.production_year) AS latest_movie_production_year, MIN(t.production_year) AS oldest_movie_production_year FROM cast_info ci JOIN title t ON ci.movie_id = t.id JOIN name n ON ci.person_id = n.id LEFT JOIN complete_cast cc ON t.id = cc.movie_id JOIN person_info pi ON n.id = pi.person_id JOIN info_type it ON pi.info_type_id = it.id WHERE it.id = '46' AND pi.note ILIKE '%yasmine%' AND (ci.note ILIKE '%(segment "Requiem")%' OR ci.note ILIKE '%(2010)%' OR ci.note ILIKE '%(as Alima Abubarka)%' OR ci.note ILIKE '%(segment "Soulmates")%' OR ci.note ILIKE '%(as Dr Anthony Absalom)%' OR ci.note ILIKE '%(as Mitch Abshire)%') GROUP BY pi.info_type_id, it.info;
