SELECT kt.kind AS movie_kind, AVG(title.production_year) AS average_production_year, COUNT(DISTINCT cast_info.person_id) AS number_of_actors, COUNT(DISTINCT company_name.id) AS number_of_companies, SUM(case when cast_info.role_id = 1 then 1 else 0 end) AS number_of_lead_roles, MAX(movie_info.info) AS longest_movie_info FROM title JOIN kind_type AS kt ON title.kind_id = kt.id JOIN cast_info ON title.id = cast_info.movie_id JOIN movie_companies ON title.id = movie_companies.movie_id JOIN company_name ON movie_companies.company_id = company_name.id JOIN movie_info ON title.id = movie_info.movie_id WHERE title.production_year >= 2000 AND cast_info.role_id = 1 AND movie_companies.company_type_id IN (SELECT id FROM company_name WHERE country_code = 'US') GROUP BY kt.kind ORDER BY average_production_year DESC, number_of_actors DESC;
SELECT ct.kind AS company_type, AVG(t.production_year) AS average_production_year, COUNT(DISTINCT mk.keyword_id) AS unique_keyword_count, SUM(CASE WHEN an.name_pcode_cf LIKE 'A%' THEN 1 ELSE 0 END) AS names_starting_with_a, COUNT(DISTINCT an.person_id) AS total_actors_with_alternate_names FROM title AS t JOIN movie_keyword AS mk ON t.id = mk.movie_id JOIN aka_name AS an ON an.person_id = t.id JOIN company_type AS ct ON ct.id = t.kind_id WHERE t.production_year > 2000 AND mk.keyword_id IN (4192, 3543, 917, 3554) AND an.name_pcode_cf IN ('K365', 'J262', 'C4625', 'A1526') GROUP BY ct.kind ORDER BY average_production_year DESC;
SELECT AVG(ak.production_year) AS average_production_year, COUNT(DISTINCT an.person_id) AS number_of_unique_persons, COUNT(DISTINCT mk.movie_id) AS number_of_movies_with_keywords, SUM(CASE WHEN ml.link_type_id = 12 THEN 1 ELSE 0 END) AS count_of_link_type_12 FROM aka_title AS ak JOIN aka_name AS an ON ak.id = an.person_id JOIN movie_keyword AS mk ON ak.movie_id = mk.movie_id JOIN movie_link AS ml ON ak.movie_id = ml.movie_id WHERE an.name_pcode_cf IN ('P54', 'A5321', 'D232', 'A1463', 'V4214', 'A235') AND ak.kind_id = (SELECT id FROM info_type WHERE info = 'movie') AND ak.production_year BETWEEN 2000 AND 2020 GROUP BY ak.kind_id;
SELECT n.name AS actor_name, COUNT(DISTINCT ci.movie_id) AS movies_participated, AVG(mi_idx.info::numeric) AS average_movie_rating, COUNT(DISTINCT cc.subject_id) AS distinct_subjects_involved, SUM(CASE WHEN it.info = 'LD video quality' THEN 1 ELSE 0 END) AS count_LD_video_quality_movies, SUM(CASE WHEN it.info = 'crazy credits' THEN 1 ELSE 0 END) AS count_crazy_credits_movies FROM name AS n JOIN cast_info AS ci ON n.id = ci.person_id LEFT JOIN movie_info_idx AS mi_idx ON ci.movie_id = mi_idx.movie_id AND mi_idx.info_type_id IN (SELECT id FROM info_type WHERE info = 'rating') LEFT JOIN complete_cast AS cc ON ci.movie_id = cc.movie_id LEFT JOIN info_type AS it ON mi_idx.info_type_id = it.id WHERE ci.person_id IN (1837, 1344) AND (mi_idx.movie_id IN (8431, 19632, 8488) OR mi_idx.movie_id IS NULL) GROUP BY n.name ORDER BY movies_participated DESC, average_movie_rating DESC;
SELECT COUNT(DISTINCT mi_idx.movie_id) AS total_movies, AVG(mk_cnt.keyword_count) AS avg_keywords_per_movie, COUNT(DISTINCT ml.movie_id) AS total_linked_movies, SUM(CASE WHEN lt.link = 'similar to' THEN 1 ELSE 0 END) AS count_similar_to_links, COUNT(DISTINCT mc.company_id) AS total_companies, AVG(NULLIF(regexp_replace(mi_idx.info, '\D', '', 'g'), '')::NUMERIC) AS average_info_numeric, SUM(CASE WHEN k.phonetic_code IN ('M342', 'N2165') THEN 1 ELSE 0 END) AS count_specific_phonetic_codes FROM movie_info_idx AS mi_idx JOIN movie_keyword AS mk ON mi_idx.movie_id = mk.movie_id JOIN movie_link AS ml ON mk.movie_id = ml.movie_id JOIN movie_companies AS mc ON ml.movie_id = mc.movie_id JOIN link_type AS lt ON ml.link_type_id = lt.id JOIN keyword AS k ON mk.keyword_id = k.id JOIN (SELECT movie_id, COUNT(keyword_id) AS keyword_count FROM movie_keyword GROUP BY movie_id) AS mk_cnt ON mk.movie_id = mk_cnt.movie_id WHERE mi_idx.info_type_id = '100' AND mi_idx.info SIMILAR TO '%[0-9]{6,}%' AND (ml.movie_id IN ('11122', '14650', '11447', '7786', '14516') OR ml.id IN ('3768', '4002', '4548', '963', '430', '4309')) GROUP BY lt.link;
SELECT ct.kind AS company_kind, COUNT(DISTINCT mi.movie_id) AS number_of_movies, AVG(mi.id) AS average_movie_info_id, SUM(CASE WHEN mi.info_type_id = 1 THEN 1 ELSE 0 END) AS count_of_info_type_1, SUM(CASE WHEN mi.note IS NOT NULL THEN 1 ELSE 0 END) AS count_of_non_null_notes FROM movie_info mi JOIN movie_info_idx mii ON mi.movie_id = mii.movie_id JOIN company_type ct ON mii.info_type_id = ct.id WHERE mi.movie_id IN (939658, 924408, 929751) AND mi.id IN (7267027, 7270561, 7268356, 7270113) AND mii.id = 949 GROUP BY ct.kind;
SELECT kt.kind AS movie_kind, COUNT(DISTINCT ci.movie_id) AS number_of_movies, COUNT(DISTINCT ci.person_id) AS number_of_actors, AVG(ci.nr_order) AS average_cast_order, SUM(CASE WHEN cct.kind = 'actor' THEN 1 ELSE 0 END) AS total_actor_roles, SUM(CASE WHEN cct.kind = 'actress' THEN 1 ELSE 0 END) AS total_actress_roles, COUNT(DISTINCT mk.keyword_id) AS number_of_unique_keywords FROM cast_info ci JOIN kind_type kt ON ci.role_id = kt.id JOIN comp_cast_type cct ON ci.person_role_id = cct.id JOIN movie_keyword mk ON ci.movie_id = mk.movie_id GROUP BY kt.kind ORDER BY number_of_movies DESC;
SELECT kt.kind AS movie_kind, COUNT(DISTINCT mc.movie_id) AS number_of_movies, AVG(mi_numeric.info::NUMERIC) AS average_budget, SUM(CASE WHEN mc.company_id = '1187' THEN 1 ELSE 0 END) AS movies_with_company_1187, SUM(CASE WHEN mc.company_id = '1024' THEN 1 ELSE 0 END) AS movies_with_company_1024, COUNT(DISTINCT ml.link_type_id) AS distinct_link_types FROM movie_companies AS mc JOIN movie_info AS mi ON mc.movie_id = mi.movie_id JOIN kind_type AS kt ON mi.info_type_id = kt.id LEFT JOIN movie_link AS ml ON mc.movie_id = ml.movie_id LEFT JOIN movie_info AS mi_numeric ON mc.movie_id = mi_numeric.movie_id AND mi_numeric.info_type_id = ( SELECT id FROM info_type WHERE info = 'budget' ) WHERE mc.company_id IN ('1187', '1024', '1009', '1239', '1034') AND mi.info_type_id IN ( SELECT id FROM info_type WHERE info = 'budget' ) AND mc.movie_id IN ('18864', '18945') GROUP BY kt.kind;
SELECT ct.kind AS company_type, AVG(t.production_year) AS average_production_year, COUNT(DISTINCT t.id) AS total_movies, COUNT(DISTINCT an.id) AS total_aka_names, COUNT(DISTINCT mi.id) AS total_movie_info, SUM(CASE WHEN lt.LINK = 'remade as' THEN 1 ELSE 0 END) AS total_remake_links FROM title t LEFT JOIN aka_name an ON t.id = an.person_id LEFT JOIN movie_info_idx mi ON t.id = mi.movie_id LEFT JOIN link_type lt ON mi.info_type_id = lt.id LEFT JOIN company_type ct ON t.kind_id = ct.id GROUP BY ct.kind ORDER BY total_movies DESC;
