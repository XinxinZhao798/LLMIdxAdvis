SELECT COUNT(DISTINCT cn.id) AS num_companies, COUNT(DISTINCT chn.id) AS num_characters, AVG(CAST(mi_idx.info AS DECIMAL)) AS average_movie_rating, SUM(CASE WHEN kt.id = '4' THEN 1 ELSE 0 END) AS num_tv_series, COUNT(DISTINCT cc.movie_id) AS num_movies_with_complete_cast FROM company_name cn LEFT JOIN movie_companies mc ON cn.id = mc.company_id LEFT JOIN char_name chn ON chn.surname_pcode IN ('O416', 'M65', 'L5163') LEFT JOIN complete_cast cc ON mc.movie_id = cc.movie_id LEFT JOIN movie_info_idx mi_idx ON mc.movie_id = mi_idx.movie_id LEFT JOIN kind_type kt ON cc.subject_id = kt.id LEFT JOIN info_type it ON mi_idx.info_type_id = it.id AND it.info = 'rating' WHERE cn.name_pcode_nf IN ('L2416', 'A2321') AND ( cn.id = '152' OR kt.id = '4' OR it.id IN ('29', '49', '97', '78') ) GROUP BY cn.country_code;
SELECT it.info AS information_type, COUNT(DISTINCT mk.movie_id) AS number_of_movies, AVG(mc.company_id) AS average_company_id, SUM(CASE WHEN mc.company_id = 763 THEN 1 ELSE 0 END) AS count_specific_company, COUNT(DISTINCT mc.company_id) AS count_distinct_companies FROM movie_keyword AS mk INNER JOIN movie_companies AS mc ON mk.movie_id = mc.movie_id INNER JOIN complete_cast AS cc ON mc.movie_id = cc.movie_id INNER JOIN info_type AS it ON it.id = mc.company_type_id WHERE cc.status_id BETWEEN 1 AND 5 AND mc.company_id IN (763, 1012, 1500) AND mk.keyword_id BETWEEN 100 AND 200 GROUP BY it.info ORDER BY number_of_movies DESC, average_company_id;
SELECT kt.kind, COUNT(DISTINCT mc.movie_id) AS total_movies, AVG(cast_info.nr_order) AS average_cast_order, SUM(case when cn.country_code = 'US' THEN 1 ELSE 0 END) AS total_us_companies, COUNT(DISTINCT mk.keyword_id) AS unique_keywords FROM movie_companies mc JOIN company_name cn ON mc.company_id = cn.id JOIN kind_type kt ON kt.kind IN ('episode', 'video game', 'video movie', 'tv movie', 'tv mini series', 'tv series') JOIN movie_keyword mk ON mk.movie_id = mc.movie_id JOIN cast_info ON cast_info.movie_id = mc.movie_id WHERE mk.movie_id IN ('12147', '11128', '12146') GROUP BY kt.kind ORDER BY total_movies DESC;
SELECT n.name AS actor_name, COUNT(DISTINCT ci.movie_id) AS number_of_movies, AVG(mi_idx.info::numeric) AS average_movie_rating, SUM(CASE WHEN ci.role_id = 1 THEN 1 ELSE 0 END) AS number_of_lead_roles, COUNT(DISTINCT mc.company_id) AS number_of_companies_worked_with FROM cast_info ci JOIN name n ON ci.person_id = n.id JOIN movie_info_idx mi_idx ON ci.movie_id = mi_idx.movie_id AND mi_idx.info_type_id = 101 JOIN movie_companies mc ON ci.movie_id = mc.movie_id WHERE ci.nr_order <= 51 AND mi_idx.info::numeric >= 5.0 GROUP BY n.name HAVING COUNT(DISTINCT ci.movie_id) > 5 ORDER BY average_movie_rating DESC, number_of_movies DESC LIMIT 10;
SELECT AVG(mi_idx.info::numeric) AS average_rating, COUNT(DISTINCT k.id) AS total_unique_keywords, COUNT(DISTINCT n.id) AS total_unique_writers, SUM(CASE WHEN cn.surname_pcode = 'M1236' THEN 1 ELSE 0 END) AS count_of_m1236_surname_writers FROM keyword AS k LEFT JOIN movie_keyword AS mk ON k.id = mk.keyword_id LEFT JOIN movie_info_idx AS mi_idx ON mk.movie_id = mi_idx.movie_id AND mi_idx.info_type_id = 101 LEFT JOIN cast_info AS ci ON mk.movie_id = ci.movie_id LEFT JOIN char_name AS cn ON ci.person_id = cn.id AND ci.role_id = 2 LEFT JOIN name AS n ON ci.person_id = n.id AND n.gender = 'm' WHERE k.keyword IN ('airforce-one', 'mexican-revolutionary', 'full-house', 'gay-hollywood', 'overactive-imagination') AND cn.surname_pcode IN ('M1236', 'H3245', 'Z12', 'F236') AND ci.role_id IN (SELECT id FROM comp_cast_type WHERE kind = 'writer') GROUP BY ci.movie_id;
SELECT COUNT(DISTINCT t.id) AS number_of_movies, AVG(t.production_year) AS average_production_year, SUM(CASE WHEN t.kind_id = 1 THEN 1 ELSE 0 END) AS number_of_feature_films, SUM(CASE WHEN t.kind_id = 2 THEN 1 ELSE 0 END) AS number_of_tv_shows, COUNT(DISTINCT n.id) AS number_of_cast_members, COUNT(DISTINCT cc.subject_id) AS number_of_cast_types, AVG(cc.status_id) AS average_status_id FROM title AS t JOIN complete_cast AS cc ON t.id = cc.movie_id JOIN name AS n ON cc.subject_id = n.id WHERE cc.status_id = 4 AND t.production_year > 1990 GROUP BY t.kind_id ORDER BY number_of_movies DESC, average_production_year DESC;
SELECT COUNT(DISTINCT mk.movie_id) AS total_movies_with_keywords, AVG(t.production_year) AS average_production_year, SUM(CASE WHEN n.gender = 'M' THEN 1 ELSE 0 END) AS total_male_actors, SUM(CASE WHEN n.gender = 'F' THEN 1 ELSE 0 END) AS total_female_actors, MAX(t.production_year) AS latest_production_year, MIN(t.production_year) AS earliest_production_year FROM movie_keyword AS mk JOIN title AS t ON mk.movie_id = t.id JOIN name AS n ON t.id = n.id GROUP BY n.gender ORDER BY total_movies_with_keywords DESC, average_production_year;
SELECT kt.kind, COUNT(DISTINCT ml.movie_id) AS total_movies, COUNT(DISTINCT cn.id) AS distinct_companies, cn.country_code, AVG(cn.imdb_id) AS avg_imdb_id_of_companies FROM movie_link AS ml INNER JOIN kind_type AS kt ON ml.link_type_id = kt.id INNER JOIN movie_link AS ml2 ON ml.movie_id = ml2.movie_id INNER JOIN company_name AS cn ON ml2.movie_id = cn.id GROUP BY kt.kind, cn.country_code ORDER BY total_movies DESC;
SELECT kt.kind AS movie_kind, COUNT(DISTINCT t.id) AS total_movies, AVG(t.production_year) AS average_production_year, SUM(CASE WHEN mc.note LIKE '%(TV)%' THEN 1 ELSE 0 END) AS total_tv_movies, COUNT(DISTINCT cn.id) AS total_characters, COUNT(DISTINCT an.person_id) AS total_actors_with_aliases FROM title t JOIN kind_type kt ON t.kind_id = kt.id LEFT JOIN movie_companies mc ON t.id = mc.movie_id LEFT JOIN char_name cn ON cn.imdb_id = t.imdb_id LEFT JOIN aka_name an ON an.person_id = t.id WHERE t.production_year > 2000 AND t.kind_id IN (2, 3, 6, 7) AND (mc.note LIKE '%(TV)%' OR mc.note IS NULL) AND (cn.surname_pcode = 'B654' OR cn.surname_pcode IS NULL) AND (mc.company_type_id = kt.id OR mc.company_type_id IS NULL) GROUP BY kt.kind ORDER BY total_movies DESC;
SELECT n.name AS actor_name, COUNT(DISTINCT cn.id) AS character_count, AVG(mk.keyword_id) AS average_keyword_id, SUM(CASE WHEN ml.link_type_id = 1 THEN 1 ELSE 0 END) AS direct_movie_links, COUNT(DISTINCT ml.movie_id) AS linked_movies_count FROM name n JOIN aka_name an ON n.id = an.person_id JOIN char_name cn ON an.id = cn.imdb_id JOIN movie_keyword mk ON cn.id = mk.movie_id JOIN movie_link ml ON mk.movie_id = ml.movie_id WHERE n.gender = 'm' GROUP BY n.name;
SELECT rt.ROLE, COUNT(DISTINCT cn.id) AS num_companies, COUNT(DISTINCT ch.id) AS num_characters, AVG(pi.person_id) AS avg_person_id, SUM(pi.id) AS total_person_info_ids FROM role_type rt JOIN person_info pi ON rt.id = pi.info_type_id JOIN char_name ch ON pi.person_id = ch.id JOIN company_name cn ON ch.surname_pcode = cn.name_pcode_sf WHERE rt.ROLE = 'director' AND ch.name_pcode_nf = 'P3636' AND cn.name_pcode_sf = 'I1341' AND rt.id IN ('7', '5', '3', '1', '9') GROUP BY rt.ROLE ORDER BY num_companies DESC;
SELECT kt.kind AS movie_genre, COUNT(DISTINCT mi_idx.movie_id) AS total_movies, AVG(CASE WHEN mi_idx.note SIMILAR TO '[0-9]+(\\.[0-9]+)?' THEN CAST(mi_idx.note AS FLOAT) ELSE NULL END) AS average_rating, MAX(CASE WHEN mi_idx.note SIMILAR TO '[0-9]+(\\.[0-9]+)?' THEN CAST(mi_idx.note AS FLOAT) ELSE NULL END) AS highest_rating FROM kind_type AS kt JOIN movie_info_idx AS mi_idx ON kt.id = mi_idx.info_type_id WHERE mi_idx.info LIKE '%Genre%' GROUP BY kt.kind;
SELECT AVG(CAST(mi.info AS DOUBLE PRECISION)) AS average_budget, COUNT(DISTINCT ml.movie_id) AS total_linked_movies, COUNT(DISTINCT n.id) AS total_people_with_surname_code, SUM(CASE WHEN mi_idx.info LIKE '0.0%' THEN 1 ELSE 0 END) AS count_prefix_info FROM movie_info mi JOIN movie_info_idx mi_idx ON mi.movie_id = mi_idx.movie_id JOIN movie_link ml ON ml.movie_id = mi.movie_id JOIN name n ON n.surname_pcode = 'A465' WHERE mi.info_type_id = 3 AND mi_idx.info_type_id = 2 AND ml.link_type_id = 1 AND mi.note IS NOT NULL GROUP BY n.surname_pcode;
SELECT mc.company_id, COUNT(DISTINCT mc.movie_id) AS number_of_movies, cs.status_id, AVG(CAST(pi.info AS FLOAT)) FILTER (WHERE pi.info_type_id = 10) AS average_rating FROM movie_companies AS mc JOIN complete_cast AS cs ON mc.movie_id = cs.movie_id JOIN person_info AS pi ON cs.subject_id = pi.person_id GROUP BY mc.company_id, cs.status_id ORDER BY number_of_movies DESC, average_rating DESC;
SELECT t.production_year, COUNT(DISTINCT t.id) AS total_movies, COUNT(DISTINCT c.id) AS total_casts, AVG(mi.info::INTEGER) AS average_movie_length, SUM(CASE WHEN ml.link_type_id = 1 THEN 1 ELSE 0 END) AS total_sequels FROM title t LEFT JOIN complete_cast c ON t.id = c.movie_id AND c.subject_id = 1 LEFT JOIN movie_info_idx mi ON t.id = mi.movie_id AND mi.info_type_id = 3 LEFT JOIN movie_link ml ON t.id = ml.movie_id AND ml.link_type_id = 1 WHERE t.production_year IN (1997, 1974, 1967, 1969) GROUP BY t.production_year ORDER BY t.production_year;
SELECT AVG(at.production_year) AS average_production_year, COUNT(DISTINCT at.movie_id) AS number_of_movies, COUNT(DISTINCT ml.linked_movie_id) AS number_of_linked_movies, SUM(CASE WHEN lt.link = 'similar to' THEN 1 ELSE 0 END) AS count_similar_movies, rt.role AS role_type, COUNT(DISTINCT cct.id) AS count_of_cast_types FROM aka_title at JOIN movie_link ml ON at.movie_id = ml.movie_id JOIN link_type lt ON ml.link_type_id = lt.id JOIN role_type rt ON rt.id = 4 JOIN comp_cast_type cct ON cct.kind IN ('complete+verified', 'cast', 'crew', 'complete') WHERE at.md5sum IN ('efba398a3a676bcdd49811cf868754d9', '532902abff1e92fb97a2eef43fb530a6', '803eb3353f2aeb81555223391ef4de88', 'eaf5b1adddabc3742e27581d5b19c2ac') GROUP BY rt.role;
SELECT t.title AS Movie_Title, COUNT(DISTINCT akn.id) AS Number_of_Aliases, COUNT(DISTINCT cn.id) AS Number_of_Characters, COUNT(DISTINCT mk.id) AS Number_of_Keywords, AVG(t.production_year) AS Average_Production_Year, SUM(CASE WHEN akn.name_pcode_cf IN ('A2312', 'A4565', 'A2651', 'T4236', 'K526', 'A1216') THEN 1 ELSE 0 END) AS Sum_Aliases_With_Specific_Pcodes, SUM(CASE WHEN akn.surname_pcode IN ('M53', 'Q53', 'L23') THEN 1 ELSE 0 END) AS Sum_Aliases_With_Specific_Surnames FROM title t LEFT JOIN aka_name akn ON t.id = akn.person_id LEFT JOIN char_name cn ON t.id = cn.imdb_id LEFT JOIN movie_keyword mk ON t.id = mk.movie_id WHERE mk.keyword_id IN ('2968', '2869', '3716', '2906') AND t.id IN ('199103', '150273', '87557') GROUP BY t.title ORDER BY Number_of_Aliases DESC, Number_of_Characters DESC;
SELECT ct.kind AS company_kind, COUNT(mc.id) AS total_movies, AVG(t.production_year) AS average_production_year, SUM(CASE WHEN ti.series_years IS NOT NULL THEN 1 ELSE 0 END) AS total_series, COUNT(DISTINCT t.id) AS unique_titles, MAX(t.production_year) AS latest_production_year, MIN(t.production_year) AS oldest_production_year FROM movie_companies AS mc JOIN company_type AS ct ON mc.company_type_id = ct.id JOIN title AS t ON mc.movie_id = t.id LEFT JOIN title AS ti ON t.episode_of_id = ti.id WHERE ct.kind IN ('production companies', 'special effects companies') AND t.production_year BETWEEN 1980 AND 2005 AND (t.series_years = '1985-1987' OR t.series_years = '1987-????' OR t.series_years LIKE '1968-%' OR t.series_years LIKE '1978-1979') AND mc.company_id = 909 GROUP BY ct.kind ORDER BY total_movies DESC;
SELECT COUNT(DISTINCT t.id) AS total_movies, AVG(t.production_year) AS average_production_year, SUM(CASE WHEN mk.movie_id IN ('18308', '18764', '15408', '17206', '12185') THEN 1 ELSE 0 END) AS count_specific_movies, COUNT(DISTINCT cn.surname_pcode) AS unique_character_surnames, MIN(t.title) AS earliest_alphabetical_movie_title FROM title AS t JOIN movie_keyword AS mk ON mk.movie_id = t.id JOIN char_name AS cn ON cn.id = mk.movie_id JOIN name AS n ON n.surname_pcode = cn.surname_pcode WHERE t.series_years = '1990-1991' OR t.phonetic_code IN ('P6523', 'D162', 'R5265', 'D2453', 'F6145') AND cn.surname_pcode IN ('L3414', 'O4353', 'W16', 'I5236') GROUP BY t.kind_id HAVING COUNT(DISTINCT t.id) > 10 ORDER BY total_movies DESC, average_production_year ASC;
