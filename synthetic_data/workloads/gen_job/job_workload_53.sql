SELECT COUNT(DISTINCT n.id) AS total_names, AVG(n.imdb_id) AS average_imdb_id, SUM(CASE WHEN n.gender = 'F' THEN 1 ELSE 0 END) AS female_count, SUM(CASE WHEN n.gender = 'M' THEN 1 ELSE 0 END) AS male_count, mi.info_type_id, k.keyword, AVG(CAST(mi.info AS DOUBLE PRECISION)) FILTER (WHERE mi.info ~ '^\d+(\.\d+)?$') AS average_numeric_info FROM name n JOIN movie_info mi ON n.id = mi.movie_id JOIN keyword k ON k.id = mi.info_type_id WHERE n.name_pcode_nf IN ('H6142', 'K434', 'L4', 'B2415') GROUP BY mi.info_type_id, k.keyword ORDER BY total_names DESC, average_numeric_info DESC;
SELECT CN.name AS character_name, AVG(CI.nr_order) AS average_order_appearance, COUNT(DISTINCT CI.movie_id) AS number_of_movies, COUNT(DISTINCT CI.person_id) AS number_of_actors, CN.surname_pcode AS character_surname_code, STRING_AGG(DISTINCT CO.name, ', ') AS associated_companies, SUM(CASE WHEN CO.country_code = 'US' THEN 1 ELSE 0 END) AS number_of_US_companies FROM cast_info CI JOIN char_name CN ON CI.person_role_id = CN.id JOIN company_name CO ON CI.movie_id = CO.imdb_id WHERE CO.name_pcode_nf = 'T1452' GROUP BY CN.name, CN.surname_pcode ORDER BY number_of_movies DESC, average_order_appearance;
SELECT ct.kind AS company_kind, COUNT(DISTINCT ci.movie_id) AS total_movies, AVG(ci.nr_order) AS average_cast_order, SUM(CASE WHEN ci.note LIKE '%(as %' THEN 1 ELSE 0 END) AS total_alias_credits, COUNT(DISTINCT mc.company_id) AS total_companies_involved, COUNT(DISTINCT ci.person_id) AS unique_cast_members FROM cast_info ci JOIN movie_companies mc ON ci.movie_id = mc.movie_id JOIN company_type ct ON mc.company_type_id = ct.id WHERE ct.kind IN ('distributors', 'miscellaneous companies', 'special effects companies') AND ci.note IS NOT NULL GROUP BY ct.kind ORDER BY total_movies DESC;
SELECT COUNT(DISTINCT n.id) AS number_of_actors, AVG(n.imdb_id) AS average_imdb_id, SUM(CASE WHEN n.gender = 'F' THEN 1 ELSE 0 END) AS female_actors_count, SUM(CASE WHEN n.gender = 'M' THEN 1 ELSE 0 END) AS male_actors_count, COUNT(DISTINCT an.id) AS number_of_alternative_names, COUNT(DISTINCT cct.id) AS number_of_cast_types, AVG(LENGTH(n.name)) AS average_actor_name_length FROM name n LEFT JOIN aka_name an ON n.id = an.person_id LEFT JOIN comp_cast_type cct ON an.id = cct.id WHERE n.name LIKE '%Amplify%' OR an.name IN ('Allen, ''Barefoot'' Chris', 'Alsamia, Etienne', 'Altamirano, Lisa Mariea', 'Aller, Gina', 'Smith, Mary Alice') GROUP BY n.gender;
SELECT rt.role AS role_type, COUNT(*) AS total_roles, COUNT(DISTINCT cn.id) AS unique_characters, AVG(cn.imdb_id) AS average_imdb_id, SUM(cn.imdb_id) AS total_imdb_id, MAX(k.keyword) AS max_keyword, MIN(k.keyword) AS min_keyword, COUNT(DISTINCT k.id) AS total_unique_keywords FROM role_type rt JOIN char_name cn ON rt.id = cn.id JOIN keyword k ON cn.id = k.id GROUP BY rt.role ORDER BY total_roles DESC;
SELECT n.gender, COUNT(DISTINCT n.id) AS total_people, AVG(ci.nr_order) AS average_credit_order FROM name AS n JOIN cast_info AS ci ON n.id = ci.person_id WHERE n.gender IN ('M', 'F') AND ci.note LIKE '%(2000)%' GROUP BY n.gender;
