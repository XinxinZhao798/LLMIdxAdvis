SELECT rt.ROLE, COUNT(DISTINCT cn.id) AS total_characters, COUNT(DISTINCT pi.person_id) AS total_people, COUNT(DISTINCT cc.movie_id) AS total_movies, AVG(pi.id) AS average_person_info_id, SUM(ct.id) AS sum_company_type_ids FROM role_type rt JOIN char_name cn ON cn.md5sum IN ('87fb1da22896f8674cfb742fe549ec67', 'bf85b5265ca46bac451dcdce6f3625f7', '74802eebae1a12921215b7402178254c') JOIN person_info pi ON pi.person_id = cn.id JOIN complete_cast cc ON cc.subject_id = cn.id JOIN company_type ct ON ct.id = 2 WHERE rt.ROLE IN ('actress', 'miscellaneous crew', 'editor', 'director', 'composer') AND pi.note IN ('frankfob2@yahoo.com', 'Deception Films', 'CelebrityLoop.com', 'Spook Show Entertainment', 'E Adamson') AND pi.person_id IN ('3716', '1740595') GROUP BY rt.ROLE ORDER BY total_movies DESC;
SELECT kt.kind AS movie_kind, COUNT(DISTINCT cc.movie_id) AS total_movies, COUNT(DISTINCT mi.id) AS total_movie_info_entries, AVG(CASE WHEN lt.LINK LIKE '%imdb%' THEN 1 ELSE NULL END) AS avg_imdb_linked, SUM(CASE WHEN mi.info_type_id = 1 THEN 1 ELSE 0 END) AS count_of_info_type_1 FROM complete_cast cc JOIN movie_info mi ON cc.movie_id = mi.movie_id JOIN kind_type kt ON kt.id = cc.subject_id LEFT JOIN link_type lt ON lt.id = mi.info_type_id WHERE kt.id IN (1, 4, 2) AND mi.info LIKE '%budget%' AND cc.status_id BETWEEN 1 AND 5 GROUP BY kt.kind;
SELECT cn.name AS company_name, AVG(at.production_year) AS average_production_year, COUNT(DISTINCT at.movie_id) AS number_of_movies, COUNT(DISTINCT an.person_id) AS unique_actors FROM company_name AS cn JOIN aka_title AS at ON at.title = cn.name LEFT JOIN aka_name AS an ON an.name = at.title GROUP BY cn.name HAVING COUNT(DISTINCT at.movie_id) > 5 ORDER BY number_of_movies DESC, average_production_year DESC;
SELECT ct.kind AS company_type, avg(at.production_year) AS average_production_year, count(DISTINCT at.movie_id) AS total_alternate_titles, sum(CASE WHEN cc.subject_id = 1 THEN 1 ELSE 0 END) AS total_full_cast_movies, count(DISTINCT n.id) AS total_actors, count(DISTINCT mi.movie_id) AS total_movies_with_info FROM aka_title at JOIN movie_info mi ON at.movie_id = mi.movie_id JOIN complete_cast cc ON mi.movie_id = cc.movie_id JOIN company_type ct ON cc.subject_id = ct.id JOIN info_type it ON mi.info_type_id = it.id LEFT JOIN name n ON n.imdb_index = at.imdb_index WHERE mi.info_type_id IN (SELECT id FROM info_type WHERE info IN ('birth date', 'mini biography')) AND mi.note NOT LIKE '%(interviews)%' AND at.kind_id NOT IN (SELECT id FROM info_type WHERE info = 'admissions') AND (at.phonetic_code = 'M5251' OR at.phonetic_code = 'B4536') GROUP BY ct.kind ORDER BY total_alternate_titles DESC;
SELECT it.info AS info_type, AVG(CAST(mi.info AS INTEGER)) AS average_info, COUNT(DISTINCT mk.movie_id) AS count_movies, COUNT(DISTINCT at.id) AS count_alternative_titles, SUM(CASE WHEN at.episode_of_id = 15436 THEN 1 ELSE 0 END) AS count_episodes_of_show_15436 FROM movie_info mi JOIN info_type it ON mi.info_type_id = it.id JOIN movie_keyword mk ON mk.movie_id = mi.movie_id LEFT JOIN aka_title at ON at.movie_id = mi.movie_id WHERE it.id IN (112, 107) AND mi.info ~ '^\d+$' GROUP BY it.info HAVING COUNT(DISTINCT mk.movie_id) > 5;
SELECT cn.country_code, COUNT(DISTINCT cn.id) AS num_companies, AVG(mi_idx.id) AS avg_movie_info_idx_id, SUM(CASE WHEN mi.info_type_id = mi_idx.info_type_id THEN 1 ELSE 0 END) AS sum_matching_info_types, COUNT(DISTINCT pi.person_id) AS num_people FROM company_name AS cn LEFT JOIN movie_info_idx AS mi_idx ON cn.imdb_id = mi_idx.movie_id LEFT JOIN movie_info AS mi ON mi.movie_id = mi_idx.movie_id LEFT JOIN person_info AS pi ON pi.info_type_id = mi.info_type_id WHERE cn.country_code = '[be]' AND mi_idx.movie_id IN ('925666', '929198', '939783', '925877', '930515', '925116') AND cn.md5sum IN ('6490953d16a7d7a36b9daafe4a9e84b6', 'b68f1bd9708e765d511e6e251f56419a', '11b8906a4c994a2996176bba270124ac', '8eb39544eea1fca12f1a46d1747c807c') GROUP BY cn.country_code;
SELECT kt.kind AS movie_type, COUNT(DISTINCT mi.movie_id) AS total_movies, AVG(CASE WHEN k.keyword = 'drama' THEN 1.0 ELSE 0 END) AS avg_drama_keyword, SUM(CASE WHEN k.keyword = 'comedy' THEN 1 ELSE 0 END) AS total_comedy_keyword, COUNT(DISTINCT a.person_id) AS unique_actors FROM movie_info mi JOIN kind_type kt ON mi.movie_id = kt.id LEFT JOIN movie_keyword mk ON mi.movie_id = mk.movie_id LEFT JOIN keyword k ON mk.keyword_id = k.id LEFT JOIN aka_name a ON mi.movie_id = a.person_id WHERE k.id IN ('7626', '7498') AND kt.id IN ('6', '7', '4', '3', '5') AND mi.id IN ('7266975', '7266320', '7271067', '7270758', '7267432') GROUP BY kt.kind;
SELECT kt.kind, COUNT(DISTINCT cc.movie_id) AS total_movies_with_complete_cast, AVG(mc.company_id) AS average_company_id, SUM(ml.linked_movie_id) AS total_linked_movie_ids FROM complete_cast cc JOIN kind_type kt ON cc.subject_id = kt.id JOIN movie_companies mc ON cc.movie_id = mc.movie_id JOIN movie_link ml ON cc.movie_id = ml.movie_id WHERE cc.status_id IN (1, 2) AND kt.id IN (1, 2, 5, 3) AND mc.id IN (2678, 1671, 621, 430) AND ml.movie_id IN (20571, 5979, 11130) GROUP BY kt.kind;
SELECT ct.kind AS company_type, COUNT(DISTINCT cn.id) AS number_of_companies, COUNT(DISTINCT mk.movie_id) AS number_of_movies_with_keywords, AVG(mi_idx.info::numeric) AS average_movie_rating, SUM(CASE WHEN cc.status_id = '4' THEN 1 ELSE 0 END) AS completed_and_verified_casts, COUNT(DISTINCT rt.id) AS number_of_cinematographer_roles, MIN(aka.name) AS example_aka_name FROM company_name AS cn JOIN company_type AS ct ON cn.id = ct.id JOIN movie_keyword AS mk ON cn.id = mk.movie_id JOIN movie_info_idx AS mi_idx ON mk.movie_id = mi_idx.movie_id JOIN complete_cast AS cc ON mk.movie_id = cc.movie_id JOIN role_type AS rt ON rt.role = 'cinematographer' LEFT JOIN aka_name AS aka ON aka.name_pcode_cf = 'D1353' AND aka.md5sum IN ('e6b1b0cc9037b00160a143b03dc5524d', '1d440711fb046c932badfdc8121ce380', '88bcce46f057ed51b9026d05fbdb1ac0') WHERE cc.status_id IN ('3', '4') GROUP BY ct.kind
SELECT COUNT(DISTINCT an.person_id) AS number_of_persons, COUNT(k.id) AS total_keyword_mentions FROM keyword AS k JOIN movie_keyword AS mk ON k.id = mk.keyword_id JOIN aka_name AS an ON mk.movie_id = an.person_id WHERE k.keyword IN ('money-tree', 'reference-to-moby-dick', 'camp', 'summons') GROUP BY an.person_id;
SELECT n.name AS actor_name, COUNT(DISTINCT ci.movie_id) AS movie_count, AVG(mi_idx.info::NUMERIC) AS average_movie_rating, SUM(CASE WHEN m_info.info = 'Tagalog' THEN 1 ELSE 0 END) AS tagalog_movie_count FROM name AS n JOIN cast_info AS ci ON n.id = ci.person_id JOIN movie_info_idx AS mi_idx ON ci.movie_id = mi_idx.movie_id AND mi_idx.info_type_id = (SELECT id FROM info_type WHERE info = 'rating') JOIN movie_info AS m_info ON ci.movie_id = m_info.movie_id AND m_info.info_type_id = (SELECT id FROM info_type WHERE info = 'language') JOIN aka_name AS an ON n.id = an.person_id WHERE n.md5sum IN ('5c62d56f20103365a0051ebfd83ddd52', '4fbdca492f6b2ca9c6ee41602f4c8105', 'b19cb2bb887743bd4f33ed7c2b452ef6', '11f7d599980f6d97b7059ab1819ac294', 'd8d7be4935447c9e30dce0605179162d', 'e788144eeed55c07f730effca4f3cb55') AND n.surname_pcode = 'A4' GROUP BY n.name HAVING COUNT(DISTINCT ci.movie_id) > 5 ORDER BY average_movie_rating DESC;
SELECT kt.kind, COUNT(DISTINCT t.id) AS total_movies, AVG(t.production_year) AS average_production_year, SUM(CASE WHEN ci.role_id = 1 THEN 1 ELSE 0 END) AS total_actors, SUM(CASE WHEN ci.role_id = 2 THEN 1 ELSE 0 END) AS total_directors, COUNT(DISTINCT mc.company_id) AS total_companies_involved, COUNT(DISTINCT k.id) AS total_unique_keywords FROM title t JOIN kind_type kt ON t.kind_id = kt.id LEFT JOIN cast_info ci ON t.id = ci.movie_id LEFT JOIN movie_companies mc ON t.id = mc.movie_id LEFT JOIN keyword k ON t.id = k.id WHERE t.production_year > 2000 AND kt.id = 5 AND ci.note LIKE '%(20%' AND ci.role_id IN (1, 2) GROUP BY kt.kind ORDER BY total_movies DESC;
SELECT it.info AS info_type, COUNT(mi.id) AS total_movie_info_entries, AVG(LENGTH(mi.info)) AS average_info_length, SUM(CASE WHEN mi.note IS NOT NULL THEN 1 ELSE 0 END) AS count_with_notes FROM movie_info mi JOIN info_type it ON mi.info_type_id = it.id JOIN keyword k ON k.id = ANY(ARRAY[8402, 763, 4258, 5648]) WHERE it.id IN (16, 97, 31, 104, 71) GROUP BY it.info ORDER BY total_movie_info_entries DESC, average_info_length DESC;
SELECT kt.kind AS movie_kind, COUNT(DISTINCT mi_idx.movie_id) AS total_movies, AVG(CAST(mi_idx.info AS INTEGER)) AS average_movie_rating, SUM(CASE WHEN cn.country_code = '[sd]' THEN 1 ELSE 0 END) AS sudanese_company_movies, SUM(CASE WHEN cn.country_code = '[dz]' THEN 1 ELSE 0 END) AS algerian_company_movies, SUM(CASE WHEN cn.country_code = '[dm]' THEN 1 ELSE 0 END) AS dominican_company_movies, COUNT(DISTINCT k.id) AS total_unique_keywords FROM movie_info_idx AS mi_idx JOIN kind_type AS kt ON mi_idx.info_type_id = kt.id JOIN movie_info_idx AS mi_votes ON mi_idx.movie_id = mi_votes.movie_id AND mi_votes.info_type_id = 41 JOIN company_name AS cn ON mi_idx.movie_id = cn.imdb_id LEFT JOIN movie_keyword AS mk ON mi_idx.movie_id = mk.movie_id LEFT JOIN keyword AS k ON mk.keyword_id = k.id WHERE mi_idx.info_type_id IN (112, 72) AND kt.id IN (2, 1, 3) GROUP BY kt.kind;
SELECT rt.ROLE, COUNT(DISTINCT t.id) AS total_titles, AVG(t.production_year) AS average_production_year, SUM(CASE WHEN lt.LINK = 'featured in' THEN 1 ELSE 0 END) AS featured_in_count, SUM(CASE WHEN lt.LINK = 'followed by' THEN 1 ELSE 0 END) AS followed_by_count, SUM(CASE WHEN lt.LINK = 'referenced in' THEN 1 ELSE 0 END) AS referenced_in_count, SUM(CASE WHEN lt.LINK = 'remade as' THEN 1 ELSE 0 END) AS remade_as_count FROM title AS t JOIN role_type AS rt ON t.kind_id = rt.id JOIN link_type AS lt ON t.kind_id = lt.id JOIN info_type AS it ON t.kind_id = it.id WHERE t.production_year BETWEEN 1990 AND 2010 AND t.episode_nr IS NOT NULL AND rt.id = 7 AND rt.ROLE = 'editor' AND lt.id IN (5, 15) AND it.id IN (31, 10, 50, 76, 73) GROUP BY rt.ROLE ORDER BY total_titles DESC;
SELECT ct.kind AS company_type, AVG(CASE WHEN ml.link_type_id = '3' THEN 1 ELSE 0 END) AS avg_movie_references, COUNT(DISTINCT mk.movie_id) AS unique_movies_with_keywords, COUNT(DISTINCT at.id) AS total_aka_titles, SUM(CASE WHEN at.phonetic_code IN ('T54', 'V5231') THEN 1 ELSE 0 END) AS count_phonetic_code_matches, MAX(at.production_year) AS latest_production_year FROM company_type ct LEFT JOIN movie_companies mc ON ct.id = mc.company_type_id LEFT JOIN movie_link ml ON mc.movie_id = ml.movie_id LEFT JOIN movie_keyword mk ON mc.movie_id = mk.movie_id LEFT JOIN aka_title at ON mc.movie_id = at.movie_id WHERE ct.kind = 'distributors' AND ml.link_type_id IN ('3', '9', '15', '4', '10') GROUP BY ct.kind;
SELECT AVG(ak.title_count) AS average_title_count, MAX(ak.max_production_year) AS latest_production_year, MIN(ak.min_production_year) AS earliest_production_year, SUM(ak.title_count) AS total_titles, COUNT(DISTINCT ki.id) AS total_unique_keywords, COUNT(DISTINCT pi.person_id) AS total_unique_persons FROM (SELECT at.movie_id, COUNT(at.id) AS title_count, MAX(at.production_year) AS max_production_year, MIN(at.production_year) AS min_production_year FROM aka_title at GROUP BY at.movie_id ) ak LEFT JOIN movie_keyword mk ON mk.movie_id = ak.movie_id LEFT JOIN keyword ki ON ki.id = mk.keyword_id AND ki.keyword IN ('vampire-hunter', 'training', 'newspaper-editor', 'multiple-views', 'historical-fiction', 'forbidden-love') LEFT JOIN movie_info_idx mi ON mi.movie_id = ak.movie_id LEFT JOIN person_info pi ON pi.info_type_id = mi.info_type_id GROUP BY ki.keyword;
SELECT lt.LINK AS link_type, COUNT(DISTINCT ml.movie_id) AS num_movies, COUNT(ml.id) AS total_links, AVG(sub_ml.movie_links_count) AS average_links_per_movie FROM movie_link AS ml JOIN link_type AS lt ON ml.link_type_id = lt.id JOIN movie_info_idx AS miidx ON ml.movie_id = miidx.movie_id JOIN (SELECT movie_id, COUNT(id) AS movie_links_count FROM movie_link GROUP BY movie_id) AS sub_ml ON sub_ml.movie_id = ml.movie_id WHERE miidx.info_type_id IN (SELECT id FROM company_type WHERE kind = 'special effects companies') GROUP BY lt.LINK;
