SELECT cct.kind AS role_type, COUNT(DISTINCT ci.person_id) AS number_of_people, AVG(ci.nr_order) AS average_cast_order, COUNT(DISTINCT k.id) AS number_of_keywords FROM cast_info ci JOIN comp_cast_type cct ON ci.role_id = cct.id JOIN keyword k ON k.keyword LIKE '%murder%' OR k.keyword LIKE '%violence%' WHERE ci.person_role_id IN (2, 3, 4) GROUP BY cct.kind ORDER BY number_of_people DESC, average_cast_order;
SELECT kt.kind AS movie_kind, rt.ROLE AS role_type, COUNT(DISTINCT ci.movie_id) AS total_movies, COUNT(DISTINCT ci.person_id) AS total_people, AVG(ci.nr_order) AS average_cast_position, SUM(CASE WHEN rt.ROLE = 'producer' THEN 1 ELSE 0 END) AS total_producers, SUM(CASE WHEN rt.ROLE = 'actor' THEN 1 ELSE 0 END) AS total_actors FROM cast_info ci JOIN role_type rt ON ci.role_id = rt.id JOIN kind_type kt ON kt.id = (SELECT id FROM kind_type WHERE id = ci.person_role_id) JOIN movie_companies mc ON mc.movie_id = ci.movie_id JOIN company_name cn ON cn.id = mc.company_id WHERE rt.id IN (4, 5) GROUP BY kt.kind, rt.ROLE ORDER BY total_movies DESC, average_cast_position ASC;
SELECT it.info AS info_category, COUNT(DISTINCT mc.movie_id) AS number_of_movies, AVG(CAST(mi_idx.info AS INTEGER)) AS average_rating, SUM(CASE WHEN mc.company_type_id = 1 THEN 1 ELSE 0 END) AS number_of_production_companies, SUM(CASE WHEN mc.company_type_id = 2 THEN 1 ELSE 0 END) AS number_of_distributors, COUNT(DISTINCT pi.person_id) AS number_of_people_involved, COUNT(DISTINCT ml.linked_movie_id) AS number_of_linked_movies FROM movie_info_idx AS mi_idx JOIN info_type AS it ON mi_idx.info_type_id = it.id JOIN movie_companies AS mc ON mi_idx.movie_id = mc.movie_id JOIN person_info AS pi ON mi_idx.movie_id = pi.person_id JOIN movie_link AS ml ON mi_idx.movie_id = ml.movie_id WHERE it.id IN (18, 57, 72, 5, 81) AND mc.id = 1085 AND mi_idx.id = 21 AND mc.note IS NOT NULL AND mi_idx.movie_id IN (8975, 19179, 18832, 8413, 9810) GROUP BY it.info ORDER BY number_of_movies DESC;
SELECT kt.kind AS movie_type, COUNT(DISTINCT mc.movie_id) AS total_movies, COUNT(DISTINCT company_name.id) AS total_companies, AVG(CAST(movie_info_idx.info AS INTEGER)) AS average_movie_votes, SUM(CASE WHEN movie_keyword.keyword_id IN ('3511', '571', '2246', '851') THEN 1 ELSE 0 END) AS relevant_keyword_count FROM movie_companies AS mc JOIN kind_type AS kt ON mc.company_type_id = kt.id JOIN company_name ON mc.company_id = company_name.id JOIN movie_info_idx ON mc.movie_id = movie_info_idx.movie_id AND movie_info_idx.info_type_id = '100' LEFT JOIN movie_keyword ON mc.movie_id = movie_keyword.movie_id WHERE company_name.country_code = 'us' AND company_name.name_pcode_nf IN ('M3261', 'N63', 'W145') AND company_name.md5sum IN ('b38522871a3a9a6ad83d7e5843a8052f', 'c67d47f8ed0acd863dbcb8c2b928208a', 'ae19a96a34d54b7e7ee2c770489cf9fb', '5e5a159eb009ac92bde3144fdf7d7d1a', '3119ec8bdc119971f2e03179a43f5ce4', 'f07a92b898eabd85eba36a20b3df770e') AND kt.kind IN ('tv movie', 'movie', 'tv mini series', 'episode', 'video game') GROUP BY kt.kind;
SELECT ct.kind AS company_type, COUNT(DISTINCT mc.movie_id) AS total_movies, COUNT(DISTINCT mc.company_id) AS total_companies FROM movie_companies mc JOIN company_type ct ON mc.company_type_id = ct.id JOIN name n ON mc.company_id = n.id WHERE ct.kind IN ('production companies', 'special effects companies', 'distributors') GROUP BY ct.kind ORDER BY total_movies DESC;
SELECT COUNT(DISTINCT t.id) AS total_movies, AVG(t.production_year) AS average_production_year, SUM(CASE WHEN t.series_years LIKE '%????' THEN 1 ELSE 0 END) AS ongoing_series_count, ct.kind AS company_type_kind, AVG(CAST(cn.country_code AS numeric)) AS average_country_code_numeric, ct.id AS company_type_id, MAX(t.season_nr) AS max_season_number FROM title t JOIN company_name cn ON t.id = cn.id JOIN company_type ct ON cn.id = ct.id JOIN complete_cast cc ON t.id = cc.movie_id JOIN comp_cast_type cct ON cc.subject_id = cct.id JOIN aka_title at ON t.id = at.movie_id JOIN info_type it ON at.id = it.id WHERE t.season_nr IN (6, 15, 8, 17) AND t.series_years IN ('1963-1969', '2003-2006', '1997-1998', '1974-????', '1956-????', '1993-1994') AND it.id IN (20, 107, 32, 88) AND it.info IN ('death notes', 'votes', 'LD subtitles', 'LD dynamic range', 'LD close captions-teletext-ld-g', 'adaption') AND cct.id = 1 AND cct.kind IN ('complete+verified', 'cast', 'crew', 'complete') AND at.id = 33786 AND at.production_year IN (2002, 1976, 1959) GROUP BY ct.kind, ct.id ORDER BY total_movies DESC;
SELECT kt.kind, AVG(t.production_year) AS average_production_year, COUNT(DISTINCT t.id) AS total_titles, SUM(CASE WHEN rt.role = 'cinematographer' THEN 1 ELSE 0 END) AS cinematographer_count, SUM(CASE WHEN rt.role = 'writer' THEN 1 ELSE 0 END) AS writer_count, SUM(CASE WHEN rt.role = 'miscellaneous crew' THEN 1 ELSE 0 END) AS miscellaneous_crew_count FROM title t JOIN kind_type kt ON t.kind_id = kt.id JOIN role_type rt ON t.id = rt.id WHERE kt.id IN (3, 7, 4, 6, 2) AND rt.id IN (5, 3, 9, 4, 11, 6) AND t.production_year IS NOT NULL GROUP BY kt.kind ORDER BY average_production_year DESC;
SELECT info_type.info AS info_category, COUNT(DISTINCT movie_info.movie_id) AS number_of_movies, AVG(LENGTH(movie_info.info)) AS average_info_length, SUM(CASE WHEN comp_cast_type.kind = 'complete+verified' THEN 1 ELSE 0 END) AS complete_verified_count, SUM(CASE WHEN comp_cast_type.kind = 'cast' THEN 1 ELSE 0 END) AS cast_count, SUM(CASE WHEN comp_cast_type.kind = 'crew' THEN 1 ELSE 0 END) AS crew_count FROM movie_info JOIN info_type ON movie_info.info_type_id = info_type.id JOIN movie_info_idx ON movie_info.movie_id = movie_info_idx.movie_id JOIN comp_cast_type ON movie_info_idx.info_type_id = comp_cast_type.id WHERE info_type.info IN ('LD original title', 'LD quality of source', 'tech info', 'LD master format', 'salary history', 'LD release country') AND comp_cast_type.kind IN ('complete+verified', 'cast', 'crew', 'complete') GROUP BY info_type.info ORDER BY number_of_movies DESC;
SELECT ct.kind AS company_kind, COUNT(DISTINCT cn.id) AS number_of_companies, COUNT(DISTINCT n.id) AS number_of_related_people, AVG(n.imdb_id) AS average_imdb_id, SUM(CASE WHEN k.keyword = 'business-deal' THEN 1 ELSE 0 END) AS count_business_deal_keywords, MAX(mi.info) AS latest_movie_info FROM company_name cn JOIN company_type ct ON cn.name_pcode_nf = ct.id::varchar JOIN movie_info mi ON mi.info_type_id = ct.id JOIN keyword k ON k.id = mi.movie_id JOIN name n ON n.imdb_id = mi.movie_id WHERE cn.country_code NOT IN ('[pl]', '[us]') AND k.keyword IN ('lunchbox', 'slipper', 'business-deal', 'child-molester') AND ct.kind IN ('special effects companies', 'miscellaneous companies', 'production companies', 'distributors') GROUP BY ct.kind ORDER BY number_of_companies DESC, count_business_deal_keywords DESC;
SELECT kt.kind, COUNT(DISTINCT cn.id) as number_of_companies, COUNT(DISTINCT pi.person_id) as number_of_people, AVG(CASE WHEN pi.note SIMILAR TO '%(Coverland|Chris Hendren|maria afsharian|CelebrityLoop.com)%' THEN CAST(pi.info AS NUMERIC) ELSE NULL END) as average_info_rating, SUM(CASE WHEN kt.kind = 'video movie' THEN 1 ELSE 0 END) as video_movie_count, SUM(CASE WHEN kt.kind = 'tv mini series' THEN 1 ELSE 0 END) as tv_mini_series_count, SUM(CASE WHEN kt.kind = 'video game' THEN 1 ELSE 0 END) as video_game_count FROM company_name cn JOIN kind_type kt ON cn.id = kt.id JOIN person_info pi ON cn.id = pi.person_id WHERE cn.country_code NOT IN ('US', 'GB') AND pi.info_type_id BETWEEN 1 AND 5 AND kt.id IN ('1', '2', '4', '5', '7') GROUP BY kt.kind ORDER BY number_of_companies DESC;
SELECT mi.info AS Movie_Language, rt.ROLE AS Role_Type, COUNT(DISTINCT ci.person_id) AS Total_People, AVG(ci.nr_order) AS Average_Cast_Order FROM movie_info mi JOIN cast_info ci ON mi.movie_id = ci.movie_id JOIN role_type rt ON ci.role_id = rt.id WHERE mi.info IN ('Bosnian', 'Serbian', 'Finnish', 'Greek') GROUP BY mi.info, rt.ROLE ORDER BY Movie_Language, Total_People DESC;
