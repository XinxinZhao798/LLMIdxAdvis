SELECT rt.ROLE, COUNT(distinct ci.movie_id) AS total_movies, COUNT(distinct ci.person_id) AS total_actors, AVG(ci.nr_order) AS average_cast_order, COUNT(distinct kw.id) AS total_keyword_occurrences, COUNT(distinct cn.id) AS total_companies_involved, AVG(length(pi.info)) AS average_person_info_length FROM cast_info ci JOIN role_type rt ON ci.role_id = rt.id JOIN movie_info_idx mi_idx ON ci.movie_id = mi_idx.movie_id JOIN keyword kw ON kw.id = ANY(ARRAY[9828, 3338, 5730, 2511]) JOIN company_name cn ON cn.imdb_id = mi_idx.movie_id JOIN person_info pi ON ci.person_id = pi.person_id WHERE rt.id IN (11, 10, 7, 2) AND rt.ROLE = 'actor' AND ci.movie_id IN (1610581, 1098561, 1413295, 2451586, 1851477, 2419871) AND ci.role_id = 1 GROUP BY rt.ROLE
SELECT mc.company_type_id, COUNT(DISTINCT mc.movie_id) AS total_movies, COUNT(DISTINCT mc.company_id) AS total_companies, AVG(k.id) AS average_keyword_id, COUNT(DISTINCT n.id) AS total_unique_cast_members, MAX(n.name) AS most_recent_cast_member_name FROM movie_companies mc JOIN keyword k ON mc.movie_id = k.id JOIN name n ON n.id = mc.company_id WHERE mc.company_type_id = '1' AND mc.note LIKE '%(TV)%' AND k.keyword IN ('training', 'mad-scientist', 'war-memorial') AND n.name_pcode_cf IN ('A6136', 'A2353', 'A6515', 'A4564', 'A2352', 'A265') GROUP BY mc.company_type_id;
SELECT COUNT(DISTINCT t.id) AS number_of_movies, AVG(t.production_year) AS average_production_year, SUM(CASE WHEN t.kind_id = 1 THEN 1 ELSE 0 END) AS number_of_feature_films, SUM(CASE WHEN t.kind_id = 2 THEN 1 ELSE 0 END) AS number_of_tv_shows, COUNT(DISTINCT n.id) AS number_of_cast_members, COUNT(DISTINCT cc.subject_id) AS number_of_cast_types, AVG(cc.status_id) AS average_status_id FROM title AS t JOIN complete_cast AS cc ON t.id = cc.movie_id JOIN name AS n ON cc.subject_id = n.id WHERE cc.status_id = 4 AND t.production_year > 1990 GROUP BY t.kind_id ORDER BY number_of_movies DESC, average_production_year DESC;
SELECT COUNT(DISTINCT mc.movie_id) AS number_of_movies, AVG(aka.production_year) AS average_production_year, MAX(aka.production_year) AS latest_production_year, MIN(aka.production_year) AS earliest_production_year, COUNT(DISTINCT cn.id) AS number_of_unique_companies, COUNT(DISTINCT mk.keyword_id) AS number_of_unique_keywords, SUM(CASE WHEN n.gender = 'F' THEN 1 ELSE 0 END) AS number_of_female_cast_members, SUM(CASE WHEN n.gender = 'M' THEN 1 ELSE 0 END) AS number_of_male_cast_members FROM movie_companies AS mc JOIN aka_title AS aka ON mc.movie_id = aka.movie_id JOIN movie_keyword AS mk ON aka.movie_id = mk.movie_id JOIN complete_cast AS cc ON aka.movie_id = cc.movie_id JOIN char_name AS cn ON cn.name_pcode_nf IN ('E2416', 'R3242', 'W4165') JOIN name AS n ON cn.id = n.id WHERE mc.id IN ('577', '4551', '4702', '4381', '3126', '3864') AND aka.kind_id = 1 GROUP BY aka.kind_id HAVING COUNT(DISTINCT mc.movie_id) > 10 ORDER BY average_production_year DESC;
SELECT kt.kind AS movie_kind, AVG(aka_title.production_year) AS average_production_year, COUNT(DISTINCT aka_title.movie_id) AS total_movies, COUNT(DISTINCT movie_companies.company_id) AS total_companies_involved, SUM(case when aka_title.season_nr is not null then 1 else 0 end) AS total_seasons, COUNT(DISTINCT role_type.id) AS total_unique_roles FROM aka_title JOIN kind_type AS kt ON aka_title.kind_id = kt.id JOIN movie_companies ON aka_title.movie_id = movie_companies.movie_id JOIN company_type AS ct ON movie_companies.company_type_id = ct.id JOIN role_type ON role_type.id = movie_companies.company_id WHERE ct.kind = 'production companies' AND role_type.role IN ('guest', 'writer', 'miscellaneous crew', 'cinematographer') AND aka_title.imdb_index IN ('III', 'IV', 'I', 'II') AND aka_title.production_year BETWEEN 1990 AND 2020 GROUP BY kt.kind ORDER BY total_movies DESC;
SELECT it.info AS info_type, COUNT(*) AS total_movies, AVG(CAST(mi.info AS INTEGER)) AS average_info_value, SUM(CAST(mi.info AS INTEGER)) AS sum_info_value, COUNT(DISTINCT cc.movie_id) AS count_distinct_movies FROM movie_info_idx mi JOIN info_type it ON mi.info_type_id = it.id LEFT JOIN complete_cast cc ON mi.movie_id = cc.movie_id WHERE it.id IN (27, 34, 97, 20, 80, 54) AND mi.movie_id IN (19576, 19282, 18727, 13977, 7344) GROUP BY it.info;
SELECT tk.kind, AVG(t.production_year) AS average_production_year, SUM(t.production_year) AS total_production_year_sum, COUNT(DISTINCT t.id) AS number_of_movies, COUNT(DISTINCT mc.company_type_id) AS distinct_company_types_involved FROM title AS t JOIN movie_companies AS mc ON t.id = mc.movie_id JOIN company_type AS ct ON mc.company_type_id = ct.id JOIN (SELECT id, 'Drama' AS kind FROM title WHERE kind_id = 1 UNION ALL SELECT id, 'Comedy' AS kind FROM title WHERE kind_id = 2 ) AS tk ON t.id = tk.id GROUP BY tk.kind ORDER BY number_of_movies DESC, average_production_year DESC;
SELECT COUNT(DISTINCT t.id) AS total_movies, AVG(t.production_year) AS average_production_year, COUNT(DISTINCT mc.company_id) AS number_of_companies, SUM(CASE WHEN lt.link LIKE '%remake of%' THEN 1 ELSE 0 END) AS total_remake_movies, COUNT(DISTINCT pi.person_id) AS number_of_persons_with_info, SUM(CASE WHEN rt.role = 'actress' THEN 1 ELSE 0 END) AS total_actress_roles FROM title AS t LEFT JOIN movie_companies AS mc ON t.id = mc.movie_id LEFT JOIN person_info AS pi ON pi.info IN ('Sand Springs, Oklahoma, USA', 'Wilmington, Delaware, USA', '29 January 1982') LEFT JOIN role_type AS rt ON rt.role IN ('editor', 'composer', 'actress') LEFT JOIN link_type AS lt ON lt.link IN ('remake of', 'spin off from', 'spoofs') WHERE t.production_year > 2000 AND mc.company_type_id = '1' AND (lt.id IN ('5', '2', '1', '15', '17') OR lt.id IS NULL) GROUP BY t.kind_id ORDER BY total_movies DESC;
SELECT COUNT(DISTINCT ci.person_id) AS total_actors, AVG(ci.nr_order) AS average_cast_position, SUM(CASE WHEN ci.role_id = 1 THEN 1 ELSE 0 END) AS total_leading_roles, COUNT(DISTINCT mc.company_id) AS total_production_companies, COUNT(DISTINCT ml.linked_movie_id) AS total_linked_movies, SUM(CASE WHEN lt.id = '12' THEN 1 ELSE 0 END) AS total_prequels_links, SUM(CASE WHEN lt.id = '7' THEN 1 ELSE 0 END) AS total_sequels_links, MAX(n.name) AS max_actor_name, MIN(n.name) AS min_actor_name FROM cast_info ci JOIN name n ON ci.person_id = n.id JOIN movie_companies mc ON ci.movie_id = mc.movie_id LEFT JOIN movie_link ml ON ci.movie_id = ml.movie_id LEFT JOIN link_type lt ON ml.link_type_id = lt.id WHERE n.imdb_index IN ('IX', 'XXIII', 'XIII') AND ci.note IN ('(segment "It Takes Two to Tango")', '(segment "Public Service Announcement")') AND ci.role_id = 1 GROUP BY ci.role_id;
SELECT n.name AS actor_name, COUNT(DISTINCT ci.movie_id) AS total_movies, AVG(mi_idx.info::numeric) AS average_movie_rating, SUM(CASE WHEN pi.info LIKE '%Oscar%' THEN 1 ELSE 0 END) AS total_oscars_won FROM cast_info ci INNER JOIN name n ON ci.person_id = n.id LEFT JOIN movie_info_idx mi_idx ON ci.movie_id = mi_idx.movie_id AND mi_idx.info_type_id = (SELECT id FROM info_type WHERE info = 'rating') LEFT JOIN person_info pi ON ci.person_id = pi.person_id AND pi.info_type_id = (SELECT id FROM info_type WHERE info = 'awards') WHERE n.imdb_index IN ('XXIII', 'XV', 'IX', 'XI') AND ci.role_id = (SELECT id FROM role_type WHERE role = 'actor') AND pi.note NOT IN ('carlosprimati@uol.com.br', 'E.A.', 'IMDb Editors') GROUP BY n.name HAVING COUNT(DISTINCT ci.movie_id) > 5 ORDER BY total_oscars_won DESC, average_movie_rating DESC, total_movies DESC, actor_name;
SELECT rt.ROLE AS role_type, AVG(ci.nr_order) AS average_order, COUNT(DISTINCT ci.person_id) AS distinct_actors_count, SUM(CASE WHEN k.phonetic_code = 'D56' THEN 1 ELSE 0 END) AS keyword_D56_count, MIN(t.title) AS earliest_movie_title, MAX(t.production_year) AS latest_production_year, COUNT(DISTINCT k.id) AS distinct_keyword_count FROM cast_info ci JOIN role_type rt ON ci.role_id = rt.id JOIN title t ON ci.movie_id = t.id LEFT JOIN keyword k ON k.id = ANY(ARRAY[2148, 118, 3933, 2925]) WHERE rt.ROLE IN ('actor', 'actress', 'producer', 'director') AND t.production_year BETWEEN 1990 AND 2020 GROUP BY rt.ROLE ORDER BY distinct_actors_count DESC;
SELECT AVG(mi_idx.info::numeric) AS average_rating, COUNT(DISTINCT k.id) AS total_unique_keywords, COUNT(DISTINCT n.id) AS total_unique_writers, SUM(CASE WHEN cn.surname_pcode = 'M1236' THEN 1 ELSE 0 END) AS count_of_m1236_surname_writers FROM keyword AS k LEFT JOIN movie_keyword AS mk ON k.id = mk.keyword_id LEFT JOIN movie_info_idx AS mi_idx ON mk.movie_id = mi_idx.movie_id AND mi_idx.info_type_id = 101 LEFT JOIN cast_info AS ci ON mk.movie_id = ci.movie_id LEFT JOIN char_name AS cn ON ci.person_id = cn.id AND ci.role_id = 2 LEFT JOIN name AS n ON ci.person_id = n.id AND n.gender = 'm' WHERE k.keyword IN ('airforce-one', 'mexican-revolutionary', 'full-house', 'gay-hollywood', 'overactive-imagination') AND cn.surname_pcode IN ('M1236', 'H3245', 'Z12', 'F236') AND ci.role_id IN (SELECT id FROM comp_cast_type WHERE kind = 'writer') GROUP BY ci.movie_id;
SELECT COUNT(DISTINCT t.id) AS total_movies, AVG(t.production_year) AS average_production_year, SUM(CASE WHEN t.series_years LIKE '%????' THEN 1 ELSE 0 END) AS ongoing_series_count, ct.kind AS company_type_kind, AVG(CAST(cn.country_code AS numeric)) AS average_country_code_numeric, ct.id AS company_type_id, MAX(t.season_nr) AS max_season_number FROM title t JOIN company_name cn ON t.id = cn.id JOIN company_type ct ON cn.id = ct.id JOIN complete_cast cc ON t.id = cc.movie_id JOIN comp_cast_type cct ON cc.subject_id = cct.id JOIN aka_title at ON t.id = at.movie_id JOIN info_type it ON at.id = it.id WHERE t.season_nr IN (6, 15, 8, 17) AND t.series_years IN ('1963-1969', '2003-2006', '1997-1998', '1974-????', '1956-????', '1993-1994') AND it.id IN (20, 107, 32, 88) AND it.info IN ('death notes', 'votes', 'LD subtitles', 'LD dynamic range', 'LD close captions-teletext-ld-g', 'adaption') AND cct.id = 1 AND cct.kind IN ('complete+verified', 'cast', 'crew', 'complete') AND at.id = 33786 AND at.production_year IN (2002, 1976, 1959) GROUP BY ct.kind, ct.id ORDER BY total_movies DESC;
SELECT AVG(t.production_year) AS average_production_year, COUNT(DISTINCT n.id) AS total_actors, COUNT(DISTINCT pi.person_id) AS actors_with_additional_info, SUM(CASE WHEN rt.ROLE = 'Actor' THEN 1 ELSE 0 END) AS total_actor_roles, SUM(CASE WHEN rt.ROLE = 'Director' THEN 1 ELSE 0 END) AS total_director_roles, COUNT(DISTINCT t.id) AS total_titles FROM title t LEFT JOIN complete_cast cc ON t.id = cc.movie_id LEFT JOIN name n ON cc.subject_id = n.id LEFT JOIN role_type rt ON cc.status_id = rt.id LEFT JOIN person_info pi ON n.id = pi.person_id WHERE t.production_year IN ('1998', '1971') GROUP BY t.kind_id ORDER BY average_production_year DESC;
SELECT ml.movie_id, lt.LINK AS link_type, COUNT(ml.id) AS total_links, AVG(cn.imdb_id) AS avg_company_imdb_id FROM movie_link AS ml JOIN link_type AS lt ON ml.link_type_id = lt.id JOIN company_name AS cn ON ml.movie_id = cn.id GROUP BY ml.movie_id, lt.LINK ORDER BY total_links DESC, avg_company_imdb_id DESC;
SELECT kt.kind AS movie_type, AVG(t.production_year) AS average_production_year, COUNT(DISTINCT t.id) AS total_movies, SUM(CASE WHEN at.note LIKE '%(DVD box title)%' THEN 1 ELSE 0 END) AS total_dvd_box_titles, COUNT(DISTINCT ct.id) AS total_company_types, COUNT(lt.id) AS total_link_types FROM title t JOIN kind_type kt ON t.kind_id = kt.id LEFT JOIN aka_title at ON t.id = at.movie_id LEFT JOIN company_type ct ON ct.id = t.id LEFT JOIN link_type lt ON lt.id = t.id WHERE t.production_year BETWEEN 1990 AND 2020 AND at.note IS NOT NULL AND at.production_year > 1980 GROUP BY kt.kind ORDER BY total_movies DESC;
SELECT kt.kind AS movie_type, COUNT(DISTINCT at.movie_id) AS number_of_titles, AVG(at.production_year) AS average_production_year, SUM(CASE WHEN cc.status_id = '4' THEN 1 ELSE 0 END) AS count_completed_status_4, SUM(CASE WHEN cc.status_id = '3' THEN 1 ELSE 0 END) AS count_completed_status_3 FROM aka_title at JOIN kind_type kt ON at.kind_id = kt.id LEFT JOIN complete_cast cc ON at.movie_id = cc.movie_id GROUP BY kt.kind ORDER BY number_of_titles DESC;
SELECT kt.kind AS movie_kind, AVG(title.production_year) AS average_production_year, COUNT(DISTINCT cast_info.person_id) AS number_of_actors, COUNT(DISTINCT company_name.id) AS number_of_companies, SUM(case when cast_info.role_id = 1 then 1 else 0 end) AS number_of_lead_roles, MAX(movie_info.info) AS longest_movie_info FROM title JOIN kind_type AS kt ON title.kind_id = kt.id JOIN cast_info ON title.id = cast_info.movie_id JOIN movie_companies ON title.id = movie_companies.movie_id JOIN company_name ON movie_companies.company_id = company_name.id JOIN movie_info ON title.id = movie_info.movie_id WHERE title.production_year >= 2000 AND cast_info.role_id = 1 AND movie_companies.company_type_id IN (SELECT id FROM company_name WHERE country_code = 'US') GROUP BY kt.kind ORDER BY average_production_year DESC, number_of_actors DESC;
SELECT lt.LINK AS link_type, COUNT(ml.id) AS total_links, AVG(n.imdb_id) AS average_imdb_id, MIN(n.name) AS first_alphabetical_actor_name, SUM(CASE WHEN n.gender = 'f' THEN 1 ELSE 0 END) AS total_actresses, SUM(CASE WHEN n.gender = 'm' THEN 1 ELSE 0 END) AS total_actors FROM movie_link AS ml JOIN link_type AS lt ON ml.link_type_id = lt.id JOIN name AS n ON n.id = ml.movie_id OR n.id = ml.linked_movie_id WHERE lt.id IN (8, 6, 13, 10, 16, 7) GROUP BY lt.LINK ORDER BY total_links DESC;
SELECT ct.kind AS company_kind, COUNT(DISTINCT t.id) AS number_of_movies, AVG(t.production_year) AS average_production_year, COUNT(DISTINCT cc.subject_id) AS number_of_subjects, SUM(CASE WHEN t.kind_id = 1 THEN 1 ELSE 0 END) AS number_of_feature_films, SUM(CASE WHEN t.kind_id = 2 THEN 1 ELSE 0 END) AS number_of_tv_shows, SUM(CASE WHEN t.kind_id = 4 THEN 1 ELSE 0 END) AS number_of_documentaries FROM title t JOIN complete_cast cc ON t.id = cc.movie_id JOIN company_type ct ON t.kind_id = ct.id GROUP BY ct.kind ORDER BY number_of_movies DESC;
SELECT MIN(t.title) AS movie_title, MIN(at.title) AS alternative_title, AVG(ci.nr_order) AS average_cast_order, COUNT(DISTINCT t.id) AS number_of_movies, COUNT(DISTINCT ci.person_id) AS number_of_unique_actors, SUM(CASE WHEN t.production_year BETWEEN 1970 AND 1980 THEN 1 ELSE 0 END) AS movies_produced_1970_to_1980, SUM(CASE WHEN t.production_year BETWEEN 1981 AND 1990 THEN 1 ELSE 0 END) AS movies_produced_1981_to_1990, SUM(CASE WHEN t.production_year BETWEEN 1991 AND 2000 THEN 1 ELSE 0 END) AS movies_produced_1991_to_2000 FROM title AS t INNER JOIN aka_title AS at ON t.id = at.movie_id AND at.kind_id IN (1, 3) INNER JOIN cast_info AS ci ON t.id = ci.movie_id WHERE t.production_year IN (1985, 1975, 1950, 1972) GROUP BY t.kind_id HAVING COUNT(DISTINCT ci.person_id) > 10 ORDER BY number_of_movies DESC, average_cast_order;
