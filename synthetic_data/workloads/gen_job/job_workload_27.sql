SELECT mc.company_id, COUNT(DISTINCT cc.movie_id) AS total_movies, AVG(mi_idx_numeric.info::NUMERIC) AS average_numeric_info, SUM(CASE WHEN mc.company_type_id = 1 THEN 1 ELSE 0 END) AS production_companies, SUM(CASE WHEN mc.company_type_id = 2 THEN 1 ELSE 0 END) AS distribution_companies FROM movie_companies AS mc JOIN complete_cast AS cc ON mc.movie_id = cc.movie_id JOIN movie_info_idx AS mi_idx ON mc.movie_id = mi_idx.movie_id JOIN movie_info_idx AS mi_idx_numeric ON mc.movie_id = mi_idx_numeric.movie_id AND mi_idx_numeric.info ~ '^[0-9\.]+$' WHERE mi_idx.info_type_id = 3 GROUP BY mc.company_id HAVING COUNT(DISTINCT cc.movie_id) > 5 ORDER BY total_movies DESC, average_numeric_info DESC;
SELECT kt.kind AS movie_kind, COUNT(DISTINCT mi.movie_id) AS number_of_movies, AVG(CASE WHEN mi_numeric.info_type_id = 3 THEN mi_numeric.info::NUMERIC END) AS average_movie_length, COUNT(DISTINCT kw.id) AS number_of_unique_keywords, SUM(CASE WHEN n.gender = 'M' THEN 1 ELSE 0 END) AS male_cast_count, SUM(CASE WHEN n.gender = 'F' THEN 1 ELSE 0 END) AS female_cast_count FROM movie_info mi JOIN kind_type kt ON mi.info_type_id = kt.id JOIN movie_keyword mk ON mi.movie_id = mk.movie_id JOIN keyword kw ON mk.keyword_id = kw.id LEFT JOIN movie_link ml ON mi.movie_id = ml.movie_id LEFT JOIN name n ON ml.movie_id = n.id LEFT JOIN movie_info mi_numeric ON mi.movie_id = mi_numeric.movie_id AND mi_numeric.info_type_id = 3 WHERE kt.kind = 'complete' AND kw.keyword IN ('santiago-de-chile', 'golf-club', 'tripping') AND n.name IN ('Anderson, Othello', 'Ammar, Ali', 'Ameyl, Dzaga') GROUP BY kt.kind;
SELECT COUNT(*) AS total_movies, AVG(aka_title.production_year) AS average_production_year, SUM(CASE WHEN comp_cast_type.kind = 'complete' THEN 1 ELSE 0 END) AS total_complete_cast_movies, SUM(CASE WHEN comp_cast_type.kind = 'complete+verified' THEN 1 ELSE 0 END) AS total_verified_cast_movies, COUNT(DISTINCT char_name.name) AS distinct_character_names, COUNT(DISTINCT keyword.id) AS total_keywords, MAX(movie_companies.company_type_id) AS max_company_type_id FROM aka_title JOIN movie_keyword ON aka_title.movie_id = movie_keyword.movie_id JOIN keyword ON movie_keyword.keyword_id = keyword.id JOIN movie_companies ON aka_title.movie_id = movie_companies.movie_id JOIN comp_cast_type ON movie_companies.company_type_id = comp_cast_type.id JOIN char_name ON char_name.name = aka_title.note WHERE aka_title.production_year BETWEEN 1990 AND 2000 AND movie_companies.company_type_id = 1 AND aka_title.kind_id = 1 AND (char_name.name IN ('Vereshchagin', 'Old Man on Street', 'Hadhod', 'Uncle Carl Ã…kerblom') OR movie_keyword.movie_id IN ('15386', '18793')) GROUP BY aka_title.kind_id ORDER BY total_movies DESC;
SELECT kt.kind AS movie_kind, AVG(CASE WHEN rt.ROLE = 'director' THEN 1 ELSE 0 END) AS avg_director_presence, COUNT(DISTINCT ml.movie_id) AS num_movies_linked, MAX(t.production_year) AS latest_production_year, MIN(t.production_year) AS earliest_production_year, SUM(CASE WHEN mi.info_type_id = 2 AND mi.info = 'color' THEN 1 ELSE 0 END) AS total_color_movies, COUNT(DISTINCT t.id) AS total_movies FROM title t LEFT JOIN kind_type kt ON t.kind_id = kt.id LEFT JOIN movie_link ml ON t.id = ml.movie_id LEFT JOIN movie_info mi ON t.id = mi.movie_id LEFT JOIN role_type rt ON mi.info_type_id = rt.id WHERE t.production_year BETWEEN 1990 AND 2020 AND kt.kind IN ('movie', 'tv series', 'video game') AND (ml.link_type_id IN (5, 12, 16) OR ml.link_type_id IS NULL) AND (ml.linked_movie_id IN (1639371, 2307098) OR ml.linked_movie_id IS NULL) AND rt.ROLE IN ('director', 'actor', 'producer') GROUP BY kt.kind ORDER BY total_movies DESC;
SELECT k.keyword, COUNT(DISTINCT ci.movie_id) AS movie_count, AVG(a.production_year) AS avg_production_year, COUNT(DISTINCT ci.person_id) AS actor_count, SUM(CASE WHEN ci.role_id = 1 THEN 1 ELSE 0 END) AS lead_roles, SUM(CASE WHEN ci.role_id = 2 THEN 1 ELSE 0 END) AS supporting_roles FROM keyword k JOIN cast_info ci ON ci.movie_id = k.id JOIN aka_title a ON a.movie_id = ci.movie_id WHERE k.id IN (9469, 4548, 8976, 5594, 8711) GROUP BY k.keyword ORDER BY movie_count DESC, avg_production_year DESC;
SELECT kt.kind, t.production_year AS production_year, COUNT(DISTINCT t.id) AS number_of_titles, AVG(CAST(mi_idx.info AS FLOAT)) FILTER (WHERE mi_idx.info_type_id = 101) AS average_rating, COUNT(cc.id) AS complete_cast_count FROM title AS t LEFT JOIN kind_type AS kt ON t.kind_id = kt.id LEFT JOIN movie_info_idx AS mi_idx ON t.id = mi_idx.movie_id LEFT JOIN complete_cast AS cc ON t.id = cc.movie_id WHERE t.kind_id IN (2, 7) GROUP BY kt.kind, production_year ORDER BY kt.kind, production_year DESC;
SELECT kt.kind AS movie_type, COUNT(DISTINCT at.id) AS total_alternate_titles, AVG(cc.status_id) AS average_status_id, SUM(CASE WHEN at.kind_id = 7 THEN 1 ELSE 0 END) AS total_tv_shows, SUM(CASE WHEN at.kind_id = 2 THEN 1 ELSE 0 END) AS total_movies, COUNT(DISTINCT mi.id) AS total_movie_info_entries, COUNT(DISTINCT cc.id) AS total_complete_cast_entries FROM aka_title at JOIN kind_type kt ON at.kind_id = kt.id JOIN complete_cast cc ON at.movie_id = cc.movie_id LEFT JOIN movie_info_idx mi ON at.movie_id = mi.movie_id GROUP BY kt.kind ORDER BY total_alternate_titles DESC;
SELECT kind.kind AS company_kind, COUNT(DISTINCT ci.movie_id) AS num_movies, AVG(mi_idx.info::NUMERIC) AS average_movie_rating, SUM(CASE WHEN at.title LIKE '%War%' THEN 1 ELSE 0 END) AS num_war_related_titles, COUNT(DISTINCT ci.person_id) AS num_unique_actors FROM company_type kind JOIN movie_info_idx mi_idx ON mi_idx.info LIKE '0.0%' JOIN movie_info mi ON mi.movie_id = mi_idx.movie_id AND mi.info = 'Romanian' JOIN aka_title at ON at.movie_id = mi.movie_id JOIN cast_info ci ON ci.movie_id = at.movie_id WHERE kind.kind = 'special effects companies' AND at.imdb_index IN ('I', 'II', 'III', 'IV') GROUP BY kind.kind;
SELECT kt.kind AS movie_kind, COUNT(DISTINCT at.id) AS total_titles, COUNT(DISTINCT at.movie_id) AS unique_movies, AVG(at.production_year) AS avg_production_year, SUM(CASE WHEN lt.link = 'alternate language version of' THEN 1 ELSE 0 END) AS alt_lang_versions, SUM(CASE WHEN lt.link = 'version of' THEN 1 ELSE 0 END) AS versions, SUM(CASE WHEN lt.link = 'features' THEN 1 ELSE 0 END) AS features_count FROM aka_title at JOIN kind_type kt ON at.kind_id = kt.id JOIN movie_info_idx mii ON at.movie_id = mii.movie_id JOIN link_type lt ON mii.id = lt.id WHERE at.imdb_index = 'IV' AND at.episode_of_id IN ('11942', '6153', '1980', '7480', '8274') AND kt.kind IN ('tv series', 'video movie', 'video game', 'tv mini series') AND mii.info_type_id IN (SELECT id FROM info_type WHERE info LIKE '%0..11202%' OR info LIKE '.0..002212') GROUP BY kt.kind;
SELECT COUNT(DISTINCT t.id) AS number_of_movies, AVG(t.production_year) AS average_production_year, SUM(CASE WHEN at.episode_of_id IS NOT NULL THEN 1 ELSE 0 END) AS number_of_episodes, it.info AS info_type_description, COUNT(DISTINCT an.person_id) AS number_of_actors, COUNT(DISTINCT at.movie_id) AS number_of_aka_titles FROM title AS t LEFT JOIN aka_title AS at ON t.id = at.movie_id LEFT JOIN movie_info_idx AS mi_idx ON t.id = mi_idx.movie_id LEFT JOIN info_type AS it ON mi_idx.info_type_id = it.id LEFT JOIN aka_name AS an ON an.id = mi_idx.movie_id WHERE t.production_year BETWEEN 1990 AND 2020 AND (mi_idx.info_type_id IN (100, 101, 99) OR mi_idx.info IS NOT NULL) AND (at.episode_of_id IN (24960, 8508, 3016, 7633) OR at.episode_of_id IS NULL) AND an.surname_pcode IN ('T653', 'E164', 'H56', 'A526') GROUP BY it.info;
SELECT it.info AS info_type, COUNT(DISTINCT mk.movie_id) AS total_movies_with_keywords, COUNT(DISTINCT cc.movie_id) AS total_movies_with_complete_cast, AVG(cn.imdb_id) AS average_imdb_id, SUM(CASE WHEN cn.country_code = 'US' THEN 1 ELSE 0 END) AS total_us_companies FROM movie_keyword AS mk INNER JOIN complete_cast AS cc ON mk.movie_id = cc.movie_id INNER JOIN company_name AS cn ON cn.imdb_id = mk.movie_id INNER JOIN info_type AS it ON it.id = cc.subject_id WHERE mk.id IN (3843, 4798) AND mk.movie_id IN (8317, 10013, 9914, 7373) AND cn.md5sum IN ( '8d978787b0ec287764f214189bd27ccc', 'cd11f002bfac4110767acd038dad525d', 'f528d5021e84ca97756808ca01ec4605', '885492194dc62a66d0fb18ca950f6163', 'c2c967c278a15530e9f0d846e4f11a14' ) AND it.info IN ('LD analog left', 'quotes', 'admissions') GROUP BY it.info;
SELECT COUNT(DISTINCT ci.person_id) AS total_actors, AVG(ci.nr_order) AS average_cast_position, SUM(CASE WHEN lt.link LIKE '%producer%' THEN 1 ELSE 0 END) AS total_producers_linked, COUNT(DISTINCT mk.keyword_id) AS total_unique_keywords, COUNT(DISTINCT mc.company_id) AS total_companies_involved FROM cast_info ci JOIN movie_companies mc ON ci.movie_id = mc.movie_id JOIN movie_keyword mk ON ci.movie_id = mk.movie_id JOIN link_type lt ON mc.company_type_id = lt.id WHERE ci.person_role_id IS NOT NULL AND mc.note IS NULL AND ci.movie_id IN (SELECT movie_id FROM movie_companies WHERE id = '3813') GROUP BY ci.movie_id;
SELECT kt.kind AS movie_type, MIN(at.title) AS example_movie, COUNT(DISTINCT mk.movie_id) AS total_movies_with_keywords, AVG(at.production_year) AS average_production_year, SUM(CASE WHEN at.note LIKE '%(imdb display title)%' THEN 1 ELSE 0 END) AS imdb_display_title_count FROM aka_title at JOIN kind_type kt ON at.kind_id = kt.id JOIN movie_keyword mk ON at.movie_id = mk.movie_id JOIN movie_info mi ON at.movie_id = mi.movie_id WHERE at.production_year BETWEEN 1990 AND 2020 AND at.note LIKE '%(imdb display title)%' AND mi.movie_id IN ('931220', '926777', '925133') GROUP BY kt.kind HAVING COUNT(DISTINCT at.movie_id) > 10 ORDER BY total_movies_with_keywords DESC;
SELECT MIN(t.title) AS movie_title, MIN(at.title) AS alternative_title, AVG(ci.nr_order) AS average_cast_order, COUNT(DISTINCT t.id) AS number_of_movies, COUNT(DISTINCT ci.person_id) AS number_of_unique_actors, SUM(CASE WHEN t.production_year BETWEEN 1970 AND 1980 THEN 1 ELSE 0 END) AS movies_produced_1970_to_1980, SUM(CASE WHEN t.production_year BETWEEN 1981 AND 1990 THEN 1 ELSE 0 END) AS movies_produced_1981_to_1990, SUM(CASE WHEN t.production_year BETWEEN 1991 AND 2000 THEN 1 ELSE 0 END) AS movies_produced_1991_to_2000 FROM title AS t INNER JOIN aka_title AS at ON t.id = at.movie_id AND at.kind_id IN (1, 3) INNER JOIN cast_info AS ci ON t.id = ci.movie_id WHERE t.production_year IN (1985, 1975, 1950, 1972) GROUP BY t.kind_id HAVING COUNT(DISTINCT ci.person_id) > 10 ORDER BY number_of_movies DESC, average_cast_order;
SELECT mc.company_id, ct.kind AS company_type, AVG(t.production_year) AS avg_production_year, COUNT(t.id) AS movie_count, STRING_AGG(k.keyword, ', ') AS common_keywords, AVG(LENGTH(t.title)) AS avg_title_length FROM movie_companies AS mc JOIN kind_type AS ct ON mc.company_type_id = ct.id JOIN title AS t ON mc.movie_id = t.id JOIN movie_info AS mi ON t.id = mi.movie_id JOIN info_type AS it ON mi.info_type_id = it.id LEFT JOIN keyword AS k ON mi.id = k.id WHERE mc.company_id IN (995, 1074, 719, 977, 232, 371) AND mc.company_type_id = 1 AND k.keyword IN ('yellow-dress', 'drug-enforcement', 'larry-holmes', 'borough-name-in-title', 'showbiz', 'flower-club') AND it.info = 'release dates' GROUP BY mc.company_id, ct.kind ORDER BY avg_production_year DESC, movie_count DESC;
SELECT t.kind_id, t.production_year, COUNT(DISTINCT t.id) AS number_of_titles, COUNT(DISTINCT n.id) AS number_of_unique_persons, AVG(CAST(mi.info AS FLOAT)) AS average_movie_length, SUM(CASE WHEN at.episode_nr IS NOT NULL THEN 1 ELSE 0 END) AS number_of_episodes FROM title t LEFT JOIN aka_title at ON t.id = at.movie_id LEFT JOIN movie_info_idx mi ON t.id = mi.movie_id AND mi.info_type_id = 100 LEFT JOIN complete_cast cc ON t.id = cc.movie_id LEFT JOIN name n ON cc.subject_id = n.id WHERE t.production_year BETWEEN 2000 AND 2020 AND t.kind_id IN (1, 2, 3) GROUP BY t.kind_id, t.production_year ORDER BY t.kind_id, t.production_year;
SELECT kt.kind AS movie_type, AVG(t.production_year) AS average_production_year, COUNT(DISTINCT t.id) AS total_movies, COUNT(DISTINCT n.id) AS total_actors, SUM(CASE WHEN cn.country_code IS NOT NULL THEN 1 ELSE 0 END) AS total_companies_with_country_code, MAX(cc.subject_id) AS max_subject_id_in_cast, MIN(cc.status_id) AS min_status_id_in_cast FROM aka_title AS t LEFT JOIN kind_type AS kt ON t.kind_id = kt.id LEFT JOIN complete_cast AS cc ON t.movie_id = cc.movie_id LEFT JOIN company_name AS cn ON t.movie_id = cn.imdb_id LEFT JOIN name AS n ON t.movie_id = n.imdb_id GROUP BY kt.kind ORDER BY total_movies DESC;
SELECT COUNT(DISTINCT ci.movie_id) AS total_movies, AVG(ci.nr_order) AS average_cast_order, SUM(CASE WHEN ci.person_role_id IN (56, 1326) THEN 1 ELSE 0 END) AS count_special_roles, COUNT(DISTINCT cn.id) AS total_unique_characters, COUNT(DISTINCT k.id) AS total_unique_keywords, MAX(mi.info) AS longest_movie_info FROM cast_info ci JOIN char_name cn ON ci.person_id = cn.id JOIN movie_info mi ON ci.movie_id = mi.movie_id JOIN keyword k ON k.phonetic_code = 'O16' WHERE mi.info <> 'None' AND mi.info LIKE '%Czech%' GROUP BY ci.movie_id;
SELECT rt.ROLE, AVG(miidx.info::NUMERIC) AS average_rating, COUNT(DISTINCT cn.id) AS number_of_companies, COUNT(DISTINCT cl.movie_id) AS number_of_movies_linked, COUNT(DISTINCT mk.keyword_id) AS number_of_unique_keywords FROM role_type rt LEFT JOIN char_name cn ON cn.surname_pcode = rt.id::CHARACTER VARYING LEFT JOIN movie_link cl ON cl.link_type_id = rt.id LEFT JOIN movie_keyword mk ON mk.movie_id = cl.movie_id LEFT JOIN movie_info_idx miidx ON miidx.movie_id = cl.movie_id WHERE rt.ROLE IN ('production designer', 'guest', 'editor', 'cinematographer') AND cn.name_pcode_nf IN ('T3452', 'A423', 'D653', 'A5426', 'H5161', 'B3216') AND miidx.info_type_id = 101 /* Assuming 101 is the info_type_id for 'rating' */ GROUP BY rt.ROLE;
SELECT ct.kind AS cast_type, AVG(mk.keyword_id) AS average_keyword_id, COUNT(DISTINCT at.id) AS total_alternate_titles, COUNT(DISTINCT cn.id) AS total_companies, SUM(CASE WHEN ml.linked_movie_id = 1910055 THEN 1 ELSE 0 END) AS count_linked_to_movie_1910055, COUNT(DISTINCT ml.movie_id) FILTER (WHERE ml.link_type_id BETWEEN 2 AND 3) AS count_movie_links_type_2_3, COUNT(DISTINCT cn.id) FILTER (WHERE cn.country_code IN ('[lb]', '[cn]', '[na]', '[in]', '[kr]', '[xyu]')) AS count_movies_non_english_speaking_countries FROM comp_cast_type AS ct LEFT JOIN aka_title AS at ON ct.id = at.kind_id LEFT JOIN movie_keyword AS mk ON at.movie_id = mk.movie_id LEFT JOIN company_name AS cn ON cn.name_pcode_nf = 'A6453' LEFT JOIN movie_link AS ml ON at.movie_id = ml.movie_id WHERE ct.id IN (2, 3) AND mk.movie_id IN (18826, 18728, 18726, 12088, 18819, 15536) AND mk.id IN (886, 4673, 4280, 2228, 1485, 4805) GROUP BY ct.kind;
