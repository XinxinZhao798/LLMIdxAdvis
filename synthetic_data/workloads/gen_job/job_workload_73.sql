SELECT ct.kind AS company_type, COUNT(*) AS total_movies, AVG(ak.production_year) AS average_production_year, SUM(CASE WHEN ci.role_id = 1 THEN 1 ELSE 0 END) AS total_actor_roles, SUM(CASE WHEN ci.person_role_id IN (444, 927, 278, 35) THEN 1 ELSE 0 END) AS specific_person_roles FROM company_name AS cn JOIN company_type AS ct ON cn.id = ct.id JOIN complete_cast AS cc ON cn.id = cc.movie_id JOIN aka_title AS ak ON cc.movie_id = ak.movie_id JOIN cast_info AS ci ON ak.movie_id = ci.movie_id WHERE cn.country_code = 'US' GROUP BY ct.kind HAVING COUNT(*) > 10 ORDER BY total_movies DESC;
SELECT lt.LINK AS link_type, COUNT(DISTINCT ml.movie_id) AS number_of_movies, AVG(t.production_year) AS average_production_year, SUM(CASE WHEN n.gender = 'f' THEN 1 ELSE 0 END) AS female_cast_count, SUM(CASE WHEN n.gender = 'm' THEN 1 ELSE 0 END) AS male_cast_count FROM movie_link AS ml JOIN link_type AS lt ON ml.link_type_id = lt.id JOIN title AS t ON ml.movie_id = t.id JOIN movie_info_idx AS miidx ON miidx.movie_id = t.id JOIN info_type AS it ON miidx.info_type_id = it.id JOIN name AS n ON n.id = miidx.movie_id WHERE lt.id IN (13, 14, 8, 18, 4) AND ml.movie_id IN (10590, 11494) AND n.name_pcode_cf IN ('A4534', 'A31') GROUP BY lt.LINK ORDER BY number_of_movies DESC, average_production_year;
SELECT AVG(CAST(mi_idx.info AS numeric)) AS avg_rating, COUNT(DISTINCT t.id) AS total_movies, SUM(CASE WHEN lt.link = 'spoofed in' THEN 1 ELSE 0 END) AS total_spoofs, SUM(CASE WHEN lt.link = 'remake of' THEN 1 ELSE 0 END) AS total_remakes, cn.name AS company_name, cn.country_code, it.info AS info_type, EXTRACT(YEAR FROM NOW()) - AVG(t.production_year) AS avg_years_since_release FROM movie_info_idx AS mi_idx JOIN title AS t ON t.id = mi_idx.movie_id LEFT JOIN company_name AS cn ON cn.imdb_id = t.id JOIN movie_info_idx AS mi_idx_link ON mi_idx_link.movie_id = t.id JOIN link_type AS lt ON mi_idx_link.info_type_id = lt.id JOIN info_type AS it ON mi_idx.info_type_id = it.id WHERE it.info = 'rating' AND mi_idx.info > '5.0' AND t.production_year BETWEEN 2000 AND EXTRACT(YEAR FROM NOW()) AND (lt.link = 'spoofed in' OR lt.link = 'remake of') GROUP BY cn.name, cn.country_code, it.info ORDER BY avg_rating DESC, total_movies DESC;
SELECT t.title, kt.kind, COUNT(DISTINCT cn.id) AS total_characters, COUNT(DISTINCT comp_n.id) AS total_companies, AVG(t.production_year) AS average_production_year, MAX(it.info) AS most_frequent_info FROM title t JOIN kind_type kt ON t.kind_id = kt.id LEFT JOIN movie_info_idx mii ON t.id = mii.movie_id LEFT JOIN info_type it ON mii.info_type_id = it.id LEFT JOIN char_name cn ON t.id = cn.id LEFT JOIN company_name comp_n ON t.id = comp_n.id GROUP BY t.title, kt.kind ORDER BY total_characters DESC, total_companies DESC;
SELECT cc.kind AS cast_type, COUNT(DISTINCT ci.movie_id) AS number_of_movies, AVG(ci.nr_order) AS average_cast_order, COUNT(DISTINCT cn.id) AS number_of_companies, lt.link AS link_type, COUNT(DISTINCT ml.linked_movie_id) AS number_of_linked_movies FROM cast_info ci JOIN comp_cast_type cc ON ci.role_id = cc.id JOIN complete_cast c ON ci.movie_id = c.movie_id JOIN company_name cn ON cn.country_code LIKE 'US%' JOIN movie_link ml ON ci.movie_id = ml.movie_id JOIN link_type lt ON ml.link_type_id = lt.id WHERE cc.kind IN ('complete+verified', 'complete', 'cast') AND lt.link IN ('spoofs', 'spoofed in', 'follows', 'edited into', 'referenced in') GROUP BY cc.kind, lt.link ORDER BY number_of_movies DESC, average_cast_order ASC;
SELECT ct.kind AS company_kind, COUNT(DISTINCT alias_data.person_id) AS unique_persons_with_aliases, AVG(alias_data.alias_count) AS avg_aliases_per_person, COUNT(DISTINCT cc.movie_id) AS movies_with_complete_cast FROM company_type AS ct LEFT JOIN (SELECT mc.company_type_id, ci.person_id FROM movie_companies AS mc JOIN cast_info AS ci ON mc.movie_id = ci.movie_id WHERE ci.role_id IN ('7', '6')) AS movie_casts ON ct.id = movie_casts.company_type_id LEFT JOIN (SELECT person_id, COUNT(*) AS alias_count FROM aka_name GROUP BY person_id) AS alias_data ON movie_casts.person_id = alias_data.person_id LEFT JOIN complete_cast AS cc ON movie_casts.person_id = cc.subject_id AND cc.status_id IN ('4', '3') GROUP BY ct.kind;
SELECT COUNT(DISTINCT ci.id) AS total_cast_members, AVG(ci.nr_order) AS average_cast_order, COUNT(DISTINCT mk.id) AS total_movie_keywords, MAX(t.production_year) AS latest_production_year, MIN(t.production_year) AS earliest_production_year, AVG(t.production_year) AS average_production_year, COUNT(DISTINCT mi.id) AS total_movie_info_records, ct.kind AS company_kind, COUNT(DISTINCT n.id) AS total_people FROM cast_info ci JOIN movie_keyword mk ON ci.movie_id = mk.movie_id JOIN title t ON ci.movie_id = t.id JOIN movie_info mi ON mi.movie_id = t.id JOIN company_type ct ON ct.id = mi.info_type_id JOIN name n ON n.id = ci.person_id WHERE ci.role_id = 1 AND ct.kind IN ('special effects companies', 'miscellaneous companies', 'production companies', 'distributors') AND ci.nr_order IN (36, 47, 23, 39) AND mk.movie_id IN (14906, 12662, 17516, 17625) GROUP BY ct.kind ORDER BY total_movie_keywords DESC;
SELECT kt.kind AS movie_type, COUNT(DISTINCT t.id) AS number_of_movies, AVG(t.production_year) AS average_production_year, COUNT(DISTINCT mc.company_id) AS number_of_production_companies, COUNT(DISTINCT pi.person_id) AS number_of_individual_contributors, SUM(CASE WHEN t.md5sum IN ('1f1ce7379075bf949e40cb57616b3f4d', '0d05192e412a817cc87628ae56d58d5b') THEN 1 ELSE 0 END) AS count_of_specific_md5sum FROM title t JOIN kind_type kt ON t.kind_id = kt.id JOIN movie_companies mc ON t.id = mc.movie_id JOIN company_type ct ON mc.company_type_id = ct.id JOIN person_info pi ON pi.person_id = t.id WHERE ct.kind = 'production' AND t.production_year BETWEEN 1990 AND 2020 GROUP BY kt.kind ORDER BY number_of_movies DESC;
SELECT ct.kind AS company_type, AVG(ak.production_year) AS average_production_year, COUNT(DISTINCT ak.movie_id) AS number_of_movies, COUNT(DISTINCT cc.subject_id) AS number_of_subjects, SUM(CASE WHEN n.gender = 'm' THEN 1 ELSE 0 END) AS male_actor_count, SUM(CASE WHEN n.gender = 'f' THEN 1 ELSE 0 END) AS female_actor_count, COUNT(DISTINCT k.id) AS number_of_unique_keywords FROM aka_title ak JOIN complete_cast cc ON ak.movie_id = cc.movie_id JOIN company_type ct ON ak.kind_id = ct.id JOIN keyword k ON ak.id = k.id JOIN name n ON ak.id = n.id WHERE ak.production_year BETWEEN 2000 AND 2010 AND n.md5sum IN ('660ea0ef9bdefafcda003d019848f703', '6d0c221bb93b310ab2904bdd75c8a442', 'a24f9431335b1461f14ac1933840f6cf', 'afaebb48a6577994f1924c5910d75467', 'e755250c050a467046983653e209cf90', '3978c1bc47a6deab5ab0956b3cb08ada') GROUP BY ct.kind;
SELECT nt.info AS movie_genre, COUNT(DISTINCT cn.id) AS num_of_actors, AVG((n.gender = 'M')::int) AS avg_male_actors, AVG((n.gender = 'F')::int) AS avg_female_actors, SUM(CASE WHEN cn.id IN ('75924', '37156', '79891', '61423', '79360') THEN 1 ELSE 0 END) AS special_char_count, cname.name AS frequent_production_company, MAX(mi_idx.info) AS longest_movie_description FROM char_name cn JOIN name n ON cn.id = n.id JOIN movie_info_idx mi_idx ON n.id = mi_idx.movie_id JOIN info_type nt ON mi_idx.info_type_id = nt.id JOIN movie_companies mc ON mi_idx.movie_id = mc.movie_id JOIN company_name cname ON mc.company_id = cname.id WHERE n.md5sum IN ('5867f236efd2a49e525e28170e53884f', 'e30d31437d0cc24a549ebe11e068d91c', '103b12a2a1f067552d1582f217894732', '937aa89fd20c81ec429381d29296632e', 'b19e28f6480e3653f20f36528b67ddfd', 'ee97cefd84759ed4ec46f94d2e8962ed') AND cname.name IN ('Jamtown Films', 'Ovie Entertainment', 'Canibal Friends', 'Rocket Sheep Boom', 'Yarnmaker', 'Toko-Tokuma') AND nt.info IN ('LD dialogue intellegibility', 'book', 'tech info') GROUP BY nt.info, cname.name ORDER BY num_of_actors DESC, avg_male_actors DESC;
SELECT cn.name AS company_name, COUNT(DISTINCT mk.movie_id) AS number_of_movies_with_keywords, COUNT(DISTINCT ml.movie_id) AS number_of_linked_movies, COUNT(DISTINCT ml.linked_movie_id) AS number_of_movies_linked_to, AVG(cn.imdb_id) AS average_imdb_id FROM company_name cn LEFT JOIN movie_companies mc ON cn.id = mc.company_id LEFT JOIN movie_keyword mk ON mc.movie_id = mk.movie_id LEFT JOIN movie_link ml ON mc.movie_id = ml.movie_id OR mc.movie_id = ml.linked_movie_id WHERE cn.country_code NOT IN ('[pl]') AND cn.name_pcode_sf IN ('V6251', 'D1253', 'A4562', 'D5351', 'T5626') AND (ml.link_type_id IN (5, 3, 13) OR ml.link_type_id IS NULL) GROUP BY cn.name ORDER BY number_of_movies_with_keywords DESC, number_of_linked_movies DESC, number_of_movies_linked_to DESC, average_imdb_id DESC LIMIT 10;
SELECT it.info AS cast_completeness, COUNT(DISTINCT cc.movie_id) AS number_of_movies, AVG(ci.person_count) AS average_roles_per_person FROM (SELECT movie_id, COUNT(DISTINCT person_id) AS person_count FROM cast_info GROUP BY movie_id) ci JOIN complete_cast cc ON ci.movie_id = cc.movie_id JOIN info_type it ON cc.status_id = it.id GROUP BY it.info;
SELECT ct.kind AS company_type, AVG(t.production_year) AS average_production_year, COUNT(DISTINCT t.id) AS number_of_titles, SUM(CASE WHEN cn.country_code = '[us]' THEN 1 ELSE 0 END) AS number_of_us_companies, MAX(pi.info) AS latest_info_entry FROM title AS t JOIN company_name AS cn ON t.id = cn.imdb_id JOIN company_type AS ct ON cn.id = ct.id LEFT JOIN person_info AS pi ON pi.info LIKE '%USA%' WHERE t.production_year BETWEEN 1980 AND 1990 AND cn.country_code IN ('[us]', '[ca]') GROUP BY ct.kind ORDER BY number_of_titles DESC;
