SELECT CN.name AS company_name, COUNT(DISTINCT AN.id) AS total_aliases, AVG(AT.production_year) AS average_production_year, SUM(CASE WHEN N.gender = 'M' THEN 1 ELSE 0 END) AS male_actors_count, SUM(CASE WHEN N.gender = 'F' THEN 1 ELSE 0 END) AS female_actors_count FROM company_name CN JOIN aka_title AT ON CN.id = AT.movie_id JOIN aka_name AN ON AN.person_id = AT.movie_id JOIN name N ON N.id = AN.person_id WHERE CN.country_code = 'US' AND AT.production_year >= 2000 AND N.gender IN ('M', 'F') GROUP BY CN.name;
SELECT kt.kind AS movie_genre, AVG(mi_idx.note::int) AS average_rating, COUNT(DISTINCT k.id) AS unique_keywords, SUM(CASE WHEN cct.kind = 'complete' THEN 1 ELSE 0 END) AS complete_cast_movies, SUM(CASE WHEN cct.kind = 'complete+verified' THEN 1 ELSE 0 END) AS verified_cast_movies FROM movie_info_idx mi_idx JOIN movie_link ml ON mi_idx.movie_id = ml.movie_id JOIN keyword k ON ml.link_type_id = k.id JOIN kind_type kt ON mi_idx.info_type_id = kt.id JOIN complete_cast cc ON mi_idx.movie_id = cc.movie_id JOIN comp_cast_type cct ON cc.status_id = cct.id WHERE kt.kind IN ('drama', 'comedy', 'action') AND mi_idx.info LIKE '%rating%' AND k.keyword IN ('epic', 'cult', 'thriller', 'romance') GROUP BY kt.kind ORDER BY average_rating DESC;
SELECT cct.kind AS movie_kind, AVG(at.production_year) AS average_production_year, COUNT(at.id) AS number_of_titles, MAX(at.production_year) AS latest_production_year, MIN(at.production_year) AS earliest_production_year FROM aka_title at JOIN comp_cast_type cct ON at.kind_id = cct.id GROUP BY cct.kind ORDER BY average_production_year DESC;
SELECT COUNT(DISTINCT t.id) AS total_movies, AVG(t.production_year) AS average_production_year, COUNT(DISTINCT a.id) AS total_aka_titles, COUNT(DISTINCT k.id) AS total_keywords, COUNT(DISTINCT n.id) AS total_names, COUNT(DISTINCT c.id) AS total_complete_cast_entries FROM title t LEFT JOIN aka_title a ON t.id = a.movie_id LEFT JOIN movie_link ml ON t.id = ml.movie_id LEFT JOIN keyword k ON k.phonetic_code = a.phonetic_code LEFT JOIN name n ON n.gender = 'm' AND (n.imdb_index = 'XVII' OR n.imdb_index = 'XXII') LEFT JOIN complete_cast c ON t.id = c.movie_id WHERE t.kind_id IN (SELECT id FROM role_type WHERE role IN ('miscellaneous crew', 'director')) AND (k.keyword IN ('fbi', 'fencing-lesson', 'repairing-a-tv-set', 'leaving-home') OR k.phonetic_code IN ('L2153', 'G56', 'C6326', 'A3436', 'P212', 'W262')) AND ml.link_type_id IN (SELECT id FROM link_type WHERE link IN ('references', 'referenced in')) GROUP BY t.kind_id;
SELECT AVG(a.production_year) AS average_production_year, COUNT(DISTINCT l.id) AS total_link_types, COUNT(DISTINCT a.id) AS total_aka_titles, SUM(CASE WHEN a.episode_nr = 23 THEN 1 ELSE 0 END) AS count_episode_23, SUM(CASE WHEN a.episode_nr = 2 THEN 1 ELSE 0 END) AS count_episode_2, SUM(CASE WHEN a.episode_nr = 198 THEN 1 ELSE 0 END) AS count_episode_198 FROM aka_title AS a JOIN comp_cast_type AS c ON a.kind_id = c.id JOIN link_type AS l ON a.id = l.id WHERE a.production_year IS NOT NULL AND a.md5sum IN ('fb468fe5a2dd6cbadb547cbfcc31fe6e', 'aebc712f90712d70c4098b641cecc92c', 'f13da07aa2abf77454bb4a2209a5fc0d') GROUP BY a.kind_id;
SELECT COUNT(DISTINCT at.id) AS total_alternate_titles, COUNT(DISTINCT ci.id) AS total_cast_members, AVG(at.production_year) AS average_production_year, SUM(mc.company_id) AS total_companies_involved, COUNT(DISTINCT cc.id) AS total_complete_casts, STRING_AGG(DISTINCT lt.LINK, '; ') AS link_types_used FROM aka_title AS at JOIN cast_info AS ci ON at.movie_id = ci.movie_id JOIN movie_companies AS mc ON at.movie_id = mc.movie_id JOIN complete_cast AS cc ON at.movie_id = cc.movie_id JOIN link_type AS lt ON cc.status_id = lt.id WHERE at.production_year > 2000 AND ci.note IS NOT NULL AND cc.id IN ('2731', '2678', '7', '3665') AND at.season_nr IN (8, 4, 11, 22) AND at.md5sum IN ('ae1ec4b6524d40f203cb722b6e74c9d6', '51978b45ff1151ec3cc873180401b93c') GROUP BY at.kind_id ORDER BY total_alternate_titles DESC, average_production_year;
SELECT n.name AS actor_name, COUNT(DISTINCT cn.id) AS character_count, AVG(mk.keyword_id) AS average_keyword_id, SUM(CASE WHEN ml.link_type_id = 1 THEN 1 ELSE 0 END) AS direct_movie_links, COUNT(DISTINCT ml.movie_id) AS linked_movies_count FROM name n JOIN aka_name an ON n.id = an.person_id JOIN char_name cn ON an.id = cn.imdb_id JOIN movie_keyword mk ON cn.id = mk.movie_id JOIN movie_link ml ON mk.movie_id = ml.movie_id WHERE n.gender = 'm' GROUP BY n.name;
SELECT kt.kind, COUNT(DISTINCT t.id) AS total_titles, AVG(t.production_year) AS avg_production_year, COUNT(DISTINCT n.id) AS total_unique_persons, SUM(CASE WHEN t.kind_id = 6 THEN 1 ELSE 0 END) AS total_episodes, SUM(CASE WHEN t.kind_id = 2 THEN 1 ELSE 0 END) AS total_video_games FROM title t JOIN kind_type kt ON t.kind_id = kt.id LEFT JOIN aka_name an ON an.person_id = t.id LEFT JOIN char_name cn ON cn.id = an.person_id LEFT JOIN name n ON n.id = an.person_id LEFT JOIN keyword k ON k.id IN (7895, 1560, 4900, 639, 4708, 2246) WHERE kt.kind IN ('episode', 'video game') GROUP BY kt.kind ORDER BY total_titles DESC;
