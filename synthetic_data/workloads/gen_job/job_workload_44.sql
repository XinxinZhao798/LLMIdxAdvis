SELECT avg(CAST(mi_idx.info AS FLOAT)) AS average_rating, count(DISTINCT mk.keyword_id) AS number_of_keywords, count(DISTINCT an.id) AS number_of_aka_names FROM movie_info_idx AS mi_idx JOIN movie_keyword AS mk ON mi_idx.movie_id = mk.movie_id JOIN aka_name AS an ON an.person_id = mk.movie_id WHERE mi_idx.info_type_id IN (100, 101, 99) AND mk.movie_id IN (18864, 8952, 12152) AND an.surname_pcode IN ('M635', 'P14', 'A15', 'A263', 'D1', 'A261') GROUP BY mi_idx.movie_id;
SELECT kt.kind AS movie_kind, AVG(CASE WHEN rt.ROLE = 'director' THEN 1 ELSE 0 END) AS avg_director_presence, COUNT(DISTINCT ml.movie_id) AS num_movies_linked, MAX(t.production_year) AS latest_production_year, MIN(t.production_year) AS earliest_production_year, SUM(CASE WHEN mi.info_type_id = 2 AND mi.info = 'color' THEN 1 ELSE 0 END) AS total_color_movies, COUNT(DISTINCT t.id) AS total_movies FROM title t LEFT JOIN kind_type kt ON t.kind_id = kt.id LEFT JOIN movie_link ml ON t.id = ml.movie_id LEFT JOIN movie_info mi ON t.id = mi.movie_id LEFT JOIN role_type rt ON mi.info_type_id = rt.id WHERE t.production_year BETWEEN 1990 AND 2020 AND kt.kind IN ('movie', 'tv series', 'video game') AND (ml.link_type_id IN (5, 12, 16) OR ml.link_type_id IS NULL) AND (ml.linked_movie_id IN (1639371, 2307098) OR ml.linked_movie_id IS NULL) AND rt.ROLE IN ('director', 'actor', 'producer') GROUP BY kt.kind ORDER BY total_movies DESC;
SELECT rt.role, COUNT(DISTINCT mc.movie_id) AS number_of_movies, COUNT(DISTINCT mc.company_id) AS number_of_companies, AVG(movie_count_per_company.movie_count) AS average_movies_per_company FROM movie_companies mc JOIN (SELECT company_id, COUNT(movie_id) AS movie_count FROM movie_companies GROUP BY company_id) AS movie_count_per_company ON mc.company_id = movie_count_per_company.company_id JOIN role_type rt ON mc.company_type_id = rt.id GROUP BY rt.role ORDER BY number_of_movies DESC;
SELECT rt.ROLE as role_type, COUNT(DISTINCT t.id) as total_titles, COALESCE(SUM(t.episode_nr), 0) as total_episodes, ROUND(AVG(t.production_year), 2) as average_production_year FROM title t JOIN role_type rt ON t.kind_id = rt.id GROUP BY rt.ROLE ORDER BY total_titles DESC;
SELECT t.production_year, COUNT(DISTINCT mi.movie_id) AS total_movies, AVG(ci.nr_order) AS average_cast_order, SUM(CASE WHEN ci.person_role_id = 524 THEN 1 ELSE 0 END) AS count_role_524, SUM(CASE WHEN ci.person_role_id = 235 THEN 1 ELSE 0 END) AS count_role_235, SUM(CASE WHEN ci.person_role_id = 1257 THEN 1 ELSE 0 END) AS count_role_1257 FROM title AS t JOIN cast_info AS ci ON t.id = ci.movie_id JOIN movie_info_idx AS mi ON t.id = mi.movie_id WHERE t.production_year >= 2000 AND t.production_year <= 2010 GROUP BY t.production_year ORDER BY t.production_year;
SELECT AVG(akat.production_year) AS average_production_year, COUNT(DISTINCT akat.movie_id) AS number_of_movies, cct.kind, k.keyword, SUM(CASE WHEN akat.season_nr IS NOT NULL THEN 1 ELSE 0 END) AS total_seasons, SUM(CASE WHEN akat.episode_nr IS NOT NULL THEN 1 ELSE 0 END) AS total_episodes FROM aka_title akat JOIN comp_cast_type cct ON akat.kind_id = cct.id JOIN keyword k ON k.id IN (58, 8642, 3881, 5552, 5846) WHERE akat.production_year > 1990 AND cct.kind IN ('complete+verified', 'cast', 'crew', 'complete') GROUP BY cct.kind, k.keyword ORDER BY average_production_year DESC, number_of_movies DESC;
SELECT kt.kind, COUNT(DISTINCT cn.id) AS num_companies, COUNT(DISTINCT mi.movie_id) AS num_movies, AVG(CAST(mi.info AS NUMERIC)) FILTER (WHERE it1.info = 'rating') AS avg_rating, SUM(CAST(mi.info AS NUMERIC)) FILTER (WHERE it1.info = 'budget') AS total_budget FROM kind_type AS kt JOIN movie_info AS mi ON mi.info_type_id = kt.id JOIN company_name AS cn ON cn.imdb_id = mi.movie_id JOIN movie_info AS it1 ON mi.movie_id = it1.movie_id AND it1.info_type_id = kt.id WHERE kt.id IN ('4', '5', '1') AND kt.kind IN ('episode', 'tv series', 'video game') AND mi.info_type_id IN (SELECT id FROM info_type WHERE info IN ('rating', 'budget')) GROUP BY kt.kind;
SELECT AVG(CAST(mi_idx.info AS NUMERIC)) AS average_rating, COUNT(DISTINCT t.id) AS number_of_movies, SUM(CASE WHEN mi.info = 'Color' THEN 1 ELSE 0 END) AS number_of_color_movies, SUM(CASE WHEN mi.info = 'Black and White' THEN 1 ELSE 0 END) AS number_of_black_and_white_movies, MIN(t.production_year) AS earliest_production_year, MAX(t.production_year) AS latest_production_year FROM movie_info_idx AS mi_idx JOIN movie_info AS mi ON mi_idx.movie_id = mi.movie_id AND mi_idx.info_type_id = mi.info_type_id JOIN title AS t ON t.id = mi.movie_id JOIN comp_cast_type AS cct ON t.kind_id = cct.id WHERE mi_idx.info_type_id IN ('100', '101') AND mi.info_type_id IN ('100', '101') AND cct.kind = 'complete+verified' GROUP BY cct.kind;
