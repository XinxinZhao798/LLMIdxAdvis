SELECT COUNT(DISTINCT ci.person_id) AS total_actors, AVG(ci.nr_order) AS average_roles_per_movie, COUNT(DISTINCT ci.movie_id) AS total_movies, COUNT(DISTINCT k.id) AS total_keywords FROM cast_info ci JOIN keyword k ON k.keyword = 'christ-the-redeemer-rio-de-janeiro' JOIN link_type lt ON lt.id = ci.role_id WHERE lt.link IN ('edited into', 'features', 'follows', 'similar to', 'edited from') GROUP BY ci.movie_id;
SELECT mc.company_type_id, COUNT(DISTINCT mc.movie_id) AS num_movies, AVG(at.production_year) AS avg_production_year, COUNT(DISTINCT lt.id) AS num_link_types FROM movie_companies AS mc JOIN aka_title AS at ON mc.movie_id = at.movie_id JOIN link_type AS lt ON at.id = lt.id WHERE mc.company_type_id = 1 AND lt.link IN ('alternate language version of', 'featured in', 'edited into', 'edited from', 'spoofs', 'referenced in') GROUP BY mc.company_type_id;
SELECT COUNT(DISTINCT at.movie_id) AS total_movies, AVG(at.production_year) AS average_production_year, COUNT(DISTINCT kt.kind) AS distinct_kind_types FROM aka_title at INNER JOIN movie_info_idx mi ON at.movie_id = mi.movie_id INNER JOIN kind_type kt ON at.kind_id = kt.id INNER JOIN link_type lt ON mi.info = lt.LINK WHERE kt.kind IN ('tv movie', 'tv series') AND lt.link IN ('follows', 'spoofs') AND at.imdb_index = 'II' GROUP BY kt.kind;
SELECT ct.kind AS company_kind, COUNT(DISTINCT t.id) AS number_of_movies, AVG(t.production_year) AS average_production_year, COUNT(DISTINCT cc.subject_id) AS number_of_subjects, SUM(CASE WHEN t.kind_id = 1 THEN 1 ELSE 0 END) AS number_of_feature_films, SUM(CASE WHEN t.kind_id = 2 THEN 1 ELSE 0 END) AS number_of_tv_shows, SUM(CASE WHEN t.kind_id = 4 THEN 1 ELSE 0 END) AS number_of_documentaries FROM title t JOIN complete_cast cc ON t.id = cc.movie_id JOIN company_type ct ON t.kind_id = ct.id GROUP BY ct.kind ORDER BY number_of_movies DESC;
SELECT ct.kind AS company_kind, COUNT(DISTINCT ci.movie_id) AS total_movies, AVG(ci.nr_order) AS average_cast_order, SUM(CASE WHEN ci.note LIKE '%(as %' THEN 1 ELSE 0 END) AS total_alias_credits, COUNT(DISTINCT mc.company_id) AS total_companies_involved, COUNT(DISTINCT ci.person_id) AS unique_cast_members FROM cast_info ci JOIN movie_companies mc ON ci.movie_id = mc.movie_id JOIN company_type ct ON mc.company_type_id = ct.id WHERE ct.kind IN ('distributors', 'miscellaneous companies', 'special effects companies') AND ci.note IS NOT NULL GROUP BY ct.kind ORDER BY total_movies DESC;
SELECT AVG(ml_count.count) AS avg_movie_links, COUNT(DISTINCT an.person_id) AS distinct_person_count, SUM(CASE WHEN ml.link_type_id = '5' THEN 1 ELSE 0 END) AS total_sequel_links FROM movie_link AS ml JOIN (SELECT movie_id, COUNT(*) AS count FROM movie_link GROUP BY movie_id) AS ml_count ON ml.movie_id = ml_count.movie_id JOIN aka_name AS an ON ml.movie_id = an.person_id WHERE ml.link_type_id IN ('5', '11', '13', '17', '2', '1') GROUP BY ml.link_type_id;
SELECT AVG(title.production_year) AS average_production_year, COUNT(DISTINCT name.id) AS number_of_actors, COUNT(DISTINCT title.id) AS number_of_movies, SUM(CASE WHEN name.gender = 'M' THEN 1 ELSE 0 END) AS number_of_male_actors, SUM(CASE WHEN name.gender = 'F' THEN 1 ELSE 0 END) AS number_of_female_actors, MAX(title.production_year) AS latest_production_year, MIN(title.production_year) AS earliest_production_year FROM title JOIN aka_title ON title.id = aka_title.movie_id JOIN person_info ON aka_title.movie_id = person_info.person_id JOIN name ON person_info.person_id = name.id WHERE title.production_year BETWEEN 2000 AND 2020 AND name.name_pcode_nf IN ('N4532', 'H6341', 'M2164') GROUP BY title.kind_id HAVING COUNT(DISTINCT title.id) > 10 ORDER BY average_production_year DESC, number_of_movies DESC;
SELECT AVG(nc.name_count) AS average_cast_per_movie, SUM(mc.company_count) AS total_production_companies, COUNT(DISTINCT r.id) AS total_roles, COUNT(DISTINCT m.movie_id) AS total_movies FROM (SELECT c.movie_id, COUNT(*) AS name_count FROM complete_cast AS c WHERE c.status_id IN (3, 4) GROUP BY c.movie_id) AS nc JOIN (SELECT mc.movie_id, COUNT(*) AS company_count FROM movie_companies AS mc WHERE mc.company_type_id = (SELECT id FROM company_type WHERE kind = 'production') GROUP BY mc.movie_id) AS mc ON nc.movie_id = mc.movie_id JOIN movie_companies AS m ON m.movie_id = nc.movie_id JOIN role_type AS r ON r.id = m.company_type_id WHERE m.movie_id = '30202';
SELECT COUNT(DISTINCT t.id) AS total_movies, AVG(t.production_year) AS average_production_year, COUNT(DISTINCT k.id) AS total_keywords, COUNT(DISTINCT p.person_id) AS total_persons_involved, COUNT(DISTINCT c.company_id) AS total_companies_involved, SUM(CASE WHEN k.keyword = 'sherlock-holmes' THEN 1 ELSE 0 END) AS sherlock_holmes_keyword_count, MAX(t.production_year) AS latest_movie_year, MIN(t.production_year) AS oldest_movie_year FROM title AS t JOIN movie_companies AS c ON t.id = c.movie_id JOIN complete_cast AS cc ON t.id = cc.movie_id JOIN keyword AS k ON k.id = ANY(ARRAY[4287, 1968]) JOIN person_info AS p ON p.info_type_id = ANY(ARRAY[34, 28, 32, 33]) JOIN link_type AS lt ON lt.id = ANY(ARRAY[4821, 4781, 1175]) AND lt.link IN ('spoofs', 'featured in', 'edited from') WHERE t.kind_id != 0 GROUP BY t.kind_id;
SELECT kt.kind AS movie_kind, COUNT(DISTINCT mc.movie_id) AS number_of_movies, AVG(mi_idx.info::numeric) AS average_movie_length, SUM(CASE WHEN n.gender = 'M' THEN 1 ELSE 0 END) AS number_of_male_actors, SUM(CASE WHEN n.gender = 'F' THEN 1 ELSE 0 END) AS number_of_female_actors, MAX(n.name) AS most_recent_actor_name FROM movie_companies AS mc JOIN kind_type AS kt ON mc.movie_id = kt.id JOIN movie_info_idx AS mi_idx ON mc.movie_id = mi_idx.movie_id AND mi_idx.info_type_id = (SELECT id FROM info_type WHERE info = 'runtime') JOIN complete_cast AS cc ON mc.movie_id = cc.movie_id JOIN name AS n ON cc.subject_id = n.id WHERE mc.note LIKE '%(TV)%' AND kt.kind = 'movie' AND n.name_pcode_cf IN ('A2531', 'A4136', 'A21', 'A6123', 'A2', 'A5656') AND n.gender IN ('M', 'F') GROUP BY kt.kind;
SELECT mc.company_id, it.info AS keyword, COUNT(DISTINCT mk.movie_id) AS movies_count, AVG(sub.person_count) AS avg_cast_size FROM movie_keyword AS mk JOIN (SELECT id, info FROM info_type WHERE id IN (3708, 323, 4279) ) AS it ON it.id = mk.keyword_id JOIN movie_companies AS mc ON mk.movie_id = mc.movie_id AND mc.company_type_id = 1 LEFT JOIN (SELECT ci.movie_id, COUNT(DISTINCT ci.person_id) AS person_count FROM cast_info AS ci GROUP BY ci.movie_id ) AS sub ON mk.movie_id = sub.movie_id GROUP BY mc.company_id, it.info ORDER BY mc.company_id, movies_count DESC;
SELECT mi.info AS Movie_Language, rt.ROLE AS Role_Type, COUNT(DISTINCT ci.person_id) AS Total_People, AVG(ci.nr_order) AS Average_Cast_Order FROM movie_info mi JOIN cast_info ci ON mi.movie_id = ci.movie_id JOIN role_type rt ON ci.role_id = rt.id WHERE mi.info IN ('Bosnian', 'Serbian', 'Finnish', 'Greek') GROUP BY mi.info, rt.ROLE ORDER BY Movie_Language, Total_People DESC;
SELECT rt.role, AVG(akat.production_year) AS average_production_year, COUNT(DISTINCT akat.movie_id) AS total_movies, COUNT(DISTINCT cn.id) AS total_characters, SUM(CASE WHEN mk.keyword_id IS NOT NULL THEN 1 ELSE 0 END) AS movie_keyword_count, COUNT(DISTINCT pi.person_id) AS total_persons_with_info FROM role_type rt LEFT JOIN aka_title akat ON rt.id = akat.kind_id LEFT JOIN char_name cn ON cn.name = akat.title LEFT JOIN movie_keyword mk ON mk.movie_id = akat.movie_id LEFT JOIN person_info pi ON pi.info_type_id = rt.id WHERE akat.production_year > 2000 GROUP BY rt.role ORDER BY total_movies DESC, average_production_year DESC;
SELECT ct.kind AS company_type, cn.country_code, COUNT(DISTINCT t.id) AS total_movies, AVG(t.imdb_id) AS average_imdb_id FROM title AS t JOIN movie_link AS ml ON t.id = ml.movie_id JOIN company_name AS cn ON cn.imdb_id = ml.linked_movie_id JOIN company_type AS ct ON cn.id = ct.id WHERE t.production_year BETWEEN 2010 AND 2020 AND cn.country_code IN ('US', 'GB', 'CA') GROUP BY ct.kind, cn.country_code ORDER BY total_movies DESC, average_imdb_id ASC;
SELECT kt.kind AS movie_type, avg(akat.production_year) AS average_production_year, count(DISTINCT akat.movie_id) AS number_of_movies, count(DISTINCT mc.company_id) AS number_of_companies_involved, sum(CASE WHEN rt.role = 'director' THEN 1 ELSE 0 END) AS number_of_directors, sum(CASE WHEN rt.role = 'actress' THEN 1 ELSE 0 END) AS number_of_actresses, sum(CASE WHEN rt.role = 'cinematographer' THEN 1 ELSE 0 END) AS number_of_cinematographers, sum(CASE WHEN rt.role = 'composer' THEN 1 ELSE 0 END) AS number_of_composers FROM kind_type kt JOIN aka_title akat ON kt.id = akat.kind_id JOIN movie_companies mc ON akat.movie_id = mc.movie_id JOIN company_type ct ON mc.company_type_id = ct.id JOIN movie_link mlink ON akat.movie_id = mlink.movie_id JOIN role_type rt ON mlink.link_type_id = rt.id GROUP BY kt.kind ORDER BY number_of_movies DESC;
SELECT CN.name AS character_name, AVG(CI.nr_order) AS average_order_appearance, COUNT(DISTINCT CI.movie_id) AS number_of_movies, COUNT(DISTINCT CI.person_id) AS number_of_actors, CN.surname_pcode AS character_surname_code, STRING_AGG(DISTINCT CO.name, ', ') AS associated_companies, SUM(CASE WHEN CO.country_code = 'US' THEN 1 ELSE 0 END) AS number_of_US_companies FROM cast_info CI JOIN char_name CN ON CI.person_role_id = CN.id JOIN company_name CO ON CI.movie_id = CO.imdb_id WHERE CO.name_pcode_nf = 'T1452' GROUP BY CN.name, CN.surname_pcode ORDER BY number_of_movies DESC, average_order_appearance;
SELECT ct.kind AS cast_type, lt.LINK AS link_type, avg(at.production_year) AS average_production_year, count(distinct at.movie_id) AS number_of_movies, sum(CASE WHEN co.kind = 'distributors' THEN 1 ELSE 0 END) AS number_of_distributors, sum(CASE WHEN co.kind = 'production companies' THEN 1 ELSE 0 END) AS number_of_production_companies, sum(CASE WHEN co.kind = 'special effects companies' THEN 1 ELSE 0 END) AS number_of_special_effects_companies FROM comp_cast_type AS ct JOIN aka_title AS at ON ct.id = at.kind_id JOIN company_type AS co ON at.kind_id = co.id JOIN link_type AS lt ON at.id = lt.id WHERE ct.kind IN ('complete+verified', 'cast', 'crew', 'complete') AND lt.id IN ('13', '3', '5', '1', '10', '15') AND at.phonetic_code IN ('K4236', 'P2163', 'B5326') AND at.kind_id IN ('3', '2', '1', '4') GROUP BY ct.kind, lt.LINK;
SELECT kt.kind AS movie_genre, COUNT(DISTINCT mi_idx.movie_id) AS total_movies, AVG(CASE WHEN mi_idx.note SIMILAR TO '[0-9]+(\\.[0-9]+)?' THEN CAST(mi_idx.note AS FLOAT) ELSE NULL END) AS average_rating, MAX(CASE WHEN mi_idx.note SIMILAR TO '[0-9]+(\\.[0-9]+)?' THEN CAST(mi_idx.note AS FLOAT) ELSE NULL END) AS highest_rating FROM kind_type AS kt JOIN movie_info_idx AS mi_idx ON kt.id = mi_idx.info_type_id WHERE mi_idx.info LIKE '%Genre%' GROUP BY kt.kind;
SELECT COUNT(DISTINCT mc.movie_id) AS number_of_movies, AVG(t.production_year) AS average_production_year, cct.kind AS company_type, MIN(cn.name) AS company_name, SUM(CASE WHEN n.gender = 'M' THEN 1 ELSE 0 END) AS male_actors, SUM(CASE WHEN n.gender = 'F' THEN 1 ELSE 0 END) AS female_actors FROM movie_companies AS mc JOIN title AS t ON mc.movie_id = t.id JOIN company_name AS cn ON mc.company_id = cn.id JOIN comp_cast_type AS cct ON mc.company_type_id = cct.id LEFT JOIN name AS n ON n.md5sum = mc.note WHERE cn.country_code NOT LIKE '[pl]' AND t.production_year BETWEEN 1950 AND 1999 AND t.phonetic_code = 'D323' AND n.name_pcode_nf IN ('N6454', 'I4364', 'O2464', 'D54', 'M3526', 'G6534') GROUP BY cct.kind;
SELECT COUNT(DISTINCT chn.id) AS total_characters, AVG(CAST(mi_idx.info AS NUMERIC)) AS average_rating, SUM(CASE WHEN cc.status_id = 4 THEN 1 ELSE 0 END) AS total_complete_cast, SUM(CASE WHEN cc.status_id = 3 THEN 1 ELSE 0 END) AS total_incomplete_cast FROM char_name AS chn JOIN cast_info AS ci ON ci.person_role_id = chn.id JOIN movie_info_idx AS mi_idx ON mi_idx.movie_id = ci.movie_id JOIN complete_cast AS cc ON cc.movie_id = ci.movie_id WHERE mi_idx.info_type_id = 101 AND (cc.subject_id = 1 AND cc.status_id IN (3, 4)) GROUP BY cc.movie_id;
SELECT ct.kind AS company_kind, AVG(mi_idx.info::numeric) AS average_rating, COUNT(DISTINCT mc.movie_id) AS number_of_movies, COUNT(DISTINCT c.id) AS number_of_casts, SUM(CASE WHEN mc.note IS NOT NULL THEN 1 ELSE 0 END) AS noted_movie_companies FROM company_type ct JOIN movie_companies mc ON ct.id = mc.company_type_id JOIN movie_info_idx mi_idx ON mc.movie_id = mi_idx.movie_id AND mi_idx.info_type_id = 101 JOIN complete_cast c ON mc.movie_id = c.movie_id WHERE ct.kind IN ('production companies', 'distributors') AND mi_idx.movie_id IN ('30178', '12242', '20540', '27059', '12152', '12149') AND mi_idx.info::numeric >= 1 AND mi_idx.info::numeric <= 10 GROUP BY ct.kind;
SELECT kt.kind, COUNT(DISTINCT cc.movie_id) AS number_of_movies, AVG(cc.status_id) AS average_status_id, SUM(CASE WHEN n.gender = 'f' THEN 1 ELSE 0 END) AS female_cast_count, SUM(CASE WHEN n.gender = 'm' THEN 1 ELSE 0 END) AS male_cast_count FROM complete_cast cc JOIN kind_type kt ON cc.subject_id = kt.id JOIN name n ON cc.movie_id = n.id WHERE kt.kind IN ('video movie', 'tv series') GROUP BY kt.kind ORDER BY number_of_movies DESC;
SELECT ct.kind AS company_kind, COUNT(DISTINCT mc.company_id) AS number_of_companies, COUNT(DISTINCT t.id) AS number_of_movies, AVG(t.production_year) AS average_production_year, SUM(CASE WHEN mi.info = 'Norwegian' THEN 1 ELSE 0 END) AS norwegian_movies_count, SUM(CASE WHEN mi.info = 'Arabic' THEN 1 ELSE 0 END) AS arabic_movies_count, SUM(CASE WHEN mi.info = 'Serbian' THEN 1 ELSE 0 END) AS serbian_movies_count, SUM(CASE WHEN mi.info = 'Portuguese' THEN 1 ELSE 0 END) AS portuguese_movies_count FROM company_type AS ct JOIN movie_companies AS mc ON ct.id = mc.company_type_id JOIN title AS t ON mc.movie_id = t.id LEFT JOIN movie_info AS mi ON t.id = mi.movie_id AND mi.info_type_id = '4' WHERE ct.kind IN ('special effects companies', 'miscellaneous companies', 'production companies', 'distributors') GROUP BY ct.kind ORDER BY number_of_companies DESC;
SELECT COUNT(DISTINCT an.id) AS number_of_aka_names, AVG(cc.status_id) AS average_status_id, SUM(CASE WHEN cc.movie_id = 86434 THEN 1 ELSE 0 END) AS count_movie_86434, SUM(CASE WHEN cc.movie_id = 1676869 THEN 1 ELSE 0 END) AS count_movie_1676869, it.info AS information_type, MAX(an.name) AS most_common_alias FROM aka_name an JOIN complete_cast cc ON an.person_id = cc.subject_id JOIN info_type it ON cc.status_id = it.id GROUP BY it.info ORDER BY number_of_aka_names DESC, average_status_id;
SELECT COUNT(DISTINCT ci.id) AS total_actors, AVG(mc.id) AS avg_company_id, SUM(CASE WHEN rt.id = 6 THEN 1 ELSE 0 END) AS total_directors, MIN(n.name) AS first_actor_name, MAX(t.title) AS last_movie_title, COUNT(DISTINCT ml.movie_id) FILTER (WHERE ml.link_type_id = 3 OR ml.link_type_id = 7) AS total_related_movies FROM cast_info AS ci JOIN name AS n ON ci.person_id = n.id JOIN aka_title AS at ON ci.movie_id = at.movie_id JOIN movie_companies AS mc ON at.movie_id = mc.movie_id JOIN role_type AS rt ON ci.role_id = rt.id JOIN movie_link AS ml ON at.movie_id = ml.movie_id JOIN title AS t ON at.movie_id = t.id WHERE ci.note NOT LIKE '%uncredited%' AND at.production_year BETWEEN 2000 AND 2010 AND mc.company_type_id = (SELECT id FROM company_type WHERE kind = 'production') AND rt.role IN ('actor', 'actress', 'director') GROUP BY rt.id;
SELECT kt.kind AS movie_kind, COUNT(DISTINCT mk.movie_id) AS number_of_movies, AVG(mk.keyword_id) AS average_keyword_id FROM movie_keyword AS mk INNER JOIN kind_type AS kt ON kt.id = mk.keyword_id GROUP BY kt.kind ORDER BY number_of_movies DESC;
SELECT ct.kind AS company_type, AVG(t.production_year) AS average_production_year, COUNT(DISTINCT t.id) AS total_movies, SUM(CASE WHEN t.kind_id = 2 THEN 1 ELSE 0 END) AS total_movies_kind_id_2, SUM(CASE WHEN t.kind_id = 7 THEN 1 ELSE 0 END) AS total_movies_kind_id_7, COUNT(DISTINCT aka.id) AS total_alternate_titles, SUM(CASE WHEN t.season_nr = 34 THEN 1 ELSE 0 END) AS total_season_34_episodes FROM title t LEFT JOIN aka_title aka ON t.id = aka.movie_id LEFT JOIN company_type ct ON t.kind_id = ct.id GROUP BY ct.kind;
SELECT kt.kind AS movie_kind, COUNT(DISTINCT ci.movie_id) AS number_of_movies, COUNT(ci.person_id) AS number_of_cast_entries, AVG(ci.nr_order) AS average_cast_order, SUM(CASE WHEN rt.role = 'actor' THEN 1 ELSE 0 END) AS total_actors, SUM(CASE WHEN rt.role = 'actress' THEN 1 ELSE 0 END) AS total_actresses, COUNT(DISTINCT CASE WHEN ct.kind = 'production' THEN ci.movie_id END) AS number_of_production_movies, COUNT(DISTINCT CASE WHEN ct.kind = 'distributor' THEN ci.movie_id END) AS number_of_distributed_movies FROM cast_info ci JOIN role_type rt ON ci.role_id = rt.id JOIN kind_type kt ON ci.person_role_id = kt.id JOIN company_type ct ON ci.person_id = ct.id WHERE kt.kind = 'tv movie' AND ct.id IN (3, 4, 2) GROUP BY kt.kind HAVING COUNT(DISTINCT ci.movie_id) > 0;
SELECT rt.ROLE, AVG(at.production_year) AS avg_production_year, COUNT(DISTINCT at.movie_id) AS movie_count, SUM(unique_name_count) AS unique_names_sum FROM aka_title at JOIN (SELECT id, COUNT(DISTINCT name) as unique_name_count FROM char_name GROUP BY id) cn ON at.movie_id = cn.id JOIN role_type rt ON cn.id = rt.id WHERE at.note IN ('(new title)', '(USA) (working title)') GROUP BY rt.ROLE;
