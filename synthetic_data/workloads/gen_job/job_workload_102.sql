SELECT lt.LINK AS link_type, COUNT(DISTINCT ml.movie_id) AS number_of_movies, AVG(t.production_year) AS average_production_year, COUNT(DISTINCT t.episode_of_id) AS number_of_series, SUM(CASE WHEN t.season_nr IS NOT NULL THEN 1 ELSE 0 END) AS total_seasons_count, SUM(CASE WHEN t.production_year > 2000 THEN 1 ELSE 0 END) AS movies_since_2001 FROM movie_link AS ml JOIN link_type AS lt ON ml.link_type_id = lt.id JOIN title AS t ON ml.movie_id = t.id WHERE t.production_year BETWEEN 1980 AND 2023 AND lt.link IN ('remade as', 'edited from', 'referenced in') GROUP BY lt.LINK ORDER BY number_of_movies DESC;
SELECT kt.kind AS movie_kind, COUNT(DISTINCT t.id) AS total_movies, AVG(t.production_year) AS average_production_year, SUM(CASE WHEN cn.country_code = '[us]' THEN 1 ELSE 0 END) AS total_us_productions, COUNT(DISTINCT pi.person_id) AS unique_actors_info, MAX(n.name) AS latest_actor_name FROM title t JOIN kind_type kt ON t.kind_id = kt.id LEFT JOIN cast_info ci ON ci.movie_id = t.id LEFT JOIN name n ON ci.person_id = n.id LEFT JOIN person_info pi ON n.id = pi.person_id LEFT JOIN company_name cn ON cn.imdb_id = t.imdb_id WHERE kt.kind IN ('tv series', 'video movie', 'movie', 'video game') AND (cn.country_code = '[us]' OR cn.country_code IS NULL) AND n.id IN ('7106', '6832', '5625') AND pi.info_type_id IN ('34', '39', '27', '21') GROUP BY kt.kind ORDER BY total_movies DESC;
SELECT ct.kind AS company_kind, COUNT(*) AS total_movies, AVG(cc.status_id) AS average_status_id, SUM(case when cc.subject_id = 1 then 1 else 0 end) AS subject_1_movie_count, COUNT(DISTINCT k.id) AS unique_keywords_count FROM complete_cast AS cc JOIN company_name AS cn ON cc.movie_id = cn.imdb_id JOIN company_type AS ct ON cn.id = ct.id JOIN movie_keyword AS mk ON cc.movie_id = mk.movie_id JOIN keyword AS k ON mk.keyword_id = k.id WHERE cc.status_id = 3 AND cc.subject_id = 1 AND cn.country_code SIMILAR TO '(\[ae\]|\[hu\]|\[tj\]|\[cu\]|\[is\])' AND k.id IN (9868, 4714, 290, 4495, 1113) GROUP BY ct.kind;
SELECT rt.ROLE as role_type, COUNT(DISTINCT t.id) as total_titles, COALESCE(SUM(t.episode_nr), 0) as total_episodes, ROUND(AVG(t.production_year), 2) as average_production_year FROM title t JOIN role_type rt ON t.kind_id = rt.id GROUP BY rt.ROLE ORDER BY total_titles DESC;
SELECT AVG(CAST(mi_idx.info AS numeric)) AS average_rating, COUNT(DISTINCT a_t.movie_id) AS num_movies, COUNT(DISTINCT c_c.movie_id) AS num_complete_cast_movies, COUNT(DISTINCT p_i.person_id) AS num_persons_info, SUM(CASE WHEN a_t.production_year >= 2000 THEN 1 ELSE 0 END) AS num_movies_since_2000 FROM movie_info_idx mi_idx JOIN aka_title a_t ON mi_idx.movie_id = a_t.movie_id JOIN complete_cast c_c ON a_t.movie_id = c_c.movie_id JOIN person_info p_i ON p_i.person_id = ANY(ARRAY[1739786, 3545, 2362, 3631, 1719, 1739809]) WHERE mi_idx.info_type_id = (SELECT id FROM info_type WHERE info = 'rating') AND a_t.kind_id = 1 AND a_t.production_year IS NOT NULL GROUP BY a_t.kind_id;
SELECT kt.kind AS movie_kind, AVG(at.production_year) AS average_production_year, COUNT(DISTINCT ci.movie_id) AS number_of_movies, COUNT(DISTINCT ci.person_id) AS number_of_actors, SUM(CASE WHEN ci.role_id = 1 THEN 1 ELSE 0 END) AS number_of_lead_roles, COUNT(DISTINCT cn.id) AS number_of_unique_characters FROM cast_info ci JOIN aka_title at ON ci.movie_id = at.movie_id JOIN kind_type kt ON at.kind_id = kt.id JOIN char_name cn ON ci.person_role_id = cn.id WHERE at.production_year BETWEEN 1990 AND 2000 AND kt.kind = 'feature' GROUP BY kt.kind;
SELECT COUNT(DISTINCT mc.movie_id) AS number_of_movies, AVG(t.production_year) AS average_production_year, cct.kind AS company_type, MIN(cn.name) AS company_name, SUM(CASE WHEN n.gender = 'M' THEN 1 ELSE 0 END) AS male_actors, SUM(CASE WHEN n.gender = 'F' THEN 1 ELSE 0 END) AS female_actors FROM movie_companies AS mc JOIN title AS t ON mc.movie_id = t.id JOIN company_name AS cn ON mc.company_id = cn.id JOIN comp_cast_type AS cct ON mc.company_type_id = cct.id LEFT JOIN name AS n ON n.md5sum = mc.note WHERE cn.country_code NOT LIKE '[pl]' AND t.production_year BETWEEN 1950 AND 1999 AND t.phonetic_code = 'D323' AND n.name_pcode_nf IN ('N6454', 'I4364', 'O2464', 'D54', 'M3526', 'G6534') GROUP BY cct.kind;
SELECT kt.kind AS movie_kind, COUNT(*) AS total_movies, AVG(t.production_year) AS average_production_year, SUM(CASE WHEN mi.info = 'color' THEN 1 ELSE 0 END) AS color_movie_count, SUM(CASE WHEN mi.info = 'black and white' THEN 1 ELSE 0 END) AS black_and_white_movie_count FROM title AS t JOIN kind_type AS kt ON t.kind_id = kt.id JOIN movie_info AS mi ON t.id = mi.movie_id WHERE t.production_year BETWEEN 2000 AND 2010 AND mi.info_type_id IN (SELECT id FROM info_type WHERE info IN ('color', 'black and white')) GROUP BY kt.kind HAVING COUNT(*) > 100 ORDER BY total_movies DESC, average_production_year;
SELECT rt.role AS role_type, COUNT(DISTINCT n.id) AS number_of_people, AVG(n.imdb_id) AS average_imdb_id, SUM(CASE WHEN n.gender = 'F' THEN 1 ELSE 0 END) AS female_count, SUM(CASE WHEN n.gender = 'M' THEN 1 ELSE 0 END) AS male_count, COUNT(DISTINCT k.id) AS unique_keywords_used, COUNT(DISTINCT mi.movie_id) AS movies_with_notes FROM name n INNER JOIN role_type rt ON n.id = rt.id INNER JOIN keyword k ON k.phonetic_code IN ('S56', 'S12', 'S1535', 'B4535', 'A25', 'O123') INNER JOIN movie_info mi ON mi.info_type_id = k.id WHERE mi.note IN ('(some dialogue)', '(English subtitles)', '(Original version)', '(English version)') AND n.name_pcode_nf IN ('C4145', 'T641', 'Q5354', 'G6342', 'E2541') AND rt.role IN ('editor', 'director', 'production designer', 'cinematographer', 'miscellaneous crew') AND n.name IN ('Amores, Joaquín', 'Amor, Miguel Ángel', 'Anderson, Damion', 'Amokrane, Mustapha', 'Anderlik, Maddie', 'André, Emmanuel') GROUP BY rt.role;
SELECT ct.kind AS company_type, AVG(t.production_year) AS average_production_year, COUNT(DISTINCT t.id) AS number_of_movies, SUM(CASE WHEN mi.info_type_id = 1 THEN 1 ELSE 0 END) AS number_of_top_ranked_movies FROM company_type AS ct JOIN movie_companies AS mc ON ct.id = mc.company_type_id JOIN title AS t ON mc.movie_id = t.id JOIN movie_info AS mi ON t.id = mi.movie_id WHERE ct.kind IN ('special effects companies', 'miscellaneous companies', 'production companies', 'distributors') AND t.production_year >= 2000 GROUP BY ct.kind ORDER BY number_of_movies DESC;
