SELECT pi.note AS person_note, COUNT(DISTINCT ml.movie_id) AS total_movies, AVG(CAST(pi.info AS INTEGER)) AS average_person_info_number, SUM(CASE WHEN cc.subject_id = 1 THEN 1 ELSE 0 END) AS total_subject_id_1 FROM person_info pi JOIN movie_link ml ON pi.person_id = ml.movie_id JOIN complete_cast cc ON ml.movie_id = cc.movie_id WHERE pi.note IN ('Nick van de Wall', 'Gary Brumburgh / gr-home@pacbell.net') AND ml.link_type_id IN (3, 13, 17, 10, 16, 2) AND pi.info_type_id IN (32, 17, 31, 33, 38, 36) GROUP BY pi.note HAVING COUNT(DISTINCT ml.linked_movie_id) > 5;
SELECT AVG(a.production_year) AS average_production_year, COUNT(DISTINCT c.movie_id) AS number_of_movies, rt.ROLE, MAX(p.info) AS latest_person_info, COUNT(DISTINCT cn.id) AS number_of_people_with_role FROM aka_title AS a JOIN movie_companies AS c ON a.movie_id = c.movie_id JOIN role_type AS rt ON rt.ROLE IN ('writer', 'miscellaneous crew', 'production designer', 'actress') JOIN person_info AS p ON p.info_type_id = rt.id JOIN char_name AS cn ON cn.name_pcode_nf IN ('N6361', 'F6326', 'W6356') WHERE a.note IN ('(UK) (reissue title)', '(Hong Kong: English title) (video title)', '(West Germany) (Berlin film festival title)') AND c.company_id IN ('1064', '133') AND c.company_type_id = '1' AND a.production_year >= 2000 GROUP BY rt.ROLE ORDER BY number_of_movies DESC, average_production_year DESC;
SELECT cn.name AS company_name, AVG(at.production_year) AS average_production_year, COUNT(DISTINCT at.movie_id) AS number_of_movies, COUNT(DISTINCT an.person_id) AS unique_actors FROM company_name AS cn JOIN aka_title AS at ON at.title = cn.name LEFT JOIN aka_name AS an ON an.name = at.title GROUP BY cn.name HAVING COUNT(DISTINCT at.movie_id) > 5 ORDER BY number_of_movies DESC, average_production_year DESC;
SELECT kt.kind AS movie_type, COUNT(DISTINCT cn.id) AS total_actors, AVG(mi.info::NUMERIC) AS average_rating, SUM(CASE WHEN cn.name LIKE 'A%' THEN 1 ELSE 0 END) AS actors_with_A, COUNT(DISTINCT comp.id) AS total_companies_involved, COUNT(DISTINCT kw.id) AS total_keywords_used FROM movie_info mi JOIN info_type it ON mi.info_type_id = it.id JOIN kind_type kt ON it.id = kt.id JOIN char_name cn ON cn.id = mi.movie_id JOIN company_name comp ON comp.imdb_id = mi.movie_id JOIN keyword kw ON kw.id = mi.movie_id WHERE it.id IN (107, 78, 62, 5, 113, 20) AND comp.name IN ('Alex Wolf & Eugen Ill√©s', 'Total Film Home Entertainment', 'Pablo Distribuzione') AND comp.md5sum IN ('e4f3cb7948efaa2189b8433a5d0c2e5c', '7ca5629b21d0a13cc0a01264df7fa8e5') AND mi.info_type_id = it.id AND mi.info ~ '^\d+(\.\d+)?$' GROUP BY kt.kind;
SELECT kt.kind AS kind_of_production, COUNT(DISTINCT mk.movie_id) AS number_of_movies, COUNT(DISTINCT mk.keyword_id) AS number_of_unique_keywords, AVG(sub.movie_keyword_count) AS average_keywords_per_movie, COUNT(DISTINCT an.person_id) AS number_of_distinct_persons FROM kind_type kt JOIN movie_keyword mk ON mk.id = ANY(ARRAY[3853, 448, 3514, 4583, 3985]) JOIN (SELECT movie_id, COUNT(keyword_id) AS movie_keyword_count FROM movie_keyword GROUP BY movie_id) AS sub ON sub.movie_id = mk.movie_id LEFT JOIN aka_name an ON an.id = mk.movie_id AND an.name IS NOT NULL WHERE kt.kind IN ('video game', 'tv series', 'tv mini series', 'episode', 'video movie') GROUP BY kt.kind ORDER BY number_of_movies DESC;
SELECT kt.kind AS movie_kind, COUNT(DISTINCT at.id) AS total_alternate_titles, AVG(at.production_year) AS average_production_year, COUNT(DISTINCT cn.id) AS total_companies, COUNT(DISTINCT k.id) AS total_keywords, COUNT(DISTINCT ml.id) AS total_movie_links, SUM(CASE WHEN at.imdb_index = 'III' THEN 1 ELSE 0 END) AS count_imdb_index_III, SUM(CASE WHEN at.imdb_index = 'II' THEN 1 ELSE 0 END) AS count_imdb_index_II FROM aka_title at JOIN keyword k ON at.id = k.id JOIN movie_companies mc ON at.movie_id = mc.movie_id JOIN company_name cn ON mc.company_id = cn.id LEFT JOIN movie_link ml ON at.movie_id = ml.movie_id JOIN (SELECT id, kind FROM comp_cast_type WHERE kind IN ('actor', 'actress')) kt ON at.kind_id = kt.id WHERE at.kind_id IN ('1', '4') AND k.id IN ('5500', '1630', '2267', '1048', '1589') AND cn.md5sum IN ( 'ecf8ff261534cbe4303655e3dc9d91d6', 'b62db3e43522346d25381c78513fb9f0', '558dd734341ba79634e8c1a3eb8cb0b4', '209bfa49f531585f9c54dcc6f84a6263', 'f617c567816ace229f1654cef896d37c', 'a6ab3a7e25fc36179e64a2d2f6d205e8' ) AND ml.linked_movie_id IN ('1089913', '2016615') GROUP BY kt.kind;
SELECT ct.kind AS company_type, COUNT(DISTINCT mi_idx.movie_id) AS number_of_movies, AVG(CASE WHEN mi_idx.info_type_id = 100 THEN CAST(mi_idx.info AS FLOAT) END) AS average_rating, SUM(CASE WHEN mi_idx.info_type_id = 101 THEN CAST(mi_idx.info AS INTEGER) END) AS total_budget, COUNT(DISTINCT pi.person_id) AS number_of_persons_involved FROM movie_info_idx mi_idx JOIN company_type ct ON mi_idx.info_type_id = ct.id LEFT JOIN person_info pi ON mi_idx.movie_id = pi.person_id WHERE mi_idx.info_type_id IN (100, 101, 99) GROUP BY ct.kind;
SELECT ct.kind AS company_kind, COUNT(DISTINCT mc.movie_id) AS number_of_movies, AVG(CAST(mi_idx.info AS NUMERIC)) AS average_rating, SUM(CASE WHEN n.gender = 'F' THEN 1 ELSE 0 END) AS female_cast_count, SUM(CASE WHEN n.gender = 'M' THEN 1 ELSE 0 END) AS male_cast_count FROM company_type ct JOIN movie_companies mc ON ct.id = mc.company_type_id JOIN movie_info_idx mi_idx ON mc.movie_id = mi_idx.movie_id AND mi_idx.info_type_id = ( SELECT id FROM comp_cast_type WHERE kind = 'rating' ) JOIN name n ON mc.movie_id = n.id WHERE ct.kind IN ('special effects companies', 'miscellaneous companies', 'distributors') AND mc.movie_id IN ('19654', '24487', '18671', '31117', '18944') AND mc.company_id IN ('209', '936', '1140') AND n.name_pcode_cf IN ('A6232', 'A5163') GROUP BY ct.kind ORDER BY number_of_movies DESC, average_rating DESC;
