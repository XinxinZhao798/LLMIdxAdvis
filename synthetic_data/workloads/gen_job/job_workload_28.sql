SELECT rt.role AS role_type, COUNT(ml.movie_id) AS number_of_movies, AVG(it.id) AS average_info_type_id, SUM(CASE WHEN ml.link_type_id = 8 THEN 1 ELSE 0 END) AS count_link_type_8, SUM(CASE WHEN ml.link_type_id = 11 THEN 1 ELSE 0 END) AS count_link_type_11, SUM(CASE WHEN ml.link_type_id = 3 THEN 1 ELSE 0 END) AS count_link_type_3 FROM movie_link AS ml JOIN role_type AS rt ON rt.id = ml.link_type_id JOIN info_type AS it ON it.id = ml.link_type_id GROUP BY rt.role ORDER BY number_of_movies DESC, average_info_type_id DESC;
SELECT COUNT(DISTINCT at.id) AS total_alternative_titles, AVG(cc.status_id) AS average_status_id, SUM(CASE WHEN at.production_year > 2000 THEN 1 ELSE 0 END) AS titles_after_2000, cn.name AS character_name, it.info AS info_type_description, MAX(at.season_nr) AS max_season_nr, MIN(at.episode_nr) AS min_episode_nr FROM aka_title at JOIN complete_cast cc ON at.movie_id = cc.movie_id JOIN char_name cn ON cn.id = at.id JOIN info_type it ON it.id = cc.subject_id GROUP BY cn.name, it.info ORDER BY total_alternative_titles DESC, average_status_id;
SELECT t.production_year, COUNT(DISTINCT ci.movie_id) AS number_of_movies, COUNT(DISTINCT ci.person_id) AS number_of_actors, AVG(ci.nr_order) AS average_cast_order, SUM(CASE WHEN n.gender = 'm' THEN 1 ELSE 0 END) AS male_actors_count, SUM(CASE WHEN n.gender <> 'm' THEN 1 ELSE 0 END) AS female_and_other_actors_count, it.info AS info_type, COUNT(DISTINCT t.id) FILTER (WHERE it.info = 'budget') AS number_of_movies_with_budget, COUNT(DISTINCT t.id) FILTER (WHERE it.info = 'LD digital sound') AS number_of_movies_with_ld_digital_sound FROM cast_info ci JOIN name n ON ci.person_id = n.id JOIN title t ON ci.movie_id = t.id JOIN info_type it ON ci.role_id = it.id GROUP BY t.production_year, it.info ORDER BY t.production_year DESC, it.info;
SELECT CN.name AS company_name, COUNT(DISTINCT AN.id) AS total_aliases, AVG(AT.production_year) AS average_production_year, SUM(CASE WHEN N.gender = 'M' THEN 1 ELSE 0 END) AS male_actors_count, SUM(CASE WHEN N.gender = 'F' THEN 1 ELSE 0 END) AS female_actors_count FROM company_name CN JOIN aka_title AT ON CN.id = AT.movie_id JOIN aka_name AN ON AN.person_id = AT.movie_id JOIN name N ON N.id = AN.person_id WHERE CN.country_code = 'US' AND AT.production_year >= 2000 AND N.gender IN ('M', 'F') GROUP BY CN.name;
SELECT ct.kind AS cast_type, AVG(t.production_year) AS avg_production_year, COUNT(DISTINCT cn.id) AS total_companies, SUM(CASE WHEN pi.info_type_id = 17 THEN 1 ELSE 0 END) AS count_info_type_17, COUNT(DISTINCT k.id) AS total_keywords, COUNT(DISTINCT t.id) FILTER (WHERE t.production_year > 2010) AS titles_after_2010 FROM title AS t JOIN comp_cast_type AS ct ON t.kind_id = ct.id LEFT JOIN company_name AS cn ON cn.md5sum IN ('46757a84e182ecbce2485bbe4f94c35c', '042c3abaa3eee3219096099e572cbd78', '055c9414a7d1b5428c44a7840e634a28') LEFT JOIN person_info AS pi ON pi.info IN ('Elektra', '23 September 1989') LEFT JOIN keyword AS k ON k.keyword LIKE '%' LEFT JOIN link_type AS lt ON lt.link = 'similar to' AND lt.id = 13 WHERE (t.episode_of_id = '86208' OR cn.name_pcode_nf = 'M6421') GROUP BY ct.kind;
SELECT it.info AS genre, COUNT(mi.movie_id) AS number_of_movies, AVG(LENGTH(mi.info)) AS average_info_length, SUM(CASE WHEN an.name_pcode_cf IN ('A5143', 'F2162', 'B362', 'M2462') THEN 1 ELSE 0 END) AS count_actors_with_pcode FROM movie_info mi JOIN info_type it ON mi.info_type_id = it.id LEFT JOIN aka_name an ON an.person_id = mi.movie_id WHERE it.id = 40 AND mi.info IN ('Tagalog', 'Persian') GROUP BY it.info;
SELECT kt.kind, COUNT(DISTINCT cc.movie_id) AS number_of_movies, AVG(CAST(mi_idx.info AS NUMERIC)) AS average_movie_info, SUM(CASE WHEN mi_idx.note = 'Y' THEN 1 ELSE 0 END) AS count_noted_info FROM complete_cast cc JOIN kind_type kt ON cc.subject_id = kt.id JOIN movie_info_idx mi_idx ON cc.movie_id = mi_idx.movie_id WHERE cc.status_id IN (1, 2, 3) AND mi_idx.info_type_id BETWEEN 10 AND 20 AND mi_idx.id NOT IN (4072, 3466, 2096, 1652, 1371) AND cc.id NOT IN (3672, 620) GROUP BY kt.kind HAVING COUNT(DISTINCT cc.movie_id) > 5 ORDER BY average_movie_info DESC;
SELECT cn.country_code, COUNT(DISTINCT mi.movie_id) AS movie_count, AVG(pi.info_type_id::numeric) AS avg_person_info_type, COUNT(DISTINCT cn.name) AS company_count, COUNT(DISTINCT chn.name) AS character_name_count FROM movie_info mi JOIN movie_info_idx mii ON mi.movie_id = mii.movie_id AND mi.info_type_id = mii.info_type_id JOIN company_name cn ON mi.movie_id = cn.imdb_id JOIN person_info pi ON mi.movie_id = pi.person_id JOIN char_name chn ON mi.movie_id = chn.imdb_id WHERE cn.country_code IN ('[np]', '[kr]', '[cn]', '[tw]', '[sa]', '[my]') AND pi.note IN ('info@aeberhard.com', 'Chris Hendren', 'Quincy Johnson', 'Ian Adema', 'isabelleadriani@yahoo.it') AND pi.info_type_id IN ('34', '36') AND mi.info IN ('Galician', 'Flemish', 'Persian', 'Czech') GROUP BY cn.country_code ORDER BY movie_count DESC, avg_person_info_type DESC;
SELECT ct.kind AS company_type, COUNT(DISTINCT mc.company_id) AS number_of_companies, COUNT(DISTINCT mc.movie_id) AS number_of_movies, AVG(k.id) AS average_keyword_id, SUM(CASE WHEN k.keyword = 'personal-stories' THEN 1 ELSE 0 END) AS count_personal_stories, SUM(CASE WHEN k.keyword = 'toyota-starlet' THEN 1 ELSE 0 END) AS count_toyota_starlet FROM movie_companies AS mc JOIN company_type AS ct ON mc.company_type_id = ct.id JOIN company_name AS cn ON mc.company_id = cn.id JOIN keyword AS k ON k.phonetic_code = cn.name_pcode_nf GROUP BY ct.kind ORDER BY number_of_companies DESC, number_of_movies DESC;
SELECT kt.kind AS movie_kind, count(DISTINCT ci.movie_id) AS num_movies, avg(ci.nr_order) AS avg_cast_order, count(DISTINCT pi.person_id) AS num_people, sum(case when pi.info LIKE '%tropical fever%' then 1 else 0 end) AS count_tropical_fever_mentions, min(a.name) AS example_actor_name, max(k.keyword) AS example_keyword FROM cast_info AS ci JOIN kind_type AS kt ON ci.movie_id = kt.id JOIN person_info AS pi ON ci.person_id = pi.person_id JOIN aka_name AS a ON ci.person_id = a.person_id JOIN keyword AS k ON pi.info LIKE '%' || k.keyword || '%' WHERE a.name_pcode_nf IN ('L6543', 'E3624', 'F6543', 'F6261', 'A5242', 'F6526') AND ci.person_id IN ('21277', '11977', '18600') GROUP BY kt.kind ORDER BY num_movies DESC;
SELECT c.name AS company_name, c.country_code, kt.kind AS movie_type, COUNT(DISTINCT mi.movie_id) AS number_of_movies, AVG(CAST(mi_num.info AS DECIMAL)) AS average_rating, SUM(CASE WHEN mk.keyword_id = 3569 THEN 1 ELSE 0 END) AS count_of_keyword_3569, SUM(CASE WHEN mk.keyword_id = 3677 THEN 1 ELSE 0 END) AS count_of_keyword_3677, COUNT(DISTINCT ml.id) AS number_of_movie_links, COUNT(DISTINCT mi.id) AS number_of_movie_infos FROM company_name c JOIN movie_info mi ON c.imdb_id = mi.movie_id JOIN info_type it ON mi.info_type_id = it.id JOIN movie_keyword mk ON mi.movie_id = mk.movie_id JOIN movie_link ml ON mi.movie_id = ml.movie_id JOIN kind_type kt ON it.id = kt.id LEFT JOIN movie_info mi_num ON mi.movie_id = mi_num.movie_id AND mi_num.info_type_id = ( SELECT id FROM info_type WHERE info = 'rating' ) WHERE c.country_code = 'US' AND it.info = 'countries' AND kt.kind = 'movie' GROUP BY c.name, c.country_code, kt.kind ORDER BY number_of_movies DESC;
SELECT AVG(cast_count) AS average_cast_per_movie, AVG(link_count) AS average_links_per_movie, COUNT(DISTINCT mi.info_type_id) AS unique_info_types FROM (SELECT movie_id, COUNT(*) AS cast_count FROM cast_info WHERE note LIKE '%(Band)%' GROUP BY movie_id) AS cast_counts JOIN (SELECT movie_id, COUNT(*) AS link_count FROM movie_link WHERE link_type_id IN (6, 5, 11, 15) GROUP BY movie_id) AS link_counts ON cast_counts.movie_id = link_counts.movie_id JOIN movie_info AS mi ON cast_counts.movie_id = mi.movie_id;
SELECT COUNT(DISTINCT t.id) AS total_titles, AVG(t.production_year) AS average_production_year, SUM(CASE WHEN t.kind_id = 1 THEN 1 ELSE 0 END) AS total_movies, SUM(CASE WHEN t.kind_id = 2 THEN 1 ELSE 0 END) AS total_tv_shows, COUNT(DISTINCT pi.person_id) AS total_people_contributed, AVG(pi.info::NUMERIC) FILTER (WHERE pi.info_type_id = 3) AS average_movie_length FROM title AS t LEFT JOIN person_info AS pi ON t.id = pi.person_id WHERE t.production_year BETWEEN 1990 AND 2020 AND t.series_years LIKE '%199%' GROUP BY t.kind_id;
SELECT n.name AS actor_name, COUNT(DISTINCT ci.movie_id) AS number_of_movies, COUNT(ci.id) AS total_roles_played, AVG(ci.nr_order) AS average_order_of_appearance, AVG(CAST(mi_idx.info AS FLOAT)) AS average_movie_rating FROM cast_info ci JOIN name n ON ci.person_id = n.id JOIN movie_info_idx mi_idx ON ci.movie_id = mi_idx.movie_id AND mi_idx.info_type_id = (SELECT id FROM info_type WHERE info = 'rating') GROUP BY n.name ORDER BY number_of_movies DESC, average_movie_rating DESC, average_order_of_appearance ASC LIMIT 10;
SELECT AVG(CASE WHEN mi.info_type_id = 101 THEN mi.info::NUMERIC END) AS average_rating, COUNT(DISTINCT ci.movie_id) AS total_movies_with_cast, COUNT(DISTINCT mc.company_id) AS total_companies_involved, SUM(CASE WHEN t.kind_id = 1 THEN 1 ELSE 0 END) AS total_movies, SUM(CASE WHEN t.kind_id = 2 THEN 1 ELSE 0 END) AS total_tv_shows FROM title t LEFT JOIN movie_info mi ON mi.movie_id = t.id AND mi.info_type_id = 101 LEFT JOIN movie_companies mc ON t.id = mc.movie_id LEFT JOIN aka_title at ON at.movie_id = t.id LEFT JOIN comp_cast_type cct ON cct.id = t.kind_id LEFT JOIN movie_link ml ON ml.movie_id = t.id LEFT JOIN cast_info ci ON ci.movie_id = t.id WHERE t.production_year BETWEEN 1990 AND 2000 AND (cct.kind = 'cast' OR cct.kind IS NULL) AND (mi.info::NUMERIC > 5 OR mi.info IS NULL) AND mc.movie_id IN ('27126', '18504', '29107', '9067', '19664') AND mc.id IN ('2907', '3863', '4319') AND (at.title LIKE 'äÎÅ×ÎÉË ÕÂÉÊÃÙ' OR at.title IS NULL) AND (mi.note LIKE '%(only a few lines)%' OR mi.note IS NULL) GROUP BY t.kind_id;
SELECT cn.name AS company_name, COUNT(DISTINCT pers_info.movie_id) AS number_of_movies, AVG(pers_info.avg_actor_age) AS average_actor_age, SUM(CASE WHEN mi_idx.info = 'color' THEN 1 ELSE 0 END) AS color_movie_count, SUM(CASE WHEN mi_idx.info = 'black and white' THEN 1 ELSE 0 END) AS bw_movie_count FROM company_name cn JOIN movie_info_idx mi_idx ON cn.imdb_id = mi_idx.movie_id JOIN (SELECT ci.movie_id, AVG(CAST(info AS INTEGER)) AS avg_actor_age FROM cast_info ci JOIN person_info pi ON ci.person_id = pi.person_id AND pi.info_type_id = 1 WHERE ci.role_id = (SELECT id FROM cast_info WHERE note = 'actor' LIMIT 1) GROUP BY ci.movie_id) pers_info ON mi_idx.movie_id = pers_info.movie_id WHERE cn.name_pcode_sf IN ('I5164', 'C3132') GROUP BY cn.name;
SELECT kt.kind AS movie_type, COUNT(DISTINCT ci.movie_id) AS total_movies, AVG(CAST(mi_idx.info AS FLOAT)) AS average_rating, COUNT(DISTINCT ci.person_id) AS total_actors, COUNT(DISTINCT mc.company_id) AS total_companies, COUNT(DISTINCT ml.linked_movie_id) AS total_linked_movies FROM cast_info ci JOIN kind_type kt ON ci.movie_id = kt.id JOIN movie_info_idx mi_idx ON ci.movie_id = mi_idx.movie_id AND mi_idx.info_type_id = (SELECT id FROM info_type WHERE info = 'rating') JOIN movie_companies mc ON ci.movie_id = mc.movie_id JOIN movie_link ml ON ci.movie_id = ml.movie_id WHERE kt.kind IN ('episode', 'tv movie') AND ml.link_type_id IN (4, 13, 11, 6, 8, 3) AND mi_idx.movie_id IN (8354, 8579) GROUP BY kt.kind;
SELECT link_type.LINK AS link_type, COUNT(DISTINCT movie_link.movie_id) AS total_movies, AVG(aka_title.production_year) AS average_production_year, SUM(CASE WHEN aka_title.kind_id = 1 THEN 1 ELSE 0 END) AS total_full_length_movies, COUNT(DISTINCT company_name.id) AS total_different_companies, COUNT(DISTINCT movie_companies.company_type_id) AS total_company_types, MAX(aka_title.season_nr) AS max_season_number, MIN(aka_title.episode_nr) AS min_episode_number, COUNT(DISTINCT info_type.id) AS total_info_types FROM movie_link JOIN link_type ON movie_link.link_type_id = link_type.id JOIN aka_title ON movie_link.movie_id = aka_title.movie_id JOIN movie_companies ON aka_title.movie_id = movie_companies.movie_id JOIN company_name ON movie_companies.company_id = company_name.id JOIN info_type ON 1=1 WHERE link_type.LINK IN ('features', 'alternate language version of', 'featured in', 'edited into', 'remade as') AND aka_title.kind_id IN (1, 4, 3, 7, 2, 6) AND aka_title.md5sum IN ('1b81d95ddc7a645727ec6e01c28ec5be', 'de1cedb89a8eeb93cc5cba31a251e0f8', 'b4e6ea5bd996a24faacd0571b2f495dd') AND company_name.country_code = '[tr]' GROUP BY link_type.LINK;
SELECT AVG(CAST(mi_idx.info AS NUMERIC)) AS average_rating, COUNT(DISTINCT a_title.movie_id) AS number_of_movies, COUNT(DISTINCT a_name.person_id) AS number_of_people, SUM(CASE WHEN m_link.link_type_id = 1 THEN 1 ELSE 0 END) AS number_of_prequels, SUM(CASE WHEN m_link.link_type_id = 2 THEN 1 ELSE 0 END) AS number_of_sequels, AVG(a_title.production_year) AS average_production_year FROM aka_title AS a_title JOIN aka_name AS a_name ON a_title.movie_id = a_name.person_id JOIN movie_info_idx AS mi_idx ON a_title.movie_id = mi_idx.movie_id JOIN movie_link AS m_link ON a_title.movie_id = m_link.movie_id WHERE a_title.md5sum IN ('d4b78437f259ec962b25a518a77b6488', '982d91d043a457fb7114c4e57fba41a9') AND mi_idx.info_type_id = 101 GROUP BY a_title.kind_id HAVING COUNT(DISTINCT a_title.movie_id) > 10;
SELECT rt.ROLE, COUNT(*) AS role_count, AVG(ci.nr_order) AS average_order, SUM(ci.nr_order) AS total_order, MAX(ci.nr_order) AS max_order, MIN(ci.nr_order) AS min_order FROM cast_info ci JOIN role_type rt ON ci.role_id = rt.id JOIN movie_keyword mk ON ci.movie_id = mk.movie_id JOIN movie_info mi ON ci.movie_id = mi.movie_id JOIN movie_link ml ON ci.movie_id = ml.movie_id WHERE mk.keyword_id IN (3544, 4170, 355, 3797, 2901) AND ci.movie_id IN (14730, 8894, 18741, 18773, 15355, 12280, 2069434, 2317758, 2267299) GROUP BY rt.ROLE ORDER BY role_count DESC, average_order;
SELECT ct.kind AS company_type, COUNT(DISTINCT mc.movie_id) AS number_of_movies, COUNT(DISTINCT comp.id) AS number_of_companies, AVG(CAST(SUBSTRING(mc.note FROM '\\(([0-9]{4})\\)') AS INTEGER)) AS average_production_year, COUNT(DISTINCT ccast.subject_id) AS number_of_unique_subjects, COUNT(DISTINCT k.id) AS number_of_keywords, SUM(CASE WHEN lt.link ILIKE '%spin off%' THEN 1 ELSE 0 END) AS count_spin_off_links FROM movie_companies AS mc JOIN company_type AS ct ON mc.company_type_id = ct.id JOIN company_name AS comp ON mc.company_id = comp.id LEFT JOIN complete_cast AS ccast ON mc.movie_id = ccast.movie_id LEFT JOIN movie_info_idx AS mi ON mc.movie_id = mi.movie_id LEFT JOIN keyword AS k ON mi.info = k.keyword LEFT JOIN link_type AS lt ON mi.info_type_id = lt.id WHERE mc.note NOT LIKE '%(TV)%' AND SUBSTRING(mc.note FROM '\\(([0-9]{4})\\)')::INTEGER BETWEEN 1990 AND 2023 GROUP BY ct.kind ORDER BY number_of_movies DESC;
SELECT COUNT(DISTINCT ci.movie_id) AS total_movies, AVG(ci.nr_order) AS average_cast_order, SUM(CASE WHEN ci.person_role_id IN (56, 1326) THEN 1 ELSE 0 END) AS count_special_roles, COUNT(DISTINCT cn.id) AS total_unique_characters, COUNT(DISTINCT k.id) AS total_unique_keywords, MAX(mi.info) AS longest_movie_info FROM cast_info ci JOIN char_name cn ON ci.person_id = cn.id JOIN movie_info mi ON ci.movie_id = mi.movie_id JOIN keyword k ON k.phonetic_code = 'O16' WHERE mi.info <> 'None' AND mi.info LIKE '%Czech%' GROUP BY ci.movie_id;
SELECT ct.kind AS company_type, AVG(CAST(mi_idx.info AS numeric)) AS average_rating, COUNT(DISTINCT n.id) AS total_actors, COUNT(DISTINCT mk.movie_id) AS movies_with_keywords, SUM(CASE WHEN at.season_nr IS NOT NULL THEN 1 ELSE 0 END) AS total_episodes FROM movie_info_idx AS mi_idx JOIN aka_title AS at ON mi_idx.movie_id = at.movie_id JOIN company_type AS ct ON at.kind_id = ct.id JOIN movie_keyword AS mk ON mi_idx.movie_id = mk.movie_id JOIN name AS n ON at.movie_id = n.id WHERE mi_idx.info_type_id = 101 AND mi_idx.movie_id IN ('18742', '8465', '6663') AND at.production_year BETWEEN 2000 AND 2023 GROUP BY ct.kind ORDER BY average_rating DESC;
SELECT AVG(ml_count.count) AS avg_movie_links, COUNT(DISTINCT an.person_id) AS distinct_person_count, SUM(CASE WHEN ml.link_type_id = '5' THEN 1 ELSE 0 END) AS total_sequel_links FROM movie_link AS ml JOIN (SELECT movie_id, COUNT(*) AS count FROM movie_link GROUP BY movie_id) AS ml_count ON ml.movie_id = ml_count.movie_id JOIN aka_name AS an ON ml.movie_id = an.person_id WHERE ml.link_type_id IN ('5', '11', '13', '17', '2', '1') GROUP BY ml.link_type_id;
SELECT AVG(CAST(mi.info AS NUMERIC)) AS average_rating, COUNT(DISTINCT ci.movie_id) AS number_of_movies, SUM(CASE WHEN k.keyword = 'sugar' THEN 1 ELSE 0 END) AS sugar_keyword_count, SUM(CASE WHEN k.keyword = 'chair' THEN 1 ELSE 0 END) AS chair_keyword_count, COUNT(DISTINCT akn.person_id) AS unique_actors_with_alternate_names, MAX(mi.note) AS longest_note FROM movie_info mi JOIN info_type it ON mi.info_type_id = it.id AND it.info = 'rating' JOIN cast_info ci ON mi.movie_id = ci.movie_id JOIN movie_keyword mk ON ci.movie_id = mk.movie_id JOIN keyword k ON mk.keyword_id = k.id AND k.id IN ('5046', '3865') LEFT JOIN aka_name akn ON ci.person_id = akn.person_id WHERE mi.movie_id IN (SELECT movie_id FROM movie_keyword WHERE keyword_id IN ('5046', '3865')) GROUP BY it.info;
