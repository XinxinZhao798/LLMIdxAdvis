SELECT it.info AS genre, COUNT(mi.movie_id) AS number_of_movies, AVG(LENGTH(mi.info)) AS average_info_length, SUM(CASE WHEN an.name_pcode_cf IN ('A5143', 'F2162', 'B362', 'M2462') THEN 1 ELSE 0 END) AS count_actors_with_pcode FROM movie_info mi JOIN info_type it ON mi.info_type_id = it.id LEFT JOIN aka_name an ON an.person_id = mi.movie_id WHERE it.id = 40 AND mi.info IN ('Tagalog', 'Persian') GROUP BY it.info;
SELECT ct.kind AS company_type, COUNT(mc.id) AS total_movies, AVG(mi_idx.info::numeric) AS average_movie_info, SUM(CASE WHEN rt.role = 'director' THEN 1 ELSE 0 END) AS total_directors, SUM(CASE WHEN rt.role = 'editor' THEN 1 ELSE 0 END) AS total_editors FROM movie_companies AS mc JOIN company_type AS ct ON mc.company_type_id = ct.id JOIN movie_info_idx AS mi_idx ON mc.movie_id = mi_idx.movie_id JOIN role_type AS rt ON rt.id = mc.company_type_id WHERE mi_idx.info_type_id IN (100, 101, 99) AND ct.id IN (SELECT id FROM comp_cast_type WHERE kind IN ('complete+verified', 'cast', 'crew', 'complete')) AND rt.id IN (9, 3, 10, 8, 11, 6) GROUP BY ct.kind ORDER BY total_movies DESC;
SELECT cn.country_code, k.keyword, COUNT(DISTINCT mc.movie_id) AS num_movies, AVG(CAST(NULLIF(REGEXP_REPLACE(mi_duration.info, '[^\d.]', '', 'g'), '') AS NUMERIC)) AS average_movie_duration, SUM(CASE WHEN mi_release.info_type_id = 4 THEN 1 ELSE 0 END) AS count_movie_releases FROM company_name AS cn JOIN movie_companies AS mc ON cn.id = mc.company_id JOIN movie_keyword AS mk ON mc.movie_id = mk.movie_id JOIN keyword AS k ON mk.keyword_id = k.id LEFT JOIN movie_info AS mi_release ON mc.movie_id = mi_release.movie_id AND mi_release.info_type_id = 4 LEFT JOIN movie_info AS mi_duration ON mc.movie_id = mi_duration.movie_id AND mi_duration.info_type_id = 3 WHERE k.keyword IN ('dead-mother', 'manipulation') AND mi_release.note IN ('(some dialogue)', '(none)', '(only a few lines)', '(a few lines)', '(a few words)') GROUP BY cn.country_code, k.keyword ORDER BY cn.country_code, k.keyword;
SELECT kind.id AS kind_id, COUNT(DISTINCT aka_title.movie_id) AS number_of_movies, AVG(aka_title.production_year) AS average_production_year, COUNT(DISTINCT movie_info_idx.info_type_id) AS unique_info_types_count, SUM(CASE WHEN info_type.info = 'locations' THEN 1 ELSE 0 END) AS locations_count, SUM(CASE WHEN info_type.info = 'adaption' THEN 1 ELSE 0 END) AS adaption_count, SUM(CASE WHEN info_type.info = 'LD disc format' THEN 1 ELSE 0 END) AS ld_disc_format_count, SUM(CASE WHEN info_type.info = 'quotes' THEN 1 ELSE 0 END) AS quotes_count FROM aka_title JOIN movie_info_idx ON aka_title.movie_id = movie_info_idx.movie_id JOIN info_type ON movie_info_idx.info_type_id = info_type.id JOIN (SELECT id, kind_id FROM aka_title GROUP BY id, kind_id) AS kind ON aka_title.kind_id = kind.id GROUP BY kind.id ORDER BY number_of_movies DESC;
SELECT rt.ROLE, AVG(miidx.info::NUMERIC) AS average_rating, COUNT(DISTINCT cn.id) AS number_of_companies, COUNT(DISTINCT cl.movie_id) AS number_of_movies_linked, COUNT(DISTINCT mk.keyword_id) AS number_of_unique_keywords FROM role_type rt LEFT JOIN char_name cn ON cn.surname_pcode = rt.id::CHARACTER VARYING LEFT JOIN movie_link cl ON cl.link_type_id = rt.id LEFT JOIN movie_keyword mk ON mk.movie_id = cl.movie_id LEFT JOIN movie_info_idx miidx ON miidx.movie_id = cl.movie_id WHERE rt.ROLE IN ('production designer', 'guest', 'editor', 'cinematographer') AND cn.name_pcode_nf IN ('T3452', 'A423', 'D653', 'A5426', 'H5161', 'B3216') AND miidx.info_type_id = 101 /* Assuming 101 is the info_type_id for 'rating' */ GROUP BY rt.ROLE;
SELECT AVG(ml_count.count) AS avg_movie_links, COUNT(DISTINCT an.person_id) AS distinct_person_count, SUM(CASE WHEN ml.link_type_id = '5' THEN 1 ELSE 0 END) AS total_sequel_links FROM movie_link AS ml JOIN (SELECT movie_id, COUNT(*) AS count FROM movie_link GROUP BY movie_id) AS ml_count ON ml.movie_id = ml_count.movie_id JOIN aka_name AS an ON ml.movie_id = an.person_id WHERE ml.link_type_id IN ('5', '11', '13', '17', '2', '1') GROUP BY ml.link_type_id;
SELECT AVG(at.note_length) AS avg_note_length, COUNT(DISTINCT kw.id) AS num_unique_keywords, COUNT(DISTINCT at.id) AS num_titles, SUM(CASE WHEN at.episode_nr = 155 THEN 1 ELSE 0 END) AS num_episode_155, STRING_AGG(DISTINCT kw.keyword, ', ') AS keywords_list FROM ( SELECT id, movie_id, episode_nr, LENGTH(note) AS note_length FROM aka_title WHERE note LIKE '%(Australia) (fake working title)%' ) AS at JOIN movie_companies AS mc ON at.movie_id = mc.movie_id JOIN company_name AS cn ON mc.company_id = cn.id JOIN company_type AS ct ON mc.company_type_id = ct.id JOIN keyword AS kw ON cn.country_code = kw.phonetic_code WHERE kw.keyword IN ('handcuffed-to-someone', 'religious', 'drug-trafficking', 'conservatory', 'scientology', 'horse-riding') AND ct.kind = 'production companies' GROUP BY cn.country_code;
SELECT ct.kind AS company_type, COUNT(DISTINCT mc.movie_id) AS number_of_movies, COUNT(DISTINCT comp.id) AS number_of_companies, AVG(CAST(SUBSTRING(mc.note FROM '\\(([0-9]{4})\\)') AS INTEGER)) AS average_production_year, COUNT(DISTINCT ccast.subject_id) AS number_of_unique_subjects, COUNT(DISTINCT k.id) AS number_of_keywords, SUM(CASE WHEN lt.link ILIKE '%spin off%' THEN 1 ELSE 0 END) AS count_spin_off_links FROM movie_companies AS mc JOIN company_type AS ct ON mc.company_type_id = ct.id JOIN company_name AS comp ON mc.company_id = comp.id LEFT JOIN complete_cast AS ccast ON mc.movie_id = ccast.movie_id LEFT JOIN movie_info_idx AS mi ON mc.movie_id = mi.movie_id LEFT JOIN keyword AS k ON mi.info = k.keyword LEFT JOIN link_type AS lt ON mi.info_type_id = lt.id WHERE mc.note NOT LIKE '%(TV)%' AND SUBSTRING(mc.note FROM '\\(([0-9]{4})\\)')::INTEGER BETWEEN 1990 AND 2023 GROUP BY ct.kind ORDER BY number_of_movies DESC;
SELECT kt.kind AS movie_kind, AVG(t.production_year) AS average_production_year, COUNT(DISTINCT an.person_id) AS unique_actors_with_alternate_names, COUNT(DISTINCT cn.id) AS number_of_companies, SUM(CASE WHEN t.production_year > 2000 THEN 1 ELSE 0 END) AS movies_produced_after_2000 FROM aka_name an INNER JOIN name n ON an.person_id = n.id INNER JOIN aka_title at ON n.id = at.movie_id INNER JOIN title t ON at.movie_id = t.id INNER JOIN kind_type kt ON t.kind_id = kt.id INNER JOIN company_name cn ON t.id = cn.imdb_id LEFT JOIN char_name chn ON an.person_id = chn.id WHERE (chn.name = 'Clarkson' OR chn.name = 'Miguelito' OR chn.name = 'Basket coach') GROUP BY kt.kind;
SELECT rt.role AS role_type, AVG(at.production_year) AS avg_production_year, COUNT(DISTINCT ci.movie_id) AS total_movies_with_writers, COUNT(DISTINCT ci.person_id) AS total_different_writers, SUM(CASE WHEN at.title ILIKE 'The %' THEN 1 ELSE 0 END) AS movies_beginning_with_the FROM cast_info ci INNER JOIN role_type rt ON ci.role_id = rt.id AND rt.role = 'writer' LEFT JOIN aka_title at ON ci.movie_id = at.movie_id WHERE at.kind_id = 1 AND rt.id = 11 GROUP BY rt.role;
SELECT COUNT(DISTINCT mc.movie_id) AS number_of_movies, AVG(t.production_year) AS average_production_year, cct.kind AS company_type, MIN(cn.name) AS company_name, SUM(CASE WHEN n.gender = 'M' THEN 1 ELSE 0 END) AS male_actors, SUM(CASE WHEN n.gender = 'F' THEN 1 ELSE 0 END) AS female_actors FROM movie_companies AS mc JOIN title AS t ON mc.movie_id = t.id JOIN company_name AS cn ON mc.company_id = cn.id JOIN comp_cast_type AS cct ON mc.company_type_id = cct.id LEFT JOIN name AS n ON n.md5sum = mc.note WHERE cn.country_code NOT LIKE '[pl]' AND t.production_year BETWEEN 1950 AND 1999 AND t.phonetic_code = 'D323' AND n.name_pcode_nf IN ('N6454', 'I4364', 'O2464', 'D54', 'M3526', 'G6534') GROUP BY cct.kind;
SELECT ct.kind AS company_kind, COUNT(DISTINCT mc.company_id) AS number_of_companies, AVG(CAST(mi.info AS DECIMAL)) AS average_movie_length, SUM(CASE WHEN mi.info_type_id = 1 THEN 1 ELSE 0 END) AS number_of_movies_with_specific_info, MIN(t.title) AS shortest_movie_title, MAX(t.title) AS longest_movie_title, COUNT(DISTINCT c.id) AS number_of_complete_cast_records FROM movie_companies mc JOIN company_type ct ON mc.company_type_id = ct.id JOIN movie_info mi ON mc.movie_id = mi.movie_id JOIN title t ON mi.movie_id = t.id LEFT JOIN complete_cast c ON t.id = c.movie_id WHERE ct.id = 3 GROUP BY ct.kind HAVING COUNT(DISTINCT mc.movie_id) > 5;
SELECT ct.kind AS company_type, COUNT(DISTINCT cn.name) AS number_of_companies, AVG(CAST(mi.info AS NUMERIC)) AS average_movie_budget, COUNT(DISTINCT ci.movie_id) AS number_of_movies_with_complete_cast, SUM(CASE WHEN rt.role = 'writer' THEN 1 ELSE 0 END) AS total_writers, COUNT(DISTINCT pi.person_id) AS unique_persons_involved FROM company_type ct JOIN company_name cn ON ct.id = cn.id LEFT JOIN movie_info mi ON cn.imdb_id = mi.movie_id AND mi.info_type_id = 3 LEFT JOIN complete_cast ci ON cn.imdb_id = ci.movie_id LEFT JOIN role_type rt ON ci.subject_id = rt.id LEFT JOIN person_info pi ON ci.subject_id = pi.info_type_id GROUP BY ct.kind ORDER BY number_of_companies DESC, average_movie_budget DESC;
SELECT ct.kind AS company_kind, kt.kind AS movie_kind, COUNT(mc.movie_id) AS num_movies, AVG(mi_idx.info::NUMERIC) AS average_info, SUM(CASE WHEN mi_idx.note = 'Y' THEN 1 ELSE 0 END) AS noted_count FROM movie_companies AS mc JOIN company_type AS ct ON mc.company_type_id = ct.id JOIN movie_info_idx AS mi_idx ON mc.movie_id = mi_idx.movie_id JOIN kind_type AS kt ON mi_idx.info_type_id = kt.id JOIN movie_keyword AS mk ON mc.movie_id = mk.movie_id WHERE mc.movie_id IN (8982, 14559, 8408) AND kt.id IN (6, 2, 3, 4, 5, 1) GROUP BY company_kind, movie_kind ORDER BY num_movies DESC, average_info DESC;
SELECT ct.kind AS crew_type, COUNT(DISTINCT cn.id) AS num_companies, AVG(mi_idx.id::numeric) AS average_movie_info_idx, SUM(CASE WHEN mk.keyword_id IN ('3835', '2651', '3091', '4000') THEN 1 ELSE 0 END) AS relevant_keyword_count, MIN(cn.name) AS sample_company_name, MAX(cn.country_code) AS max_country_code FROM comp_cast_type ct JOIN movie_info_idx mi_idx ON ct.id = mi_idx.info_type_id JOIN movie_keyword mk ON mi_idx.movie_id = mk.movie_id JOIN company_name cn ON cn.imdb_id = mi_idx.movie_id WHERE ct.kind = 'crew' AND mi_idx.id IN ('57', '2630') AND cn.name_pcode_nf IN ('P6431', 'U521', 'C6536') GROUP BY ct.kind;
SELECT kt.kind AS movie_kind, COUNT(DISTINCT t.id) AS total_movies, AVG(t.production_year) AS average_production_year, SUM(CASE WHEN cn.country_code = '[us]' THEN 1 ELSE 0 END) AS total_us_productions, COUNT(DISTINCT pi.person_id) AS unique_actors_info, MAX(n.name) AS latest_actor_name FROM title t JOIN kind_type kt ON t.kind_id = kt.id LEFT JOIN cast_info ci ON ci.movie_id = t.id LEFT JOIN name n ON ci.person_id = n.id LEFT JOIN person_info pi ON n.id = pi.person_id LEFT JOIN company_name cn ON cn.imdb_id = t.imdb_id WHERE kt.kind IN ('tv series', 'video movie', 'movie', 'video game') AND (cn.country_code = '[us]' OR cn.country_code IS NULL) AND n.id IN ('7106', '6832', '5625') AND pi.info_type_id IN ('34', '39', '27', '21') GROUP BY kt.kind ORDER BY total_movies DESC;
SELECT AVG(aka.production_year) AS average_production_year, COUNT(DISTINCT ci.movie_id) AS number_of_movies, SUM(mc.company_id) AS total_companies_involved, COUNT(DISTINCT aka.title) AS unique_aka_titles, COUNT(DISTINCT ci.person_id) AS number_of_cast_members, MAX(ml.link_type_id) AS highest_link_type_id FROM aka_title aka JOIN cast_info ci ON aka.movie_id = ci.movie_id JOIN movie_companies mc ON aka.movie_id = mc.movie_id JOIN movie_link ml ON aka.movie_id = ml.movie_id WHERE aka.title IS NOT NULL AND aka.production_year IS NOT NULL AND (aka.title LIKE '0....01124%' OR aka.title LIKE '...0012111%' OR aka.title LIKE '%758%') GROUP BY aka.production_year ORDER BY average_production_year DESC;
SELECT COUNT(DISTINCT n.id) as ActorCount, AVG(at.production_year) as AverageProductionYear, SUM(CASE WHEN mi.info = 'Color' THEN 1 ELSE 0 END) as ColorMoviesCount, SUM(CASE WHEN mi.info = 'Black and White' THEN 1 ELSE 0 END) as BW_MoviesCount, mi_idx.info_type_id, cn.name as MostCommonActorName FROM name n JOIN aka_title at ON n.id = at.movie_id JOIN movie_info mi ON mi.movie_id = at.movie_id JOIN movie_info_idx mi_idx ON mi_idx.movie_id = mi.movie_id JOIN char_name cn ON cn.id = n.id WHERE mi.info IN ('Korean', 'Serbo-Croatian', 'Tatar', 'Filipino', 'Icelandic') AND mi_idx.info LIKE '...11..3.3' AND at.production_year > 1990 GROUP BY mi_idx.info_type_id, cn.name ORDER BY ActorCount DESC, AverageProductionYear DESC LIMIT 10;
SELECT AVG(ak.production_year) AS average_production_year, COUNT(DISTINCT an.person_id) AS number_of_unique_persons, COUNT(DISTINCT mk.movie_id) AS number_of_movies_with_keywords, SUM(CASE WHEN ml.link_type_id = 12 THEN 1 ELSE 0 END) AS count_of_link_type_12 FROM aka_title AS ak JOIN aka_name AS an ON ak.id = an.person_id JOIN movie_keyword AS mk ON ak.movie_id = mk.movie_id JOIN movie_link AS ml ON ak.movie_id = ml.movie_id WHERE an.name_pcode_cf IN ('P54', 'A5321', 'D232', 'A1463', 'V4214', 'A235') AND ak.kind_id = (SELECT id FROM info_type WHERE info = 'movie') AND ak.production_year BETWEEN 2000 AND 2020 GROUP BY ak.kind_id;
SELECT cn.name AS company_name, COUNT(DISTINCT mc.movie_id) AS total_movies_produced, AVG(cast_count.cast_count) AS average_cast_per_movie, SUM(keyword_count.keyword_count) AS total_keywords FROM movie_companies AS mc JOIN company_name AS cn ON mc.company_id = cn.id LEFT JOIN (SELECT movie_id, COUNT(*) AS cast_count FROM cast_info GROUP BY movie_id) AS cast_count ON mc.movie_id = cast_count.movie_id LEFT JOIN (SELECT movie_id, COUNT(*) AS keyword_count FROM movie_keyword GROUP BY movie_id) AS keyword_count ON mc.movie_id = keyword_count.movie_id GROUP BY cn.name ORDER BY total_movies_produced DESC, average_cast_per_movie DESC, total_keywords DESC;
SELECT lt.LINK AS link_type, COUNT(DISTINCT ml.movie_id) AS number_of_movies, AVG(mi_idx_rank.info::FLOAT) AS average_movie_rank, COUNT(DISTINCT pi.person_id) AS number_of_people_involved, COUNT(DISTINCT mc.company_id) AS number_of_companies_involved FROM link_type AS lt JOIN movie_link AS ml ON lt.id = ml.link_type_id LEFT JOIN movie_info AS mi_idx_rank ON mi_idx_rank.movie_id = ml.movie_id AND mi_idx_rank.info_type_id = (SELECT id FROM info_type WHERE info = 'rank') LEFT JOIN movie_companies AS mc ON mc.movie_id = ml.movie_id LEFT JOIN person_info AS pi ON pi.info_type_id = (SELECT id FROM info_type WHERE info = 'biography') AND pi.info LIKE '%actor%' WHERE lt.link IN ('follows', 'edited from') AND (mc.note LIKE '(2009)%' OR mc.note LIKE '(2012)%' OR mc.note LIKE '(2000-????)%') AND ml.movie_id IN ('7361', '14633') GROUP BY lt.LINK ORDER BY average_movie_rank DESC;
SELECT it.info AS info_category, COUNT(DISTINCT pi.person_id) AS number_of_people, AVG(CASE WHEN it.info = 'gross' THEN CAST(pi.info AS NUMERIC) END) AS average_gross, SUM(CASE WHEN it.info = 'LD quality program' THEN 1 ELSE 0 END) AS LD_quality_programs FROM person_info AS pi JOIN info_type AS it ON pi.info_type_id = it.id WHERE it.id IN (22, 25, 105) GROUP BY it.info ORDER BY info_category;
SELECT lt.LINK AS link_type, COUNT(DISTINCT ml.movie_id) AS number_of_movies, AVG(t.production_year) AS average_production_year, COUNT(DISTINCT t.episode_of_id) AS number_of_series, SUM(CASE WHEN t.season_nr IS NOT NULL THEN 1 ELSE 0 END) AS total_seasons_count, SUM(CASE WHEN t.production_year > 2000 THEN 1 ELSE 0 END) AS movies_since_2001 FROM movie_link AS ml JOIN link_type AS lt ON ml.link_type_id = lt.id JOIN title AS t ON ml.movie_id = t.id WHERE t.production_year BETWEEN 1980 AND 2023 AND lt.link IN ('remade as', 'edited from', 'referenced in') GROUP BY lt.LINK ORDER BY number_of_movies DESC;
SELECT kt.kind AS movie_type, COUNT(DISTINCT mi.movie_id) AS total_movies, AVG(CASE WHEN k.keyword = 'drama' THEN 1.0 ELSE 0 END) AS avg_drama_keyword, SUM(CASE WHEN k.keyword = 'comedy' THEN 1 ELSE 0 END) AS total_comedy_keyword, COUNT(DISTINCT a.person_id) AS unique_actors FROM movie_info mi JOIN kind_type kt ON mi.movie_id = kt.id LEFT JOIN movie_keyword mk ON mi.movie_id = mk.movie_id LEFT JOIN keyword k ON mk.keyword_id = k.id LEFT JOIN aka_name a ON mi.movie_id = a.person_id WHERE k.id IN ('7626', '7498') AND kt.id IN ('6', '7', '4', '3', '5') AND mi.id IN ('7266975', '7266320', '7271067', '7270758', '7267432') GROUP BY kt.kind;
SELECT AVG(mi.id) AS average_movie_info_id, COUNT(DISTINCT mk.movie_id) AS count_distinct_movies, SUM(mk.keyword_id) AS sum_keyword_ids, COUNT(DISTINCT cn.id) AS count_distinct_character_names, MAX(ct.kind) AS max_comp_cast_type_kind FROM movie_info mi JOIN movie_keyword mk ON mi.movie_id = mk.movie_id JOIN char_name cn ON cn.id = mk.id JOIN comp_cast_type ct ON ct.id = cn.id WHERE mi.info IN ('French', 'Macedonian', 'Tatar') AND mk.movie_id IN ('12263', '18845') AND mi.id IN ('7268883', '7269557', '7270084') GROUP BY mi.info;
SELECT kt.kind AS movie_type, AVG(a.production_year) AS average_production_year, COUNT(DISTINCT mk.movie_id) AS movie_count, SUM(mi.info::integer) AS total_info_numeric, COUNT(DISTINCT c.person_id) AS unique_actors_count FROM aka_title a JOIN kind_type kt ON a.kind_id = kt.id JOIN movie_info_idx mi ON a.movie_id = mi.movie_id JOIN movie_keyword mk ON a.movie_id = mk.movie_id JOIN cast_info c ON a.movie_id = c.movie_id WHERE a.production_year BETWEEN 1990 AND 2000 AND mk.keyword_id IN (780, 3464, 2349, 1994, 1285, 705) AND mi.movie_id IN (13634, 18372, 13503, 18944, 19411, 8878) AND mi.info SIMILAR TO '[0-9]+' AND c.role_id = 1 GROUP BY kt.kind ORDER BY movie_count DESC;
SELECT AVG(CAST(mi.info AS NUMERIC)) AS average_rating, COUNT(DISTINCT ci.movie_id) AS number_of_movies, SUM(CASE WHEN k.keyword = 'sugar' THEN 1 ELSE 0 END) AS sugar_keyword_count, SUM(CASE WHEN k.keyword = 'chair' THEN 1 ELSE 0 END) AS chair_keyword_count, COUNT(DISTINCT akn.person_id) AS unique_actors_with_alternate_names, MAX(mi.note) AS longest_note FROM movie_info mi JOIN info_type it ON mi.info_type_id = it.id AND it.info = 'rating' JOIN cast_info ci ON mi.movie_id = ci.movie_id JOIN movie_keyword mk ON ci.movie_id = mk.movie_id JOIN keyword k ON mk.keyword_id = k.id AND k.id IN ('5046', '3865') LEFT JOIN aka_name akn ON ci.person_id = akn.person_id WHERE mi.movie_id IN (SELECT movie_id FROM movie_keyword WHERE keyword_id IN ('5046', '3865')) GROUP BY it.info;
SELECT rt.ROLE AS Role, COUNT(distinct ci.person_id) AS Number_Of_Actors, AVG(ci.nr_order) AS Average_Billing_Position, SUM(CASE WHEN n.gender = 'M' THEN 1 ELSE 0 END) AS Male_Actors, SUM(CASE WHEN n.gender = 'F' THEN 1 ELSE 0 END) AS Female_Actors, MIN(aka.production_year) AS Earliest_Film_Year, MAX(aka.production_year) AS Latest_Film_Year, COUNT(distinct mk.movie_id) AS Number_Of_Movies_With_Keywords, AVG(pi.info_type_id::integer) AS Average_Info_Type_Id FROM cast_info ci JOIN name n ON ci.person_id = n.id JOIN role_type rt ON ci.role_id = rt.id LEFT JOIN aka_title aka ON ci.movie_id = aka.movie_id LEFT JOIN movie_keyword mk ON ci.movie_id = mk.movie_id LEFT JOIN person_info pi ON n.id = pi.person_id WHERE (aka.title = 'Abduction - Riprenditi la tua vita' OR aka.title = 'Mala wielka milosc' OR aka.title = 'Great Performances: On the Town in Concert' OR aka.title = 'æÁÂÒÉËÉ Ú×ÅÚÄ. ÷ÏÚ×ÒÁÝÅÎÉÅ' OR aka.title = 'Zavoevanie ameriki') AND pi.info_type_id IN ('37', '20', '28', '32', '25') AND ci.nr_order = 93 GROUP BY rt.ROLE;
