SELECT it.info AS information_type, COUNT(DISTINCT ml.movie_id) AS number_of_movies, COUNT(DISTINCT ml.linked_movie_id) AS number_of_linked_movies, AVG(n.imdb_id) AS average_imdb_id, MAX(k.keyword) AS most_common_keyword, SUM(CASE WHEN n.gender = 'F' THEN 1 ELSE 0 END) AS female_count, SUM(CASE WHEN n.gender = 'M' THEN 1 ELSE 0 END) AS male_count FROM movie_link AS ml JOIN info_type AS it ON ml.link_type_id = it.id JOIN name AS n ON ml.movie_id = n.id JOIN keyword AS k ON k.id = ml.id WHERE ml.link_type_id = 9 AND k.phonetic_code IN ('I4243', 'B43', 'D63', 'B4523', 'T521') AND ml.linked_movie_id IN (2406273, 1737708, 1377064) GROUP BY it.info;
SELECT kt.kind AS kind_of_movie, AVG(mi_idx.info::NUMERIC) AS average_rating, COUNT(DISTINCT t.id) AS number_of_movies, SUM(CASE WHEN mi.info = 'color' THEN 1 ELSE 0 END) AS number_of_color_movies, SUM(CASE WHEN mi.info = 'black and white' THEN 1 ELSE 0 END) AS number_of_black_and_white_movies, COUNT(DISTINCT mk.keyword_id) AS number_of_unique_keywords FROM title AS t JOIN kind_type AS kt ON t.kind_id = kt.id JOIN movie_info AS mi ON t.id = mi.movie_id JOIN movie_info_idx AS mi_idx ON t.id = mi_idx.movie_id JOIN movie_keyword AS mk ON t.id = mk.movie_id WHERE t.production_year IN (1976, 1989, 1952, 1990, 1959, 1967) AND mi.info_type_id IN (SELECT id FROM info_type WHERE info IN ('color', 'black and white')) AND mi_idx.info_type_id = (SELECT id FROM info_type WHERE info = 'rating') GROUP BY kt.kind ORDER BY average_rating DESC;
SELECT cn.name AS company_name, ct.kind AS company_kind, COUNT(DISTINCT mc.movie_id) AS total_movies_produced, AVG(mk.keyword_count) AS average_keywords_per_movie, MAX(mi.info) AS most_common_language FROM company_name cn JOIN movie_companies mc ON mc.company_id = cn.id JOIN company_type ct ON mc.company_type_id = ct.id AND ct.kind IN ('production companies', 'special effects companies') JOIN (SELECT movie_id, COUNT(keyword_id) AS keyword_count FROM movie_keyword GROUP BY movie_id) mk ON mk.movie_id = mc.movie_id JOIN (SELECT movie_id, info FROM movie_info WHERE info_type_id = 4 AND info IN ('Slovak', 'Gujarati', 'Czech') ) mi ON mi.movie_id = mc.movie_id GROUP BY cn.name, ct.kind ORDER BY total_movies_produced DESC, average_keywords_per_movie DESC;
SELECT ct.kind AS company_type, AVG(akat.production_year) AS average_production_year, SUM(CASE WHEN akat.kind_id = 1 THEN 1 ELSE 0 END) AS total_movies, SUM(CASE WHEN akat.kind_id = 2 THEN 1 ELSE 0 END) AS total_tv_shows, COUNT(DISTINCT mk.keyword_id) AS unique_keywords_used, COUNT(DISTINCT ml.link_type_id) AS distinct_link_types FROM movie_companies AS mc JOIN company_type AS ct ON mc.company_type_id = ct.id JOIN aka_title AS akat ON mc.movie_id = akat.movie_id JOIN movie_keyword AS mk ON akat.movie_id = mk.movie_id JOIN movie_link AS ml ON akat.movie_id = ml.movie_id WHERE mc.note IS NOT NULL AND akat.production_year BETWEEN 2000 AND 2010 AND ml.id IN ('434', '4988', '3490', '3087', '1401', '4759') GROUP BY ct.kind ORDER BY average_production_year DESC;
SELECT ct.kind AS company_type, cn.country_code, COUNT(DISTINCT k.id) AS unique_keywords_count, COUNT(DISTINCT t.id) AS total_movies, SUM(CASE WHEN t.production_year > 2000 THEN 1 ELSE 0 END) AS movies_after_2000 FROM company_name cn JOIN company_type ct ON cn.id = ct.id JOIN title t ON t.production_year IS NOT NULL JOIN movie_keyword mk ON t.id = mk.movie_id JOIN keyword k ON mk.keyword_id = k.id WHERE cn.country_code != 'US' AND k.keyword IN ('high-powered-gun', 'airforce', 'harpoon', 'creek') AND t.kind_id != 1 GROUP BY ct.kind, cn.country_code ORDER BY total_movies DESC;
SELECT cn.name AS company_name, COUNT(DISTINCT mi_idx.movie_id) AS number_of_movies, AVG(CAST(mi_idx.info AS NUMERIC)) AS average_runtime, SUM(CASE WHEN it.info = 'locations' THEN 1 ELSE 0 END) AS total_locations, COUNT(DISTINCT mk.keyword_id) AS unique_keywords, COUNT(DISTINCT cc.movie_id) AS complete_cast_movies FROM movie_info_idx AS mi_idx JOIN info_type AS it ON mi_idx.info_type_id = it.id JOIN movie_keyword AS mk ON mi_idx.movie_id = mk.movie_id JOIN complete_cast AS cc ON mi_idx.movie_id = cc.movie_id JOIN company_name AS cn ON cn.imdb_id = mi_idx.movie_id WHERE it.info IN ('runtimes', 'locations') AND cn.name_pcode_nf = 'G2642' GROUP BY cn.name ORDER BY average_runtime DESC, number_of_movies DESC;
SELECT k.keyword, AVG(at.production_year) AS avg_production_year, COUNT(DISTINCT at.movie_id) AS total_movies, COUNT(DISTINCT at.kind_id) AS different_kinds FROM keyword AS k JOIN movie_info AS mi ON mi.info LIKE '%' || k.keyword || '%' JOIN aka_title AS at ON at.movie_id = mi.movie_id WHERE k.keyword IN ('stewardess', 'lost-film', 'reality', 'honeymoon', 'murder-mystery') AND at.note LIKE '%lost film%' GROUP BY k.keyword;
SELECT ct.kind AS company_type, AVG(t.production_year) AS average_production_year, COUNT(DISTINCT mk.keyword_id) AS unique_keyword_count, SUM(CASE WHEN an.name_pcode_cf LIKE 'A%' THEN 1 ELSE 0 END) AS names_starting_with_a, COUNT(DISTINCT an.person_id) AS total_actors_with_alternate_names FROM title AS t JOIN movie_keyword AS mk ON t.id = mk.movie_id JOIN aka_name AS an ON an.person_id = t.id JOIN company_type AS ct ON ct.id = t.kind_id WHERE t.production_year > 2000 AND mk.keyword_id IN (4192, 3543, 917, 3554) AND an.name_pcode_cf IN ('K365', 'J262', 'C4625', 'A1526') GROUP BY ct.kind ORDER BY average_production_year DESC;
SELECT kt.kind AS movie_kind, COUNT(DISTINCT ml.movie_id) AS number_of_movies, COUNT(DISTINCT ml.linked_movie_id) AS number_of_linked_movies, LT.LINK AS link_type, AVG(pi.person_id) AS average_person_id, SUM(CASE WHEN mk.keyword_id = '3986' THEN 1 ELSE 0 END) AS count_of_keyword_3986, SUM(CASE WHEN mk.keyword_id = '3808' THEN 1 ELSE 0 END) AS count_of_keyword_3808, SUM(CASE WHEN mk.keyword_id = '4322' THEN 1 ELSE 0 END) AS count_of_keyword_4322 FROM movie_link AS ml JOIN link_type AS LT ON ml.link_type_id = LT.id JOIN kind_type AS kt ON kt.id IN ('6', '5') JOIN movie_keyword AS mk ON mk.movie_id = ml.movie_id LEFT JOIN person_info AS pi ON pi.person_id = ml.movie_id AND pi.info_type_id = mk.keyword_id WHERE mk.movie_id = '8874' AND LT.link IN ('features', 'referenced in', 'spin off', 'edited from', 'remade as', 'unknown link') GROUP BY kt.kind, LT.LINK;
SELECT rt.ROLE, ct.kind, AVG(cast(chn.imdb_id as numeric)) AS avg_imdb_id, COUNT(chn.id) AS num_characters, SUM(chn.imdb_id) AS sum_imdb_id FROM char_name AS chn JOIN role_type AS rt ON chn.id = rt.id JOIN company_type AS ct ON rt.id = ct.id WHERE rt.ROLE = 'miscellaneous crew' AND ct.kind IN ('miscellaneous companies', 'special effects companies') GROUP BY rt.ROLE, ct.kind;
SELECT AVG(ak.production_year) AS average_production_year, COUNT(DISTINCT ak.id) AS total_alternate_titles, SUM(mc.company_type_id) AS total_company_types, COUNT(DISTINCT pi.person_id) AS total_persons_with_info, COUNT(DISTINCT kc.id) AS total_keywords_used, kt.LINK as link_type FROM aka_title ak JOIN movie_companies mc ON ak.movie_id = mc.movie_id JOIN person_info pi ON ak.movie_id = pi.person_id JOIN keyword kc ON ak.movie_id = kc.id JOIN link_type kt ON kt.id = mc.company_type_id WHERE ak.production_year > 2000 AND kt.LINK IN ('spoofs', 'remake of') AND mc.note IS NOT NULL AND pi.info_type_id BETWEEN 1 AND 5 GROUP BY kt.LINK ORDER BY average_production_year DESC;
SELECT k.keyword, COUNT(DISTINCT ci.movie_id) AS movie_count, AVG(a.production_year) AS avg_production_year, COUNT(DISTINCT ci.person_id) AS actor_count, SUM(CASE WHEN ci.role_id = 1 THEN 1 ELSE 0 END) AS lead_roles, SUM(CASE WHEN ci.role_id = 2 THEN 1 ELSE 0 END) AS supporting_roles FROM keyword k JOIN cast_info ci ON ci.movie_id = k.id JOIN aka_title a ON a.movie_id = ci.movie_id WHERE k.id IN (9469, 4548, 8976, 5594, 8711) GROUP BY k.keyword ORDER BY movie_count DESC, avg_production_year DESC;
SELECT kt.kind AS movie_type, AVG(a.production_year) AS average_production_year, COUNT(DISTINCT mk.movie_id) AS movie_count, SUM(mi.info::integer) AS total_info_numeric, COUNT(DISTINCT c.person_id) AS unique_actors_count FROM aka_title a JOIN kind_type kt ON a.kind_id = kt.id JOIN movie_info_idx mi ON a.movie_id = mi.movie_id JOIN movie_keyword mk ON a.movie_id = mk.movie_id JOIN cast_info c ON a.movie_id = c.movie_id WHERE a.production_year BETWEEN 1990 AND 2000 AND mk.keyword_id IN (780, 3464, 2349, 1994, 1285, 705) AND mi.movie_id IN (13634, 18372, 13503, 18944, 19411, 8878) AND mi.info SIMILAR TO '[0-9]+' AND c.role_id = 1 GROUP BY kt.kind ORDER BY movie_count DESC;
SELECT ct.kind AS company_kind, kt.kind AS movie_kind, AVG(ci.nr_order) AS average_cast_nr_order, COUNT(DISTINCT ci.person_id) AS total_unique_actors, COUNT(DISTINCT mc.movie_id) AS total_movies, SUM(CASE WHEN it.info = 'languages' THEN 1 ELSE 0 END) AS total_movies_with_languages_info FROM cast_info ci JOIN movie_companies mc ON ci.movie_id = mc.movie_id JOIN company_type ct ON mc.company_type_id = ct.id JOIN kind_type kt ON ci.role_id = kt.id JOIN info_type it ON ci.person_role_id = it.id WHERE ci.nr_order IN (35, 54, 23, 1) AND mc.movie_id IN (1542488, 1515644, 1097704) AND kt.id IN (3, 4, 2, 1) AND it.info IN ('taglines', 'languages', 'pictorial') GROUP BY company_kind, movie_kind;
SELECT COUNT(DISTINCT cn.id) AS total_companies, COUNT(DISTINCT ci.person_id) AS total_cast_members, AVG(ci.nr_order) AS average_cast_order, COUNT(DISTINCT mk.movie_id) AS total_movies_with_keywords, SUM(CASE WHEN k.keyword = 'contest' THEN 1 ELSE 0 END) AS total_contest_keyword, SUM(CASE WHEN k.keyword = 'shield' THEN 1 ELSE 0 END) AS total_shield_keyword FROM company_name cn JOIN company_type ct ON cn.id = ct.id JOIN cast_info ci ON ci.person_id = cn.id JOIN movie_keyword mk ON mk.movie_id = ci.movie_id JOIN keyword k ON k.id = mk.keyword_id WHERE k.phonetic_code IN ('P2353', 'C2535', 'P6215') AND mk.keyword_id IN ('1071', '3527', '3569', '2390');
SELECT mc.company_id, mc.company_type_id, COUNT(mc.movie_id) AS total_movies, AVG(at.production_year) AS avg_production_year, SUM(k.id) AS total_keyword_id_sum FROM movie_companies mc JOIN aka_title at ON mc.movie_id = at.movie_id LEFT JOIN keyword k ON at.id = k.id WHERE mc.movie_id IN (19080, 25456, 14762, 19670, 32217, 10568) GROUP BY mc.company_id, mc.company_type_id ORDER BY total_movies DESC, avg_production_year DESC;
SELECT rt.ROLE, COUNT(DISTINCT n.id) AS total_actors, AVG(t.production_year) AS average_production_year, SUM(CASE WHEN n.gender = 'F' THEN 1 ELSE 0 END) AS female_actors_count, SUM(CASE WHEN n.gender = 'M' THEN 1 ELSE 0 END) AS male_actors_count, COUNT(DISTINCT t.id) AS total_movies, COUNT(DISTINCT k.id) AS total_keywords FROM name n JOIN person_info pi ON n.id = pi.person_id JOIN movie_info_idx mii ON pi.info_type_id = mii.info_type_id JOIN role_type rt ON pi.info_type_id = rt.id JOIN title t ON mii.movie_id = t.id LEFT JOIN keyword k ON k.phonetic_code = t.phonetic_code WHERE mii.info IN ('856', '1..11...15') AND t.production_year BETWEEN 2000 AND 2020 GROUP BY rt.ROLE;
SELECT kt.kind as movie_type, COUNT(DISTINCT mk.movie_id) as number_of_movies, COUNT(DISTINCT k.id) as number_of_unique_keywords, STRING_AGG(DISTINCT k.keyword, ', ') as keywords_list FROM kind_type kt JOIN movie_keyword mk ON kt.id = mk.movie_id JOIN keyword k ON mk.keyword_id = k.id JOIN movie_info mi ON mk.movie_id = mi.movie_id WHERE kt.kind = 'movie' AND mk.id IN ('3186', '2034', '2102', '2766', '2505', '305') GROUP BY kt.kind ORDER BY number_of_movies DESC;
SELECT COUNT(DISTINCT n.id) as ActorCount, AVG(at.production_year) as AverageProductionYear, SUM(CASE WHEN mi.info = 'Color' THEN 1 ELSE 0 END) as ColorMoviesCount, SUM(CASE WHEN mi.info = 'Black and White' THEN 1 ELSE 0 END) as BW_MoviesCount, mi_idx.info_type_id, cn.name as MostCommonActorName FROM name n JOIN aka_title at ON n.id = at.movie_id JOIN movie_info mi ON mi.movie_id = at.movie_id JOIN movie_info_idx mi_idx ON mi_idx.movie_id = mi.movie_id JOIN char_name cn ON cn.id = n.id WHERE mi.info IN ('Korean', 'Serbo-Croatian', 'Tatar', 'Filipino', 'Icelandic') AND mi_idx.info LIKE '...11..3.3' AND at.production_year > 1990 GROUP BY mi_idx.info_type_id, cn.name ORDER BY ActorCount DESC, AverageProductionYear DESC LIMIT 10;
SELECT MAX(cn.name) AS company_name, ct.kind AS company_kind, COUNT(DISTINCT cn.id) AS num_companies, AVG(cn.imdb_id) AS average_imdb_id, COUNT(DISTINCT cct.id) AS cast_type_count, SUM(CASE WHEN cn.country_code = 'US' THEN 1 ELSE 0 END) AS us_based_companies, COUNT(DISTINCT it.id) AS info_type_count, COUNT(DISTINCT lt.id) AS link_type_count FROM company_name cn JOIN company_type ct ON cn.id = ct.id JOIN comp_cast_type cct ON cn.id = cct.id JOIN info_type it ON cn.id = it.id JOIN link_type lt ON cn.id = lt.id WHERE cn.country_code IN ('US', 'JP', 'FR') AND cn.name_pcode_sf IN ('M3652', 'A6163', 'L2641', 'D6123') AND ct.id IN (1, 2, 3, 4) AND ct.kind IN ('special effects companies', 'miscellaneous companies', 'production companies', 'distributors') GROUP BY ct.kind ORDER BY us_based_companies DESC, num_companies DESC;
SELECT kt.kind, COUNT(DISTINCT cc.movie_id) AS number_of_movies, AVG(CAST(mi_idx.info AS NUMERIC)) AS average_movie_info, SUM(CASE WHEN mi_idx.note = 'Y' THEN 1 ELSE 0 END) AS count_noted_info FROM complete_cast cc JOIN kind_type kt ON cc.subject_id = kt.id JOIN movie_info_idx mi_idx ON cc.movie_id = mi_idx.movie_id WHERE cc.status_id IN (1, 2, 3) AND mi_idx.info_type_id BETWEEN 10 AND 20 AND mi_idx.id NOT IN (4072, 3466, 2096, 1652, 1371) AND cc.id NOT IN (3672, 620) GROUP BY kt.kind HAVING COUNT(DISTINCT cc.movie_id) > 5 ORDER BY average_movie_info DESC;
SELECT rt.ROLE, COUNT(DISTINCT ci.movie_id) AS number_of_movies, AVG(ci.nr_order) AS average_role_order, SUM(CASE WHEN cn.surname_pcode = 'G3143' THEN 1 ELSE 0 END) AS count_surname_G3143_roles, it.info AS information_type, COUNT(DISTINCT ci.person_id) AS number_of_persons FROM cast_info ci JOIN role_type rt ON ci.role_id = rt.id JOIN char_name cn ON ci.person_role_id = cn.id JOIN info_type it ON cn.imdb_id = it.id WHERE ci.person_id IN (1663, 1868, 1050, 1120) AND ci.person_role_id IN (538, 1342, 1444, 1143, 1039) AND rt.id IN (5, 3, 1, 11) GROUP BY rt.ROLE, it.info ORDER BY number_of_movies DESC, average_role_order;
SELECT COUNT(DISTINCT cn.id) AS num_companies, AVG(t.production_year) AS avg_production_year, SUM(CASE WHEN rt.ROLE = 'actor' THEN 1 ELSE 0 END) AS total_actor_roles, SUM(CASE WHEN rt.ROLE = 'actress' THEN 1 ELSE 0 END) AS total_actress_roles, COUNT(DISTINCT n.id) AS num_actors, COUNT(DISTINCT t.id) AS num_titles FROM name AS n JOIN char_name AS chn ON n.name_pcode_nf = chn.name_pcode_nf JOIN role_type AS rt ON n.id = chn.id JOIN title AS t ON t.phonetic_code IN ('A1265', 'M3151', 'R5434') JOIN movie_companies AS mc ON mc.movie_id = t.id JOIN company_name AS cn ON cn.id = mc.company_id WHERE t.production_year BETWEEN 1990 AND 2000 AND chn.md5sum IN ('c8d3a477c4092e8d35d54ee4e2a854a7', '7887e4403fb219782fde01f150e22f05', 'b90077cfb2486002f9581b5cd2a1a04b', 'b6658816fc7029718e649600b2cc328e') GROUP BY t.production_year;
