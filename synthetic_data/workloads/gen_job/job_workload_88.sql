SELECT ct.kind AS company_kind, COUNT(DISTINCT t.id) AS number_of_movies, AVG(t.production_year) AS average_production_year, COUNT(DISTINCT cc.subject_id) AS number_of_subjects, SUM(CASE WHEN t.kind_id = 1 THEN 1 ELSE 0 END) AS number_of_feature_films, SUM(CASE WHEN t.kind_id = 2 THEN 1 ELSE 0 END) AS number_of_tv_shows, SUM(CASE WHEN t.kind_id = 4 THEN 1 ELSE 0 END) AS number_of_documentaries FROM title t JOIN complete_cast cc ON t.id = cc.movie_id JOIN company_type ct ON t.kind_id = ct.id GROUP BY ct.kind ORDER BY number_of_movies DESC;
SELECT cct.kind AS cast_type, AVG(t.production_year) AS average_production_year, COUNT(DISTINCT k.id) AS unique_keywords_count, SUM(CASE WHEN t.kind_id = cct.id AND cct.kind = 'complete+verified' THEN 1 ELSE 0 END) AS total_complete_verified_titles, COUNT(*) AS total_titles FROM title t LEFT JOIN comp_cast_type cct ON t.kind_id = cct.id LEFT JOIN keyword k ON k.phonetic_code = t.phonetic_code GROUP BY cct.kind ORDER BY total_complete_verified_titles DESC;
SELECT ct.kind AS company_type, AVG(at.production_year) AS average_production_year, COUNT(DISTINCT k.id) AS number_of_keywords, SUM(CASE WHEN at.episode_of_id IS NOT NULL THEN 1 ELSE 0 END) AS number_of_episodes, COUNT(DISTINCT n.id) AS number_of_names, COUNT(DISTINCT cc.id) AS number_of_complete_cast_records FROM movie_companies AS mc JOIN company_type AS ct ON mc.company_type_id = ct.id JOIN aka_title AS at ON mc.movie_id = at.movie_id JOIN complete_cast AS cc ON at.movie_id = cc.movie_id JOIN keyword AS k ON at.id = k.id JOIN name AS n ON at.id = n.id WHERE mc.note LIKE '%(TV)%' AND at.production_year > 1990 AND (at.episode_nr IN (37, 566, 13, 606, 41) OR at.episode_of_id IN (12586, 2536, 13063, 16867, 21471)) GROUP BY ct.kind;
SELECT ct.kind AS company_type, AVG(kw.id) AS average_keyword_id, COUNT(DISTINCT mc.movie_id) AS total_movies, SUM(mc.company_id) AS sum_company_id FROM movie_companies mc JOIN company_type ct ON mc.company_type_id = ct.id JOIN movie_link ml ON mc.movie_id = ml.movie_id JOIN keyword kw ON CAST(ml.link_type_id AS INTEGER) = kw.id JOIN name n ON mc.movie_id = n.id WHERE n.gender = 'm' AND kw.keyword IN ('Black Rick', 'Joel Gonzalez', 'TNI Soldier', 'ESPN', 'Newsroom Martian') GROUP BY ct.kind ORDER BY total_movies DESC, average_keyword_id;
SELECT it.info AS cast_completeness, COUNT(DISTINCT cc.movie_id) AS number_of_movies, AVG(ci.person_count) AS average_roles_per_person FROM (SELECT movie_id, COUNT(DISTINCT person_id) AS person_count FROM cast_info GROUP BY movie_id) ci JOIN complete_cast cc ON ci.movie_id = cc.movie_id JOIN info_type it ON cc.status_id = it.id GROUP BY it.info;
SELECT t.title AS original_title, COUNT(DISTINCT at.id) AS number_of_alternative_titles, AVG(CAST(mi_idx.info AS INTEGER)) AS average_movie_rating, SUM(CASE WHEN mc.company_type_id = 1 THEN 1 ELSE 0 END) AS number_of_production_companies, SUM(CASE WHEN mc.company_type_id = 2 THEN 1 ELSE 0 END) AS number_of_distribution_companies, COUNT(DISTINCT n.id) AS number_of_unique_actors FROM title t LEFT JOIN aka_title at ON t.id = at.movie_id LEFT JOIN movie_info_idx mi_idx ON t.id = mi_idx.movie_id AND mi_idx.info_type_id = 100 LEFT JOIN movie_companies mc ON t.id = mc.movie_id LEFT JOIN name n ON n.id IN ('7238', '8193', '11843', '6809', '6894', '6651') LEFT JOIN movie_info mi ON t.id = mi.movie_id AND mi.info_type_id = 3 WHERE t.production_year BETWEEN 1990 AND 2000 AND n.id IS NOT NULL AND mi.note IS NOT NULL GROUP BY t.title ORDER BY average_movie_rating DESC LIMIT 10;
SELECT t.kind_id, COUNT(DISTINCT t.id) AS total_titles, AVG(t.production_year) AS average_production_year, SUM(CASE WHEN lt.link = 'featured in' THEN 1 ELSE 0 END) AS featured_in_count, SUM(CASE WHEN lt.link = 'references' THEN 1 ELSE 0 END) AS references_count, SUM(CASE WHEN lt.link = 'spoofed in' THEN 1 ELSE 0 END) AS spoofed_in_count, SUM(CASE WHEN lt.link = 'similar to' THEN 1 ELSE 0 END) AS similar_to_count, SUM(CASE WHEN lt.link = 'features' THEN 1 ELSE 0 END) AS features_count, SUM(CASE WHEN lt.link = 'followed by' THEN 1 ELSE 0 END) AS followed_by_count, COUNT(DISTINCT pi.person_id) AS unique_persons_involved, AVG(CASE WHEN pi.info_type_id = 1 THEN CAST(pi.info AS INTEGER) END) AS average_info_type_1, COUNT(DISTINCT CASE WHEN pi.note IS NOT NULL THEN pi.person_id END) AS count_persons_with_notes FROM title AS t JOIN link_type AS lt ON t.kind_id = lt.id LEFT JOIN person_info AS pi ON t.id = pi.person_id GROUP BY t.kind_id ORDER BY total_titles DESC;
SELECT kt.kind, lt.link, COUNT(DISTINCT mi.movie_id) AS num_movies, AVG(n.imdb_id) AS avg_imdb_id, SUM(CASE WHEN mi.info = 'French' THEN 1 ELSE 0 END) AS num_french_movies, SUM(CASE WHEN mi.note = '(none)' THEN 1 ELSE 0 END) AS num_movies_without_notes, COUNT(DISTINCT c.name) FILTER (WHERE c.surname_pcode = 'M6456') AS count_characters_with_surname_pcode_M6456 FROM movie_info mi JOIN kind_type kt ON mi.movie_id = kt.id JOIN link_type lt ON lt.id = mi.info_type_id LEFT JOIN movie_info_idx mii ON mii.movie_id = mi.movie_id AND mii.info_type_id = mi.info_type_id LEFT JOIN char_name c ON c.id = mii.info_type_id LEFT JOIN name n ON n.id = c.id WHERE lt.id IN ('4', '6', '9', '1', '14') AND mi.info IN ('Albanian', 'Catalan', 'French', 'Danish') GROUP BY kt.kind, lt.link ORDER BY num_movies DESC, avg_imdb_id;
SELECT kt.kind AS movie_kind, AVG(CAST(pi.info AS NUMERIC)) AS average_budget, SUM(CASE WHEN mc.company_type_id = '1' THEN 1 ELSE 0 END) AS number_of_producers, COUNT(DISTINCT k.id) AS number_of_unique_keywords FROM movie_companies AS mc JOIN kind_type AS kt ON mc.company_type_id = kt.id JOIN person_info AS pi ON mc.movie_id = pi.person_id JOIN keyword AS k ON k.phonetic_code IN ('N3642', 'I', 'N3', 'B6245', 'S5324', 'C6361') WHERE pi.info_type_id = (SELECT id FROM info_type WHERE info = 'budget') GROUP BY kt.kind;
SELECT ct.kind AS company_type, COUNT(DISTINCT cc.movie_id) AS total_movies, COUNT(DISTINCT ml.movie_id) AS total_linked_movies, AVG(CAST(mi.info AS NUMERIC)) FILTER (WHERE it.info = 'budget') AS average_movie_budget, SUM(CAST(mi.info AS INTEGER)) FILTER (WHERE it.info = 'votes') AS total_movie_votes FROM company_type ct JOIN movie_companies mc ON mc.company_type_id = ct.id JOIN complete_cast cc ON cc.movie_id = mc.movie_id JOIN movie_link ml ON ml.movie_id = mc.movie_id JOIN movie_info mi ON mi.movie_id = mc.movie_id JOIN info_type it ON it.id = mi.info_type_id WHERE ct.kind IN ('distributors', 'special effects companies', 'production companies') AND cc.status_id IN (3, 4) AND mi.movie_id IN ('932270', '939910') AND mi.info IN ('Gujarati', 'Tagalog', 'French', 'Portuguese') GROUP BY ct.kind ORDER BY total_movies DESC, average_movie_budget DESC;
SELECT kt.kind AS movie_kind, COUNT(DISTINCT at.id) AS total_alternate_titles, AVG(at.production_year) AS average_production_year, SUM(CASE WHEN at.kind_id = 1 THEN 1 ELSE 0 END) AS total_movies, SUM(CASE WHEN at.kind_id = 7 THEN 1 ELSE 0 END) AS total_series, COUNT(DISTINCT mi.movie_id) AS total_movies_with_info, COUNT(DISTINCT pi.person_id) AS total_persons_with_info, COUNT(DISTINCT cn.id) AS total_companies, MAX(at.production_year) AS latest_production_year, MIN(at.production_year) AS earliest_production_year FROM aka_title at LEFT JOIN kind_type kt ON at.kind_id = kt.id LEFT JOIN movie_info mi ON at.movie_id = mi.movie_id LEFT JOIN person_info pi ON mi.movie_id = pi.person_id LEFT JOIN company_name cn ON mi.movie_id = cn.imdb_id GROUP BY kt.kind ORDER BY total_alternate_titles DESC;
SELECT t.title, kt.kind, COUNT(DISTINCT cn.id) AS total_characters, COUNT(DISTINCT comp_n.id) AS total_companies, AVG(t.production_year) AS average_production_year, MAX(it.info) AS most_frequent_info FROM title t JOIN kind_type kt ON t.kind_id = kt.id LEFT JOIN movie_info_idx mii ON t.id = mii.movie_id LEFT JOIN info_type it ON mii.info_type_id = it.id LEFT JOIN char_name cn ON t.id = cn.id LEFT JOIN company_name comp_n ON t.id = comp_n.id GROUP BY t.title, kt.kind ORDER BY total_characters DESC, total_companies DESC;
SELECT COUNT(DISTINCT cn.id) AS character_count, COUNT(DISTINCT mc.movie_id) AS movie_count, COUNT(DISTINCT mc.company_id) AS company_count, AVG(kw.id) AS average_keyword_id, SUM(mc.company_type_id) AS total_company_types FROM char_name AS cn INNER JOIN movie_companies AS mc ON cn.id = mc.company_id INNER JOIN keyword AS kw ON kw.id = mc.movie_id GROUP BY mc.company_type_id ORDER BY character_count DESC, movie_count DESC;
SELECT kt.kind AS movie_kind, COUNT(DISTINCT mc.movie_id) AS number_of_movies, AVG(CAST(mc.company_id AS NUMERIC)) AS average_company_id, SUM(kw.keyword_id) AS total_keyword_usage FROM kind_type kt JOIN movie_companies mc ON kt.id = mc.company_type_id JOIN movie_keyword kw ON mc.movie_id = kw.movie_id GROUP BY kt.kind ORDER BY number_of_movies DESC;
SELECT kt.kind, COUNT(DISTINCT cn.id) AS total_characters, AVG(cn.imdb_id) AS average_imdb_id, COUNT(DISTINCT mi.info) AS distinct_info_count FROM kind_type AS kt LEFT JOIN movie_info_idx AS mi ON mi.info_type_id = kt.id LEFT JOIN char_name AS cn ON cn.imdb_id = mi.movie_id GROUP BY kt.kind ORDER BY total_characters DESC;
SELECT rt.ROLE, COUNT(DISTINCT cn.id) AS number_of_characters, AVG(cn.imdb_id) AS average_imdb_id, COUNT(DISTINCT mc.company_id) AS number_of_companies_involved, SUM(CASE WHEN mc.note LIKE '%(TV)' THEN 1 ELSE 0 END) AS tv_releases_count, SUM(CASE WHEN mc.note LIKE '%(worldwide)%' THEN 1 ELSE 0 END) AS worldwide_releases_count FROM role_type rt JOIN char_name cn ON cn.id = rt.id JOIN movie_companies mc ON mc.movie_id = cn.id GROUP BY rt.ROLE ORDER BY number_of_characters DESC, number_of_companies_involved DESC;
SELECT kt.kind, COUNT(DISTINCT cc.movie_id) AS total_movies_with_complete_cast, AVG(mc.company_id) AS average_company_id, SUM(ml.linked_movie_id) AS total_linked_movie_ids FROM complete_cast cc JOIN kind_type kt ON cc.subject_id = kt.id JOIN movie_companies mc ON cc.movie_id = mc.movie_id JOIN movie_link ml ON cc.movie_id = ml.movie_id WHERE cc.status_id IN (1, 2) AND kt.id IN (1, 2, 5, 3) AND mc.id IN (2678, 1671, 621, 430) AND ml.movie_id IN (20571, 5979, 11130) GROUP BY kt.kind;
SELECT AVG(t.production_year) AS average_production_year, COUNT(DISTINCT t.id) AS number_of_movies, COUNT(DISTINCT mk.keyword_id) AS unique_keywords, SUM(CASE WHEN ct.id = 1 THEN 1 ELSE 0 END) AS count_of_company_type_1, COUNT(DISTINCT cn.id) AS number_of_char_names_with_notable_keywords FROM title AS t JOIN movie_keyword AS mk ON t.id = mk.movie_id JOIN keyword AS k ON mk.keyword_id = k.id LEFT JOIN movie_info AS mi ON t.id = mi.movie_id LEFT JOIN char_name AS cn ON cn.md5sum IN ('b0dc5d03266435f97cebf99921c7e7ac', 'd86327f54be7c284dea0e9dbcfc30d64', 'c36ece9f29aeec8bdb6e41b809e925e7', 'a997ab7b0916b53836f2184145809ded') LEFT JOIN company_type AS ct ON ct.id IN (1, 2, 4) WHERE mi.info_type_id = 4 AND mi.info = 'Vietnamese' AND t.production_year IS NOT NULL GROUP BY ct.id;
SELECT COUNT(DISTINCT t.id) AS number_of_movies, AVG(t.production_year) AS average_production_year, SUM(CASE WHEN t.kind_id = 1 THEN 1 ELSE 0 END) AS number_of_feature_films, SUM(CASE WHEN t.kind_id = 2 THEN 1 ELSE 0 END) AS number_of_tv_shows, COUNT(DISTINCT n.id) AS number_of_cast_members, COUNT(DISTINCT cc.subject_id) AS number_of_cast_types, AVG(cc.status_id) AS average_status_id FROM title AS t JOIN complete_cast AS cc ON t.id = cc.movie_id JOIN name AS n ON cc.subject_id = n.id WHERE cc.status_id = 4 AND t.production_year > 1990 GROUP BY t.kind_id ORDER BY number_of_movies DESC, average_production_year DESC;
SELECT ct.kind AS company_kind, COUNT(DISTINCT mc.movie_id) AS number_of_movies, AVG(CAST(mi_idx.info AS NUMERIC)) AS average_rating, SUM(CASE WHEN n.gender = 'F' THEN 1 ELSE 0 END) AS female_cast_count, SUM(CASE WHEN n.gender = 'M' THEN 1 ELSE 0 END) AS male_cast_count FROM company_type ct JOIN movie_companies mc ON ct.id = mc.company_type_id JOIN movie_info_idx mi_idx ON mc.movie_id = mi_idx.movie_id AND mi_idx.info_type_id = ( SELECT id FROM comp_cast_type WHERE kind = 'rating' ) JOIN name n ON mc.movie_id = n.id WHERE ct.kind IN ('special effects companies', 'miscellaneous companies', 'distributors') AND mc.movie_id IN ('19654', '24487', '18671', '31117', '18944') AND mc.company_id IN ('209', '936', '1140') AND n.name_pcode_cf IN ('A6232', 'A5163') GROUP BY ct.kind ORDER BY number_of_movies DESC, average_rating DESC;
SELECT AVG(mc.company_type_id) AS average_company_type, COUNT(DISTINCT mk.movie_id) AS total_movies_with_keywords, SUM(CASE WHEN cn.country_code = 'US' THEN 1 ELSE 0 END) AS total_us_companies, cn.name AS company_name, k.keyword AS keyword_name, COUNT(DISTINCT ml.link_type_id) AS total_link_types FROM movie_companies AS mc JOIN company_name AS cn ON mc.company_id = cn.id JOIN movie_keyword AS mk ON mc.movie_id = mk.movie_id JOIN keyword AS k ON mk.keyword_id = k.id JOIN movie_link AS ml ON mc.movie_id = ml.movie_id WHERE cn.name_pcode_nf IN ('L3424', 'T3231', 'J23') AND ml.id IN ('713', '4080', '967', '4313', '3260') AND k.phonetic_code IN ('M5', 'P4162', 'V4514', 'H452') GROUP BY cn.name, k.keyword ORDER BY total_movies_with_keywords DESC, total_us_companies DESC;
SELECT COUNT(DISTINCT t.id) AS total_movies, AVG(t.production_year) AS average_production_year, SUM(CASE WHEN n.gender = 'F' THEN 1 ELSE 0 END) AS female_cast_count, SUM(CASE WHEN n.gender = 'M' THEN 1 ELSE 0 END) AS male_cast_count, COUNT(DISTINCT k.id) AS total_distinct_keywords, MAX(t.production_year) AS latest_production_year FROM title t INNER JOIN aka_title at ON t.id = at.movie_id INNER JOIN movie_info_idx mi ON t.id = mi.movie_id INNER JOIN name n ON n.md5sum = at.md5sum INNER JOIN keyword k ON k.phonetic_code = at.phonetic_code WHERE t.production_year BETWEEN 2000 AND 2010 AND mi.info_type_id IN ('100', '101', '99') AND at.episode_of_id IN ('14284', '16059', '8468', '2167', '20079', '24526') AND n.name_pcode_cf IN ('A4165', 'A3423') GROUP BY t.kind_id ORDER BY total_movies DESC;
SELECT AVG(a.production_year) AS average_production_year, COUNT(DISTINCT c.id) AS total_unique_casts, SUM(CASE WHEN l.id IN (7, 8) THEN 1 ELSE 0 END) AS total_edited_or_spin_off_links, COUNT(DISTINCT cn.id) AS total_unique_characters, COUNT(*) AS total_titles FROM aka_title AS a JOIN complete_cast AS c ON a.movie_id = c.movie_id JOIN char_name AS cn ON cn.id = ANY(ARRAY[54785, 4119, 86783, 28862]) JOIN link_type AS l ON l.id = ANY(ARRAY[7, 8, 6, 3]) WHERE a.production_year IS NOT NULL AND c.status_id IN (3, 4) AND a.episode_of_id IS NOT NULL AND a.episode_of_id IN (15984, 4570, 5164, 247, 20256, 15791) AND l.link IN ('edited from', 'spin off') GROUP BY c.subject_id;
SELECT t.title AS movie_title, COUNT(DISTINCT mi.id) AS info_count, AVG(CAST(mi.info AS NUMERIC)) FILTER (WHERE it.info = 'rating') AS average_rating, SUM(mc.company_id) FILTER (WHERE mc.company_type_id = 1) AS sum_production_companies, COUNT(DISTINCT cc.id) AS cast_count, MAX(t.production_year) AS latest_production_year FROM title AS t JOIN movie_info AS mi ON t.id = mi.movie_id JOIN movie_companies AS mc ON t.id = mc.movie_id JOIN complete_cast AS cc ON t.id = cc.movie_id JOIN info_type AS it ON mi.info_type_id = it.id WHERE t.production_year > 1990 AND (mi.info_type_id IN (SELECT id FROM info_type WHERE info = 'rating' OR info = 'countries')) AND mc.company_type_id = 1 AND (mc.note NOT LIKE '%(USA)%' OR mc.note IS NULL) AND (cc.status_id = 1 OR cc.status_id = 2) GROUP BY t.title ORDER BY average_rating DESC, sum_production_companies DESC LIMIT 10;
SELECT cn.name AS company_name, ct.kind AS cast_type, COUNT(ml.id) AS total_movie_links, AVG(ml.linked_movie_id) AS average_linked_movie_imdb_id, COUNT(DISTINCT chn.id) AS total_characters FROM company_name cn JOIN movie_link ml ON cn.id = ml.movie_id JOIN comp_cast_type ct ON ml.link_type_id = ct.id LEFT JOIN char_name chn ON ml.movie_id = chn.id WHERE cn.country_code = 'US' AND cn.name_pcode_sf BETWEEN 'A0000' AND 'Z9999' GROUP BY cn.name, ct.kind ORDER BY total_movie_links DESC, average_linked_movie_imdb_id;
SELECT kt.kind, COUNT(DISTINCT mi.movie_id) AS movie_count, AVG(CAST(NULLIF(mi.info, '') AS numeric)) FILTER (WHERE it.info = 'rating') AS average_rating, SUM(CAST(NULLIF(mi.info, '') AS numeric)) FILTER (WHERE it.info = 'budget') AS total_budget FROM movie_info mi JOIN movie_keyword mk ON mi.movie_id = mk.movie_id JOIN kind_type kt ON kt.id = mk.keyword_id JOIN (SELECT id, info FROM movie_info WHERE info_type_id IN (SELECT id FROM info_type WHERE info IN ('rating', 'budget'))) it ON mi.id = it.id WHERE mi.movie_id IN (925861, 925697, 924285) AND kt.id IN (1, 5, 7) GROUP BY kt.kind;
SELECT cn.name AS company_name, COUNT(DISTINCT mi_idx.movie_id) AS number_of_movies, AVG(CAST(mi_idx.info AS NUMERIC)) AS average_runtime, SUM(CASE WHEN it.info = 'locations' THEN 1 ELSE 0 END) AS total_locations, COUNT(DISTINCT mk.keyword_id) AS unique_keywords, COUNT(DISTINCT cc.movie_id) AS complete_cast_movies FROM movie_info_idx AS mi_idx JOIN info_type AS it ON mi_idx.info_type_id = it.id JOIN movie_keyword AS mk ON mi_idx.movie_id = mk.movie_id JOIN complete_cast AS cc ON mi_idx.movie_id = cc.movie_id JOIN company_name AS cn ON cn.imdb_id = mi_idx.movie_id WHERE it.info IN ('runtimes', 'locations') AND cn.name_pcode_nf = 'G2642' GROUP BY cn.name ORDER BY average_runtime DESC, number_of_movies DESC;
