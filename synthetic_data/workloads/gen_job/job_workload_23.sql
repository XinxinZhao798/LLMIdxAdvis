SELECT it.info AS info_category, COUNT(DISTINCT mc.movie_id) AS number_of_movies, COUNT(DISTINCT mc.company_id) AS number_of_companies, AVG(n.imdb_id) AS average_imdb_id, SUM(CASE WHEN n.gender = 'M' THEN 1 ELSE 0 END) AS male_count, SUM(CASE WHEN n.gender = 'F' THEN 1 ELSE 0 END) AS female_count, MAX(n.name) AS max_name FROM movie_companies mc JOIN person_info pi ON mc.company_id = pi.person_id JOIN info_type it ON pi.info_type_id = it.id JOIN name n ON pi.person_id = n.id GROUP BY it.info ORDER BY number_of_movies DESC, number_of_companies DESC;
SELECT kt.kind AS movie_kind, COUNT(DISTINCT ml.movie_id) AS number_of_movies, COUNT(DISTINCT ml.linked_movie_id) AS number_of_linked_movies, LT.LINK AS link_type, AVG(pi.person_id) AS average_person_id, SUM(CASE WHEN mk.keyword_id = '3986' THEN 1 ELSE 0 END) AS count_of_keyword_3986, SUM(CASE WHEN mk.keyword_id = '3808' THEN 1 ELSE 0 END) AS count_of_keyword_3808, SUM(CASE WHEN mk.keyword_id = '4322' THEN 1 ELSE 0 END) AS count_of_keyword_4322 FROM movie_link AS ml JOIN link_type AS LT ON ml.link_type_id = LT.id JOIN kind_type AS kt ON kt.id IN ('6', '5') JOIN movie_keyword AS mk ON mk.movie_id = ml.movie_id LEFT JOIN person_info AS pi ON pi.person_id = ml.movie_id AND pi.info_type_id = mk.keyword_id WHERE mk.movie_id = '8874' AND LT.link IN ('features', 'referenced in', 'spin off', 'edited from', 'remade as', 'unknown link') GROUP BY kt.kind, LT.LINK;
SELECT kt.kind AS movie_kind, COUNT(DISTINCT ml.movie_id) AS number_of_movies, COUNT(DISTINCT ml.linked_movie_id) AS number_of_linked_movies, AVG(ml.link_type_id) AS average_link_type_id, SUM(CASE WHEN rt.role = 'producer' THEN 1 ELSE 0 END) AS producer_roles_count, SUM(CASE WHEN rt.role = 'actress' THEN 1 ELSE 0 END) AS actress_roles_count FROM movie_link AS ml JOIN kind_type AS kt ON ml.movie_id = kt.id JOIN role_type AS rt ON ml.link_type_id = rt.id WHERE kt.kind IN ('movie', 'tv mini series', 'episode') AND rt.role IN ('guest', 'cinematographer', 'producer', 'actress') GROUP BY kt.kind;
SELECT ct.kind AS company_type, AVG(CAST(mi.info AS NUMERIC)) AS average_rating, COUNT(DISTINCT mk.movie_id) AS movie_count, COUNT(k.id) AS keyword_count, SUM(CASE WHEN it.info = 'LD official retail price' THEN CAST(mi.info AS NUMERIC) ELSE 0 END) AS total_official_retail_price FROM company_type ct JOIN movie_info mi ON ct.id = mi.info_type_id JOIN movie_keyword mk ON mi.movie_id = mk.movie_id JOIN keyword k ON mk.keyword_id = k.id JOIN info_type it ON mi.info_type_id = it.id WHERE mk.keyword_id IN (2506, 2862, 589, 3476, 4237) AND k.phonetic_code IN ('D1653', 'H532', 'M6321', 'H4326', 'F2426', 'A3513') AND it.id IN (15, 16, 18, 76, 39, 111) AND mi.movie_id IN (9091, 13237, 927238) AND (mi.note ILIKE '%(English subtitles)%' OR mi.note ILIKE '%(Original version)%') GROUP BY ct.kind;
SELECT kt.kind, COUNT(DISTINCT mi.movie_id) AS number_of_movies, AVG(subquery.keyword_count) AS average_keywords_per_movie, COUNT(DISTINCT n.id) AS unique_actors FROM kind_type kt LEFT JOIN movie_info mi ON mi.info_type_id = kt.id LEFT JOIN ( SELECT mk.movie_id, COUNT(mk.keyword_id) AS keyword_count FROM movie_keyword mk GROUP BY mk.movie_id ) AS subquery ON mi.movie_id = subquery.movie_id LEFT JOIN name n ON n.imdb_index = mi.info WHERE n.imdb_index IN ('VII', 'IV', 'X', 'XXII', 'VI') AND mi.info_type_id IN (SELECT id FROM info_type WHERE id IN ('40', '7', '30', '74', '34', '76')) GROUP BY kt.kind;
SELECT COUNT(DISTINCT cn.id) AS num_companies, COUNT(DISTINCT chn.id) AS num_characters, AVG(CAST(mi_idx.info AS DECIMAL)) AS average_movie_rating, SUM(CASE WHEN kt.id = '4' THEN 1 ELSE 0 END) AS num_tv_series, COUNT(DISTINCT cc.movie_id) AS num_movies_with_complete_cast FROM company_name cn LEFT JOIN movie_companies mc ON cn.id = mc.company_id LEFT JOIN char_name chn ON chn.surname_pcode IN ('O416', 'M65', 'L5163') LEFT JOIN complete_cast cc ON mc.movie_id = cc.movie_id LEFT JOIN movie_info_idx mi_idx ON mc.movie_id = mi_idx.movie_id LEFT JOIN kind_type kt ON cc.subject_id = kt.id LEFT JOIN info_type it ON mi_idx.info_type_id = it.id AND it.info = 'rating' WHERE cn.name_pcode_nf IN ('L2416', 'A2321') AND ( cn.id = '152' OR kt.id = '4' OR it.id IN ('29', '49', '97', '78') ) GROUP BY cn.country_code;
SELECT kt.kind AS movie_type, COUNT(DISTINCT at.id) AS total_alternate_titles, AVG(cc.status_id) AS average_status_id, SUM(CASE WHEN at.kind_id = 7 THEN 1 ELSE 0 END) AS total_tv_shows, SUM(CASE WHEN at.kind_id = 2 THEN 1 ELSE 0 END) AS total_movies, COUNT(DISTINCT mi.id) AS total_movie_info_entries, COUNT(DISTINCT cc.id) AS total_complete_cast_entries FROM aka_title at JOIN kind_type kt ON at.kind_id = kt.id JOIN complete_cast cc ON at.movie_id = cc.movie_id LEFT JOIN movie_info_idx mi ON at.movie_id = mi.movie_id GROUP BY kt.kind ORDER BY total_alternate_titles DESC;
SELECT k.keyword, COUNT(DISTINCT mk.movie_id) AS movie_count, AVG(LENGTH(k.phonetic_code)) AS avg_phonetic_code_length, COUNT(DISTINCT rt.id) AS distinct_role_types FROM movie_keyword AS mk JOIN keyword AS k ON mk.keyword_id = k.id JOIN cast_info AS ci ON mk.movie_id = ci.movie_id JOIN role_type AS rt ON ci.role_id = rt.id WHERE mk.movie_id IN ('12183', '10549', '12251', '15502', '13890', '9703') AND mk.keyword_id IN ('2957', '3334', '3038', '2036') GROUP BY k.keyword ORDER BY movie_count DESC, avg_phonetic_code_length;
SELECT it.info AS info_category, COUNT(pi.id) AS total_person_info_records, AVG(mi.movie_id) AS average_movie_id, SUM(CASE WHEN pi.note = 'anonymous' THEN 1 ELSE 0 END) AS anonymous_count, SUM(CASE WHEN pi.note = 'Spook Show Entertainment' THEN 1 ELSE 0 END) AS spook_show_count, MAX(pi.id) AS max_person_info_id, MIN(mi.id) AS min_movie_info_id FROM person_info pi JOIN info_type it ON pi.info_type_id = it.id JOIN movie_info mi ON pi.person_id = mi.movie_id JOIN comp_cast_type cct ON mi.info_type_id = cct.id AND cct.kind = 'complete' GROUP BY it.info HAVING COUNT(pi.id) > 5 ORDER BY total_person_info_records DESC;
SELECT rt.ROLE, AVG(miidx.info::NUMERIC) AS average_rating, COUNT(DISTINCT cn.id) AS number_of_companies, COUNT(DISTINCT cl.movie_id) AS number_of_movies_linked, COUNT(DISTINCT mk.keyword_id) AS number_of_unique_keywords FROM role_type rt LEFT JOIN char_name cn ON cn.surname_pcode = rt.id::CHARACTER VARYING LEFT JOIN movie_link cl ON cl.link_type_id = rt.id LEFT JOIN movie_keyword mk ON mk.movie_id = cl.movie_id LEFT JOIN movie_info_idx miidx ON miidx.movie_id = cl.movie_id WHERE rt.ROLE IN ('production designer', 'guest', 'editor', 'cinematographer') AND cn.name_pcode_nf IN ('T3452', 'A423', 'D653', 'A5426', 'H5161', 'B3216') AND miidx.info_type_id = 101 /* Assuming 101 is the info_type_id for 'rating' */ GROUP BY rt.ROLE;
SELECT t.title AS original_title, COUNT(DISTINCT at.id) AS number_of_alternative_titles, AVG(CAST(mi_idx.info AS INTEGER)) AS average_movie_rating, SUM(CASE WHEN mc.company_type_id = 1 THEN 1 ELSE 0 END) AS number_of_production_companies, SUM(CASE WHEN mc.company_type_id = 2 THEN 1 ELSE 0 END) AS number_of_distribution_companies, COUNT(DISTINCT n.id) AS number_of_unique_actors FROM title t LEFT JOIN aka_title at ON t.id = at.movie_id LEFT JOIN movie_info_idx mi_idx ON t.id = mi_idx.movie_id AND mi_idx.info_type_id = 100 LEFT JOIN movie_companies mc ON t.id = mc.movie_id LEFT JOIN name n ON n.id IN ('7238', '8193', '11843', '6809', '6894', '6651') LEFT JOIN movie_info mi ON t.id = mi.movie_id AND mi.info_type_id = 3 WHERE t.production_year BETWEEN 1990 AND 2000 AND n.id IS NOT NULL AND mi.note IS NOT NULL GROUP BY t.title ORDER BY average_movie_rating DESC LIMIT 10;
SELECT AVG(CAST(mi_idx.info AS numeric)) AS average_rating, COUNT(DISTINCT mk.movie_id) AS number_of_movies_with_keywords, COUNT(DISTINCT akn.person_id) AS unique_actors_with_alternate_names, SUM(CASE WHEN cn.name LIKE 'John %' THEN 1 ELSE 0 END) AS count_char_john FROM movie_info_idx mi_idx JOIN movie_keyword mk ON mi_idx.movie_id = mk.movie_id JOIN aka_name akn ON mk.movie_id = akn.person_id JOIN char_name cn ON akn.person_id = cn.id WHERE mi_idx.info_type_id = (SELECT id FROM info_type WHERE info = 'rating') AND mi_idx.note IS NULL AND cn.md5sum IN ('8d27c5ba7c1446502255ecfe6fec5a75', 'b314ed1fd1802d098b87fb46fbba3d62', 'b7658b3c5efeaba483fa8fb61d460be3') GROUP BY mi_idx.info_type_id;
SELECT AVG(t.production_year) AS average_production_year, COUNT(DISTINCT k.id) AS number_of_unique_keywords, SUM(CASE WHEN mc.company_type_id = 1 THEN 1 ELSE 0 END) AS number_of_production_companies, COUNT(DISTINCT mk.movie_id) AS number_of_movies_with_keywords, COUNT(DISTINCT t.id) AS total_movies FROM title AS t JOIN movie_keyword AS mk ON t.id = mk.movie_id JOIN keyword AS k ON mk.keyword_id = k.id JOIN movie_companies AS mc ON t.id = mc.movie_id JOIN complete_cast AS cc ON t.id = cc.movie_id WHERE t.production_year > 1990 AND mc.company_type_id IN (1, 2, 3) AND cc.status_id = 1 AND k.phonetic_code IN ('W25', 'P4232', 'G4323') GROUP BY t.kind_id HAVING COUNT(DISTINCT mc.company_id) > 5 ORDER BY average_production_year DESC;
SELECT t.kind_id, AVG(CASE WHEN mi.info_type_id = 101 THEN CAST(mi.info AS NUMERIC) ELSE NULL END) AS avg_budget, SUM(CASE WHEN at.title LIKE '%Finnish%' THEN 1 ELSE 0 END) AS finnish_title_count, COUNT(DISTINCT t.id) AS total_movies, MIN(t.production_year) AS earliest_production_year, MAX(t.production_year) AS latest_production_year FROM title t LEFT JOIN movie_info mi ON t.id = mi.movie_id LEFT JOIN aka_title at ON t.id = at.movie_id LEFT JOIN complete_cast cc ON t.id = cc.movie_id WHERE (t.kind_id = 2 OR t.kind_id = 7) AND (at.phonetic_code IN ('C4231', 'U4351', 'D5353') OR t.phonetic_code = 'F635') AND (at.season_nr IN (30, 7, 9) OR t.production_year BETWEEN 2005 AND 2015) AND (mi.info = 'Finnish' OR mi.info = 'Serbo-Croatian') GROUP BY t.kind_id ORDER BY total_movies DESC;
SELECT ct.kind AS company_kind, COUNT(DISTINCT n.id) AS number_of_people, AVG(t.production_year) AS average_production_year, SUM(CASE WHEN t.season_nr IS NOT NULL THEN 1 ELSE 0 END) AS total_series_episodes, COUNT(DISTINCT at.id) AS number_of_alternate_titles FROM name n JOIN aka_name an ON n.id = an.person_id JOIN title t ON n.id = t.id JOIN aka_title at ON t.id = at.movie_id JOIN company_type ct ON ct.kind = 'production companies' GROUP BY ct.kind;
SELECT t.production_year, COUNT(DISTINCT t.id) AS number_of_movies, AVG(CAST(mi.info AS NUMERIC)) AS average_box_office, SUM(CAST(mi.info AS NUMERIC)) AS total_box_office, COUNT(DISTINCT mc.company_id) AS number_of_production_companies FROM title AS t JOIN movie_info AS mi_language ON t.id = mi_language.movie_id AND mi_language.info_type_id = ( SELECT id FROM info_type WHERE info = 'language' ) JOIN movie_info AS mi ON t.id = mi.movie_id AND mi.info_type_id = ( SELECT id FROM info_type WHERE info = 'box office' ) JOIN movie_companies AS mc ON t.id = mc.movie_id WHERE mi_language.info IN ('Slovak', 'Spanish', 'Italian') AND mc.company_type_id = 1 AND t.title IN ('Freaky Friends & Fiction', 'Fait Accompli', '(#1.109)', 'Der Sheriff von Giesing', 'Dont Utter a Note') GROUP BY t.production_year ORDER BY t.production_year DESC;
SELECT t.title AS movie_title, COUNT(DISTINCT mi.id) AS info_count, AVG(CAST(mi.info AS NUMERIC)) FILTER (WHERE it.info = 'rating') AS average_rating, SUM(mc.company_id) FILTER (WHERE mc.company_type_id = 1) AS sum_production_companies, COUNT(DISTINCT cc.id) AS cast_count, MAX(t.production_year) AS latest_production_year FROM title AS t JOIN movie_info AS mi ON t.id = mi.movie_id JOIN movie_companies AS mc ON t.id = mc.movie_id JOIN complete_cast AS cc ON t.id = cc.movie_id JOIN info_type AS it ON mi.info_type_id = it.id WHERE t.production_year > 1990 AND (mi.info_type_id IN (SELECT id FROM info_type WHERE info = 'rating' OR info = 'countries')) AND mc.company_type_id = 1 AND (mc.note NOT LIKE '%(USA)%' OR mc.note IS NULL) AND (cc.status_id = 1 OR cc.status_id = 2) GROUP BY t.title ORDER BY average_rating DESC, sum_production_companies DESC LIMIT 10;
SELECT ct.kind AS cast_type, COUNT(ci.id) AS total_cast_entries, AVG(ci.nr_order) AS average_order, SUM(CASE WHEN ml.link_type_id = 1 THEN 1 ELSE 0 END) AS total_sequel_links, COUNT(DISTINCT ci.movie_id) AS unique_movies, COUNT(DISTINCT ci.person_id) AS unique_persons FROM cast_info ci JOIN comp_cast_type ct ON ci.role_id = ct.id LEFT JOIN movie_link ml ON ci.movie_id = ml.movie_id AND ml.linked_movie_id = 9108 WHERE ci.movie_id IN (2348393, 1843055, 2354998, 2143306, 1326354, 1589480) AND ci.nr_order IN (75, 20, 2, 35) GROUP BY ct.kind ORDER BY total_cast_entries DESC;
SELECT ct.kind AS cast_type, AVG(movcomp_notes.note_length) AS average_note_length, COUNT(DISTINCT movcomp.movie_id) AS number_of_movies, COUNT(DISTINCT comp.name) AS number_of_companies, SUM(CASE WHEN movcomp.company_type_id = 1 THEN 1 ELSE 0 END) AS number_of_producers, MAX(comp_cast.subject_id) AS max_subject_id_for_cast_type FROM complete_cast AS comp_cast JOIN comp_cast_type AS ct ON comp_cast.subject_id = ct.id JOIN movie_companies AS movcomp ON movcomp.movie_id = comp_cast.movie_id JOIN company_name AS comp ON movcomp.company_id = comp.id LEFT JOIN (SELECT movie_id, LENGTH(note) AS note_length FROM movie_companies) AS movcomp_notes ON movcomp.movie_id = movcomp_notes.movie_id WHERE comp_cast.id IN (4264, 2513, 575, 1032) AND comp_cast.subject_id = 1 AND ct.id = 4 GROUP BY ct.kind;
SELECT kind.kind AS company_kind, COUNT(DISTINCT ci.movie_id) AS num_movies, AVG(mi_idx.info::NUMERIC) AS average_movie_rating, SUM(CASE WHEN at.title LIKE '%War%' THEN 1 ELSE 0 END) AS num_war_related_titles, COUNT(DISTINCT ci.person_id) AS num_unique_actors FROM company_type kind JOIN movie_info_idx mi_idx ON mi_idx.info LIKE '0.0%' JOIN movie_info mi ON mi.movie_id = mi_idx.movie_id AND mi.info = 'Romanian' JOIN aka_title at ON at.movie_id = mi.movie_id JOIN cast_info ci ON ci.movie_id = at.movie_id WHERE kind.kind = 'special effects companies' AND at.imdb_index IN ('I', 'II', 'III', 'IV') GROUP BY kind.kind;
SELECT kt.kind as movie_kind, AVG(t.production_year) as average_production_year, COUNT(DISTINCT t.id) as total_movies, COUNT(DISTINCT n.id) as total_actors, SUM(CASE WHEN pi.info_type_id = 76 THEN 1 ELSE 0 END) as total_awards, MIN(t.title) as earliest_movie_title FROM title t JOIN kind_type kt ON t.kind_id = kt.id JOIN movie_info_idx mii ON t.id = mii.movie_id JOIN info_type it ON mii.info_type_id = it.id JOIN person_info pi ON pi.info_type_id = it.id JOIN name n ON pi.person_id = n.id WHERE kt.kind = 'video game' AND t.production_year > 2000 AND n.gender = 'f' AND pi.note NOT LIKE '%Coverland%' AND pi.note NOT LIKE '%CED Talent%' AND pi.note NOT LIKE '%The Official Web Site of Alexandra Adomaitis%' GROUP BY kt.kind;
SELECT COUNT(DISTINCT a.id) AS unique_alternate_titles, AVG(a.production_year) AS average_production_year, COUNT(DISTINCT c.movie_id) AS total_movies_with_complete_cast, SUM(CASE WHEN k.keyword = 'dry-cleaners' THEN 1 ELSE 0 END) AS dry_cleaners_keyword_count, (SELECT COUNT(*) FROM link_type) AS total_link_types FROM aka_title AS a LEFT JOIN complete_cast AS c ON a.movie_id = c.movie_id LEFT JOIN movie_keyword AS mk ON a.movie_id = mk.movie_id LEFT JOIN keyword AS k ON mk.keyword_id = k.id WHERE a.production_year >= 2000 AND c.status_id IN (SELECT id FROM comp_cast_type WHERE kind = 'complete+verified') AND (k.phonetic_code = 'L2523' OR k.keyword IN ('imam', 'jug', 'greek', 'richard-nixon')) GROUP BY a.kind_id HAVING COUNT(DISTINCT c.movie_id) > 5;
SELECT ct.kind AS company_kind, COUNT(DISTINCT t.id) AS total_titles, AVG(t.production_year) AS average_production_year, COUNT(DISTINCT k.id) AS distinct_keywords_count FROM company_type AS ct JOIN title AS t ON t.kind_id = ct.id LEFT JOIN keyword AS k ON k.phonetic_code = t.phonetic_code WHERE t.production_year IS NOT NULL AND ct.id IN (SELECT kind_id FROM title WHERE id IN (175843, 103199, 50713, 123396, 75890)) GROUP BY ct.kind ORDER BY total_titles DESC;
SELECT COUNT(DISTINCT cn.id) AS total_companies, COUNT(DISTINCT k.id) AS total_keywords, COUNT(DISTINCT pi.person_id) AS total_people, COUNT(DISTINCT at.id) AS total_titles, AVG(cc.status_id) AS average_cast_status, SUM(CASE WHEN cn.country_code = 'US' THEN 1 ELSE 0 END) AS total_us_companies, MAX(at.production_year) AS latest_production_year, MIN(at.production_year) AS earliest_production_year FROM company_name AS cn JOIN aka_title AS at ON cn.id = at.kind_id JOIN complete_cast AS cc ON at.movie_id = cc.movie_id JOIN person_info AS pi ON cc.subject_id = pi.person_id JOIN keyword AS k ON at.id = k.id WHERE cn.name IN ('Sunset Productions (II)', 'Coming Soon TV', 'Tucker Film', 'Windfall Films', 'NMK') AND k.keyword IN ('lavatory', 'society') AND at.production_year BETWEEN 2000 AND 2023 GROUP BY cn.country_code ORDER BY total_us_companies DESC, latest_production_year DESC;
SELECT ct.kind AS company_type, AVG(mi_idx.info::NUMERIC) AS average_movie_rating, SUM(CASE WHEN cc.status_id = 4 THEN 1 ELSE 0 END) AS total_completed_movies, COUNT(DISTINCT k.id) AS number_of_unique_keywords, COUNT(DISTINCT mc.movie_id) AS number_of_movies_with_companies FROM movie_info mi JOIN movie_info_idx mi_idx ON mi.movie_id = mi_idx.movie_id AND mi.info_type_id = mi_idx.info_type_id JOIN movie_companies mc ON mi.movie_id = mc.movie_id JOIN company_type ct ON mc.company_type_id = ct.id JOIN complete_cast cc ON mc.movie_id = cc.movie_id JOIN keyword k ON mi.movie_id = k.id WHERE ct.id IN (3, 4) AND mc.company_id IN (202, 974) AND cc.status_id IN (3, 4) AND cc.subject_id = 1 AND mi.note LIKE '%(only a few lines)%' GROUP BY ct.kind;
SELECT rt.ROLE AS Role, COUNT(distinct ci.person_id) AS Number_Of_Actors, AVG(ci.nr_order) AS Average_Billing_Position, SUM(CASE WHEN n.gender = 'M' THEN 1 ELSE 0 END) AS Male_Actors, SUM(CASE WHEN n.gender = 'F' THEN 1 ELSE 0 END) AS Female_Actors, MIN(aka.production_year) AS Earliest_Film_Year, MAX(aka.production_year) AS Latest_Film_Year, COUNT(distinct mk.movie_id) AS Number_Of_Movies_With_Keywords, AVG(pi.info_type_id::integer) AS Average_Info_Type_Id FROM cast_info ci JOIN name n ON ci.person_id = n.id JOIN role_type rt ON ci.role_id = rt.id LEFT JOIN aka_title aka ON ci.movie_id = aka.movie_id LEFT JOIN movie_keyword mk ON ci.movie_id = mk.movie_id LEFT JOIN person_info pi ON n.id = pi.person_id WHERE (aka.title = 'Abduction - Riprenditi la tua vita' OR aka.title = 'Mala wielka milosc' OR aka.title = 'Great Performances: On the Town in Concert' OR aka.title = 'æÁÂÒÉËÉ Ú×ÅÚÄ. ÷ÏÚ×ÒÁÝÅÎÉÅ' OR aka.title = 'Zavoevanie ameriki') AND pi.info_type_id IN ('37', '20', '28', '32', '25') AND ci.nr_order = 93 GROUP BY rt.ROLE;
SELECT kt.kind AS movie_kind, COUNT(distinct t.id) AS number_of_movies, AVG(t.production_year) AS average_production_year, SUM(CASE WHEN cct.kind = 'complete+verified' THEN 1 ELSE 0 END) AS total_complete_verified, SUM(CASE WHEN cct.kind = 'crew' THEN 1 ELSE 0 END) AS total_crew, SUM(CASE WHEN cct.kind = 'cast' THEN 1 ELSE 0 END) AS total_cast, COUNT(distinct mk.keyword_id) AS number_of_keywords FROM title t JOIN kind_type kt ON t.kind_id = kt.id LEFT JOIN comp_cast_type cct ON t.id = cct.id LEFT JOIN movie_keyword mk ON t.id = mk.movie_id WHERE kt.id IN (2, 6) AND kt.kind = 'video movie' AND cct.kind IN ('complete+verified', 'crew', 'cast') AND cct.id IN (2, 1, 4, 3) GROUP BY kt.kind ORDER BY number_of_movies DESC;
SELECT rt.role, COUNT(DISTINCT n.id) AS number_of_people, AVG(t.production_year) AS average_production_year, MIN(t.production_year) AS earliest_production_year, MAX(t.production_year) AS latest_production_year, SUM(CASE WHEN mi.info = 'Cantonese' THEN 1 ELSE 0 END) AS cantonese_movies, SUM(CASE WHEN mi.info = 'Polish' THEN 1 ELSE 0 END) AS polish_movies, SUM(CASE WHEN mi.info = 'Russian' THEN 1 ELSE 0 END) AS russian_movies, SUM(CASE WHEN mi.info = 'Vietnamese' THEN 1 ELSE 0 END) AS vietnamese_movies, SUM(CASE WHEN mi.info = 'Faroese' THEN 1 ELSE 0 END) AS faroese_movies, SUM(CASE WHEN mi.info = 'Catalan' THEN 1 ELSE 0 END) AS catalan_movies FROM role_type rt JOIN movie_companies mc ON mc.company_type_id = rt.id JOIN title t ON mc.movie_id = t.id JOIN name n ON n.id = mc.company_id JOIN movie_info mi ON mi.movie_id = t.id AND mi.info_type_id = '4' WHERE rt.id = '8' AND rt.role = 'miscellaneous crew' GROUP BY rt.role;
SELECT AVG(CAST(mi_idx.info AS NUMERIC)) AS average_rating, COUNT(DISTINCT ci.person_id) AS number_of_actors, SUM(CASE WHEN cn.country_code = '[us]' THEN 1 ELSE 0 END) AS US_based_companies, t.production_year, COUNT(DISTINCT t.id) AS number_of_movies FROM title t LEFT JOIN movie_info_idx mi_idx ON t.id = mi_idx.movie_id AND mi_idx.info_type_id = (SELECT id FROM info_type WHERE info = 'rating') LEFT JOIN cast_info ci ON t.id = ci.movie_id LEFT JOIN movie_companies mc ON t.id = mc.movie_id LEFT JOIN company_name cn ON mc.company_id = cn.id WHERE t.production_year IS NOT NULL GROUP BY t.production_year HAVING COUNT(DISTINCT t.id) > 10 ORDER BY t.production_year DESC;
SELECT ct.kind AS company_kind, AVG(t.production_year) AS average_production_year, COUNT(DISTINCT t.id) AS number_of_movies, SUM(CASE WHEN t.production_year >= 2000 THEN 1 ELSE 0 END) AS movies_since_2000 FROM title AS t JOIN movie_keyword AS mk ON t.id = mk.movie_id JOIN company_type AS ct ON t.kind_id = ct.id WHERE ct.kind IN ('special effects companies', 'distributors') AND t.production_year IS NOT NULL GROUP BY ct.kind;
