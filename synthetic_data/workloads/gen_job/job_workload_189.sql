SELECT ct.kind AS company_type, COUNT(DISTINCT t.id) AS number_of_movies, AVG(t.production_year) AS average_production_year, SUM(CASE WHEN al.title IS NOT NULL THEN 1 ELSE 0 END) AS number_of_alternate_titles, COUNT(DISTINCT ml.linked_movie_id) AS number_of_linked_movies, COUNT(DISTINCT k.id) AS number_of_unique_keywords FROM title AS t LEFT JOIN aka_title AS al ON t.id = al.movie_id LEFT JOIN movie_link AS ml ON t.id = ml.movie_id LEFT JOIN keyword AS k ON k.phonetic_code = al.phonetic_code INNER JOIN company_type AS ct ON t.kind_id = ct.id WHERE t.production_year BETWEEN 2000 AND 2023 AND ml.linked_movie_id IN (16385, 2365137, 1412093, 1391187, 16056, 1432843) AND al.title IS NOT NULL AND k.keyword IN ('freezer', 'vengeance', 'undead', 'meat-cleaver') GROUP BY ct.kind ORDER BY number_of_movies DESC;
SELECT kt.kind AS movie_kind, AVG(t.production_year) AS average_production_year, COUNT(DISTINCT t.id) AS total_movies, COUNT(DISTINCT mi.info) AS unique_info_types, SUM(CASE WHEN t.season_nr IN ('8', '20', '12', '24', '33') THEN 1 ELSE 0 END) AS count_specific_seasons, COUNT(DISTINCT pi.person_id) AS total_persons_involved FROM title AS t JOIN kind_type AS kt ON t.kind_id = kt.id LEFT JOIN movie_info_idx AS mi ON t.id = mi.movie_id LEFT JOIN person_info AS pi ON pi.person_id = t.id GROUP BY kt.kind ORDER BY total_movies DESC;
SELECT ml.movie_id, COUNT(DISTINCT ml.linked_movie_id) AS number_of_linked_movies, AVG(COUNT(ml.linked_movie_id)) OVER () AS average_links_per_movie, COUNT(DISTINCT mk.keyword_id) AS total_distinct_keywords FROM movie_link AS ml INNER JOIN movie_info AS mi ON ml.movie_id = mi.movie_id INNER JOIN movie_keyword AS mk ON ml.movie_id = mk.movie_id GROUP BY ml.movie_id ORDER BY number_of_linked_movies DESC, total_distinct_keywords DESC;
SELECT COUNT(t.id) AS total_movies, AVG(mi_idx.info::numeric) AS average_rating, SUM(CASE WHEN cn.country_code = '[ch]' THEN 1 ELSE 0 END) AS swiss_produced_movies, SUM(CASE WHEN k.keyword = 'video-tape' THEN 1 ELSE 0 END) AS video_tape_keyword_count, COUNT(DISTINCT cn.name) AS unique_companies_involved FROM title AS t JOIN movie_keyword AS mk ON t.id = mk.movie_id JOIN keyword AS k ON mk.keyword_id = k.id JOIN movie_companies AS mc ON t.id = mc.movie_id JOIN company_name AS cn ON mc.company_id = cn.id JOIN movie_info_idx AS mi_idx ON t.id = mi_idx.movie_id WHERE t.production_year BETWEEN 2000 AND 2010 AND k.keyword IN ('video-tape', 'delta-airlines') AND cn.country_code IN ('[sa]', '[hk]', '[np]', '[ao]', '[ch]', '[do]') AND cn.name_pcode_sf = 'F4623' AND mi_idx.info_type_id = (SELECT id FROM info_type WHERE info = 'rating') GROUP BY cn.country_code, k.keyword;
SELECT AVG(ak.production_year) AS average_production_year, COUNT(DISTINCT ak.id) AS total_alternate_titles, SUM(mc.company_type_id) AS total_company_types, COUNT(DISTINCT pi.person_id) AS total_persons_with_info, COUNT(DISTINCT kc.id) AS total_keywords_used, kt.LINK as link_type FROM aka_title ak JOIN movie_companies mc ON ak.movie_id = mc.movie_id JOIN person_info pi ON ak.movie_id = pi.person_id JOIN keyword kc ON ak.movie_id = kc.id JOIN link_type kt ON kt.id = mc.company_type_id WHERE ak.production_year > 2000 AND kt.LINK IN ('spoofs', 'remake of') AND mc.note IS NOT NULL AND pi.info_type_id BETWEEN 1 AND 5 GROUP BY kt.LINK ORDER BY average_production_year DESC;
SELECT cct.kind, COUNT(DISTINCT mi_idx.movie_id) AS number_of_movies, AVG(CAST(mi_idx.info AS INTEGER)) AS average_votes, COUNT(DISTINCT pi.person_id) AS number_of_people, SUM(CASE WHEN pi.info LIKE '%1971%' THEN 1 ELSE 0 END) AS count_people_born_1971, SUM(CASE WHEN pi.info LIKE '%O-chan%' THEN 1 ELSE 0 END) AS count_people_with_Ochan_info FROM comp_cast_type cct JOIN movie_info_idx mi_idx ON cct.id = mi_idx.info_type_id JOIN person_info pi ON pi.info_type_id = mi_idx.info_type_id WHERE cct.kind = 'crew' GROUP BY cct.kind;
SELECT ci.person_id, ci.role_id, COUNT(ci.movie_id) AS total_movies, AVG(ci.nr_order) AS avg_cast_position, COUNT(DISTINCT cc.movie_id) AS complete_cast_movies, COUNT(DISTINCT lt.id) AS unique_link_types FROM cast_info ci LEFT JOIN complete_cast cc ON ci.movie_id = cc.movie_id LEFT JOIN link_type lt ON ci.person_role_id = lt.id GROUP BY ci.person_id, ci.role_id ORDER BY total_movies DESC, avg_cast_position;
SELECT lt.LINK AS link_type, COUNT(DISTINCT ml.movie_id) AS total_movies, AVG(ak.production_year) AS average_production_year, SUM(CASE WHEN ak.note LIKE '%(USA)%' THEN 1 ELSE 0 END) AS total_us_titles, COUNT(DISTINCT mk.keyword_id) AS distinct_keywords_used, COUNT(DISTINCT n.id) AS number_of_contributors FROM movie_link AS ml JOIN link_type AS lt ON ml.link_type_id = lt.id JOIN aka_title AS ak ON ml.movie_id = ak.movie_id JOIN movie_keyword AS mk ON ml.movie_id = mk.movie_id JOIN name AS n ON ak.id = n.id WHERE ak.title IS NOT NULL AND n.gender IN ('m', 'f') AND lt.id IN (3, 6) GROUP BY lt.LINK ORDER BY total_movies DESC;
SELECT it.info AS info_type, COUNT(DISTINCT ci.movie_id) AS number_of_movies, AVG(LENGTH(mi.note)) FILTER (WHERE mi.info_type_id = it.id) AS average_note_length, SUM(CASE WHEN ch.imdb_id IS NOT NULL THEN 1 ELSE 0 END) AS total_characters_with_imdb_id, MAX(t.production_year) AS latest_production_year FROM info_type it JOIN movie_info mi ON mi.info_type_id = it.id JOIN title t ON t.id = mi.movie_id JOIN cast_info ci ON ci.movie_id = t.id JOIN char_name ch ON ch.id = ci.person_id WHERE (ch.name_pcode_nf IN ('P6523', 'C1563', 'S2345') OR ch.surname_pcode IN ('O6', 'L3', 'H616', 'C4162', 'C5')) AND t.season_nr IN (22, 36, 28, 44, 38) AND it.id IN (108, 57, 44, 85, 52) GROUP BY it.info;
SELECT kt.kind AS movie_kind, AVG(at.production_year) AS average_production_year, COUNT(DISTINCT ci.movie_id) AS number_of_movies, COUNT(DISTINCT ci.person_id) AS number_of_actors, SUM(CASE WHEN ci.role_id = 1 THEN 1 ELSE 0 END) AS number_of_lead_roles, COUNT(DISTINCT cn.id) AS number_of_unique_characters FROM cast_info ci JOIN aka_title at ON ci.movie_id = at.movie_id JOIN kind_type kt ON at.kind_id = kt.id JOIN char_name cn ON ci.person_role_id = cn.id WHERE at.production_year BETWEEN 1990 AND 2000 AND kt.kind = 'feature' GROUP BY kt.kind;
SELECT kt.kind AS movie_kind, AVG(at.production_year) AS average_production_year, COUNT(DISTINCT at.movie_id) AS total_movies, COUNT(DISTINCT mk.keyword_id) AS distinct_keywords FROM aka_title at INNER JOIN kind_type kt ON at.kind_id = kt.id LEFT JOIN movie_keyword mk ON at.movie_id = mk.movie_id GROUP BY kt.kind ORDER BY total_movies DESC, average_production_year DESC;
SELECT it.info AS info_category, COUNT(pi.id) AS total_person_info_records, AVG(mi.movie_id) AS average_movie_id, SUM(CASE WHEN pi.note = 'anonymous' THEN 1 ELSE 0 END) AS anonymous_count, SUM(CASE WHEN pi.note = 'Spook Show Entertainment' THEN 1 ELSE 0 END) AS spook_show_count, MAX(pi.id) AS max_person_info_id, MIN(mi.id) AS min_movie_info_id FROM person_info pi JOIN info_type it ON pi.info_type_id = it.id JOIN movie_info mi ON pi.person_id = mi.movie_id JOIN comp_cast_type cct ON mi.info_type_id = cct.id AND cct.kind = 'complete' GROUP BY it.info HAVING COUNT(pi.id) > 5 ORDER BY total_person_info_records DESC;
SELECT kt.kind, AVG(at.production_year) AS avg_production_year, COUNT(at.id) AS alt_title_count, COUNT(DISTINCT pi.person_id) AS distinct_person_count FROM aka_title at JOIN kind_type kt ON at.kind_id = kt.id LEFT JOIN person_info pi ON at.movie_id = pi.person_id WHERE kt.kind IN ('tv series', 'video game', 'movie', 'tv movie') GROUP BY kt.kind ORDER BY kt.kind;
SELECT t.production_year, ct.kind AS company_type, COUNT(t.id) AS movie_count FROM title t JOIN movie_companies mc ON t.id = mc.movie_id JOIN company_name cn ON mc.company_id = cn.id JOIN company_type ct ON mc.company_type_id = ct.id WHERE cn.country_code IN ('[gb]', '[dk]') AND ct.kind IN ('Distribution', 'Production') GROUP BY t.production_year, ct.kind ORDER BY t.production_year ASC, ct.kind;
SELECT AVG(mi.id) AS average_movie_info_id, COUNT(DISTINCT mk.movie_id) AS count_distinct_movies, SUM(mk.keyword_id) AS sum_keyword_ids, COUNT(DISTINCT cn.id) AS count_distinct_character_names, MAX(ct.kind) AS max_comp_cast_type_kind FROM movie_info mi JOIN movie_keyword mk ON mi.movie_id = mk.movie_id JOIN char_name cn ON cn.id = mk.id JOIN comp_cast_type ct ON ct.id = cn.id WHERE mi.info IN ('French', 'Macedonian', 'Tatar') AND mk.movie_id IN ('12263', '18845') AND mi.id IN ('7268883', '7269557', '7270084') GROUP BY mi.info;
SELECT MIN(t.title) AS movie_title, MIN(at.title) AS alternative_title, AVG(ci.nr_order) AS average_cast_order, COUNT(DISTINCT t.id) AS number_of_movies, COUNT(DISTINCT ci.person_id) AS number_of_unique_actors, SUM(CASE WHEN t.production_year BETWEEN 1970 AND 1980 THEN 1 ELSE 0 END) AS movies_produced_1970_to_1980, SUM(CASE WHEN t.production_year BETWEEN 1981 AND 1990 THEN 1 ELSE 0 END) AS movies_produced_1981_to_1990, SUM(CASE WHEN t.production_year BETWEEN 1991 AND 2000 THEN 1 ELSE 0 END) AS movies_produced_1991_to_2000 FROM title AS t INNER JOIN aka_title AS at ON t.id = at.movie_id AND at.kind_id IN (1, 3) INNER JOIN cast_info AS ci ON t.id = ci.movie_id WHERE t.production_year IN (1985, 1975, 1950, 1972) GROUP BY t.kind_id HAVING COUNT(DISTINCT ci.person_id) > 10 ORDER BY number_of_movies DESC, average_cast_order;
SELECT ct.kind AS company_kind, kt.kind AS movie_kind, COUNT(ml.id) AS total_links, AVG(ml.link_type_id) AS average_link_type, SUM(ml.link_type_id) AS sum_link_type FROM movie_link AS ml JOIN company_type AS ct ON ct.id = 2 JOIN kind_type AS kt ON kt.id = ml.link_type_id WHERE kt.kind IN ('episode', 'video movie', 'tv movie') GROUP BY ct.kind, kt.kind ORDER BY total_links DESC;
SELECT MIN(n.name) AS actor_name, AVG(CASE WHEN mi.info_type_id = (SELECT id FROM info_type WHERE info = 'runtime') THEN mi.info::FLOAT ELSE NULL END) AS average_movie_length, COUNT(DISTINCT k.id) AS unique_keywords_count, SUM(CASE WHEN ct.id = '1' THEN 1 ELSE 0 END) AS production_company_movies, SUM(CASE WHEN ct.id = '2' THEN 1 ELSE 0 END) AS distributor_movies, COUNT(DISTINCT a_t.id) AS total_movies_count FROM name AS n JOIN aka_name AS an ON n.id = an.person_id JOIN movie_info AS mi ON mi.movie_id = an.id JOIN movie_keyword AS mk ON mk.movie_id = an.id JOIN keyword AS k ON k.id = mk.keyword_id JOIN aka_title AS a_t ON a_t.movie_id = an.id JOIN movie_companies AS mc ON mc.movie_id = an.id JOIN company_type AS ct ON ct.id = mc.company_type_id WHERE n.name_pcode_nf = 'J4163' AND ct.id IN ('1', '2', '3', '4') GROUP BY n.id;
SELECT kt.kind AS movie_kind, COUNT(DISTINCT ci.movie_id) AS number_of_movies, AVG(ci.nr_order) AS average_cast_order, SUM(CASE WHEN ml.link_type_id = lt.id AND lt.link = 'features' THEN 1 ELSE 0 END) AS total_features_links, COUNT(DISTINCT cn.id) AS number_of_production_companies, AVG(ati.production_year) AS average_production_year_of_akas FROM cast_info ci JOIN kind_type kt ON ci.role_id = kt.id LEFT JOIN movie_link ml ON ci.movie_id = ml.movie_id LEFT JOIN link_type lt ON ml.link_type_id = lt.id LEFT JOIN aka_title ati ON ci.movie_id = ati.movie_id LEFT JOIN company_name cn ON ati.movie_id = cn.imdb_id GROUP BY kt.kind ORDER BY number_of_movies DESC;
SELECT n.name AS actor_name, COUNT(DISTINCT ci.movie_id) AS movie_count, AVG(t.production_year) AS average_production_year, SUM(CASE WHEN ct.kind = 'distributors' THEN 1 ELSE 0 END) AS distributor_movie_count, COUNT(DISTINCT mk.keyword_id) AS unique_keyword_count, COUNT(DISTINCT ml.linked_movie_id) AS linked_movie_count FROM name AS n JOIN cast_info AS ci ON n.id = ci.person_id JOIN title AS t ON ci.movie_id = t.id LEFT JOIN movie_companies AS mc ON t.id = mc.movie_id LEFT JOIN company_type AS ct ON mc.company_type_id = ct.id LEFT JOIN movie_keyword AS mk ON t.id = mk.movie_id LEFT JOIN movie_link AS ml ON t.id = ml.movie_id WHERE n.name IN ('Anderson, Abe', 'Anderako, Mark', 'Anagnostopoulos, Ilias') AND mc.company_type_id IN (SELECT id FROM company_type WHERE kind IN ('special effects companies', 'miscellaneous companies', 'distributors')) GROUP BY n.name;
SELECT CN.name AS company_name, COUNT(DISTINCT AN.id) AS total_aliases, AVG(AT.production_year) AS average_production_year, SUM(CASE WHEN N.gender = 'M' THEN 1 ELSE 0 END) AS male_actors_count, SUM(CASE WHEN N.gender = 'F' THEN 1 ELSE 0 END) AS female_actors_count FROM company_name CN JOIN aka_title AT ON CN.id = AT.movie_id JOIN aka_name AN ON AN.person_id = AT.movie_id JOIN name N ON N.id = AN.person_id WHERE CN.country_code = 'US' AND AT.production_year >= 2000 AND N.gender IN ('M', 'F') GROUP BY CN.name;
SELECT mc.company_id, COUNT(DISTINCT cc.movie_id) AS total_movies, AVG(mi_idx_numeric.info::NUMERIC) AS average_numeric_info, SUM(CASE WHEN mc.company_type_id = 1 THEN 1 ELSE 0 END) AS production_companies, SUM(CASE WHEN mc.company_type_id = 2 THEN 1 ELSE 0 END) AS distribution_companies FROM movie_companies AS mc JOIN complete_cast AS cc ON mc.movie_id = cc.movie_id JOIN movie_info_idx AS mi_idx ON mc.movie_id = mi_idx.movie_id JOIN movie_info_idx AS mi_idx_numeric ON mc.movie_id = mi_idx_numeric.movie_id AND mi_idx_numeric.info ~ '^[0-9\.]+$' WHERE mi_idx.info_type_id = 3 GROUP BY mc.company_id HAVING COUNT(DISTINCT cc.movie_id) > 5 ORDER BY total_movies DESC, average_numeric_info DESC;
SELECT AVG(CAST(mi_idx.info AS NUMERIC)) AS average_rating, COUNT(DISTINCT a_title.movie_id) AS number_of_movies, COUNT(DISTINCT a_name.person_id) AS number_of_people, SUM(CASE WHEN m_link.link_type_id = 1 THEN 1 ELSE 0 END) AS number_of_prequels, SUM(CASE WHEN m_link.link_type_id = 2 THEN 1 ELSE 0 END) AS number_of_sequels, AVG(a_title.production_year) AS average_production_year FROM aka_title AS a_title JOIN aka_name AS a_name ON a_title.movie_id = a_name.person_id JOIN movie_info_idx AS mi_idx ON a_title.movie_id = mi_idx.movie_id JOIN movie_link AS m_link ON a_title.movie_id = m_link.movie_id WHERE a_title.md5sum IN ('d4b78437f259ec962b25a518a77b6488', '982d91d043a457fb7114c4e57fba41a9') AND mi_idx.info_type_id = 101 GROUP BY a_title.kind_id HAVING COUNT(DISTINCT a_title.movie_id) > 10;
SELECT ct.kind AS company_kind, COUNT(DISTINCT cn.id) AS number_of_companies, COUNT(DISTINCT lt.id) AS number_of_link_types, AVG(cn.imdb_id) AS average_imdb_id, SUM(CASE WHEN cn.country_code = 'US' THEN 1 ELSE 0 END) AS number_of_us_companies, MAX(cn.id) AS max_company_id FROM company_name cn JOIN company_type ct ON cn.id = ct.id JOIN link_type lt ON cn.id = lt.id WHERE cn.md5sum IN ('98b3290c059fa23b472f7277bba9e6c9', '7ddd8c092b2c8500fe94d9138d2cacd7') AND lt.id IN ('12', '13', '4', '14') GROUP BY ct.kind;
SELECT COUNT(DISTINCT n.id) AS total_actors, AVG(n.imdb_id) AS average_imdb_id, SUM(CASE WHEN n.gender = 'f' THEN 1 ELSE 0 END) AS female_actors_count, SUM(CASE WHEN n.gender = 'm' THEN 1 ELSE 0 END) AS male_actors_count, COUNT(DISTINCT k.id) AS total_distinct_keywords, STRING_AGG(DISTINCT k.keyword, ', ') AS keywords_list FROM name AS n JOIN cast_info AS ci ON n.id = ci.person_id JOIN movie_keyword AS mk ON ci.movie_id = mk.movie_id JOIN keyword AS k ON mk.keyword_id = k.id JOIN comp_cast_type AS cct ON ci.role_id = cct.id WHERE k.keyword IN ('graffiti', 'goblet') AND n.name LIKE '%a%' GROUP BY cct.kind ORDER BY total_actors DESC;
SELECT kt.kind AS movie_kind, COUNT(DISTINCT ml.movie_id) AS total_movies, COUNT(DISTINCT ci.person_id) AS total_individuals_involved, AVG(CAST(mi_idx.info AS NUMERIC)) AS average_rating, SUM(CASE WHEN lt.link = 'references' THEN 1 ELSE 0 END) AS total_references, STRING_AGG(DISTINCT k.keyword, ', ') AS associated_keywords FROM movie_link AS ml JOIN link_type AS lt ON ml.link_type_id = lt.id JOIN movie_info_idx AS mi_idx ON ml.movie_id = mi_idx.movie_id JOIN keyword AS k ON mi_idx.info_type_id = k.id JOIN kind_type AS kt ON mi_idx.info_type_id = kt.id JOIN cast_info AS ci ON ml.movie_id = ci.movie_id WHERE ml.link_type_id IN (4, 2, 13, 1, 11, 9) AND lt.link IN ('unknown link', 'references') AND mi_idx.info_type_id IN (SELECT id FROM info_type WHERE info = 'rating') AND kt.id IN (SELECT id FROM kind_type WHERE kind LIKE '%movie%') AND ci.note IN ('(producer)', '(executive producer)') GROUP BY kt.kind;
