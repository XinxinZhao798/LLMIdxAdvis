SELECT ct.kind AS cast_type, AVG(production_year) AS average_production_year, COUNT(DISTINCT ci.movie_id) AS number_of_movies, COUNT(DISTINCT ci.person_id) AS number_of_actors, COUNT(DISTINCT cn.id) AS number_of_characters, SUM(CASE WHEN ci.nr_order IS NOT NULL THEN 1 ELSE 0 END) AS number_of_credits_with_order FROM cast_info ci JOIN comp_cast_type ct ON ci.person_role_id = ct.id JOIN aka_title at ON ci.movie_id = at.movie_id JOIN char_name cn ON ci.person_id = cn.id WHERE at.kind_id = 1 AND ci.role_id IN (1,2) GROUP BY ct.kind ORDER BY number_of_movies DESC;
SELECT ct.kind AS company_type, COUNT(DISTINCT cc.movie_id) AS total_movies, COUNT(DISTINCT ml.movie_id) AS total_linked_movies, AVG(CAST(mi.info AS NUMERIC)) FILTER (WHERE it.info = 'budget') AS average_movie_budget, SUM(CAST(mi.info AS INTEGER)) FILTER (WHERE it.info = 'votes') AS total_movie_votes FROM company_type ct JOIN movie_companies mc ON mc.company_type_id = ct.id JOIN complete_cast cc ON cc.movie_id = mc.movie_id JOIN movie_link ml ON ml.movie_id = mc.movie_id JOIN movie_info mi ON mi.movie_id = mc.movie_id JOIN info_type it ON it.id = mi.info_type_id WHERE ct.kind IN ('distributors', 'special effects companies', 'production companies') AND cc.status_id IN (3, 4) AND mi.movie_id IN ('932270', '939910') AND mi.info IN ('Gujarati', 'Tagalog', 'French', 'Portuguese') GROUP BY ct.kind ORDER BY total_movies DESC, average_movie_budget DESC;
SELECT ct.kind AS company_kind, COUNT(DISTINCT ml.movie_id) AS linked_movies_count, COUNT(DISTINCT k.id) AS unique_keywords_count, AVG(n.imdb_id) AS average_imdb_id, SUM(CASE WHEN n.gender = 'M' THEN 1 ELSE 0 END) AS male_count, SUM(CASE WHEN n.gender = 'F' THEN 1 ELSE 0 END) AS female_count FROM movie_link AS ml JOIN movie_link AS linked_ml ON ml.linked_movie_id = linked_ml.movie_id JOIN keyword AS k ON ml.id = k.id JOIN name AS n ON linked_ml.movie_id = n.id JOIN role_type AS rt ON n.id = rt.id JOIN company_type AS ct ON k.id = ct.id WHERE ct.id = 2 AND n.imdb_index = 'III' AND (n.name_pcode_nf = 'J5234' OR n.name_pcode_nf = 'W6526') GROUP BY ct.kind;
SELECT ct.kind AS company_kind, COUNT(DISTINCT cn.id) AS number_of_companies, COUNT(DISTINCT lt.id) AS number_of_link_types, AVG(cn.imdb_id) AS average_imdb_id, SUM(CASE WHEN cn.country_code = 'US' THEN 1 ELSE 0 END) AS number_of_us_companies, MAX(cn.id) AS max_company_id FROM company_name cn JOIN company_type ct ON cn.id = ct.id JOIN link_type lt ON cn.id = lt.id WHERE cn.md5sum IN ('98b3290c059fa23b472f7277bba9e6c9', '7ddd8c092b2c8500fe94d9138d2cacd7') AND lt.id IN ('12', '13', '4', '14') GROUP BY ct.kind;
SELECT rt.ROLE, COUNT(DISTINCT ci.movie_id) AS number_of_movies, AVG(n.imdb_id) AS average_imdb_id, SUM(ci.nr_order) AS total_order_sum, COUNT(DISTINCT ci.person_id) AS unique_actors, COUNT(DISTINCT mi.movie_id) AS movies_with_info, COUNT(DISTINCT ml.linked_movie_id) AS linked_movies_count FROM role_type rt JOIN cast_info ci ON rt.id = ci.role_id JOIN name n ON ci.person_id = n.id LEFT JOIN movie_info mi ON ci.movie_id = mi.movie_id LEFT JOIN movie_link ml ON ci.movie_id = ml.movie_id WHERE ci.nr_order IS NOT NULL AND mi.info_type_id IN (SELECT id FROM info_type WHERE info = 'rating') AND ci.movie_id IN ('929798', '929796', '924886', '927401', '924550', '927661') AND ci.person_id IN ('1575', '1023', '1432', '1713') AND ml.linked_movie_id IN ('1915722', '1526520') AND n.gender IN ('M', 'F') GROUP BY rt.ROLE ORDER BY number_of_movies DESC;
SELECT kt.kind AS content_type, COUNT(*) AS total_titles, AVG(cn.imdb_id) AS average_imdb_id, COUNT(DISTINCT cn.country_code) AS unique_country_codes, SUM(CASE WHEN an.imdb_index = 'I' THEN 1 ELSE 0 END) AS count_primary_aka_names FROM kind_type AS kt JOIN company_name AS cn ON cn.id = kt.id LEFT JOIN aka_name AS an ON an.person_id = cn.id WHERE kt.id IN ('4', '3', '5', '6', '1', '2') GROUP BY kt.kind ORDER BY total_titles DESC;
SELECT cn.name AS company_name, COUNT(DISTINCT mc.movie_id) AS total_movies_produced, AVG(cast_count.cast_count) AS average_cast_per_movie, SUM(keyword_count.keyword_count) AS total_keywords FROM movie_companies AS mc JOIN company_name AS cn ON mc.company_id = cn.id LEFT JOIN (SELECT movie_id, COUNT(*) AS cast_count FROM cast_info GROUP BY movie_id) AS cast_count ON mc.movie_id = cast_count.movie_id LEFT JOIN (SELECT movie_id, COUNT(*) AS keyword_count FROM movie_keyword GROUP BY movie_id) AS keyword_count ON mc.movie_id = keyword_count.movie_id GROUP BY cn.name ORDER BY total_movies_produced DESC, average_cast_per_movie DESC, total_keywords DESC;
SELECT ct.kind AS company_category, COUNT(DISTINCT ml.movie_id) AS total_movies_linked, COUNT(DISTINCT akn.person_id) AS distinct_person_count, SUM(CASE WHEN ml.id IN ('3629', '2913', '3444', '4653', '4412', '4422') THEN 1 ELSE 0 END) AS special_movie_links_count FROM movie_link AS ml JOIN company_type AS ct ON ct.kind IN ('special effects companies', 'miscellaneous companies') LEFT JOIN aka_name AS akn ON akn.person_id = ml.movie_id GROUP BY ct.kind;
SELECT it.info AS info_type, AVG(mi.production_year) AS average_production_year, COUNT(DISTINCT k.id) AS number_of_unique_keywords, COUNT(DISTINCT ml.movie_id) AS number_of_movies_linked, SUM(CASE WHEN pi.info_type_id = it.id THEN 1 ELSE 0 END) AS number_of_person_info_entries FROM movie_info_idx AS mii JOIN aka_title AS mi ON mi.movie_id = mii.movie_id JOIN info_type AS it ON mii.info_type_id = it.id JOIN keyword AS k ON k.id = mii.info_type_id JOIN movie_link AS ml ON ml.movie_id = mii.movie_id JOIN person_info AS pi ON pi.info_type_id = it.id GROUP BY it.info ORDER BY number_of_unique_keywords DESC, average_production_year DESC;
SELECT it.info AS info_type, COUNT(DISTINCT mk.movie_id) AS total_movies_with_keywords, COUNT(DISTINCT cc.movie_id) AS total_movies_with_complete_cast, AVG(cn.imdb_id) AS average_imdb_id, SUM(CASE WHEN cn.country_code = 'US' THEN 1 ELSE 0 END) AS total_us_companies FROM movie_keyword AS mk INNER JOIN complete_cast AS cc ON mk.movie_id = cc.movie_id INNER JOIN company_name AS cn ON cn.imdb_id = mk.movie_id INNER JOIN info_type AS it ON it.id = cc.subject_id WHERE mk.id IN (3843, 4798) AND mk.movie_id IN (8317, 10013, 9914, 7373) AND cn.md5sum IN ( '8d978787b0ec287764f214189bd27ccc', 'cd11f002bfac4110767acd038dad525d', 'f528d5021e84ca97756808ca01ec4605', '885492194dc62a66d0fb18ca950f6163', 'c2c967c278a15530e9f0d846e4f11a14' ) AND it.info IN ('LD analog left', 'quotes', 'admissions') GROUP BY it.info;
SELECT ct.kind AS company_kind, COUNT(DISTINCT mc.movie_id) AS number_of_movies, AVG(CAST(mi_idx.info AS numeric)) AS average_rating, SUM(CASE WHEN cct.kind = 'complete+verified' THEN 1 ELSE 0 END) AS complete_verified_casts, COUNT(DISTINCT cn.id) AS number_of_actors FROM movie_companies AS mc JOIN company_type AS ct ON mc.company_type_id = ct.id LEFT JOIN movie_info_idx AS mi_idx ON mc.movie_id = mi_idx.movie_id LEFT JOIN complete_cast AS cc ON mc.movie_id = cc.movie_id LEFT JOIN comp_cast_type AS cct ON cc.status_id = cct.id LEFT JOIN char_name AS cn ON cc.subject_id = cn.id WHERE mc.movie_id IN (27359, 1639517, 1663098) AND mc.company_id IN (SELECT company_id FROM movie_companies WHERE company_type_id IN (1, 2)) GROUP BY ct.kind HAVING COUNT(DISTINCT mc.movie_id) > 1 ORDER BY number_of_movies DESC, average_rating DESC;
SELECT COUNT(DISTINCT cn.id) AS number_of_companies, kt.kind AS movie_kind, AVG(cc.status_id) AS average_status, SUM(CASE WHEN cn.country_code = '[fi]' THEN 1 ELSE 0 END) AS finnish_companies_count, COUNT(DISTINCT cc.movie_id) AS movies_count FROM company_name AS cn JOIN complete_cast AS cc ON cn.imdb_id = cc.movie_id JOIN kind_type AS kt ON cc.subject_id = kt.id WHERE cn.md5sum IN ('df5f53a18aca1956d39f4c3e8efba40d', '1f4fb34b400c593a88ee241792a10246', '528802a0236e52af987bb556a2a18522', '5dfe4406cd7d44d4e65cce35f75b02cb') AND kt.kind = 'video movie' AND cc.status_id IN (4, 3) AND cc.movie_id = 51584 GROUP BY kt.kind;
SELECT kt.kind, AVG(at.production_year) AS avg_production_year, COUNT(DISTINCT at.title) AS title_count, SUM(CASE WHEN cn.id IS NOT NULL THEN 1 ELSE 0 END) AS unique_character_count FROM aka_title AS at JOIN kind_type AS kt ON at.kind_id = kt.id LEFT JOIN movie_info AS mi ON at.movie_id = mi.movie_id LEFT JOIN char_name AS cn ON mi.movie_id = cn.id WHERE at.production_year IS NOT NULL GROUP BY kt.kind ORDER BY avg_production_year DESC, title_count DESC;
SELECT ct.kind AS company_type, AVG(t.production_year) AS average_production_year, COUNT(DISTINCT t.id) AS number_of_titles, SUM(CASE WHEN t.kind_id = 3 THEN 1 ELSE 0 END) AS number_of_distributors_titles, SUM(CASE WHEN t.kind_id = 4 THEN 1 ELSE 0 END) AS number_of_special_effects_titles FROM title AS t JOIN company_type AS ct ON t.kind_id = ct.id GROUP BY ct.kind HAVING COUNT(DISTINCT t.id) > 0 ORDER BY number_of_titles DESC;
SELECT COUNT(DISTINCT n.id) AS total_actors, COUNT(DISTINCT ci.movie_id) AS movies_with_keywords, AVG(mi_idx.info::NUMERIC) AS average_movie_rating, SUM(CASE WHEN n.gender = 'm' THEN 1 ELSE 0 END) AS male_actors, SUM(CASE WHEN n.gender = 'f' THEN 1 ELSE 0 END) AS female_actors, MIN(cn.name) AS company_name FROM name AS n JOIN cast_info AS ci ON n.id = ci.person_id JOIN movie_keyword AS mk ON ci.movie_id = mk.movie_id JOIN keyword AS k ON mk.keyword_id = k.id JOIN movie_info_idx AS mi_idx ON ci.movie_id = mi_idx.movie_id JOIN company_name AS cn ON cn.imdb_id = mi_idx.movie_id WHERE k.keyword IN ('pearl', 'reference-to-john-the-baptist', 'gigantic-breasts', 'mental-abuse', 'hammer-moves-by-itself', 'picket-fence') AND mi_idx.info_type_id = (SELECT id FROM info_type WHERE info = 'rating') AND mi_idx.info > '2.0' AND n.gender IN ('m', 'f') AND ci.note IN ('CelebrityLoop.com', 'Les Maykithappen', 'Guy Bellinger', 'Allegra Masters', 'Anonymous') GROUP BY cn.name ORDER BY average_movie_rating DESC, total_actors DESC LIMIT 1;
SELECT kt.kind AS movie_type, COUNT(DISTINCT t.movie_id) AS total_movies, AVG(CAST(mi_idx.info AS NUMERIC)) AS average_rating, SUM(CASE WHEN ci.role_id = 1 THEN 1 ELSE 0 END) AS total_actors, SUM(CASE WHEN ci.role_id = 2 THEN 1 ELSE 0 END) AS total_directors FROM kind_type AS kt JOIN aka_title AS t ON kt.id = t.kind_id JOIN movie_info_idx AS mi_idx ON t.movie_id = mi_idx.movie_id LEFT JOIN cast_info AS ci ON t.movie_id = ci.movie_id WHERE mi_idx.info_type_id = 101 AND kt.kind IN ('movie', 'tv series') AND t.production_year BETWEEN 1990 AND 2023 GROUP BY kt.kind;
SELECT rt.role AS role_type, COUNT(*) AS total_roles, COUNT(DISTINCT cn.id) AS unique_characters, AVG(cn.imdb_id) AS average_imdb_id, SUM(cn.imdb_id) AS total_imdb_id, MAX(k.keyword) AS max_keyword, MIN(k.keyword) AS min_keyword, COUNT(DISTINCT k.id) AS total_unique_keywords FROM role_type rt JOIN char_name cn ON rt.id = cn.id JOIN keyword k ON cn.id = k.id GROUP BY rt.role ORDER BY total_roles DESC;
SELECT kt.kind AS movie_kind, lt.LINK AS link_type, COUNT(DISTINCT ml.movie_id) AS number_of_movies, AVG(cn.imdb_id) AS average_imdb_id, SUM(cn.imdb_id) AS total_imdb_id, MIN(cn.name) AS first_company_name_in_list FROM movie_link AS ml JOIN link_type AS lt ON lt.id = ml.link_type_id JOIN kind_type AS kt ON kt.id = 1 JOIN company_name AS cn ON cn.imdb_id = ml.movie_id WHERE lt.link IN ('edited into', 'edited from', 'remade as') AND cn.country_code = 'US' AND cn.name_pcode_nf IN ('Z5121', 'B4513', 'I5353', 'A3531') GROUP BY kt.kind, lt.LINK ORDER BY number_of_movies DESC;
