SELECT AVG(t.production_year) AS average_production_year, COUNT(DISTINCT n.id) AS total_actors, COUNT(DISTINCT pi.person_id) AS actors_with_additional_info, SUM(CASE WHEN rt.ROLE = 'Actor' THEN 1 ELSE 0 END) AS total_actor_roles, SUM(CASE WHEN rt.ROLE = 'Director' THEN 1 ELSE 0 END) AS total_director_roles, COUNT(DISTINCT t.id) AS total_titles FROM title t LEFT JOIN complete_cast cc ON t.id = cc.movie_id LEFT JOIN name n ON cc.subject_id = n.id LEFT JOIN role_type rt ON cc.status_id = rt.id LEFT JOIN person_info pi ON n.id = pi.person_id WHERE t.production_year IN ('1998', '1971') GROUP BY t.kind_id ORDER BY average_production_year DESC;
SELECT COUNT(DISTINCT cn.id) AS total_companies, AVG(t.production_year) AS average_production_year, SUM(CASE WHEN lt.id = '15' THEN 1 ELSE 0 END) AS count_type_15_links, SUM(CASE WHEN lt.id = '12' THEN 1 ELSE 0 END) AS count_type_12_links, COUNT(DISTINCT t.id) AS total_titles, COUNT(DISTINCT mi_idx.info) AS total_unique_info FROM company_name cn JOIN movie_companies mc ON cn.id = mc.company_id JOIN title t ON mc.movie_id = t.id JOIN movie_info_idx mi_idx ON t.id = mi_idx.movie_id LEFT JOIN movie_link ml ON t.id = ml.movie_id LEFT JOIN link_type lt ON ml.link_type_id = lt.id WHERE cn.country_code = 'US' AND t.production_year BETWEEN 1990 AND 2000 AND mc.note IS NOT NULL AND (lt.id = '15' OR lt.id = '12') GROUP BY cn.country_code, t.production_year ORDER BY average_production_year DESC;
SELECT mc.company_id, COUNT(DISTINCT mc.movie_id) AS number_of_movies, cs.status_id, AVG(CAST(pi.info AS FLOAT)) FILTER (WHERE pi.info_type_id = 10) AS average_rating FROM movie_companies AS mc JOIN complete_cast AS cs ON mc.movie_id = cs.movie_id JOIN person_info AS pi ON cs.subject_id = pi.person_id GROUP BY mc.company_id, cs.status_id ORDER BY number_of_movies DESC, average_rating DESC;
SELECT kt.kind AS movie_kind, COUNT(DISTINCT ci.movie_id) AS number_of_movies, AVG(mi_idx.info::integer) AS average_rating, SUM(CASE WHEN cn.country_code = '[us]' THEN 1 ELSE 0 END) AS number_of_us_companies_involved, COUNT(DISTINCT ci.person_id) AS number_of_cast_members FROM movie_companies AS mc JOIN kind_type AS kt ON kt.id = mc.company_type_id JOIN cast_info AS ci ON ci.movie_id = mc.movie_id JOIN company_name AS cn ON cn.id = mc.company_id JOIN movie_info_idx AS mi_idx ON mi_idx.movie_id = mc.movie_id AND mi_idx.info_type_id = 101 WHERE mc.movie_id IN (19315, 15715, 19236, 19775, 18865, 11243) AND mc.note LIKE '%(TV)%' AND kt.kind IN ('movie', 'episode') AND cn.name_pcode_sf IN ('B5261', 'H1535', 'T5642', 'W5214', 'C3163', 'K2145') GROUP BY kt.kind;
SELECT rt.ROLE, COUNT(DISTINCT ci.person_id) AS total_persons, COUNT(DISTINCT ci.movie_id) AS total_movies, AVG(ci.nr_order) AS average_order, COUNT(DISTINCT mc.company_id) AS total_companies, COUNT(DISTINCT ml.linked_movie_id) AS total_linked_movies FROM cast_info AS ci JOIN role_type AS rt ON ci.role_id = rt.id JOIN movie_companies AS mc ON ci.movie_id = mc.movie_id JOIN movie_link AS ml ON ci.movie_id = ml.movie_id WHERE rt.ROLE IN ('cinematographer', 'actress', 'costume designer') AND ml.link_type_id IN (10, 8, 11, 13, 7, 6) AND (mc.note LIKE '%(1993) (UK) (all media)%' OR mc.note LIKE '%(1952-1960) (UK) (TV)%') GROUP BY rt.ROLE ORDER BY total_persons DESC;
SELECT kt.kind AS movie_kind, COUNT(*) AS total_movies, AVG(t.production_year) AS average_production_year, SUM(CASE WHEN mi.info = 'color' THEN 1 ELSE 0 END) AS color_movie_count, SUM(CASE WHEN mi.info = 'black and white' THEN 1 ELSE 0 END) AS black_and_white_movie_count FROM title AS t JOIN kind_type AS kt ON t.kind_id = kt.id JOIN movie_info AS mi ON t.id = mi.movie_id WHERE t.production_year BETWEEN 2000 AND 2010 AND mi.info_type_id IN (SELECT id FROM info_type WHERE info IN ('color', 'black and white')) GROUP BY kt.kind HAVING COUNT(*) > 100 ORDER BY total_movies DESC, average_production_year;
SELECT kt.kind, COUNT(DISTINCT mc.movie_id) AS number_of_movies, COUNT(DISTINCT cn.id) AS number_of_characters, AVG(cn.imdb_id) AS average_imdb_id, SUM(CASE WHEN cn.surname_pcode = 'T5253' THEN 1 ELSE 0 END) AS count_surname_T5253, SUM(CASE WHEN cn.surname_pcode = 'M5253' THEN 1 ELSE 0 END) AS count_surname_M5253, COUNT(DISTINCT mc.company_id) AS number_of_companies_involved, STRING_AGG(DISTINCT rt.ROLE, ', ') AS roles_involved, STRING_AGG(DISTINCT mc.note, '; ') AS production_notes FROM kind_type kt LEFT JOIN movie_companies mc ON kt.id = mc.company_type_id LEFT JOIN char_name cn ON cn.id = mc.movie_id LEFT JOIN role_type rt ON rt.id = mc.company_type_id WHERE kt.kind IN ('episode', 'tv movie', 'movie', 'video movie', 'tv mini series', 'video game') AND mc.company_type_id = 1 AND (cn.surname_pcode IN ('T5253', 'M5253') OR cn.name IN ('Ish', 'Conti', 'Governor of the town', 'Himself - Grand Questor', 'Miss Travers''s Class')) AND rt.ROLE IN ('costume designer', 'production designer', 'cinematographer', 'director', 'writer', 'miscellaneous crew') AND mc.note LIKE '%(TV)%' GROUP BY kt.kind;
SELECT ct.kind AS company_type, COUNT(DISTINCT mc.movie_id) AS number_of_movies, AVG(aka.production_year) AS average_production_year, COUNT(DISTINCT cn.id) AS number_of_companies, COUNT(DISTINCT char_name.id) AS number_of_unique_char_names FROM movie_companies mc JOIN aka_title aka ON mc.movie_id = aka.movie_id JOIN company_name cn ON mc.company_id = cn.id JOIN company_type ct ON mc.company_type_id = ct.id JOIN char_name ON cn.id = char_name.id WHERE ct.kind NOT IN ('subsidiary', 'division') AND char_name.id IN ('12861', '46459', '54418', '37871', '75348') AND aka.production_year BETWEEN 2000 AND 2010 GROUP BY ct.kind ORDER BY number_of_movies DESC, average_production_year;
SELECT t.production_year, kt.kind, AVG(LENGTH(t.title)) AS average_title_length, COUNT(DISTINCT t.id) AS total_movies, COUNT(DISTINCT mc.company_id) AS total_companies_involved FROM title AS t JOIN kind_type AS kt ON t.kind_id = kt.id JOIN movie_companies AS mc ON t.id = mc.movie_id WHERE t.production_year IS NOT NULL AND kt.kind IS NOT NULL GROUP BY t.production_year, kt.kind ORDER BY t.production_year DESC, kt.kind;
SELECT cn.name AS company_name, ct.kind AS cast_type, COUNT(ml.id) AS total_movie_links, AVG(ml.linked_movie_id) AS average_linked_movie_imdb_id, COUNT(DISTINCT chn.id) AS total_characters FROM company_name cn JOIN movie_link ml ON cn.id = ml.movie_id JOIN comp_cast_type ct ON ml.link_type_id = ct.id LEFT JOIN char_name chn ON ml.movie_id = chn.id WHERE cn.country_code = 'US' AND cn.name_pcode_sf BETWEEN 'A0000' AND 'Z9999' GROUP BY cn.name, ct.kind ORDER BY total_movie_links DESC, average_linked_movie_imdb_id;
SELECT ct.kind AS company_kind, it.info AS info_category, AVG(t.production_year) AS average_production_year, COUNT(t.id) AS total_titles, SUM(CASE WHEN p.info = 'Adams, Terry Wayne' THEN 1 ELSE 0 END) AS count_terry_wayne_adams_mentions, SUM(CASE WHEN p.info = '14 March 1879' THEN 1 ELSE 0 END) AS count_14_march_1879_mentions FROM title AS t JOIN company_type AS ct ON t.kind_id = ct.id JOIN person_info AS p ON p.info_type_id = ct.id JOIN info_type AS it ON p.info_type_id = it.id WHERE t.production_year BETWEEN 1990 AND 2020 GROUP BY ct.kind, it.info HAVING COUNT(t.id) > 10;
SELECT rt.ROLE, COUNT(DISTINCT ci.movie_id) AS num_movies, COUNT(ci.person_id) AS num_performances, AVG(at.production_year) AS avg_production_year, SUM(CASE WHEN k.keyword = 'drama' THEN 1 ELSE 0 END) AS drama_keyword_count FROM cast_info ci JOIN role_type rt ON ci.role_id = rt.id JOIN aka_title at ON ci.movie_id = at.movie_id LEFT JOIN (SELECT mk.movie_id, k.keyword FROM movie_keyword mk JOIN keyword k ON mk.keyword_id = k.id) AS k ON ci.movie_id = k.movie_id WHERE rt.id IN ('12', '7', '9', '3') AND ci.person_id IN ('1145', '1200', '1289') AND at.movie_id IN ('19436', '18749', '11251', '18754', '17100') GROUP BY rt.ROLE HAVING COUNT(DISTINCT ci.movie_id) > 1 ORDER BY num_movies DESC, num_performances DESC;
SELECT cn.name AS company_name, COUNT(DISTINCT at.title) AS total_titles, AVG(at.production_year) AS average_production_year, COUNT(DISTINCT mk.keyword_id) AS unique_keywords, AVG(LENGTH(at.title)) AS average_title_length FROM company_name cn LEFT JOIN aka_title at ON cn.id = at.movie_id LEFT JOIN movie_keyword mk ON at.movie_id = mk.movie_id WHERE cn.country_code = 'US' GROUP BY cn.name ORDER BY total_titles DESC;
SELECT kt.kind AS movie_kind, AVG(aka.production_year) AS avg_production_year, COUNT(DISTINCT aka.movie_id) AS total_movies, COUNT(DISTINCT mc.company_id) AS total_companies_involved, SUM(CASE WHEN aka.kind_id = 4 THEN 1 ELSE 0 END) AS total_tv_series FROM aka_title aka JOIN kind_type kt ON aka.kind_id = kt.id LEFT JOIN movie_companies mc ON aka.movie_id = mc.movie_id GROUP BY kt.kind HAVING COUNT(DISTINCT aka.movie_id) > 100 ORDER BY avg_production_year DESC, total_movies;
SELECT ct.kind AS company_type, COUNT(DISTINCT cn.id) AS number_of_companies, COUNT(DISTINCT mc.movie_id) AS number_of_movies, AVG(mi_idx.avg_movie_score) AS average_movie_score, SUM(CASE WHEN mi.info = '(Original Version)' THEN 1 ELSE 0 END) AS original_version_count, SUM(CASE WHEN mi.info = '(English subtitles)' THEN 1 ELSE 0 END) AS english_subtitles_count FROM movie_companies AS mc JOIN company_name AS cn ON mc.company_id = cn.id JOIN company_type AS ct ON mc.company_type_id = ct.id JOIN (SELECT movie_id, AVG(CAST(info AS DOUBLE PRECISION)) AS avg_movie_score FROM movie_info_idx WHERE info_type_id = 101 GROUP BY movie_id) AS mi_idx ON mc.movie_id = mi_idx.movie_id LEFT JOIN movie_info AS mi ON mc.movie_id = mi.movie_id WHERE ct.kind IN ('special effects companies', 'miscellaneous companies', 'production companies', 'distributors') GROUP BY ct.kind;
SELECT COUNT(DISTINCT at.id) AS number_of_titles, AVG(at.production_year) AS average_production_year, rt.role AS role_type, COUNT(DISTINCT mi.id) AS number_of_movie_infos, SUM(CASE WHEN at.kind_id = '1' THEN 1 ELSE 0 END) AS number_of_movies, SUM(CASE WHEN at.kind_id = '2' THEN 1 ELSE 0 END) AS number_of_tv_shows, COUNT(DISTINCT at.episode_of_id) AS number_of_unique_series, MAX(at.season_nr) AS max_season_number, MAX(at.episode_nr) AS max_episode_number FROM aka_title at JOIN movie_info mi ON at.movie_id = mi.movie_id JOIN role_type rt ON mi.info_type_id = rt.id WHERE at.production_year BETWEEN 1990 AND 2020 AND mi.info LIKE '%color%' GROUP BY rt.role ORDER BY number_of_titles DESC, average_production_year;
SELECT cn.name AS character_name, COUNT(cn.id) AS character_occurrences, AVG(cn.imdb_id) AS average_imdb_id FROM char_name AS cn JOIN aka_name AS akn ON akn.person_id = cn.id JOIN company_type AS ct ON ct.id = akn.person_id WHERE ct.kind = 'distributors' GROUP BY cn.name ORDER BY character_occurrences DESC, average_imdb_id DESC;
SELECT c.name AS company_name, c.country_code, kt.kind AS movie_type, COUNT(DISTINCT mi.movie_id) AS number_of_movies, AVG(CAST(mi_num.info AS DECIMAL)) AS average_rating, SUM(CASE WHEN mk.keyword_id = 3569 THEN 1 ELSE 0 END) AS count_of_keyword_3569, SUM(CASE WHEN mk.keyword_id = 3677 THEN 1 ELSE 0 END) AS count_of_keyword_3677, COUNT(DISTINCT ml.id) AS number_of_movie_links, COUNT(DISTINCT mi.id) AS number_of_movie_infos FROM company_name c JOIN movie_info mi ON c.imdb_id = mi.movie_id JOIN info_type it ON mi.info_type_id = it.id JOIN movie_keyword mk ON mi.movie_id = mk.movie_id JOIN movie_link ml ON mi.movie_id = ml.movie_id JOIN kind_type kt ON it.id = kt.id LEFT JOIN movie_info mi_num ON mi.movie_id = mi_num.movie_id AND mi_num.info_type_id = ( SELECT id FROM info_type WHERE info = 'rating' ) WHERE c.country_code = 'US' AND it.info = 'countries' AND kt.kind = 'movie' GROUP BY c.name, c.country_code, kt.kind ORDER BY number_of_movies DESC;
SELECT MAX(cn.name) AS company_name, ct.kind AS company_kind, COUNT(DISTINCT cn.id) AS num_companies, AVG(cn.imdb_id) AS average_imdb_id, COUNT(DISTINCT cct.id) AS cast_type_count, SUM(CASE WHEN cn.country_code = 'US' THEN 1 ELSE 0 END) AS us_based_companies, COUNT(DISTINCT it.id) AS info_type_count, COUNT(DISTINCT lt.id) AS link_type_count FROM company_name cn JOIN company_type ct ON cn.id = ct.id JOIN comp_cast_type cct ON cn.id = cct.id JOIN info_type it ON cn.id = it.id JOIN link_type lt ON cn.id = lt.id WHERE cn.country_code IN ('US', 'JP', 'FR') AND cn.name_pcode_sf IN ('M3652', 'A6163', 'L2641', 'D6123') AND ct.id IN (1, 2, 3, 4) AND ct.kind IN ('special effects companies', 'miscellaneous companies', 'production companies', 'distributors') GROUP BY ct.kind ORDER BY us_based_companies DESC, num_companies DESC;
SELECT kt.kind AS movie_kind, AVG(aka.production_year) AS average_production_year, COUNT(DISTINCT aka.movie_id) AS number_of_movies, COUNT(DISTINCT mk.keyword_id) AS number_of_unique_keywords, SUM(CASE WHEN aka.title = 'Sea of Love' THEN 1 ELSE 0 END) AS count_sea_of_love, SUM(CASE WHEN aka.title = 'Anna of Rhodes' THEN 1 ELSE 0 END) AS count_anna_of_rhodes, SUM(CASE WHEN aka.title = 'The Last Days on Earth' THEN 1 ELSE 0 END) AS count_last_days_on_earth, SUM(CASE WHEN aka.title = 'Hammer Session!' THEN 1 ELSE 0 END) AS count_hammer_session, SUM(CASE WHEN aka.title = 'Bank Vault 713' THEN 1 ELSE 0 END) AS count_bank_vault_713 FROM aka_title AS aka JOIN kind_type AS kt ON aka.kind_id = kt.id LEFT JOIN movie_keyword AS mk ON aka.movie_id = mk.movie_id GROUP BY kt.kind ORDER BY average_production_year DESC, number_of_movies DESC;
