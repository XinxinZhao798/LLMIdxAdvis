SELECT mi.info AS genre, COUNT(DISTINCT t.id) AS number_of_movies, AVG(mi_idx.info::numeric) AS average_rating, COUNT(DISTINCT p.id) AS number_of_cast_members, SUM(CASE WHEN t.production_year BETWEEN 2000 AND 2010 THEN 1 ELSE 0 END) AS movies_2000_2010 FROM movie_info mi JOIN title t ON mi.movie_id = t.id LEFT JOIN movie_info mi_idx ON t.id = mi_idx.movie_id AND mi_idx.info_type_id = 4 JOIN complete_cast cc ON t.id = cc.movie_id JOIN person_info p ON cc.subject_id = p.person_id JOIN movie_companies mc ON t.id = mc.movie_id WHERE mi.info_type_id = 3 AND cc.status_id = 1 AND mc.company_type_id = 2 GROUP BY mi.info ORDER BY number_of_movies DESC, average_rating DESC;
SELECT kt.kind AS movie_kind, MIN(at.title) AS alternative_title, AVG(CASE WHEN mi.info_type_id = it.id AND it.info = 'rating' THEN CAST(mi.info AS FLOAT) END) AS average_rating, COUNT(DISTINCT cn.id) AS number_of_companies_involved, SUM(CASE WHEN mc.company_type_id = ct.id AND ct.kind = 'production' THEN 1 ELSE 0 END) AS total_production_companies, MAX(at.production_year) AS latest_production_year FROM kind_type AS kt LEFT JOIN aka_title AS at ON kt.id = at.kind_id LEFT JOIN movie_info AS mi ON at.movie_id = mi.movie_id LEFT JOIN info_type AS it ON mi.info_type_id = it.id LEFT JOIN movie_companies AS mc ON at.movie_id = mc.movie_id LEFT JOIN company_name AS cn ON mc.company_id = cn.id LEFT JOIN comp_cast_type AS ct ON mc.company_type_id = ct.id WHERE at.production_year >= 1990 AND (at.title = 'The 11th Hour' OR at.title = 'Anna and Wulin' OR at.title = 'Arabian Tale') AND (at.imdb_index = 'I' OR at.imdb_index = 'III' OR at.imdb_index = 'IV') GROUP BY kt.kind;
SELECT COUNT(DISTINCT mi.movie_id) AS total_movies, AVG(CAST(mi_idx.info AS NUMERIC)) AS average_movie_rating, SUM(CASE WHEN at.kind_id = 1 THEN 1 ELSE 0 END) AS total_movies_kind_1, COUNT(DISTINCT mc.company_id) AS total_production_companies, COUNT(DISTINCT n.id) AS total_unique_names, MAX(at.production_year) AS latest_production_year, MIN(at.production_year) AS earliest_production_year FROM movie_info mi JOIN movie_info_idx mi_idx ON mi.movie_id = mi_idx.movie_id AND mi.info_type_id = mi_idx.info_type_id JOIN aka_title at ON mi.movie_id = at.movie_id JOIN movie_companies mc ON mi.movie_id = mc.movie_id JOIN name n ON n.id = ANY(ARRAY(SELECT movie_id FROM movie_info WHERE info_type_id = (SELECT id FROM info_type WHERE info = 'writers'))) WHERE mi.info_type_id = (SELECT id FROM info_type WHERE info = 'rating') AND CAST(mi_idx.info AS NUMERIC) > 5 AND at.production_year BETWEEN 1990 AND 2000 AND at.kind_id IN (1, 2, 3) GROUP BY at.kind_id ORDER BY total_movies_kind_1 DESC;
SELECT i.info AS genre, COUNT(DISTINCT k.keyword) AS number_of_keywords, AVG(m.production_year) AS average_production_year, SUM(CASE WHEN n.gender = 'M' THEN 1 ELSE 0 END) AS number_of_male_actors, SUM(CASE WHEN n.gender = 'F' THEN 1 ELSE 0 END) AS number_of_female_actors FROM movie_link AS ml JOIN keyword AS k ON ml.movie_id = k.id JOIN aka_title AS m ON ml.movie_id = m.movie_id JOIN name AS n ON n.surname_pcode = m.phonetic_code JOIN person_info AS pi ON pi.person_id = n.id AND pi.info_type_id IN ('21', '24', '35', '17', '27') JOIN info_type AS i ON pi.info_type_id = i.id WHERE ml.linked_movie_id IN ('1928558', '571140', '1683460', '1635656', '1308096') AND ml.movie_id IN ('11141', '2036', '14524', '6636') AND n.surname_pcode IN ('A426', 'A436', 'A465', 'A453') GROUP BY i.info;
SELECT kt.kind, AVG(t.production_year) AS average_production_year, COUNT(DISTINCT t.id) AS total_titles, SUM(CASE WHEN rt.role = 'cinematographer' THEN 1 ELSE 0 END) AS cinematographer_count, SUM(CASE WHEN rt.role = 'writer' THEN 1 ELSE 0 END) AS writer_count, SUM(CASE WHEN rt.role = 'miscellaneous crew' THEN 1 ELSE 0 END) AS miscellaneous_crew_count FROM title t JOIN kind_type kt ON t.kind_id = kt.id JOIN role_type rt ON t.id = rt.id WHERE kt.id IN (3, 7, 4, 6, 2) AND rt.id IN (5, 3, 9, 4, 11, 6) AND t.production_year IS NOT NULL GROUP BY kt.kind ORDER BY average_production_year DESC;
SELECT it.info AS info_category, COUNT(DISTINCT n.id) AS total_people, COUNT(DISTINCT pi.person_id) AS people_with_info, AVG(n.imdb_id) AS average_imdb_id, SUM(CASE WHEN n.gender = 'M' THEN 1 ELSE 0 END) AS total_males, SUM(CASE WHEN n.gender = 'F' THEN 1 ELSE 0 END) AS total_females FROM name AS n LEFT JOIN person_info AS pi ON n.id = pi.person_id JOIN info_type AS it ON pi.info_type_id = it.id GROUP BY it.info;
SELECT it.info AS information_type, COUNT(DISTINCT at.movie_id) AS total_movies, AVG(at.production_year) AS average_production_year, SUM(CASE WHEN k.phonetic_code = 'H5632' THEN 1 ELSE 0 END) AS count_specific_phonetic_code, COUNT(DISTINCT k.id) AS unique_keywords_used FROM aka_title at JOIN info_type it ON at.kind_id = it.id LEFT JOIN keyword k ON at.movie_id = k.id WHERE at.kind_id IN (7, 3, 4) AND it.info IN ('trade mark', 'production process protocol', 'languages', 'LD catalog number', 'mini biography') AND at.production_year IS NOT NULL GROUP BY it.info ORDER BY total_movies DESC, average_production_year DESC;
SELECT ct.kind AS company_kind, COUNT(DISTINCT mc.movie_id) AS num_movies, COUNT(DISTINCT ci.person_id) AS num_people_involved, AVG(ci.nr_order) AS average_cast_order, SUM(CASE WHEN n.gender = 'M' THEN 1 ELSE 0 END) AS num_male_actors, SUM(CASE WHEN n.gender = 'F' THEN 1 ELSE 0 END) AS num_female_actors FROM movie_companies AS mc JOIN company_type AS ct ON mc.company_type_id = ct.id LEFT JOIN cast_info AS ci ON mc.movie_id = ci.movie_id LEFT JOIN name AS n ON ci.person_id = n.id WHERE ct.id IN (2, 3, 4) GROUP BY ct.kind
SELECT at.production_year, COUNT(DISTINCT at.movie_id) AS total_movies, AVG(at.episode_nr) AS average_episodes_per_season, COUNT(DISTINCT rt.id) AS distinct_roles_count FROM aka_title at JOIN role_type rt ON at.kind_id = rt.id JOIN info_type it ON at.id = it.id WHERE at.production_year IN (1972, 1934, 1943) AND rt.role IN ('production designer', 'composer', 'guest', 'producer', 'actor', 'writer') AND it.info IN ('admissions', 'votes', 'LD master format', 'soundtrack') GROUP BY at.production_year ORDER BY at.production_year;
SELECT mc.company_id, it.info AS keyword, COUNT(DISTINCT mk.movie_id) AS movies_count, AVG(sub.person_count) AS avg_cast_size FROM movie_keyword AS mk JOIN (SELECT id, info FROM info_type WHERE id IN (3708, 323, 4279) ) AS it ON it.id = mk.keyword_id JOIN movie_companies AS mc ON mk.movie_id = mc.movie_id AND mc.company_type_id = 1 LEFT JOIN (SELECT ci.movie_id, COUNT(DISTINCT ci.person_id) AS person_count FROM cast_info AS ci GROUP BY ci.movie_id ) AS sub ON mk.movie_id = sub.movie_id GROUP BY mc.company_id, it.info ORDER BY mc.company_id, movies_count DESC;
SELECT it.info AS info_type, COUNT(*) AS total_movies, AVG(CAST(mi.info AS INTEGER)) AS average_info_value, SUM(CAST(mi.info AS INTEGER)) AS sum_info_value, COUNT(DISTINCT cc.movie_id) AS count_distinct_movies FROM movie_info_idx mi JOIN info_type it ON mi.info_type_id = it.id LEFT JOIN complete_cast cc ON mi.movie_id = cc.movie_id WHERE it.id IN (27, 34, 97, 20, 80, 54) AND mi.movie_id IN (19576, 19282, 18727, 13977, 7344) GROUP BY it.info;
SELECT COUNT(DISTINCT mi.movie_id) AS number_of_movies, AVG(CAST(mi.info AS DECIMAL)) AS average_info_rating, SUM(CASE WHEN mi.info_type_id = 101 THEN CAST(mi.info AS BIGINT) ELSE 0 END) AS total_info_type_101, MAX(t.production_year) AS latest_production_year, MIN(t.production_year) AS earliest_production_year, COUNT(DISTINCT mk.keyword_id) AS distinct_keywords, COUNT(DISTINCT t.id) FILTER (WHERE t.production_year BETWEEN 2000 AND 2010) AS movies_between_2000_and_2010 FROM movie_info_idx mi JOIN title t ON mi.movie_id = t.id LEFT JOIN movie_keyword mk ON t.id = mk.movie_id WHERE mi.info SIMILAR TO '%(4.4|0100111101|36|6000000001|1.0..10113)%' AND mi.movie_id IN (19624, 8384) GROUP BY t.kind_id ORDER BY total_info_type_101 DESC;
SELECT ct.kind AS company_type, AVG(CAST(mi_idx.info AS numeric)) AS average_rating, COUNT(DISTINCT n.id) AS total_actors, COUNT(DISTINCT mk.movie_id) AS movies_with_keywords, SUM(CASE WHEN at.season_nr IS NOT NULL THEN 1 ELSE 0 END) AS total_episodes FROM movie_info_idx AS mi_idx JOIN aka_title AS at ON mi_idx.movie_id = at.movie_id JOIN company_type AS ct ON at.kind_id = ct.id JOIN movie_keyword AS mk ON mi_idx.movie_id = mk.movie_id JOIN name AS n ON at.movie_id = n.id WHERE mi_idx.info_type_id = 101 AND mi_idx.movie_id IN ('18742', '8465', '6663') AND at.production_year BETWEEN 2000 AND 2023 GROUP BY ct.kind ORDER BY average_rating DESC;
SELECT ct.kind AS company_type_kind, AVG(name.imdb_id) AS avg_imdb_id, COUNT(DISTINCT aka_name.person_id) AS unique_aka_person_count, SUM(CASE WHEN pi.info_type_id = '22' THEN 1 ELSE 0 END) AS count_info_type_22, MAX(mc.note) AS max_movie_company_note FROM movie_companies AS mc JOIN comp_cast_type AS cct ON mc.company_type_id = cct.id JOIN name ON name.id = mc.company_id JOIN aka_name ON aka_name.person_id = name.id LEFT JOIN person_info AS pi ON pi.person_id = name.id JOIN company_type AS ct ON ct.id = mc.company_type_id WHERE cct.kind = 'crew' AND name.surname_pcode IN ('A43', 'A432') AND name.md5sum IN ('95a7b086dc6ce3e141f3acbc8b45cc12', '27e967b3984165c80f751a75ef91e3fc') GROUP BY ct.kind;
SELECT kt.kind, AVG(t.production_year) AS avg_production_year, COUNT(DISTINCT t.id) AS number_of_titles, COUNT(DISTINCT mc.company_id) AS number_of_companies, COUNT(DISTINCT ml.linked_movie_id) AS number_of_linked_movies FROM title AS t JOIN kind_type AS kt ON t.kind_id = kt.id LEFT JOIN movie_companies AS mc ON t.id = mc.movie_id LEFT JOIN movie_link AS ml ON t.id = ml.movie_id WHERE kt.kind IN ('tv series', 'episode', 'tv mini series') AND mc.company_type_id = '1' AND t.production_year BETWEEN 2005 AND 2015 GROUP BY kt.kind;
SELECT cct.kind AS cast_type_kind, it.info AS info_type, AVG(t.production_year) AS average_production_year, COUNT(DISTINCT t.id) AS count_of_movies, SUM(CASE WHEN ml.linked_movie_id IS NOT NULL THEN 1 ELSE 0 END) AS sum_of_linked_movies FROM title t JOIN comp_cast_type cct ON t.kind_id = cct.id JOIN complete_cast cc ON t.id = cc.movie_id JOIN movie_info mi ON t.id = mi.movie_id JOIN info_type it ON mi.info_type_id = it.id LEFT JOIN movie_link ml ON t.id = ml.movie_id WHERE cc.status_id IN ('3', '4') GROUP BY cct.kind, it.info ORDER BY count_of_movies DESC, sum_of_linked_movies DESC;
SELECT ct.kind as company_type, avg(at.production_year) as average_production_year, count(distinct at.id) as total_movies, count(distinct ml.movie_id) as total_linked_movies, sum(CASE WHEN at.kind_id = 3 THEN 1 ELSE 0 END) as total_kind_id_3, sum(CASE WHEN at.kind_id = 4 THEN 1 ELSE 0 END) as total_kind_id_4 FROM aka_title at JOIN movie_link ml ON at.movie_id = ml.movie_id JOIN company_type ct ON ml.link_type_id = ct.id WHERE at.kind_id IN (3, 4) AND ml.linked_movie_id IN (766538, 436, 2392833, 1659295, 2490166) AND at.production_year > 2000 GROUP BY ct.kind;
SELECT COUNT(DISTINCT n.id) AS total_actors, AVG(t.production_year) AS average_production_year, SUM(CASE WHEN n.gender = 'F' THEN 1 ELSE 0 END) AS female_actors_count, SUM(CASE WHEN n.gender = 'M' THEN 1 ELSE 0 END) AS male_actors_count, COUNT(DISTINCT t.id) AS total_titles, MAX(t.production_year) AS latest_production_year, MIN(t.production_year) AS earliest_production_year, COUNT(DISTINCT k.id) AS total_keywords, t.series_years, n.surname_pcode FROM name AS n INNER JOIN title AS t ON n.id = t.id LEFT JOIN keyword AS k ON k.id = t.id WHERE n.surname_pcode IN ('A424', 'A414') AND t.series_years LIKE '1993-____' AND (k.id = '74' OR k.id = '8451') GROUP BY t.series_years, n.surname_pcode ORDER BY total_actors DESC, average_production_year DESC;
SELECT ct.kind AS company_kind, it.info AS info_category, COUNT(*) AS total_companies, AVG(cn.imdb_id) AS average_imdb_id, SUM(CASE WHEN cn.country_code = 'US' THEN 1 ELSE 0 END) AS total_us_companies FROM company_name cn JOIN company_type ct ON cn.id = ct.id JOIN info_type it ON cn.id = it.id WHERE cn.md5sum IN ('6f5f695d7bd08122f1c8ece2814ae2cd', 'a90eefb65011789cddc830ed101bcd88') AND it.id IN ('74', '51', '63') GROUP BY ct.kind, it.info;
SELECT rt.ROLE, COUNT(DISTINCT ci.person_id) AS number_of_persons, AVG(ci.nr_order) AS average_order, SUM(mc.company_id) AS total_companies_involved, COUNT(DISTINCT mi.movie_id) AS number_of_movies_with_info FROM cast_info ci JOIN role_type rt ON ci.role_id = rt.id JOIN movie_companies mc ON ci.movie_id = mc.movie_id AND mc.company_type_id = 1 JOIN movie_info_idx mi ON ci.movie_id = mi.movie_id JOIN complete_cast cc ON ci.movie_id = cc.movie_id AND cc.subject_id = 1 WHERE ci.person_id IN (3767, 4155) AND ci.person_role_id IS NOT NULL AND mi.info LIKE '..00011111%' AND mi.info_type_id IN (15, 28, 24) GROUP BY rt.ROLE;
