SELECT COUNT(DISTINCT ci.id) AS total_actors, AVG(mc.id) AS avg_company_id, SUM(CASE WHEN rt.id = 6 THEN 1 ELSE 0 END) AS total_directors, MIN(n.name) AS first_actor_name, MAX(t.title) AS last_movie_title, COUNT(DISTINCT ml.movie_id) FILTER (WHERE ml.link_type_id = 3 OR ml.link_type_id = 7) AS total_related_movies FROM cast_info AS ci JOIN name AS n ON ci.person_id = n.id JOIN aka_title AS at ON ci.movie_id = at.movie_id JOIN movie_companies AS mc ON at.movie_id = mc.movie_id JOIN role_type AS rt ON ci.role_id = rt.id JOIN movie_link AS ml ON at.movie_id = ml.movie_id JOIN title AS t ON at.movie_id = t.id WHERE ci.note NOT LIKE '%uncredited%' AND at.production_year BETWEEN 2000 AND 2010 AND mc.company_type_id = (SELECT id FROM company_type WHERE kind = 'production') AND rt.role IN ('actor', 'actress', 'director') GROUP BY rt.id;
SELECT cn.country_code, COUNT(DISTINCT mc.movie_id) AS number_of_movies, AVG(m_link.link_type_id) AS average_link_type_id, SUM(CASE WHEN n.gender = 'M' THEN 1 ELSE 0 END) AS male_actors_count, SUM(CASE WHEN n.gender = 'F' THEN 1 ELSE 0 END) AS female_actors_count FROM company_name cn JOIN movie_companies mc ON cn.id = mc.company_id JOIN movie_link m_link ON mc.movie_id = m_link.movie_id JOIN name n ON n.name_pcode_nf IN ('A6354', 'D1345') WHERE mc.company_type_id = 1 GROUP BY cn.country_code HAVING COUNT(DISTINCT mc.movie_id) > 10 ORDER BY number_of_movies DESC;
SELECT t.production_year, COUNT(DISTINCT t.id) AS number_of_movies, AVG(mi_idx.info::NUMERIC) AS average_rating, SUM(CASE WHEN k.keyword = 'drama' THEN 1 ELSE 0 END) AS drama_movie_count FROM title AS t JOIN movie_keyword AS mk ON t.id = mk.movie_id JOIN keyword AS k ON mk.keyword_id = k.id JOIN movie_info AS mi ON t.id = mi.movie_id JOIN movie_info_idx AS mi_idx ON t.id = mi_idx.movie_id JOIN company_type AS ct ON ct.kind = 'miscellaneous companies' JOIN movie_companies AS mc ON t.id = mc.movie_id AND ct.id = mc.company_type_id WHERE t.kind_id = 1 AND mi_idx.info_type_id = 101 AND t.production_year BETWEEN 2000 AND 2010 AND mc.note LIKE '%(international)%' GROUP BY t.production_year ORDER BY t.production_year;
SELECT AVG(mc.company_type_id) AS average_company_type, COUNT(DISTINCT mk.movie_id) AS total_movies_with_keywords, SUM(CASE WHEN cn.country_code = 'US' THEN 1 ELSE 0 END) AS total_us_companies, cn.name AS company_name, k.keyword AS keyword_name, COUNT(DISTINCT ml.link_type_id) AS total_link_types FROM movie_companies AS mc JOIN company_name AS cn ON mc.company_id = cn.id JOIN movie_keyword AS mk ON mc.movie_id = mk.movie_id JOIN keyword AS k ON mk.keyword_id = k.id JOIN movie_link AS ml ON mc.movie_id = ml.movie_id WHERE cn.name_pcode_nf IN ('L3424', 'T3231', 'J23') AND ml.id IN ('713', '4080', '967', '4313', '3260') AND k.phonetic_code IN ('M5', 'P4162', 'V4514', 'H452') GROUP BY cn.name, k.keyword ORDER BY total_movies_with_keywords DESC, total_us_companies DESC;
SELECT ct.kind AS company_type, AVG(at.production_year) AS avg_production_year, COUNT(DISTINCT ci.movie_id) AS num_movies_casted, SUM(CASE WHEN at.season_nr IS NOT NULL THEN 1 ELSE 0 END) AS total_seasons, COUNT(DISTINCT k.id) AS unique_keywords FROM movie_companies AS mc JOIN company_type AS ct ON mc.company_type_id = ct.id JOIN aka_title AS at ON mc.movie_id = at.movie_id JOIN cast_info AS ci ON ci.movie_id = mc.movie_id LEFT JOIN keyword AS k ON k.id = at.movie_id WHERE mc.note LIKE '%(20%)%' AND ci.nr_order IN (44, 146, 15, 7, 47) AND ci.role_id = 1 AND at.movie_id IN (879100, 610270, 1241825, 1678396, 1699805, 549252) GROUP BY ct.kind;
SELECT cn.name AS character_name, AVG(mi_idx.info::numeric) AS average_rating, COUNT(DISTINCT k.keyword) AS unique_keywords, COUNT(DISTINCT ml.linked_movie_id) AS number_of_linked_movies, SUM(CASE WHEN pi.info_type_id = 3 THEN 1 ELSE 0 END) AS number_of_birthdays_recorded FROM char_name cn LEFT JOIN movie_info_idx mi_idx ON cn.imdb_id = mi_idx.movie_id AND mi_idx.info_type_id = 101 LEFT JOIN movie_keyword mk ON mk.movie_id = mi_idx.movie_id LEFT JOIN keyword k ON k.id = mk.keyword_id LEFT JOIN movie_link ml ON ml.movie_id = mi_idx.movie_id LEFT JOIN person_info pi ON pi.person_id = cn.id AND pi.info_type_id = 3 WHERE cn.md5sum IN ('ad29d0b30522be696e375c0cf52fad0b', 'ca8d2f6f99875f835be5a698310d23a5', 'e195362a34d97e0c055cd5c7275fb81f', '60817b9dbbd1ec43e9d559147a578e08') AND cn.name_pcode_nf IN ('G5146', 'J2525', 'B5', 'K6252') GROUP BY cn.name;
SELECT COUNT(DISTINCT akat.id) AS total_alternate_titles, AVG(akat.production_year) AS average_production_year, SUM(CASE WHEN mcomp.company_type_id = 1 THEN 1 ELSE 0 END) AS total_producer_companies, COUNT(DISTINCT k.id) AS total_unique_keywords, COUNT(DISTINCT mlink.movie_id) AS total_linked_movies, COUNT(DISTINCT n.id) AS total_people FROM aka_title AS akat JOIN movie_companies AS mcomp ON akat.movie_id = mcomp.movie_id JOIN movie_link AS mlink ON akat.movie_id = mlink.movie_id JOIN keyword AS k ON akat.movie_id IN (SELECT mk.movie_id FROM movie_keyword AS mk WHERE mk.keyword_id = k.id) JOIN name AS n ON akat.movie_id IN ( SELECT ci.movie_id FROM cast_info AS ci WHERE ci.person_id = n.id ) WHERE akat.kind_id = 1 AND mcomp.company_type_id IN (1, 2, 3) AND mlink.link_type_id IN (13, 15, 12, 2) AND k.id IN ('2959', '4902', '2890') AND n.id IN ('5102', '4144', '5253', '8021', '11905', '4985') GROUP BY mcomp.company_type_id ORDER BY total_producer_companies DESC;
SELECT ct.kind AS crew_type, COUNT(DISTINCT cn.id) AS num_companies, AVG(mi_idx.id::numeric) AS average_movie_info_idx, SUM(CASE WHEN mk.keyword_id IN ('3835', '2651', '3091', '4000') THEN 1 ELSE 0 END) AS relevant_keyword_count, MIN(cn.name) AS sample_company_name, MAX(cn.country_code) AS max_country_code FROM comp_cast_type ct JOIN movie_info_idx mi_idx ON ct.id = mi_idx.info_type_id JOIN movie_keyword mk ON mi_idx.movie_id = mk.movie_id JOIN company_name cn ON cn.imdb_id = mi_idx.movie_id WHERE ct.kind = 'crew' AND mi_idx.id IN ('57', '2630') AND cn.name_pcode_nf IN ('P6431', 'U521', 'C6536') GROUP BY ct.kind;
SELECT kt.kind AS movie_kind, COUNT(DISTINCT ml.movie_id) AS number_of_movies, COUNT(DISTINCT ml.linked_movie_id) AS number_of_linked_movies, LT.LINK AS link_type, AVG(pi.person_id) AS average_person_id, SUM(CASE WHEN mk.keyword_id = '3986' THEN 1 ELSE 0 END) AS count_of_keyword_3986, SUM(CASE WHEN mk.keyword_id = '3808' THEN 1 ELSE 0 END) AS count_of_keyword_3808, SUM(CASE WHEN mk.keyword_id = '4322' THEN 1 ELSE 0 END) AS count_of_keyword_4322 FROM movie_link AS ml JOIN link_type AS LT ON ml.link_type_id = LT.id JOIN kind_type AS kt ON kt.id IN ('6', '5') JOIN movie_keyword AS mk ON mk.movie_id = ml.movie_id LEFT JOIN person_info AS pi ON pi.person_id = ml.movie_id AND pi.info_type_id = mk.keyword_id WHERE mk.movie_id = '8874' AND LT.link IN ('features', 'referenced in', 'spin off', 'edited from', 'remade as', 'unknown link') GROUP BY kt.kind, LT.LINK;
SELECT mk.movie_id, COUNT(DISTINCT mk.keyword_id) AS total_keywords, AVG(LENGTH(pi.note)) AS average_note_length, COUNT(DISTINCT lt.id) AS total_distinct_link_types FROM movie_keyword AS mk LEFT JOIN person_info AS pi ON mk.movie_id = pi.person_id LEFT JOIN link_type AS lt ON mk.movie_id = lt.id WHERE mk.keyword_id IN (820, 3672, 3996, 3616, 1099) GROUP BY mk.movie_id ORDER BY total_keywords DESC, average_note_length DESC;
SELECT cc.kind AS company_cast_type, COUNT(DISTINCT mc.movie_id) AS number_of_movies, COUNT(DISTINCT cn.id) AS number_of_companies, AVG(name.length) AS average_name_length FROM movie_companies AS mc JOIN comp_cast_type AS cc ON mc.company_type_id = cc.id JOIN company_name AS cn ON mc.company_id = cn.id JOIN (SELECT id, CHAR_LENGTH(name) AS length FROM name WHERE gender = 'm') AS name ON name.id = mc.movie_id WHERE mc.movie_id IN ('18930', '11158', '28073', '9831', '18529', '30177') AND cc.kind IN ('complete', 'crew', 'cast') GROUP BY cc.kind;
SELECT t.production_year, COUNT(DISTINCT t.id) AS total_movies, COUNT(DISTINCT c.id) AS total_casts, AVG(mi.info::INTEGER) AS average_movie_length, SUM(CASE WHEN ml.link_type_id = 1 THEN 1 ELSE 0 END) AS total_sequels FROM title t LEFT JOIN complete_cast c ON t.id = c.movie_id AND c.subject_id = 1 LEFT JOIN movie_info_idx mi ON t.id = mi.movie_id AND mi.info_type_id = 3 LEFT JOIN movie_link ml ON t.id = ml.movie_id AND ml.link_type_id = 1 WHERE t.production_year IN (1997, 1974, 1967, 1969) GROUP BY t.production_year ORDER BY t.production_year;
SELECT kt.kind AS movie_genre, COUNT(DISTINCT t.id) AS total_movies, AVG(t.production_year) AS average_production_year, COUNT(DISTINCT mc.company_id) AS total_production_companies, COUNT(DISTINCT n.id) AS total_unique_actors FROM title AS t JOIN kind_type AS kt ON t.kind_id = kt.id JOIN movie_companies AS mc ON t.id = mc.movie_id JOIN cast_info AS ci ON t.id = ci.movie_id JOIN name AS n ON ci.person_id = n.id WHERE t.production_year > 1990 AND mc.movie_id IN ('9013', '18754', '19628', '12173') AND mc.id IN ('2363', '1293', '1757', '2957') GROUP BY kt.kind ORDER BY total_movies DESC;
SELECT lt.LINK AS link_type, COUNT(ml.id) AS total_links, AVG(ml.movie_id) AS average_movie_id, MIN(cn.name) AS character_name_with_min_id, MAX(an.name) AS aka_name_with_max_id FROM movie_link AS ml JOIN link_type AS lt ON ml.link_type_id = lt.id LEFT JOIN char_name AS cn ON cn.id = ml.movie_id AND cn.surname_pcode = 'E2146' LEFT JOIN aka_name AS an ON an.id = ml.linked_movie_id AND an.md5sum = '7df6a930bde6eff675fae9eecfb9ff7e' GROUP BY lt.LINK ORDER BY total_links DESC;
SELECT t.title AS movie_title, COUNT(DISTINCT mi.id) AS info_count, AVG(CAST(mi.info AS NUMERIC)) FILTER (WHERE it.info = 'rating') AS average_rating, SUM(mc.company_id) FILTER (WHERE mc.company_type_id = 1) AS sum_production_companies, COUNT(DISTINCT cc.id) AS cast_count, MAX(t.production_year) AS latest_production_year FROM title AS t JOIN movie_info AS mi ON t.id = mi.movie_id JOIN movie_companies AS mc ON t.id = mc.movie_id JOIN complete_cast AS cc ON t.id = cc.movie_id JOIN info_type AS it ON mi.info_type_id = it.id WHERE t.production_year > 1990 AND (mi.info_type_id IN (SELECT id FROM info_type WHERE info = 'rating' OR info = 'countries')) AND mc.company_type_id = 1 AND (mc.note NOT LIKE '%(USA)%' OR mc.note IS NULL) AND (cc.status_id = 1 OR cc.status_id = 2) GROUP BY t.title ORDER BY average_rating DESC, sum_production_companies DESC LIMIT 10;
