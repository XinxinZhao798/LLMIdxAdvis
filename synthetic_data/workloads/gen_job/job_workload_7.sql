SELECT at.production_year, COUNT(DISTINCT at.movie_id) AS total_movies, AVG(at.episode_nr) AS average_episodes_per_season, COUNT(DISTINCT rt.id) AS distinct_roles_count FROM aka_title at JOIN role_type rt ON at.kind_id = rt.id JOIN info_type it ON at.id = it.id WHERE at.production_year IN (1972, 1934, 1943) AND rt.role IN ('production designer', 'composer', 'guest', 'producer', 'actor', 'writer') AND it.info IN ('admissions', 'votes', 'LD master format', 'soundtrack') GROUP BY at.production_year ORDER BY at.production_year;
SELECT AVG(t.production_year) AS average_production_year, COUNT(DISTINCT at.id) AS total_alternate_titles, COUNT(DISTINCT t.id) AS total_titles, SUM(CASE WHEN at.kind_id = 4 THEN 1 ELSE 0 END) AS count_kind_id_4, SUM(CASE WHEN at.kind_id = 3 THEN 1 ELSE 0 END) AS count_kind_id_3, COUNT(DISTINCT cct.id) AS total_comp_cast_types, MAX(at.production_year) AS latest_alternate_title_year, MIN(t.production_year) AS earliest_title_year FROM title t LEFT JOIN aka_title at ON t.id = at.movie_id LEFT JOIN comp_cast_type cct ON cct.kind = 'complete' OR cct.kind = 'complete+verified' GROUP BY t.kind_id HAVING COUNT(DISTINCT at.id) > 0
SELECT COUNT(DISTINCT t.id) AS total_movies, SUM(mc.company_id) AS total_companies_involved, link_typ.LINK AS link_type, COUNT(DISTINCT mk.keyword_id) AS unique_keywords_used, COUNT(DISTINCT ml.linked_movie_id) AS total_linked_movies FROM title AS t JOIN movie_companies AS mc ON t.id = mc.movie_id JOIN movie_keyword AS mk ON t.id = mk.movie_id JOIN movie_link AS ml ON t.id = ml.movie_id JOIN link_type AS link_typ ON link_typ.id = ml.link_type_id WHERE t.production_year BETWEEN 2000 AND 2020 AND mc.company_type_id = 2 AND link_typ.id IN (3, 10, 6, 15, 11) AND mk.movie_id IN (13936, 8886, 13347, 7802, 15519, 18796) GROUP BY link_typ.LINK ORDER BY total_movies DESC;
SELECT it.info AS company_role, COUNT(DISTINCT mc.movie_id) AS number_of_movies, COUNT(DISTINCT mc.company_id) AS number_of_companies, AVG(CAST(coalesce(an.name_pcode_cf, '0') AS INTEGER)) AS avg_name_code_cf, SUM(CAST(coalesce(an.name_pcode_nf, '0') AS INTEGER)) AS total_name_code_nf FROM movie_companies mc JOIN role_type rt ON mc.company_type_id = rt.id JOIN info_type it ON rt.id = it.id LEFT JOIN aka_name an ON mc.movie_id = an.person_id WHERE mc.id IN (2557, 2170, 250, 4955, 466) GROUP BY it.info ORDER BY number_of_movies DESC;
SELECT cn.name AS company_name, kt.kind AS movie_kind, (t.production_year / 10) * 10 AS decade, COUNT(t.id) AS movie_count, AVG(t.imdb_id) AS average_imdb_id FROM company_name cn JOIN title t ON cn.imdb_id = t.imdb_id JOIN kind_type kt ON t.kind_id = kt.id WHERE cn.country_code = 'XX' AND t.production_year IS NOT NULL GROUP BY company_name, movie_kind, decade ORDER BY company_name, movie_kind, decade;
SELECT ct.kind AS cast_type_kind, COUNT(DISTINCT ml.movie_id) AS number_of_movies, AVG(mi.info_type_id) AS average_info_type_id, COUNT(DISTINCT rt.id) AS distinct_role_types, SUM(CASE WHEN ml.linked_movie_id IN ('2506545', '2342579', '147212', '15711', '1448011') THEN 1 ELSE 0 END) AS linked_movies_count, STRING_AGG(DISTINCT mi.info, ', ') AS movie_languages FROM movie_link AS ml JOIN movie_info AS mi ON ml.movie_id = mi.movie_id JOIN comp_cast_type AS ct ON ml.link_type_id = ct.id JOIN role_type AS rt ON ct.id = rt.id WHERE mi.info IN ('Tatar', 'Arabic', 'Slovenian', 'Mandarin', 'Maori', 'Icelandic') AND rt.role IN ('actor', 'writer', 'miscellaneous crew', 'director') AND mi.id IN ('7270303', '7268889', '7270059', '7267623', '7271071', '7268128') AND ct.kind IN ('complete+verified', 'cast', 'crew', 'complete') GROUP BY ct.kind;
SELECT ct.kind AS company_kind, AVG(mi_idx.info::NUMERIC) AS average_movie_length, COUNT(DISTINCT ch_name.id) AS unique_character_count, COUNT(DISTINCT cn_name.id) AS unique_company_count, SUM(CASE WHEN ml.link_type_id = 2 THEN 1 ELSE 0 END) AS sequel_link_count FROM movie_info_idx AS mi_idx JOIN company_name AS cn_name ON cn_name.imdb_id = mi_idx.movie_id JOIN company_type AS ct ON cn_name.id = ct.id JOIN char_name AS ch_name ON ch_name.imdb_id = mi_idx.movie_id JOIN movie_link AS ml ON ml.movie_id = mi_idx.movie_id WHERE mi_idx.info_type_id = 1 AND ct.kind IN ('special effects companies', 'miscellaneous companies', 'production companies', 'distributors') AND ch_name.name IN ('Dr. Carlos Ventura', 'John Hartman Jr.', 'Paw Slawson', 'Pera', 'The Jester', 'Guitarist') GROUP BY ct.kind;
SELECT AVG(CAST(mi_idx.info AS NUMERIC)) AS average_rating, COUNT(DISTINCT a_title.movie_id) AS number_of_movies, COUNT(DISTINCT a_name.person_id) AS number_of_people, SUM(CASE WHEN m_link.link_type_id = 1 THEN 1 ELSE 0 END) AS number_of_prequels, SUM(CASE WHEN m_link.link_type_id = 2 THEN 1 ELSE 0 END) AS number_of_sequels, AVG(a_title.production_year) AS average_production_year FROM aka_title AS a_title JOIN aka_name AS a_name ON a_title.movie_id = a_name.person_id JOIN movie_info_idx AS mi_idx ON a_title.movie_id = mi_idx.movie_id JOIN movie_link AS m_link ON a_title.movie_id = m_link.movie_id WHERE a_title.md5sum IN ('d4b78437f259ec962b25a518a77b6488', '982d91d043a457fb7114c4e57fba41a9') AND mi_idx.info_type_id = 101 GROUP BY a_title.kind_id HAVING COUNT(DISTINCT a_title.movie_id) > 10;
SELECT kt.kind AS movie_type, AVG(a.production_year) AS average_production_year, COUNT(DISTINCT mk.movie_id) AS movie_count, SUM(mi.info::integer) AS total_info_numeric, COUNT(DISTINCT c.person_id) AS unique_actors_count FROM aka_title a JOIN kind_type kt ON a.kind_id = kt.id JOIN movie_info_idx mi ON a.movie_id = mi.movie_id JOIN movie_keyword mk ON a.movie_id = mk.movie_id JOIN cast_info c ON a.movie_id = c.movie_id WHERE a.production_year BETWEEN 1990 AND 2000 AND mk.keyword_id IN (780, 3464, 2349, 1994, 1285, 705) AND mi.movie_id IN (13634, 18372, 13503, 18944, 19411, 8878) AND mi.info SIMILAR TO '[0-9]+' AND c.role_id = 1 GROUP BY kt.kind ORDER BY movie_count DESC;
SELECT kt.kind, COUNT(DISTINCT mc.movie_id) AS total_movies, AVG(cast_info.nr_order) AS average_cast_order, SUM(case when cn.country_code = 'US' THEN 1 ELSE 0 END) AS total_us_companies, COUNT(DISTINCT mk.keyword_id) AS unique_keywords FROM movie_companies mc JOIN company_name cn ON mc.company_id = cn.id JOIN kind_type kt ON kt.kind IN ('episode', 'video game', 'video movie', 'tv movie', 'tv mini series', 'tv series') JOIN movie_keyword mk ON mk.movie_id = mc.movie_id JOIN cast_info ON cast_info.movie_id = mc.movie_id WHERE mk.movie_id IN ('12147', '11128', '12146') GROUP BY kt.kind ORDER BY total_movies DESC;
