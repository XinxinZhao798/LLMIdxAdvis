SELECT COUNT(DISTINCT ci.movie_id) AS num_movies, AVG(ci.nr_order) AS avg_cast_position, COUNT(DISTINCT cn.id) AS num_companies, AVG(complete_cast.status_id) AS avg_status_id, SUM(CASE WHEN pi.info_type_id = 19 THEN 1 ELSE 0 END) AS count_info_type_19, SUM(CASE WHEN pi.info_type_id = 20 THEN 1 ELSE 0 END) AS count_info_type_20, COUNT(DISTINCT mk.keyword_id) AS num_keywords FROM cast_info ci JOIN movie_keyword mk ON ci.movie_id = mk.movie_id JOIN company_name cn ON cn.imdb_id = ci.movie_id JOIN complete_cast ON complete_cast.movie_id = ci.movie_id JOIN person_info pi ON pi.person_id = ci.person_id WHERE ci.note NOT LIKE '%(archive footage)%' AND cn.country_code = 'US' AND complete_cast.subject_id = 1 AND (pi.info LIKE '%Stage:%' OR pi.info LIKE '%AIDS%') GROUP BY cn.country_code;
SELECT ct.kind AS company_type, COUNT(DISTINCT mc.company_id) AS number_of_companies, COUNT(DISTINCT mc.movie_id) AS number_of_movies, AVG(k.id) AS average_keyword_id, SUM(CASE WHEN k.keyword = 'personal-stories' THEN 1 ELSE 0 END) AS count_personal_stories, SUM(CASE WHEN k.keyword = 'toyota-starlet' THEN 1 ELSE 0 END) AS count_toyota_starlet FROM movie_companies AS mc JOIN company_type AS ct ON mc.company_type_id = ct.id JOIN company_name AS cn ON mc.company_id = cn.id JOIN keyword AS k ON k.phonetic_code = cn.name_pcode_nf GROUP BY ct.kind ORDER BY number_of_companies DESC, number_of_movies DESC;
SELECT c.name AS company_name, p.gender, COUNT(*) AS number_of_employees, AVG(pi.info_type_id) AS average_info_type_id, SUM(mi.movie_id) AS total_movie_id_sum, COUNT(DISTINCT k.id) AS unique_keyword_count FROM company_name AS c JOIN movie_info_idx AS mi ON c.imdb_id = mi.movie_id JOIN person_info AS pi ON mi.movie_id = pi.person_id JOIN name AS p ON pi.person_id = p.id JOIN keyword AS k ON mi.info LIKE '%' || k.keyword || '%' WHERE c.name_pcode_nf IN ('E2153', 'C5125', 'M2643', 'C2425') AND c.name_pcode_sf IN ('V3252', 'C1212', 'I2416', 'T6215', 'U5163') AND mi.info_type_id IN ('100', '101', '99') GROUP BY c.name, p.gender ORDER BY number_of_employees DESC, average_info_type_id;
SELECT rt.ROLE, COUNT(ci.id) AS num_roles, AVG(ci.nr_order) AS avg_order, COUNT(DISTINCT ci.person_id) AS unique_actors, COUNT(DISTINCT cn.id) AS character_count FROM cast_info ci JOIN role_type rt ON ci.role_id = rt.id LEFT JOIN char_name cn ON ci.person_role_id = cn.id GROUP BY rt.ROLE ORDER BY num_roles DESC;
SELECT MIN(n.name) AS actor_name, AVG(CASE WHEN mi.info_type_id = (SELECT id FROM info_type WHERE info = 'runtime') THEN mi.info::FLOAT ELSE NULL END) AS average_movie_length, COUNT(DISTINCT k.id) AS unique_keywords_count, SUM(CASE WHEN ct.id = '1' THEN 1 ELSE 0 END) AS production_company_movies, SUM(CASE WHEN ct.id = '2' THEN 1 ELSE 0 END) AS distributor_movies, COUNT(DISTINCT a_t.id) AS total_movies_count FROM name AS n JOIN aka_name AS an ON n.id = an.person_id JOIN movie_info AS mi ON mi.movie_id = an.id JOIN movie_keyword AS mk ON mk.movie_id = an.id JOIN keyword AS k ON k.id = mk.keyword_id JOIN aka_title AS a_t ON a_t.movie_id = an.id JOIN movie_companies AS mc ON mc.movie_id = an.id JOIN company_type AS ct ON ct.id = mc.company_type_id WHERE n.name_pcode_nf = 'J4163' AND ct.id IN ('1', '2', '3', '4') GROUP BY n.id;
SELECT kt.kind, COUNT(DISTINCT at.movie_id) AS number_of_movies, COUNT(at.id) AS number_of_alt_titles, AVG(at.production_year) AS average_production_year, SUM(CASE WHEN at.episode_of_id IS NOT NULL THEN 1 ELSE 0 END) AS number_of_episodes FROM aka_title at INNER JOIN comp_cast_type kt ON at.kind_id = kt.id GROUP BY kt.kind ORDER BY number_of_movies DESC;
SELECT kt.kind AS movie_kind, COUNT(*) AS total_movies, AVG(t.production_year) AS average_production_year, SUM(CASE WHEN mi.info = 'color' THEN 1 ELSE 0 END) AS color_movie_count, SUM(CASE WHEN mi.info = 'black and white' THEN 1 ELSE 0 END) AS black_and_white_movie_count FROM title AS t JOIN kind_type AS kt ON t.kind_id = kt.id JOIN movie_info AS mi ON t.id = mi.movie_id WHERE t.production_year BETWEEN 2000 AND 2010 AND mi.info_type_id IN (SELECT id FROM info_type WHERE info IN ('color', 'black and white')) GROUP BY kt.kind HAVING COUNT(*) > 100 ORDER BY total_movies DESC, average_production_year;
SELECT k.keyword, COUNT(DISTINCT ci.movie_id) AS movie_count, AVG(a.production_year) AS avg_production_year, COUNT(DISTINCT ci.person_id) AS actor_count, SUM(CASE WHEN ci.role_id = 1 THEN 1 ELSE 0 END) AS lead_roles, SUM(CASE WHEN ci.role_id = 2 THEN 1 ELSE 0 END) AS supporting_roles FROM keyword k JOIN cast_info ci ON ci.movie_id = k.id JOIN aka_title a ON a.movie_id = ci.movie_id WHERE k.id IN (9469, 4548, 8976, 5594, 8711) GROUP BY k.keyword ORDER BY movie_count DESC, avg_production_year DESC;
SELECT kt.kind AS content_type, COUNT(DISTINCT ci.movie_id) AS total_movies, COUNT(DISTINCT ci.person_id) AS total_actors, AVG(movie_link.id) AS average_movie_link_id, SUM(mc.company_id) AS total_company_ids, COUNT(DISTINCT k.id) AS unique_keywords FROM cast_info ci JOIN kind_type kt ON ci.movie_id IN (2360100, 2237184, 947729, 1615145) JOIN movie_link ON movie_link.movie_id = ci.movie_id JOIN movie_companies mc ON ci.movie_id = mc.movie_id JOIN keyword k ON k.phonetic_code IN ('S4623', 'P4162', 'M4252') WHERE kt.kind IN ('video game', 'tv movie', 'episode', 'video movie', 'tv series', 'tv mini series') AND ci.nr_order IN (87, 12, 8, 34) AND movie_link.id IN (1606, 3369, 1804, 3838) GROUP BY kt.kind;
SELECT it.info AS info_category, COUNT(pi.id) AS total_person_info_records, AVG(mi.movie_id) AS average_movie_id, SUM(CASE WHEN pi.note = 'anonymous' THEN 1 ELSE 0 END) AS anonymous_count, SUM(CASE WHEN pi.note = 'Spook Show Entertainment' THEN 1 ELSE 0 END) AS spook_show_count, MAX(pi.id) AS max_person_info_id, MIN(mi.id) AS min_movie_info_id FROM person_info pi JOIN info_type it ON pi.info_type_id = it.id JOIN movie_info mi ON pi.person_id = mi.movie_id JOIN comp_cast_type cct ON mi.info_type_id = cct.id AND cct.kind = 'complete' GROUP BY it.info HAVING COUNT(pi.id) > 5 ORDER BY total_person_info_records DESC;
SELECT kt.kind AS movie_kind, AVG(title.production_year) AS average_production_year, COUNT(DISTINCT cast_info.person_id) AS number_of_actors, COUNT(DISTINCT company_name.id) AS number_of_companies, SUM(case when cast_info.role_id = 1 then 1 else 0 end) AS number_of_lead_roles, MAX(movie_info.info) AS longest_movie_info FROM title JOIN kind_type AS kt ON title.kind_id = kt.id JOIN cast_info ON title.id = cast_info.movie_id JOIN movie_companies ON title.id = movie_companies.movie_id JOIN company_name ON movie_companies.company_id = company_name.id JOIN movie_info ON title.id = movie_info.movie_id WHERE title.production_year >= 2000 AND cast_info.role_id = 1 AND movie_companies.company_type_id IN (SELECT id FROM company_name WHERE country_code = 'US') GROUP BY kt.kind ORDER BY average_production_year DESC, number_of_actors DESC;
SELECT kt.kind AS movie_kind, COUNT(DISTINCT mc.movie_id) AS number_of_movies, AVG(mi_numeric.info::NUMERIC) AS average_budget, SUM(CASE WHEN mc.company_id = '1187' THEN 1 ELSE 0 END) AS movies_with_company_1187, SUM(CASE WHEN mc.company_id = '1024' THEN 1 ELSE 0 END) AS movies_with_company_1024, COUNT(DISTINCT ml.link_type_id) AS distinct_link_types FROM movie_companies AS mc JOIN movie_info AS mi ON mc.movie_id = mi.movie_id JOIN kind_type AS kt ON mi.info_type_id = kt.id LEFT JOIN movie_link AS ml ON mc.movie_id = ml.movie_id LEFT JOIN movie_info AS mi_numeric ON mc.movie_id = mi_numeric.movie_id AND mi_numeric.info_type_id = ( SELECT id FROM info_type WHERE info = 'budget' ) WHERE mc.company_id IN ('1187', '1024', '1009', '1239', '1034') AND mi.info_type_id IN ( SELECT id FROM info_type WHERE info = 'budget' ) AND mc.movie_id IN ('18864', '18945') GROUP BY kt.kind;
SELECT ct.kind as company_type, avg(at.production_year) as average_production_year, count(distinct at.id) as total_movies, count(distinct ml.movie_id) as total_linked_movies, sum(CASE WHEN at.kind_id = 3 THEN 1 ELSE 0 END) as total_kind_id_3, sum(CASE WHEN at.kind_id = 4 THEN 1 ELSE 0 END) as total_kind_id_4 FROM aka_title at JOIN movie_link ml ON at.movie_id = ml.movie_id JOIN company_type ct ON ml.link_type_id = ct.id WHERE at.kind_id IN (3, 4) AND ml.linked_movie_id IN (766538, 436, 2392833, 1659295, 2490166) AND at.production_year > 2000 GROUP BY ct.kind;
