SELECT n.gender, COUNT(DISTINCT n.id) AS total_actors, AVG(pi.info::numeric) AS average_salary, SUM(CASE WHEN t.production_year >= 2000 THEN 1 ELSE 0 END) AS movies_since_2000, COUNT(DISTINCT an.id) AS alias_count FROM name AS n LEFT JOIN person_info AS pi ON n.id = pi.person_id AND pi.info_type_id = 5 LEFT JOIN aka_name AS an ON n.id = an.person_id JOIN title AS t ON t.production_year IS NOT NULL WHERE n.gender = 'm' AND an.surname_pcode IN ('A314', 'M625', 'A623') AND ( t.md5sum = 'e12660c2276e1be7ab2cedff19318a06' OR t.md5sum = 'ed4e8da1cad9d62090810472bc647ccb' ) GROUP BY n.gender;
SELECT ct.kind AS company_type, COUNT(DISTINCT cn.id) AS number_of_companies, COUNT(DISTINCT mk.movie_id) AS number_of_movies_with_keywords, AVG(mi_idx.info::numeric) AS average_movie_rating, SUM(CASE WHEN cc.status_id = '4' THEN 1 ELSE 0 END) AS completed_and_verified_casts, COUNT(DISTINCT rt.id) AS number_of_cinematographer_roles, MIN(aka.name) AS example_aka_name FROM company_name AS cn JOIN company_type AS ct ON cn.id = ct.id JOIN movie_keyword AS mk ON cn.id = mk.movie_id JOIN movie_info_idx AS mi_idx ON mk.movie_id = mi_idx.movie_id JOIN complete_cast AS cc ON mk.movie_id = cc.movie_id JOIN role_type AS rt ON rt.role = 'cinematographer' LEFT JOIN aka_name AS aka ON aka.name_pcode_cf = 'D1353' AND aka.md5sum IN ('e6b1b0cc9037b00160a143b03dc5524d', '1d440711fb046c932badfdc8121ce380', '88bcce46f057ed51b9026d05fbdb1ac0') WHERE cc.status_id IN ('3', '4') GROUP BY ct.kind
SELECT kt.kind AS movie_type, COUNT(DISTINCT mk.movie_id) AS num_movies, AVG(cn.imdb_id::NUMERIC) AS average_imdb_id, SUM(CASE WHEN cn.country_code = 'us' THEN 1 ELSE 0 END) AS num_us_companies, COUNT(DISTINCT cn.id) AS num_companies_involved FROM movie_keyword AS mk JOIN movie_info AS mi ON mk.movie_id = mi.movie_id JOIN kind_type AS kt ON mi.info_type_id = kt.id AND kt.id IN ('2', '3', '4', '5', '6') JOIN company_name AS cn ON mk.movie_id = cn.imdb_id WHERE (mk.keyword_id IN ('3195', '2832', '4019', '2965', '3002') OR mi.info IN ('Albanian', 'Norwegian', 'Ladino', 'Filipino', 'Estonian')) AND cn.name_pcode_nf IN ('R5365', 'C514', 'E5314', 'L532') AND cn.id IN ('23278', '44380', '28077', '6858', '43412', '27250') GROUP BY kt.kind;
SELECT COUNT(DISTINCT cn.id) AS num_companies, COUNT(DISTINCT chn.id) AS num_characters, AVG(CAST(mi_idx.info AS DECIMAL)) AS average_movie_rating, SUM(CASE WHEN kt.id = '4' THEN 1 ELSE 0 END) AS num_tv_series, COUNT(DISTINCT cc.movie_id) AS num_movies_with_complete_cast FROM company_name cn LEFT JOIN movie_companies mc ON cn.id = mc.company_id LEFT JOIN char_name chn ON chn.surname_pcode IN ('O416', 'M65', 'L5163') LEFT JOIN complete_cast cc ON mc.movie_id = cc.movie_id LEFT JOIN movie_info_idx mi_idx ON mc.movie_id = mi_idx.movie_id LEFT JOIN kind_type kt ON cc.subject_id = kt.id LEFT JOIN info_type it ON mi_idx.info_type_id = it.id AND it.info = 'rating' WHERE cn.name_pcode_nf IN ('L2416', 'A2321') AND ( cn.id = '152' OR kt.id = '4' OR it.id IN ('29', '49', '97', '78') ) GROUP BY cn.country_code;
SELECT ct.kind AS company_kind, kt.kind AS movie_kind, COUNT(mc.movie_id) AS num_movies, AVG(mi_idx.info::NUMERIC) AS average_info, SUM(CASE WHEN mi_idx.note = 'Y' THEN 1 ELSE 0 END) AS noted_count FROM movie_companies AS mc JOIN company_type AS ct ON mc.company_type_id = ct.id JOIN movie_info_idx AS mi_idx ON mc.movie_id = mi_idx.movie_id JOIN kind_type AS kt ON mi_idx.info_type_id = kt.id JOIN movie_keyword AS mk ON mc.movie_id = mk.movie_id WHERE mc.movie_id IN (8982, 14559, 8408) AND kt.id IN (6, 2, 3, 4, 5, 1) GROUP BY company_kind, movie_kind ORDER BY num_movies DESC, average_info DESC;
SELECT cct.kind AS cast_type_kind, AVG(mi_idx.info::numeric) AS average_movie_length, COUNT(DISTINCT mk.movie_id) AS number_of_movies_with_keywords, COUNT(DISTINCT pi.person_id) AS number_of_people_with_info FROM comp_cast_type cct JOIN movie_info_idx mi_idx ON cct.id = mi_idx.info_type_id JOIN movie_keyword mk ON mi_idx.movie_id = mk.movie_id JOIN person_info pi ON pi.info_type_id = mi_idx.info_type_id WHERE mk.keyword_id IN (3246, 2661, 3786) AND mi_idx.info_type_id = cct.id AND pi.info_type_id = cct.id GROUP BY cct.kind;
SELECT kt.kind AS movie_kind, AVG(akat.production_year) AS average_production_year, COUNT(DISTINCT akat.movie_id) AS number_of_movies, COUNT(DISTINCT cc.movie_id) AS number_of_completed_movies, SUM(CASE WHEN lt.link = 'features' THEN 1 ELSE 0 END) AS count_features_link, MAX(mi.info) AS latest_movie_info FROM aka_title akat JOIN kind_type kt ON akat.kind_id = kt.id LEFT JOIN complete_cast cc ON akat.movie_id = cc.movie_id AND cc.status_id = 4 LEFT JOIN movie_info mi ON akat.movie_id = mi.movie_id LEFT JOIN link_type lt ON lt.id = mi.info_type_id AND lt.link IN ('features', 'spin off', 'remade as') WHERE akat.production_year IS NOT NULL AND akat.kind_id IN (SELECT id FROM kind_type) GROUP BY kt.kind ORDER BY average_production_year DESC, number_of_movies DESC;
SELECT cct.kind AS cast_type, AVG(nm.imdb_id) AS average_imdb_id, COUNT(DISTINCT an.name) AS unique_aka_names, COUNT(*) AS total_entries, SUM(CASE WHEN an.surname_pcode = 'P1' THEN 1 ELSE 0 END) AS surname_pcode_P1_count FROM name nm JOIN aka_name an ON nm.id = an.person_id JOIN complete_cast cc ON nm.id = cc.subject_id JOIN comp_cast_type cct ON cc.status_id = cct.id WHERE an.name IN ('Aldhaheri, Saeed Ali Mohammed', 'Allen-Turner, Knitted Richard', 'Allen, Clinton Layne', 'Burpee, Luke', 'Algrang, Manfred Anton', 'Alfons√≥') GROUP BY cct.kind
SELECT kt.kind AS movie_kind, COUNT(DISTINCT mc.movie_id) AS number_of_movies, AVG(mi_idx.info::numeric) AS average_movie_length, SUM(CASE WHEN n.gender = 'M' THEN 1 ELSE 0 END) AS number_of_male_actors, SUM(CASE WHEN n.gender = 'F' THEN 1 ELSE 0 END) AS number_of_female_actors, MAX(n.name) AS most_recent_actor_name FROM movie_companies AS mc JOIN kind_type AS kt ON mc.movie_id = kt.id JOIN movie_info_idx AS mi_idx ON mc.movie_id = mi_idx.movie_id AND mi_idx.info_type_id = (SELECT id FROM info_type WHERE info = 'runtime') JOIN complete_cast AS cc ON mc.movie_id = cc.movie_id JOIN name AS n ON cc.subject_id = n.id WHERE mc.note LIKE '%(TV)%' AND kt.kind = 'movie' AND n.name_pcode_cf IN ('A2531', 'A4136', 'A21', 'A6123', 'A2', 'A5656') AND n.gender IN ('M', 'F') GROUP BY kt.kind;
SELECT ct.kind AS company_type, AVG(ati.production_year) AS average_production_year, COUNT(DISTINCT cn.id) AS number_of_companies, COUNT(DISTINCT ati.movie_id) AS number_of_movies, SUM(CASE WHEN ati.note LIKE '%(subtitle)%' THEN 1 ELSE 0 END) AS number_of_subtitled_movies, SUM(CASE WHEN ati.note LIKE '%(series title)%' THEN 1 ELSE 0 END) AS number_of_series_titles, SUM(CASE WHEN ati.note LIKE '%(informal literal title)%' THEN 1 ELSE 0 END) AS number_of_informal_literal_titles FROM aka_title ati JOIN company_type ct ON ati.kind_id = ct.id LEFT JOIN company_name cn ON ati.movie_id = cn.imdb_id GROUP BY ct.kind ORDER BY number_of_movies DESC, average_production_year DESC;
SELECT rt.role AS role_type, AVG(at.production_year) AS avg_production_year, COUNT(DISTINCT ci.movie_id) AS total_movies_with_writers, COUNT(DISTINCT ci.person_id) AS total_different_writers, SUM(CASE WHEN at.title ILIKE 'The %' THEN 1 ELSE 0 END) AS movies_beginning_with_the FROM cast_info ci INNER JOIN role_type rt ON ci.role_id = rt.id AND rt.role = 'writer' LEFT JOIN aka_title at ON ci.movie_id = at.movie_id WHERE at.kind_id = 1 AND rt.id = 11 GROUP BY rt.role;
