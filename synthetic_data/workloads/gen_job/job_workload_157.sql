SELECT cct.kind AS cast_type_kind, AVG(at.production_year) AS average_production_year, COUNT(DISTINCT at.id) AS alternate_titles_count, COUNT(DISTINCT k.id) AS keyword_count FROM aka_title AS at JOIN keyword AS k ON k.phonetic_code = 'I3142' JOIN comp_cast_type AS cct ON cct.id = at.kind_id GROUP BY cct.kind;
SELECT ct.kind AS company_kind, COUNT(DISTINCT mk.movie_id) AS movie_count, AVG(mk.movie_id) AS average_movie_id, SUM(mk.keyword_id) AS sum_keyword_id FROM company_name cn JOIN company_type ct ON cn.id = ct.id JOIN movie_keyword mk ON mk.movie_id = cn.imdb_id WHERE cn.country_code = 'US' AND mk.keyword_id IN (SELECT keyword_id FROM movie_keyword WHERE movie_id IN (11153, 9867, 7272, 12152, 12175, 8867)) GROUP BY ct.kind ORDER BY movie_count DESC;
SELECT ct.kind AS company_type, AVG(kw.id) AS average_keyword_id, COUNT(DISTINCT mc.movie_id) AS total_movies, SUM(mc.company_id) AS sum_company_id FROM movie_companies mc JOIN company_type ct ON mc.company_type_id = ct.id JOIN movie_link ml ON mc.movie_id = ml.movie_id JOIN keyword kw ON CAST(ml.link_type_id AS INTEGER) = kw.id JOIN name n ON mc.movie_id = n.id WHERE n.gender = 'm' AND kw.keyword IN ('Black Rick', 'Joel Gonzalez', 'TNI Soldier', 'ESPN', 'Newsroom Martian') GROUP BY ct.kind ORDER BY total_movies DESC, average_keyword_id;
SELECT ct.kind AS company_type, cn.country_code, COUNT(DISTINCT t.id) AS total_movies, AVG(t.imdb_id) AS average_imdb_id FROM title AS t JOIN movie_link AS ml ON t.id = ml.movie_id JOIN company_name AS cn ON cn.imdb_id = ml.linked_movie_id JOIN company_type AS ct ON cn.id = ct.id WHERE t.production_year BETWEEN 2010 AND 2020 AND cn.country_code IN ('US', 'GB', 'CA') GROUP BY ct.kind, cn.country_code ORDER BY total_movies DESC, average_imdb_id ASC;
SELECT SUM(mc.company_id) AS total_company_ids, AVG(CASE WHEN mc.company_type_id = 1 THEN mc.movie_id ELSE NULL END) AS average_movie_id_for_type_1, COUNT(DISTINCT ml.link_type_id) AS unique_link_types, COUNT(DISTINCT pi.person_id) AS unique_person_count, AVG(CASE WHEN pi.info_type_id = 5 THEN LENGTH(pi.info) ELSE NULL END) AS average_info_length_for_type_5 FROM movie_companies mc FULL OUTER JOIN movie_link ml ON mc.movie_id = ml.movie_id FULL OUTER JOIN person_info pi ON mc.company_id = pi.person_id GROUP BY mc.company_type_id;
SELECT COUNT(DISTINCT mc.movie_id) AS number_of_movies, AVG(CAST(mi_idx.info AS NUMERIC)) AS average_rating, COUNT(DISTINCT ml.linked_movie_id) AS linked_movies_count, SUM(CASE WHEN n.gender = 'F' THEN 1 ELSE 0 END) AS female_participants_count, SUM(CASE WHEN n.gender = 'M' THEN 1 ELSE 0 END) AS male_participants_count, MAX(t.production_year) AS latest_movie_year, MIN(t.production_year) AS oldest_movie_year FROM movie_companies AS mc JOIN title AS t ON mc.movie_id = t.id JOIN movie_info_idx AS mi_idx ON t.id = mi_idx.movie_id AND mi_idx.info_type_id = 101 LEFT JOIN movie_link AS ml ON t.id = ml.movie_id LEFT JOIN name AS n ON t.id = n.id WHERE mc.company_type_id = 1 GROUP BY mc.company_id ORDER BY number_of_movies DESC, average_rating DESC;
SELECT ml.link_type_id, k.keyword AS genre, AVG(t.production_year) AS avg_production_year, COUNT(DISTINCT ci.person_id) AS unique_actors, COUNT(DISTINCT t.id) AS number_of_movies FROM movie_link AS ml JOIN title AS t ON ml.movie_id = t.id JOIN cast_info AS ci ON t.id = ci.movie_id JOIN movie_keyword AS mk ON t.id = mk.movie_id JOIN keyword AS k ON mk.keyword_id = k.id WHERE ml.link_type_id IN (6, 13, 11, 7) AND ci.role_id = 1 AND k.id IN (3152) GROUP BY ml.link_type_id, k.keyword ORDER BY avg_production_year DESC, number_of_movies DESC;
SELECT cn.name AS company_name, COUNT(DISTINCT mi_idx.movie_id) AS number_of_movies, AVG(CAST(mi_idx.info AS NUMERIC)) AS average_runtime, SUM(CASE WHEN it.info = 'locations' THEN 1 ELSE 0 END) AS total_locations, COUNT(DISTINCT mk.keyword_id) AS unique_keywords, COUNT(DISTINCT cc.movie_id) AS complete_cast_movies FROM movie_info_idx AS mi_idx JOIN info_type AS it ON mi_idx.info_type_id = it.id JOIN movie_keyword AS mk ON mi_idx.movie_id = mk.movie_id JOIN complete_cast AS cc ON mi_idx.movie_id = cc.movie_id JOIN company_name AS cn ON cn.imdb_id = mi_idx.movie_id WHERE it.info IN ('runtimes', 'locations') AND cn.name_pcode_nf = 'G2642' GROUP BY cn.name ORDER BY average_runtime DESC, number_of_movies DESC;
SELECT ct.kind AS company_type, COUNT(DISTINCT cc.movie_id) AS total_movies, COUNT(DISTINCT ml.movie_id) AS total_linked_movies, AVG(CAST(mi.info AS NUMERIC)) FILTER (WHERE it.info = 'budget') AS average_movie_budget, SUM(CAST(mi.info AS INTEGER)) FILTER (WHERE it.info = 'votes') AS total_movie_votes FROM company_type ct JOIN movie_companies mc ON mc.company_type_id = ct.id JOIN complete_cast cc ON cc.movie_id = mc.movie_id JOIN movie_link ml ON ml.movie_id = mc.movie_id JOIN movie_info mi ON mi.movie_id = mc.movie_id JOIN info_type it ON it.id = mi.info_type_id WHERE ct.kind IN ('distributors', 'special effects companies', 'production companies') AND cc.status_id IN (3, 4) AND mi.movie_id IN ('932270', '939910') AND mi.info IN ('Gujarati', 'Tagalog', 'French', 'Portuguese') GROUP BY ct.kind ORDER BY total_movies DESC, average_movie_budget DESC;
