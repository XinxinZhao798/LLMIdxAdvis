SELECT n.name AS actor_name, COUNT(DISTINCT ci.movie_id) AS number_of_movies, COUNT(ci.id) AS total_roles_played, AVG(ci.nr_order) AS average_order_of_appearance, AVG(CAST(mi_idx.info AS FLOAT)) AS average_movie_rating FROM cast_info ci JOIN name n ON ci.person_id = n.id JOIN movie_info_idx mi_idx ON ci.movie_id = mi_idx.movie_id AND mi_idx.info_type_id = (SELECT id FROM info_type WHERE info = 'rating') GROUP BY n.name ORDER BY number_of_movies DESC, average_movie_rating DESC, average_order_of_appearance ASC LIMIT 10;
SELECT ct.kind AS company_type, COUNT(DISTINCT mc.movie_id) AS total_movies, AVG(at.production_year) AS average_production_year, SUM(CASE WHEN at.season_nr IN ('6', '22', '9', '1') THEN 1 ELSE 0 END) AS total_seasonal_titles, COUNT(DISTINCT ml.movie_id) AS total_movies_with_links, COUNT(DISTINCT pi.person_id) AS total_people_with_info FROM company_type AS ct JOIN movie_companies AS mc ON ct.id = mc.company_type_id LEFT JOIN aka_title AS at ON mc.movie_id = at.movie_id LEFT JOIN movie_link AS ml ON mc.movie_id = ml.movie_id LEFT JOIN person_info AS pi ON pi.person_id = mc.movie_id WHERE ct.kind IN ('special effects companies', 'miscellaneous companies', 'production companies', 'distributors') GROUP BY ct.kind ORDER BY total_movies DESC;
SELECT t.production_year, COUNT(DISTINCT t.id) as total_movies, AVG(mcc.count_companies) as average_companies_per_movie, SUM(cast_members.total_cast) as total_cast_members FROM title t LEFT JOIN ( SELECT movie_id, COUNT(company_id) as count_companies FROM movie_companies GROUP BY movie_id ) mcc ON mcc.movie_id = t.id LEFT JOIN ( SELECT movie_id, COUNT(id) as total_cast FROM complete_cast GROUP BY movie_id ) cast_members ON cast_members.movie_id = t.id WHERE t.production_year IS NOT NULL GROUP BY t.production_year ORDER BY t.production_year;
SELECT kt.kind AS movie_type, COUNT(DISTINCT t.id) AS total_movies, AVG(t.production_year) AS average_production_year, SUM(CASE WHEN n.gender = 'm' THEN 1 ELSE 0 END) AS male_actors_count, SUM(CASE WHEN n.gender = 'f' THEN 1 ELSE 0 END) AS female_actors_count, COUNT(DISTINCT k.id) AS distinct_keywords_used FROM title t INNER JOIN kind_type kt ON t.kind_id = kt.id LEFT JOIN movie_keyword mk ON t.id = mk.movie_id LEFT JOIN keyword k ON mk.keyword_id = k.id LEFT JOIN char_name cn ON t.id = cn.imdb_id LEFT JOIN name n ON cn.id = n.id WHERE t.production_year >= 2000 AND (n.surname_pcode = 'A41' OR n.surname_pcode = 'A42' OR n.surname_pcode = 'A435') GROUP BY kt.kind ORDER BY total_movies DESC;
SELECT COUNT(DISTINCT mc.movie_id) AS number_of_movies, AVG(t.production_year) AS average_production_year, cct.kind AS company_type, MIN(cn.name) AS company_name, SUM(CASE WHEN n.gender = 'M' THEN 1 ELSE 0 END) AS male_actors, SUM(CASE WHEN n.gender = 'F' THEN 1 ELSE 0 END) AS female_actors FROM movie_companies AS mc JOIN title AS t ON mc.movie_id = t.id JOIN company_name AS cn ON mc.company_id = cn.id JOIN comp_cast_type AS cct ON mc.company_type_id = cct.id LEFT JOIN name AS n ON n.md5sum = mc.note WHERE cn.country_code NOT LIKE '[pl]' AND t.production_year BETWEEN 1950 AND 1999 AND t.phonetic_code = 'D323' AND n.name_pcode_nf IN ('N6454', 'I4364', 'O2464', 'D54', 'M3526', 'G6534') GROUP BY cct.kind;
SELECT rt.role, AVG(mc.company_type_id) AS average_company_type, COUNT(DISTINCT mk.keyword_id) AS unique_keywords, SUM(CASE WHEN cc.subject_id = 1 THEN 1 ELSE 0 END) AS count_main_subject_movies FROM movie_companies mc INNER JOIN movie_keyword mk ON mc.movie_id = mk.movie_id INNER JOIN movie_info_idx mi ON mc.movie_id = mi.movie_id INNER JOIN complete_cast cc ON mc.movie_id = cc.movie_id INNER JOIN role_type rt ON rt.id = cc.subject_id WHERE rt.role IN ('costume designer', 'writer', 'guest', 'editor') AND mc.note IS NOT NULL AND mi.note IS NOT NULL GROUP BY rt.role;
SELECT COUNT(DISTINCT ci.person_id) AS total_actors, SUM(CASE WHEN ct.kind = 'production' THEN 1 ELSE 0 END) AS production_companies_count, AVG(t.production_year) AS average_production_year, MIN(t.title) AS oldest_movie_title, MAX(t.title) AS latest_movie_title, COUNT(DISTINCT mi.movie_id) AS total_movies_with_info FROM title t LEFT JOIN cast_info ci ON t.id = ci.movie_id LEFT JOIN movie_info mi ON t.id = mi.movie_id LEFT JOIN movie_companies mc ON t.id = mc.movie_id LEFT JOIN company_type ct ON mc.company_type_id = ct.id WHERE t.title = 'Vengence' AND t.production_year >= 2000 AND (t.episode_nr IN ('119', '9622', '13530', '255', '26') OR t.episode_nr IS NULL) GROUP BY t.production_year ORDER BY t.production_year ASC;
SELECT rt.ROLE, COUNT(DISTINCT n.id) AS Total_People, AVG(mi.id) AS Average_Movie_Info_Id, SUM(CASE WHEN ml.linked_movie_id IN ('2454993', '1779499', '763084', '1938935', '188175', '1915458') THEN 1 ELSE 0 END) AS Linked_Movies_Count FROM role_type rt JOIN name n ON n.surname_pcode = CAST(rt.id AS CHARACTER VARYING) JOIN movie_info mi ON mi.info_type_id = rt.id LEFT JOIN movie_link ml ON ml.movie_id = mi.movie_id WHERE rt.id = 12 AND rt.ROLE IN ('writer', 'producer', 'actress', 'actor', 'director', 'composer') AND n.surname_pcode IN ('A432', 'A4', 'A465', 'A456') AND ml.movie_id IN ('10538', '16743', '7369', '5520', '14521') GROUP BY rt.ROLE;
SELECT kt.kind AS movie_type, COUNT(DISTINCT ci.movie_id) AS movie_count, AVG(ci.nr_order) AS average_order_of_appearance, COUNT(DISTINCT pi.person_id) AS distinct_actors_count, SUM(CASE WHEN ci.role_id = 1 THEN 1 ELSE 0 END) AS total_lead_roles FROM cast_info ci JOIN kind_type kt ON ci.role_id = kt.id LEFT JOIN person_info pi ON ci.person_id = pi.person_id WHERE ci.person_role_id IN (1344, 1214) GROUP BY kt.kind ORDER BY movie_count DESC;
SELECT AT.production_year, CT.kind AS company_kind, IT.info AS info_type, AVG(CI.nr_order) AS average_cast_order, COUNT(DISTINCT MK.keyword_id) AS number_of_keywords, COUNT(DISTINCT ML.link_type_id) AS number_of_link_types, SUM(CASE WHEN AT.episode_nr IS NOT NULL THEN 1 ELSE 0 END) AS total_episodes FROM aka_title AT JOIN movie_keyword MK ON AT.movie_id = MK.movie_id JOIN movie_link ML ON AT.movie_id = ML.movie_id JOIN cast_info CI ON AT.movie_id = CI.movie_id JOIN company_type CT ON AT.kind_id = CT.id JOIN info_type IT ON MK.keyword_id = IT.id WHERE AT.production_year BETWEEN 2000 AND 2020 AND CT.kind = 'production' AND IT.info LIKE '%genre%' GROUP BY AT.production_year, CT.kind, IT.info ORDER BY AT.production_year, number_of_keywords DESC;
SELECT kt.kind, AVG(t.production_year) AS avg_production_year, COUNT(DISTINCT ci.movie_id) AS num_movies, COUNT(DISTINCT ci.person_id) AS num_actors, SUM(CASE WHEN mc.note LIKE '%(TV)%' THEN 1 ELSE 0 END) AS num_tv_related_companies, SUM(CASE WHEN mc.note LIKE '%(worldwide) (all media)%' THEN 1 ELSE 0 END) AS num_worldwide_media_companies FROM title t JOIN kind_type kt ON t.kind_id = kt.id JOIN cast_info ci ON t.id = ci.movie_id JOIN movie_companies mc ON t.id = mc.movie_id WHERE t.series_years NOT LIKE '%????%' AND t.production_year >= 2000 AND EXISTS (SELECT 1 FROM keyword k WHERE k.id = ci.movie_id AND k.keyword LIKE '%crime%') GROUP BY kt.kind ORDER BY num_movies DESC;
SELECT kt.kind AS movie_kind, COUNT(DISTINCT n.id) AS total_actors, COUNT(DISTINCT mi.movie_id) AS total_movies, AVG(CAST(mi.info AS FLOAT)) FILTER (WHERE it.info = 'rating') AS average_rating, COUNT(DISTINCT k.id) AS total_keywords, COUNT(DISTINCT mi.info) FILTER (WHERE it.info = 'release dates') AS total_release_dates FROM kind_type AS kt JOIN title AS t ON kt.id = t.kind_id JOIN movie_info AS mi ON t.id = mi.movie_id JOIN info_type AS it ON mi.info_type_id = it.id LEFT JOIN movie_keyword AS mk ON t.id = mk.movie_id LEFT JOIN keyword AS k ON mk.keyword_id = k.id LEFT JOIN cast_info AS ci ON t.id = ci.movie_id LEFT JOIN name AS n ON ci.person_id = n.id WHERE kt.kind IN ('movie', 'tv series', 'video game') AND n.gender = 'm' AND it.id IN ('17', '71', '44', '69', '79', '64') AND mi.id IN ('7266297', '7266302', '7266333', '7267324', '7267795') AND t.production_year BETWEEN 2000 AND 2010 GROUP BY kt.kind;
SELECT ml.movie_id, lt.LINK AS link_type, COUNT(ml.id) AS total_links, AVG(cn.imdb_id) AS avg_company_imdb_id FROM movie_link AS ml JOIN link_type AS lt ON ml.link_type_id = lt.id JOIN company_name AS cn ON ml.movie_id = cn.id GROUP BY ml.movie_id, lt.LINK ORDER BY total_links DESC, avg_company_imdb_id DESC;
SELECT it.info AS information_type, COUNT(DISTINCT mk.movie_id) AS number_of_movies, AVG(mc.company_id) AS average_company_id, SUM(CASE WHEN mc.company_id = 763 THEN 1 ELSE 0 END) AS count_specific_company, COUNT(DISTINCT mc.company_id) AS count_distinct_companies FROM movie_keyword AS mk INNER JOIN movie_companies AS mc ON mk.movie_id = mc.movie_id INNER JOIN complete_cast AS cc ON mc.movie_id = cc.movie_id INNER JOIN info_type AS it ON it.id = mc.company_type_id WHERE cc.status_id BETWEEN 1 AND 5 AND mc.company_id IN (763, 1012, 1500) AND mk.keyword_id BETWEEN 100 AND 200 GROUP BY it.info ORDER BY number_of_movies DESC, average_company_id;
SELECT kt.kind AS company_type, COUNT(DISTINCT mc.movie_id) AS number_of_movies, AVG(mc.company_id) AS average_company_id, SUM(mc.company_type_id) AS sum_company_type_ids FROM movie_companies mc JOIN kind_type kt ON mc.company_type_id = kt.id GROUP BY kt.kind ORDER BY number_of_movies DESC;
SELECT ct.kind AS company_type, COUNT(DISTINCT mc.movie_id) AS total_movies, COUNT(DISTINCT mc.company_id) AS total_companies FROM movie_companies mc JOIN company_type ct ON mc.company_type_id = ct.id JOIN name n ON mc.company_id = n.id WHERE ct.kind IN ('production companies', 'special effects companies', 'distributors') GROUP BY ct.kind ORDER BY total_movies DESC;
SELECT cct.kind AS cast_type, COUNT(DISTINCT mk.movie_id) AS movie_count, COUNT(mk.id) AS keyword_count, AVG(ct.id) AS average_company_type_id FROM comp_cast_type cct JOIN movie_keyword mk ON cct.id = mk.movie_id JOIN company_type ct ON mk.keyword_id = ct.id GROUP BY cct.kind HAVING COUNT(DISTINCT mk.movie_id) > 5 ORDER BY movie_count DESC, keyword_count DESC;
SELECT mc.company_id, ct.kind AS company_type, AVG(t.production_year) AS avg_production_year, COUNT(t.id) AS movie_count, STRING_AGG(k.keyword, ', ') AS common_keywords, AVG(LENGTH(t.title)) AS avg_title_length FROM movie_companies AS mc JOIN kind_type AS ct ON mc.company_type_id = ct.id JOIN title AS t ON mc.movie_id = t.id JOIN movie_info AS mi ON t.id = mi.movie_id JOIN info_type AS it ON mi.info_type_id = it.id LEFT JOIN keyword AS k ON mi.id = k.id WHERE mc.company_id IN (995, 1074, 719, 977, 232, 371) AND mc.company_type_id = 1 AND k.keyword IN ('yellow-dress', 'drug-enforcement', 'larry-holmes', 'borough-name-in-title', 'showbiz', 'flower-club') AND it.info = 'release dates' GROUP BY mc.company_id, ct.kind ORDER BY avg_production_year DESC, movie_count DESC;
SELECT t.title, COUNT(DISTINCT mk.keyword_id) AS total_keywords, AVG(CAST(mi.info AS NUMERIC)) AS average_rating, COUNT(DISTINCT ml.movie_id) AS total_linked_movies, SUM(CASE WHEN mi_idx.info_type_id = 3 THEN 1 ELSE 0 END) AS count_of_type_3_infos FROM title t JOIN movie_info mi ON t.id = mi.movie_id JOIN movie_info_idx mi_idx ON t.id = mi_idx.movie_id JOIN movie_keyword mk ON t.id = mk.movie_id LEFT JOIN movie_link ml ON t.id = ml.movie_id WHERE t.production_year BETWEEN 2000 AND 2020 AND mi.info_type_id = 101 AND mk.keyword_id IN ('3774', '2749', '3382', '2831', '1138') AND mi_idx.info_type_id IN ('3', '5', '7') GROUP BY t.title ORDER BY average_rating DESC, total_linked_movies DESC;
