SELECT rt.role AS role_type, COUNT(DISTINCT n.id) AS number_of_people, AVG(n.imdb_id) AS average_imdb_id, SUM(CASE WHEN n.gender = 'F' THEN 1 ELSE 0 END) AS female_count, SUM(CASE WHEN n.gender = 'M' THEN 1 ELSE 0 END) AS male_count, COUNT(DISTINCT k.id) AS unique_keywords_used, COUNT(DISTINCT mi.movie_id) AS movies_with_notes FROM name n INNER JOIN role_type rt ON n.id = rt.id INNER JOIN keyword k ON k.phonetic_code IN ('S56', 'S12', 'S1535', 'B4535', 'A25', 'O123') INNER JOIN movie_info mi ON mi.info_type_id = k.id WHERE mi.note IN ('(some dialogue)', '(English subtitles)', '(Original version)', '(English version)') AND n.name_pcode_nf IN ('C4145', 'T641', 'Q5354', 'G6342', 'E2541') AND rt.role IN ('editor', 'director', 'production designer', 'cinematographer', 'miscellaneous crew') AND n.name IN ('Amores, Joaquín', 'Amor, Miguel Ángel', 'Anderson, Damion', 'Amokrane, Mustapha', 'Anderlik, Maddie', 'André, Emmanuel') GROUP BY rt.role;
SELECT t.production_year, COUNT(DISTINCT t.id) AS number_of_movies, AVG(mc.company_id) AS average_company_id, SUM(CASE WHEN t.kind_id = '2' THEN 1 ELSE 0 END) AS number_of_kind_id_2, COUNT(DISTINCT pi.person_id) AS number_of_persons_involved, MAX(t.episode_nr) AS highest_episode_number FROM title AS t JOIN movie_companies AS mc ON t.id = mc.movie_id LEFT JOIN person_info AS pi ON pi.person_id = mc.company_id WHERE mc.note LIKE '%(TV)%' AND t.production_year BETWEEN 1990 AND 2000 GROUP BY t.production_year ORDER BY t.production_year;
SELECT COUNT(DISTINCT ci.movie_id) AS total_movies, AVG(ci.nr_order) AS average_cast_order, SUM(CASE WHEN ci.person_role_id IN (56, 1326) THEN 1 ELSE 0 END) AS count_special_roles, COUNT(DISTINCT cn.id) AS total_unique_characters, COUNT(DISTINCT k.id) AS total_unique_keywords, MAX(mi.info) AS longest_movie_info FROM cast_info ci JOIN char_name cn ON ci.person_id = cn.id JOIN movie_info mi ON ci.movie_id = mi.movie_id JOIN keyword k ON k.phonetic_code = 'O16' WHERE mi.info <> 'None' AND mi.info LIKE '%Czech%' GROUP BY ci.movie_id;
SELECT cct.kind, COUNT(DISTINCT mi_idx.movie_id) AS number_of_movies, AVG(CAST(mi_idx.info AS INTEGER)) AS average_votes, COUNT(DISTINCT pi.person_id) AS number_of_people, SUM(CASE WHEN pi.info LIKE '%1971%' THEN 1 ELSE 0 END) AS count_people_born_1971, SUM(CASE WHEN pi.info LIKE '%O-chan%' THEN 1 ELSE 0 END) AS count_people_with_Ochan_info FROM comp_cast_type cct JOIN movie_info_idx mi_idx ON cct.id = mi_idx.info_type_id JOIN person_info pi ON pi.info_type_id = mi_idx.info_type_id WHERE cct.kind = 'crew' GROUP BY cct.kind;
SELECT AVG(mi_idx.info::numeric) AS average_rating, COUNT(DISTINCT k.id) AS total_unique_keywords, COUNT(DISTINCT n.id) AS total_unique_writers, SUM(CASE WHEN cn.surname_pcode = 'M1236' THEN 1 ELSE 0 END) AS count_of_m1236_surname_writers FROM keyword AS k LEFT JOIN movie_keyword AS mk ON k.id = mk.keyword_id LEFT JOIN movie_info_idx AS mi_idx ON mk.movie_id = mi_idx.movie_id AND mi_idx.info_type_id = 101 LEFT JOIN cast_info AS ci ON mk.movie_id = ci.movie_id LEFT JOIN char_name AS cn ON ci.person_id = cn.id AND ci.role_id = 2 LEFT JOIN name AS n ON ci.person_id = n.id AND n.gender = 'm' WHERE k.keyword IN ('airforce-one', 'mexican-revolutionary', 'full-house', 'gay-hollywood', 'overactive-imagination') AND cn.surname_pcode IN ('M1236', 'H3245', 'Z12', 'F236') AND ci.role_id IN (SELECT id FROM comp_cast_type WHERE kind = 'writer') GROUP BY ci.movie_id;
SELECT AVG(CAST(mi.info AS NUMERIC)) AS average_budget, COUNT(DISTINCT at.id) AS number_of_movies, kt.kind AS movie_kind, COUNT(DISTINCT cn.id) AS number_of_companies_involved, SUM(CASE WHEN mi_idx.info_type_id = 3 THEN 1 ELSE 0 END) AS count_of_trivia_info, MAX(at.production_year) AS latest_movie_year FROM movie_info mi INNER JOIN kind_type kt ON kt.id = mi.info_type_id INNER JOIN aka_title at ON at.movie_id = mi.movie_id INNER JOIN movie_info_idx mi_idx ON mi_idx.movie_id = mi.movie_id LEFT JOIN movie_companies mc ON mc.movie_id = mi.movie_id LEFT JOIN comp_cast_type cct ON cct.id = mc.company_type_id LEFT JOIN char_name cn ON cn.id = mc.company_id WHERE mi.info_type_id = 1 AND kt.kind IN ('movie', 'tv series') AND at.production_year BETWEEN 2000 AND 2022 AND mi_idx.info_type_id IN (2, 3) AND cct.kind IN ('complete', 'complete+verified') GROUP BY kt.kind ORDER BY average_budget DESC;
SELECT MAX(cn.name) AS company_name, ct.kind AS company_kind, COUNT(DISTINCT cn.id) AS num_companies, AVG(cn.imdb_id) AS average_imdb_id, COUNT(DISTINCT cct.id) AS cast_type_count, SUM(CASE WHEN cn.country_code = 'US' THEN 1 ELSE 0 END) AS us_based_companies, COUNT(DISTINCT it.id) AS info_type_count, COUNT(DISTINCT lt.id) AS link_type_count FROM company_name cn JOIN company_type ct ON cn.id = ct.id JOIN comp_cast_type cct ON cn.id = cct.id JOIN info_type it ON cn.id = it.id JOIN link_type lt ON cn.id = lt.id WHERE cn.country_code IN ('US', 'JP', 'FR') AND cn.name_pcode_sf IN ('M3652', 'A6163', 'L2641', 'D6123') AND ct.id IN (1, 2, 3, 4) AND ct.kind IN ('special effects companies', 'miscellaneous companies', 'production companies', 'distributors') GROUP BY ct.kind ORDER BY us_based_companies DESC, num_companies DESC;
SELECT kt.kind, COUNT(DISTINCT cn.id) AS total_characters, AVG(cn.imdb_id) AS average_imdb_id, COUNT(DISTINCT mi.info) AS distinct_info_count FROM kind_type AS kt LEFT JOIN movie_info_idx AS mi ON mi.info_type_id = kt.id LEFT JOIN char_name AS cn ON cn.imdb_id = mi.movie_id GROUP BY kt.kind ORDER BY total_characters DESC;
SELECT COUNT(DISTINCT ci.person_id) AS total_actors, AVG(t.production_year) AS average_production_year, SUM(CASE WHEN a.imdb_index = 'I' THEN 1 ELSE 0 END) AS count_primary_titles, kt.kind AS title_kind, n.gender AS actor_gender FROM cast_info ci JOIN title t ON ci.movie_id = t.id JOIN name n ON ci.person_id = n.id JOIN aka_title a ON t.id = a.movie_id JOIN (SELECT id, CASE kind_id WHEN 2 THEN 'Feature' WHEN 7 THEN 'TV Movie' ELSE 'Other' END AS kind FROM title) kt ON t.kind_id = kt.id WHERE t.kind_id IN (2, 7) AND a.kind_id IN (6, 4, 3, 1) AND (ci.note LIKE '%(1988)%' OR a.imdb_index IN ('III', 'IV', 'I', 'II')) AND n.name IN ('Anazald, Mark', 'Anderson, Dean', 'Ancevski, Blagoja') GROUP BY kt.kind, n.gender;
SELECT t.production_year, COUNT(DISTINCT t.id) AS number_of_movies, AVG(t.season_nr) AS average_season_number, SUM(mov_comp.company_id) AS total_company_contributions, rt.ROLE, COUNT(DISTINCT cn.id) AS number_of_companies, COUNT(DISTINCT an.person_id) AS number_of_actors_with_aliases, MAX(t.episode_nr) AS max_episode_number FROM title AS t JOIN movie_companies AS mov_comp ON mov_comp.movie_id = t.id JOIN company_name AS cn ON cn.id = mov_comp.company_id JOIN role_type AS rt ON rt.id = mov_comp.company_type_id LEFT JOIN aka_name AS an ON an.person_id = t.id WHERE t.production_year BETWEEN 1990 AND 2020 AND cn.name IN ('Vestron UK', 'Messina Films') AND rt.id = 9 AND t.id IN ('17038', '13408', '18586', '19239', '26429') GROUP BY t.production_year, rt.ROLE ORDER BY t.production_year DESC, number_of_movies DESC;
SELECT ct.kind AS company_kind, AVG(ti.production_year) AS average_production_year, COUNT(*) AS total_movies, SUM(CASE WHEN ml.link_type_id = 10 THEN 1 ELSE 0 END) AS total_sequels, COUNT(DISTINCT n.id) AS distinct_actors FROM title ti INNER JOIN company_type ct ON ti.kind_id = ct.id LEFT JOIN movie_link ml ON ti.id = ml.movie_id AND ml.link_type_id IN (10, 11, 5, 6, 13) LEFT JOIN cast_info ci ON ti.id = ci.movie_id LEFT JOIN name n ON ci.person_id = n.id WHERE ti.production_year BETWEEN 2000 AND 2020 GROUP BY ct.kind ORDER BY total_movies DESC, average_production_year;
SELECT AVG(COALESCE(NULLIF(pi.info::NUMERIC, 0), 0)) AS avg_person_info_numeric, SUM(CASE WHEN mk.keyword_id IN (2717, 2798) THEN 1 ELSE 0 END) AS sum_movie_keyword_special, COUNT(DISTINCT mc.movie_id) AS count_distinct_movies_with_companies, COUNT(DISTINCT an.person_id) AS count_distinct_persons_with_aka, COUNT(DISTINCT ml.linked_movie_id) AS count_linked_movies FROM person_info pi LEFT JOIN aka_name an ON pi.person_id = an.person_id LEFT JOIN movie_keyword mk ON mk.movie_id = an.person_id LEFT JOIN movie_companies mc ON mc.movie_id = mk.movie_id LEFT JOIN movie_link ml ON ml.movie_id = mc.movie_id WHERE an.name IN ('Alouf, Bernard', 'Almedia-Pederalba, Karen', 'Chanclettes, The', 'Ali, Muhammed', 'Verbrugge, Willy') AND pi.id IN ('3188', '489', '4904') AND mk.id IN ('4094', '2901', '4468') AND ml.id IN ('608', '4874', '3573');
SELECT kt.kind AS movie_kind, AVG(t.production_year) AS average_production_year, COUNT(DISTINCT t.id) AS total_movies, COUNT(DISTINCT mi.info) AS unique_info_types, SUM(CASE WHEN t.season_nr IN ('8', '20', '12', '24', '33') THEN 1 ELSE 0 END) AS count_specific_seasons, COUNT(DISTINCT pi.person_id) AS total_persons_involved FROM title AS t JOIN kind_type AS kt ON t.kind_id = kt.id LEFT JOIN movie_info_idx AS mi ON t.id = mi.movie_id LEFT JOIN person_info AS pi ON pi.person_id = t.id GROUP BY kt.kind ORDER BY total_movies DESC;
SELECT COUNT(DISTINCT t.id) AS total_titles, AVG(t.production_year) AS average_production_year, SUM(CASE WHEN t.kind_id = 1 THEN 1 ELSE 0 END) AS total_movies, SUM(CASE WHEN t.kind_id = 2 THEN 1 ELSE 0 END) AS total_tv_shows, COUNT(DISTINCT pi.person_id) AS total_people_contributed, AVG(pi.info::NUMERIC) FILTER (WHERE pi.info_type_id = 3) AS average_movie_length FROM title AS t LEFT JOIN person_info AS pi ON t.id = pi.person_id WHERE t.production_year BETWEEN 1990 AND 2020 AND t.series_years LIKE '%199%' GROUP BY t.kind_id;
SELECT cct.kind AS cast_type_kind, it.info AS info_type, AVG(t.production_year) AS average_production_year, COUNT(DISTINCT t.id) AS count_of_movies, SUM(CASE WHEN ml.linked_movie_id IS NOT NULL THEN 1 ELSE 0 END) AS sum_of_linked_movies FROM title t JOIN comp_cast_type cct ON t.kind_id = cct.id JOIN complete_cast cc ON t.id = cc.movie_id JOIN movie_info mi ON t.id = mi.movie_id JOIN info_type it ON mi.info_type_id = it.id LEFT JOIN movie_link ml ON t.id = ml.movie_id WHERE cc.status_id IN ('3', '4') GROUP BY cct.kind, it.info ORDER BY count_of_movies DESC, sum_of_linked_movies DESC;
SELECT t.title, COUNT(DISTINCT ci.person_id) AS total_cast_members, COUNT(DISTINCT k.id) AS number_of_keywords, AVG(t.production_year) AS average_production_year, SUM(CASE WHEN rt.id = 7 THEN 1 ELSE 0 END) AS number_of_actors, SUM(CASE WHEN rt.id = 9 THEN 1 ELSE 0 END) AS number_of_actresses, SUM(CASE WHEN rt.id = 4 THEN 1 ELSE 0 END) AS number_of_producers, SUM(CASE WHEN rt.id = 6 THEN 1 ELSE 0 END) AS number_of_directors FROM title AS t JOIN cast_info AS ci ON t.id = ci.movie_id JOIN role_type AS rt ON ci.role_id = rt.id JOIN movie_keyword AS mk ON t.id = mk.movie_id JOIN keyword AS k ON mk.keyword_id = k.id JOIN movie_companies AS mc ON t.id = mc.movie_id WHERE t.production_year > 1990 AND ci.role_id IN (7, 9, 4, 6) AND mc.company_type_id = 2 GROUP BY t.title HAVING COUNT(DISTINCT k.id) > 5 ORDER BY average_production_year DESC, total_cast_members DESC;
SELECT COUNT(DISTINCT cn.id) AS num_companies, COUNT(DISTINCT chn.id) AS num_characters, AVG(CAST(mi_idx.info AS DECIMAL)) AS average_movie_rating, SUM(CASE WHEN kt.id = '4' THEN 1 ELSE 0 END) AS num_tv_series, COUNT(DISTINCT cc.movie_id) AS num_movies_with_complete_cast FROM company_name cn LEFT JOIN movie_companies mc ON cn.id = mc.company_id LEFT JOIN char_name chn ON chn.surname_pcode IN ('O416', 'M65', 'L5163') LEFT JOIN complete_cast cc ON mc.movie_id = cc.movie_id LEFT JOIN movie_info_idx mi_idx ON mc.movie_id = mi_idx.movie_id LEFT JOIN kind_type kt ON cc.subject_id = kt.id LEFT JOIN info_type it ON mi_idx.info_type_id = it.id AND it.info = 'rating' WHERE cn.name_pcode_nf IN ('L2416', 'A2321') AND ( cn.id = '152' OR kt.id = '4' OR it.id IN ('29', '49', '97', '78') ) GROUP BY cn.country_code;
SELECT kt.kind AS movie_type, COUNT(DISTINCT ci.movie_id) AS total_movies, AVG(CAST(mi_idx.info AS FLOAT)) AS average_rating, COUNT(DISTINCT ci.person_id) AS total_actors, COUNT(DISTINCT mc.company_id) AS total_companies, COUNT(DISTINCT ml.linked_movie_id) AS total_linked_movies FROM cast_info ci JOIN kind_type kt ON ci.movie_id = kt.id JOIN movie_info_idx mi_idx ON ci.movie_id = mi_idx.movie_id AND mi_idx.info_type_id = (SELECT id FROM info_type WHERE info = 'rating') JOIN movie_companies mc ON ci.movie_id = mc.movie_id JOIN movie_link ml ON ci.movie_id = ml.movie_id WHERE kt.kind IN ('episode', 'tv movie') AND ml.link_type_id IN (4, 13, 11, 6, 8, 3) AND mi_idx.movie_id IN (8354, 8579) GROUP BY kt.kind;
SELECT COUNT(DISTINCT t.id) AS total_movies, AVG(t.production_year) AS average_production_year, SUM(CASE WHEN at.episode_nr IS NOT NULL THEN 1 ELSE 0 END) AS total_episodes, kt.kind AS movie_kind, COUNT(DISTINCT k.id) AS distinct_keywords FROM title AS t JOIN aka_title AS at ON t.id = at.movie_id JOIN keyword AS k ON at.id = k.id JOIN company_type AS kt ON t.kind_id = kt.id WHERE t.production_year > 1990 AND at.md5sum IN ('3fbf6cc79b437aac2b533ef93a1a1f72', '3b7d0f2a4c38d29ba47fb2bef6fdc62a', '3029182796f9ac1107d5ec5eba333955', '3f32d0b04dd67b92118e6032b58a8be4', '33e7b8cd483255b73ad813d49d5f4a46') AND at.imdb_index IN ('III', 'IV', 'I', 'II') GROUP BY kt.kind ORDER BY total_movies DESC;
SELECT rt.ROLE, AVG(nk.count_keywords) AS average_keywords, COUNT(DISTINCT at.movie_id) AS number_of_movies, SUM(CASE WHEN at.production_year BETWEEN 2000 AND 2010 THEN 1 ELSE 0 END) AS movies_2000_to_2010, COUNT(DISTINCT n.id) AS number_of_names FROM role_type rt LEFT JOIN aka_title at ON rt.id = at.kind_id LEFT JOIN ( SELECT mk.movie_id, COUNT(mk.keyword_id) AS count_keywords FROM movie_keyword mk GROUP BY mk.movie_id ) nk ON nk.movie_id = at.movie_id LEFT JOIN name n ON n.id = at.movie_id WHERE rt.id IN (6, 7, 8) GROUP BY rt.ROLE ORDER BY average_keywords DESC;
SELECT COUNT(DISTINCT akat.movie_id) AS total_movies, AVG(CAST(akat.production_year AS DECIMAL)) AS average_production_year, SUM(CASE WHEN mi.note IS NOT NULL THEN 1 ELSE 0 END) AS total_movies_with_notes, COUNT(DISTINCT mk.keyword_id) AS unique_keywords_used, COUNT(DISTINCT mc.company_id) AS total_companies_involved, SUM(CASE WHEN it.info = 'English' THEN 1 ELSE 0 END) AS total_english_language_movies FROM aka_title akat JOIN movie_info mi ON akat.movie_id = mi.movie_id JOIN movie_info_idx miidx ON akat.movie_id = miidx.movie_id JOIN movie_keyword mk ON akat.movie_id = mk.movie_id JOIN movie_companies mc ON akat.movie_id = mc.movie_id JOIN info_type it ON mi.info_type_id = it.id WHERE akat.production_year IN (1979, 1966) AND mc.company_type_id IN (SELECT id FROM link_type WHERE id = 7) AND mk.id IN (3803, 847) GROUP BY akat.kind_id;
