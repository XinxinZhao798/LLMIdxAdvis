SELECT kt.kind AS movie_kind, COUNT(DISTINCT mi.movie_id) AS total_movies, AVG(CAST(mi.info AS NUMERIC)) AS average_movie_length, SUM(CASE WHEN mi_idx.info_type_id = 26 THEN 1 ELSE 0 END) AS total_movies_with_votes, COUNT(DISTINCT mk.keyword_id) AS unique_keywords_used, COUNT(DISTINCT an.person_id) AS number_of_aka_names FROM movie_info mi JOIN kind_type kt ON mi.info_type_id = kt.id LEFT JOIN movie_info_idx mi_idx ON mi.movie_id = mi_idx.movie_id AND mi_idx.info_type_id IN (26, 41, 27, 80, 87) LEFT JOIN movie_keyword mk ON mi.movie_id = mk.movie_id LEFT JOIN aka_name an ON mi.movie_id = an.person_id WHERE mi.info_type_id = 1 AND mi_idx.movie_id = '8945' AND an.md5sum IN ('536004f9d825a8468fbfa85cb0221d0c', '5126b143aa05c2a7a362057c4543038b') GROUP BY kt.kind ORDER BY total_movies DESC;
SELECT cn.country_code, ct.kind AS genre, COUNT(t.id) AS total_movies, AVG(t.production_year) AS avg_production_year, SUM(CASE WHEN ml.link_type_id = 1 THEN 1 ELSE 0 END) AS total_sequels FROM title AS t JOIN company_name AS cn ON t.id = cn.imdb_id JOIN comp_cast_type AS ct ON t.kind_id = ct.id LEFT JOIN movie_link AS ml ON t.id = ml.movie_id AND ml.link_type_id = 1 WHERE t.production_year BETWEEN 2000 AND 2020 AND cn.country_code IN ('US', 'GB', 'CA') GROUP BY cn.country_code, ct.kind ORDER BY cn.country_code, total_movies DESC;
SELECT mc.company_id, COUNT(mc.movie_id) AS num_movies, AVG(t.production_year) AS avg_production_year, SUM(CASE WHEN cc.status_id = 1 THEN 1 ELSE 0 END) AS num_completed_cast, MAX(t.production_year) AS latest_production_year, MIN(t.production_year) AS earliest_production_year FROM movie_companies AS mc JOIN title AS t ON mc.movie_id = t.id LEFT JOIN complete_cast AS cc ON t.id = cc.movie_id WHERE t.md5sum = '12d48ee4d0d61ef22a7ce0c5a1d93caf' GROUP BY mc.company_id ORDER BY num_movies DESC;
SELECT COUNT(DISTINCT t.id) AS total_titles, AVG(t.production_year) AS average_production_year, SUM(CASE WHEN t.kind_id = 1 THEN 1 ELSE 0 END) AS total_movies, SUM(CASE WHEN t.kind_id = 2 THEN 1 ELSE 0 END) AS total_tv_shows, COUNT(DISTINCT pi.person_id) AS total_people_contributed, AVG(pi.info::NUMERIC) FILTER (WHERE pi.info_type_id = 3) AS average_movie_length FROM title AS t LEFT JOIN person_info AS pi ON t.id = pi.person_id WHERE t.production_year BETWEEN 1990 AND 2020 AND t.series_years LIKE '%199%' GROUP BY t.kind_id;
SELECT n.name AS actor_name, COUNT(DISTINCT ci.movie_id) AS number_of_movies, AVG(mi_idx.info::numeric) AS average_movie_rating, SUM(CASE WHEN ci.role_id = 1 THEN 1 ELSE 0 END) AS number_of_lead_roles, COUNT(DISTINCT mc.company_id) AS number_of_companies_worked_with FROM cast_info ci JOIN name n ON ci.person_id = n.id JOIN movie_info_idx mi_idx ON ci.movie_id = mi_idx.movie_id AND mi_idx.info_type_id = 101 JOIN movie_companies mc ON ci.movie_id = mc.movie_id WHERE ci.nr_order <= 51 AND mi_idx.info::numeric >= 5.0 GROUP BY n.name HAVING COUNT(DISTINCT ci.movie_id) > 5 ORDER BY average_movie_rating DESC, number_of_movies DESC LIMIT 10;
