SELECT kt.kind AS movie_kind, MIN(at.title) AS alternative_title, AVG(CASE WHEN mi.info_type_id = it.id AND it.info = 'rating' THEN CAST(mi.info AS FLOAT) END) AS average_rating, COUNT(DISTINCT cn.id) AS number_of_companies_involved, SUM(CASE WHEN mc.company_type_id = ct.id AND ct.kind = 'production' THEN 1 ELSE 0 END) AS total_production_companies, MAX(at.production_year) AS latest_production_year FROM kind_type AS kt LEFT JOIN aka_title AS at ON kt.id = at.kind_id LEFT JOIN movie_info AS mi ON at.movie_id = mi.movie_id LEFT JOIN info_type AS it ON mi.info_type_id = it.id LEFT JOIN movie_companies AS mc ON at.movie_id = mc.movie_id LEFT JOIN company_name AS cn ON mc.company_id = cn.id LEFT JOIN comp_cast_type AS ct ON mc.company_type_id = ct.id WHERE at.production_year >= 1990 AND (at.title = 'The 11th Hour' OR at.title = 'Anna and Wulin' OR at.title = 'Arabian Tale') AND (at.imdb_index = 'I' OR at.imdb_index = 'III' OR at.imdb_index = 'IV') GROUP BY kt.kind;
SELECT kt.kind AS movie_kind, COUNT(DISTINCT mc.movie_id) AS number_of_movies, COUNT(DISTINCT mc.company_id) AS number_of_companies, SUM(pi.id) AS total_person_info_records, COUNT(DISTINCT k.id) AS unique_keywords_count FROM movie_companies AS mc JOIN kind_type AS kt ON mc.company_type_id = kt.id JOIN name AS n ON mc.movie_id = n.id JOIN person_info AS pi ON pi.person_id = n.id JOIN keyword AS k ON k.id = pi.id WHERE kt.id IN ('7', '6', '2', '5') AND k.keyword IN ('24-hours', 'compassion') AND n.surname_pcode IN ('A415', 'A4') AND pi.note IN ('Jack Backstreet', 'Zaid Adham', 'David Adler', 'John Dream', 'Trace''s Publicist') GROUP BY kt.kind ORDER BY number_of_movies DESC;
SELECT kt.kind AS kind_of_title, AVG(t.production_year) AS average_production_year, COUNT(DISTINCT t.id) AS number_of_titles, SUM(CASE WHEN mi.info_type_id = 2 THEN 1 ELSE 0 END) AS count_of_info_type_2, MAX(t.episode_nr) AS highest_episode_number FROM title t JOIN kind_type kt ON t.kind_id = kt.id LEFT JOIN movie_info mi ON t.id = mi.movie_id WHERE t.kind_id IN (2, 7) AND kt.id IN (4, 7, 6, 1) AND kt.kind IN ('video game', 'movie', 'video movie', 'tv series') GROUP BY kt.kind ORDER BY average_production_year DESC;
SELECT rt.role, COUNT(DISTINCT cn.id) AS total_characters, AVG(p.id) AS average_person_id, SUM(mc.company_id) AS total_company_id_sum, COUNT(DISTINCT k.id) AS total_unique_keywords FROM role_type rt LEFT JOIN char_name cn ON CAST(cn.id AS VARCHAR) = rt.id::varchar LEFT JOIN person_info p ON p.info_type_id = rt.id LEFT JOIN movie_companies mc ON mc.movie_id = cn.id LEFT JOIN keyword k ON k.id = mc.movie_id LEFT JOIN company_name cnm ON cnm.id = mc.company_id WHERE rt.role IN ('costume designer', 'miscellaneous crew', 'writer', 'actress', 'cinematographer', 'editor') AND mc.movie_id IN (12988, 12661, 11129, 26451, 19305, 12141) AND cnm.id IN (59673, 4533, 60539, 5934, 16779) GROUP BY rt.role ORDER BY total_unique_keywords DESC, total_characters DESC;
SELECT COUNT(DISTINCT t.id) AS total_movies, AVG(t.production_year) AS average_production_year, SUM(CASE WHEN n.gender = 'F' THEN 1 ELSE 0 END) AS female_cast_count, SUM(CASE WHEN n.gender = 'M' THEN 1 ELSE 0 END) AS male_cast_count, COUNT(DISTINCT k.id) AS total_distinct_keywords, MAX(t.production_year) AS latest_production_year FROM title t INNER JOIN aka_title at ON t.id = at.movie_id INNER JOIN movie_info_idx mi ON t.id = mi.movie_id INNER JOIN name n ON n.md5sum = at.md5sum INNER JOIN keyword k ON k.phonetic_code = at.phonetic_code WHERE t.production_year BETWEEN 2000 AND 2010 AND mi.info_type_id IN ('100', '101', '99') AND at.episode_of_id IN ('14284', '16059', '8468', '2167', '20079', '24526') AND n.name_pcode_cf IN ('A4165', 'A3423') GROUP BY t.kind_id ORDER BY total_movies DESC;
SELECT at.production_year, COUNT(DISTINCT at.movie_id) AS total_movies, AVG(at.episode_nr) AS average_episodes_per_season, COUNT(DISTINCT rt.id) AS distinct_roles_count FROM aka_title at JOIN role_type rt ON at.kind_id = rt.id JOIN info_type it ON at.id = it.id WHERE at.production_year IN (1972, 1934, 1943) AND rt.role IN ('production designer', 'composer', 'guest', 'producer', 'actor', 'writer') AND it.info IN ('admissions', 'votes', 'LD master format', 'soundtrack') GROUP BY at.production_year ORDER BY at.production_year;
SELECT rt.ROLE, COUNT(DISTINCT ci.movie_id) AS number_of_movies, AVG(ci.nr_order) AS average_cast_order, COUNT(DISTINCT name.id) AS number_of_unique_actors FROM cast_info ci JOIN role_type rt ON ci.role_id = rt.id JOIN name ON ci.person_id = name.id WHERE rt.id IN (1) AND ci.nr_order IS NOT NULL AND name.md5sum IN ('0d93c2f49007eb923f1f3983f0a8cc6b', 'c73602ee6ad37663369ca6e3bd40e7dd', 'db97c7dc12820b568f8351333075a92d', '53ebf953411448090e3e779bf1486727', 'f22535a12044b89484f9cba769cf437a', '6f608ba1bd4dd87eac0e663a877f54bc') GROUP BY rt.ROLE;
SELECT COUNT(DISTINCT cn.id) AS total_companies, COUNT(DISTINCT k.id) AS total_keywords, COUNT(DISTINCT pi.person_id) AS total_people, COUNT(DISTINCT at.id) AS total_titles, AVG(cc.status_id) AS average_cast_status, SUM(CASE WHEN cn.country_code = 'US' THEN 1 ELSE 0 END) AS total_us_companies, MAX(at.production_year) AS latest_production_year, MIN(at.production_year) AS earliest_production_year FROM company_name AS cn JOIN aka_title AS at ON cn.id = at.kind_id JOIN complete_cast AS cc ON at.movie_id = cc.movie_id JOIN person_info AS pi ON cc.subject_id = pi.person_id JOIN keyword AS k ON at.id = k.id WHERE cn.name IN ('Sunset Productions (II)', 'Coming Soon TV', 'Tucker Film', 'Windfall Films', 'NMK') AND k.keyword IN ('lavatory', 'society') AND at.production_year BETWEEN 2000 AND 2023 GROUP BY cn.country_code ORDER BY total_us_companies DESC, latest_production_year DESC;
SELECT kt.kind AS movie_kind, mc.company_type_id, COUNT(DISTINCT t.id) AS movie_count, t.production_year AS production_year, AVG((SELECT COUNT(*) FROM char_name WHERE char_name.id = t.id)) AS avg_character_count FROM title AS t JOIN kind_type AS kt ON t.kind_id = kt.id JOIN movie_companies AS mc ON t.id = mc.movie_id GROUP BY kt.kind, mc.company_type_id, t.production_year ORDER BY production_year DESC, kt.kind, mc.company_type_id;
SELECT kt.kind AS movie_type, AVG(t.production_year) AS average_production_year, COUNT(DISTINCT t.id) AS total_movies, SUM(CASE WHEN at.note LIKE '%(DVD box title)%' THEN 1 ELSE 0 END) AS total_dvd_box_titles, COUNT(DISTINCT ct.id) AS total_company_types, COUNT(lt.id) AS total_link_types FROM title t JOIN kind_type kt ON t.kind_id = kt.id LEFT JOIN aka_title at ON t.id = at.movie_id LEFT JOIN company_type ct ON ct.id = t.id LEFT JOIN link_type lt ON lt.id = t.id WHERE t.production_year BETWEEN 1990 AND 2020 AND at.note IS NOT NULL AND at.production_year > 1980 GROUP BY kt.kind ORDER BY total_movies DESC;
SELECT COUNT(DISTINCT cn.id) AS num_companies, COUNT(DISTINCT chn.id) AS num_characters, AVG(CAST(mi_idx.info AS DECIMAL)) AS average_movie_rating, SUM(CASE WHEN kt.id = '4' THEN 1 ELSE 0 END) AS num_tv_series, COUNT(DISTINCT cc.movie_id) AS num_movies_with_complete_cast FROM company_name cn LEFT JOIN movie_companies mc ON cn.id = mc.company_id LEFT JOIN char_name chn ON chn.surname_pcode IN ('O416', 'M65', 'L5163') LEFT JOIN complete_cast cc ON mc.movie_id = cc.movie_id LEFT JOIN movie_info_idx mi_idx ON mc.movie_id = mi_idx.movie_id LEFT JOIN kind_type kt ON cc.subject_id = kt.id LEFT JOIN info_type it ON mi_idx.info_type_id = it.id AND it.info = 'rating' WHERE cn.name_pcode_nf IN ('L2416', 'A2321') AND ( cn.id = '152' OR kt.id = '4' OR it.id IN ('29', '49', '97', '78') ) GROUP BY cn.country_code;
SELECT ct.kind AS company_type, AVG(CAST(mi.info AS NUMERIC)) AS average_rating, COUNT(DISTINCT mk.movie_id) AS movie_count, COUNT(k.id) AS keyword_count, SUM(CASE WHEN it.info = 'LD official retail price' THEN CAST(mi.info AS NUMERIC) ELSE 0 END) AS total_official_retail_price FROM company_type ct JOIN movie_info mi ON ct.id = mi.info_type_id JOIN movie_keyword mk ON mi.movie_id = mk.movie_id JOIN keyword k ON mk.keyword_id = k.id JOIN info_type it ON mi.info_type_id = it.id WHERE mk.keyword_id IN (2506, 2862, 589, 3476, 4237) AND k.phonetic_code IN ('D1653', 'H532', 'M6321', 'H4326', 'F2426', 'A3513') AND it.id IN (15, 16, 18, 76, 39, 111) AND mi.movie_id IN (9091, 13237, 927238) AND (mi.note ILIKE '%(English subtitles)%' OR mi.note ILIKE '%(Original version)%') GROUP BY ct.kind;
SELECT kt.kind AS Movie_Type, AVG(t.production_year) AS Average_Production_Year, COUNT(DISTINCT t.id) AS Total_Movies, COUNT(DISTINCT cc.id) AS Total_Complete_Casts, SUM(CASE WHEN t.season_nr IS NOT NULL THEN 1 ELSE 0 END) AS Total_Seasons FROM title AS t JOIN kind_type AS kt ON t.kind_id = kt.id LEFT JOIN complete_cast AS cc ON t.id = cc.movie_id LEFT JOIN movie_info AS mi ON t.id = mi.movie_id WHERE t.production_year IS NOT NULL AND kt.kind IN ('movie', 'tv movie', 'video movie', 'video game') GROUP BY kt.kind ORDER BY Total_Movies DESC;
