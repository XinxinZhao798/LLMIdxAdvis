SELECT rt.ROLE AS Role, COUNT(distinct ci.person_id) AS Number_Of_Actors, AVG(ci.nr_order) AS Average_Billing_Position, SUM(CASE WHEN n.gender = 'M' THEN 1 ELSE 0 END) AS Male_Actors, SUM(CASE WHEN n.gender = 'F' THEN 1 ELSE 0 END) AS Female_Actors, MIN(aka.production_year) AS Earliest_Film_Year, MAX(aka.production_year) AS Latest_Film_Year, COUNT(distinct mk.movie_id) AS Number_Of_Movies_With_Keywords, AVG(pi.info_type_id::integer) AS Average_Info_Type_Id FROM cast_info ci JOIN name n ON ci.person_id = n.id JOIN role_type rt ON ci.role_id = rt.id LEFT JOIN aka_title aka ON ci.movie_id = aka.movie_id LEFT JOIN movie_keyword mk ON ci.movie_id = mk.movie_id LEFT JOIN person_info pi ON n.id = pi.person_id WHERE (aka.title = 'Abduction - Riprenditi la tua vita' OR aka.title = 'Mala wielka milosc' OR aka.title = 'Great Performances: On the Town in Concert' OR aka.title = 'æÁÂÒÉËÉ Ú×ÅÚÄ. ÷ÏÚ×ÒÁÝÅÎÉÅ' OR aka.title = 'Zavoevanie ameriki') AND pi.info_type_id IN ('37', '20', '28', '32', '25') AND ci.nr_order = 93 GROUP BY rt.ROLE;
SELECT it.info AS info_category, COUNT(DISTINCT mi.movie_id) AS movie_count, SUM(CASE WHEN mi.note LIKE '%(interviews)%' THEN 1 ELSE 0 END) AS interview_movie_count, SUM(CASE WHEN mi.note LIKE '%(Original version)%' THEN 1 ELSE 0 END) AS original_version_movie_count, COUNT(DISTINCT k.id) AS distinct_keywords_used, AVG(mi.id) AS average_movie_info_id FROM movie_info mi JOIN info_type it ON mi.info_type_id = it.id JOIN movie_keyword mk ON mi.movie_id = mk.movie_id JOIN keyword k ON mk.keyword_id = k.id WHERE it.id IN (9, 31) AND k.keyword IN ('cobra', 'dinosaur-egg', 'startled', 'paranoia') GROUP BY it.info ORDER BY movie_count DESC;
SELECT ct.kind AS company_type, AVG(t.production_year) AS average_production_year, COUNT(DISTINCT t.id) AS number_of_movies, SUM(CASE WHEN cn.country_code = 'US' THEN 1 ELSE 0 END) AS number_of_us_movies, COUNT(DISTINCT cn.id) AS number_of_companies FROM movie_companies AS mc JOIN company_type AS ct ON mc.company_type_id = ct.id JOIN company_name AS cn ON mc.company_id = cn.id JOIN title AS t ON mc.movie_id = t.id GROUP BY ct.kind ORDER BY number_of_movies DESC;
SELECT t.title, COUNT(DISTINCT ci.person_id) AS total_cast_members, AVG(ci.nr_order) AS average_cast_position, COUNT(DISTINCT mc.company_id) AS number_of_companies_involved, MAX(t.production_year) AS latest_production_year, SUM(CASE WHEN cct.kind = 'production' THEN 1 ELSE 0 END) AS total_production_companies FROM title t LEFT JOIN cast_info ci ON t.id = ci.movie_id LEFT JOIN movie_companies mc ON t.id = mc.movie_id LEFT JOIN comp_cast_type cct ON mc.company_type_id = cct.id WHERE t.production_year > 2000 AND mc.note LIKE '%(TV)%' GROUP BY t.title ORDER BY total_cast_members DESC, latest_production_year DESC;
SELECT kt.kind AS movie_kind, AVG(title.production_year) AS average_production_year, COUNT(DISTINCT cast_info.person_id) AS number_of_actors, COUNT(DISTINCT company_name.id) AS number_of_companies, SUM(case when cast_info.role_id = 1 then 1 else 0 end) AS number_of_lead_roles, MAX(movie_info.info) AS longest_movie_info FROM title JOIN kind_type AS kt ON title.kind_id = kt.id JOIN cast_info ON title.id = cast_info.movie_id JOIN movie_companies ON title.id = movie_companies.movie_id JOIN company_name ON movie_companies.company_id = company_name.id JOIN movie_info ON title.id = movie_info.movie_id WHERE title.production_year >= 2000 AND cast_info.role_id = 1 AND movie_companies.company_type_id IN (SELECT id FROM company_name WHERE country_code = 'US') GROUP BY kt.kind ORDER BY average_production_year DESC, number_of_actors DESC;
SELECT rt.ROLE, COUNT(DISTINCT ci.person_id) AS number_of_people, AVG(mc.company_id) AS average_company_id, SUM(CASE WHEN t.production_year > 2000 THEN 1 ELSE 0 END) AS movies_after_2000, COUNT(DISTINCT t.id) AS total_movies FROM cast_info ci JOIN role_type rt ON ci.role_id = rt.id JOIN title t ON ci.movie_id = t.id JOIN movie_companies mc ON t.id = mc.movie_id WHERE rt.ROLE IN ('director', 'production designer', 'costume designer', 'composer') AND t.production_year BETWEEN 1990 AND 2020 GROUP BY rt.ROLE ORDER BY number_of_people DESC;
SELECT mc.company_id, COUNT(mc.movie_id) AS num_movies, AVG(t.production_year) AS avg_production_year, SUM(CASE WHEN cc.status_id = 1 THEN 1 ELSE 0 END) AS num_completed_cast, MAX(t.production_year) AS latest_production_year, MIN(t.production_year) AS earliest_production_year FROM movie_companies AS mc JOIN title AS t ON mc.movie_id = t.id LEFT JOIN complete_cast AS cc ON t.id = cc.movie_id WHERE t.md5sum = '12d48ee4d0d61ef22a7ce0c5a1d93caf' GROUP BY mc.company_id ORDER BY num_movies DESC;
SELECT AVG(at.production_year) AS avg_production_year, COUNT(DISTINCT at.movie_id) AS total_movies, SUM(CASE WHEN mc.company_type_id = 2 THEN 1 ELSE 0 END) AS total_distributors, COUNT(DISTINCT pi.person_id) AS total_people, AVG(CASE WHEN pi.info_type_id = 17 THEN CAST(pi.info AS INTEGER) ELSE NULL END) AS avg_salary FROM movie_companies mc JOIN aka_title at ON mc.movie_id = at.movie_id JOIN person_info pi ON mc.movie_id = pi.person_id JOIN keyword k ON at.id = k.id WHERE mc.company_id IN (643, 838, 877) AND pi.info_type_id IN (17, 25, 35, 28, 26) AND at.kind_id IN (SELECT id FROM comp_cast_type WHERE kind IN ('complete+verified', 'cast', 'crew', 'complete')) AND k.id IN (2792, 548, 6394, 3958) GROUP BY mc.company_type_id;
SELECT AVG(t.production_year) AS average_production_year, COUNT(DISTINCT k.id) AS number_of_unique_keywords, SUM(CASE WHEN mc.company_type_id = 1 THEN 1 ELSE 0 END) AS number_of_production_companies, COUNT(DISTINCT mk.movie_id) AS number_of_movies_with_keywords, COUNT(DISTINCT t.id) AS total_movies FROM title AS t JOIN movie_keyword AS mk ON t.id = mk.movie_id JOIN keyword AS k ON mk.keyword_id = k.id JOIN movie_companies AS mc ON t.id = mc.movie_id JOIN complete_cast AS cc ON t.id = cc.movie_id WHERE t.production_year > 1990 AND mc.company_type_id IN (1, 2, 3) AND cc.status_id = 1 AND k.phonetic_code IN ('W25', 'P4232', 'G4323') GROUP BY t.kind_id HAVING COUNT(DISTINCT mc.company_id) > 5 ORDER BY average_production_year DESC;
SELECT ct.kind AS company_kind, COUNT(DISTINCT mc.movie_id) AS number_of_movies, COUNT(DISTINCT mc.company_id) AS number_of_companies_involved, AVG(mcc.status_id) AS average_status_id, SUM(CASE WHEN mc.note LIKE '%(DVD)%' THEN 1 ELSE 0 END) AS dvd_releases, SUM(CASE WHEN mc.note LIKE '%(TV)%' THEN 1 ELSE 0 END) AS tv_releases, SUM(CASE WHEN mc.note LIKE '%(all media)%' THEN 1 ELSE 0 END) AS all_media_releases, SUM(CASE WHEN mc.note LIKE '%) (UK) %' THEN 1 ELSE 0 END) AS uk_releases, SUM(CASE WHEN mc.note LIKE '%) (USA) %' THEN 1 ELSE 0 END) AS usa_releases FROM movie_companies AS mc JOIN company_type AS ct ON mc.company_type_id = ct.id LEFT JOIN complete_cast AS mcc ON mc.movie_id = mcc.movie_id WHERE ct.kind IN ('distributors', 'special effects companies') GROUP BY ct.kind;
SELECT lt.LINK AS link_type, COUNT(DISTINCT ml.movie_id) AS number_of_movies, AVG(t.production_year) AS average_production_year, SUM(CASE WHEN n.gender = 'f' THEN 1 ELSE 0 END) AS female_cast_count, SUM(CASE WHEN n.gender = 'm' THEN 1 ELSE 0 END) AS male_cast_count FROM movie_link AS ml JOIN link_type AS lt ON ml.link_type_id = lt.id JOIN title AS t ON ml.movie_id = t.id JOIN movie_info_idx AS miidx ON miidx.movie_id = t.id JOIN info_type AS it ON miidx.info_type_id = it.id JOIN name AS n ON n.id = miidx.movie_id WHERE lt.id IN (13, 14, 8, 18, 4) AND ml.movie_id IN (10590, 11494) AND n.name_pcode_cf IN ('A4534', 'A31') GROUP BY lt.LINK ORDER BY number_of_movies DESC, average_production_year;
SELECT COUNT(DISTINCT ci.person_id) AS total_actors, COUNT(DISTINCT mc.company_id) AS total_production_companies, AVG(COUNT(mi.id)) OVER (PARTITION BY mc.movie_id) AS average_info_per_movie FROM movie_companies mc INNER JOIN cast_info ci ON mc.movie_id = ci.movie_id AND ci.role_id = (SELECT id FROM comp_cast_type WHERE kind = 'actor') INNER JOIN movie_info mi ON mc.movie_id = mi.movie_id WHERE mc.company_type_id = (SELECT id FROM company_type WHERE kind = 'production companies') GROUP BY mc.movie_id;
SELECT ct.id AS company_type_id, ct.kind AS company_type_kind, COUNT(*) AS total_companies, kt.id AS kind_type_id, kt.kind AS kind_type_kind, AVG(chn.imdb_id) AS average_imdb_id, SUM(chn.imdb_id) AS total_imdb_id_sum FROM company_type AS ct JOIN kind_type AS kt ON ct.id = kt.id LEFT JOIN char_name AS chn ON chn.id = ct.id GROUP BY ct.id, kt.id ORDER BY total_companies DESC, average_imdb_id ASC;
SELECT kt.kind AS movie_kind, COUNT(DISTINCT t.id) AS total_movies, COUNT(DISTINCT ml.movie_id) AS total_linked_movies, AVG(t.production_year) AS average_production_year, SUM(CASE WHEN t.production_year > 1990 THEN 1 ELSE 0 END) AS movies_after_1990, MAX(t.production_year) AS latest_production_year, MIN(t.production_year) AS oldest_production_year FROM title AS t JOIN kind_type AS kt ON t.kind_id = kt.id LEFT JOIN movie_link AS ml ON t.id = ml.movie_id WHERE kt.id IN (2, 4, 6, 3) AND kt.kind IN ('tv mini series', 'video movie') GROUP BY kt.kind ORDER BY total_movies DESC;
SELECT lt.LINK AS link_type, AVG(t.production_year) AS average_production_year, COUNT(DISTINCT mc.company_id) AS number_of_companies, COUNT(DISTINCT ml.movie_id) AS number_of_movies_linked, SUM(CASE WHEN t.kind_id = 1 THEN 1 ELSE 0 END) AS number_of_movies, SUM(CASE WHEN t.kind_id = 2 THEN 1 ELSE 0 END) AS number_of_tv_shows FROM movie_link AS ml INNER JOIN link_type AS lt ON ml.link_type_id = lt.id INNER JOIN title AS t ON ml.movie_id = t.id INNER JOIN movie_companies AS mc ON t.id = mc.movie_id INNER JOIN comp_cast_type AS cct ON mc.company_type_id = cct.id WHERE lt.link IN ('alternate language version of', 'featured in') AND cct.kind IN ('complete+verified', 'cast', 'crew', 'complete') AND mc.id IN ('2868', '289') AND ml.id IN ('5', '751', '4865') AND ml.linked_movie_id IN ('1634429', '905740', '1900325', '1041780', '426055') GROUP BY lt.LINK;
SELECT mc.company_type_id, COUNT(DISTINCT mc.movie_id) AS num_movies, AVG(at.production_year) AS avg_production_year, COUNT(DISTINCT lt.id) AS num_link_types FROM movie_companies AS mc JOIN aka_title AS at ON mc.movie_id = at.movie_id JOIN link_type AS lt ON at.id = lt.id WHERE mc.company_type_id = 1 AND lt.link IN ('alternate language version of', 'featured in', 'edited into', 'edited from', 'spoofs', 'referenced in') GROUP BY mc.company_type_id;
SELECT kt.kind AS movie_kind, COUNT(DISTINCT ml.movie_id) AS total_movies, COUNT(DISTINCT ml.linked_movie_id) AS total_linked_movies, COUNT(DISTINCT pi.person_id) AS total_actors, AVG(CAST(pi.info AS numeric)) AS average_rating, SUM(CASE WHEN pi.info_type_id = 1 THEN 1 ELSE 0 END) AS count_of_main_roles FROM movie_link AS ml JOIN kind_type AS kt ON kt.id = ml.link_type_id JOIN person_info AS pi ON pi.person_id = ml.movie_id WHERE kt.kind IN ('video movie', 'tv movie', 'video game', 'episode') AND ml.linked_movie_id IN (825152, 1846684, 1922177) AND pi.person_id IN (1740363, 732, 286, 1740595, 2742) AND pi.info_type_id IN (1, 7) GROUP BY kt.kind ORDER BY total_movies DESC;
SELECT kt.kind AS movie_kind, AVG(t.production_year) AS average_production_year, COUNT(DISTINCT an.person_id) AS unique_actors_with_alternate_names, COUNT(DISTINCT cn.id) AS number_of_companies, SUM(CASE WHEN t.production_year > 2000 THEN 1 ELSE 0 END) AS movies_produced_after_2000 FROM aka_name an INNER JOIN name n ON an.person_id = n.id INNER JOIN aka_title at ON n.id = at.movie_id INNER JOIN title t ON at.movie_id = t.id INNER JOIN kind_type kt ON t.kind_id = kt.id INNER JOIN company_name cn ON t.id = cn.imdb_id LEFT JOIN char_name chn ON an.person_id = chn.id WHERE (chn.name = 'Clarkson' OR chn.name = 'Miguelito' OR chn.name = 'Basket coach') GROUP BY kt.kind;
SELECT AVG(t.production_year) AS average_production_year, COUNT(DISTINCT t.id) AS total_movies, COUNT(DISTINCT pi.person_id) AS total_people, SUM(CASE WHEN ct.kind = 'complete+verified' THEN 1 ELSE 0 END) AS complete_verified_casts, COUNT(DISTINCT pi.person_id) FILTER (WHERE pi.note IN ('AJ Addo', 'tina ansah', 'Fan Club President')) AS noted_persons FROM title AS t LEFT JOIN complete_cast AS cc ON t.id = cc.movie_id LEFT JOIN comp_cast_type AS ct ON cc.status_id = ct.id LEFT JOIN role_type AS rt ON cc.subject_id = rt.id LEFT JOIN person_info AS pi ON pi.person_id = t.id WHERE t.kind_id = 1 AND t.production_year BETWEEN 1990 AND 2005 AND (ct.id IN (2, 1, 4, 3) OR ct.id IS NULL) AND (pi.person_id IN (904, 1963, 736, 1740234, 1741102) OR pi.person_id IS NULL) GROUP BY t.kind_id;
SELECT rt.ROLE, COUNT(*) AS role_count, AVG(ci.nr_order) AS average_order, SUM(ci.nr_order) AS total_order, MAX(ci.nr_order) AS max_order, MIN(ci.nr_order) AS min_order FROM cast_info ci JOIN role_type rt ON ci.role_id = rt.id JOIN movie_keyword mk ON ci.movie_id = mk.movie_id JOIN movie_info mi ON ci.movie_id = mi.movie_id JOIN movie_link ml ON ci.movie_id = ml.movie_id WHERE mk.keyword_id IN (3544, 4170, 355, 3797, 2901) AND ci.movie_id IN (14730, 8894, 18741, 18773, 15355, 12280, 2069434, 2317758, 2267299) GROUP BY rt.ROLE ORDER BY role_count DESC, average_order;
SELECT AVG(a.production_year) AS average_production_year, COUNT(DISTINCT a.movie_id) AS total_movies, COUNT(DISTINCT n.id) AS total_unique_actors, SUM(CASE WHEN c.kind = 'complete+verified' THEN 1 ELSE 0 END) AS total_complete_verified, MAX(a.episode_nr) AS max_episode_number FROM aka_title AS a JOIN comp_cast_type AS c ON a.kind_id = c.id JOIN name AS n ON a.id = n.id WHERE a.production_year BETWEEN 1980 AND 2000 AND a.kind_id = 6 AND c.kind IN ('complete+verified', 'cast', 'crew', 'complete') GROUP BY a.kind_id HAVING COUNT(DISTINCT n.id) > 10;
SELECT AVG(ak.title_count) AS average_title_count, MAX(ak.max_production_year) AS latest_production_year, MIN(ak.min_production_year) AS earliest_production_year, SUM(ak.title_count) AS total_titles, COUNT(DISTINCT ki.id) AS total_unique_keywords, COUNT(DISTINCT pi.person_id) AS total_unique_persons FROM (SELECT at.movie_id, COUNT(at.id) AS title_count, MAX(at.production_year) AS max_production_year, MIN(at.production_year) AS min_production_year FROM aka_title at GROUP BY at.movie_id ) ak LEFT JOIN movie_keyword mk ON mk.movie_id = ak.movie_id LEFT JOIN keyword ki ON ki.id = mk.keyword_id AND ki.keyword IN ('vampire-hunter', 'training', 'newspaper-editor', 'multiple-views', 'historical-fiction', 'forbidden-love') LEFT JOIN movie_info_idx mi ON mi.movie_id = ak.movie_id LEFT JOIN person_info pi ON pi.info_type_id = mi.info_type_id GROUP BY ki.keyword;
SELECT kt.kind AS movie_type, COUNT(DISTINCT mi.movie_id) AS total_movies, AVG(CAST(mi_idx.info AS FLOAT)) AS average_rating, SUM(CASE WHEN k.keyword = 'disco-ball' THEN 1 ELSE 0 END) AS disco_ball_keyword_count, SUM(CASE WHEN k.keyword = 'bandana' THEN 1 ELSE 0 END) AS bandana_keyword_count, STRING_AGG(DISTINCT ct.kind, ', ') AS involved_company_types FROM movie_info mi JOIN movie_info_idx mi_idx ON mi.movie_id = mi_idx.movie_id AND mi.info_type_id = mi_idx.info_type_id JOIN kind_type kt ON kt.id = mi.info_type_id JOIN movie_info mii ON mii.movie_id = mi.movie_id JOIN link_type lt ON lt.id = mi_idx.id JOIN keyword k ON k.id = mi_idx.id JOIN company_type ct ON ct.id = mi_idx.id WHERE mi.id IN ('7268657', '7271065', '7267731') AND mi.movie_id IN ('924506', '925955', '929745', '938512', '930430') AND ct.kind IN ('special effects companies', 'miscellaneous companies', 'production companies', 'distributors') AND mi_idx.info SIMILAR TO '(%...[0-9]*[0-9].[0-9]*[0-9]%)' GROUP BY kt.kind;
SELECT kt.kind AS movie_type, COUNT(DISTINCT t.id) AS total_movies, AVG(t.production_year) AS average_production_year, SUM(CASE WHEN n.gender = 'm' THEN 1 ELSE 0 END) AS male_actors_count, SUM(CASE WHEN n.gender = 'f' THEN 1 ELSE 0 END) AS female_actors_count, COUNT(DISTINCT k.id) AS distinct_keywords_used FROM title t INNER JOIN kind_type kt ON t.kind_id = kt.id LEFT JOIN movie_keyword mk ON t.id = mk.movie_id LEFT JOIN keyword k ON mk.keyword_id = k.id LEFT JOIN char_name cn ON t.id = cn.imdb_id LEFT JOIN name n ON cn.id = n.id WHERE t.production_year >= 2000 AND (n.surname_pcode = 'A41' OR n.surname_pcode = 'A42' OR n.surname_pcode = 'A435') GROUP BY kt.kind ORDER BY total_movies DESC;
SELECT ct.kind AS company_type, COUNT(DISTINCT mc.company_id) AS number_of_companies, COUNT(DISTINCT mi.movie_id) AS number_of_movies, AVG(CAST(mi.info AS INTEGER)) FILTER (WHERE it.info = 'budget') AS average_movie_budget, SUM(CAST(mi_idx.info AS INTEGER)) FILTER (WHERE it.info = 'votes') AS total_movie_votes, kt.kind AS movie_kind, COUNT(DISTINCT cc.movie_id) FILTER (WHERE cc.status_id = 1) AS number_of_complete_movies FROM movie_companies AS mc JOIN company_type AS ct ON mc.company_type_id = ct.id JOIN movie_info AS mi ON mc.movie_id = mi.movie_id JOIN info_type AS it ON mi.info_type_id = it.id JOIN movie_info_idx AS mi_idx ON mc.movie_id = mi_idx.movie_id JOIN kind_type AS kt ON kt.id = 1 JOIN complete_cast AS cc ON mc.movie_id = cc.movie_id WHERE ct.kind IN ('special effects companies', 'miscellaneous companies', 'production companies', 'distributors') AND mi.info_type_id IN (SELECT id FROM info_type WHERE info IN ('budget', 'votes')) AND cc.status_id = 1 GROUP BY ct.kind, kt.kind;
