SELECT COUNT(DISTINCT t.id) AS total_movies, AVG(t.production_year) AS average_production_year, MAX(t.production_year) AS latest_production_year, MIN(t.production_year) AS oldest_production_year, COUNT(DISTINCT k.keyword_id) AS unique_keywords, COUNT(DISTINCT cn.id) AS total_companies_involved, COUNT(DISTINCT at.id) AS total_alternate_titles FROM title AS t JOIN movie_keyword AS k ON t.id = k.movie_id JOIN company_name AS cn ON cn.id = t.id LEFT JOIN aka_title AS at ON t.id = at.movie_id WHERE t.production_year >= 2000 AND t.production_year <= 2010 GROUP BY t.kind_id HAVING COUNT(DISTINCT cn.country_code) > 1;
SELECT AVG(t.production_year) AS average_production_year, COUNT(DISTINCT k.id) AS number_of_unique_keywords, SUM(CASE WHEN mc.company_type_id = 1 THEN 1 ELSE 0 END) AS number_of_production_companies, COUNT(DISTINCT mk.movie_id) AS number_of_movies_with_keywords, COUNT(DISTINCT t.id) AS total_movies FROM title AS t JOIN movie_keyword AS mk ON t.id = mk.movie_id JOIN keyword AS k ON mk.keyword_id = k.id JOIN movie_companies AS mc ON t.id = mc.movie_id JOIN complete_cast AS cc ON t.id = cc.movie_id WHERE t.production_year > 1990 AND mc.company_type_id IN (1, 2, 3) AND cc.status_id = 1 AND k.phonetic_code IN ('W25', 'P4232', 'G4323') GROUP BY t.kind_id HAVING COUNT(DISTINCT mc.company_id) > 5 ORDER BY average_production_year DESC;
SELECT t.production_year, COUNT(DISTINCT ci.movie_id) AS total_movies, AVG(ci.nr_order) AS average_cast_order, SUM(CASE WHEN lt.link = 'spin off' THEN 1 ELSE 0 END) AS spin_off_count, STRING_AGG(DISTINCT cn.name, ', ') AS character_names FROM title t JOIN cast_info ci ON ci.movie_id = t.id LEFT JOIN char_name cn ON cn.id = ci.person_id LEFT JOIN movie_link ml ON ml.movie_id = t.id LEFT JOIN link_type lt ON lt.id = ml.link_type_id WHERE t.production_year BETWEEN 2000 AND 2010 GROUP BY t.production_year ORDER BY t.production_year;
SELECT COUNT(DISTINCT an.id) AS number_of_aka_names, AVG(cc.status_id) AS average_status_id, SUM(CASE WHEN cc.movie_id = 86434 THEN 1 ELSE 0 END) AS count_movie_86434, SUM(CASE WHEN cc.movie_id = 1676869 THEN 1 ELSE 0 END) AS count_movie_1676869, it.info AS information_type, MAX(an.name) AS most_common_alias FROM aka_name an JOIN complete_cast cc ON an.person_id = cc.subject_id JOIN info_type it ON cc.status_id = it.id GROUP BY it.info ORDER BY number_of_aka_names DESC, average_status_id;
SELECT kt.kind AS content_type, COUNT(DISTINCT t.id) AS total_titles, AVG(t.production_year) AS average_production_year, COUNT(DISTINCT a.person_id) AS total_individuals, SUM(CASE WHEN t.series_years = '1978-????' THEN 1 ELSE 0 END) AS count_series_from_1978 FROM title AS t JOIN kind_type AS kt ON t.kind_id = kt.id LEFT JOIN aka_name AS a ON a.id = t.id LEFT JOIN role_type AS rt ON rt.id = a.id WHERE rt.role = 'editor' AND t.production_year IS NOT NULL GROUP BY kt.kind ORDER BY total_titles DESC;
SELECT AVG(ak.production_year) AS average_production_year, COUNT(DISTINCT an.person_id) AS number_of_unique_persons, COUNT(DISTINCT mk.movie_id) AS number_of_movies_with_keywords, SUM(CASE WHEN ml.link_type_id = 12 THEN 1 ELSE 0 END) AS count_of_link_type_12 FROM aka_title AS ak JOIN aka_name AS an ON ak.id = an.person_id JOIN movie_keyword AS mk ON ak.movie_id = mk.movie_id JOIN movie_link AS ml ON ak.movie_id = ml.movie_id WHERE an.name_pcode_cf IN ('P54', 'A5321', 'D232', 'A1463', 'V4214', 'A235') AND ak.kind_id = (SELECT id FROM info_type WHERE info = 'movie') AND ak.production_year BETWEEN 2000 AND 2020 GROUP BY ak.kind_id;
SELECT ct.kind AS company_type, AVG(t.production_year) AS average_production_year, COUNT(DISTINCT t.id) AS number_of_movies, SUM(CASE WHEN ak.season_nr IS NOT NULL THEN 1 ELSE 0 END) AS number_of_series_episodes, COUNT(DISTINCT mk.keyword_id) AS unique_keywords_used, COUNT(DISTINCT ml.linked_movie_id) AS number_of_linked_movies FROM title AS t LEFT JOIN aka_title AS ak ON t.id = ak.movie_id LEFT JOIN movie_companies AS mc ON t.id = mc.movie_id LEFT JOIN company_type AS ct ON mc.company_type_id = ct.id LEFT JOIN movie_keyword AS mk ON t.id = mk.movie_id LEFT JOIN movie_link AS ml ON t.id = ml.movie_id WHERE t.production_year BETWEEN 2000 AND 2010 AND mc.note LIKE '%(TV)%' AND (ak.season_nr IN ('13', '5', '19') OR ak.season_nr IS NULL) AND (ak.production_year = '2008' OR ak.production_year IS NULL) GROUP BY ct.kind ORDER BY average_production_year DESC, number_of_movies DESC;
SELECT COUNT(DISTINCT ci.movie_id) AS total_movies, AVG(mi_idx.avg_rating) AS average_movie_rating, SUM(case when ci.note LIKE '%(voice)%' THEN 1 ELSE 0 END) AS total_voice_roles FROM cast_info ci JOIN (SELECT movie_id, AVG(CAST(info AS FLOAT)) as avg_rating FROM movie_info_idx WHERE info_type_id = 101 GROUP BY movie_id) mi_idx ON mi_idx.movie_id = ci.movie_id JOIN movie_keyword mk ON mk.movie_id = ci.movie_id JOIN char_name chn ON chn.id = ci.person_role_id JOIN aka_name an ON an.person_id = ci.person_id WHERE chn.surname_pcode IN ('L236', 'S4251', 'H61', 'M13', 'G64', 'B4123') AND an.md5sum IN ('335ed401df5f248a3e329bb55d27dd0d', '7b6c3470024015d9b7509ce72ba9bdbe', '676e4dab04ea3f8b91859f8353698682', 'ae437679898b344a4c9d5b911ff41b3d', '2326d6a8ac3328a37b6196b7d6122ca1', '2f0962bd6afa28b8588a8333f39cbb4e') AND mk.keyword_id IN (SELECT id FROM movie_keyword WHERE movie_id = mk.movie_id) GROUP BY chn.surname_pcode;
