SELECT kt.kind AS movie_kind, AVG(t.production_year) AS average_production_year, COUNT(DISTINCT t.id) AS total_movies, COUNT(DISTINCT n.id) AS total_actors, SUM(CASE WHEN n.gender = 'F' THEN 1 ELSE 0 END) AS female_actors, SUM(CASE WHEN n.gender = 'M' THEN 1 ELSE 0 END) AS male_actors, COUNT(DISTINCT k.id) AS total_keywords FROM title t JOIN kind_type kt ON t.kind_id = kt.id LEFT JOIN cast_info ci ON t.id = ci.movie_id LEFT JOIN name n ON ci.person_id = n.id LEFT JOIN movie_keyword mk ON t.id = mk.movie_id LEFT JOIN keyword k ON mk.keyword_id = k.id WHERE t.production_year BETWEEN 2000 AND 2020 AND kt.kind IN ('movie', 'tv series', 'video') AND t.season_nr IS NULL GROUP BY kt.kind ORDER BY total_movies DESC, average_production_year DESC;
SELECT rt.ROLE, COUNT(DISTINCT ci.person_id) AS number_of_people, AVG(ci.nr_order) AS average_cast_order, SUM(CASE WHEN ci.note LIKE '%(voice)%' THEN 1 ELSE 0 END) AS number_of_voice_roles, COUNT(DISTINCT mk.keyword_id) AS number_of_keywords, COUNT(DISTINCT ml.linked_movie_id) AS number_of_linked_movies FROM cast_info ci JOIN role_type rt ON ci.role_id = rt.id JOIN movie_keyword mk ON ci.movie_id = mk.movie_id JOIN movie_link ml ON ci.movie_id = ml.movie_id GROUP BY rt.ROLE HAVING COUNT(DISTINCT ci.person_id) > 50;
SELECT COUNT(DISTINCT ci.movie_id) AS number_of_movies, AVG(mi_idx.info::numeric) AS average_movie_rating, SUM(CASE WHEN ci.person_role_id IS NOT NULL THEN 1 ELSE 0 END) AS total_cast_with_role, n.gender, n.name_pcode_nf FROM cast_info ci JOIN movie_info_idx mi_idx ON ci.movie_id = mi_idx.movie_id JOIN name n ON ci.person_id = n.id WHERE mi_idx.info_type_id = (SELECT id FROM info_type WHERE info = 'rating') AND n.name_pcode_nf IN ('T6535', 'E3245', 'T124') AND ci.nr_order IN (2, 21, 10, 117, 42) GROUP BY n.gender, n.name_pcode_nf ORDER BY average_movie_rating DESC;
SELECT n.name AS actor_name, COUNT(DISTINCT ci.movie_id) AS number_of_movies, AVG(t.production_year) AS average_production_year, SUM(CASE WHEN lt.id = 3 THEN 1 ELSE 0 END) AS count_of_sequels, SUM(CASE WHEN lt.id = 4 THEN 1 ELSE 0 END) AS count_of_prequels FROM cast_info ci JOIN name n ON ci.person_id = n.id JOIN title t ON ci.movie_id = t.id LEFT JOIN movie_link ml ON t.id = ml.movie_id LEFT JOIN link_type lt ON ml.link_type_id = lt.id WHERE n.gender = 'F' AND t.kind_id IN (2, 7) AND t.production_year BETWEEN 1990 AND 2000 GROUP BY n.name HAVING COUNT(DISTINCT ci.movie_id) > 5 ORDER BY number_of_movies DESC, average_production_year DESC;
SELECT kt.kind AS movie_kind, AVG(CAST(mi.info AS INTEGER)) AS average_budget, COUNT(DISTINCT mc.movie_id) AS number_of_movies, COUNT(DISTINCT at.id) AS number_of_alternate_titles, SUM(CASE WHEN cc.status_id = 1 THEN 1 ELSE 0 END) AS completed_cast_count FROM movie_info mi JOIN movie_companies mc ON mc.movie_id = mi.movie_id JOIN kind_type kt ON kt.id = (SELECT kind_id FROM aka_title WHERE movie_id = mi.movie_id LIMIT 1) LEFT JOIN aka_title at ON at.movie_id = mi.movie_id LEFT JOIN complete_cast cc ON cc.movie_id = mi.movie_id WHERE mi.info_type_id = 3 AND mc.company_type_id = 2 AND mi.movie_id IN ('929898', '931171', '924369', '925167', '939922') AND kt.kind <> 'tv series' GROUP BY kt.kind ORDER BY average_budget DESC;
SELECT ct.kind AS company_type, COUNT(DISTINCT cn.name) AS distinct_company_names, COUNT(DISTINCT cn.country_code) AS distinct_country_codes, AVG(cc.movie_id) AS average_movie_id, SUM(CASE WHEN rt.role = 'producer' THEN 1 ELSE 0 END) AS total_producers, SUM(CASE WHEN rt.role = 'editor' THEN 1 ELSE 0 END) AS total_editors, COUNT(DISTINCT cc.movie_id) AS distinct_movies_with_complete_cast, MAX(cc.status_id) AS max_status_id FROM company_name cn JOIN company_type ct ON cn.id = ct.id JOIN complete_cast cc ON cc.movie_id = cn.imdb_id JOIN role_type rt ON rt.id = cc.subject_id WHERE cn.country_code != 'US' AND rt.role IN ('guest', 'actress', 'editor', 'producer') GROUP BY ct.kind ORDER BY total_producers DESC;
SELECT t.production_year, COUNT(DISTINCT t.id) AS number_of_movies, AVG(mc.company_id) AS average_company_id, SUM(CASE WHEN t.kind_id = '2' THEN 1 ELSE 0 END) AS number_of_kind_id_2, COUNT(DISTINCT pi.person_id) AS number_of_persons_involved, MAX(t.episode_nr) AS highest_episode_number FROM title AS t JOIN movie_companies AS mc ON t.id = mc.movie_id LEFT JOIN person_info AS pi ON pi.person_id = mc.company_id WHERE mc.note LIKE '%(TV)%' AND t.production_year BETWEEN 1990 AND 2000 GROUP BY t.production_year ORDER BY t.production_year;
SELECT rt.role AS role_type, COUNT(DISTINCT ci.person_id) AS number_of_persons, AVG(mi_idx.info::numeric) AS average_rating, SUM(CASE WHEN mi.info = 'Greek' THEN 1 ELSE 0 END) AS greek_language_movies, SUM(CASE WHEN mi.info = 'Hindi' THEN 1 ELSE 0 END) AS hindi_language_movies, SUM(CASE WHEN mi.info = 'Kyrgyz' THEN 1 ELSE 0 END) AS kyrgyz_language_movies FROM role_type AS rt JOIN cast_info AS ci ON rt.id = ci.role_id JOIN movie_info AS mi ON ci.movie_id = mi.movie_id JOIN movie_info_idx AS mi_idx ON mi.movie_id = mi_idx.movie_id WHERE rt.role = 'writer' AND mi_idx.info_type_id = (SELECT id FROM info_type WHERE info = 'rating') AND mi.info_type_id IN (SELECT id FROM info_type WHERE info IN ('languages', 'language')) GROUP BY rt.role;
SELECT AVG(mc.company_type_id) AS average_company_type, COUNT(DISTINCT mk.movie_id) AS total_movies_with_keywords, SUM(CASE WHEN cn.country_code = 'US' THEN 1 ELSE 0 END) AS total_us_companies, cn.name AS company_name, k.keyword AS keyword_name, COUNT(DISTINCT ml.link_type_id) AS total_link_types FROM movie_companies AS mc JOIN company_name AS cn ON mc.company_id = cn.id JOIN movie_keyword AS mk ON mc.movie_id = mk.movie_id JOIN keyword AS k ON mk.keyword_id = k.id JOIN movie_link AS ml ON mc.movie_id = ml.movie_id WHERE cn.name_pcode_nf IN ('L3424', 'T3231', 'J23') AND ml.id IN ('713', '4080', '967', '4313', '3260') AND k.phonetic_code IN ('M5', 'P4162', 'V4514', 'H452') GROUP BY cn.name, k.keyword ORDER BY total_movies_with_keywords DESC, total_us_companies DESC;
SELECT kt.kind AS movie_kind, AVG(t.production_year) AS average_production_year, COUNT(DISTINCT mc.company_id) AS number_of_companies_involved, SUM(CASE WHEN it.info = 'rentals' THEN 1 ELSE 0 END) AS rental_info_count, COUNT(DISTINCT n.id) AS number_of_actors FROM title AS t JOIN kind_type AS kt ON t.kind_id = kt.id JOIN movie_companies AS mc ON t.id = mc.movie_id LEFT JOIN info_type AS it ON it.info = 'rentals' OR it.info = 'LD disc format' LEFT JOIN complete_cast AS cc ON t.id = cc.movie_id LEFT JOIN name AS n ON cc.subject_id = n.id WHERE t.production_year > 1990 AND kt.kind IN ('tv movie', 'movie') AND mc.movie_id IN (29084, 12692, 23482, 19661, 19291, 18927) GROUP BY kt.kind ORDER BY average_production_year DESC, number_of_companies_involved;
SELECT AVG(CAST(mi.info AS NUMERIC)) AS average_movie_duration, COUNT(DISTINCT ci.movie_id) AS number_of_movies, COUNT(DISTINCT ci.person_id) AS number_of_actors, MAX(CAST(mi.info AS INTERVAL)) AS longest_movie_duration, MIN(CAST(mi.info AS INTERVAL)) AS shortest_movie_duration FROM movie_info mi JOIN cast_info ci ON mi.movie_id = ci.movie_id JOIN movie_companies mc ON mi.movie_id = mc.movie_id JOIN comp_cast_type cct ON ci.person_role_id = cct.id JOIN char_name cn ON ci.person_id = cn.id WHERE mi.info_type_id = (SELECT id FROM info_type WHERE info = 'runtime') AND mc.note LIKE '%(USA)%' AND cct.kind IN ('cast', 'complete') AND cn.surname_pcode IN ('E235', 'A6432', 'E2536', 'A1526') GROUP BY mc.company_id ORDER BY average_movie_duration DESC;
SELECT CT.kind AS company_type, COUNT(DISTINCT ML.movie_id) AS total_movies_linked, AVG(CAST(MI.info AS NUMERIC)) AS average_rating, SUM(CASE WHEN ML.linked_movie_id IN ('583610', '1639457', '20479', '2056353', '346879') THEN 1 ELSE 0 END) AS specific_links_count FROM movie_link ML JOIN movie_info MI ON ML.movie_id = MI.movie_id AND MI.info_type_id = '4' JOIN company_name CN ON CN.imdb_id = ML.movie_id JOIN company_type CT ON CN.id = CT.id WHERE ML.link_type_id IN ('1', '2') GROUP BY CT.kind HAVING COUNT(DISTINCT ML.movie_id) > 10 ORDER BY average_rating DESC;
SELECT ct.kind AS company_type, AVG(CASE WHEN ml.link_type_id = '3' THEN 1 ELSE 0 END) AS avg_movie_references, COUNT(DISTINCT mk.movie_id) AS unique_movies_with_keywords, COUNT(DISTINCT at.id) AS total_aka_titles, SUM(CASE WHEN at.phonetic_code IN ('T54', 'V5231') THEN 1 ELSE 0 END) AS count_phonetic_code_matches, MAX(at.production_year) AS latest_production_year FROM company_type ct LEFT JOIN movie_companies mc ON ct.id = mc.company_type_id LEFT JOIN movie_link ml ON mc.movie_id = ml.movie_id LEFT JOIN movie_keyword mk ON mc.movie_id = mk.movie_id LEFT JOIN aka_title at ON mc.movie_id = at.movie_id WHERE ct.kind = 'distributors' AND ml.link_type_id IN ('3', '9', '15', '4', '10') GROUP BY ct.kind;
SELECT ct.kind AS company_kind, COUNT(DISTINCT mc.company_id) AS number_of_companies, AVG(CAST(mi.info AS DECIMAL)) AS average_movie_length, SUM(CASE WHEN mi.info_type_id = 1 THEN 1 ELSE 0 END) AS number_of_movies_with_specific_info, MIN(t.title) AS shortest_movie_title, MAX(t.title) AS longest_movie_title, COUNT(DISTINCT c.id) AS number_of_complete_cast_records FROM movie_companies mc JOIN company_type ct ON mc.company_type_id = ct.id JOIN movie_info mi ON mc.movie_id = mi.movie_id JOIN title t ON mi.movie_id = t.id LEFT JOIN complete_cast c ON t.id = c.movie_id WHERE ct.id = 3 GROUP BY ct.kind HAVING COUNT(DISTINCT mc.movie_id) > 5;
SELECT kt.kind AS movie_kind, lt.LINK AS link_type, COUNT(DISTINCT ml.movie_id) AS number_of_movies, AVG(cn.imdb_id) AS average_imdb_id, SUM(cn.imdb_id) AS total_imdb_id, MIN(cn.name) AS first_company_name_in_list FROM movie_link AS ml JOIN link_type AS lt ON lt.id = ml.link_type_id JOIN kind_type AS kt ON kt.id = 1 JOIN company_name AS cn ON cn.imdb_id = ml.movie_id WHERE lt.link IN ('edited into', 'edited from', 'remade as') AND cn.country_code = 'US' AND cn.name_pcode_nf IN ('Z5121', 'B4513', 'I5353', 'A3531') GROUP BY kt.kind, lt.LINK ORDER BY number_of_movies DESC;
SELECT kt.kind AS movie_kind, COUNT(DISTINCT mi_idx.movie_id) AS total_movies, AVG(CAST(mi_idx.info AS INTEGER)) AS average_movie_rating, SUM(CASE WHEN cn.country_code = '[sd]' THEN 1 ELSE 0 END) AS sudanese_company_movies, SUM(CASE WHEN cn.country_code = '[dz]' THEN 1 ELSE 0 END) AS algerian_company_movies, SUM(CASE WHEN cn.country_code = '[dm]' THEN 1 ELSE 0 END) AS dominican_company_movies, COUNT(DISTINCT k.id) AS total_unique_keywords FROM movie_info_idx AS mi_idx JOIN kind_type AS kt ON mi_idx.info_type_id = kt.id JOIN movie_info_idx AS mi_votes ON mi_idx.movie_id = mi_votes.movie_id AND mi_votes.info_type_id = 41 JOIN company_name AS cn ON mi_idx.movie_id = cn.imdb_id LEFT JOIN movie_keyword AS mk ON mi_idx.movie_id = mk.movie_id LEFT JOIN keyword AS k ON mk.keyword_id = k.id WHERE mi_idx.info_type_id IN (112, 72) AND kt.id IN (2, 1, 3) GROUP BY kt.kind;
SELECT ct.kind AS company_type, it.info AS info_type, COUNT(DISTINCT mi.movie_id) AS number_of_movies, AVG(mi.id) AS average_movie_info_id, SUM(CASE WHEN mi.note IS NOT NULL THEN 1 ELSE 0 END) AS count_of_notes FROM movie_info mi JOIN info_type it ON mi.info_type_id = it.id JOIN movie_info_idx mi_idx ON mi.movie_id = mi_idx.movie_id JOIN company_type ct ON ct.id::text = mi.info WHERE mi.info_type_id IN (80, 15, 107, 26, 82) AND it.info LIKE 'crazy credits' AND mi_idx.id IN (2000, 184) AND ct.kind IN ('special effects companies', 'miscellaneous companies', 'production companies', 'distributors') GROUP BY ct.kind, it.info ORDER BY number_of_movies DESC, average_movie_info_id;
SELECT rt.ROLE, COUNT(ci.id) AS total_casts, AVG(pi.info::numeric) AS average_salary, SUM(CASE WHEN an.name IS NOT NULL THEN 1 ELSE 0 END) AS aliases_count FROM role_type rt LEFT JOIN cast_info ci ON rt.id = ci.role_id LEFT JOIN person_info pi ON ci.person_id = pi.person_id AND pi.info_type_id = 6 LEFT JOIN aka_name an ON ci.person_id = an.person_id GROUP BY rt.ROLE ORDER BY total_casts DESC, average_salary DESC;
SELECT COUNT(DISTINCT t.id) AS total_movies, AVG(t.production_year) AS average_production_year, SUM(CASE WHEN t.series_years LIKE '%????' THEN 1 ELSE 0 END) AS ongoing_series_count, ct.kind AS company_type_kind, AVG(CAST(cn.country_code AS numeric)) AS average_country_code_numeric, ct.id AS company_type_id, MAX(t.season_nr) AS max_season_number FROM title t JOIN company_name cn ON t.id = cn.id JOIN company_type ct ON cn.id = ct.id JOIN complete_cast cc ON t.id = cc.movie_id JOIN comp_cast_type cct ON cc.subject_id = cct.id JOIN aka_title at ON t.id = at.movie_id JOIN info_type it ON at.id = it.id WHERE t.season_nr IN (6, 15, 8, 17) AND t.series_years IN ('1963-1969', '2003-2006', '1997-1998', '1974-????', '1956-????', '1993-1994') AND it.id IN (20, 107, 32, 88) AND it.info IN ('death notes', 'votes', 'LD subtitles', 'LD dynamic range', 'LD close captions-teletext-ld-g', 'adaption') AND cct.id = 1 AND cct.kind IN ('complete+verified', 'cast', 'crew', 'complete') AND at.id = 33786 AND at.production_year IN (2002, 1976, 1959) GROUP BY ct.kind, ct.id ORDER BY total_movies DESC;
