SELECT kt.kind AS movie_kind, AVG(mi.info::numeric) AS average_rating, COUNT(DISTINCT t.id) AS total_movies, COUNT(DISTINCT an.id) AS total_actors, SUM(CASE WHEN cn.country_code = '[us]' THEN 1 ELSE 0 END) AS total_us_production_companies FROM title t JOIN kind_type kt ON t.kind_id = kt.id JOIN movie_info mi ON t.id = mi.movie_id JOIN info_type it ON mi.info_type_id = it.id AND it.info = 'rating' LEFT JOIN movie_companies mc ON t.id = mc.movie_id LEFT JOIN company_name cn ON mc.company_id = cn.id LEFT JOIN complete_cast cc ON t.id = cc.movie_id LEFT JOIN complete_cast an ON cc.id = an.id WHERE kt.kind IN ('video game', 'episode', 'tv series', 'tv mini series') AND t.production_year > 2000 GROUP BY kt.kind HAVING AVG(mi.info::numeric) > 5.0 ORDER BY average_rating DESC;
SELECT ct.kind AS company_kind, AVG(CAST(mi_idx.info AS NUMERIC)) AS average_rating, COUNT(DISTINCT mk.movie_id) AS num_movies_with_keywords, COUNT(DISTINCT mc.movie_id) AS num_movies_by_company_type, COUNT(DISTINCT aka.name) AS unique_aka_names FROM movie_info_idx mi_idx JOIN info_type it ON mi_idx.info_type_id = it.id AND it.info = 'rating' JOIN movie_keyword mk ON mi_idx.movie_id = mk.movie_id JOIN movie_companies mc ON mk.movie_id = mc.movie_id JOIN company_type ct ON mc.company_type_id = ct.id LEFT JOIN aka_name aka ON aka.person_id = mc.company_id WHERE mk.keyword_id IN (2900, 3761, 2634) AND mc.company_type_id IN (SELECT id FROM company_type WHERE kind LIKE '%production%') AND aka.name_pcode_cf IN ('M65', 'S352', 'C64') GROUP BY ct.kind ORDER BY average_rating DESC;
SELECT t.production_year, ct.kind AS company_type, COUNT(t.id) AS movie_count FROM title t JOIN movie_companies mc ON t.id = mc.movie_id JOIN company_name cn ON mc.company_id = cn.id JOIN company_type ct ON mc.company_type_id = ct.id WHERE cn.country_code IN ('[gb]', '[dk]') AND ct.kind IN ('Distribution', 'Production') GROUP BY t.production_year, ct.kind ORDER BY t.production_year ASC, ct.kind;
SELECT COUNT(DISTINCT ci.movie_id) AS total_movies, AVG(mi_idx.avg_rating) AS average_movie_rating, SUM(case when ci.note LIKE '%(voice)%' THEN 1 ELSE 0 END) AS total_voice_roles FROM cast_info ci JOIN (SELECT movie_id, AVG(CAST(info AS FLOAT)) as avg_rating FROM movie_info_idx WHERE info_type_id = 101 GROUP BY movie_id) mi_idx ON mi_idx.movie_id = ci.movie_id JOIN movie_keyword mk ON mk.movie_id = ci.movie_id JOIN char_name chn ON chn.id = ci.person_role_id JOIN aka_name an ON an.person_id = ci.person_id WHERE chn.surname_pcode IN ('L236', 'S4251', 'H61', 'M13', 'G64', 'B4123') AND an.md5sum IN ('335ed401df5f248a3e329bb55d27dd0d', '7b6c3470024015d9b7509ce72ba9bdbe', '676e4dab04ea3f8b91859f8353698682', 'ae437679898b344a4c9d5b911ff41b3d', '2326d6a8ac3328a37b6196b7d6122ca1', '2f0962bd6afa28b8588a8333f39cbb4e') AND mk.keyword_id IN (SELECT id FROM movie_keyword WHERE movie_id = mk.movie_id) GROUP BY chn.surname_pcode;
SELECT COUNT(DISTINCT ml.movie_id) AS NumberOfMovies, COUNT(DISTINCT ml.linked_movie_id) AS NumberOfLinkedMovies, AVG(n.imdb_id) AS AverageIMDbID, SUM(CASE WHEN cc.status_id = 3 THEN 1 ELSE 0 END) AS Status3Count, SUM(CASE WHEN cc.status_id = 4 THEN 1 ELSE 0 END) AS Status4Count FROM movie_link AS ml JOIN complete_cast AS cc ON cc.movie_id = ml.movie_id JOIN name AS n ON n.id = cc.subject_id WHERE cc.status_id IN (3, 4) GROUP BY cc.subject_id;
SELECT AVG(mi_idx.info::integer) AS average_movie_rating, COUNT(DISTINCT k.id) AS total_unique_keywords, COUNT(DISTINCT cn.id) AS total_companies_involved, COUNT(DISTINCT pi.person_id) AS total_people_with_info, MAX(cn.name) AS largest_company_name FROM keyword AS k, movie_keyword AS mk, movie_info_idx AS mi_idx, company_name AS cn, movie_companies AS mc, person_info AS pi, comp_cast_type AS cct WHERE k.keyword IN ('hang-gliding', 'stubbornness', 'porch-swing', 'cereal', 'identical-twins') AND k.id = mk.keyword_id AND mk.movie_id = mi_idx.movie_id AND mc.movie_id = mi_idx.movie_id AND mc.company_id = cn.id AND pi.info_type_id = cct.id AND cct.kind IN ('complete+verified', 'cast', 'crew', 'complete') GROUP BY cct.kind;
SELECT kt.kind AS movie_kind, COUNT(DISTINCT ml.movie_id) AS number_of_movies, COUNT(DISTINCT ml.linked_movie_id) AS number_of_linked_movies, AVG(ml.link_type_id) AS average_link_type_id, SUM(CASE WHEN rt.role = 'producer' THEN 1 ELSE 0 END) AS producer_roles_count, SUM(CASE WHEN rt.role = 'actress' THEN 1 ELSE 0 END) AS actress_roles_count FROM movie_link AS ml JOIN kind_type AS kt ON ml.movie_id = kt.id JOIN role_type AS rt ON ml.link_type_id = rt.id WHERE kt.kind IN ('movie', 'tv mini series', 'episode') AND rt.role IN ('guest', 'cinematographer', 'producer', 'actress') GROUP BY kt.kind;
SELECT cct.kind, COUNT(*) AS count_cast_types, AVG(cn.imdb_id) AS average_imdb_id, SUM(cn.imdb_id) AS sum_imdb_id, cn.country_code, COUNT(DISTINCT cn.name) AS distinct_company_names, COUNT(DISTINCT mi.movie_id) AS distinct_movies FROM comp_cast_type cct JOIN company_name cn ON cct.id = cn.id JOIN movie_info_idx mi ON cn.id = mi.info_type_id WHERE cn.country_code IN ('[cu]', '[se]', '[dk]', '[ar]', '[al]') AND cn.name_pcode_nf IN ('M2531', 'A6254', 'M6341', 'K3256') AND cct.kind IN ('complete+verified', 'cast', 'crew', 'complete') GROUP BY cct.kind, cn.country_code ORDER BY count_cast_types DESC;
SELECT AVG(COALESCE(NULLIF(pi.info::NUMERIC, 0), 0)) AS avg_person_info_numeric, SUM(CASE WHEN mk.keyword_id IN (2717, 2798) THEN 1 ELSE 0 END) AS sum_movie_keyword_special, COUNT(DISTINCT mc.movie_id) AS count_distinct_movies_with_companies, COUNT(DISTINCT an.person_id) AS count_distinct_persons_with_aka, COUNT(DISTINCT ml.linked_movie_id) AS count_linked_movies FROM person_info pi LEFT JOIN aka_name an ON pi.person_id = an.person_id LEFT JOIN movie_keyword mk ON mk.movie_id = an.person_id LEFT JOIN movie_companies mc ON mc.movie_id = mk.movie_id LEFT JOIN movie_link ml ON ml.movie_id = mc.movie_id WHERE an.name IN ('Alouf, Bernard', 'Almedia-Pederalba, Karen', 'Chanclettes, The', 'Ali, Muhammed', 'Verbrugge, Willy') AND pi.id IN ('3188', '489', '4904') AND mk.id IN ('4094', '2901', '4468') AND ml.id IN ('608', '4874', '3573');
