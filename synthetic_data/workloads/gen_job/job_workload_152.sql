SELECT kt.kind AS movie_type, AVG(mi_idx.info::numeric) AS average_rating, COUNT(DISTINCT mk.movie_id) AS movie_count, COUNT(DISTINCT cn.id) AS company_count, COUNT(DISTINCT n.id) AS actor_count FROM movie_info mi JOIN kind_type kt ON mi.movie_id = kt.id JOIN movie_info_idx mi_idx ON mi.movie_id = mi_idx.movie_id JOIN movie_keyword mk ON mi.movie_id = mk.movie_id JOIN company_name cn ON mi.movie_id = cn.imdb_id JOIN cast_info ci ON ci.movie_id = mi.movie_id JOIN name n ON ci.person_id = n.id WHERE kt.id IN ('7', '1', '4') AND cn.name_pcode_sf IN ('F2365', 'Z3132', 'Y6253', 'F4231') AND mk.keyword_id IN ('3887', '4275', '3550', '4202') AND mi_idx.info_type_id = (SELECT id FROM info_type WHERE info = 'rating') AND ci.role_id = (SELECT id FROM role_type WHERE role = 'actor') GROUP BY kt.kind;
SELECT cct.kind AS cast_type_kind, COUNT(DISTINCT mk.movie_id) AS number_of_movies, AVG(kt.id) AS average_kind_type_id, SUM(mk.keyword_id) AS total_keyword_id_sum FROM comp_cast_type cct JOIN movie_keyword mk ON cct.id = mk.movie_id JOIN kind_type kt ON mk.movie_id = kt.id WHERE cct.kind IN ('complete+verified', 'cast', 'crew', 'complete') AND mk.movie_id IN (13927, 7318, 9248, 15407) GROUP BY cct.kind ORDER BY number_of_movies DESC;
SELECT kt.kind AS movie_type, COUNT(DISTINCT at.movie_id) AS number_of_titles, AVG(at.production_year) AS average_production_year, SUM(CASE WHEN cc.status_id = '4' THEN 1 ELSE 0 END) AS count_completed_status_4, SUM(CASE WHEN cc.status_id = '3' THEN 1 ELSE 0 END) AS count_completed_status_3 FROM aka_title at JOIN kind_type kt ON at.kind_id = kt.id LEFT JOIN complete_cast cc ON at.movie_id = cc.movie_id GROUP BY kt.kind ORDER BY number_of_titles DESC;
SELECT it.info AS company_role, COUNT(DISTINCT mc.movie_id) AS number_of_movies, COUNT(DISTINCT mc.company_id) AS number_of_companies, AVG(CAST(coalesce(an.name_pcode_cf, '0') AS INTEGER)) AS avg_name_code_cf, SUM(CAST(coalesce(an.name_pcode_nf, '0') AS INTEGER)) AS total_name_code_nf FROM movie_companies mc JOIN role_type rt ON mc.company_type_id = rt.id JOIN info_type it ON rt.id = it.id LEFT JOIN aka_name an ON mc.movie_id = an.person_id WHERE mc.id IN (2557, 2170, 250, 4955, 466) GROUP BY it.info ORDER BY number_of_movies DESC;
SELECT kt.kind, AVG(at.production_year) AS avg_production_year, COUNT(DISTINCT at.title) AS title_count, SUM(CASE WHEN cn.id IS NOT NULL THEN 1 ELSE 0 END) AS unique_character_count FROM aka_title AS at JOIN kind_type AS kt ON at.kind_id = kt.id LEFT JOIN movie_info AS mi ON at.movie_id = mi.movie_id LEFT JOIN char_name AS cn ON mi.movie_id = cn.id WHERE at.production_year IS NOT NULL GROUP BY kt.kind ORDER BY avg_production_year DESC, title_count DESC;
SELECT rt.ROLE, COUNT(DISTINCT cn.id) AS num_companies, COUNT(DISTINCT ch.id) AS num_characters, AVG(pi.person_id) AS avg_person_id, SUM(pi.id) AS total_person_info_ids FROM role_type rt JOIN person_info pi ON rt.id = pi.info_type_id JOIN char_name ch ON pi.person_id = ch.id JOIN company_name cn ON ch.surname_pcode = cn.name_pcode_sf WHERE rt.ROLE = 'director' AND ch.name_pcode_nf = 'P3636' AND cn.name_pcode_sf = 'I1341' AND rt.id IN ('7', '5', '3', '1', '9') GROUP BY rt.ROLE ORDER BY num_companies DESC;
