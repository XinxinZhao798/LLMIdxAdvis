SELECT rt.ROLE, COUNT(DISTINCT ci.person_id) AS num_people, COUNT(DISTINCT ci.movie_id) AS num_movies, AVG(ci.nr_order) AS average_order, SUM(CASE WHEN mc.company_id IN (1160, 1112, 1110, 814, 903, 165) THEN 1 ELSE 0 END) AS num_company_specific_movies, COUNT(DISTINCT k.id) AS num_keywords FROM cast_info ci INNER JOIN role_type rt ON ci.role_id = rt.id LEFT JOIN movie_companies mc ON ci.movie_id = mc.movie_id LEFT JOIN keyword k ON k.id = ci.person_id LEFT JOIN char_name cn ON cn.id = ci.person_id WHERE mc.company_type_id = 1 AND ci.person_role_id IS NOT NULL AND cn.name_pcode_nf IN ('L6521', 'C1456', 'O5423', 'I4253') AND (mc.company_id IN (1160, 1112, 1110, 814, 903, 165) OR mc.company_id IS NULL) GROUP BY rt.ROLE ORDER BY num_people DESC, num_movies DESC;
SELECT t.title AS movie_title, ct.kind AS company_type, rt.role AS role, AVG(t.production_year) AS average_production_year, COUNT(DISTINCT mc.company_id) AS number_of_companies, COUNT(DISTINCT mi.movie_id) AS number_of_movie_info_entries, SUM(CASE WHEN rt.role = 'actor' THEN 1 ELSE 0 END) AS total_actor_roles, SUM(CASE WHEN rt.role = 'director' THEN 1 ELSE 0 END) AS total_director_roles FROM title t JOIN movie_companies mc ON t.id = mc.movie_id JOIN company_type ct ON mc.company_type_id = ct.id JOIN movie_info mi ON t.id = mi.movie_id JOIN role_type rt ON t.id = rt.id WHERE ct.kind IN ('miscellaneous companies', 'special effects companies', 'distributors') AND rt.role IN ('actor', 'guest', 'writer', 'director') AND t.season_nr IS NULL AND t.production_year BETWEEN 2000 AND 2023 GROUP BY t.title, ct.kind, rt.role ORDER BY average_production_year DESC, number_of_companies DESC, number_of_movie_info_entries DESC;
SELECT kt.kind, AVG(at.production_year) AS avg_production_year, COUNT(DISTINCT at.title) AS title_count, SUM(CASE WHEN cn.id IS NOT NULL THEN 1 ELSE 0 END) AS unique_character_count FROM aka_title AS at JOIN kind_type AS kt ON at.kind_id = kt.id LEFT JOIN movie_info AS mi ON at.movie_id = mi.movie_id LEFT JOIN char_name AS cn ON mi.movie_id = cn.id WHERE at.production_year IS NOT NULL GROUP BY kt.kind ORDER BY avg_production_year DESC, title_count DESC;
SELECT lt.LINK AS link_type, COUNT(ml.id) AS total_links, AVG(ml.movie_id) AS average_movie_id, MIN(cn.name) AS character_name_with_min_id, MAX(an.name) AS aka_name_with_max_id FROM movie_link AS ml JOIN link_type AS lt ON ml.link_type_id = lt.id LEFT JOIN char_name AS cn ON cn.id = ml.movie_id AND cn.surname_pcode = 'E2146' LEFT JOIN aka_name AS an ON an.id = ml.linked_movie_id AND an.md5sum = '7df6a930bde6eff675fae9eecfb9ff7e' GROUP BY lt.LINK ORDER BY total_links DESC;
SELECT n.name AS actor_name, COUNT(a.id) AS aka_name_count, AVG(n.imdb_id) AS average_imdb_id, SUM(mc.movie_id) AS sum_movie_ids, MAX(mc.note) AS latest_production_note FROM name n LEFT JOIN aka_name a ON n.id = a.person_id INNER JOIN movie_companies mc ON n.id = mc.company_id WHERE n.imdb_index IN ('IX', 'XVI', 'I', 'XI', 'XIX') AND a.name_pcode_nf IN ('N1312', 'A6236', 'W5653', 'A5463', 'K52', 'B5415') AND mc.company_type_id = '1' GROUP BY n.name;
SELECT ct.kind AS company_kind, COUNT(DISTINCT an.id) AS number_of_aka_names, AVG(cn.imdb_id) AS average_char_imdb_id, SUM(CASE WHEN lt.id IN (5, 7) THEN 1 ELSE 0 END) AS count_link_type_5_or_7 FROM aka_name an JOIN char_name cn ON an.person_id = cn.id JOIN company_type ct ON ct.kind LIKE '%companies' JOIN link_type lt ON lt.id = an.id % 10 WHERE an.person_id = 2704491 AND an.name IN ('Allaudin', 'McKean, Scott', 'Alles, J.') AND cn.id IN ('99259', '3288', '99679', '23104', '45337') AND ct.kind IN ('special effects companies', 'miscellaneous companies', 'production companies', 'distributors') AND lt.id IN (12, 17, 9, 8, 5, 7) GROUP BY ct.kind;
SELECT COUNT(DISTINCT ci.movie_id) AS number_of_movies, AVG(ci.nr_order) AS average_cast_position, MIN(n.name) AS first_actor_name, MAX(n.name) AS last_actor_name, COUNT(DISTINCT n.id) AS number_of_actors, SUM(CASE WHEN ci.note LIKE '%(voice)%' THEN 1 ELSE 0 END) AS number_of_voice_actors, COUNT(DISTINCT cc.id) AS number_of_complete_casts, COUNT(DISTINCT cct.id) AS number_of_different_cast_types FROM cast_info AS ci JOIN name AS n ON ci.person_id = n.id LEFT JOIN complete_cast AS cc ON ci.movie_id = cc.movie_id LEFT JOIN comp_cast_type AS cct ON cc.subject_id = cct.id WHERE ci.role_id = (SELECT id FROM comp_cast_type WHERE kind = 'actor') AND (ci.note LIKE '%(voice)%' OR ci.note NOT LIKE '%(archive footage)%') GROUP BY ci.movie_id HAVING COUNT(DISTINCT ci.person_id) > 1;
SELECT MIN(t.title) AS movie_title, AVG(t.production_year) AS average_production_year, COUNT(DISTINCT n.id) AS total_actors, SUM(CASE WHEN pi.info = 'New Kensington, Pennsylvania, USA' THEN 1 ELSE 0 END) AS actors_from_new_kensington, COUNT(DISTINCT k.id) AS total_keywords_used FROM title AS t JOIN complete_cast AS cc ON t.id = cc.movie_id JOIN name AS n ON cc.subject_id = n.id JOIN person_info AS pi ON n.id = pi.person_id JOIN keyword AS k ON k.phonetic_code = t.phonetic_code WHERE t.imdb_index IN ('V', 'I', 'II') AND n.surname_pcode IN ('A434', 'A414') AND pi.info IN ('New Kensington, Pennsylvania, USA', '5'' 6"', 'Czech Republic') AND pi.note IN ('Bobbie Merritt/THE ENTERTAINMENT GROUP', 'Be Free Films', 'isabelleadriani@yahoo.it', 'Autor', 'Quincy Johnson', 'MSC') GROUP BY t.id;
SELECT ct.kind AS cast_type, AVG(mc.company_id) AS average_company_id, SUM(CASE WHEN mi.info_type_id = 1 THEN 1 ELSE 0 END) AS count_genre_info, COUNT(DISTINCT k.id) AS unique_keyword_count, MAX(mi.movie_id) AS max_movie_id FROM comp_cast_type ct JOIN complete_cast cc ON ct.id = cc.subject_id JOIN movie_companies mc ON cc.movie_id = mc.movie_id JOIN movie_info mi ON mc.movie_id = mi.movie_id JOIN keyword k ON k.id = ANY(ARRAY[6997, 6526]) WHERE mc.company_type_id BETWEEN 1 AND 5 AND mi.info_type_id IN (1, 2, 3, 4) AND mi.note IS NOT NULL AND cc.status_id IN (SELECT id FROM link_type WHERE id IN (4, 8, 12)) GROUP BY ct.kind ORDER BY unique_keyword_count DESC, average_company_id;
SELECT COUNT(DISTINCT mc.movie_id) AS number_of_movies, AVG(t.production_year) AS average_production_year, cct.kind AS company_type, MIN(cn.name) AS company_name, SUM(CASE WHEN n.gender = 'M' THEN 1 ELSE 0 END) AS male_actors, SUM(CASE WHEN n.gender = 'F' THEN 1 ELSE 0 END) AS female_actors FROM movie_companies AS mc JOIN title AS t ON mc.movie_id = t.id JOIN company_name AS cn ON mc.company_id = cn.id JOIN comp_cast_type AS cct ON mc.company_type_id = cct.id LEFT JOIN name AS n ON n.md5sum = mc.note WHERE cn.country_code NOT LIKE '[pl]' AND t.production_year BETWEEN 1950 AND 1999 AND t.phonetic_code = 'D323' AND n.name_pcode_nf IN ('N6454', 'I4364', 'O2464', 'D54', 'M3526', 'G6534') GROUP BY cct.kind;
