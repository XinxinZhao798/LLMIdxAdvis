SELECT ct.kind AS company_type, COUNT(DISTINCT cn.id) AS number_of_companies, COUNT(DISTINCT mc.movie_id) AS number_of_movies, AVG(mi_idx.avg_movie_score) AS average_movie_score, SUM(CASE WHEN mi.info = '(Original Version)' THEN 1 ELSE 0 END) AS original_version_count, SUM(CASE WHEN mi.info = '(English subtitles)' THEN 1 ELSE 0 END) AS english_subtitles_count FROM movie_companies AS mc JOIN company_name AS cn ON mc.company_id = cn.id JOIN company_type AS ct ON mc.company_type_id = ct.id JOIN (SELECT movie_id, AVG(CAST(info AS DOUBLE PRECISION)) AS avg_movie_score FROM movie_info_idx WHERE info_type_id = 101 GROUP BY movie_id) AS mi_idx ON mc.movie_id = mi_idx.movie_id LEFT JOIN movie_info AS mi ON mc.movie_id = mi.movie_id WHERE ct.kind IN ('special effects companies', 'miscellaneous companies', 'production companies', 'distributors') GROUP BY ct.kind;
SELECT rt.ROLE, COUNT(*) AS role_count, AVG(ci.nr_order) AS average_order, SUM(ci.nr_order) AS total_order, MAX(ci.nr_order) AS max_order, MIN(ci.nr_order) AS min_order FROM cast_info ci JOIN role_type rt ON ci.role_id = rt.id JOIN movie_keyword mk ON ci.movie_id = mk.movie_id JOIN movie_info mi ON ci.movie_id = mi.movie_id JOIN movie_link ml ON ci.movie_id = ml.movie_id WHERE mk.keyword_id IN (3544, 4170, 355, 3797, 2901) AND ci.movie_id IN (14730, 8894, 18741, 18773, 15355, 12280, 2069434, 2317758, 2267299) GROUP BY rt.ROLE ORDER BY role_count DESC, average_order;
SELECT cn.name AS company_name, COUNT(DISTINCT mc.movie_id) AS total_movies_produced, AVG(cast_count.cast_count) AS average_cast_per_movie, SUM(keyword_count.keyword_count) AS total_keywords FROM movie_companies AS mc JOIN company_name AS cn ON mc.company_id = cn.id LEFT JOIN (SELECT movie_id, COUNT(*) AS cast_count FROM cast_info GROUP BY movie_id) AS cast_count ON mc.movie_id = cast_count.movie_id LEFT JOIN (SELECT movie_id, COUNT(*) AS keyword_count FROM movie_keyword GROUP BY movie_id) AS keyword_count ON mc.movie_id = keyword_count.movie_id GROUP BY cn.name ORDER BY total_movies_produced DESC, average_cast_per_movie DESC, total_keywords DESC;
SELECT cn.country_code, kt.kind AS title_kind, t.production_year AS year_of_production, COUNT(DISTINCT t.id) AS total_titles, SUM(CASE WHEN n.gender = 'M' THEN 1 ELSE 0 END) AS male_names_count, SUM(CASE WHEN n.gender = 'F' THEN 1 ELSE 0 END) AS female_names_count FROM title t INNER JOIN kind_type kt ON t.kind_id = kt.id LEFT JOIN company_name cn ON t.id = cn.imdb_id LEFT JOIN name n ON t.id = n.imdb_id WHERE t.production_year IS NOT NULL AND (n.gender = 'M' OR n.gender = 'F') GROUP BY cn.country_code, kt.kind, t.production_year ORDER BY cn.country_code, total_titles DESC, t.production_year DESC;
SELECT AVG(mi_idx.info::NUMERIC) AS average_movie_rating, COUNT(DISTINCT cn.name) AS number_of_production_companies, COUNT(DISTINCT chn.name) AS number_of_unique_character_names, SUM(CASE WHEN mw.movie_id IS NOT NULL THEN 1 ELSE 0 END) AS number_of_movies_with_keywords FROM movie_info_idx AS mi_idx JOIN movie_keyword AS mw ON mi_idx.movie_id = mw.movie_id JOIN company_name AS cn ON cn.imdb_id = mi_idx.movie_id JOIN char_name AS chn ON chn.imdb_id = mi_idx.movie_id WHERE mi_idx.info_type_id = 101 AND mw.keyword_id IN (918, 3849, 3998, 3575) AND cn.name_pcode_sf IN ('L1242', 'S5261', 'G6425', 'S621', 'A5356', 'W132') AND chn.name_pcode_nf IN ('H61', 'M5316', 'D36', 'D1363') GROUP BY cn.country_code ORDER BY average_movie_rating DESC;
SELECT COUNT(DISTINCT ci.person_id) AS total_actors, AVG(ci.nr_order) AS average_cast_order, SUM(CASE WHEN lt.link = 'features' THEN 1 ELSE 0 END) AS total_features_links, c.name AS company_name, c.country_code AS company_country, MIN(m.info) AS movie_info FROM cast_info ci JOIN complete_cast cc ON ci.movie_id = cc.movie_id JOIN company_name c ON cc.movie_id = c.imdb_id JOIN link_type lt ON cc.subject_id = lt.id JOIN movie_info m ON ci.movie_id = m.movie_id WHERE m.info_type_id = '4' AND ci.note LIKE '%(segment "Laman")%' AND ci.person_id IN ('1523', '1842', '1395', '1462', '1527', '1496') AND cc.id IN ('3566', '4902', '2721') AND cc.movie_id IN ('1683114', '1664432') AND lt.id IN ('9', '16', '1', '7', '6', '18') AND lt.link IN ('features', 'follows') GROUP BY c.name, c.country_code;
SELECT it.info AS information_type, COUNT(DISTINCT cc.movie_id) AS number_of_movies, COUNT(DISTINCT cc.subject_id) AS number_of_subjects, SUM(CASE WHEN cc.status_id = 3 THEN 1 ELSE 0 END) AS status_3_count, AVG(mii.info_type_id) AS average_info_type_id FROM complete_cast cc JOIN movie_info_idx mii ON cc.movie_id = mii.movie_id JOIN info_type it ON mii.info_type_id = it.id GROUP BY it.info ORDER BY number_of_movies DESC, number_of_subjects DESC;
SELECT nt.info AS movie_genre, COUNT(DISTINCT cn.id) AS num_of_actors, AVG((n.gender = 'M')::int) AS avg_male_actors, AVG((n.gender = 'F')::int) AS avg_female_actors, SUM(CASE WHEN cn.id IN ('75924', '37156', '79891', '61423', '79360') THEN 1 ELSE 0 END) AS special_char_count, cname.name AS frequent_production_company, MAX(mi_idx.info) AS longest_movie_description FROM char_name cn JOIN name n ON cn.id = n.id JOIN movie_info_idx mi_idx ON n.id = mi_idx.movie_id JOIN info_type nt ON mi_idx.info_type_id = nt.id JOIN movie_companies mc ON mi_idx.movie_id = mc.movie_id JOIN company_name cname ON mc.company_id = cname.id WHERE n.md5sum IN ('5867f236efd2a49e525e28170e53884f', 'e30d31437d0cc24a549ebe11e068d91c', '103b12a2a1f067552d1582f217894732', '937aa89fd20c81ec429381d29296632e', 'b19e28f6480e3653f20f36528b67ddfd', 'ee97cefd84759ed4ec46f94d2e8962ed') AND cname.name IN ('Jamtown Films', 'Ovie Entertainment', 'Canibal Friends', 'Rocket Sheep Boom', 'Yarnmaker', 'Toko-Tokuma') AND nt.info IN ('LD dialogue intellegibility', 'book', 'tech info') GROUP BY nt.info, cname.name ORDER BY num_of_actors DESC, avg_male_actors DESC;
SELECT kt.kind AS content_type, COUNT(DISTINCT chn.id) AS unique_characters, AVG(comp_cast_type.id) AS average_comp_cast_type_id, COUNT(DISTINCT company_type.id) AS number_of_company_types FROM char_name AS chn JOIN kind_type AS kt ON chn.id = kt.id JOIN comp_cast_type ON chn.id = comp_cast_type.id JOIN company_type ON chn.id = company_type.id WHERE kt.kind IN ('tv movie', 'tv series', 'video game', 'movie', 'episode', 'video movie') AND company_type.kind IN ('special effects companies', 'miscellaneous companies', 'production companies', 'distributors') GROUP BY kt.kind ORDER BY unique_characters DESC, average_comp_cast_type_id;
SELECT t.production_year, COUNT(DISTINCT t.id) AS number_of_movies, COUNT(DISTINCT ci.person_id) AS number_of_actors, AVG(ci.nr_order) AS average_cast_order, SUM(CASE WHEN lt.link = 'follows' THEN 1 ELSE 0 END) AS number_of_sequels, SUM(CASE WHEN lt.link = 'spoofed in' THEN 1 ELSE 0 END) AS number_of_spoofs FROM title t JOIN cast_info ci ON t.id = ci.movie_id JOIN movie_keyword mk ON t.id = mk.movie_id JOIN keyword k ON mk.keyword_id = k.id LEFT JOIN movie_companies mc ON t.id = mc.movie_id LEFT JOIN link_type lt ON lt.id = mc.company_type_id WHERE t.production_year BETWEEN 2000 AND 2010 AND k.phonetic_code IN ('U6523', 'W46', 'S3123', 'L3416', 'A3435', 'P4252') AND ci.role_id = 1 GROUP BY t.production_year ORDER BY t.production_year;
SELECT kt.kind AS movie_kind, avg(title.production_year) AS average_production_year, count(DISTINCT title.id) AS number_of_titles, count(DISTINCT cast_info.person_id) AS number_of_participants, count(DISTINCT movie_keyword.keyword_id) AS number_of_unique_keywords, sum(case when role_type.role = 'actor' then 1 else 0 end) AS number_of_actors, sum(case when role_type.role = 'actress' then 1 else 0 end) AS number_of_actresses FROM title JOIN kind_type AS kt ON title.kind_id = kt.id LEFT JOIN cast_info ON title.id = cast_info.movie_id LEFT JOIN role_type ON cast_info.role_id = role_type.id LEFT JOIN movie_keyword ON title.id = movie_keyword.movie_id WHERE kt.kind IN ('video movie', 'video game') AND title.production_year BETWEEN 2000 AND 2020 GROUP BY kt.kind;
SELECT AVG(CAST(mi.info AS NUMERIC)) AS average_budget, COUNT(DISTINCT at.id) AS number_of_movies, kt.kind AS movie_kind, COUNT(DISTINCT cn.id) AS number_of_companies_involved, SUM(CASE WHEN mi_idx.info_type_id = 3 THEN 1 ELSE 0 END) AS count_of_trivia_info, MAX(at.production_year) AS latest_movie_year FROM movie_info mi INNER JOIN kind_type kt ON kt.id = mi.info_type_id INNER JOIN aka_title at ON at.movie_id = mi.movie_id INNER JOIN movie_info_idx mi_idx ON mi_idx.movie_id = mi.movie_id LEFT JOIN movie_companies mc ON mc.movie_id = mi.movie_id LEFT JOIN comp_cast_type cct ON cct.id = mc.company_type_id LEFT JOIN char_name cn ON cn.id = mc.company_id WHERE mi.info_type_id = 1 AND kt.kind IN ('movie', 'tv series') AND at.production_year BETWEEN 2000 AND 2022 AND mi_idx.info_type_id IN (2, 3) AND cct.kind IN ('complete', 'complete+verified') GROUP BY kt.kind ORDER BY average_budget DESC;
SELECT kt.kind AS movie_kind, AVG(at.production_year) AS average_production_year, COUNT(DISTINCT at.movie_id) AS total_movies, COUNT(DISTINCT mk.keyword_id) AS distinct_keywords FROM aka_title at INNER JOIN kind_type kt ON at.kind_id = kt.id LEFT JOIN movie_keyword mk ON at.movie_id = mk.movie_id GROUP BY kt.kind ORDER BY total_movies DESC, average_production_year DESC;
SELECT kt.kind AS movie_type, COUNT(DISTINCT ci.movie_id) AS movie_count, AVG(ci.nr_order) AS average_order_of_appearance, COUNT(DISTINCT pi.person_id) AS distinct_actors_count, SUM(CASE WHEN ci.role_id = 1 THEN 1 ELSE 0 END) AS total_lead_roles FROM cast_info ci JOIN kind_type kt ON ci.role_id = kt.id LEFT JOIN person_info pi ON ci.person_id = pi.person_id WHERE ci.person_role_id IN (1344, 1214) GROUP BY kt.kind ORDER BY movie_count DESC;
SELECT COUNT(DISTINCT ml.movie_id) AS NumberOfMovies, COUNT(DISTINCT ml.linked_movie_id) AS NumberOfLinkedMovies, AVG(n.imdb_id) AS AverageIMDbID, SUM(CASE WHEN cc.status_id = 3 THEN 1 ELSE 0 END) AS Status3Count, SUM(CASE WHEN cc.status_id = 4 THEN 1 ELSE 0 END) AS Status4Count FROM movie_link AS ml JOIN complete_cast AS cc ON cc.movie_id = ml.movie_id JOIN name AS n ON n.id = cc.subject_id WHERE cc.status_id IN (3, 4) GROUP BY cc.subject_id;
SELECT COUNT(DISTINCT at.id) AS total_alternate_titles, COUNT(DISTINCT ci.id) AS total_cast_members, AVG(at.production_year) AS average_production_year, SUM(mc.company_id) AS total_companies_involved, COUNT(DISTINCT cc.id) AS total_complete_casts, STRING_AGG(DISTINCT lt.LINK, '; ') AS link_types_used FROM aka_title AS at JOIN cast_info AS ci ON at.movie_id = ci.movie_id JOIN movie_companies AS mc ON at.movie_id = mc.movie_id JOIN complete_cast AS cc ON at.movie_id = cc.movie_id JOIN link_type AS lt ON cc.status_id = lt.id WHERE at.production_year > 2000 AND ci.note IS NOT NULL AND cc.id IN ('2731', '2678', '7', '3665') AND at.season_nr IN (8, 4, 11, 22) AND at.md5sum IN ('ae1ec4b6524d40f203cb722b6e74c9d6', '51978b45ff1151ec3cc873180401b93c') GROUP BY at.kind_id ORDER BY total_alternate_titles DESC, average_production_year;
SELECT cn.name AS character_name, COUNT(DISTINCT cl.movie_id) AS total_linked_movies, COUNT(ci.person_id) AS total_roles_played, AVG(ci.nr_order) AS average_role_order FROM char_name AS cn JOIN cast_info AS ci ON cn.id = ci.person_id JOIN movie_link AS cl ON ci.movie_id = cl.movie_id WHERE cn.name IN ('Boy Negro''s Gang', 'Lazoglu', 'Paco Hernández Gil', 'Tedddy Hart', 'Funcionario prisión', 'Make Up Man') GROUP BY cn.name ORDER BY total_linked_movies DESC, total_roles_played DESC;
