SELECT kt.kind AS movie_type, COUNT(DISTINCT ci.movie_id) AS total_movies, AVG(CAST(mi.info AS INTEGER)) AS average_movie_length, SUM(CASE WHEN cn.country_code = '[us]' THEN 1 ELSE 0 END) AS us_based_companies, COUNT(DISTINCT pi.person_id) AS total_actors FROM cast_info ci JOIN kind_type kt ON ci.role_id = kt.id JOIN movie_info mi ON ci.movie_id = mi.movie_id AND mi.info_type_id = (SELECT id FROM info_type WHERE info = 'runtime') LEFT JOIN movie_companies mc ON ci.movie_id = mc.movie_id LEFT JOIN company_name cn ON mc.company_id = cn.id LEFT JOIN person_info pi ON ci.person_id = pi.person_id AND pi.info_type_id = (SELECT id FROM info_type WHERE info = 'actor') GROUP BY kt.kind HAVING COUNT(DISTINCT ci.movie_id) > 10 ORDER BY total_movies DESC;
SELECT COUNT(DISTINCT n.id) AS total_actors, AVG(t.production_year) AS average_production_year, SUM(CASE WHEN n.gender = 'F' THEN 1 ELSE 0 END) AS female_actors_count, SUM(CASE WHEN n.gender = 'M' THEN 1 ELSE 0 END) AS male_actors_count, COUNT(DISTINCT t.id) AS total_titles, MAX(t.production_year) AS latest_production_year, MIN(t.production_year) AS earliest_production_year, COUNT(DISTINCT k.id) AS total_keywords, t.series_years, n.surname_pcode FROM name AS n INNER JOIN title AS t ON n.id = t.id LEFT JOIN keyword AS k ON k.id = t.id WHERE n.surname_pcode IN ('A424', 'A414') AND t.series_years LIKE '1993-____' AND (k.id = '74' OR k.id = '8451') GROUP BY t.series_years, n.surname_pcode ORDER BY total_actors DESC, average_production_year DESC;
SELECT it.info AS info_category, COUNT(DISTINCT mk.movie_id) AS number_of_movies, COUNT(mk.keyword_id) AS total_keyword_mentions, AVG(sub_query.avg_keyword_per_movie) AS average_keywords_per_movie FROM movie_keyword AS mk INNER JOIN keyword AS k ON mk.keyword_id = k.id INNER JOIN info_type AS it ON it.id = ANY(ARRAY[107, 103, 84, 8, 113]) LEFT JOIN (SELECT movie_id, AVG(keyword_count) AS avg_keyword_per_movie FROM (SELECT mk.movie_id, COUNT(mk.keyword_id) AS keyword_count FROM movie_keyword AS mk GROUP BY mk.movie_id) AS sub_query_1 GROUP BY movie_id) AS sub_query ON mk.movie_id = sub_query.movie_id WHERE mk.id IN (1632, 3030, 4546, 1918, 3771, 1414) AND mk.movie_id IN (15503, 12271, 9141) GROUP BY it.info;
SELECT AVG(a.production_year) AS average_production_year, COUNT(DISTINCT c.id) AS total_unique_casts, SUM(CASE WHEN l.id IN (7, 8) THEN 1 ELSE 0 END) AS total_edited_or_spin_off_links, COUNT(DISTINCT cn.id) AS total_unique_characters, COUNT(*) AS total_titles FROM aka_title AS a JOIN complete_cast AS c ON a.movie_id = c.movie_id JOIN char_name AS cn ON cn.id = ANY(ARRAY[54785, 4119, 86783, 28862]) JOIN link_type AS l ON l.id = ANY(ARRAY[7, 8, 6, 3]) WHERE a.production_year IS NOT NULL AND c.status_id IN (3, 4) AND a.episode_of_id IS NOT NULL AND a.episode_of_id IN (15984, 4570, 5164, 247, 20256, 15791) AND l.link IN ('edited from', 'spin off') GROUP BY c.subject_id;
SELECT kt.kind as movie_kind, AVG(akat.production_year) as average_production_year, COUNT(DISTINCT akat.movie_id) as number_of_movies, SUM(CASE WHEN akat.episode_of_id IS NOT NULL THEN 1 ELSE 0 END) as number_of_episodes, COUNT(DISTINCT cn.id) as number_of_characters, COUNT(DISTINCT cct.id) as number_of_cast_types FROM aka_title akat JOIN kind_type kt ON akat.kind_id = kt.id JOIN char_name cn ON akat.movie_id = cn.imdb_id JOIN comp_cast_type cct ON akat.id = cct.id WHERE kt.kind = 'movie' AND akat.production_year BETWEEN 2000 AND 2010 AND akat.season_nr IN (6, 27, 1) AND akat.episode_of_id IN (23513, 23963, 12924, 12200, 8336) GROUP BY kt.kind;
SELECT COUNT(DISTINCT mk.movie_id) AS num_movies_with_keywords, AVG(CAST(mi.info AS INTEGER)) AS average_movie_length, COUNT(DISTINCT ml.movie_id) AS num_movies_with_links, COUNT(DISTINCT cc.movie_id) AS num_movies_with_complete_cast, STRING_AGG(DISTINCT k.keyword, ', ') AS sample_keywords FROM movie_keyword AS mk INNER JOIN keyword AS k ON mk.keyword_id = k.id INNER JOIN movie_info_idx AS mi ON mk.movie_id = mi.movie_id INNER JOIN movie_link AS ml ON mk.movie_id = ml.movie_id INNER JOIN complete_cast AS cc ON mk.movie_id = cc.movie_id WHERE mi.info_type_id = 3 AND ml.link_type_id IN (1, 2, 3) AND cc.status_id IN (1, 2) GROUP BY mi.info_type_id;
SELECT t.production_year, COUNT(DISTINCT t.id) AS total_titles, AVG(t.production_year) AS avg_production_year, SUM(CASE WHEN k.keyword = 'medical-emergency' THEN 1 ELSE 0 END) AS count_medical_emergency, COUNT(DISTINCT cc.movie_id) AS total_movies_with_complete_cast, COUNT(DISTINCT char_name.name) AS total_character_names FROM title AS t LEFT JOIN keyword AS k ON t.phonetic_code = k.phonetic_code LEFT JOIN complete_cast AS cc ON t.id = cc.movie_id LEFT JOIN char_name ON char_name.surname_pcode = t.md5sum WHERE t.production_year BETWEEN 1990 AND 2000 AND cc.status_id IN (3, 4) AND (k.keyword = 'audi-rs5' OR k.keyword = 'second-chance' OR k.keyword = 'little-boy') GROUP BY t.production_year ORDER BY total_titles DESC;
SELECT ct.kind AS company_kind, COUNT(DISTINCT mi.movie_id) AS number_of_movies, AVG(nm.imdb_id) AS average_imdb_id, SUM(CASE WHEN nm.gender = 'f' THEN 1 ELSE 0 END) AS female_count, SUM(CASE WHEN nm.gender = 'm' THEN 1 ELSE 0 END) AS male_count FROM company_type ct JOIN movie_info mi ON ct.id = mi.info_type_id JOIN name nm ON mi.movie_id = nm.id WHERE ct.kind IN ('special effects companies', 'distributors', 'production companies') GROUP BY ct.kind ORDER BY number_of_movies DESC;
SELECT AVG(t.production_year) AS average_production_year, COUNT(DISTINCT mk.keyword_id) AS number_of_unique_keywords, COUNT(DISTINCT at.id) AS number_of_alternative_titles, rt.ROLE, COUNT(*) AS total_movies_by_role_type FROM title AS t JOIN movie_keyword AS mk ON mk.movie_id = t.id JOIN aka_title AS at ON at.movie_id = t.id JOIN role_type AS rt ON rt.id = at.kind_id WHERE t.production_year BETWEEN 1990 AND 2000 AND rt.id IN ('5', '4', '6') AND t.imdb_index IN ('V', 'I', 'II') GROUP BY rt.ROLE ORDER BY total_movies_by_role_type DESC;
SELECT cn.name AS company_name, COUNT(DISTINCT mi_idx.movie_id) AS number_of_movies, AVG(CAST(mi_idx.info AS NUMERIC)) AS average_runtime, SUM(CASE WHEN it.info = 'locations' THEN 1 ELSE 0 END) AS total_locations, COUNT(DISTINCT mk.keyword_id) AS unique_keywords, COUNT(DISTINCT cc.movie_id) AS complete_cast_movies FROM movie_info_idx AS mi_idx JOIN info_type AS it ON mi_idx.info_type_id = it.id JOIN movie_keyword AS mk ON mi_idx.movie_id = mk.movie_id JOIN complete_cast AS cc ON mi_idx.movie_id = cc.movie_id JOIN company_name AS cn ON cn.imdb_id = mi_idx.movie_id WHERE it.info IN ('runtimes', 'locations') AND cn.name_pcode_nf = 'G2642' GROUP BY cn.name ORDER BY average_runtime DESC, number_of_movies DESC;
SELECT c.name AS company_name, c.country_code, rt.ROLE, COUNT(DISTINCT t.id) AS number_of_titles, AVG(t.production_year) AS average_production_year, SUM(CASE WHEN mi.info_type_id = 1 THEN 1 ELSE 0 END) AS number_of_genres_assigned, COUNT(DISTINCT mi.info) AS unique_movie_info_entries FROM company_name AS c JOIN title AS t ON c.imdb_id = t.imdb_id JOIN movie_info AS mi ON t.id = mi.movie_id JOIN role_type AS rt ON rt.id = mi.info_type_id WHERE rt.ROLE IN ('composer', 'guest', 'production designer') AND t.production_year BETWEEN 2000 AND 2023 AND c.country_code = 'US' GROUP BY c.name, c.country_code, rt.ROLE ORDER BY number_of_titles DESC, average_production_year DESC;
SELECT COUNT(DISTINCT ci.id) AS total_cast_members, AVG(ci.nr_order) AS average_cast_order, COUNT(DISTINCT mk.id) AS total_movie_keywords, MAX(t.production_year) AS latest_production_year, MIN(t.production_year) AS earliest_production_year, AVG(t.production_year) AS average_production_year, COUNT(DISTINCT mi.id) AS total_movie_info_records, ct.kind AS company_kind, COUNT(DISTINCT n.id) AS total_people FROM cast_info ci JOIN movie_keyword mk ON ci.movie_id = mk.movie_id JOIN title t ON ci.movie_id = t.id JOIN movie_info mi ON mi.movie_id = t.id JOIN company_type ct ON ct.id = mi.info_type_id JOIN name n ON n.id = ci.person_id WHERE ci.role_id = 1 AND ct.kind IN ('special effects companies', 'miscellaneous companies', 'production companies', 'distributors') AND ci.nr_order IN (36, 47, 23, 39) AND mk.movie_id IN (14906, 12662, 17516, 17625) GROUP BY ct.kind ORDER BY total_movie_keywords DESC;
SELECT t.production_year, kt.kind, AVG(LENGTH(t.title)) AS average_title_length, COUNT(DISTINCT t.id) AS total_movies, COUNT(DISTINCT mc.company_id) AS total_companies_involved FROM title AS t JOIN kind_type AS kt ON t.kind_id = kt.id JOIN movie_companies AS mc ON t.id = mc.movie_id WHERE t.production_year IS NOT NULL AND kt.kind IS NOT NULL GROUP BY t.production_year, kt.kind ORDER BY t.production_year DESC, kt.kind;
SELECT AVG(CAST(mi.info AS FLOAT)) AS average_rating, COUNT(DISTINCT mc.movie_id) AS number_of_movies, cn.name AS company_name, rt.ROLE AS role_type, COUNT(DISTINCT ci.person_id) AS number_of_actors FROM movie_companies AS mc JOIN company_name AS cn ON mc.company_id = cn.id JOIN movie_info AS mi ON mc.movie_id = mi.movie_id AND mi.info_type_id = 101 JOIN cast_info AS ci ON mc.movie_id = ci.movie_id JOIN role_type AS rt ON ci.role_id = rt.id WHERE cn.name_pcode_nf IN ('C5342', 'A6514', 'W6321', 'S2', 'M1653', 'A3532') AND mc.company_id IN ('1199', '263', '157', '78') AND mi.id IN ('7268010', '7269101', '7266891', '7268390', '7270852', '7269590') GROUP BY cn.name, rt.ROLE ORDER BY average_rating DESC, number_of_movies DESC, number_of_actors DESC;
SELECT kt.kind AS movie_kind, COUNT(DISTINCT ci.movie_id) AS num_movies, COUNT(DISTINCT ci.person_id) AS num_people, AVG(ci.nr_order) AS avg_cast_order, SUM(CASE WHEN n.gender = 'f' THEN 1 ELSE 0 END) AS female_actors_count, SUM(CASE WHEN n.gender = 'm' THEN 1 ELSE 0 END) AS male_actors_count, COUNT(DISTINCT k.id) AS num_keywords, count(DISTINCT cc.id) AS num_complete_cast_records FROM cast_info ci JOIN kind_type kt ON ci.role_id = kt.id JOIN name n ON ci.person_id = n.id LEFT JOIN keyword k ON ci.movie_id = k.id LEFT JOIN complete_cast cc ON ci.movie_id = cc.movie_id WHERE n.surname_pcode IN ('A415', 'A435') GROUP BY kt.kind ORDER BY num_movies DESC;
SELECT it.info AS info_category, COUNT(DISTINCT mi.movie_id) AS total_movies, AVG(CASE WHEN n.gender = 'm' THEN 1.0 ELSE NULL END) AS avg_male_involvement, AVG(CASE WHEN n.gender = 'f' THEN 1.0 ELSE NULL END) AS avg_female_involvement, COUNT(DISTINCT an.person_id) AS unique_aka_names, SUM(CASE WHEN mi.info_type_id = 4 THEN 1 ELSE 0 END) AS count_info_type_4 FROM movie_info mi INNER JOIN info_type it ON mi.info_type_id = it.id LEFT JOIN aka_name an ON an.person_id = mi.movie_id LEFT JOIN name n ON n.id = mi.movie_id WHERE mi.info LIKE '%Mandarin%' OR mi.info_type_id IN ('47', '5', '7') OR n.surname_pcode IN ('A432', 'A416', 'A414') OR n.imdb_index IN ('VI', 'XVII', 'XIV', 'I') GROUP BY it.info;
SELECT kt.kind AS movie_kind, COUNT(DISTINCT ci.movie_id) AS number_of_movies, COUNT(DISTINCT ci.person_id) AS number_of_actors, AVG(ci.nr_order) AS average_cast_position, SUM(CASE WHEN ci.role_id = 1 THEN 1 ELSE 0 END) AS number_of_lead_roles FROM cast_info ci JOIN kind_type kt ON ci.role_id = kt.id JOIN char_name cn ON ci.person_role_id = cn.id WHERE ci.person_id IN (1097, 1215) AND ci.role_id = 1 AND kt.id = 7 GROUP BY kt.kind;
