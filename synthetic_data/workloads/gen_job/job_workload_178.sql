SELECT kt.kind AS movie_kind, avg(title.production_year) AS average_production_year, count(DISTINCT title.id) AS number_of_titles, count(DISTINCT cast_info.person_id) AS number_of_participants, count(DISTINCT movie_keyword.keyword_id) AS number_of_unique_keywords, sum(case when role_type.role = 'actor' then 1 else 0 end) AS number_of_actors, sum(case when role_type.role = 'actress' then 1 else 0 end) AS number_of_actresses FROM title JOIN kind_type AS kt ON title.kind_id = kt.id LEFT JOIN cast_info ON title.id = cast_info.movie_id LEFT JOIN role_type ON cast_info.role_id = role_type.id LEFT JOIN movie_keyword ON title.id = movie_keyword.movie_id WHERE kt.kind IN ('video movie', 'video game') AND title.production_year BETWEEN 2000 AND 2020 GROUP BY kt.kind;
SELECT kt.kind AS movie_type, COUNT(DISTINCT mk.movie_id) AS num_movies, AVG(cn.imdb_id::NUMERIC) AS average_imdb_id, SUM(CASE WHEN cn.country_code = 'us' THEN 1 ELSE 0 END) AS num_us_companies, COUNT(DISTINCT cn.id) AS num_companies_involved FROM movie_keyword AS mk JOIN movie_info AS mi ON mk.movie_id = mi.movie_id JOIN kind_type AS kt ON mi.info_type_id = kt.id AND kt.id IN ('2', '3', '4', '5', '6') JOIN company_name AS cn ON mk.movie_id = cn.imdb_id WHERE (mk.keyword_id IN ('3195', '2832', '4019', '2965', '3002') OR mi.info IN ('Albanian', 'Norwegian', 'Ladino', 'Filipino', 'Estonian')) AND cn.name_pcode_nf IN ('R5365', 'C514', 'E5314', 'L532') AND cn.id IN ('23278', '44380', '28077', '6858', '43412', '27250') GROUP BY kt.kind;
SELECT kt.kind, AVG(mi_idx_nr_count.count) AS average_number_of_facts, SUM(cast_member_count.count) AS total_cast_members, COUNT(DISTINCT ci.movie_id) AS number_of_movies, COUNT(DISTINCT n.id) AS number_of_actors FROM kind_type kt LEFT JOIN ( SELECT movie_id, COUNT(*) AS count FROM movie_info_idx GROUP BY movie_id ) mi_idx_nr_count ON mi_idx_nr_count.movie_id = kt.id LEFT JOIN ( SELECT movie_id, COUNT(*) AS count FROM cast_info GROUP BY movie_id ) cast_member_count ON cast_member_count.movie_id = kt.id LEFT JOIN cast_info ci ON ci.movie_id = kt.id LEFT JOIN name n ON n.id = ci.person_id WHERE kt.kind IN ('tv series', 'video game', 'episode', 'tv mini series', 'video movie') AND ci.nr_order IN (41, 43, 49, 3) GROUP BY kt.kind ORDER BY average_number_of_facts DESC;
SELECT ct.kind AS company_type, COUNT(DISTINCT t.id) AS number_of_titles, AVG(t.production_year) AS average_production_year, SUM(CASE WHEN t.kind_id = 1 THEN 1 ELSE 0 END) AS number_of_movies, SUM(CASE WHEN t.kind_id = 2 THEN 1 ELSE 0 END) AS number_of_tv_shows, COUNT(DISTINCT mk.keyword_id) AS unique_keywords, MAX(t.episode_nr) AS highest_episode_number FROM company_type AS ct JOIN movie_keyword AS mk ON mk.id IN (736, 2675) JOIN title AS t ON mk.movie_id = t.id WHERE t.md5sum IN ('744ccb1f3edd96cf5612c32621c4791d', '0dc255a0af1364d1a6e0083ec4231290', '468bba8c2823f5f827c055c2915eab8d', 'cfc401143a32c532fb68d85bc9f69635', '70d7d2f9c169c31ae459fa8daa188539') AND t.episode_nr IN (10516, 95, 120, 103, 30, 151) AND ct.kind IN ('special effects companies', 'miscellaneous companies', 'production companies', 'distributors') GROUP BY ct.kind ORDER BY number_of_titles DESC;
SELECT kt.kind AS movie_type, COUNT(DISTINCT cn.id) AS total_actors, AVG(mi.info::NUMERIC) AS average_rating, SUM(CASE WHEN cn.name LIKE 'A%' THEN 1 ELSE 0 END) AS actors_with_A, COUNT(DISTINCT comp.id) AS total_companies_involved, COUNT(DISTINCT kw.id) AS total_keywords_used FROM movie_info mi JOIN info_type it ON mi.info_type_id = it.id JOIN kind_type kt ON it.id = kt.id JOIN char_name cn ON cn.id = mi.movie_id JOIN company_name comp ON comp.imdb_id = mi.movie_id JOIN keyword kw ON kw.id = mi.movie_id WHERE it.id IN (107, 78, 62, 5, 113, 20) AND comp.name IN ('Alex Wolf & Eugen IllÃ©s', 'Total Film Home Entertainment', 'Pablo Distribuzione') AND comp.md5sum IN ('e4f3cb7948efaa2189b8433a5d0c2e5c', '7ca5629b21d0a13cc0a01264df7fa8e5') AND mi.info_type_id = it.id AND mi.info ~ '^\d+(\.\d+)?$' GROUP BY kt.kind;
SELECT AVG(CAST(mi_idx.info AS numeric)) AS average_rating, COUNT(DISTINCT a_t.movie_id) AS num_movies, COUNT(DISTINCT c_c.movie_id) AS num_complete_cast_movies, COUNT(DISTINCT p_i.person_id) AS num_persons_info, SUM(CASE WHEN a_t.production_year >= 2000 THEN 1 ELSE 0 END) AS num_movies_since_2000 FROM movie_info_idx mi_idx JOIN aka_title a_t ON mi_idx.movie_id = a_t.movie_id JOIN complete_cast c_c ON a_t.movie_id = c_c.movie_id JOIN person_info p_i ON p_i.person_id = ANY(ARRAY[1739786, 3545, 2362, 3631, 1719, 1739809]) WHERE mi_idx.info_type_id = (SELECT id FROM info_type WHERE info = 'rating') AND a_t.kind_id = 1 AND a_t.production_year IS NOT NULL GROUP BY a_t.kind_id;
SELECT kt.kind AS movie_genre, AVG(mi_idx.note::int) AS average_rating, COUNT(DISTINCT k.id) AS unique_keywords, SUM(CASE WHEN cct.kind = 'complete' THEN 1 ELSE 0 END) AS complete_cast_movies, SUM(CASE WHEN cct.kind = 'complete+verified' THEN 1 ELSE 0 END) AS verified_cast_movies FROM movie_info_idx mi_idx JOIN movie_link ml ON mi_idx.movie_id = ml.movie_id JOIN keyword k ON ml.link_type_id = k.id JOIN kind_type kt ON mi_idx.info_type_id = kt.id JOIN complete_cast cc ON mi_idx.movie_id = cc.movie_id JOIN comp_cast_type cct ON cc.status_id = cct.id WHERE kt.kind IN ('drama', 'comedy', 'action') AND mi_idx.info LIKE '%rating%' AND k.keyword IN ('epic', 'cult', 'thriller', 'romance') GROUP BY kt.kind ORDER BY average_rating DESC;
SELECT kt.kind AS movie_type, COUNT(DISTINCT mi.movie_id) AS total_movies, AVG(CAST(mi_idx.info AS FLOAT)) AS average_rating, SUM(CASE WHEN k.keyword = 'disco-ball' THEN 1 ELSE 0 END) AS disco_ball_keyword_count, SUM(CASE WHEN k.keyword = 'bandana' THEN 1 ELSE 0 END) AS bandana_keyword_count, STRING_AGG(DISTINCT ct.kind, ', ') AS involved_company_types FROM movie_info mi JOIN movie_info_idx mi_idx ON mi.movie_id = mi_idx.movie_id AND mi.info_type_id = mi_idx.info_type_id JOIN kind_type kt ON kt.id = mi.info_type_id JOIN movie_info mii ON mii.movie_id = mi.movie_id JOIN link_type lt ON lt.id = mi_idx.id JOIN keyword k ON k.id = mi_idx.id JOIN company_type ct ON ct.id = mi_idx.id WHERE mi.id IN ('7268657', '7271065', '7267731') AND mi.movie_id IN ('924506', '925955', '929745', '938512', '930430') AND ct.kind IN ('special effects companies', 'miscellaneous companies', 'production companies', 'distributors') AND mi_idx.info SIMILAR TO '(%...[0-9]*[0-9].[0-9]*[0-9]%)' GROUP BY kt.kind;
SELECT kt.kind AS movie_kind, COUNT(DISTINCT mi.movie_id) AS movie_count, AVG(CAST(mi.info AS DOUBLE PRECISION)) AS average_info_value, SUM(CAST(mi.info AS DOUBLE PRECISION)) AS total_info_value, COUNT(DISTINCT cc.subject_id) AS unique_subject_count, cct.kind AS cast_type_kind FROM movie_info mi JOIN info_type it ON mi.info_type_id = it.id JOIN kind_type kt ON kt.id = mi.movie_id JOIN complete_cast cc ON cc.movie_id = mi.movie_id JOIN comp_cast_type cct ON cc.status_id = cct.id WHERE kt.id IN ('3', '4') AND it.info IN ('LD subtitles', 'LD audio quality') AND cct.id = '3' AND kt.kind IN ('video movie', 'video game', 'tv mini series', 'episode') AND cct.kind IN ('complete+verified', 'complete') GROUP BY kt.kind, cct.kind;
SELECT it.info AS info_type, COUNT(DISTINCT mk.movie_id) AS total_movies_with_keywords, COUNT(DISTINCT cc.movie_id) AS total_movies_with_complete_cast, AVG(cn.imdb_id) AS average_imdb_id, SUM(CASE WHEN cn.country_code = 'US' THEN 1 ELSE 0 END) AS total_us_companies FROM movie_keyword AS mk INNER JOIN complete_cast AS cc ON mk.movie_id = cc.movie_id INNER JOIN company_name AS cn ON cn.imdb_id = mk.movie_id INNER JOIN info_type AS it ON it.id = cc.subject_id WHERE mk.id IN (3843, 4798) AND mk.movie_id IN (8317, 10013, 9914, 7373) AND cn.md5sum IN ( '8d978787b0ec287764f214189bd27ccc', 'cd11f002bfac4110767acd038dad525d', 'f528d5021e84ca97756808ca01ec4605', '885492194dc62a66d0fb18ca950f6163', 'c2c967c278a15530e9f0d846e4f11a14' ) AND it.info IN ('LD analog left', 'quotes', 'admissions') GROUP BY it.info;
SELECT ct.kind AS company_type, AVG(t.production_year) AS average_production_year, COUNT(DISTINCT t.id) AS total_movies, COUNT(DISTINCT an.id) AS total_aka_names, COUNT(DISTINCT mi.id) AS total_movie_info, SUM(CASE WHEN lt.LINK = 'remade as' THEN 1 ELSE 0 END) AS total_remake_links FROM title t LEFT JOIN aka_name an ON t.id = an.person_id LEFT JOIN movie_info_idx mi ON t.id = mi.movie_id LEFT JOIN link_type lt ON mi.info_type_id = lt.id LEFT JOIN company_type ct ON t.kind_id = ct.id GROUP BY ct.kind ORDER BY total_movies DESC;
SELECT kt.kind AS movie_kind, COUNT(DISTINCT mc.movie_id) AS number_of_movies, AVG(mi_numeric.info::NUMERIC) AS average_budget, SUM(CASE WHEN mc.company_id = '1187' THEN 1 ELSE 0 END) AS movies_with_company_1187, SUM(CASE WHEN mc.company_id = '1024' THEN 1 ELSE 0 END) AS movies_with_company_1024, COUNT(DISTINCT ml.link_type_id) AS distinct_link_types FROM movie_companies AS mc JOIN movie_info AS mi ON mc.movie_id = mi.movie_id JOIN kind_type AS kt ON mi.info_type_id = kt.id LEFT JOIN movie_link AS ml ON mc.movie_id = ml.movie_id LEFT JOIN movie_info AS mi_numeric ON mc.movie_id = mi_numeric.movie_id AND mi_numeric.info_type_id = ( SELECT id FROM info_type WHERE info = 'budget' ) WHERE mc.company_id IN ('1187', '1024', '1009', '1239', '1034') AND mi.info_type_id IN ( SELECT id FROM info_type WHERE info = 'budget' ) AND mc.movie_id IN ('18864', '18945') GROUP BY kt.kind;
SELECT rt.ROLE, AVG(nk.count_keywords) AS average_keywords, COUNT(DISTINCT at.movie_id) AS number_of_movies, SUM(CASE WHEN at.production_year BETWEEN 2000 AND 2010 THEN 1 ELSE 0 END) AS movies_2000_to_2010, COUNT(DISTINCT n.id) AS number_of_names FROM role_type rt LEFT JOIN aka_title at ON rt.id = at.kind_id LEFT JOIN ( SELECT mk.movie_id, COUNT(mk.keyword_id) AS count_keywords FROM movie_keyword mk GROUP BY mk.movie_id ) nk ON nk.movie_id = at.movie_id LEFT JOIN name n ON n.id = at.movie_id WHERE rt.id IN (6, 7, 8) GROUP BY rt.ROLE ORDER BY average_keywords DESC;
SELECT kt.kind AS movie_type, COUNT(DISTINCT ci.movie_id) AS movie_count, AVG(ci.nr_order) AS average_order_of_appearance, COUNT(DISTINCT pi.person_id) AS distinct_actors_count, SUM(CASE WHEN ci.role_id = 1 THEN 1 ELSE 0 END) AS total_lead_roles FROM cast_info ci JOIN kind_type kt ON ci.role_id = kt.id LEFT JOIN person_info pi ON ci.person_id = pi.person_id WHERE ci.person_role_id IN (1344, 1214) GROUP BY kt.kind ORDER BY movie_count DESC;
SELECT lt.LINK AS link_type, COUNT(DISTINCT ml.movie_id) AS total_movies, AVG(ak.production_year) AS average_production_year, SUM(CASE WHEN ak.note LIKE '%(USA)%' THEN 1 ELSE 0 END) AS total_us_titles, COUNT(DISTINCT mk.keyword_id) AS distinct_keywords_used, COUNT(DISTINCT n.id) AS number_of_contributors FROM movie_link AS ml JOIN link_type AS lt ON ml.link_type_id = lt.id JOIN aka_title AS ak ON ml.movie_id = ak.movie_id JOIN movie_keyword AS mk ON ml.movie_id = mk.movie_id JOIN name AS n ON ak.id = n.id WHERE ak.title IS NOT NULL AND n.gender IN ('m', 'f') AND lt.id IN (3, 6) GROUP BY lt.LINK ORDER BY total_movies DESC;
SELECT k.keyword, AVG(at.production_year) AS avg_production_year, COUNT(DISTINCT at.movie_id) AS total_movies, COUNT(DISTINCT at.kind_id) AS different_kinds FROM keyword AS k JOIN movie_info AS mi ON mi.info LIKE '%' || k.keyword || '%' JOIN aka_title AS at ON at.movie_id = mi.movie_id WHERE k.keyword IN ('stewardess', 'lost-film', 'reality', 'honeymoon', 'murder-mystery') AND at.note LIKE '%lost film%' GROUP BY k.keyword;
SELECT ci.person_id, ci.role_id, COUNT(ci.movie_id) AS total_movies, AVG(ci.nr_order) AS avg_cast_position, COUNT(DISTINCT cc.movie_id) AS complete_cast_movies, COUNT(DISTINCT lt.id) AS unique_link_types FROM cast_info ci LEFT JOIN complete_cast cc ON ci.movie_id = cc.movie_id LEFT JOIN link_type lt ON ci.person_role_id = lt.id GROUP BY ci.person_id, ci.role_id ORDER BY total_movies DESC, avg_cast_position;
SELECT kt.kind AS movie_kind, COUNT(DISTINCT mc.movie_id) AS number_of_movies, AVG(CAST(mc.company_id AS NUMERIC)) AS average_company_id, SUM(kw.keyword_id) AS total_keyword_usage FROM kind_type kt JOIN movie_companies mc ON kt.id = mc.company_type_id JOIN movie_keyword kw ON mc.movie_id = kw.movie_id GROUP BY kt.kind ORDER BY number_of_movies DESC;
SELECT rt.role, AVG(akat.production_year) AS average_production_year, COUNT(DISTINCT akat.movie_id) AS total_movies, COUNT(DISTINCT cn.id) AS total_characters, SUM(CASE WHEN mk.keyword_id IS NOT NULL THEN 1 ELSE 0 END) AS movie_keyword_count, COUNT(DISTINCT pi.person_id) AS total_persons_with_info FROM role_type rt LEFT JOIN aka_title akat ON rt.id = akat.kind_id LEFT JOIN char_name cn ON cn.name = akat.title LEFT JOIN movie_keyword mk ON mk.movie_id = akat.movie_id LEFT JOIN person_info pi ON pi.info_type_id = rt.id WHERE akat.production_year > 2000 GROUP BY rt.role ORDER BY total_movies DESC, average_production_year DESC;
SELECT ct.kind AS company_type, AVG(mi_idx.info::numeric) AS average_rating, COUNT(DISTINCT cn.id) AS number_of_companies, COUNT(DISTINCT t.id) AS number_of_titles, SUM(CASE WHEN t.production_year >= 2000 THEN 1 ELSE 0 END) AS titles_since_2000 FROM company_name AS cn JOIN movie_companies AS mc ON cn.id = mc.company_id JOIN title AS t ON mc.movie_id = t.id JOIN movie_info_idx AS mi_idx ON t.id = mi_idx.movie_id JOIN company_type AS ct ON mc.company_type_id = ct.id JOIN info_type AS it ON mi_idx.info_type_id = it.id WHERE cn.name IN ('SalviNET SIA', 'IconNicholson', 'Globe TV') AND it.info = 'rating' AND ct.kind IN ('production companies', 'distributors') GROUP BY ct.kind;
SELECT ct.kind AS company_type, AVG(kw.id) AS average_keyword_id, COUNT(DISTINCT mc.movie_id) AS total_movies, SUM(mc.company_id) AS sum_company_id FROM movie_companies mc JOIN company_type ct ON mc.company_type_id = ct.id JOIN movie_link ml ON mc.movie_id = ml.movie_id JOIN keyword kw ON CAST(ml.link_type_id AS INTEGER) = kw.id JOIN name n ON mc.movie_id = n.id WHERE n.gender = 'm' AND kw.keyword IN ('Black Rick', 'Joel Gonzalez', 'TNI Soldier', 'ESPN', 'Newsroom Martian') GROUP BY ct.kind ORDER BY total_movies DESC, average_keyword_id;
SELECT mc.company_id, COUNT(DISTINCT cast_info_count.movie_id) AS total_movies, AVG(cast_info_count.nr_actors) AS average_actors_per_movie, SUM(kw_count.total_keywords) AS total_keywords, COUNT(DISTINCT ml.movie_id) FILTER (WHERE ml.link_type_id = 2) AS sequel_links, COUNT(DISTINCT ml.movie_id) FILTER (WHERE ml.link_type_id = 4) AS prequel_links FROM movie_companies mc LEFT JOIN (SELECT movie_id, COUNT(*) AS nr_actors FROM cast_info GROUP BY movie_id) cast_info_count ON mc.movie_id = cast_info_count.movie_id LEFT JOIN (SELECT movie_id, COUNT(*) AS total_keywords FROM movie_keyword GROUP BY movie_id) kw_count ON mc.movie_id = kw_count.movie_id LEFT JOIN movie_link ml ON mc.movie_id = ml.movie_id WHERE mc.company_id IN (753, 1127, 569) GROUP BY mc.company_id ORDER BY mc.company_id;
SELECT AVG(cast_roles.total_roles) AS average_roles_per_movie, COUNT(DISTINCT prod.movie_id) AS total_production_movies, COUNT(DISTINCT spec_eff.company_id) AS distinct_special_effects_companies FROM title t LEFT JOIN ( SELECT ci.movie_id, COUNT(ci.person_id) AS total_roles FROM cast_info ci GROUP BY ci.movie_id ) cast_roles ON cast_roles.movie_id = t.id LEFT JOIN ( SELECT mc.movie_id, mc.company_id FROM movie_companies mc INNER JOIN company_type ct ON mc.company_type_id = ct.id AND ct.kind = 'production companies' ) prod ON prod.movie_id = t.id LEFT JOIN ( SELECT mc.movie_id, mc.company_id FROM movie_companies mc INNER JOIN company_type ct ON mc.company_type_id = ct.id AND ct.kind = 'special effects companies' ) spec_eff ON spec_eff.movie_id = t.id WHERE t.production_year >= 2000 GROUP BY t.production_year;
SELECT rt.role AS role_type, COUNT(DISTINCT n.id) AS number_of_people, AVG(n.imdb_id) AS average_imdb_id, SUM(CASE WHEN n.gender = 'F' THEN 1 ELSE 0 END) AS female_count, SUM(CASE WHEN n.gender = 'M' THEN 1 ELSE 0 END) AS male_count, COUNT(DISTINCT k.id) AS unique_keywords_used, COUNT(DISTINCT mi.movie_id) AS movies_with_notes FROM name n INNER JOIN role_type rt ON n.id = rt.id INNER JOIN keyword k ON k.phonetic_code IN ('S56', 'S12', 'S1535', 'B4535', 'A25', 'O123') INNER JOIN movie_info mi ON mi.info_type_id = k.id WHERE mi.note IN ('(some dialogue)', '(English subtitles)', '(Original version)', '(English version)') AND n.name_pcode_nf IN ('C4145', 'T641', 'Q5354', 'G6342', 'E2541') AND rt.role IN ('editor', 'director', 'production designer', 'cinematographer', 'miscellaneous crew') AND n.name IN ('Amores, JoaquÃ­n', 'Amor, Miguel Ãngel', 'Anderson, Damion', 'Amokrane, Mustapha', 'Anderlik, Maddie', 'AndrÃ©, Emmanuel') GROUP BY rt.role;
SELECT kt.kind, COUNT(DISTINCT cn.id) AS num_companies, COUNT(DISTINCT mi.movie_id) AS num_movies, AVG(CAST(mi.info AS NUMERIC)) FILTER (WHERE it1.info = 'rating') AS avg_rating, SUM(CAST(mi.info AS NUMERIC)) FILTER (WHERE it1.info = 'budget') AS total_budget FROM kind_type AS kt JOIN movie_info AS mi ON mi.info_type_id = kt.id JOIN company_name AS cn ON cn.imdb_id = mi.movie_id JOIN movie_info AS it1 ON mi.movie_id = it1.movie_id AND it1.info_type_id = kt.id WHERE kt.id IN ('4', '5', '1') AND kt.kind IN ('episode', 'tv series', 'video game') AND mi.info_type_id IN (SELECT id FROM info_type WHERE info IN ('rating', 'budget')) GROUP BY kt.kind;
SELECT lt.LINK AS link_type, COUNT(DISTINCT ml.movie_id) AS number_of_movies, COUNT(DISTINCT ml.linked_movie_id) AS number_of_linked_movies, AVG(kw.id) AS average_keyword_id, MAX(n.name) AS most_common_name, SUM(CASE WHEN n.gender = 'm' THEN 1 ELSE 0 END) AS male_count, SUM(CASE WHEN n.gender <> 'm' THEN 1 ELSE 0 END) AS non_male_count FROM movie_link AS ml JOIN link_type AS lt ON ml.link_type_id = lt.id JOIN cast_info AS ci ON ml.movie_id = ci.movie_id JOIN keyword AS kw ON ci.id = kw.id JOIN name AS n ON ci.person_id = n.id GROUP BY lt.LINK ORDER BY number_of_movies DESC, number_of_linked_movies DESC;
