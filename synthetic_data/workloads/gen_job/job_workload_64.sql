SELECT cct.kind, COUNT(*) AS count_cast_types, AVG(cn.imdb_id) AS average_imdb_id, SUM(cn.imdb_id) AS sum_imdb_id, cn.country_code, COUNT(DISTINCT cn.name) AS distinct_company_names, COUNT(DISTINCT mi.movie_id) AS distinct_movies FROM comp_cast_type cct JOIN company_name cn ON cct.id = cn.id JOIN movie_info_idx mi ON cn.id = mi.info_type_id WHERE cn.country_code IN ('[cu]', '[se]', '[dk]', '[ar]', '[al]') AND cn.name_pcode_nf IN ('M2531', 'A6254', 'M6341', 'K3256') AND cct.kind IN ('complete+verified', 'cast', 'crew', 'complete') GROUP BY cct.kind, cn.country_code ORDER BY count_cast_types DESC;
SELECT cn.name AS company_name, ct.kind AS company_kind, COUNT(DISTINCT mc.movie_id) AS total_movies_produced, AVG(mk.keyword_count) AS average_keywords_per_movie, MAX(mi.info) AS most_common_language FROM company_name cn JOIN movie_companies mc ON mc.company_id = cn.id JOIN company_type ct ON mc.company_type_id = ct.id AND ct.kind IN ('production companies', 'special effects companies') JOIN (SELECT movie_id, COUNT(keyword_id) AS keyword_count FROM movie_keyword GROUP BY movie_id) mk ON mk.movie_id = mc.movie_id JOIN (SELECT movie_id, info FROM movie_info WHERE info_type_id = 4 AND info IN ('Slovak', 'Gujarati', 'Czech') ) mi ON mi.movie_id = mc.movie_id GROUP BY cn.name, ct.kind ORDER BY total_movies_produced DESC, average_keywords_per_movie DESC;
SELECT AVG(CAST(mi.info AS DOUBLE PRECISION)) AS average_budget, COUNT(DISTINCT ml.movie_id) AS total_linked_movies, COUNT(DISTINCT n.id) AS total_people_with_surname_code, SUM(CASE WHEN mi_idx.info LIKE '0.0%' THEN 1 ELSE 0 END) AS count_prefix_info FROM movie_info mi JOIN movie_info_idx mi_idx ON mi.movie_id = mi_idx.movie_id JOIN movie_link ml ON ml.movie_id = mi.movie_id JOIN name n ON n.surname_pcode = 'A465' WHERE mi.info_type_id = 3 AND mi_idx.info_type_id = 2 AND ml.link_type_id = 1 AND mi.note IS NOT NULL GROUP BY n.surname_pcode;
SELECT cct.kind AS cast_type, AVG(ci.nr_order) AS average_order, COUNT(DISTINCT ci.person_id) AS unique_actors, COUNT(DISTINCT t.id) AS movies_count, COUNT(DISTINCT k.id) AS unique_keywords, SUM(CASE WHEN t.production_year > 2000 THEN 1 ELSE 0 END) AS movies_after_2000 FROM cast_info ci JOIN comp_cast_type cct ON ci.role_id = cct.id JOIN title t ON ci.movie_id = t.id JOIN keyword k ON t.id = k.id WHERE cct.kind IN ('cast', 'crew') AND ci.person_id IN (1316, 1630, 1608, 1595) AND k.id IN (2472, 5355, 7118) GROUP BY cct.kind;
SELECT AVG(m.production_year) AS average_production_year, COUNT(DISTINCT mc.company_id) AS number_of_companies_involved, COUNT(DISTINCT k.id) AS number_of_unique_keywords, COUNT(DISTINCT n.id) AS number_of_persons FROM title AS m LEFT JOIN movie_companies AS mc ON mc.movie_id = m.id LEFT JOIN movie_info AS mi ON mi.movie_id = m.id AND mi.info_type_id = 6 LEFT JOIN keyword AS k ON k.id = mi.info_type_id LEFT JOIN name AS n ON n.id = mi.movie_id GROUP BY m.kind_id HAVING COUNT(DISTINCT mc.company_id) > 1 ORDER BY average_production_year DESC;
SELECT kt.kind AS movie_kind, COUNT(DISTINCT at.id) AS total_titles, COUNT(DISTINCT at.movie_id) AS unique_movies, AVG(at.production_year) AS avg_production_year, SUM(CASE WHEN lt.link = 'alternate language version of' THEN 1 ELSE 0 END) AS alt_lang_versions, SUM(CASE WHEN lt.link = 'version of' THEN 1 ELSE 0 END) AS versions, SUM(CASE WHEN lt.link = 'features' THEN 1 ELSE 0 END) AS features_count FROM aka_title at JOIN kind_type kt ON at.kind_id = kt.id JOIN movie_info_idx mii ON at.movie_id = mii.movie_id JOIN link_type lt ON mii.id = lt.id WHERE at.imdb_index = 'IV' AND at.episode_of_id IN ('11942', '6153', '1980', '7480', '8274') AND kt.kind IN ('tv series', 'video movie', 'video game', 'tv mini series') AND mii.info_type_id IN (SELECT id FROM info_type WHERE info LIKE '%0..11202%' OR info LIKE '.0..002212') GROUP BY kt.kind;
SELECT kt.kind, COUNT(DISTINCT ml.movie_id) AS total_movies, COUNT(DISTINCT ml.linked_movie_id) AS total_linked_movies, COUNT(DISTINCT cn.id) AS total_companies, AVG(pi.person_id) AS average_person_id, SUM(cc.subject_id) AS sum_subject_ids FROM movie_link AS ml JOIN kind_type AS kt ON ml.link_type_id = kt.id JOIN complete_cast AS cc ON ml.movie_id = cc.movie_id JOIN company_name AS cn ON cn.country_code NOT LIKE '%[pl]%' JOIN person_info AS pi ON pi.person_id = cc.subject_id WHERE kt.kind IN ('episode', 'movie', 'video movie', 'video game') AND cc.subject_id = '1' AND cn.name_pcode_sf IN ('J2316', 'F4131', 'N2314', 'S1526', 'D2346', 'J6123') GROUP BY kt.kind;
SELECT mc.company_id, COUNT(DISTINCT mc.movie_id) AS number_of_movies, cs.status_id, AVG(CAST(pi.info AS FLOAT)) FILTER (WHERE pi.info_type_id = 10) AS average_rating FROM movie_companies AS mc JOIN complete_cast AS cs ON mc.movie_id = cs.movie_id JOIN person_info AS pi ON cs.subject_id = pi.person_id GROUP BY mc.company_id, cs.status_id ORDER BY number_of_movies DESC, average_rating DESC;
SELECT COUNT(DISTINCT mk.movie_id) AS num_movies_with_keywords, AVG(CAST(mi.info AS INTEGER)) AS average_movie_length, COUNT(DISTINCT ml.movie_id) AS num_movies_with_links, COUNT(DISTINCT cc.movie_id) AS num_movies_with_complete_cast, STRING_AGG(DISTINCT k.keyword, ', ') AS sample_keywords FROM movie_keyword AS mk INNER JOIN keyword AS k ON mk.keyword_id = k.id INNER JOIN movie_info_idx AS mi ON mk.movie_id = mi.movie_id INNER JOIN movie_link AS ml ON mk.movie_id = ml.movie_id INNER JOIN complete_cast AS cc ON mk.movie_id = cc.movie_id WHERE mi.info_type_id = 3 AND ml.link_type_id IN (1, 2, 3) AND cc.status_id IN (1, 2) GROUP BY mi.info_type_id;
SELECT AVG(cast_count) AS average_cast_per_movie, AVG(link_count) AS average_links_per_movie, COUNT(DISTINCT mi.info_type_id) AS unique_info_types FROM (SELECT movie_id, COUNT(*) AS cast_count FROM cast_info WHERE note LIKE '%(Band)%' GROUP BY movie_id) AS cast_counts JOIN (SELECT movie_id, COUNT(*) AS link_count FROM movie_link WHERE link_type_id IN (6, 5, 11, 15) GROUP BY movie_id) AS link_counts ON cast_counts.movie_id = link_counts.movie_id JOIN movie_info AS mi ON cast_counts.movie_id = mi.movie_id;
SELECT kt.kind AS movie_type, COUNT(DISTINCT ci.movie_id) AS total_movies, COUNT(DISTINCT ci.person_id) AS total_participants, AVG(ci.nr_order) AS average_cast_position, SUM(CASE WHEN cct.kind = 'complete' THEN 1 ELSE 0 END) AS complete_movies, SUM(CASE WHEN cct.kind = 'complete+verified' THEN 1 ELSE 0 END) AS verified_movies, COUNT(DISTINCT pi.person_id) FILTER (WHERE pi.note IS NOT NULL) AS noted_person_info_entries, COUNT(DISTINCT ml.movie_id) AS total_movie_links, COUNT(DISTINCT an.person_id) AS total_aka_persons FROM kind_type AS kt JOIN title AS t ON kt.id = t.kind_id LEFT JOIN cast_info AS ci ON t.id = ci.movie_id LEFT JOIN complete_cast AS cc ON t.id = cc.movie_id LEFT JOIN comp_cast_type AS cct ON cc.subject_id = cct.id LEFT JOIN person_info AS pi ON ci.person_id = pi.person_id LEFT JOIN movie_link AS ml ON t.id = ml.movie_id LEFT JOIN aka_name AS an ON ci.person_id = an.person_id WHERE kt.kind IN ('movie', 'tv series') AND t.production_year >= 2000 AND t.production_year <= 2010 GROUP BY kt.kind ORDER BY total_movies DESC;
SELECT COUNT(DISTINCT ci.person_id) AS total_actors, AVG(kt.keyword_count) AS average_keywords_per_movie, MAX(t.production_year) AS latest_production_year, SUM(CASE WHEN ci.person_id IN (1674, 1343) THEN 1 ELSE 0 END) AS appearances_of_selected_actors FROM title t JOIN cast_info ci ON t.id = ci.movie_id JOIN (SELECT movie_id, COUNT(keyword_id) AS keyword_count FROM movie_keyword GROUP BY movie_id) kt ON kt.movie_id = t.id WHERE t.episode_of_id IN ('133358', '192556', '167400', '84369') AND t.kind_id != 7 GROUP BY t.production_year ORDER BY latest_production_year DESC;
SELECT rt.role, COUNT(DISTINCT cn.id) AS num_characters, COUNT(DISTINCT cc.movie_id) AS num_movies, AVG(mi.info::numeric) AS average_rating, SUM(CASE WHEN mk.keyword_id = 4215 THEN 1 ELSE 0 END) AS count_keyword_4215, SUM(CASE WHEN mk.keyword_id = 3983 THEN 1 ELSE 0 END) AS count_keyword_3983 FROM role_type rt LEFT JOIN char_name cn ON rt.id = cn.id LEFT JOIN complete_cast cc ON cn.id = cc.subject_id LEFT JOIN movie_info mi ON cc.movie_id = mi.movie_id AND mi.info_type_id = (SELECT id FROM movie_info WHERE info = 'rating') LEFT JOIN movie_keyword mk ON cc.movie_id = mk.movie_id WHERE rt.role IN ('actress', 'producer') AND mi.movie_id IN ('925429', '925019') GROUP BY rt.role;
SELECT cn.name AS company_name, COUNT(DISTINCT mi_idx.movie_id) AS number_of_movies, AVG(CAST(mi_idx.info AS NUMERIC)) AS average_runtime, SUM(CASE WHEN it.info = 'locations' THEN 1 ELSE 0 END) AS total_locations, COUNT(DISTINCT mk.keyword_id) AS unique_keywords, COUNT(DISTINCT cc.movie_id) AS complete_cast_movies FROM movie_info_idx AS mi_idx JOIN info_type AS it ON mi_idx.info_type_id = it.id JOIN movie_keyword AS mk ON mi_idx.movie_id = mk.movie_id JOIN complete_cast AS cc ON mi_idx.movie_id = cc.movie_id JOIN company_name AS cn ON cn.imdb_id = mi_idx.movie_id WHERE it.info IN ('runtimes', 'locations') AND cn.name_pcode_nf = 'G2642' GROUP BY cn.name ORDER BY average_runtime DESC, number_of_movies DESC;
SELECT COUNT(DISTINCT cn.id) AS total_companies, COUNT(DISTINCT ci.person_id) AS total_cast_members, AVG(ci.nr_order) AS average_cast_order, COUNT(DISTINCT mk.movie_id) AS total_movies_with_keywords, SUM(CASE WHEN k.keyword = 'contest' THEN 1 ELSE 0 END) AS total_contest_keyword, SUM(CASE WHEN k.keyword = 'shield' THEN 1 ELSE 0 END) AS total_shield_keyword FROM company_name cn JOIN company_type ct ON cn.id = ct.id JOIN cast_info ci ON ci.person_id = cn.id JOIN movie_keyword mk ON mk.movie_id = ci.movie_id JOIN keyword k ON k.id = mk.keyword_id WHERE k.phonetic_code IN ('P2353', 'C2535', 'P6215') AND mk.keyword_id IN ('1071', '3527', '3569', '2390');
SELECT COUNT(DISTINCT ci.movie_id) AS number_of_movies, AVG(mi_idx_cnt.count) AS average_keywords_per_movie, SUM(case when n.gender = 'M' then 1 else 0 end) AS male_actors_count, SUM(case when f.gender = 'F' then 1 else 0 end) AS female_actors_count, MIN(n.name) AS most_common_male_actor_name, MIN(f.name) AS most_common_female_actor_name FROM cast_info ci LEFT JOIN name n ON ci.person_id = n.id AND n.gender = 'M' LEFT JOIN name f ON ci.person_id = f.id AND f.gender = 'F' LEFT JOIN ( SELECT movie_id, COUNT(keyword_id) AS count FROM movie_keyword GROUP BY movie_id ) mi_idx_cnt ON ci.movie_id = mi_idx_cnt.movie_id WHERE ci.nr_order = 1 GROUP BY ci.person_id;
SELECT AVG(t.production_year) AS average_production_year, COUNT(DISTINCT t.id) AS number_of_movies, COUNT(DISTINCT cn.id) AS number_of_actors, SUM(CASE WHEN t.kind_id = 1 THEN 1 ELSE 0 END) AS number_of_feature_films, MAX(mi.info) AS longest_movie_duration FROM title t JOIN movie_info mi ON mi.movie_id = t.id AND mi.info_type_id = (SELECT id FROM info_type WHERE info = 'runtime') JOIN char_name cn ON cn.id IN (SELECT person_id FROM cast_info WHERE movie_id = t.id) JOIN role_type rt ON rt.id IN (SELECT role_id FROM cast_info WHERE person_id = cn.id) WHERE t.production_year BETWEEN 1990 AND 2020 GROUP BY t.kind_id ORDER BY average_production_year DESC, number_of_movies DESC;
SELECT rt.ROLE AS role_type, AVG(ci.nr_order) AS average_cast_order, COUNT(DISTINCT ci.person_id) AS unique_actors, COUNT(DISTINCT ci.movie_id) AS movies_count, MIN(t.title) AS earliest_movie_title, MAX(t.production_year) AS latest_production_year, SUM(CASE WHEN cn.country_code = 'US' THEN 1 ELSE 0 END) AS us_based_companies_count FROM cast_info AS ci JOIN role_type AS rt ON ci.role_id = rt.id JOIN title AS t ON ci.movie_id = t.id JOIN company_name AS cn ON cn.imdb_id = t.imdb_id WHERE t.production_year BETWEEN 2000 AND 2020 GROUP BY rt.ROLE ORDER BY movies_count DESC, unique_actors DESC;
SELECT kt.kind AS movie_kind, COUNT(DISTINCT ci.movie_id) AS number_of_movies, AVG(ci.nr_order) AS average_cast_order, SUM(CASE WHEN ci.nr_order IS NOT NULL THEN 1 ELSE 0 END) AS total_cast_positions_filled, COUNT(DISTINCT an.id) AS unique_aka_names, COUNT(DISTINCT chn.id) AS unique_character_names, AVG(mii.info::NUMERIC) AS average_movie_info_numeric_value FROM kind_type AS kt JOIN movie_info_idx AS mii ON kt.id = mii.info_type_id LEFT JOIN cast_info AS ci ON mii.movie_id = ci.movie_id LEFT JOIN aka_name AS an ON ci.person_id = an.person_id LEFT JOIN char_name AS chn ON ci.person_id = chn.imdb_id WHERE kt.id IN (1, 2, 4, 7) AND mii.info SIMILAR TO '(26|00..001212|1\.00101100|...0\.110\.6)%' AND ci.nr_order IN (20, 33, 65, 75, 87, 93) AND an.name_pcode_cf IN ('A42', 'W4526', 'F6165', 'S5152', 'A641', 'M2626') GROUP BY kt.kind ORDER BY number_of_movies DESC;
SELECT ct.kind AS company_type, AVG(t.production_year) AS average_production_year, COUNT(DISTINCT t.id) AS number_of_movies, SUM(CASE WHEN mi.info_type_id = 1 THEN 1 ELSE 0 END) AS number_of_top_ranked_movies FROM company_type AS ct JOIN movie_companies AS mc ON ct.id = mc.company_type_id JOIN title AS t ON mc.movie_id = t.id JOIN movie_info AS mi ON t.id = mi.movie_id WHERE ct.kind IN ('special effects companies', 'miscellaneous companies', 'production companies', 'distributors') AND t.production_year >= 2000 GROUP BY ct.kind ORDER BY number_of_movies DESC;
SELECT kt.kind AS movie_type, COUNT(DISTINCT t.id) AS total_movies, AVG(t.production_year) AS average_production_year, SUM(CASE WHEN mc.company_type_id = 1 THEN 1 ELSE 0 END) AS total_produced_by_company_type_1, COUNT(DISTINCT n.id) AS total_actors_involved, AVG(CAST(n.gender AS integer)) AS average_gender_code FROM title t JOIN kind_type kt ON t.kind_id = kt.id LEFT JOIN movie_companies mc ON t.id = mc.movie_id LEFT JOIN complete_cast cc ON cc.movie_id = t.id LEFT JOIN name n ON n.id = cc.subject_id AND cc.status_id = 1 GROUP BY kt.kind ORDER BY total_movies DESC;
SELECT k.keyword AS keyword, COUNT(DISTINCT mk.movie_id) AS number_of_movies, AVG(CAST(mi.info AS FLOAT)) AS average_movie_length, COUNT(DISTINCT n.id) AS number_of_actors FROM movie_keyword AS mk INNER JOIN keyword AS k ON mk.keyword_id = k.id INNER JOIN movie_info AS mi ON mk.movie_id = mi.movie_id AND mi.info_type_id = 4 INNER JOIN name AS n ON mi.movie_id = n.imdb_id WHERE mk.keyword_id IN (3881, 2089, 3415, 3648) GROUP BY k.keyword ORDER BY number_of_movies DESC, average_movie_length DESC;
SELECT rt.ROLE AS role_type, COUNT(DISTINCT ci.person_id) AS number_of_people, AVG(ci.nr_order) AS average_nr_order, COUNT(DISTINCT t.id) AS number_of_movies, SUM(CASE WHEN cc.status_id = 1 THEN 1 ELSE 0 END) AS complete_cast_count, MIN(t.production_year) AS earliest_production_year, MAX(t.production_year) AS latest_production_year FROM cast_info ci JOIN role_type rt ON ci.role_id = rt.id JOIN title t ON ci.movie_id = t.id LEFT JOIN complete_cast cc ON t.id = cc.movie_id AND cc.subject_id = 1 WHERE t.kind_id IN (2, 7) AND (ci.person_role_id IS NULL OR ci.person_role_id IN (1264, 1098, 226, 448, 1154)) AND t.production_year BETWEEN 1990 AND 2023 GROUP BY rt.ROLE ORDER BY number_of_people DESC;
SELECT mi.info AS genre, COUNT(DISTINCT mi.movie_id) AS number_of_movies, AVG(mii.info::numeric) AS average_movie_length, SUM(CASE WHEN lt.LINK = 'followed by' THEN 1 ELSE 0 END) AS sequel_count FROM movie_info mi JOIN movie_info_idx mii ON mi.movie_id = mii.movie_id AND mi.info_type_id = mii.info_type_id LEFT JOIN link_type lt ON lt.id = mii.info_type_id WHERE mi.info_type_id = 4 AND mii.movie_id IN ('19615', '11115', '18537', '8949', '8884') AND lt.LINK IN ('similar to', 'features', 'followed by', 'alternate language version of') GROUP BY genre ORDER BY number_of_movies DESC, average_movie_length DESC;
