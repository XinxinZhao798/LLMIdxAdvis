SELECT kt.kind AS movie_kind, COUNT(DISTINCT mc.movie_id) AS number_of_movies, COUNT(DISTINCT mc.company_id) AS number_of_companies, SUM(pi.id) AS total_person_info_records, COUNT(DISTINCT k.id) AS unique_keywords_count FROM movie_companies AS mc JOIN kind_type AS kt ON mc.company_type_id = kt.id JOIN name AS n ON mc.movie_id = n.id JOIN person_info AS pi ON pi.person_id = n.id JOIN keyword AS k ON k.id = pi.id WHERE kt.id IN ('7', '6', '2', '5') AND k.keyword IN ('24-hours', 'compassion') AND n.surname_pcode IN ('A415', 'A4') AND pi.note IN ('Jack Backstreet', 'Zaid Adham', 'David Adler', 'John Dream', 'Trace''s Publicist') GROUP BY kt.kind ORDER BY number_of_movies DESC;
SELECT c.name AS company_name, p.gender, COUNT(*) AS number_of_employees, AVG(pi.info_type_id) AS average_info_type_id, SUM(mi.movie_id) AS total_movie_id_sum, COUNT(DISTINCT k.id) AS unique_keyword_count FROM company_name AS c JOIN movie_info_idx AS mi ON c.imdb_id = mi.movie_id JOIN person_info AS pi ON mi.movie_id = pi.person_id JOIN name AS p ON pi.person_id = p.id JOIN keyword AS k ON mi.info LIKE '%' || k.keyword || '%' WHERE c.name_pcode_nf IN ('E2153', 'C5125', 'M2643', 'C2425') AND c.name_pcode_sf IN ('V3252', 'C1212', 'I2416', 'T6215', 'U5163') AND mi.info_type_id IN ('100', '101', '99') GROUP BY c.name, p.gender ORDER BY number_of_employees DESC, average_info_type_id;
SELECT n.name AS actor_name, COUNT(DISTINCT cn.id) AS character_count, AVG(mk.keyword_id) AS average_keyword_id, SUM(CASE WHEN ml.link_type_id = 1 THEN 1 ELSE 0 END) AS direct_movie_links, COUNT(DISTINCT ml.movie_id) AS linked_movies_count FROM name n JOIN aka_name an ON n.id = an.person_id JOIN char_name cn ON an.id = cn.imdb_id JOIN movie_keyword mk ON cn.id = mk.movie_id JOIN movie_link ml ON mk.movie_id = ml.movie_id WHERE n.gender = 'm' GROUP BY n.name;
SELECT t.title AS movie_title, t.production_year AS movie_year, COUNT(DISTINCT ci.person_id) AS total_cast_members, AVG(ci.nr_order) AS average_cast_order, COUNT(DISTINCT ml.movie_id) AS total_related_movies, SUM(CASE WHEN ci.note LIKE '%(plastic surgeon)%' THEN 1 ELSE 0 END) AS plastic_surgeon_roles FROM title AS t LEFT JOIN cast_info AS ci ON t.id = ci.movie_id LEFT JOIN movie_link AS ml ON t.id = ml.movie_id WHERE t.production_year > 1990 AND (ml.linked_movie_id IN ('6083', '1392360', '1432949', '672621', '2395841', '604373') OR ml.linked_movie_id IS NULL) AND (ml.link_type_id = '11' OR ml.link_type_id IS NULL) AND (ci.person_role_id IS NOT NULL) GROUP BY t.title, t.production_year HAVING COUNT(DISTINCT ci.person_id) > 10 ORDER BY total_cast_members DESC, movie_year DESC;
SELECT k.keyword, AVG(at.production_year) AS avg_production_year, COUNT(DISTINCT at.movie_id) AS total_movies, COUNT(DISTINCT at.kind_id) AS different_kinds FROM keyword AS k JOIN movie_info AS mi ON mi.info LIKE '%' || k.keyword || '%' JOIN aka_title AS at ON at.movie_id = mi.movie_id WHERE k.keyword IN ('stewardess', 'lost-film', 'reality', 'honeymoon', 'murder-mystery') AND at.note LIKE '%lost film%' GROUP BY k.keyword;
