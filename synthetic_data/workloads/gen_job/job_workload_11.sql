SELECT AVG(t.production_year) AS average_production_year, COUNT(DISTINCT t.id) AS number_of_movies, COUNT(DISTINCT mk.keyword_id) AS unique_keywords, SUM(CASE WHEN ct.id = 1 THEN 1 ELSE 0 END) AS count_of_company_type_1, COUNT(DISTINCT cn.id) AS number_of_char_names_with_notable_keywords FROM title AS t JOIN movie_keyword AS mk ON t.id = mk.movie_id JOIN keyword AS k ON mk.keyword_id = k.id LEFT JOIN movie_info AS mi ON t.id = mi.movie_id LEFT JOIN char_name AS cn ON cn.md5sum IN ('b0dc5d03266435f97cebf99921c7e7ac', 'd86327f54be7c284dea0e9dbcfc30d64', 'c36ece9f29aeec8bdb6e41b809e925e7', 'a997ab7b0916b53836f2184145809ded') LEFT JOIN company_type AS ct ON ct.id IN (1, 2, 4) WHERE mi.info_type_id = 4 AND mi.info = 'Vietnamese' AND t.production_year IS NOT NULL GROUP BY ct.id;
SELECT rt.ROLE AS role_type, AVG(ci.nr_order) AS average_order, COUNT(DISTINCT ci.person_id) AS distinct_actors_count, SUM(CASE WHEN k.phonetic_code = 'D56' THEN 1 ELSE 0 END) AS keyword_D56_count, MIN(t.title) AS earliest_movie_title, MAX(t.production_year) AS latest_production_year, COUNT(DISTINCT k.id) AS distinct_keyword_count FROM cast_info ci JOIN role_type rt ON ci.role_id = rt.id JOIN title t ON ci.movie_id = t.id LEFT JOIN keyword k ON k.id = ANY(ARRAY[2148, 118, 3933, 2925]) WHERE rt.ROLE IN ('actor', 'actress', 'producer', 'director') AND t.production_year BETWEEN 1990 AND 2020 GROUP BY rt.ROLE ORDER BY distinct_actors_count DESC;
SELECT AVG(acast.cnt) AS average_cast_per_movie, AVG(alink.link_cnt) AS average_links_per_movie, SUM(kw.keyword_count) AS total_keyword_occurrences, COUNT(DISTINCT atitle.movie_id) AS count_distinct_movies FROM (SELECT movie_id, COUNT(*) AS cnt FROM cast_info GROUP BY movie_id) AS acast JOIN aka_title atitle ON acast.movie_id = atitle.movie_id LEFT JOIN (SELECT movie_id, COUNT(*) AS link_cnt FROM movie_link GROUP BY movie_id) AS alink ON atitle.movie_id = alink.movie_id LEFT JOIN (SELECT movie_id, COUNT(*) AS keyword_count FROM keyword INNER JOIN movie_keyword ON keyword.id = movie_keyword.keyword_id GROUP BY movie_id) AS kw ON atitle.movie_id = kw.movie_id WHERE atitle.production_year IS NOT NULL AND atitle.production_year >= 2000 AND atitle.kind_id = 1 AND (atitle.note LIKE '%(International: English title)%' OR atitle.note LIKE '%(Hong Kong: Mandarin title)%') AND EXISTS (SELECT 1 FROM cast_info WHERE cast_info.movie_id = atitle.movie_id AND person_role_id IN (1210, 1072, 1419)) AND EXISTS (SELECT 1 FROM info_type WHERE id IN (68, 61)) AND EXISTS (SELECT 1 FROM keyword WHERE keyword IN ('assumed-identity', 'midnight-snack', 'dyslexia') AND id IN (SELECT keyword_id FROM movie_keyword WHERE movie_id = atitle.movie_id)) GROUP BY atitle.production_year ORDER BY atitle.production_year DESC;
SELECT COUNT(DISTINCT ci.movie_id) AS number_of_movies, AVG(LENGTH(mc.note)) AS avg_company_notes_length, COUNT(DISTINCT n.id) AS number_of_actors, SUM(CASE WHEN n.gender = 'm' THEN 1 ELSE 0 END) AS number_of_male_actors, cn.name AS production_company, COUNT(k.id) AS number_of_keywords_used, AVG(ci.nr_order) AS avg_cast_order FROM cast_info ci JOIN movie_companies mc ON ci.movie_id = mc.movie_id JOIN company_name cn ON mc.company_id = cn.id JOIN name n ON ci.person_id = n.id JOIN keyword k ON k.id = ci.role_id WHERE n.gender = 'm' AND ci.nr_order IN (23, 43, 32, 50, 117, 56) AND mc.note IS NOT NULL AND cn.country_code = 'US' GROUP BY cn.name ORDER BY number_of_movies DESC, avg_company_notes_length DESC;
SELECT SUM(mc.company_id) AS total_company_ids, AVG(CASE WHEN mc.company_type_id = 1 THEN mc.movie_id ELSE NULL END) AS average_movie_id_for_type_1, COUNT(DISTINCT ml.link_type_id) AS unique_link_types, COUNT(DISTINCT pi.person_id) AS unique_person_count, AVG(CASE WHEN pi.info_type_id = 5 THEN LENGTH(pi.info) ELSE NULL END) AS average_info_length_for_type_5 FROM movie_companies mc FULL OUTER JOIN movie_link ml ON mc.movie_id = ml.movie_id FULL OUTER JOIN person_info pi ON mc.company_id = pi.person_id GROUP BY mc.company_type_id;
SELECT kt.kind AS movie_genre, COUNT(DISTINCT t.id) AS total_movies, AVG(t.production_year) AS average_production_year, COUNT(DISTINCT mc.company_id) AS total_production_companies, COUNT(DISTINCT n.id) AS total_unique_actors FROM title AS t JOIN kind_type AS kt ON t.kind_id = kt.id JOIN movie_companies AS mc ON t.id = mc.movie_id JOIN cast_info AS ci ON t.id = ci.movie_id JOIN name AS n ON ci.person_id = n.id WHERE t.production_year > 1990 AND mc.movie_id IN ('9013', '18754', '19628', '12173') AND mc.id IN ('2363', '1293', '1757', '2957') GROUP BY kt.kind ORDER BY total_movies DESC;
SELECT AVG(CAST(mi.info AS NUMERIC)) AS average_movie_length, SUM(CAST(mi_idx.info AS INTEGER)) AS total_votes, COUNT(DISTINCT cn.id) AS number_of_characters, MAX(cn.name) AS longest_character_name FROM movie_info mi JOIN movie_info_idx mi_idx ON mi.movie_id = mi_idx.movie_id AND mi.info_type_id = mi_idx.info_type_id JOIN char_name cn ON cn.id = mi.id WHERE mi.info_type_id = '4' AND mi_idx.info ~ '^\d+$' AND mi.movie_id IN ('8983', '18800', '19279', '12551') AND cn.name <> 'Clawed Stalker' GROUP BY mi.info_type_id;
SELECT AVG(at.production_year) AS average_production_year, COUNT(DISTINCT at.movie_id) AS number_of_movies, COUNT(DISTINCT ml.linked_movie_id) AS number_of_linked_movies, SUM(CASE WHEN lt.link = 'similar to' THEN 1 ELSE 0 END) AS count_similar_movies, rt.role AS role_type, COUNT(DISTINCT cct.id) AS count_of_cast_types FROM aka_title at JOIN movie_link ml ON at.movie_id = ml.movie_id JOIN link_type lt ON ml.link_type_id = lt.id JOIN role_type rt ON rt.id = 4 JOIN comp_cast_type cct ON cct.kind IN ('complete+verified', 'cast', 'crew', 'complete') WHERE at.md5sum IN ('efba398a3a676bcdd49811cf868754d9', '532902abff1e92fb97a2eef43fb530a6', '803eb3353f2aeb81555223391ef4de88', 'eaf5b1adddabc3742e27581d5b19c2ac') GROUP BY rt.role;
SELECT COUNT(DISTINCT ci.person_id) AS total_actors, AVG(ci.nr_order) AS average_cast_order, SUM(CASE WHEN ci.role_id = 1 THEN 1 ELSE 0 END) AS total_leading_roles, aka.production_year, mi.info AS movie_genre, AVG(aka.production_year) AS average_alternate_title_year FROM cast_info AS ci JOIN movie_info_idx AS mi ON ci.movie_id = mi.movie_id JOIN aka_title AS aka ON ci.movie_id = aka.movie_id WHERE ci.nr_order IN (200, 43, 31, 92, 117, 48) AND mi.info_type_id = (SELECT id FROM info_type WHERE info = 'genre') AND aka.kind_id = 1 AND aka.production_year > 2000 GROUP BY aka.production_year, mi.info ORDER BY aka.production_year DESC, total_actors DESC;
SELECT rt.ROLE AS role_type, COUNT(DISTINCT ci.person_id) AS number_of_people, AVG(ci.nr_order) AS average_cast_order, SUM(CASE WHEN cct.kind = 'complete+verified' THEN 1 ELSE 0 END) AS total_complete_verified_casts, MIN(cn.country_code) AS country_code, MAX(mi.info) AS maximum_movie_info FROM cast_info ci JOIN role_type rt ON ci.role_id = rt.id JOIN complete_cast cc ON ci.movie_id = cc.movie_id JOIN comp_cast_type cct ON cc.status_id = cct.id JOIN company_name cn ON ci.person_id = cn.id JOIN movie_info mi ON ci.movie_id = mi.movie_id WHERE ci.person_role_id IN (107, 448, 439, 1389, 1249, 420) AND cc.movie_id = 1643515 AND cc.id IN (4897, 2653, 4910, 182, 342, 359) AND mi.info LIKE '0.......26%' GROUP BY rt.ROLE ORDER BY number_of_people DESC, average_cast_order;
SELECT lt.LINK AS link_type, COUNT(DISTINCT ml.movie_id) AS number_of_movies, AVG(n.imdb_id) AS average_imdb_id, SUM(CASE WHEN cc.status_id = 4 THEN 1 ELSE 0 END) AS count_status_id_4, SUM(CASE WHEN cc.status_id = 3 THEN 1 ELSE 0 END) AS count_status_id_3, COUNT(DISTINCT pi.person_id) AS distinct_person_count FROM movie_link AS ml JOIN link_type AS lt ON ml.link_type_id = lt.id LEFT JOIN complete_cast AS cc ON ml.movie_id = cc.movie_id LEFT JOIN name AS n ON cc.subject_id = n.id LEFT JOIN person_info AS pi ON n.id = pi.person_id WHERE lt.id IN (6, 15, 11, 5) AND cc.subject_id = 1 AND cc.status_id IN (4,3) AND ml.id IN (2720, 2119, 4076, 1826, 498) AND ml.linked_movie_id IN (260725, 2349487, 1391927) GROUP BY lt.LINK;
SELECT rt.ROLE, COUNT(DISTINCT ci.person_id) AS number_of_actors, AVG(ci.nr_order) AS average_order_of_appearance, SUM(CASE WHEN ci.note LIKE '%(as %' THEN 1 ELSE 0 END) AS count_with_alias, COUNT(DISTINCT ml.movie_id) AS number_of_movies_linked, COUNT(DISTINCT ml.linked_movie_id) AS number_of_linked_movies, most_common_link_type.LINK AS most_common_link_type, COUNT(DISTINCT lt.id) AS number_of_distinct_link_types FROM cast_info ci JOIN role_type rt ON ci.role_id = rt.id LEFT JOIN movie_link ml ON ci.movie_id = ml.movie_id LEFT JOIN link_type lt ON ml.link_type_id = lt.id LEFT JOIN (SELECT inner_ml.movie_id, lt.LINK FROM movie_link inner_ml JOIN link_type lt ON inner_ml.link_type_id = lt.id GROUP BY inner_ml.movie_id, lt.LINK ORDER BY COUNT(*) DESC ) AS most_common_link_type ON ci.movie_id = most_common_link_type.movie_id GROUP BY rt.ROLE, most_common_link_type.LINK ORDER BY number_of_actors DESC, average_order_of_appearance;
SELECT n.name AS actor_name, COUNT(DISTINCT ci.movie_id) AS movies_played, AVG(ci.nr_order) AS average_cast_position, SUM(CASE WHEN cct.kind = 'actor' THEN 1 ELSE 0 END) AS total_actor_roles, SUM(CASE WHEN cct.kind = 'actress' THEN 1 ELSE 0 END) AS total_actress_roles FROM cast_info ci JOIN name n ON ci.person_id = n.id JOIN comp_cast_type cct ON ci.role_id = cct.id WHERE ci.person_role_id IN (1242, 894) AND ci.id IN (15187, 18533) AND n.id IN (8915, 8784, 8411, 7360) AND ci.person_id IN (4062401, 4062465, 1751638, 4062519, 1747068, 24195) GROUP BY n.name;
SELECT ct.kind AS company_type, AVG(cast_info.nr_order) AS average_cast_order, COUNT(DISTINCT aka_title.movie_id) AS unique_movies_count, SUM(CASE WHEN aka_title.note = '(Australia) (subtitle)' THEN 1 ELSE 0 END) AS subtitle_count_australia, COUNT(DISTINCT name.id) AS number_of_actors FROM company_name JOIN company_type ct ON company_name.id = ct.id JOIN cast_info ON cast_info.person_role_id IN (1085, 1377, 785, 931, 155, 1103) JOIN aka_title ON aka_title.movie_id = cast_info.movie_id JOIN name ON name.id = cast_info.person_id LEFT JOIN movie_link ON movie_link.movie_id = aka_title.movie_id AND movie_link.link_type_id = 6 WHERE company_name.md5sum IN ('95cfc537e91c24f4cdc46ebabba6ee92', '61e6938b1d826bba25234363eac1a650') GROUP BY ct.kind;
SELECT kt.kind AS movie_genre, COUNT(DISTINCT mi_idx.movie_id) AS number_of_movies, AVG(CAST(mi_idx.info AS INTEGER)) AS average_rating, SUM(CAST(person_info.info AS INTEGER)) AS total_movie_budget, COUNT(DISTINCT name.id) AS number_of_actors, COUNT(DISTINCT mk.keyword_id) AS number_of_unique_keywords FROM movie_info_idx mi_idx JOIN kind_type kt ON mi_idx.info_type_id = kt.id JOIN movie_keyword mk ON mi_idx.movie_id = mk.movie_id JOIN movie_info_idx budget_idx ON mi_idx.movie_id = budget_idx.movie_id AND budget_idx.info_type_id = (SELECT id FROM kind_type WHERE kind = 'budget') JOIN person_info ON mi_idx.movie_id = person_info.person_id JOIN name ON person_info.person_id = name.id WHERE kt.id IN ('6', '3', '5', '7', '2', '1') AND name.name_pcode_cf IN ('A2545', 'A2651', 'A4236', 'A4341', 'A2456', 'A2632') GROUP BY movie_genre ORDER BY number_of_movies DESC, average_rating DESC;
SELECT cn.country_code, k.keyword, COUNT(DISTINCT mc.movie_id) AS num_movies, AVG(CAST(NULLIF(REGEXP_REPLACE(mi_duration.info, '[^\d.]', '', 'g'), '') AS NUMERIC)) AS average_movie_duration, SUM(CASE WHEN mi_release.info_type_id = 4 THEN 1 ELSE 0 END) AS count_movie_releases FROM company_name AS cn JOIN movie_companies AS mc ON cn.id = mc.company_id JOIN movie_keyword AS mk ON mc.movie_id = mk.movie_id JOIN keyword AS k ON mk.keyword_id = k.id LEFT JOIN movie_info AS mi_release ON mc.movie_id = mi_release.movie_id AND mi_release.info_type_id = 4 LEFT JOIN movie_info AS mi_duration ON mc.movie_id = mi_duration.movie_id AND mi_duration.info_type_id = 3 WHERE k.keyword IN ('dead-mother', 'manipulation') AND mi_release.note IN ('(some dialogue)', '(none)', '(only a few lines)', '(a few lines)', '(a few words)') GROUP BY cn.country_code, k.keyword ORDER BY cn.country_code, k.keyword;
SELECT AVG(at.production_year) AS average_production_year, COUNT(DISTINCT ml.movie_id) AS count_of_movies_with_links, COUNT(DISTINCT at.movie_id) AS count_of_alternate_titles, SUM(CASE WHEN at.kind_id = 1 THEN 1 ELSE 0 END) AS count_of_movies, SUM(CASE WHEN at.kind_id = 3 THEN 1 ELSE 0 END) AS count_of_tv_shows, COUNT(DISTINCT k.id) AS count_of_unique_keywords FROM aka_title at LEFT JOIN movie_link ml ON at.movie_id = ml.movie_id LEFT JOIN keyword k ON at.title LIKE CONCAT('%', k.keyword, '%') WHERE at.production_year > 2000 AND (ml.id IN (4856, 1568, 48, 747, 1537, 3901) OR ml.linked_movie_id = 2323856) AND at.episode_nr IN (38, 29, 26, 64, 24) AND k.phonetic_code IS NOT NULL GROUP BY at.kind_id;
SELECT kt.kind AS movie_kind, AVG(mi.info::numeric) AS average_rating, COUNT(DISTINCT t.id) AS total_movies, COUNT(DISTINCT an.id) AS total_actors, SUM(CASE WHEN cn.country_code = '[us]' THEN 1 ELSE 0 END) AS total_us_production_companies FROM title t JOIN kind_type kt ON t.kind_id = kt.id JOIN movie_info mi ON t.id = mi.movie_id JOIN info_type it ON mi.info_type_id = it.id AND it.info = 'rating' LEFT JOIN movie_companies mc ON t.id = mc.movie_id LEFT JOIN company_name cn ON mc.company_id = cn.id LEFT JOIN complete_cast cc ON t.id = cc.movie_id LEFT JOIN complete_cast an ON cc.id = an.id WHERE kt.kind IN ('video game', 'episode', 'tv series', 'tv mini series') AND t.production_year > 2000 GROUP BY kt.kind HAVING AVG(mi.info::numeric) > 5.0 ORDER BY average_rating DESC;
SELECT it.info AS info_type, COUNT(DISTINCT pi.person_id) AS number_of_persons, COUNT(DISTINCT cc.movie_id) AS number_of_movies, AVG(cc.status_id) AS average_status_id, SUM(case when pi.info_type_id = 36 then 1 else 0 end) AS count_type_36_info, SUM(case when pi.info_type_id = 37 then 1 else 0 end) AS count_type_37_info FROM person_info pi JOIN info_type it ON pi.info_type_id = it.id LEFT JOIN complete_cast cc ON pi.person_id = cc.subject_id WHERE it.info IN ('LD analog right', 'pictorial', 'languages') AND pi.info_type_id IN (36, 37) AND cc.movie_id IN (1699369, 1690770, 1647675, 81514, 1634423) AND cc.subject_id = 1 GROUP BY it.info;
SELECT kt.kind, COUNT(DISTINCT cn.id) AS num_companies, COUNT(DISTINCT mi.movie_id) AS num_movies, AVG(CAST(mi.info AS NUMERIC)) FILTER (WHERE it1.info = 'rating') AS avg_rating, SUM(CAST(mi.info AS NUMERIC)) FILTER (WHERE it1.info = 'budget') AS total_budget FROM kind_type AS kt JOIN movie_info AS mi ON mi.info_type_id = kt.id JOIN company_name AS cn ON cn.imdb_id = mi.movie_id JOIN movie_info AS it1 ON mi.movie_id = it1.movie_id AND it1.info_type_id = kt.id WHERE kt.id IN ('4', '5', '1') AND kt.kind IN ('episode', 'tv series', 'video game') AND mi.info_type_id IN (SELECT id FROM info_type WHERE info IN ('rating', 'budget')) GROUP BY kt.kind;
SELECT CT.kind AS company_kind, AVG(CAST(MI.info AS FLOAT)) AS average_rating, COUNT(DISTINCT CI.person_id) AS total_cast_members, COUNT(DISTINCT MC.movie_id) AS number_of_movies FROM movie_companies AS MC JOIN company_type AS CT ON MC.company_type_id = CT.id JOIN movie_info AS MI ON MC.movie_id = MI.movie_id AND MI.info_type_id = 101 JOIN cast_info AS CI ON MC.movie_id = CI.movie_id WHERE (MC.note LIKE '%(TV)' OR MC.note IS NULL) AND CT.kind IN ('special effects companies', 'miscellaneous companies', 'production companies', 'distributors') AND CI.role_id = 1 GROUP BY CT.kind ORDER BY average_rating DESC;
SELECT rt.ROLE, COUNT(mc.movie_id) AS number_of_movies, AVG(alt.production_year) AS average_production_year, SUM(CASE WHEN lt.LINK = 'sequel' THEN 1 ELSE 0 END) AS sequel_count, COUNT(DISTINCT mc.company_id) AS distinct_companies_involved FROM aka_title alt INNER JOIN movie_companies mc ON alt.movie_id = mc.movie_id INNER JOIN link_type lt ON lt.id = alt.kind_id INNER JOIN role_type rt ON rt.id = mc.company_type_id WHERE rt.id IN ('1', '8') GROUP BY rt.ROLE ORDER BY number_of_movies DESC;
