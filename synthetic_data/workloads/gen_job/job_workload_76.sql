SELECT rt.ROLE, COUNT(DISTINCT ci.person_id) AS number_of_actors, AVG(ci.nr_order) AS average_cast_position, SUM(CASE WHEN ct.kind = 'production companies' THEN 1 ELSE 0 END) AS count_production_companies, SUM(CASE WHEN ct.kind = 'distributors' THEN 1 ELSE 0 END) AS count_distributors, SUM(CASE WHEN ct.kind = 'special effects companies' THEN 1 ELSE 0 END) AS count_special_effects_companies, SUM(CASE WHEN ct.kind = 'miscellaneous companies' THEN 1 ELSE 0 END) AS count_miscellaneous_companies FROM cast_info ci JOIN role_type rt ON ci.role_id = rt.id JOIN movie_companies mc ON ci.movie_id = mc.movie_id JOIN company_type ct ON mc.company_type_id = ct.id WHERE ci.movie_id IN ('1061075', '1326354', '1324782', '1249308', '2383083', '2172643') AND mc.company_id IN ('22', '900', '1231', '886') GROUP BY rt.ROLE;
SELECT ct.kind AS company_type, COUNT(DISTINCT mi_idx.movie_id) AS number_of_movies, AVG(CASE WHEN mi_idx.info_type_id = 100 THEN CAST(mi_idx.info AS FLOAT) END) AS average_rating, SUM(CASE WHEN mi_idx.info_type_id = 101 THEN CAST(mi_idx.info AS INTEGER) END) AS total_budget, COUNT(DISTINCT pi.person_id) AS number_of_persons_involved FROM movie_info_idx mi_idx JOIN company_type ct ON mi_idx.info_type_id = ct.id LEFT JOIN person_info pi ON mi_idx.movie_id = pi.person_id WHERE mi_idx.info_type_id IN (100, 101, 99) GROUP BY ct.kind;
SELECT it.info AS InfoType, COUNT(DISTINCT ci.movie_id) AS NumberOfMovies, COUNT(DISTINCT ci.person_id) AS NumberOfPeople, AVG(ci.nr_order) AS AverageCastOrder, COUNT(DISTINCT cc.movie_id) AS CompleteMoviesCount, MAX(n.name) AS MostCommonName, SUM(CASE WHEN n.gender = 'm' THEN 1 ELSE 0 END) AS MaleCount, SUM(CASE WHEN n.gender <> 'm' THEN 1 ELSE 0 END) AS NonMaleCount, mi.info AS MovieInfo FROM cast_info ci JOIN complete_cast cc ON ci.movie_id = cc.movie_id JOIN info_type it ON ci.role_id = it.id JOIN movie_info_idx mi ON ci.movie_id = mi.movie_id JOIN name n ON ci.person_id = n.id WHERE ci.role_id IN (100, 101, 99) AND n.surname_pcode IN ('A452', 'A424') AND n.gender = 'm' AND mi.info_type_id IN (100, 101, 99) GROUP BY it.info, mi.info ORDER BY NumberOfMovies DESC, NumberOfPeople DESC;
SELECT c.name AS company_name, it.info AS info_category, COUNT(DISTINCT mi.movie_id) AS num_movies, AVG(CAST(mi_idx.info AS numeric)) AS average_info, SUM(CAST((CASE WHEN mi_idx.note = '1' THEN 1 ELSE 0 END) AS integer)) AS sum_notes_flagged_1 FROM company_name c JOIN movie_info mi ON c.id = mi.movie_id JOIN movie_info_idx mi_idx ON mi.movie_id = mi_idx.movie_id AND mi.info_type_id = mi_idx.info_type_id JOIN info_type it ON mi.info_type_id = it.id JOIN movie_keyword mk ON mi.movie_id = mk.movie_id WHERE mi_idx.info_type_id IN ('100', '101', '99') AND mk.keyword_id IN ('4340', '3698', '3610', '2735') AND mi_idx.info IN ('0.0.010105', '1....1..6.', '1......413', '0..0000033') GROUP BY c.name, it.info ORDER BY num_movies DESC, average_info DESC;
SELECT rt.ROLE, COUNT(DISTINCT ci.movie_id) AS number_of_movies, AVG(ci.nr_order) AS average_cast_order, COUNT(DISTINCT name.id) AS number_of_unique_actors FROM cast_info ci JOIN role_type rt ON ci.role_id = rt.id JOIN name ON ci.person_id = name.id WHERE rt.id IN (1) AND ci.nr_order IS NOT NULL AND name.md5sum IN ('0d93c2f49007eb923f1f3983f0a8cc6b', 'c73602ee6ad37663369ca6e3bd40e7dd', 'db97c7dc12820b568f8351333075a92d', '53ebf953411448090e3e779bf1486727', 'f22535a12044b89484f9cba769cf437a', '6f608ba1bd4dd87eac0e663a877f54bc') GROUP BY rt.ROLE;
SELECT cct.kind AS cast_type, COUNT(DISTINCT mk.movie_id) AS movie_count, COUNT(mk.id) AS keyword_count, AVG(ct.id) AS average_company_type_id FROM comp_cast_type cct JOIN movie_keyword mk ON cct.id = mk.movie_id JOIN company_type ct ON mk.keyword_id = ct.id GROUP BY cct.kind HAVING COUNT(DISTINCT mk.movie_id) > 5 ORDER BY movie_count DESC, keyword_count DESC;
SELECT kt.kind AS movie_kind, COUNT(DISTINCT ci.movie_id) AS total_movies, AVG(ci.nr_order) AS average_cast_order, SUM(CASE WHEN ci.person_id = 1867 THEN 1 ELSE 0 END) AS total_movies_person_1867, SUM(CASE WHEN ci.person_id = 1769 THEN 1 ELSE 0 END) AS total_movies_person_1769, SUM(CASE WHEN ci.person_id = 1459 THEN 1 ELSE 0 END) AS total_movies_person_1459, COUNT(DISTINCT cn.id) AS total_companies, COUNT(DISTINCT mi.info) AS distinct_movie_info_types FROM kind_type AS kt JOIN movie_info AS mi ON mi.movie_id = kt.id JOIN cast_info AS ci ON ci.movie_id = kt.id JOIN company_name AS cn ON cn.imdb_id = ci.movie_id WHERE kt.kind = 'movie' AND ci.person_id IN (1867, 1769, 1459, 1473, 1640, 1126) AND ci.movie_id IN (152924, 2374081, 1326173, 1098477, 1321487, 1288531) GROUP BY kt.kind;
SELECT kt.kind AS movie_type, AVG(akat.production_year) AS average_production_year, COUNT(DISTINCT akat.movie_id) AS total_movies, SUM(CASE WHEN akat.imdb_index IS NOT NULL THEN 1 ELSE 0 END) AS indexed_movies_count, COUNT(mk.keyword_id) AS total_keywords FROM aka_title akat JOIN kind_type kt ON akat.kind_id = kt.id LEFT JOIN movie_keyword mk ON akat.movie_id = mk.movie_id GROUP BY kt.kind ORDER BY total_movies DESC;
SELECT cn.name AS company_name, ct.kind AS cast_type, COUNT(ml.id) AS total_movie_links, AVG(ml.linked_movie_id) AS average_linked_movie_imdb_id, COUNT(DISTINCT chn.id) AS total_characters FROM company_name cn JOIN movie_link ml ON cn.id = ml.movie_id JOIN comp_cast_type ct ON ml.link_type_id = ct.id LEFT JOIN char_name chn ON ml.movie_id = chn.id WHERE cn.country_code = 'US' AND cn.name_pcode_sf BETWEEN 'A0000' AND 'Z9999' GROUP BY cn.name, ct.kind ORDER BY total_movie_links DESC, average_linked_movie_imdb_id;
SELECT rt.role, COUNT(DISTINCT mi.movie_id) AS number_of_movies, AVG(CAST(mi_idx.info AS NUMERIC)) AS average_info_numeric_value, SUM(CASE WHEN mi_idx.info_type_id IN (100, 101) THEN 1 ELSE 0 END) AS total_info_100_101_count FROM movie_info mi JOIN movie_info_idx mi_idx ON mi.movie_id = mi_idx.movie_id JOIN role_type rt ON mi.info_type_id = rt.id WHERE rt.id IN (7, 2, 1, 6, 8, 9) AND mi_idx.note IS NOT NULL AND mi_idx.info ~ '^\d+(\.\d+)?$' GROUP BY rt.role ORDER BY number_of_movies DESC, average_info_numeric_value DESC;
SELECT kt.kind, COUNT(DISTINCT mk.movie_id) AS number_of_movies, COUNT(DISTINCT k.id) AS number_of_unique_keywords, AVG(cn.imdb_id) AS average_imdb_id_for_companies, SUM(CASE WHEN cn.country_code = 'US' THEN 1 ELSE 0 END) AS number_of_us_companies FROM kind_type kt JOIN movie_keyword mk ON kt.id = mk.movie_id JOIN keyword k ON mk.keyword_id = k.id JOIN company_name cn ON cn.id = mk.movie_id WHERE kt.kind IN ('movie', 'tv movie', 'tv series') AND k.keyword IN ('boss-is-away', 'musical-performance', 'global-warming') GROUP BY kt.kind ORDER BY number_of_movies DESC;
SELECT cn.name AS company_name, cn.country_code, COUNT(t.id) AS total_movies_produced, AVG(t.production_year) AS average_production_year FROM company_name AS cn JOIN movie_info AS mi ON cn.imdb_id = mi.movie_id JOIN title AS t ON mi.movie_id = t.id GROUP BY cn.name, cn.country_code ORDER BY total_movies_produced DESC, average_production_year DESC;
SELECT kt.kind, COUNT(DISTINCT mc.movie_id) AS total_movies, AVG(subquery.keyword_count) AS average_keywords_per_movie, COUNT(DISTINCT CASE WHEN mc.company_type_id = 1 THEN mc.company_id ELSE NULL END) AS type_1_company_count FROM kind_type AS kt LEFT JOIN movie_companies AS mc ON kt.id = mc.company_type_id LEFT JOIN ( SELECT mk.movie_id, COUNT(mk.keyword_id) AS keyword_count FROM movie_keyword AS mk GROUP BY mk.movie_id ) AS subquery ON mc.movie_id = subquery.movie_id WHERE kt.kind = 'movie' GROUP BY kt.kind;
SELECT COUNT(DISTINCT ci.movie_id) AS number_of_movies, AVG(mi_idx.info::numeric) AS average_movie_rating, SUM(CASE WHEN ci.person_role_id IS NOT NULL THEN 1 ELSE 0 END) AS total_cast_with_role, n.gender, n.name_pcode_nf FROM cast_info ci JOIN movie_info_idx mi_idx ON ci.movie_id = mi_idx.movie_id JOIN name n ON ci.person_id = n.id WHERE mi_idx.info_type_id = (SELECT id FROM info_type WHERE info = 'rating') AND n.name_pcode_nf IN ('T6535', 'E3245', 'T124') AND ci.nr_order IN (2, 21, 10, 117, 42) GROUP BY n.gender, n.name_pcode_nf ORDER BY average_movie_rating DESC;
SELECT t.kind_id, COUNT(DISTINCT t.id) AS total_movies, AVG(t.production_year) AS average_production_year, COUNT(DISTINCT ci.person_id) AS total_actors_involved, SUM(CASE WHEN ml.link_type_id = 1 THEN 1 ELSE 0 END) AS total_sequels_linked, MAX(ci.nr_order) AS highest_cast_order FROM title t JOIN cast_info ci ON t.id = ci.movie_id LEFT JOIN movie_link ml ON t.id = ml.movie_id GROUP BY t.kind_id HAVING COUNT(DISTINCT ci.person_id) > 10 ORDER BY total_movies DESC;
SELECT kt.kind, COUNT(DISTINCT mc.movie_id) AS total_movies, COUNT(DISTINCT mc.company_id) AS total_companies_involved, AVG(aka_count.aka_name_count) AS average_aka_names_per_movie_kind FROM kind_type kt JOIN movie_info_idx t ON kt.id = t.info_type_id JOIN movie_companies mc ON t.movie_id = mc.movie_id LEFT JOIN ( SELECT an.person_id, COUNT(*) as aka_name_count FROM aka_name an GROUP BY an.person_id ) aka_count ON mc.movie_id = aka_count.person_id GROUP BY kt.kind ORDER BY total_movies DESC;
SELECT kt.kind AS movie_type, COUNT(DISTINCT mi_idx.movie_id) AS movie_count, AVG(CAST(mi_idx.info AS DECIMAL)) AS average_rating, SUM(CASE WHEN k.keyword IN ('electric-shock', 'hiding-under-covers', 'stabbed-with-a-letter-opener') THEN 1 ELSE 0 END) AS thrill_keyword_count, COUNT(DISTINCT cn.id) AS number_of_companies_involved, STRING_AGG(DISTINCT k.keyword, ', ') AS keywords_involved FROM kind_type AS kt LEFT JOIN movie_info_idx AS mi_idx ON kt.id = mi_idx.info_type_id LEFT JOIN keyword AS k ON mi_idx.movie_id = k.id LEFT JOIN company_name AS cn ON mi_idx.movie_id = cn.imdb_id WHERE kt.kind IN ('tv mini series', 'tv series', 'video movie', 'tv movie') AND mi_idx.note IS NOT NULL AND (k.id = '7078' OR k.id = '5806') AND (cn.country_code = 'US' OR cn.country_code IS NULL) GROUP BY kt.kind ORDER BY movie_type;
SELECT at.production_year, COUNT(DISTINCT at.movie_id) AS total_movies, AVG(at.episode_nr) AS average_episodes_per_season, COUNT(DISTINCT rt.id) AS distinct_roles_count FROM aka_title at JOIN role_type rt ON at.kind_id = rt.id JOIN info_type it ON at.id = it.id WHERE at.production_year IN (1972, 1934, 1943) AND rt.role IN ('production designer', 'composer', 'guest', 'producer', 'actor', 'writer') AND it.info IN ('admissions', 'votes', 'LD master format', 'soundtrack') GROUP BY at.production_year ORDER BY at.production_year;
SELECT rt.ROLE, AVG(at.production_year) AS avg_production_year, COUNT(DISTINCT at.movie_id) AS movie_count, SUM(unique_name_count) AS unique_names_sum FROM aka_title at JOIN (SELECT id, COUNT(DISTINCT name) as unique_name_count FROM char_name GROUP BY id) cn ON at.movie_id = cn.id JOIN role_type rt ON cn.id = rt.id WHERE at.note IN ('(new title)', '(USA) (working title)') GROUP BY rt.ROLE;
SELECT ct.kind AS company_kind, AVG(ti.production_year) AS average_production_year, COUNT(*) AS total_movies, SUM(CASE WHEN ml.link_type_id = 10 THEN 1 ELSE 0 END) AS total_sequels, COUNT(DISTINCT n.id) AS distinct_actors FROM title ti INNER JOIN company_type ct ON ti.kind_id = ct.id LEFT JOIN movie_link ml ON ti.id = ml.movie_id AND ml.link_type_id IN (10, 11, 5, 6, 13) LEFT JOIN cast_info ci ON ti.id = ci.movie_id LEFT JOIN name n ON ci.person_id = n.id WHERE ti.production_year BETWEEN 2000 AND 2020 GROUP BY ct.kind ORDER BY total_movies DESC, average_production_year;
