SELECT cct.kind AS cast_type_kind, AVG(mi_idx.info::numeric) AS average_movie_length, COUNT(DISTINCT mk.movie_id) AS number_of_movies_with_keywords, COUNT(DISTINCT pi.person_id) AS number_of_people_with_info FROM comp_cast_type cct JOIN movie_info_idx mi_idx ON cct.id = mi_idx.info_type_id JOIN movie_keyword mk ON mi_idx.movie_id = mk.movie_id JOIN person_info pi ON pi.info_type_id = mi_idx.info_type_id WHERE mk.keyword_id IN (3246, 2661, 3786) AND mi_idx.info_type_id = cct.id AND pi.info_type_id = cct.id GROUP BY cct.kind;
SELECT ct.kind AS cast_type, AVG(production_year) AS average_production_year, COUNT(DISTINCT ci.movie_id) AS number_of_movies, COUNT(DISTINCT ci.person_id) AS number_of_actors, COUNT(DISTINCT cn.id) AS number_of_characters, SUM(CASE WHEN ci.nr_order IS NOT NULL THEN 1 ELSE 0 END) AS number_of_credits_with_order FROM cast_info ci JOIN comp_cast_type ct ON ci.person_role_id = ct.id JOIN aka_title at ON ci.movie_id = at.movie_id JOIN char_name cn ON ci.person_id = cn.id WHERE at.kind_id = 1 AND ci.role_id IN (1,2) GROUP BY ct.kind ORDER BY number_of_movies DESC;
SELECT kt.kind AS movie_type, COUNT(DISTINCT mi.movie_id) AS total_movies, AVG(CAST(mi_idx.info AS FLOAT)) AS average_rating, SUM(CASE WHEN k.keyword = 'disco-ball' THEN 1 ELSE 0 END) AS disco_ball_keyword_count, SUM(CASE WHEN k.keyword = 'bandana' THEN 1 ELSE 0 END) AS bandana_keyword_count, STRING_AGG(DISTINCT ct.kind, ', ') AS involved_company_types FROM movie_info mi JOIN movie_info_idx mi_idx ON mi.movie_id = mi_idx.movie_id AND mi.info_type_id = mi_idx.info_type_id JOIN kind_type kt ON kt.id = mi.info_type_id JOIN movie_info mii ON mii.movie_id = mi.movie_id JOIN link_type lt ON lt.id = mi_idx.id JOIN keyword k ON k.id = mi_idx.id JOIN company_type ct ON ct.id = mi_idx.id WHERE mi.id IN ('7268657', '7271065', '7267731') AND mi.movie_id IN ('924506', '925955', '929745', '938512', '930430') AND ct.kind IN ('special effects companies', 'miscellaneous companies', 'production companies', 'distributors') AND mi_idx.info SIMILAR TO '(%...[0-9]*[0-9].[0-9]*[0-9]%)' GROUP BY kt.kind;
SELECT mc.company_id, COUNT(DISTINCT mc.movie_id) AS number_of_movies, cs.status_id, AVG(CAST(pi.info AS FLOAT)) FILTER (WHERE pi.info_type_id = 10) AS average_rating FROM movie_companies AS mc JOIN complete_cast AS cs ON mc.movie_id = cs.movie_id JOIN person_info AS pi ON cs.subject_id = pi.person_id GROUP BY mc.company_id, cs.status_id ORDER BY number_of_movies DESC, average_rating DESC;
SELECT ct.kind AS company_type, AVG(ati.production_year) AS average_production_year, COUNT(DISTINCT cn.id) AS number_of_companies, COUNT(DISTINCT ati.movie_id) AS number_of_movies, SUM(CASE WHEN ati.note LIKE '%(subtitle)%' THEN 1 ELSE 0 END) AS number_of_subtitled_movies, SUM(CASE WHEN ati.note LIKE '%(series title)%' THEN 1 ELSE 0 END) AS number_of_series_titles, SUM(CASE WHEN ati.note LIKE '%(informal literal title)%' THEN 1 ELSE 0 END) AS number_of_informal_literal_titles FROM aka_title ati JOIN company_type ct ON ati.kind_id = ct.id LEFT JOIN company_name cn ON ati.movie_id = cn.imdb_id GROUP BY ct.kind ORDER BY number_of_movies DESC, average_production_year DESC;
SELECT rt.role, COUNT(DISTINCT mc.movie_id) AS number_of_movies, COUNT(DISTINCT mc.company_id) AS number_of_companies, AVG(movie_count_per_company.movie_count) AS average_movies_per_company FROM movie_companies mc JOIN (SELECT company_id, COUNT(movie_id) AS movie_count FROM movie_companies GROUP BY company_id) AS movie_count_per_company ON mc.company_id = movie_count_per_company.company_id JOIN role_type rt ON mc.company_type_id = rt.id GROUP BY rt.role ORDER BY number_of_movies DESC;
SELECT COUNT(DISTINCT t.id) AS total_movies, AVG(t.production_year) AS average_production_year, SUM(CASE WHEN mk.movie_id IN ('18308', '18764', '15408', '17206', '12185') THEN 1 ELSE 0 END) AS count_specific_movies, COUNT(DISTINCT cn.surname_pcode) AS unique_character_surnames, MIN(t.title) AS earliest_alphabetical_movie_title FROM title AS t JOIN movie_keyword AS mk ON mk.movie_id = t.id JOIN char_name AS cn ON cn.id = mk.movie_id JOIN name AS n ON n.surname_pcode = cn.surname_pcode WHERE t.series_years = '1990-1991' OR t.phonetic_code IN ('P6523', 'D162', 'R5265', 'D2453', 'F6145') AND cn.surname_pcode IN ('L3414', 'O4353', 'W16', 'I5236') GROUP BY t.kind_id HAVING COUNT(DISTINCT t.id) > 10 ORDER BY total_movies DESC, average_production_year ASC;
SELECT at.title AS alternate_title, COUNT(DISTINCT an.id) AS number_of_alternate_names, AVG(CAST(cc.status_id AS DECIMAL)) AS average_status_id, SUM(CASE WHEN n.gender = 'm' THEN 1 ELSE 0 END) AS male_count, SUM(CASE WHEN n.gender <> 'm' THEN 1 ELSE 0 END) AS female_count, COUNT(DISTINCT cc.id) AS complete_cast_count, MIN(at.production_year) AS earliest_production_year, MAX(at.production_year) AS latest_production_year FROM aka_title at JOIN aka_name an ON at.movie_id = an.person_id JOIN complete_cast cc ON at.movie_id = cc.movie_id JOIN name n ON an.person_id = n.id WHERE cc.subject_id = 1 AND cc.status_id IN (3, 4) AND n.gender = 'm' AND n.imdb_index IN ('V', 'VI', 'II') AND an.md5sum = 'f20a817147ce1df99c8e3b5614dbee2f' AND at.season_nr IN (28, 2, 5, 14, 37, 9) AND at.movie_id IN (1701837, 1248358, 1697981, 1674394, 1633043) GROUP BY at.title;
SELECT kt.kind AS movie_kind, COUNT(DISTINCT at.movie_id) AS total_movies, AVG(at.production_year) AS average_production_year, SUM(CASE WHEN at.note LIKE '%(working title)%' THEN 1 ELSE 0 END) AS total_working_titles, COUNT(DISTINCT mi_idx.movie_id) AS total_movies_with_additional_info, MAX(at.season_nr) AS max_season_number, MIN(at.episode_nr) AS min_episode_number FROM aka_title at JOIN kind_type kt ON at.kind_id = kt.id LEFT JOIN movie_info_idx mi_idx ON at.movie_id = mi_idx.movie_id WHERE kt.kind IN ('tv series', 'movie', 'tv mini series', 'video game', 'episode') AND at.production_year IS NOT NULL GROUP BY kt.kind ORDER BY total_movies DESC;
SELECT AVG(CAST(mi.info AS NUMERIC)) AS average_movie_length, SUM(CAST(mi_idx.info AS INTEGER)) AS total_votes, COUNT(DISTINCT cn.id) AS number_of_characters, MAX(cn.name) AS longest_character_name FROM movie_info mi JOIN movie_info_idx mi_idx ON mi.movie_id = mi_idx.movie_id AND mi.info_type_id = mi_idx.info_type_id JOIN char_name cn ON cn.id = mi.id WHERE mi.info_type_id = '4' AND mi_idx.info ~ '^\d+$' AND mi.movie_id IN ('8983', '18800', '19279', '12551') AND cn.name <> 'Clawed Stalker' GROUP BY mi.info_type_id;
SELECT kt.kind AS movie_kind, COUNT(DISTINCT ci.movie_id) AS number_of_movies, AVG(ci.nr_order) AS average_cast_order, SUM(CASE WHEN ci.nr_order IS NOT NULL THEN 1 ELSE 0 END) AS total_cast_positions_filled, COUNT(DISTINCT an.id) AS unique_aka_names, COUNT(DISTINCT chn.id) AS unique_character_names, AVG(mii.info::NUMERIC) AS average_movie_info_numeric_value FROM kind_type AS kt JOIN movie_info_idx AS mii ON kt.id = mii.info_type_id LEFT JOIN cast_info AS ci ON mii.movie_id = ci.movie_id LEFT JOIN aka_name AS an ON ci.person_id = an.person_id LEFT JOIN char_name AS chn ON ci.person_id = chn.imdb_id WHERE kt.id IN (1, 2, 4, 7) AND mii.info SIMILAR TO '(26|00..001212|1\.00101100|...0\.110\.6)%' AND ci.nr_order IN (20, 33, 65, 75, 87, 93) AND an.name_pcode_cf IN ('A42', 'W4526', 'F6165', 'S5152', 'A641', 'M2626') GROUP BY kt.kind ORDER BY number_of_movies DESC;
SELECT AVG(akat.production_year) AS average_production_year, COUNT(DISTINCT akat.movie_id) AS total_movies, CK.keyword, COUNT(DISTINCT chn.id) AS total_characters, SUM(CASE WHEN akat.kind_id = 1 THEN 1 ELSE 0 END) AS total_movies_kind_1, SUM(CASE WHEN akat.kind_id = 2 THEN 1 ELSE 0 END) AS total_movies_kind_2 FROM aka_title AS akat JOIN char_name AS chn ON akat.movie_id = chn.id JOIN keyword AS CK ON CK.id = akat.id WHERE akat.production_year BETWEEN 1990 AND 2020 AND CK.phonetic_code IN ('L165', 'M4236', 'B61') AND chn.surname_pcode IN ('D6452', 'A6245', 'V5612', 'C4532', 'O6252', 'P635') GROUP BY CK.keyword ORDER BY total_movies DESC, average_production_year DESC;
SELECT AVG(t.production_year) AS avg_production_year, COUNT(DISTINCT ci.company_id) AS number_of_companies, COUNT(DISTINCT mk.keyword_id) AS number_of_keywords, SUM(CASE WHEN mi.info = 'German' THEN 1 ELSE 0 END) AS german_movie_count FROM movie_info mi JOIN movie_companies ci ON mi.movie_id = ci.movie_id JOIN movie_keyword mk ON mi.movie_id = mk.movie_id JOIN title t ON mi.movie_id = t.id WHERE (mi.note LIKE '%(interviews)%' OR mi.note LIKE '%(Original Version)%' OR mi.note LIKE '%(only a few lines)%' OR mi.note LIKE '%(English subtitles)%') GROUP BY mi.movie_id;
SELECT ct.kind AS company_kind, COUNT(DISTINCT mc.movie_id) AS num_movies, COUNT(DISTINCT ci.person_id) AS num_people_involved, AVG(ci.nr_order) AS average_cast_order, SUM(CASE WHEN n.gender = 'M' THEN 1 ELSE 0 END) AS num_male_actors, SUM(CASE WHEN n.gender = 'F' THEN 1 ELSE 0 END) AS num_female_actors FROM movie_companies AS mc JOIN company_type AS ct ON mc.company_type_id = ct.id LEFT JOIN cast_info AS ci ON mc.movie_id = ci.movie_id LEFT JOIN name AS n ON ci.person_id = n.id WHERE ct.id IN (2, 3, 4) GROUP BY ct.kind
SELECT kt.kind AS movie_type, AVG(akat.production_year) AS average_production_year, SUM(CASE WHEN cn.country_code = 'US' THEN 1 ELSE 0 END) AS total_us_companies, COUNT(DISTINCT mk.keyword_id) AS unique_keywords, COUNT(DISTINCT akat.movie_id) AS total_movies FROM aka_title AS akat JOIN kind_type AS kt ON akat.kind_id = kt.id LEFT JOIN movie_companies AS mc ON akat.movie_id = mc.movie_id LEFT JOIN company_name AS cn ON mc.company_id = cn.id LEFT JOIN movie_keyword AS mk ON akat.movie_id = mk.movie_id WHERE akat.production_year IS NOT NULL AND mk.keyword_id = 2464 GROUP BY kt.kind ORDER BY average_production_year DESC, total_us_companies DESC;
SELECT lt.LINK AS link_type, COUNT(ml.id) AS total_links, AVG(n.imdb_id) AS average_imdb_id, MIN(n.name) AS first_alphabetical_actor_name, SUM(CASE WHEN n.gender = 'f' THEN 1 ELSE 0 END) AS total_actresses, SUM(CASE WHEN n.gender = 'm' THEN 1 ELSE 0 END) AS total_actors FROM movie_link AS ml JOIN link_type AS lt ON ml.link_type_id = lt.id JOIN name AS n ON n.id = ml.movie_id OR n.id = ml.linked_movie_id WHERE lt.id IN (8, 6, 13, 10, 16, 7) GROUP BY lt.LINK ORDER BY total_links DESC;
SELECT kt.kind AS movie_type, AVG(CASE WHEN n.gender = 'M' THEN 1 ELSE 0 END) AS avg_male_involvement, AVG(CASE WHEN n.gender = 'F' THEN 1 ELSE 0 END) AS avg_female_involvement, SUM(CASE WHEN at.production_year > 2000 THEN 1 ELSE 0 END) AS total_titles_after_2000, COUNT(DISTINCT n.id) AS total_unique_persons_involved, COUNT(DISTINCT pi.person_id) AS total_persons_with_extra_info FROM aka_title at JOIN kind_type kt ON at.kind_id = kt.id LEFT JOIN person_info pi ON at.id = pi.person_id LEFT JOIN name n ON pi.person_id = n.id WHERE kt.id IN (5, 7) AND n.imdb_index IN ('VII', 'VI', 'XIII') AND at.production_year IS NOT NULL GROUP BY kt.kind;
SELECT COUNT(DISTINCT cn.id) AS total_companies, AVG(t.production_year) AS average_production_year, SUM(CASE WHEN lt.id = '15' THEN 1 ELSE 0 END) AS count_type_15_links, SUM(CASE WHEN lt.id = '12' THEN 1 ELSE 0 END) AS count_type_12_links, COUNT(DISTINCT t.id) AS total_titles, COUNT(DISTINCT mi_idx.info) AS total_unique_info FROM company_name cn JOIN movie_companies mc ON cn.id = mc.company_id JOIN title t ON mc.movie_id = t.id JOIN movie_info_idx mi_idx ON t.id = mi_idx.movie_id LEFT JOIN movie_link ml ON t.id = ml.movie_id LEFT JOIN link_type lt ON ml.link_type_id = lt.id WHERE cn.country_code = 'US' AND t.production_year BETWEEN 1990 AND 2000 AND mc.note IS NOT NULL AND (lt.id = '15' OR lt.id = '12') GROUP BY cn.country_code, t.production_year ORDER BY average_production_year DESC;
SELECT cn.name AS company_name, kt.kind AS movie_kind, (t.production_year / 10) * 10 AS decade, COUNT(t.id) AS movie_count, AVG(t.imdb_id) AS average_imdb_id FROM company_name cn JOIN title t ON cn.imdb_id = t.imdb_id JOIN kind_type kt ON t.kind_id = kt.id WHERE cn.country_code = 'XX' AND t.production_year IS NOT NULL GROUP BY company_name, movie_kind, decade ORDER BY company_name, movie_kind, decade;
SELECT AVG(ak.production_year) AS average_production_year, COUNT(DISTINCT mc.movie_id) AS number_of_movies, MIN(ct.kind) AS company_type, SUM(CASE WHEN cc.status_id = 4 THEN 1 ELSE 0 END) AS complete_cast_status_count FROM aka_title AS ak JOIN movie_companies AS mc ON ak.movie_id = mc.movie_id JOIN company_type AS ct ON mc.company_type_id = ct.id JOIN complete_cast AS cc ON ak.movie_id = cc.movie_id JOIN movie_info AS mi ON ak.movie_id = mi.movie_id JOIN movie_info_idx AS mix ON ak.movie_id = mix.movie_id WHERE ak.kind_id <> 1 AND ak.production_year IS NOT NULL AND ak.episode_of_id IS NULL AND mi.info_type_id IN (SELECT id FROM movie_info_idx WHERE movie_id IN (19223, 6744, 12274, 12077, 18867, 19586)) AND cc.id IN (2679, 2075) AND mix.info ~ '^[A-Za-z ]+$' GROUP BY ct.kind;
