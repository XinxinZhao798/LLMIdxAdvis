SELECT kt.kind AS movie_kind, COUNT(distinct t.id) AS number_of_movies, AVG(t.production_year) AS average_production_year, SUM(CASE WHEN cct.kind = 'complete+verified' THEN 1 ELSE 0 END) AS total_complete_verified, SUM(CASE WHEN cct.kind = 'crew' THEN 1 ELSE 0 END) AS total_crew, SUM(CASE WHEN cct.kind = 'cast' THEN 1 ELSE 0 END) AS total_cast, COUNT(distinct mk.keyword_id) AS number_of_keywords FROM title t JOIN kind_type kt ON t.kind_id = kt.id LEFT JOIN comp_cast_type cct ON t.id = cct.id LEFT JOIN movie_keyword mk ON t.id = mk.movie_id WHERE kt.id IN (2, 6) AND kt.kind = 'video movie' AND cct.kind IN ('complete+verified', 'crew', 'cast') AND cct.id IN (2, 1, 4, 3) GROUP BY kt.kind ORDER BY number_of_movies DESC;
SELECT cn.country_code, kt.kind AS title_kind, t.production_year AS year_of_production, COUNT(DISTINCT t.id) AS total_titles, SUM(CASE WHEN n.gender = 'M' THEN 1 ELSE 0 END) AS male_names_count, SUM(CASE WHEN n.gender = 'F' THEN 1 ELSE 0 END) AS female_names_count FROM title t INNER JOIN kind_type kt ON t.kind_id = kt.id LEFT JOIN company_name cn ON t.id = cn.imdb_id LEFT JOIN name n ON t.id = n.imdb_id WHERE t.production_year IS NOT NULL AND (n.gender = 'M' OR n.gender = 'F') GROUP BY cn.country_code, kt.kind, t.production_year ORDER BY cn.country_code, total_titles DESC, t.production_year DESC;
SELECT cct.kind AS cast_type_kind, COUNT(DISTINCT mk.movie_id) AS number_of_movies, AVG(kt.id) AS average_kind_type_id, SUM(mk.keyword_id) AS total_keyword_id_sum FROM comp_cast_type cct JOIN movie_keyword mk ON cct.id = mk.movie_id JOIN kind_type kt ON mk.movie_id = kt.id WHERE cct.kind IN ('complete+verified', 'cast', 'crew', 'complete') AND mk.movie_id IN (13927, 7318, 9248, 15407) GROUP BY cct.kind ORDER BY number_of_movies DESC;
SELECT rt.ROLE, COUNT(DISTINCT ci.person_id) AS total_people, AVG(CASE WHEN pi.info_type_id = 3 THEN pi.info::NUMERIC ELSE NULL END) AS average_salary, COUNT(DISTINCT mi_idx.movie_id) AS total_movies, SUM(CASE WHEN pi.info LIKE '%(1980s)%' THEN 1 ELSE 0 END) AS eighties_count FROM cast_info ci JOIN role_type rt ON ci.role_id = rt.id LEFT JOIN person_info pi ON ci.person_id = pi.person_id LEFT JOIN name n ON ci.person_id = n.id LEFT JOIN movie_info_idx mi_idx ON ci.movie_id = mi_idx.movie_id AND mi_idx.info_type_id = 4 WHERE ci.note NOT LIKE '%(credit only)%' AND n.name_pcode_nf IN ('M2424', 'R5434', 'N6416', 'P5232', 'J2545', 'M6235') GROUP BY rt.ROLE ORDER BY total_people DESC;
SELECT kt.kind AS movie_kind, COUNT(DISTINCT at.id) AS total_titles, COUNT(DISTINCT al.id) AS total_links, AVG(at.production_year) AS average_production_year, SUM(CASE WHEN at.kind_id = kt.id AND kt.kind = 'movie' THEN 1 ELSE 0 END) AS total_movies, SUM(CASE WHEN at.kind_id = kt.id AND kt.kind = 'tv series' THEN 1 ELSE 0 END) AS total_tv_series FROM aka_title AS at JOIN kind_type AS kt ON at.kind_id = kt.id LEFT JOIN movie_link AS al ON at.movie_id = al.movie_id GROUP BY kt.kind ORDER BY total_titles DESC;
SELECT rt.ROLE, ct.kind, AVG(cast(chn.imdb_id as numeric)) AS avg_imdb_id, COUNT(chn.id) AS num_characters, SUM(chn.imdb_id) AS sum_imdb_id FROM char_name AS chn JOIN role_type AS rt ON chn.id = rt.id JOIN company_type AS ct ON rt.id = ct.id WHERE rt.ROLE = 'miscellaneous crew' AND ct.kind IN ('miscellaneous companies', 'special effects companies') GROUP BY rt.ROLE, ct.kind;
SELECT ct.kind AS company_type, AVG(mi_idx.info::NUMERIC) AS average_movie_rating, SUM(CASE WHEN cc.status_id = 4 THEN 1 ELSE 0 END) AS total_completed_movies, COUNT(DISTINCT k.id) AS number_of_unique_keywords, COUNT(DISTINCT mc.movie_id) AS number_of_movies_with_companies FROM movie_info mi JOIN movie_info_idx mi_idx ON mi.movie_id = mi_idx.movie_id AND mi.info_type_id = mi_idx.info_type_id JOIN movie_companies mc ON mi.movie_id = mc.movie_id JOIN company_type ct ON mc.company_type_id = ct.id JOIN complete_cast cc ON mc.movie_id = cc.movie_id JOIN keyword k ON mi.movie_id = k.id WHERE ct.id IN (3, 4) AND mc.company_id IN (202, 974) AND cc.status_id IN (3, 4) AND cc.subject_id = 1 AND mi.note LIKE '%(only a few lines)%' GROUP BY ct.kind;
SELECT cn.name AS company_name, cn.country_code AS company_country, COUNT(DISTINCT mi.movie_id) AS total_movies, AVG(CAST(mi.info AS numeric)) FILTER (WHERE it.info = 'rating') AS average_movie_rating, SUM(CAST(mi.info AS numeric)) FILTER (WHERE it.info = 'budget') AS total_budget, COUNT(DISTINCT k.id) AS total_unique_keywords FROM movie_info mi JOIN company_name cn ON cn.imdb_id = mi.movie_id JOIN keyword k ON k.id = mi.info_type_id JOIN movie_info it ON it.id = mi.info_type_id AND it.info IN ('rating', 'budget') WHERE cn.name IN ('Comedy Central', 'Odd Lot International', '20th Television') AND k.id IN ('7281', '7278', '9681', '1373', '9407', '1515') GROUP BY cn.name, cn.country_code ORDER BY total_movies DESC, average_movie_rating DESC;
SELECT mi_genre.info AS genre, COUNT(DISTINCT mi.movie_id) AS total_movies, AVG(cast_member_count) AS avg_cast_members_per_movie, SUM(company_count) AS total_companies_involved FROM movie_info mi_genre INNER JOIN movie_info mi ON mi.movie_id = mi_genre.movie_id AND mi_genre.info_type_id = 1 LEFT JOIN (SELECT movie_id, COUNT(DISTINCT person_id) AS cast_member_count FROM cast_info GROUP BY movie_id) AS ci_sub ON ci_sub.movie_id = mi.movie_id LEFT JOIN (SELECT movie_id, COUNT(DISTINCT company_id) AS company_count FROM movie_companies GROUP BY movie_id) AS mc_sub ON mc_sub.movie_id = mi.movie_id GROUP BY mi_genre.info ORDER BY total_movies DESC, avg_cast_members_per_movie DESC;
SELECT rt.ROLE AS role_type, COUNT(DISTINCT ci.person_id) AS total_actors, AVG(ci.nr_order) AS average_order, SUM(case when pi.info_type_id = 27 then 1 else 0 end) AS num_actors_with_biography, MIN(mi.info) AS earliest_movie_date, MAX(mi.info) AS latest_movie_date, COUNT(DISTINCT mi.movie_id) AS movie_count FROM cast_info ci JOIN role_type rt ON ci.role_id = rt.id LEFT JOIN person_info pi ON ci.person_id = pi.person_id AND pi.info_type_id = 27 JOIN movie_info mi ON ci.movie_id = mi.movie_id WHERE ci.role_id IN (SELECT id FROM role_type WHERE ROLE IN ('actor', 'actress')) AND mi.info_type_id = 3 GROUP BY rt.ROLE ORDER BY total_actors DESC, average_order;
SELECT MIN(t.title) AS movie_title, MIN(at.title) AS alternative_title, AVG(ci.nr_order) AS average_cast_order, COUNT(DISTINCT t.id) AS number_of_movies, COUNT(DISTINCT ci.person_id) AS number_of_unique_actors, SUM(CASE WHEN t.production_year BETWEEN 1970 AND 1980 THEN 1 ELSE 0 END) AS movies_produced_1970_to_1980, SUM(CASE WHEN t.production_year BETWEEN 1981 AND 1990 THEN 1 ELSE 0 END) AS movies_produced_1981_to_1990, SUM(CASE WHEN t.production_year BETWEEN 1991 AND 2000 THEN 1 ELSE 0 END) AS movies_produced_1991_to_2000 FROM title AS t INNER JOIN aka_title AS at ON t.id = at.movie_id AND at.kind_id IN (1, 3) INNER JOIN cast_info AS ci ON t.id = ci.movie_id WHERE t.production_year IN (1985, 1975, 1950, 1972) GROUP BY t.kind_id HAVING COUNT(DISTINCT ci.person_id) > 10 ORDER BY number_of_movies DESC, average_cast_order;
SELECT rt.ROLE, AVG(nk.count_keywords) AS average_keywords, COUNT(DISTINCT at.movie_id) AS number_of_movies, SUM(CASE WHEN at.production_year BETWEEN 2000 AND 2010 THEN 1 ELSE 0 END) AS movies_2000_to_2010, COUNT(DISTINCT n.id) AS number_of_names FROM role_type rt LEFT JOIN aka_title at ON rt.id = at.kind_id LEFT JOIN ( SELECT mk.movie_id, COUNT(mk.keyword_id) AS count_keywords FROM movie_keyword mk GROUP BY mk.movie_id ) nk ON nk.movie_id = at.movie_id LEFT JOIN name n ON n.id = at.movie_id WHERE rt.id IN (6, 7, 8) GROUP BY rt.ROLE ORDER BY average_keywords DESC;
SELECT mc.company_type_id, COUNT(DISTINCT mc.movie_id) AS num_movies, AVG(at.production_year) AS avg_production_year, COUNT(DISTINCT lt.id) AS num_link_types FROM movie_companies AS mc JOIN aka_title AS at ON mc.movie_id = at.movie_id JOIN link_type AS lt ON at.id = lt.id WHERE mc.company_type_id = 1 AND lt.link IN ('alternate language version of', 'featured in', 'edited into', 'edited from', 'spoofs', 'referenced in') GROUP BY mc.company_type_id;
SELECT cn.name AS character_name, COUNT(cn.id) AS character_occurrences, AVG(cn.imdb_id) AS average_imdb_id FROM char_name AS cn JOIN aka_name AS akn ON akn.person_id = cn.id JOIN company_type AS ct ON ct.id = akn.person_id WHERE ct.kind = 'distributors' GROUP BY cn.name ORDER BY character_occurrences DESC, average_imdb_id DESC;
SELECT cc.kind AS cast_kind, COUNT(DISTINCT ci.movie_id) AS number_of_movies, AVG(ci.nr_order) AS average_nr_order, COUNT(DISTINCT cn.id) AS number_of_companies, cn.country_code, SUM(CASE WHEN pi.info_type_id = 31 THEN 1 ELSE 0 END) AS count_of_info_type_31, MIN(pi.info) AS earliest_info FROM cast_info ci JOIN comp_cast_type cc ON ci.person_role_id = cc.id JOIN company_name cn ON cn.imdb_id = ci.movie_id JOIN person_info pi ON ci.person_id = pi.person_id WHERE ci.nr_order IS NOT NULL AND cn.country_code IN ('[xyu]', '[se]', '[my]') AND pi.info_type_id = 31 GROUP BY cc.kind, cn.country_code ORDER BY number_of_movies DESC;
SELECT rt.ROLE, COUNT(DISTINCT mi.movie_id) AS number_of_movies, AVG(CAST(mi_idx.info AS DOUBLE PRECISION)) AS average_rating, SUM(CASE WHEN mi.note IN ('(some dialogue)', '(only a few lines)', '(Original Version)', '(a few words)', '(a few lines)', '(English version)') THEN 1 ELSE 0 END) AS dialogue_mentions_count FROM movie_info_idx AS mi_idx JOIN movie_info AS mi ON mi_idx.movie_id = mi.movie_id JOIN person_info AS pi ON mi.movie_id = pi.info_type_id JOIN role_type AS rt ON pi.info_type_id = rt.id WHERE mi_idx.info_type_id = 3 AND mi.info_type_id IN (24, 36) AND rt.id IN ('8', '10', '3') AND rt.role IN ('costume designer', 'miscellaneous crew', 'writer', 'composer') GROUP BY rt.ROLE ORDER BY average_rating DESC, number_of_movies DESC;
SELECT t.title, COUNT(DISTINCT ci.person_id) AS total_cast_members, COUNT(DISTINCT k.id) AS number_of_keywords, AVG(t.production_year) AS average_production_year, SUM(CASE WHEN rt.id = 7 THEN 1 ELSE 0 END) AS number_of_actors, SUM(CASE WHEN rt.id = 9 THEN 1 ELSE 0 END) AS number_of_actresses, SUM(CASE WHEN rt.id = 4 THEN 1 ELSE 0 END) AS number_of_producers, SUM(CASE WHEN rt.id = 6 THEN 1 ELSE 0 END) AS number_of_directors FROM title AS t JOIN cast_info AS ci ON t.id = ci.movie_id JOIN role_type AS rt ON ci.role_id = rt.id JOIN movie_keyword AS mk ON t.id = mk.movie_id JOIN keyword AS k ON mk.keyword_id = k.id JOIN movie_companies AS mc ON t.id = mc.movie_id WHERE t.production_year > 1990 AND ci.role_id IN (7, 9, 4, 6) AND mc.company_type_id = 2 GROUP BY t.title HAVING COUNT(DISTINCT k.id) > 5 ORDER BY average_production_year DESC, total_cast_members DESC;
SELECT kt.kind AS movie_kind, rt.ROLE AS role_type, COUNT(DISTINCT ci.movie_id) AS total_movies, COUNT(DISTINCT ci.person_id) AS total_people, AVG(ci.nr_order) AS average_cast_position, SUM(CASE WHEN rt.ROLE = 'producer' THEN 1 ELSE 0 END) AS total_producers, SUM(CASE WHEN rt.ROLE = 'actor' THEN 1 ELSE 0 END) AS total_actors FROM cast_info ci JOIN role_type rt ON ci.role_id = rt.id JOIN kind_type kt ON kt.id = (SELECT id FROM kind_type WHERE id = ci.person_role_id) JOIN movie_companies mc ON mc.movie_id = ci.movie_id JOIN company_name cn ON cn.id = mc.company_id WHERE rt.id IN (4, 5) GROUP BY kt.kind, rt.ROLE ORDER BY total_movies DESC, average_cast_position ASC;
SELECT kt.kind AS movie_kind, COUNT(DISTINCT mi_idx.movie_id) AS total_movies, COUNT(DISTINCT mk.movie_id) AS total_movies_with_keywords, AVG(CAST(mi_idx.info AS NUMERIC)) AS average_info_num, SUM(CAST(CASE WHEN mi_idx.info LIKE '%1%' THEN 1 ELSE 0 END AS INTEGER)) AS count_info_with_1 FROM movie_info_idx mi_idx JOIN movie_keyword mk ON mi_idx.movie_id = mk.movie_id JOIN kind_type kt ON mi_idx.info_type_id = kt.id JOIN movie_link ml ON mi_idx.movie_id = ml.movie_id JOIN name n ON ml.movie_id = n.id WHERE n.md5sum IN ('801a5d533ecc2c88317db66319d4aad9', 'caa370cb4f3c3b62016775d613ce5575', '4fc8edf0bba0a30ce337c1c452a645f0') AND ml.linked_movie_id IN (1412141, 604005, 716090) AND mi_idx.info SIMILAR TO '%[0-9]%' AND mk.keyword_id IN ( SELECT id FROM keyword WHERE keyword IN ('wind-up-toy', 'money-in-title', 'suicide-pill') ) GROUP BY kt.kind ORDER BY total_movies_with_keywords DESC;
SELECT lt.LINK AS link_type, COUNT(DISTINCT ml.movie_id) AS number_of_movies, AVG(t.production_year) AS average_production_year, SUM(CASE WHEN n.gender = 'f' THEN 1 ELSE 0 END) AS female_cast_count, SUM(CASE WHEN n.gender = 'm' THEN 1 ELSE 0 END) AS male_cast_count FROM movie_link AS ml JOIN link_type AS lt ON ml.link_type_id = lt.id JOIN title AS t ON ml.movie_id = t.id JOIN movie_info_idx AS miidx ON miidx.movie_id = t.id JOIN info_type AS it ON miidx.info_type_id = it.id JOIN name AS n ON n.id = miidx.movie_id WHERE lt.id IN (13, 14, 8, 18, 4) AND ml.movie_id IN (10590, 11494) AND n.name_pcode_cf IN ('A4534', 'A31') GROUP BY lt.LINK ORDER BY number_of_movies DESC, average_production_year;
SELECT mc.company_type_id, COUNT(DISTINCT t.id) AS number_of_movies, SUM(CASE WHEN t.kind_id = 2 THEN 1 ELSE 0 END) AS total_series_movies, ROUND(AVG(t.production_year), 2) AS average_production_year, SUM(CASE WHEN rt.role = 'producer' THEN 1 ELSE 0 END) AS total_producer_roles FROM title t JOIN movie_companies mc ON mc.movie_id = t.id LEFT JOIN role_type rt ON rt.id = mc.company_type_id WHERE t.production_year > 2000 GROUP BY mc.company_type_id HAVING COUNT(DISTINCT t.id) > 0 ORDER BY number_of_movies DESC, total_series_movies DESC;
SELECT lt.LINK AS link_type, COUNT(DISTINCT ml.movie_id) AS number_of_movies, AVG(t.production_year) AS average_production_year, COUNT(DISTINCT t.episode_of_id) AS number_of_series, SUM(CASE WHEN t.season_nr IS NOT NULL THEN 1 ELSE 0 END) AS total_seasons_count, SUM(CASE WHEN t.production_year > 2000 THEN 1 ELSE 0 END) AS movies_since_2001 FROM movie_link AS ml JOIN link_type AS lt ON ml.link_type_id = lt.id JOIN title AS t ON ml.movie_id = t.id WHERE t.production_year BETWEEN 1980 AND 2023 AND lt.link IN ('remade as', 'edited from', 'referenced in') GROUP BY lt.LINK ORDER BY number_of_movies DESC;
SELECT ct.kind AS company_kind, COUNT(DISTINCT mc.movie_id) AS number_of_movies, COUNT(DISTINCT mc.company_id) AS number_of_companies, AVG(CASE WHEN kt.kind = 'movie' THEN 1 ELSE 0 END) * 100.0 AS percentage_movies, AVG(CASE WHEN kt.kind = 'tv movie' THEN 1 ELSE 0 END) * 100.0 AS percentage_tv_movies, AVG(CASE WHEN kt.kind = 'tv mini series' THEN 1 ELSE 0 END) * 100.0 AS percentage_tv_mini_series, AVG(CASE WHEN kt.kind = 'episode' THEN 1 ELSE 0 END) * 100.0 AS percentage_episodes FROM movie_companies AS mc JOIN company_type AS ct ON mc.company_type_id = ct.id JOIN kind_type AS kt ON mc.movie_id = kt.id GROUP BY ct.kind ORDER BY number_of_movies DESC;
SELECT AVG(t.production_year) AS average_production_year, COUNT(DISTINCT t.id) AS number_of_movies, cn.country_code, rt.ROLE, SUM(CASE WHEN t.kind_id = 1 THEN 1 ELSE 0 END) AS number_of_feature_films, SUM(CASE WHEN t.kind_id = 2 THEN 1 ELSE 0 END) AS number_of_short_films, COUNT(DISTINCT mc.company_id) AS number_of_companies_involved, COUNT(DISTINCT ml.link_type_id) AS number_of_unique_link_types FROM title AS t JOIN movie_companies AS mc ON t.id = mc.movie_id JOIN company_name AS cn ON mc.company_id = cn.id JOIN role_type AS rt ON mc.company_type_id = rt.id LEFT JOIN movie_link AS ml ON t.id = ml.movie_id WHERE t.production_year BETWEEN 1990 AND 2000 AND rt.id IN ('6', '8') AND mc.note LIKE '%(TV)%' GROUP BY cn.country_code, rt.ROLE ORDER BY average_production_year DESC, number_of_movies DESC;
