SELECT avg(CAST(mi_idx.info AS FLOAT)) AS average_rating, count(DISTINCT mk.keyword_id) AS number_of_keywords, count(DISTINCT an.id) AS number_of_aka_names FROM movie_info_idx AS mi_idx JOIN movie_keyword AS mk ON mi_idx.movie_id = mk.movie_id JOIN aka_name AS an ON an.person_id = mk.movie_id WHERE mi_idx.info_type_id IN (100, 101, 99) AND mk.movie_id IN (18864, 8952, 12152) AND an.surname_pcode IN ('M635', 'P14', 'A15', 'A263', 'D1', 'A261') GROUP BY mi_idx.movie_id;
SELECT ct.kind AS company_type, AVG(ak.production_year) AS average_production_year, COUNT(DISTINCT ak.movie_id) AS number_of_movies, COUNT(DISTINCT cc.subject_id) AS number_of_subjects, SUM(CASE WHEN n.gender = 'm' THEN 1 ELSE 0 END) AS male_actor_count, SUM(CASE WHEN n.gender = 'f' THEN 1 ELSE 0 END) AS female_actor_count, COUNT(DISTINCT k.id) AS number_of_unique_keywords FROM aka_title ak JOIN complete_cast cc ON ak.movie_id = cc.movie_id JOIN company_type ct ON ak.kind_id = ct.id JOIN keyword k ON ak.id = k.id JOIN name n ON ak.id = n.id WHERE ak.production_year BETWEEN 2000 AND 2010 AND n.md5sum IN ('660ea0ef9bdefafcda003d019848f703', '6d0c221bb93b310ab2904bdd75c8a442', 'a24f9431335b1461f14ac1933840f6cf', 'afaebb48a6577994f1924c5910d75467', 'e755250c050a467046983653e209cf90', '3978c1bc47a6deab5ab0956b3cb08ada') GROUP BY ct.kind;
SELECT t.kind_id, COUNT(t.id) AS title_count, AVG(t.production_year) AS avg_production_year, COUNT(DISTINCT it.id) AS info_type_count, COUNT(DISTINCT lt.id) AS link_type_count FROM title t LEFT JOIN info_type it ON it.id IN (69, 110, 74, 23, 112, 97) LEFT JOIN link_type lt ON lt.link = 'alternate language version of' WHERE t.kind_id IN (2, 7) GROUP BY t.kind_id ORDER BY t.kind_id;
SELECT it.info AS info_type, AVG(nm.imdb_id) AS average_imdb_id, COUNT(DISTINCT kw.id) AS unique_keywords_count, SUM(mc.company_id) AS total_company_id_sum, rt.ROLE AS role_type, COUNT(DISTINCT cc.movie_id) AS movies_count FROM info_type AS it JOIN movie_companies AS mc ON it.id = mc.company_type_id LEFT JOIN complete_cast AS cc ON mc.movie_id = cc.movie_id LEFT JOIN keyword AS kw ON mc.movie_id = kw.id LEFT JOIN name AS nm ON cc.subject_id = nm.id JOIN role_type AS rt ON cc.status_id = rt.id WHERE mc.company_type_id = '1' AND (nm.name_pcode_nf = 'B4645' OR nm.name_pcode_nf = 'B1436') AND (rt.ROLE = 'producer' OR rt.ROLE = 'actor') AND mc.movie_id IN ('1646081', '1699392', '1666532', '1678176', '1677967') GROUP BY it.info, rt.ROLE ORDER BY movies_count DESC, average_imdb_id;
SELECT t.production_year, COUNT(DISTINCT t.id) AS total_titles, AVG(t.production_year) AS avg_production_year, SUM(CASE WHEN k.keyword = 'medical-emergency' THEN 1 ELSE 0 END) AS count_medical_emergency, COUNT(DISTINCT cc.movie_id) AS total_movies_with_complete_cast, COUNT(DISTINCT char_name.name) AS total_character_names FROM title AS t LEFT JOIN keyword AS k ON t.phonetic_code = k.phonetic_code LEFT JOIN complete_cast AS cc ON t.id = cc.movie_id LEFT JOIN char_name ON char_name.surname_pcode = t.md5sum WHERE t.production_year BETWEEN 1990 AND 2000 AND cc.status_id IN (3, 4) AND (k.keyword = 'audi-rs5' OR k.keyword = 'second-chance' OR k.keyword = 'little-boy') GROUP BY t.production_year ORDER BY total_titles DESC;
SELECT ct.kind AS company_type, COUNT(DISTINCT mc.movie_id) AS number_of_movies, COUNT(DISTINCT mc.company_id) AS number_of_companies, AVG(CAST(pi.info AS NUMERIC)) FILTER (WHERE pi.info_type_id = 1) AS average_movie_budget, SUM(CAST(pi.info AS NUMERIC)) FILTER (WHERE pi.info_type_id = 2) AS total_box_office, COUNT(DISTINCT k.id) FILTER (WHERE k.keyword IN ('toy-car', 'personal-stories')) AS count_specific_keywords FROM movie_companies AS mc JOIN company_type AS ct ON mc.company_type_id = ct.id LEFT JOIN person_info AS pi ON mc.movie_id = pi.person_id AND pi.info_type_id IN (1, 2) LEFT JOIN keyword AS k ON k.id = pi.info_type_id JOIN comp_cast_type AS cct ON mc.company_id = cct.id WHERE mc.company_id IN (1232, 968) AND ct.id IN (2, 1, 4, 3) AND ct.kind = 'miscellaneous companies' AND cct.id IN (1, 2) GROUP BY ct.kind;
SELECT AVG(CAST(mi_idx.info AS FLOAT)) AS average_rating, COUNT(DISTINCT ci.movie_id) AS count_movies, COUNT(DISTINCT ci.person_id) AS count_actors, SUM(CASE WHEN ct.kind = 'producer' THEN 1 ELSE 0 END) AS count_producer_companies, SUM(CASE WHEN ct.kind = 'distributor' THEN 1 ELSE 0 END) AS count_distributor_companies, COUNT(DISTINCT mk.keyword_id) AS count_unique_keywords FROM movie_info_idx mi_idx JOIN cast_info ci ON mi_idx.movie_id = ci.movie_id JOIN movie_keyword mk ON ci.movie_id = mk.movie_id JOIN company_type ct ON ct.id = ci.role_id WHERE mi_idx.info_type_id = 1 AND ci.person_role_id IS NOT NULL AND ct.id IN (1, 4, 2) GROUP BY ct.kind;
SELECT ct.kind AS company_type, AVG(CAST(mi_idx.info AS NUMERIC)) AS average_rating, COUNT(DISTINCT mc.movie_id) AS number_of_movies FROM movie_companies AS mc INNER JOIN company_type AS ct ON mc.company_type_id = ct.id INNER JOIN movie_info_idx AS mi_idx ON mc.movie_id = mi_idx.movie_id WHERE mi_idx.info_type_id = (SELECT id FROM info_type WHERE info = 'rating') AND mi_idx.note IS DISTINCT FROM '1' GROUP BY ct.kind HAVING COUNT(DISTINCT mc.movie_id) > 10 ORDER BY average_rating DESC;
SELECT kt.kind AS movie_kind, AVG(akat.production_year) AS average_production_year, COUNT(DISTINCT akat.movie_id) AS total_movies, SUM(CASE WHEN k.keyword IN ('intelligence-agency', 'armed-forces') THEN 1 ELSE 0 END) AS military_related_movies, COUNT(DISTINCT CASE WHEN k.keyword = 'monster-in-the-closet' THEN akat.movie_id END) AS monster_in_the_closet_movies FROM aka_title AS akat JOIN kind_type AS kt ON akat.kind_id = kt.id LEFT JOIN keyword AS k ON akat.movie_id = k.id GROUP BY kt.kind ORDER BY total_movies DESC;
SELECT cct.kind AS cast_type_kind, COUNT(DISTINCT mk.movie_id) AS number_of_movies, AVG(kt.id) AS average_kind_type_id, SUM(mk.keyword_id) AS total_keyword_id_sum FROM comp_cast_type cct JOIN movie_keyword mk ON cct.id = mk.movie_id JOIN kind_type kt ON mk.movie_id = kt.id WHERE cct.kind IN ('complete+verified', 'cast', 'crew', 'complete') AND mk.movie_id IN (13927, 7318, 9248, 15407) GROUP BY cct.kind ORDER BY number_of_movies DESC;
SELECT cn.country_code, k.keyword, COUNT(DISTINCT mc.movie_id) AS num_movies, AVG(CAST(NULLIF(REGEXP_REPLACE(mi_duration.info, '[^\d.]', '', 'g'), '') AS NUMERIC)) AS average_movie_duration, SUM(CASE WHEN mi_release.info_type_id = 4 THEN 1 ELSE 0 END) AS count_movie_releases FROM company_name AS cn JOIN movie_companies AS mc ON cn.id = mc.company_id JOIN movie_keyword AS mk ON mc.movie_id = mk.movie_id JOIN keyword AS k ON mk.keyword_id = k.id LEFT JOIN movie_info AS mi_release ON mc.movie_id = mi_release.movie_id AND mi_release.info_type_id = 4 LEFT JOIN movie_info AS mi_duration ON mc.movie_id = mi_duration.movie_id AND mi_duration.info_type_id = 3 WHERE k.keyword IN ('dead-mother', 'manipulation') AND mi_release.note IN ('(some dialogue)', '(none)', '(only a few lines)', '(a few lines)', '(a few words)') GROUP BY cn.country_code, k.keyword ORDER BY cn.country_code, k.keyword;
SELECT ct.kind AS company_type, AVG(t.production_year) AS average_production_year, COUNT(DISTINCT mk.keyword_id) AS unique_keyword_count, SUM(CASE WHEN an.name_pcode_cf LIKE 'A%' THEN 1 ELSE 0 END) AS names_starting_with_a, COUNT(DISTINCT an.person_id) AS total_actors_with_alternate_names FROM title AS t JOIN movie_keyword AS mk ON t.id = mk.movie_id JOIN aka_name AS an ON an.person_id = t.id JOIN company_type AS ct ON ct.id = t.kind_id WHERE t.production_year > 2000 AND mk.keyword_id IN (4192, 3543, 917, 3554) AND an.name_pcode_cf IN ('K365', 'J262', 'C4625', 'A1526') GROUP BY ct.kind ORDER BY average_production_year DESC;
SELECT AVG(ak.production_year) AS average_production_year, COUNT(DISTINCT ak.title) AS unique_titles_count, COUNT(DISTINCT cn.name) AS unique_character_names, COUNT(DISTINCT mk.keyword_id) AS total_keywords_used, COUNT(DISTINCT cc.id) AS complete_cast_records, SUM(CASE WHEN ak.kind_id = 1 THEN 1 ELSE 0 END) AS feature_film_count FROM aka_title ak JOIN movie_keyword mk ON ak.movie_id = mk.movie_id JOIN char_name cn ON ak.movie_id = cn.id JOIN complete_cast cc ON ak.movie_id = cc.movie_id WHERE mk.keyword_id IN ('4162', '3164', '2594', '2742', '2189') AND ak.movie_id IN ('8850', '8984') GROUP BY ak.movie_id;
SELECT kt.kind AS movie_type, AVG(mi_idx.info::numeric) AS average_rating, COUNT(DISTINCT mk.movie_id) AS movie_count, COUNT(DISTINCT cn.id) AS company_count, COUNT(DISTINCT n.id) AS actor_count FROM movie_info mi JOIN kind_type kt ON mi.movie_id = kt.id JOIN movie_info_idx mi_idx ON mi.movie_id = mi_idx.movie_id JOIN movie_keyword mk ON mi.movie_id = mk.movie_id JOIN company_name cn ON mi.movie_id = cn.imdb_id JOIN cast_info ci ON ci.movie_id = mi.movie_id JOIN name n ON ci.person_id = n.id WHERE kt.id IN ('7', '1', '4') AND cn.name_pcode_sf IN ('F2365', 'Z3132', 'Y6253', 'F4231') AND mk.keyword_id IN ('3887', '4275', '3550', '4202') AND mi_idx.info_type_id = (SELECT id FROM info_type WHERE info = 'rating') AND ci.role_id = (SELECT id FROM role_type WHERE role = 'actor') GROUP BY kt.kind;
SELECT ct.kind AS company_kind, it.info AS info_category, AVG(t.production_year) AS average_production_year, COUNT(t.id) AS total_titles, SUM(CASE WHEN p.info = 'Adams, Terry Wayne' THEN 1 ELSE 0 END) AS count_terry_wayne_adams_mentions, SUM(CASE WHEN p.info = '14 March 1879' THEN 1 ELSE 0 END) AS count_14_march_1879_mentions FROM title AS t JOIN company_type AS ct ON t.kind_id = ct.id JOIN person_info AS p ON p.info_type_id = ct.id JOIN info_type AS it ON p.info_type_id = it.id WHERE t.production_year BETWEEN 1990 AND 2020 GROUP BY ct.kind, it.info HAVING COUNT(t.id) > 10;
SELECT COUNT(DISTINCT t.id) AS total_movies, AVG(t.production_year) AS avg_production_year, COUNT(DISTINCT ci.person_id) AS total_actors, SUM(CASE WHEN cn.country_code = 'US' THEN 1 ELSE 0 END) AS total_us_companies, MAX(mii.info) AS max_info_value FROM title AS t JOIN cast_info AS ci ON t.id = ci.movie_id JOIN company_name AS cn ON cn.imdb_id = t.imdb_id JOIN movie_info_idx AS mii ON t.id = mii.movie_id WHERE t.kind_id = 1 AND t.production_year >= 2000 AND cn.name IN ('Action Video', 'Cresa Roma', 'Time Life Films', 'Starlink Asia', 'New Cinema', 'Rok Americas') AND ci.role_id = 1 GROUP BY t.kind_id ORDER BY total_movies DESC, avg_production_year DESC;
SELECT t.title, kt.kind, COUNT(DISTINCT cn.id) AS total_characters, COUNT(DISTINCT comp_n.id) AS total_companies, AVG(t.production_year) AS average_production_year, MAX(it.info) AS most_frequent_info FROM title t JOIN kind_type kt ON t.kind_id = kt.id LEFT JOIN movie_info_idx mii ON t.id = mii.movie_id LEFT JOIN info_type it ON mii.info_type_id = it.id LEFT JOIN char_name cn ON t.id = cn.id LEFT JOIN company_name comp_n ON t.id = comp_n.id GROUP BY t.title, kt.kind ORDER BY total_characters DESC, total_companies DESC;
SELECT ct.kind AS company_kind, COUNT(*) AS total_movies, AVG(cc.status_id) AS average_status_id, SUM(case when cc.subject_id = 1 then 1 else 0 end) AS subject_1_movie_count, COUNT(DISTINCT k.id) AS unique_keywords_count FROM complete_cast AS cc JOIN company_name AS cn ON cc.movie_id = cn.imdb_id JOIN company_type AS ct ON cn.id = ct.id JOIN movie_keyword AS mk ON cc.movie_id = mk.movie_id JOIN keyword AS k ON mk.keyword_id = k.id WHERE cc.status_id = 3 AND cc.subject_id = 1 AND cn.country_code SIMILAR TO '(\[ae\]|\[hu\]|\[tj\]|\[cu\]|\[is\])' AND k.id IN (9868, 4714, 290, 4495, 1113) GROUP BY ct.kind;
SELECT AVG(ak.title_count) AS average_title_count, MAX(ak.max_production_year) AS latest_production_year, MIN(ak.min_production_year) AS earliest_production_year, SUM(ak.title_count) AS total_titles, COUNT(DISTINCT ki.id) AS total_unique_keywords, COUNT(DISTINCT pi.person_id) AS total_unique_persons FROM (SELECT at.movie_id, COUNT(at.id) AS title_count, MAX(at.production_year) AS max_production_year, MIN(at.production_year) AS min_production_year FROM aka_title at GROUP BY at.movie_id ) ak LEFT JOIN movie_keyword mk ON mk.movie_id = ak.movie_id LEFT JOIN keyword ki ON ki.id = mk.keyword_id AND ki.keyword IN ('vampire-hunter', 'training', 'newspaper-editor', 'multiple-views', 'historical-fiction', 'forbidden-love') LEFT JOIN movie_info_idx mi ON mi.movie_id = ak.movie_id LEFT JOIN person_info pi ON pi.info_type_id = mi.info_type_id GROUP BY ki.keyword;
SELECT it.info AS genre, COUNT(mi.movie_id) AS number_of_movies, AVG(LENGTH(mi.info)) AS average_info_length, SUM(CASE WHEN an.name_pcode_cf IN ('A5143', 'F2162', 'B362', 'M2462') THEN 1 ELSE 0 END) AS count_actors_with_pcode FROM movie_info mi JOIN info_type it ON mi.info_type_id = it.id LEFT JOIN aka_name an ON an.person_id = mi.movie_id WHERE it.id = 40 AND mi.info IN ('Tagalog', 'Persian') GROUP BY it.info;
SELECT AVG(mc.movie_id) AS average_movie_id, COUNT(DISTINCT mc.company_id) AS total_companies, COUNT(DISTINCT mc.company_type_id) AS total_company_types, kt.link AS link_type_description, COUNT(DISTINCT k.id) FILTER (WHERE k.phonetic_code = 'C5242') AS count_keywords_c5242, COUNT(DISTINCT k.id) FILTER (WHERE k.phonetic_code = 'V352') AS count_keywords_v352, COUNT(DISTINCT n.id) FILTER (WHERE n.gender = 'M') AS count_male_names, COUNT(DISTINCT n.id) FILTER (WHERE n.gender = 'F') AS count_female_names, AVG(n.imdb_id) AS average_imdb_id FROM movie_companies mc JOIN link_type kt ON mc.company_type_id = kt.id JOIN keyword k ON k.id = mc.id JOIN name n ON n.id = mc.id WHERE kt.link IN ('remake of', 'references') GROUP BY kt.link;
SELECT ct.kind AS company_kind, COUNT(DISTINCT mi.movie_id) AS number_of_movies, AVG(nm.imdb_id) AS average_imdb_id, SUM(CASE WHEN nm.gender = 'f' THEN 1 ELSE 0 END) AS female_count, SUM(CASE WHEN nm.gender = 'm' THEN 1 ELSE 0 END) AS male_count FROM company_type ct JOIN movie_info mi ON ct.id = mi.info_type_id JOIN name nm ON mi.movie_id = nm.id WHERE ct.kind IN ('special effects companies', 'distributors', 'production companies') GROUP BY ct.kind ORDER BY number_of_movies DESC;
SELECT ct.kind AS company_kind, COUNT(DISTINCT t.id) AS number_of_movies, AVG(t.production_year) AS average_production_year, COUNT(DISTINCT cc.subject_id) AS number_of_subjects, SUM(CASE WHEN t.kind_id = 1 THEN 1 ELSE 0 END) AS number_of_feature_films, SUM(CASE WHEN t.kind_id = 2 THEN 1 ELSE 0 END) AS number_of_tv_shows, SUM(CASE WHEN t.kind_id = 4 THEN 1 ELSE 0 END) AS number_of_documentaries FROM title t JOIN complete_cast cc ON t.id = cc.movie_id JOIN company_type ct ON t.kind_id = ct.id GROUP BY ct.kind ORDER BY number_of_movies DESC;
