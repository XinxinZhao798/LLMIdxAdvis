SELECT AVG(m.production_year) AS average_production_year, COUNT(DISTINCT mc.company_id) AS number_of_companies_involved, COUNT(DISTINCT k.id) AS number_of_unique_keywords, COUNT(DISTINCT n.id) AS number_of_persons FROM title AS m LEFT JOIN movie_companies AS mc ON mc.movie_id = m.id LEFT JOIN movie_info AS mi ON mi.movie_id = m.id AND mi.info_type_id = 6 LEFT JOIN keyword AS k ON k.id = mi.info_type_id LEFT JOIN name AS n ON n.id = mi.movie_id GROUP BY m.kind_id HAVING COUNT(DISTINCT mc.company_id) > 1 ORDER BY average_production_year DESC;
SELECT n.gender, count(DISTINCT n.id) AS number_of_actors, avg(ci.nr_order) AS average_cast_order, sum(CASE WHEN ci.role_id = 1 THEN 1 ELSE 0 END) AS number_of_leading_roles, count(DISTINCT k.id) AS number_of_unique_keywords, it.info AS info_type, count(DISTINCT ci.movie_id) AS number_of_movies FROM cast_info ci JOIN name n ON ci.person_id = n.id JOIN keyword k ON k.phonetic_code = ci.note JOIN info_type it ON ci.person_role_id = it.id WHERE ci.role_id = 1 AND ci.nr_order IN (101, 69) AND n.gender = 'm' AND it.info IN ('essays', 'LD sharpness', 'bottom 10 rank', 'soundtrack', 'magazine cover photo', 'LD color information') GROUP BY n.gender, it.info ORDER BY number_of_actors DESC;
SELECT cn.name AS company_name, COUNT(DISTINCT n.id) AS number_of_employees, AVG(pi.info::numeric) FILTER (WHERE it.info = 'salary') AS average_salary, SUM(pi.info::numeric) FILTER (WHERE it.info = 'bonus') AS total_bonus_paid, COUNT(pi.info) FILTER (WHERE it.info = 'position' AND pi.info = 'Director') AS number_of_directors FROM company_name AS cn JOIN person_info AS pi ON cn.id = pi.person_id JOIN name AS n ON n.id = pi.person_id JOIN info_type AS it ON it.id = pi.info_type_id WHERE cn.country_code = 'US' AND n.gender = 'f' AND cn.id IN ('17965', '11842') AND cn.name_pcode_nf IN ('T545', 'V2123', 'R4521', 'U5164', 'V6323', 'A2531') GROUP BY cn.name;
SELECT kt.kind AS movie_kind, COUNT(DISTINCT ci.movie_id) AS num_movies, COUNT(DISTINCT ci.person_id) AS num_people_involved, AVG(ci.nr_order) AS avg_cast_order, SUM(case when mi_idx.info_type_id = '100' THEN 1 ELSE 0 END) AS count_type_100, SUM(case when mi_idx.info_type_id = '101' THEN 1 ELSE 0 END) AS count_type_101, SUM(case when mi_idx.info_type_id = '99' THEN 1 ELSE 0 END) AS count_type_99 FROM cast_info ci JOIN kind_type kt ON ci.role_id = kt.id JOIN movie_info_idx mi_idx ON ci.movie_id = mi_idx.movie_id WHERE mi_idx.info_type_id IN ('100', '101', '99') AND ci.person_role_id = (SELECT id FROM info_type WHERE id = '94') GROUP BY kt.kind;
SELECT k.kind AS movie_genre, COUNT(DISTINCT c.person_id) AS number_of_actors, AVG(c.nr_order) AS average_cast_position, SUM(CASE WHEN t.production_year >= 2000 THEN 1 ELSE 0 END) AS movies_from_2000_onwards, MAX(t.title) AS latest_movie_title, MAX(t.production_year) AS latest_production_year FROM cast_info AS c JOIN title AS t ON c.movie_id = t.id JOIN kind_type AS k ON t.kind_id = k.id WHERE k.id = 7 GROUP BY k.kind ORDER BY number_of_actors DESC, average_cast_position, movies_from_2000_onwards DESC;
SELECT COUNT(DISTINCT ci.person_id) AS total_actors, SUM(CASE WHEN ct.kind = 'production' THEN 1 ELSE 0 END) AS production_companies_count, AVG(t.production_year) AS average_production_year, MIN(t.title) AS oldest_movie_title, MAX(t.title) AS latest_movie_title, COUNT(DISTINCT mi.movie_id) AS total_movies_with_info FROM title t LEFT JOIN cast_info ci ON t.id = ci.movie_id LEFT JOIN movie_info mi ON t.id = mi.movie_id LEFT JOIN movie_companies mc ON t.id = mc.movie_id LEFT JOIN company_type ct ON mc.company_type_id = ct.id WHERE t.title = 'Vengence' AND t.production_year >= 2000 AND (t.episode_nr IN ('119', '9622', '13530', '255', '26') OR t.episode_nr IS NULL) GROUP BY t.production_year ORDER BY t.production_year ASC;
SELECT lt.LINK AS link_type, COUNT(DISTINCT ml.movie_id) AS number_of_movies, COUNT(DISTINCT ml.linked_movie_id) AS number_of_linked_movies, SUM(CASE WHEN ml.link_type_id = 1 THEN 1 ELSE 0 END) AS number_of_type_1_links, SUM(CASE WHEN ml.link_type_id = 17 THEN 1 ELSE 0 END) AS number_of_type_17_links, AVG(ml.id) AS average_movie_link_id FROM movie_link AS ml JOIN link_type AS lt ON ml.link_type_id = lt.id JOIN keyword AS k ON k.id = ml.movie_id WHERE ml.link_type_id IN (1, 17) AND ml.linked_movie_id = 2302013 AND k.phonetic_code IN ('L2315', 'A3132') GROUP BY lt.LINK ORDER BY number_of_movies DESC;
SELECT rt.ROLE, COUNT(mc.movie_id) AS number_of_movies, AVG(alt.production_year) AS average_production_year, SUM(CASE WHEN lt.LINK = 'sequel' THEN 1 ELSE 0 END) AS sequel_count, COUNT(DISTINCT mc.company_id) AS distinct_companies_involved FROM aka_title alt INNER JOIN movie_companies mc ON alt.movie_id = mc.movie_id INNER JOIN link_type lt ON lt.id = alt.kind_id INNER JOIN role_type rt ON rt.id = mc.company_type_id WHERE rt.id IN ('1', '8') GROUP BY rt.ROLE ORDER BY number_of_movies DESC;
SELECT it.info AS info_type, COUNT(mi.id) AS total_movie_info_entries, AVG(LENGTH(mi.info)) AS average_info_length, SUM(CASE WHEN mi.note IS NOT NULL THEN 1 ELSE 0 END) AS count_with_notes FROM movie_info mi JOIN info_type it ON mi.info_type_id = it.id JOIN keyword k ON k.id = ANY(ARRAY[8402, 763, 4258, 5648]) WHERE it.id IN (16, 97, 31, 104, 71) GROUP BY it.info ORDER BY total_movie_info_entries DESC, average_info_length DESC;
SELECT ct.kind AS company_kind, it.info AS info_category, AVG(t.production_year) AS average_production_year, COUNT(t.id) AS total_titles, SUM(CASE WHEN p.info = 'Adams, Terry Wayne' THEN 1 ELSE 0 END) AS count_terry_wayne_adams_mentions, SUM(CASE WHEN p.info = '14 March 1879' THEN 1 ELSE 0 END) AS count_14_march_1879_mentions FROM title AS t JOIN company_type AS ct ON t.kind_id = ct.id JOIN person_info AS p ON p.info_type_id = ct.id JOIN info_type AS it ON p.info_type_id = it.id WHERE t.production_year BETWEEN 1990 AND 2020 GROUP BY ct.kind, it.info HAVING COUNT(t.id) > 10;
SELECT COUNT(DISTINCT at.id) AS num_alternate_titles, AVG(at.production_year) AS average_production_year, SUM(CASE WHEN mc.company_type_id = 9 THEN 1 ELSE 0 END) AS num_producer_companies, rt.ROLE AS role_type, COUNT(DISTINCT an.id) AS num_people_with_alternate_names FROM aka_title at JOIN movie_companies mc ON at.movie_id = mc.movie_id JOIN complete_cast compl_cast ON mc.movie_id = compl_cast.movie_id JOIN role_type rt ON compl_cast.subject_id = rt.id LEFT JOIN aka_name an ON an.person_id = compl_cast.subject_id WHERE mc.movie_id IN ('28519', '17394', '23681', '8931') AND an.md5sum IN ('0f9068a7f5499ebd1078fd242aa8d403', 'e4e7deb17d9499fb2031dfcbe39a2884', '19133574cb176a198fc5d24c24352d61', '86ce7e5bfe4997de75b05c21865ca40d', 'c42897449a530ff6921dbfdd466254ca') AND rt.id IN ('9', '2', '12', '6', '10') GROUP BY rt.ROLE ORDER BY num_producer_companies DESC, num_people_with_alternate_names DESC;
SELECT mc.company_type_id, COUNT(DISTINCT mc.movie_id) AS num_movies, AVG(at.production_year) AS avg_production_year, COUNT(DISTINCT lt.id) AS num_link_types FROM movie_companies AS mc JOIN aka_title AS at ON mc.movie_id = at.movie_id JOIN link_type AS lt ON at.id = lt.id WHERE mc.company_type_id = 1 AND lt.link IN ('alternate language version of', 'featured in', 'edited into', 'edited from', 'spoofs', 'referenced in') GROUP BY mc.company_type_id;
SELECT ml.movie_id, lt.LINK AS link_type, COUNT(ml.id) AS total_links, AVG(cn.imdb_id) AS avg_company_imdb_id FROM movie_link AS ml JOIN link_type AS lt ON ml.link_type_id = lt.id JOIN company_name AS cn ON ml.movie_id = cn.id GROUP BY ml.movie_id, lt.LINK ORDER BY total_links DESC, avg_company_imdb_id DESC;
SELECT c.name AS company_name, p.gender, COUNT(*) AS number_of_employees, AVG(pi.info_type_id) AS average_info_type_id, SUM(mi.movie_id) AS total_movie_id_sum, COUNT(DISTINCT k.id) AS unique_keyword_count FROM company_name AS c JOIN movie_info_idx AS mi ON c.imdb_id = mi.movie_id JOIN person_info AS pi ON mi.movie_id = pi.person_id JOIN name AS p ON pi.person_id = p.id JOIN keyword AS k ON mi.info LIKE '%' || k.keyword || '%' WHERE c.name_pcode_nf IN ('E2153', 'C5125', 'M2643', 'C2425') AND c.name_pcode_sf IN ('V3252', 'C1212', 'I2416', 'T6215', 'U5163') AND mi.info_type_id IN ('100', '101', '99') GROUP BY c.name, p.gender ORDER BY number_of_employees DESC, average_info_type_id;
SELECT AVG(keyword_count) AS average_keywords_per_movie, COUNT(DISTINCT complete_verified_movie_id) AS total_movies_with_complete_verified_cast, COUNT(DISTINCT mk.keyword_id) AS distinct_keywords_used FROM ( SELECT mk.movie_id AS complete_verified_movie_id, COUNT(mk.keyword_id) AS keyword_count FROM movie_keyword AS mk INNER JOIN complete_cast AS cc ON mk.movie_id = cc.movie_id INNER JOIN comp_cast_type AS cct ON cc.status_id = cct.id WHERE cct.kind = 'complete+verified' GROUP BY mk.movie_id ) AS subquery JOIN movie_keyword AS mk ON subquery.complete_verified_movie_id = mk.movie_id JOIN movie_info_idx AS mii ON mk.movie_id = mii.movie_id JOIN info_type AS it ON mii.info_type_id = it.id WHERE it.info = 'release dates' AND mii.info LIKE 'USA:%20%' AND SUBSTRING(mii.info FROM 'USA:%(\\d+)%')::INTEGER > 2000;
SELECT t.production_year, COUNT(DISTINCT mk.movie_id) AS number_of_movies_with_keywords, COUNT(DISTINCT mc.company_id) AS number_of_companies_involved, AVG(mi.info::numeric) AS average_movie_info, SUM(CASE WHEN k.phonetic_code = 'V6413' THEN 1 ELSE 0 END) AS count_of_keyword_V6413, MAX(t.title) AS latest_movie_title FROM title t LEFT JOIN movie_keyword mk ON t.id = mk.movie_id LEFT JOIN keyword k ON mk.keyword_id = k.id LEFT JOIN movie_companies mc ON t.id = mc.movie_id LEFT JOIN movie_info_idx mi ON t.id = mi.movie_id AND mi.info_type_id = 1 WHERE t.production_year BETWEEN 1990 AND 2000 AND t.kind_id = 1 AND (k.phonetic_code IN ('V6413', 'V632', 'M61', 'F5326', 'U1263', 'L261') OR k.phonetic_code IS NULL) GROUP BY t.production_year ORDER BY t.production_year DESC;
SELECT kt.kind, AVG(CAST(mi.info AS NUMERIC)) AS average_rating, COUNT(DISTINCT n.id) AS total_actors, COUNT(DISTINCT k.id) AS total_keywords, COUNT(DISTINCT mc.movie_id) AS total_movies, MIN(mi.info) AS lowest_rating, MAX(mi.info) AS highest_rating FROM movie_companies AS mc JOIN kind_type AS kt ON mc.company_type_id = kt.id JOIN movie_companies AS mc2 ON mc2.movie_id = mc.movie_id JOIN person_info AS mi ON mi.person_id = mc2.company_id AND mi.info_type_id = 101 /* Assuming 101 is the type_id for ratings */ JOIN movie_keyword AS mk ON mk.movie_id = mc.movie_id JOIN keyword AS k ON k.id = mk.keyword_id JOIN cast_info AS ci ON ci.movie_id = mc.movie_id JOIN name AS n ON n.id = ci.person_id WHERE kt.kind = 'production' AND mc.note IS NOT NULL AND mi.info SIMILAR TO '[0-9]+(\.[0-9]+)?' AND mi.info > '0' GROUP BY kt.kind
SELECT t.title, COUNT(DISTINCT ci.person_id) AS total_cast_members, COUNT(DISTINCT k.id) AS number_of_keywords, AVG(t.production_year) AS average_production_year, SUM(CASE WHEN rt.id = 7 THEN 1 ELSE 0 END) AS number_of_actors, SUM(CASE WHEN rt.id = 9 THEN 1 ELSE 0 END) AS number_of_actresses, SUM(CASE WHEN rt.id = 4 THEN 1 ELSE 0 END) AS number_of_producers, SUM(CASE WHEN rt.id = 6 THEN 1 ELSE 0 END) AS number_of_directors FROM title AS t JOIN cast_info AS ci ON t.id = ci.movie_id JOIN role_type AS rt ON ci.role_id = rt.id JOIN movie_keyword AS mk ON t.id = mk.movie_id JOIN keyword AS k ON mk.keyword_id = k.id JOIN movie_companies AS mc ON t.id = mc.movie_id WHERE t.production_year > 1990 AND ci.role_id IN (7, 9, 4, 6) AND mc.company_type_id = 2 GROUP BY t.title HAVING COUNT(DISTINCT k.id) > 5 ORDER BY average_production_year DESC, total_cast_members DESC;
SELECT COUNT(DISTINCT t.id) AS total_movies, AVG(mi_idx.info::NUMERIC) AS average_rating, SUM(CASE WHEN t.kind_id = 1 THEN 1 ELSE 0 END) AS total_feature_films, SUM(CASE WHEN t.kind_id = 2 THEN 1 ELSE 0 END) AS total_tv_shows, COUNT(DISTINCT ci.person_id) AS total_actors, MAX(t.production_year) AS latest_production_year, MIN(t.production_year) AS oldest_production_year FROM title AS t LEFT JOIN movie_info_idx AS mi_idx ON t.id = mi_idx.movie_id AND mi_idx.info_type_id = 100 LEFT JOIN cast_info AS ci ON t.id = ci.movie_id LEFT JOIN comp_cast_type AS cct ON ci.role_id = cct.id WHERE t.production_year BETWEEN 1990 AND 2020 AND (t.imdb_index = 'V' OR t.imdb_index = 'I' OR t.imdb_index = 'II') AND ci.note IS NOT NULL AND mi_idx.note IS NOT NULL GROUP BY t.kind_id ORDER BY total_movies DESC;
SELECT cn.country_code, cc.status_id, COUNT(DISTINCT cn.id) AS number_of_companies, COUNT(DISTINCT cc.movie_id) AS number_of_movies, AVG(cn.imdb_id) AS average_imdb_id, STRING_AGG(DISTINCT it.info, '; ') AS associated_info_types FROM company_name AS cn JOIN complete_cast AS cc ON cn.id = cc.subject_id JOIN info_type AS it ON cc.status_id = it.id WHERE cc.status_id IN (3, 4) AND it.id IN (14, 61) GROUP BY cn.country_code, cc.status_id ORDER BY number_of_movies DESC;
SELECT cn.name AS character_name, COUNT(cn.id) AS character_occurrences, AVG(cn.imdb_id) AS average_imdb_id FROM char_name AS cn JOIN aka_name AS akn ON akn.person_id = cn.id JOIN company_type AS ct ON ct.id = akn.person_id WHERE ct.kind = 'distributors' GROUP BY cn.name ORDER BY character_occurrences DESC, average_imdb_id DESC;
SELECT kt.kind AS movie_kind, COUNT(DISTINCT t.movie_id) AS total_movies, AVG(CASE WHEN mc.note LIKE '%(worldwide) (all media)%' THEN 1 ELSE NULL END) * 100 AS percentage_worldwide_distribution, COUNT(DISTINCT lt.id) FILTER (WHERE lt.link LIKE '%remake of%') AS total_remakes, AVG(t.production_year) AS average_production_year, COUNT(DISTINCT ml.linked_movie_id) FILTER (WHERE ml.link_type_id IN ('17', '16')) AS total_sequel_or_prequels, COUNT(DISTINCT n.id) AS total_actors_involved FROM kind_type AS kt JOIN aka_title AS t ON kt.id = t.kind_id LEFT JOIN movie_companies AS mc ON t.movie_id = mc.movie_id LEFT JOIN link_type AS lt ON lt.id = mc.company_type_id LEFT JOIN movie_link AS ml ON t.movie_id = ml.movie_id LEFT JOIN movie_info AS mi ON t.movie_id = mi.movie_id AND mi.info_type_id = '4' LEFT JOIN name AS n ON n.imdb_id = t.movie_id GROUP BY kt.kind;
SELECT it.info AS info_category, COUNT(DISTINCT mi.movie_id) AS total_movies, AVG(CASE WHEN n.gender = 'm' THEN 1.0 ELSE NULL END) AS avg_male_involvement, AVG(CASE WHEN n.gender = 'f' THEN 1.0 ELSE NULL END) AS avg_female_involvement, COUNT(DISTINCT an.person_id) AS unique_aka_names, SUM(CASE WHEN mi.info_type_id = 4 THEN 1 ELSE 0 END) AS count_info_type_4 FROM movie_info mi INNER JOIN info_type it ON mi.info_type_id = it.id LEFT JOIN aka_name an ON an.person_id = mi.movie_id LEFT JOIN name n ON n.id = mi.movie_id WHERE mi.info LIKE '%Mandarin%' OR mi.info_type_id IN ('47', '5', '7') OR n.surname_pcode IN ('A432', 'A416', 'A414') OR n.imdb_index IN ('VI', 'XVII', 'XIV', 'I') GROUP BY it.info;
SELECT kt.kind AS movie_type, COUNT(DISTINCT t.id) AS total_movies, AVG(t.production_year) AS average_production_year, SUM(CASE WHEN n.gender = 'm' THEN 1 ELSE 0 END) AS male_actors_count, SUM(CASE WHEN n.gender = 'f' THEN 1 ELSE 0 END) AS female_actors_count, COUNT(DISTINCT k.id) AS distinct_keywords_used FROM title t INNER JOIN kind_type kt ON t.kind_id = kt.id LEFT JOIN movie_keyword mk ON t.id = mk.movie_id LEFT JOIN keyword k ON mk.keyword_id = k.id LEFT JOIN char_name cn ON t.id = cn.imdb_id LEFT JOIN name n ON cn.id = n.id WHERE t.production_year >= 2000 AND (n.surname_pcode = 'A41' OR n.surname_pcode = 'A42' OR n.surname_pcode = 'A435') GROUP BY kt.kind ORDER BY total_movies DESC;
SELECT ct.kind AS company_type, cn.country_code, COUNT(DISTINCT cn.id) AS number_of_companies, COUNT(DISTINCT cl.id) AS number_of_movie_links, AVG(pi.person_id) AS average_person_id, SUM(CASE WHEN pi.note SIMILAR TO '%(Erin Chambers|nazir afzal|woodyanders \(qv''s & corrections by A. Nonymous\)|Woodlene Adeyemo|tina ansah)%' THEN 1 ELSE 0 END) AS count_special_notes FROM company_name AS cn JOIN company_type AS ct ON cn.id = ct.id LEFT JOIN movie_link AS cl ON cn.id = cl.movie_id LEFT JOIN char_name AS chn ON chn.name IN ('Lumbard', 'Charlie Graham', 'Der junge Graf', 'Himself - King of Jungle') LEFT JOIN complete_cast AS cc ON cc.movie_id = cl.movie_id LEFT JOIN person_info AS pi ON pi.person_id = chn.id LEFT JOIN name AS n ON n.id = pi.person_id WHERE cn.country_code IN ('[sd]', '[ir]', '[ph]', '[tr]') GROUP BY ct.kind, cn.country_code ORDER BY number_of_companies DESC, average_person_id;
SELECT cct.kind AS cast_type, COUNT(DISTINCT mi.movie_id) AS total_movies, COUNT(DISTINCT k.id) AS total_keywords, AVG(COUNT(k.id)) OVER (PARTITION BY cct.kind) AS avg_keywords_per_movie FROM comp_cast_type AS cct JOIN movie_info_idx AS mi ON cct.id = mi.info_type_id JOIN keyword AS k ON mi.movie_id = k.id WHERE cct.kind IN ('complete', 'complete+verified') GROUP BY cct.kind;
SELECT ct.kind AS company_kind, AVG(at.production_year) AS average_production_year, COUNT(DISTINCT k.id) AS unique_keywords_count, COUNT(DISTINCT at.id) AS alternate_titles_count, SUM(CASE WHEN mic.info_type_id = '100' THEN 1 ELSE 0 END) AS count_info_type_100, SUM(CASE WHEN mic.info_type_id = '101' THEN 1 ELSE 0 END) AS count_info_type_101, SUM(CASE WHEN mic.info_type_id = '99' THEN 1 ELSE 0 END) AS count_info_type_99 FROM movie_companies AS mc JOIN company_type AS ct ON mc.company_type_id = ct.id JOIN aka_title AS at ON mc.movie_id = at.movie_id JOIN movie_info_idx AS mic ON mc.movie_id = mic.movie_id LEFT JOIN keyword AS k ON at.movie_id = k.id WHERE ct.kind = 'miscellaneous companies' AND mc.id IN ('1733', '1292', '472', '1920', '683', '4338') GROUP BY ct.kind;
