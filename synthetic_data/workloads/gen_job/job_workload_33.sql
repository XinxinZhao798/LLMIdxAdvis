SELECT cn.country_code, kt.kind AS title_kind, t.production_year AS year_of_production, COUNT(DISTINCT t.id) AS total_titles, SUM(CASE WHEN n.gender = 'M' THEN 1 ELSE 0 END) AS male_names_count, SUM(CASE WHEN n.gender = 'F' THEN 1 ELSE 0 END) AS female_names_count FROM title t INNER JOIN kind_type kt ON t.kind_id = kt.id LEFT JOIN company_name cn ON t.id = cn.imdb_id LEFT JOIN name n ON t.id = n.imdb_id WHERE t.production_year IS NOT NULL AND (n.gender = 'M' OR n.gender = 'F') GROUP BY cn.country_code, kt.kind, t.production_year ORDER BY cn.country_code, total_titles DESC, t.production_year DESC;
SELECT ct.kind AS company_kind, COUNT(DISTINCT mc.movie_id) AS number_of_movies, AVG(CAST(mi_idx.info AS NUMERIC)) AS average_rating, SUM(CASE WHEN n.gender = 'F' THEN 1 ELSE 0 END) AS female_cast_count, SUM(CASE WHEN n.gender = 'M' THEN 1 ELSE 0 END) AS male_cast_count FROM company_type ct JOIN movie_companies mc ON ct.id = mc.company_type_id JOIN movie_info_idx mi_idx ON mc.movie_id = mi_idx.movie_id AND mi_idx.info_type_id = ( SELECT id FROM comp_cast_type WHERE kind = 'rating' ) JOIN name n ON mc.movie_id = n.id WHERE ct.kind IN ('special effects companies', 'miscellaneous companies', 'distributors') AND mc.movie_id IN ('19654', '24487', '18671', '31117', '18944') AND mc.company_id IN ('209', '936', '1140') AND n.name_pcode_cf IN ('A6232', 'A5163') GROUP BY ct.kind ORDER BY number_of_movies DESC, average_rating DESC;
SELECT lt.LINK AS link_type, COUNT(DISTINCT ml.movie_id) AS number_of_movies, AVG(t.production_year) AS average_production_year, SUM(CASE WHEN n.gender = 'f' THEN 1 ELSE 0 END) AS female_cast_count, SUM(CASE WHEN n.gender = 'm' THEN 1 ELSE 0 END) AS male_cast_count FROM movie_link AS ml JOIN link_type AS lt ON ml.link_type_id = lt.id JOIN title AS t ON ml.movie_id = t.id JOIN movie_info_idx AS miidx ON miidx.movie_id = t.id JOIN info_type AS it ON miidx.info_type_id = it.id JOIN name AS n ON n.id = miidx.movie_id WHERE lt.id IN (13, 14, 8, 18, 4) AND ml.movie_id IN (10590, 11494) AND n.name_pcode_cf IN ('A4534', 'A31') GROUP BY lt.LINK ORDER BY number_of_movies DESC, average_production_year;
SELECT ct.kind AS company_kind, kt.kind AS movie_kind, AVG(ci.nr_order) AS average_cast_nr_order, COUNT(DISTINCT ci.person_id) AS total_unique_actors, COUNT(DISTINCT mc.movie_id) AS total_movies, SUM(CASE WHEN it.info = 'languages' THEN 1 ELSE 0 END) AS total_movies_with_languages_info FROM cast_info ci JOIN movie_companies mc ON ci.movie_id = mc.movie_id JOIN company_type ct ON mc.company_type_id = ct.id JOIN kind_type kt ON ci.role_id = kt.id JOIN info_type it ON ci.person_role_id = it.id WHERE ci.nr_order IN (35, 54, 23, 1) AND mc.movie_id IN (1542488, 1515644, 1097704) AND kt.id IN (3, 4, 2, 1) AND it.info IN ('taglines', 'languages', 'pictorial') GROUP BY company_kind, movie_kind;
SELECT kt.kind, COUNT(DISTINCT mc.movie_id) AS number_of_movies, COUNT(DISTINCT cn.id) AS number_of_characters, AVG(cn.imdb_id) AS average_imdb_id, SUM(CASE WHEN cn.surname_pcode = 'T5253' THEN 1 ELSE 0 END) AS count_surname_T5253, SUM(CASE WHEN cn.surname_pcode = 'M5253' THEN 1 ELSE 0 END) AS count_surname_M5253, COUNT(DISTINCT mc.company_id) AS number_of_companies_involved, STRING_AGG(DISTINCT rt.ROLE, ', ') AS roles_involved, STRING_AGG(DISTINCT mc.note, '; ') AS production_notes FROM kind_type kt LEFT JOIN movie_companies mc ON kt.id = mc.company_type_id LEFT JOIN char_name cn ON cn.id = mc.movie_id LEFT JOIN role_type rt ON rt.id = mc.company_type_id WHERE kt.kind IN ('episode', 'tv movie', 'movie', 'video movie', 'tv mini series', 'video game') AND mc.company_type_id = 1 AND (cn.surname_pcode IN ('T5253', 'M5253') OR cn.name IN ('Ish', 'Conti', 'Governor of the town', 'Himself - Grand Questor', 'Miss Travers''s Class')) AND rt.ROLE IN ('costume designer', 'production designer', 'cinematographer', 'director', 'writer', 'miscellaneous crew') AND mc.note LIKE '%(TV)%' GROUP BY kt.kind;
SELECT ct.kind AS company_kind, AVG(mi_idx.info::NUMERIC) AS average_movie_length, COUNT(DISTINCT ch_name.id) AS unique_character_count, COUNT(DISTINCT cn_name.id) AS unique_company_count, SUM(CASE WHEN ml.link_type_id = 2 THEN 1 ELSE 0 END) AS sequel_link_count FROM movie_info_idx AS mi_idx JOIN company_name AS cn_name ON cn_name.imdb_id = mi_idx.movie_id JOIN company_type AS ct ON cn_name.id = ct.id JOIN char_name AS ch_name ON ch_name.imdb_id = mi_idx.movie_id JOIN movie_link AS ml ON ml.movie_id = mi_idx.movie_id WHERE mi_idx.info_type_id = 1 AND ct.kind IN ('special effects companies', 'miscellaneous companies', 'production companies', 'distributors') AND ch_name.name IN ('Dr. Carlos Ventura', 'John Hartman Jr.', 'Paw Slawson', 'Pera', 'The Jester', 'Guitarist') GROUP BY ct.kind;
SELECT nt.info AS movie_genre, COUNT(DISTINCT cn.id) AS num_of_actors, AVG((n.gender = 'M')::int) AS avg_male_actors, AVG((n.gender = 'F')::int) AS avg_female_actors, SUM(CASE WHEN cn.id IN ('75924', '37156', '79891', '61423', '79360') THEN 1 ELSE 0 END) AS special_char_count, cname.name AS frequent_production_company, MAX(mi_idx.info) AS longest_movie_description FROM char_name cn JOIN name n ON cn.id = n.id JOIN movie_info_idx mi_idx ON n.id = mi_idx.movie_id JOIN info_type nt ON mi_idx.info_type_id = nt.id JOIN movie_companies mc ON mi_idx.movie_id = mc.movie_id JOIN company_name cname ON mc.company_id = cname.id WHERE n.md5sum IN ('5867f236efd2a49e525e28170e53884f', 'e30d31437d0cc24a549ebe11e068d91c', '103b12a2a1f067552d1582f217894732', '937aa89fd20c81ec429381d29296632e', 'b19e28f6480e3653f20f36528b67ddfd', 'ee97cefd84759ed4ec46f94d2e8962ed') AND cname.name IN ('Jamtown Films', 'Ovie Entertainment', 'Canibal Friends', 'Rocket Sheep Boom', 'Yarnmaker', 'Toko-Tokuma') AND nt.info IN ('LD dialogue intellegibility', 'book', 'tech info') GROUP BY nt.info, cname.name ORDER BY num_of_actors DESC, avg_male_actors DESC;
SELECT kt.kind AS movie_kind, COUNT(DISTINCT mc.movie_id) AS total_movies, COUNT(DISTINCT mc.company_id) AS total_companies_involved, AVG(CAST(an.id AS NUMERIC)) AS average_aka_name_id, SUM(CASE WHEN cn.country_code = 'US' THEN 1 ELSE 0 END) AS total_us_based_companies FROM movie_companies AS mc JOIN company_name AS cn ON mc.company_id = cn.id JOIN kind_type AS kt ON kt.id = mc.company_type_id LEFT JOIN aka_name AS an ON an.person_id = mc.id WHERE mc.movie_id IN ('23623', '12089', '22009', '20658', '18570', '31165') GROUP BY kt.kind;
SELECT AVG(mi_idx.info::numeric) AS average_rating, COUNT(DISTINCT k.id) AS total_unique_keywords, COUNT(DISTINCT n.id) AS total_unique_writers, SUM(CASE WHEN cn.surname_pcode = 'M1236' THEN 1 ELSE 0 END) AS count_of_m1236_surname_writers FROM keyword AS k LEFT JOIN movie_keyword AS mk ON k.id = mk.keyword_id LEFT JOIN movie_info_idx AS mi_idx ON mk.movie_id = mi_idx.movie_id AND mi_idx.info_type_id = 101 LEFT JOIN cast_info AS ci ON mk.movie_id = ci.movie_id LEFT JOIN char_name AS cn ON ci.person_id = cn.id AND ci.role_id = 2 LEFT JOIN name AS n ON ci.person_id = n.id AND n.gender = 'm' WHERE k.keyword IN ('airforce-one', 'mexican-revolutionary', 'full-house', 'gay-hollywood', 'overactive-imagination') AND cn.surname_pcode IN ('M1236', 'H3245', 'Z12', 'F236') AND ci.role_id IN (SELECT id FROM comp_cast_type WHERE kind = 'writer') GROUP BY ci.movie_id;
SELECT cct.kind AS cast_type, ct.kind AS company_kind, COUNT(DISTINCT k.id) AS keyword_count, AVG(LENGTH(k.keyword)) AS average_keyword_length, COUNT(DISTINCT lt.id) AS link_type_count FROM comp_cast_type cct JOIN company_type ct ON cct.id = ct.id LEFT JOIN keyword k ON SUBSTRING(k.phonetic_code, 1, 1) = 'A' LEFT JOIN link_type lt ON LENGTH(lt.link) > 10 GROUP BY cct.kind, ct.kind ORDER BY keyword_count DESC, average_keyword_length DESC;
SELECT rt.ROLE, COUNT(distinct ci.movie_id) AS total_movies, COUNT(distinct ci.person_id) AS total_actors, AVG(ci.nr_order) AS average_cast_order, COUNT(distinct kw.id) AS total_keyword_occurrences, COUNT(distinct cn.id) AS total_companies_involved, AVG(length(pi.info)) AS average_person_info_length FROM cast_info ci JOIN role_type rt ON ci.role_id = rt.id JOIN movie_info_idx mi_idx ON ci.movie_id = mi_idx.movie_id JOIN keyword kw ON kw.id = ANY(ARRAY[9828, 3338, 5730, 2511]) JOIN company_name cn ON cn.imdb_id = mi_idx.movie_id JOIN person_info pi ON ci.person_id = pi.person_id WHERE rt.id IN (11, 10, 7, 2) AND rt.ROLE = 'actor' AND ci.movie_id IN (1610581, 1098561, 1413295, 2451586, 1851477, 2419871) AND ci.role_id = 1 GROUP BY rt.ROLE
SELECT kt.kind as movie_kind, AVG(akat.production_year) as average_production_year, COUNT(DISTINCT akat.movie_id) as number_of_movies, SUM(CASE WHEN akat.episode_of_id IS NOT NULL THEN 1 ELSE 0 END) as number_of_episodes, COUNT(DISTINCT cn.id) as number_of_characters, COUNT(DISTINCT cct.id) as number_of_cast_types FROM aka_title akat JOIN kind_type kt ON akat.kind_id = kt.id JOIN char_name cn ON akat.movie_id = cn.imdb_id JOIN comp_cast_type cct ON akat.id = cct.id WHERE kt.kind = 'movie' AND akat.production_year BETWEEN 2000 AND 2010 AND akat.season_nr IN (6, 27, 1) AND akat.episode_of_id IN (23513, 23963, 12924, 12200, 8336) GROUP BY kt.kind;
SELECT kt.kind AS movie_kind, COUNT(DISTINCT t.id) AS total_movies, COUNT(DISTINCT ml.movie_id) AS total_linked_movies, AVG(t.production_year) AS average_production_year, SUM(CASE WHEN t.production_year > 1990 THEN 1 ELSE 0 END) AS movies_after_1990, MAX(t.production_year) AS latest_production_year, MIN(t.production_year) AS oldest_production_year FROM title AS t JOIN kind_type AS kt ON t.kind_id = kt.id LEFT JOIN movie_link AS ml ON t.id = ml.movie_id WHERE kt.id IN (2, 4, 6, 3) AND kt.kind IN ('tv mini series', 'video movie') GROUP BY kt.kind ORDER BY total_movies DESC;
SELECT n.name AS actor_name, COUNT(DISTINCT ci.movie_id) AS movies_participated, AVG(mi_idx_nr_order.avg_nr_order) AS average_cast_order, SUM(CASE WHEN mi_info.info LIKE '%budget%' THEN 1 ELSE 0 END) AS budget_movies_count, MAX(CASE WHEN mi_info.info_type_id = (SELECT id FROM movie_info_idx WHERE info = 'release dates') THEN mi_info.info ELSE NULL END) AS latest_release_date FROM name n JOIN cast_info ci ON ci.person_id = n.id LEFT JOIN (SELECT movie_id, AVG(nr_order) AS avg_nr_order FROM cast_info GROUP BY movie_id) mi_idx_nr_order ON mi_idx_nr_order.movie_id = ci.movie_id LEFT JOIN movie_info mi_info ON mi_info.movie_id = ci.movie_id WHERE n.gender = 'm' AND n.surname_pcode IN ('A416', 'A43', 'A413', 'A462') GROUP BY n.name ORDER BY movies_participated DESC, average_cast_order;
SELECT ct.kind AS cast_type, COUNT(ci.id) AS total_cast_entries, AVG(ci.nr_order) AS average_order, SUM(CASE WHEN ml.link_type_id = 1 THEN 1 ELSE 0 END) AS total_sequel_links, COUNT(DISTINCT ci.movie_id) AS unique_movies, COUNT(DISTINCT ci.person_id) AS unique_persons FROM cast_info ci JOIN comp_cast_type ct ON ci.role_id = ct.id LEFT JOIN movie_link ml ON ci.movie_id = ml.movie_id AND ml.linked_movie_id = 9108 WHERE ci.movie_id IN (2348393, 1843055, 2354998, 2143306, 1326354, 1589480) AND ci.nr_order IN (75, 20, 2, 35) GROUP BY ct.kind ORDER BY total_cast_entries DESC;
SELECT kt.kind AS movie_kind, AVG(aka_title.production_year) AS average_production_year, COUNT(DISTINCT aka_title.movie_id) AS total_movies, COUNT(DISTINCT movie_companies.company_id) AS total_companies_involved, SUM(case when aka_title.season_nr is not null then 1 else 0 end) AS total_seasons, COUNT(DISTINCT role_type.id) AS total_unique_roles FROM aka_title JOIN kind_type AS kt ON aka_title.kind_id = kt.id JOIN movie_companies ON aka_title.movie_id = movie_companies.movie_id JOIN company_type AS ct ON movie_companies.company_type_id = ct.id JOIN role_type ON role_type.id = movie_companies.company_id WHERE ct.kind = 'production companies' AND role_type.role IN ('guest', 'writer', 'miscellaneous crew', 'cinematographer') AND aka_title.imdb_index IN ('III', 'IV', 'I', 'II') AND aka_title.production_year BETWEEN 1990 AND 2020 GROUP BY kt.kind ORDER BY total_movies DESC;
SELECT COUNT(DISTINCT mi.movie_id) AS total_movies, AVG(CAST(mi_idx.info AS NUMERIC)) AS average_movie_rating, SUM(CASE WHEN at.kind_id = 1 THEN 1 ELSE 0 END) AS total_movies_kind_1, COUNT(DISTINCT mc.company_id) AS total_production_companies, COUNT(DISTINCT n.id) AS total_unique_names, MAX(at.production_year) AS latest_production_year, MIN(at.production_year) AS earliest_production_year FROM movie_info mi JOIN movie_info_idx mi_idx ON mi.movie_id = mi_idx.movie_id AND mi.info_type_id = mi_idx.info_type_id JOIN aka_title at ON mi.movie_id = at.movie_id JOIN movie_companies mc ON mi.movie_id = mc.movie_id JOIN name n ON n.id = ANY(ARRAY(SELECT movie_id FROM movie_info WHERE info_type_id = (SELECT id FROM info_type WHERE info = 'writers'))) WHERE mi.info_type_id = (SELECT id FROM info_type WHERE info = 'rating') AND CAST(mi_idx.info AS NUMERIC) > 5 AND at.production_year BETWEEN 1990 AND 2000 AND at.kind_id IN (1, 2, 3) GROUP BY at.kind_id ORDER BY total_movies_kind_1 DESC;
SELECT kt.kind AS movie_kind, COUNT(*) AS total_movies, AVG(t.production_year) AS average_production_year, SUM(CASE WHEN mi.info = 'color' THEN 1 ELSE 0 END) AS color_movie_count, SUM(CASE WHEN mi.info = 'black and white' THEN 1 ELSE 0 END) AS black_and_white_movie_count FROM title AS t JOIN kind_type AS kt ON t.kind_id = kt.id JOIN movie_info AS mi ON t.id = mi.movie_id WHERE t.production_year BETWEEN 2000 AND 2010 AND mi.info_type_id IN (SELECT id FROM info_type WHERE info IN ('color', 'black and white')) GROUP BY kt.kind HAVING COUNT(*) > 100 ORDER BY total_movies DESC, average_production_year;
SELECT it.info AS info_type, AVG(nm.imdb_id) AS average_imdb_id, COUNT(DISTINCT kw.id) AS unique_keywords_count, SUM(mc.company_id) AS total_company_id_sum, rt.ROLE AS role_type, COUNT(DISTINCT cc.movie_id) AS movies_count FROM info_type AS it JOIN movie_companies AS mc ON it.id = mc.company_type_id LEFT JOIN complete_cast AS cc ON mc.movie_id = cc.movie_id LEFT JOIN keyword AS kw ON mc.movie_id = kw.id LEFT JOIN name AS nm ON cc.subject_id = nm.id JOIN role_type AS rt ON cc.status_id = rt.id WHERE mc.company_type_id = '1' AND (nm.name_pcode_nf = 'B4645' OR nm.name_pcode_nf = 'B1436') AND (rt.ROLE = 'producer' OR rt.ROLE = 'actor') AND mc.movie_id IN ('1646081', '1699392', '1666532', '1678176', '1677967') GROUP BY it.info, rt.ROLE ORDER BY movies_count DESC, average_imdb_id;
