SELECT kt.kind AS movie_kind, mc.company_type_id, COUNT(DISTINCT t.id) AS movie_count, t.production_year AS production_year, AVG((SELECT COUNT(*) FROM char_name WHERE char_name.id = t.id)) AS avg_character_count FROM title AS t JOIN kind_type AS kt ON t.kind_id = kt.id JOIN movie_companies AS mc ON t.id = mc.movie_id GROUP BY kt.kind, mc.company_type_id, t.production_year ORDER BY production_year DESC, kt.kind, mc.company_type_id;
SELECT COUNT(DISTINCT mi_idx.movie_id) AS total_movies, AVG(mk_cnt.keyword_count) AS avg_keywords_per_movie, COUNT(DISTINCT ml.movie_id) AS total_linked_movies, SUM(CASE WHEN lt.link = 'similar to' THEN 1 ELSE 0 END) AS count_similar_to_links, COUNT(DISTINCT mc.company_id) AS total_companies, AVG(NULLIF(regexp_replace(mi_idx.info, '\D', '', 'g'), '')::NUMERIC) AS average_info_numeric, SUM(CASE WHEN k.phonetic_code IN ('M342', 'N2165') THEN 1 ELSE 0 END) AS count_specific_phonetic_codes FROM movie_info_idx AS mi_idx JOIN movie_keyword AS mk ON mi_idx.movie_id = mk.movie_id JOIN movie_link AS ml ON mk.movie_id = ml.movie_id JOIN movie_companies AS mc ON ml.movie_id = mc.movie_id JOIN link_type AS lt ON ml.link_type_id = lt.id JOIN keyword AS k ON mk.keyword_id = k.id JOIN (SELECT movie_id, COUNT(keyword_id) AS keyword_count FROM movie_keyword GROUP BY movie_id) AS mk_cnt ON mk.movie_id = mk_cnt.movie_id WHERE mi_idx.info_type_id = '100' AND mi_idx.info SIMILAR TO '%[0-9]{6,}%' AND (ml.movie_id IN ('11122', '14650', '11447', '7786', '14516') OR ml.id IN ('3768', '4002', '4548', '963', '430', '4309')) GROUP BY lt.link;
SELECT n.name AS actor_name, COUNT(DISTINCT ci.movie_id) AS movies_participated, AVG(mi_idx_nr_order.avg_nr_order) AS average_cast_order, SUM(CASE WHEN mi_info.info LIKE '%budget%' THEN 1 ELSE 0 END) AS budget_movies_count, MAX(CASE WHEN mi_info.info_type_id = (SELECT id FROM movie_info_idx WHERE info = 'release dates') THEN mi_info.info ELSE NULL END) AS latest_release_date FROM name n JOIN cast_info ci ON ci.person_id = n.id LEFT JOIN (SELECT movie_id, AVG(nr_order) AS avg_nr_order FROM cast_info GROUP BY movie_id) mi_idx_nr_order ON mi_idx_nr_order.movie_id = ci.movie_id LEFT JOIN movie_info mi_info ON mi_info.movie_id = ci.movie_id WHERE n.gender = 'm' AND n.surname_pcode IN ('A416', 'A43', 'A413', 'A462') GROUP BY n.name ORDER BY movies_participated DESC, average_cast_order;
SELECT kt.kind AS movie_type, COUNT(t.id) AS total_movies, AVG(t.production_year) AS avg_production_year, MIN(t.production_year) AS earliest_production_year, MAX(t.production_year) AS latest_production_year FROM title t JOIN (SELECT id, kind FROM comp_cast_type WHERE kind IN ('director', 'actor')) cct ON t.kind_id = cct.id LEFT JOIN (SELECT id, kind FROM kind_type) kt ON t.kind_id = kt.id GROUP BY kt.kind ORDER BY total_movies DESC;
SELECT cn.country_code, COUNT(DISTINCT mi.movie_id) AS movie_count, AVG(pi.info_type_id::numeric) AS avg_person_info_type, COUNT(DISTINCT cn.name) AS company_count, COUNT(DISTINCT chn.name) AS character_name_count FROM movie_info mi JOIN movie_info_idx mii ON mi.movie_id = mii.movie_id AND mi.info_type_id = mii.info_type_id JOIN company_name cn ON mi.movie_id = cn.imdb_id JOIN person_info pi ON mi.movie_id = pi.person_id JOIN char_name chn ON mi.movie_id = chn.imdb_id WHERE cn.country_code IN ('[np]', '[kr]', '[cn]', '[tw]', '[sa]', '[my]') AND pi.note IN ('info@aeberhard.com', 'Chris Hendren', 'Quincy Johnson', 'Ian Adema', 'isabelleadriani@yahoo.it') AND pi.info_type_id IN ('34', '36') AND mi.info IN ('Galician', 'Flemish', 'Persian', 'Czech') GROUP BY cn.country_code ORDER BY movie_count DESC, avg_person_info_type DESC;
SELECT ct.kind AS company_type, AVG(cast_info.nr_order) AS average_cast_order, COUNT(DISTINCT aka_title.movie_id) AS unique_movies_count, SUM(CASE WHEN aka_title.note = '(Australia) (subtitle)' THEN 1 ELSE 0 END) AS subtitle_count_australia, COUNT(DISTINCT name.id) AS number_of_actors FROM company_name JOIN company_type ct ON company_name.id = ct.id JOIN cast_info ON cast_info.person_role_id IN (1085, 1377, 785, 931, 155, 1103) JOIN aka_title ON aka_title.movie_id = cast_info.movie_id JOIN name ON name.id = cast_info.person_id LEFT JOIN movie_link ON movie_link.movie_id = aka_title.movie_id AND movie_link.link_type_id = 6 WHERE company_name.md5sum IN ('95cfc537e91c24f4cdc46ebabba6ee92', '61e6938b1d826bba25234363eac1a650') GROUP BY ct.kind;
SELECT kt.kind AS movie_kind, COUNT(DISTINCT ci.movie_id) AS number_of_movies, AVG(mi_idx.info::integer) AS average_rating, SUM(CASE WHEN cn.country_code = '[us]' THEN 1 ELSE 0 END) AS number_of_us_companies_involved, COUNT(DISTINCT ci.person_id) AS number_of_cast_members FROM movie_companies AS mc JOIN kind_type AS kt ON kt.id = mc.company_type_id JOIN cast_info AS ci ON ci.movie_id = mc.movie_id JOIN company_name AS cn ON cn.id = mc.company_id JOIN movie_info_idx AS mi_idx ON mi_idx.movie_id = mc.movie_id AND mi_idx.info_type_id = 101 WHERE mc.movie_id IN (19315, 15715, 19236, 19775, 18865, 11243) AND mc.note LIKE '%(TV)%' AND kt.kind IN ('movie', 'episode') AND cn.name_pcode_sf IN ('B5261', 'H1535', 'T5642', 'W5214', 'C3163', 'K2145') GROUP BY kt.kind;
SELECT ct.kind AS company_type_kind, AVG(name.imdb_id) AS avg_imdb_id, COUNT(DISTINCT aka_name.person_id) AS unique_aka_person_count, SUM(CASE WHEN pi.info_type_id = '22' THEN 1 ELSE 0 END) AS count_info_type_22, MAX(mc.note) AS max_movie_company_note FROM movie_companies AS mc JOIN comp_cast_type AS cct ON mc.company_type_id = cct.id JOIN name ON name.id = mc.company_id JOIN aka_name ON aka_name.person_id = name.id LEFT JOIN person_info AS pi ON pi.person_id = name.id JOIN company_type AS ct ON ct.id = mc.company_type_id WHERE cct.kind = 'crew' AND name.surname_pcode IN ('A43', 'A432') AND name.md5sum IN ('95a7b086dc6ce3e141f3acbc8b45cc12', '27e967b3984165c80f751a75ef91e3fc') GROUP BY ct.kind;
SELECT ct.kind AS company_type, cn.country_code, COUNT(DISTINCT k.id) AS unique_keywords_count, COUNT(DISTINCT t.id) AS total_movies, SUM(CASE WHEN t.production_year > 2000 THEN 1 ELSE 0 END) AS movies_after_2000 FROM company_name cn JOIN company_type ct ON cn.id = ct.id JOIN title t ON t.production_year IS NOT NULL JOIN movie_keyword mk ON t.id = mk.movie_id JOIN keyword k ON mk.keyword_id = k.id WHERE cn.country_code != 'US' AND k.keyword IN ('high-powered-gun', 'airforce', 'harpoon', 'creek') AND t.kind_id != 1 GROUP BY ct.kind, cn.country_code ORDER BY total_movies DESC;
