SELECT ct.kind AS company_type, AVG(kw.id) AS average_keyword_id, COUNT(DISTINCT mc.movie_id) AS total_movies, SUM(mc.company_id) AS sum_company_id FROM movie_companies mc JOIN company_type ct ON mc.company_type_id = ct.id JOIN movie_link ml ON mc.movie_id = ml.movie_id JOIN keyword kw ON CAST(ml.link_type_id AS INTEGER) = kw.id JOIN name n ON mc.movie_id = n.id WHERE n.gender = 'm' AND kw.keyword IN ('Black Rick', 'Joel Gonzalez', 'TNI Soldier', 'ESPN', 'Newsroom Martian') GROUP BY ct.kind ORDER BY total_movies DESC, average_keyword_id;
SELECT kt.kind AS movie_kind, COUNT(DISTINCT mc.movie_id) AS number_of_movies, AVG(mi_numeric.info::NUMERIC) AS average_budget, SUM(CASE WHEN mc.company_id = '1187' THEN 1 ELSE 0 END) AS movies_with_company_1187, SUM(CASE WHEN mc.company_id = '1024' THEN 1 ELSE 0 END) AS movies_with_company_1024, COUNT(DISTINCT ml.link_type_id) AS distinct_link_types FROM movie_companies AS mc JOIN movie_info AS mi ON mc.movie_id = mi.movie_id JOIN kind_type AS kt ON mi.info_type_id = kt.id LEFT JOIN movie_link AS ml ON mc.movie_id = ml.movie_id LEFT JOIN movie_info AS mi_numeric ON mc.movie_id = mi_numeric.movie_id AND mi_numeric.info_type_id = ( SELECT id FROM info_type WHERE info = 'budget' ) WHERE mc.company_id IN ('1187', '1024', '1009', '1239', '1034') AND mi.info_type_id IN ( SELECT id FROM info_type WHERE info = 'budget' ) AND mc.movie_id IN ('18864', '18945') GROUP BY kt.kind;
SELECT COUNT(DISTINCT mk.movie_id) AS total_movies, k.keyword, AVG(lt.id) AS average_link_type_id, SUM(CASE WHEN k.phonetic_code = 'T2351' THEN 1 ELSE 0 END) AS count_t2351, SUM(CASE WHEN k.phonetic_code = 'D35' THEN 1 ELSE 0 END) AS count_d35 FROM movie_keyword AS mk JOIN keyword AS k ON mk.keyword_id = k.id JOIN link_type AS lt ON mk.id = lt.id GROUP BY k.keyword ORDER BY total_movies DESC, k.keyword;
SELECT kt.kind AS movie_kind, COUNT(DISTINCT ci.movie_id) AS number_of_movies, AVG(mi_idx.info::integer) AS average_rating, SUM(CASE WHEN cn.country_code = '[us]' THEN 1 ELSE 0 END) AS number_of_us_companies_involved, COUNT(DISTINCT ci.person_id) AS number_of_cast_members FROM movie_companies AS mc JOIN kind_type AS kt ON kt.id = mc.company_type_id JOIN cast_info AS ci ON ci.movie_id = mc.movie_id JOIN company_name AS cn ON cn.id = mc.company_id JOIN movie_info_idx AS mi_idx ON mi_idx.movie_id = mc.movie_id AND mi_idx.info_type_id = 101 WHERE mc.movie_id IN (19315, 15715, 19236, 19775, 18865, 11243) AND mc.note LIKE '%(TV)%' AND kt.kind IN ('movie', 'episode') AND cn.name_pcode_sf IN ('B5261', 'H1535', 'T5642', 'W5214', 'C3163', 'K2145') GROUP BY kt.kind;
SELECT AVG(CAST(mi_idx.info AS NUMERIC)) AS average_rating, COUNT(DISTINCT a_title.movie_id) AS number_of_movies, COUNT(DISTINCT a_name.person_id) AS number_of_people, SUM(CASE WHEN m_link.link_type_id = 1 THEN 1 ELSE 0 END) AS number_of_prequels, SUM(CASE WHEN m_link.link_type_id = 2 THEN 1 ELSE 0 END) AS number_of_sequels, AVG(a_title.production_year) AS average_production_year FROM aka_title AS a_title JOIN aka_name AS a_name ON a_title.movie_id = a_name.person_id JOIN movie_info_idx AS mi_idx ON a_title.movie_id = mi_idx.movie_id JOIN movie_link AS m_link ON a_title.movie_id = m_link.movie_id WHERE a_title.md5sum IN ('d4b78437f259ec962b25a518a77b6488', '982d91d043a457fb7114c4e57fba41a9') AND mi_idx.info_type_id = 101 GROUP BY a_title.kind_id HAVING COUNT(DISTINCT a_title.movie_id) > 10;
SELECT a.imdb_index AS imdb_index_version, AVG(a.production_year) AS average_production_year, COUNT(DISTINCT c.person_id) AS number_of_people_involved, COUNT(DISTINCT k.id) AS number_of_unique_keywords, lt.LINK AS link_type_description FROM aka_title a JOIN cast_info c ON a.movie_id = c.movie_id JOIN movie_keyword mk ON a.movie_id = mk.movie_id JOIN keyword k ON mk.keyword_id = k.id JOIN movie_link ml ON a.movie_id = ml.movie_id JOIN link_type lt ON ml.link_type_id = lt.id WHERE a.imdb_index IN ('I', 'II', 'III', 'IV') AND lt.LINK IN ('remake of', 'version of') GROUP BY a.imdb_index, lt.LINK ORDER BY average_production_year DESC;
SELECT it.info AS info_type, AVG(CAST(mi.info AS INTEGER)) AS average_info, COUNT(DISTINCT mk.movie_id) AS count_movies, COUNT(DISTINCT at.id) AS count_alternative_titles, SUM(CASE WHEN at.episode_of_id = 15436 THEN 1 ELSE 0 END) AS count_episodes_of_show_15436 FROM movie_info mi JOIN info_type it ON mi.info_type_id = it.id JOIN movie_keyword mk ON mk.movie_id = mi.movie_id LEFT JOIN aka_title at ON at.movie_id = mi.movie_id WHERE it.id IN (112, 107) AND mi.info ~ '^\d+$' GROUP BY it.info HAVING COUNT(DISTINCT mk.movie_id) > 5;
SELECT COUNT(DISTINCT mc.movie_id) AS number_of_movies, AVG(t.production_year) AS average_production_year, cct.kind AS company_type, MIN(cn.name) AS company_name, SUM(CASE WHEN n.gender = 'M' THEN 1 ELSE 0 END) AS male_actors, SUM(CASE WHEN n.gender = 'F' THEN 1 ELSE 0 END) AS female_actors FROM movie_companies AS mc JOIN title AS t ON mc.movie_id = t.id JOIN company_name AS cn ON mc.company_id = cn.id JOIN comp_cast_type AS cct ON mc.company_type_id = cct.id LEFT JOIN name AS n ON n.md5sum = mc.note WHERE cn.country_code NOT LIKE '[pl]' AND t.production_year BETWEEN 1950 AND 1999 AND t.phonetic_code = 'D323' AND n.name_pcode_nf IN ('N6454', 'I4364', 'O2464', 'D54', 'M3526', 'G6534') GROUP BY cct.kind;
SELECT cn.name AS company_name, COUNT(DISTINCT mc.movie_id) AS number_of_movies, AVG(CAST(mk.keyword_id AS NUMERIC)) AS average_keyword_id, SUM(CASE WHEN cc.status_id = 3 THEN 1 ELSE 0 END) AS completed_movie_count FROM movie_companies mc JOIN company_name cn ON mc.company_id = cn.id LEFT JOIN movie_keyword mk ON mc.movie_id = mk.movie_id LEFT JOIN complete_cast cc ON mc.movie_id = cc.movie_id WHERE mc.company_type_id = 1 AND cn.country_code IS NOT NULL GROUP BY cn.name ORDER BY number_of_movies DESC, completed_movie_count DESC LIMIT 10;
SELECT it.info AS info_category, COUNT(DISTINCT mc.movie_id) AS number_of_movies, AVG(CAST(mi_idx.info AS NUMERIC)) AS average_info_value, SUM(CAST(mi_idx.info AS NUMERIC)) AS total_info_value, COUNT(DISTINCT k.id) AS distinct_keywords_used FROM movie_info_idx mi_idx JOIN info_type it ON mi_idx.info_type_id = it.id JOIN movie_companies mc ON mi_idx.movie_id = mc.movie_id JOIN keyword k ON k.phonetic_code LIKE mi_idx.info WHERE mi_idx.info_type_id IN (100, 101, 99) AND mi_idx.info LIKE '...12...23' AND mc.company_id IN (741, 1095, 343, 1129) AND it.id IN (92, 14, 59) GROUP BY it.info ORDER BY number_of_movies DESC, average_info_value DESC;
