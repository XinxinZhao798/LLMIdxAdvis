SELECT AVG(ati.production_year) AS average_production_year, COUNT(DISTINCT ci.movie_id) AS total_movies, COUNT(DISTINCT ci.person_id) AS total_people_involved, SUM(CASE WHEN ci.role_id = 1 THEN 1 ELSE 0 END) AS total_actors, SUM(CASE WHEN ci.role_id = 2 THEN 1 ELSE 0 END) AS total_directors, MAX(ati.title) AS latest_added_alternative_title FROM cast_info ci JOIN aka_title ati ON ati.movie_id = ci.movie_id WHERE ati.production_year BETWEEN 1990 AND 2000 AND ci.person_role_id IN ('902', '627', '757', '669') AND ci.id IN ('18028', '15918', '15273', '16871') GROUP BY ati.movie_id ORDER BY total_movies DESC, total_people_involved DESC;
SELECT mc.company_id, ct.kind AS company_type, AVG(t.production_year) AS avg_production_year, COUNT(t.id) AS movie_count, STRING_AGG(k.keyword, ', ') AS common_keywords, AVG(LENGTH(t.title)) AS avg_title_length FROM movie_companies AS mc JOIN kind_type AS ct ON mc.company_type_id = ct.id JOIN title AS t ON mc.movie_id = t.id JOIN movie_info AS mi ON t.id = mi.movie_id JOIN info_type AS it ON mi.info_type_id = it.id LEFT JOIN keyword AS k ON mi.id = k.id WHERE mc.company_id IN (995, 1074, 719, 977, 232, 371) AND mc.company_type_id = 1 AND k.keyword IN ('yellow-dress', 'drug-enforcement', 'larry-holmes', 'borough-name-in-title', 'showbiz', 'flower-club') AND it.info = 'release dates' GROUP BY mc.company_id, ct.kind ORDER BY avg_production_year DESC, movie_count DESC;
SELECT AVG(t.production_year) AS average_production_year, COUNT(DISTINCT k.id) AS number_of_unique_keywords, SUM(CASE WHEN mc.company_type_id = 1 THEN 1 ELSE 0 END) AS number_of_production_companies, COUNT(DISTINCT mk.movie_id) AS number_of_movies_with_keywords, COUNT(DISTINCT t.id) AS total_movies FROM title AS t JOIN movie_keyword AS mk ON t.id = mk.movie_id JOIN keyword AS k ON mk.keyword_id = k.id JOIN movie_companies AS mc ON t.id = mc.movie_id JOIN complete_cast AS cc ON t.id = cc.movie_id WHERE t.production_year > 1990 AND mc.company_type_id IN (1, 2, 3) AND cc.status_id = 1 AND k.phonetic_code IN ('W25', 'P4232', 'G4323') GROUP BY t.kind_id HAVING COUNT(DISTINCT mc.company_id) > 5 ORDER BY average_production_year DESC;
SELECT kt.kind AS movie_kind, AVG(title.production_year) AS average_production_year, COUNT(DISTINCT cast_info.person_id) AS number_of_actors, COUNT(DISTINCT company_name.id) AS number_of_companies, SUM(case when cast_info.role_id = 1 then 1 else 0 end) AS number_of_lead_roles, MAX(movie_info.info) AS longest_movie_info FROM title JOIN kind_type AS kt ON title.kind_id = kt.id JOIN cast_info ON title.id = cast_info.movie_id JOIN movie_companies ON title.id = movie_companies.movie_id JOIN company_name ON movie_companies.company_id = company_name.id JOIN movie_info ON title.id = movie_info.movie_id WHERE title.production_year >= 2000 AND cast_info.role_id = 1 AND movie_companies.company_type_id IN (SELECT id FROM company_name WHERE country_code = 'US') GROUP BY kt.kind ORDER BY average_production_year DESC, number_of_actors DESC;
SELECT kt.kind AS movie_kind, rt.role AS cast_role, AVG(aka.production_year) AS avg_production_year, COUNT(DISTINCT ci.person_id) AS total_unique_actors, SUM(CASE WHEN k.keyword = 'vietnamese-restaurant' THEN 1 ELSE 0 END) AS vietnamese_restaurant_keyword_count, SUM(CASE WHEN k.keyword = 'symbol' THEN 1 ELSE 0 END) AS symbol_keyword_count FROM aka_title aka JOIN kind_type kt ON aka.kind_id = kt.id JOIN cast_info ci ON aka.movie_id = ci.movie_id JOIN role_type rt ON ci.role_id = rt.id JOIN keyword k ON aka.id = k.id WHERE aka.production_year > 2000 GROUP BY kt.kind, rt.role ORDER BY total_unique_actors DESC;
SELECT COUNT(DISTINCT n.id) AS number_of_actors, AVG(n.imdb_id) AS average_imdb_id, SUM(CASE WHEN n.gender = 'F' THEN 1 ELSE 0 END) AS female_actors_count, SUM(CASE WHEN n.gender = 'M' THEN 1 ELSE 0 END) AS male_actors_count, COUNT(DISTINCT an.id) AS number_of_alternative_names, COUNT(DISTINCT cct.id) AS number_of_cast_types, AVG(LENGTH(n.name)) AS average_actor_name_length FROM name n LEFT JOIN aka_name an ON n.id = an.person_id LEFT JOIN comp_cast_type cct ON an.id = cct.id WHERE n.name LIKE '%Amplify%' OR an.name IN ('Allen, ''Barefoot'' Chris', 'Alsamia, Etienne', 'Altamirano, Lisa Mariea', 'Aller, Gina', 'Smith, Mary Alice') GROUP BY n.gender;
SELECT COUNT(DISTINCT ci.person_id) AS total_actors, SUM(CASE WHEN ct.kind = 'production' THEN 1 ELSE 0 END) AS production_companies_count, AVG(t.production_year) AS average_production_year, MIN(t.title) AS oldest_movie_title, MAX(t.title) AS latest_movie_title, COUNT(DISTINCT mi.movie_id) AS total_movies_with_info FROM title t LEFT JOIN cast_info ci ON t.id = ci.movie_id LEFT JOIN movie_info mi ON t.id = mi.movie_id LEFT JOIN movie_companies mc ON t.id = mc.movie_id LEFT JOIN company_type ct ON mc.company_type_id = ct.id WHERE t.title = 'Vengence' AND t.production_year >= 2000 AND (t.episode_nr IN ('119', '9622', '13530', '255', '26') OR t.episode_nr IS NULL) GROUP BY t.production_year ORDER BY t.production_year ASC;
