SELECT AVG(aka.production_year) AS average_production_year, COUNT(DISTINCT ci.movie_id) AS number_of_movies, SUM(mc.company_id) AS total_companies_involved, COUNT(DISTINCT aka.title) AS unique_aka_titles, COUNT(DISTINCT ci.person_id) AS number_of_cast_members, MAX(ml.link_type_id) AS highest_link_type_id FROM aka_title aka JOIN cast_info ci ON aka.movie_id = ci.movie_id JOIN movie_companies mc ON aka.movie_id = mc.movie_id JOIN movie_link ml ON aka.movie_id = ml.movie_id WHERE aka.title IS NOT NULL AND aka.production_year IS NOT NULL AND (aka.title LIKE '0....01124%' OR aka.title LIKE '...0012111%' OR aka.title LIKE '%758%') GROUP BY aka.production_year ORDER BY average_production_year DESC;
SELECT COUNT(DISTINCT mi.movie_id) AS number_of_movies, AVG(CAST(mi.info AS DECIMAL)) AS average_info_rating, SUM(CASE WHEN mi.info_type_id = 101 THEN CAST(mi.info AS BIGINT) ELSE 0 END) AS total_info_type_101, MAX(t.production_year) AS latest_production_year, MIN(t.production_year) AS earliest_production_year, COUNT(DISTINCT mk.keyword_id) AS distinct_keywords, COUNT(DISTINCT t.id) FILTER (WHERE t.production_year BETWEEN 2000 AND 2010) AS movies_between_2000_and_2010 FROM movie_info_idx mi JOIN title t ON mi.movie_id = t.id LEFT JOIN movie_keyword mk ON t.id = mk.movie_id WHERE mi.info SIMILAR TO '%(4.4|0100111101|36|6000000001|1.0..10113)%' AND mi.movie_id IN (19624, 8384) GROUP BY t.kind_id ORDER BY total_info_type_101 DESC;
SELECT COUNT(DISTINCT akat.movie_id) AS total_movies, AVG(CAST(akat.production_year AS DECIMAL)) AS average_production_year, SUM(CASE WHEN mi.note IS NOT NULL THEN 1 ELSE 0 END) AS total_movies_with_notes, COUNT(DISTINCT mk.keyword_id) AS unique_keywords_used, COUNT(DISTINCT mc.company_id) AS total_companies_involved, SUM(CASE WHEN it.info = 'English' THEN 1 ELSE 0 END) AS total_english_language_movies FROM aka_title akat JOIN movie_info mi ON akat.movie_id = mi.movie_id JOIN movie_info_idx miidx ON akat.movie_id = miidx.movie_id JOIN movie_keyword mk ON akat.movie_id = mk.movie_id JOIN movie_companies mc ON akat.movie_id = mc.movie_id JOIN info_type it ON mi.info_type_id = it.id WHERE akat.production_year IN (1979, 1966) AND mc.company_type_id IN (SELECT id FROM link_type WHERE id = 7) AND mk.id IN (3803, 847) GROUP BY akat.kind_id;
SELECT COUNT(DISTINCT ci.person_id) AS total_actors, SUM(CASE WHEN ct.kind = 'production' THEN 1 ELSE 0 END) AS production_companies_count, AVG(t.production_year) AS average_production_year, MIN(t.title) AS oldest_movie_title, MAX(t.title) AS latest_movie_title, COUNT(DISTINCT mi.movie_id) AS total_movies_with_info FROM title t LEFT JOIN cast_info ci ON t.id = ci.movie_id LEFT JOIN movie_info mi ON t.id = mi.movie_id LEFT JOIN movie_companies mc ON t.id = mc.movie_id LEFT JOIN company_type ct ON mc.company_type_id = ct.id WHERE t.title = 'Vengence' AND t.production_year >= 2000 AND (t.episode_nr IN ('119', '9622', '13530', '255', '26') OR t.episode_nr IS NULL) GROUP BY t.production_year ORDER BY t.production_year ASC;
SELECT kt.kind AS movie_kind, AVG(ati.production_year) AS avg_production_year, COUNT(DISTINCT cn.id) AS total_actors, COUNT(DISTINCT compn.id) AS total_companies, SUM(CASE WHEN mi.info = 'Hungarian' THEN 1 ELSE 0 END) AS hungarian_movies_count, SUM(CASE WHEN mi.info = 'Bulgarian' THEN 1 ELSE 0 END) AS bulgarian_movies_count, SUM(CASE WHEN mi.info = 'Korean' THEN 1 ELSE 0 END) AS korean_movies_count FROM aka_title ati JOIN kind_type kt ON ati.kind_id = kt.id JOIN movie_info mi ON ati.movie_id = mi.movie_id JOIN info_type it ON mi.info_type_id = it.id LEFT JOIN name n ON n.id = ati.episode_of_id LEFT JOIN company_name compn ON compn.id = ati.movie_id LEFT JOIN char_name cn ON n.id = cn.id WHERE mi.info_type_id = 4 AND kt.id IN (1, 6, 5) AND ati.title IN ('Articolo 99', 'Lippenstift am Kragen', 'Eine Klasse fÃ¼r sich') GROUP BY kt.kind;
SELECT cn.name AS company_name, COUNT(DISTINCT mi_idx.movie_id) AS number_of_movies, AVG(CAST(mi_idx.info AS NUMERIC)) AS average_runtime, SUM(CASE WHEN it.info = 'locations' THEN 1 ELSE 0 END) AS total_locations, COUNT(DISTINCT mk.keyword_id) AS unique_keywords, COUNT(DISTINCT cc.movie_id) AS complete_cast_movies FROM movie_info_idx AS mi_idx JOIN info_type AS it ON mi_idx.info_type_id = it.id JOIN movie_keyword AS mk ON mi_idx.movie_id = mk.movie_id JOIN complete_cast AS cc ON mi_idx.movie_id = cc.movie_id JOIN company_name AS cn ON cn.imdb_id = mi_idx.movie_id WHERE it.info IN ('runtimes', 'locations') AND cn.name_pcode_nf = 'G2642' GROUP BY cn.name ORDER BY average_runtime DESC, number_of_movies DESC;
SELECT ak.production_year, COUNT(DISTINCT mk.movie_id) AS number_of_movies, COUNT(DISTINCT ci.person_id) AS number_of_actors, COUNT(DISTINCT mk.keyword_id) AS number_of_unique_keywords, AVG(ci.nr_order) AS average_cast_order FROM movie_keyword mk INNER JOIN aka_title ak ON mk.movie_id = ak.movie_id INNER JOIN cast_info ci ON mk.movie_id = ci.movie_id INNER JOIN movie_info_idx mi ON mk.movie_id = mi.movie_id WHERE mk.keyword_id IN (3815, 3067) AND ak.production_year BETWEEN 1980 AND 1990 GROUP BY ak.production_year ORDER BY ak.production_year;
SELECT cn.name AS company_name, AVG(CAST(mi_idx.info AS NUMERIC)) AS average_rating, COUNT(DISTINCT rt.id) AS number_of_roles, SUM(CASE WHEN cn.name_pcode_sf = 'Y5214' THEN 1 ELSE 0 END) AS count_Y5214_companies, SUM(CASE WHEN cn.name_pcode_sf = 'F2536' THEN 1 ELSE 0 END) AS count_F2536_companies FROM company_name AS cn JOIN movie_companies AS mc ON mc.company_id = cn.id JOIN movie_info_idx AS mi_idx ON mi_idx.movie_id = mc.movie_id JOIN cast_info AS ci ON ci.movie_id = mc.movie_id JOIN role_type AS rt ON rt.id = ci.role_id WHERE mi_idx.info_type_id = (SELECT id FROM info_type WHERE info = 'rating') GROUP BY cn.name HAVING COUNT(DISTINCT rt.id) > 1 ORDER BY average_rating DESC;
SELECT AVG(CAST(mi.info AS NUMERIC)) AS average_movie_duration, COUNT(DISTINCT ci.movie_id) AS number_of_movies, COUNT(DISTINCT ci.person_id) AS number_of_actors, MAX(CAST(mi.info AS INTERVAL)) AS longest_movie_duration, MIN(CAST(mi.info AS INTERVAL)) AS shortest_movie_duration FROM movie_info mi JOIN cast_info ci ON mi.movie_id = ci.movie_id JOIN movie_companies mc ON mi.movie_id = mc.movie_id JOIN comp_cast_type cct ON ci.person_role_id = cct.id JOIN char_name cn ON ci.person_id = cn.id WHERE mi.info_type_id = (SELECT id FROM info_type WHERE info = 'runtime') AND mc.note LIKE '%(USA)%' AND cct.kind IN ('cast', 'complete') AND cn.surname_pcode IN ('E235', 'A6432', 'E2536', 'A1526') GROUP BY mc.company_id ORDER BY average_movie_duration DESC;
SELECT p.info AS person_birthplace, COUNT(DISTINCT mk.movie_id) AS number_of_movies_with_keywords, COUNT(DISTINCT ml.movie_id) AS number_of_linked_movies, AVG(sub.link_count) AS average_number_of_links_per_movie, SUM(CASE WHEN mk.keyword_id = 2693 THEN 1 ELSE 0 END) AS count_keyword_2693 FROM person_info p LEFT JOIN movie_keyword mk ON p.person_id = mk.movie_id LEFT JOIN ( SELECT movie_id, COUNT(*) AS link_count FROM movie_link GROUP BY movie_id ) sub ON sub.movie_id = mk.movie_id LEFT JOIN movie_link ml ON ml.movie_id = mk.movie_id WHERE p.info = 'Miles City, Montana, USA' GROUP BY p.info;
SELECT ct.kind AS company_type, COUNT(DISTINCT t.id) AS number_of_titles, AVG(t.production_year) AS average_production_year, SUM(CASE WHEN t.kind_id = 1 THEN 1 ELSE 0 END) AS number_of_movies, SUM(CASE WHEN t.kind_id = 2 THEN 1 ELSE 0 END) AS number_of_tv_shows, COUNT(DISTINCT mk.keyword_id) AS unique_keywords, MAX(t.episode_nr) AS highest_episode_number FROM company_type AS ct JOIN movie_keyword AS mk ON mk.id IN (736, 2675) JOIN title AS t ON mk.movie_id = t.id WHERE t.md5sum IN ('744ccb1f3edd96cf5612c32621c4791d', '0dc255a0af1364d1a6e0083ec4231290', '468bba8c2823f5f827c055c2915eab8d', 'cfc401143a32c532fb68d85bc9f69635', '70d7d2f9c169c31ae459fa8daa188539') AND t.episode_nr IN (10516, 95, 120, 103, 30, 151) AND ct.kind IN ('special effects companies', 'miscellaneous companies', 'production companies', 'distributors') GROUP BY ct.kind ORDER BY number_of_titles DESC;
SELECT AVG(akat.production_year) AS average_movie_year, COUNT(DISTINCT n.id) AS unique_actor_count, COUNT(DISTINCT akat.id) AS total_movie_aliases, SUM(CASE WHEN lt.link = 'remake of' THEN 1 ELSE 0 END) AS total_remake_links, SUM(CASE WHEN lt.link = 'edited from' THEN 1 ELSE 0 END) AS total_edited_from_links FROM aka_title akat JOIN name n ON akat.movie_id = n.id JOIN link_type lt ON lt.id = akat.movie_id WHERE akat.phonetic_code IN ('K2545', 'R5321', 'S1232', 'S3425', 'B5314') AND n.name_pcode_cf IN ('A465', 'A4634', 'A5212', 'A2516', 'A5261', 'A3561') AND akat.production_year BETWEEN 1990 AND 2020 AND n.gender = 'M' GROUP BY n.gender;
SELECT it.info AS info_category, COUNT(DISTINCT cc.movie_id) AS number_of_movies, COUNT(DISTINCT cc.id) AS total_complete_cast_records, COUNT(DISTINCT mi_idx.movie_id) AS movies_with_additional_info, AVG(CAST(mi_idx.info AS INTEGER)) FILTER (WHERE it.info = 'votes') AS average_votes, SUM(CAST(mi_idx.info AS INTEGER)) FILTER (WHERE it.info = 'votes') AS total_votes, MIN(CAST(mi_idx.info AS INTEGER)) FILTER (WHERE it.info = 'votes') AS min_votes, MAX(CAST(mi_idx.info AS INTEGER)) FILTER (WHERE it.info = 'votes') AS max_votes, COUNT(DISTINCT lt.id) AS number_of_link_types, STRING_AGG(DISTINCT lt.link, ', ') AS link_types_used FROM complete_cast cc JOIN movie_info_idx mi_idx ON cc.movie_id = mi_idx.movie_id JOIN info_type it ON mi_idx.info_type_id = it.id JOIN link_type lt ON lt.id = mi_idx.info_type_id WHERE cc.status_id <> 0 AND it.info IN ('height', 'tech info', 'votes', 'mini biography') AND lt.link IN ('remake of', 'remade as', 'featured in', 'spin off') GROUP BY it.info;
SELECT COUNT(DISTINCT mc.movie_id) AS number_of_movies, AVG(aka.production_year) AS average_production_year, MAX(aka.production_year) AS latest_production_year, MIN(aka.production_year) AS earliest_production_year, COUNT(DISTINCT cn.id) AS number_of_unique_companies, COUNT(DISTINCT mk.keyword_id) AS number_of_unique_keywords, SUM(CASE WHEN n.gender = 'F' THEN 1 ELSE 0 END) AS number_of_female_cast_members, SUM(CASE WHEN n.gender = 'M' THEN 1 ELSE 0 END) AS number_of_male_cast_members FROM movie_companies AS mc JOIN aka_title AS aka ON mc.movie_id = aka.movie_id JOIN movie_keyword AS mk ON aka.movie_id = mk.movie_id JOIN complete_cast AS cc ON aka.movie_id = cc.movie_id JOIN char_name AS cn ON cn.name_pcode_nf IN ('E2416', 'R3242', 'W4165') JOIN name AS n ON cn.id = n.id WHERE mc.id IN ('577', '4551', '4702', '4381', '3126', '3864') AND aka.kind_id = 1 GROUP BY aka.kind_id HAVING COUNT(DISTINCT mc.movie_id) > 10 ORDER BY average_production_year DESC;
SELECT COUNT(DISTINCT cn.id) AS unique_character_count, AVG(mi_idx.info::numeric) AS average_movie_info_numeric, SUM(case when lt.id = '7' then 1 else 0 end) AS total_remake_links, MAX(cn.name) AS last_character_name_alphabetically FROM char_name cn JOIN complete_cast cc ON cn.id = cc.subject_id JOIN movie_info_idx mi_idx ON cc.movie_id = mi_idx.movie_id JOIN link_type lt ON lt.id = cc.status_id WHERE cn.surname_pcode IN ('S362', 'S246') AND mi_idx.info SIMILAR TO '%[0-9]+%' AND cc.movie_id IN ('1635482', '1626761', '96348', '52977') AND mi_idx.id IN ('268', '1318', '4406', '2884', '1174') AND lt.link IN ('remake of', 'spin off from', 'similar to', 'featured in') GROUP BY cn.surname_pcode;
SELECT rt.ROLE AS role_type, COUNT(DISTINCT ci.id) AS total_actors, AVG(at.production_year) AS average_production_year, SUM(mc.company_id) AS total_companies_involved, COUNT(DISTINCT cn.id) AS total_character_names, COUNT(DISTINCT at.id) AS total_alternative_titles FROM cast_info ci JOIN role_type rt ON ci.role_id = rt.id JOIN aka_title at ON ci.movie_id = at.movie_id JOIN movie_companies mc ON ci.movie_id = mc.movie_id JOIN char_name cn ON ci.person_id = cn.id WHERE rt.ROLE = 'director' AND mc.company_type_id = 1 AND cn.md5sum IN ('4ddcdcf6282d436a10b411b7016b9fb2', '4e926214a66707706c1fe2bb2f000f18') AND at.note LIKE '%(video box title)%' GROUP BY rt.ROLE;
SELECT ct.kind AS company_type, AVG(t.production_year) AS average_production_year, COUNT(DISTINCT t.id) AS number_of_movies, SUM(CASE WHEN mi.info_type_id = 1 THEN 1 ELSE 0 END) AS number_of_top_ranked_movies FROM company_type AS ct JOIN movie_companies AS mc ON ct.id = mc.company_type_id JOIN title AS t ON mc.movie_id = t.id JOIN movie_info AS mi ON t.id = mi.movie_id WHERE ct.kind IN ('special effects companies', 'miscellaneous companies', 'production companies', 'distributors') AND t.production_year >= 2000 GROUP BY ct.kind ORDER BY number_of_movies DESC;
SELECT AVG(mi_idx.info::NUMERIC) AS average_movie_rating, COUNT(DISTINCT cn.name) AS number_of_production_companies, COUNT(DISTINCT chn.name) AS number_of_unique_character_names, SUM(CASE WHEN mw.movie_id IS NOT NULL THEN 1 ELSE 0 END) AS number_of_movies_with_keywords FROM movie_info_idx AS mi_idx JOIN movie_keyword AS mw ON mi_idx.movie_id = mw.movie_id JOIN company_name AS cn ON cn.imdb_id = mi_idx.movie_id JOIN char_name AS chn ON chn.imdb_id = mi_idx.movie_id WHERE mi_idx.info_type_id = 101 AND mw.keyword_id IN (918, 3849, 3998, 3575) AND cn.name_pcode_sf IN ('L1242', 'S5261', 'G6425', 'S621', 'A5356', 'W132') AND chn.name_pcode_nf IN ('H61', 'M5316', 'D36', 'D1363') GROUP BY cn.country_code ORDER BY average_movie_rating DESC;
SELECT kt.kind AS movie_kind, AVG(t.production_year) AS average_production_year, COUNT(DISTINCT an.person_id) AS unique_actors_with_alternate_names, COUNT(DISTINCT cn.id) AS number_of_companies, SUM(CASE WHEN t.production_year > 2000 THEN 1 ELSE 0 END) AS movies_produced_after_2000 FROM aka_name an INNER JOIN name n ON an.person_id = n.id INNER JOIN aka_title at ON n.id = at.movie_id INNER JOIN title t ON at.movie_id = t.id INNER JOIN kind_type kt ON t.kind_id = kt.id INNER JOIN company_name cn ON t.id = cn.imdb_id LEFT JOIN char_name chn ON an.person_id = chn.id WHERE (chn.name = 'Clarkson' OR chn.name = 'Miguelito' OR chn.name = 'Basket coach') GROUP BY kt.kind;
SELECT COUNT(DISTINCT t.id) AS number_of_movies, AVG(t.production_year) AS average_production_year, SUM(CASE WHEN mc.company_type_id = 1 THEN 1 ELSE 0 END) AS number_of_type_1_companies, COUNT(DISTINCT mk.keyword_id) AS unique_keywords_used FROM title AS t JOIN movie_companies AS mc ON t.id = mc.movie_id JOIN movie_keyword AS mk ON t.id = mk.movie_id JOIN complete_cast AS cc ON t.id = cc.movie_id JOIN link_type AS lt ON lt.id = cc.status_id WHERE t.production_year BETWEEN 2000 AND 2010 AND mc.company_type_id = 1 AND lt.link = 'similar to' GROUP BY t.kind_id ORDER BY number_of_movies DESC;
SELECT kt.kind AS kind_of_movie, AVG(mi_idx.info::NUMERIC) AS average_rating, COUNT(DISTINCT t.id) AS number_of_movies, SUM(CASE WHEN mi.info = 'color' THEN 1 ELSE 0 END) AS number_of_color_movies, SUM(CASE WHEN mi.info = 'black and white' THEN 1 ELSE 0 END) AS number_of_black_and_white_movies, COUNT(DISTINCT mk.keyword_id) AS number_of_unique_keywords FROM title AS t JOIN kind_type AS kt ON t.kind_id = kt.id JOIN movie_info AS mi ON t.id = mi.movie_id JOIN movie_info_idx AS mi_idx ON t.id = mi_idx.movie_id JOIN movie_keyword AS mk ON t.id = mk.movie_id WHERE t.production_year IN (1976, 1989, 1952, 1990, 1959, 1967) AND mi.info_type_id IN (SELECT id FROM info_type WHERE info IN ('color', 'black and white')) AND mi_idx.info_type_id = (SELECT id FROM info_type WHERE info = 'rating') GROUP BY kt.kind ORDER BY average_rating DESC;
SELECT ct.kind AS company_type, COUNT(DISTINCT mc.movie_id) AS number_of_movies, AVG(CAST(mi.info AS NUMERIC)) AS average_movie_length, COUNT(DISTINCT ml.id) AS number_of_related_links, SUM(CASE WHEN n.gender = 'f' THEN 1 ELSE 0 END) AS female_contributors, SUM(CASE WHEN n.gender = 'm' THEN 1 ELSE 0 END) AS male_contributors FROM movie_companies mc JOIN company_type ct ON mc.company_type_id = ct.id JOIN movie_info mi ON mc.movie_id = mi.movie_id JOIN movie_link ml ON mc.movie_id = ml.movie_id JOIN name n ON mi.movie_id = n.id WHERE mi.info_type_id = (SELECT id FROM info_type WHERE info = 'runtime') AND ml.link_type_id = (SELECT id FROM link_type WHERE link = 'edited from') AND mi.id IN ('7270548', '7266456', '7269706') GROUP BY ct.kind ORDER BY number_of_movies DESC, average_movie_length DESC;
SELECT cct.kind AS cast_type_kind, AVG(mi_idx.info::numeric) AS average_movie_length, COUNT(DISTINCT mk.movie_id) AS number_of_movies_with_keywords, COUNT(DISTINCT pi.person_id) AS number_of_people_with_info FROM comp_cast_type cct JOIN movie_info_idx mi_idx ON cct.id = mi_idx.info_type_id JOIN movie_keyword mk ON mi_idx.movie_id = mk.movie_id JOIN person_info pi ON pi.info_type_id = mi_idx.info_type_id WHERE mk.keyword_id IN (3246, 2661, 3786) AND mi_idx.info_type_id = cct.id AND pi.info_type_id = cct.id GROUP BY cct.kind;
SELECT comp.name AS company_name, COUNT(DISTINCT ci.movie_id) AS number_of_movies, AVG(ci.nr_order) AS average_cast_order, SUM(CASE WHEN mc.company_type_id = 1 THEN 1 ELSE 0 END) AS number_of_production_companies, SUM(CASE WHEN mc.company_type_id = 2 THEN 1 ELSE 0 END) AS number_of_distribution_companies FROM company_name AS comp JOIN movie_companies AS mc ON comp.id = mc.company_id JOIN cast_info AS ci ON mc.movie_id = ci.movie_id WHERE comp.name_pcode_sf IN ('A4514', 'G5251', 'A3432', 'U5416', 'G6265', 'J3216') GROUP BY comp.name ORDER BY number_of_movies DESC, average_cast_order;
