SELECT kt.kind, COUNT(DISTINCT cn.id) AS total_characters, AVG(cn.imdb_id) AS average_imdb_id, COUNT(DISTINCT mi.info) AS distinct_info_count FROM kind_type AS kt LEFT JOIN movie_info_idx AS mi ON mi.info_type_id = kt.id LEFT JOIN char_name AS cn ON cn.imdb_id = mi.movie_id GROUP BY kt.kind ORDER BY total_characters DESC;
SELECT ct.kind AS company_kind, COUNT(DISTINCT cc.movie_id) AS number_of_movies, COUNT(DISTINCT cc.subject_id) AS number_of_subjects, AVG(cc.status_id) AS average_status FROM company_type ct JOIN complete_cast cc ON ct.id = cc.status_id GROUP BY ct.kind HAVING COUNT(DISTINCT cc.movie_id) > 5 ORDER BY number_of_movies DESC, average_status ASC;
SELECT lt.LINK AS link_type, COUNT(ml.id) AS total_links, AVG(pi.info_type_id) AS average_info_type_id, MIN(k.keyword) AS minimum_keyword, SUM(ml.movie_id) AS sum_movie_ids, MAX(ml.linked_movie_id) AS max_linked_movie_id FROM movie_link AS ml JOIN link_type AS lt ON lt.id = ml.link_type_id JOIN keyword AS k ON k.id = ml.id JOIN person_info AS pi ON pi.id = ml.id WHERE k.keyword LIKE 'physician%' AND lt.LINK IN ('similar to', 'spin off') AND pi.note ILIKE '%Director%' GROUP BY lt.LINK;
SELECT c.name AS company_name, COUNT(DISTINCT ci.movie_id) AS number_of_movies, AVG(k.id) AS average_keyword_id, SUM(CASE WHEN mi.info_type_id = 4 THEN 1 ELSE 0 END) AS count_of_info_type_4, STRING_AGG(DISTINCT k.keyword, ', ') AS associated_keywords, STRING_AGG(DISTINCT mi.info, ', ') FILTER (WHERE mi.info_type_id = 4) AS movie_info_languages FROM company_name AS c JOIN movie_companies AS mc ON c.id = mc.company_id JOIN movie_info AS mi ON mc.movie_id = mi.movie_id LEFT JOIN movie_keyword AS mk ON mc.movie_id = mk.movie_id LEFT JOIN keyword AS k ON mk.keyword_id = k.id LEFT JOIN cast_info AS ci ON mc.movie_id = ci.movie_id WHERE c.country_code = '[us]' AND mi.info IN ('Czech', 'Ladino', 'Ukrainian') GROUP BY c.name ORDER BY number_of_movies DESC, average_keyword_id;
SELECT it.info AS info_type, COUNT(DISTINCT akn.person_id) AS unique_person_count, COUNT(DISTINCT k.id) AS unique_keyword_count, AVG(mc.company_id) AS average_company_id, SUM(CASE WHEN k.phonetic_code IN ('S6252', 'C351', 'F2352') THEN 1 ELSE 0 END) AS specific_phonetic_code_count FROM aka_name akn JOIN info_type it ON akn.surname_pcode = it.info JOIN keyword k ON akn.name_pcode_nf = k.phonetic_code JOIN movie_companies mc ON akn.person_id = mc.company_id GROUP BY it.info ORDER BY unique_person_count DESC, unique_keyword_count DESC;
SELECT kt.kind AS movie_type, COUNT(DISTINCT at.id) AS total_alternate_titles, AVG(at.production_year) AS average_production_year, SUM(CASE WHEN at.season_nr IS NOT NULL THEN 1 ELSE 0 END) AS total_seasons, COUNT(DISTINCT mc.company_id) AS total_companies_involved, COUNT(DISTINCT cc.id) AS total_complete_cast_records, COUNT(DISTINCT k.id) AS total_unique_keywords FROM aka_title at JOIN kind_type kt ON at.kind_id = kt.id LEFT JOIN movie_companies mc ON at.movie_id = mc.movie_id LEFT JOIN complete_cast cc ON at.movie_id = cc.movie_id LEFT JOIN keyword k ON k.id = ANY(ARRAY[6884, 9943]) WHERE at.md5sum IN ('44c0080e0912e3ca5d10075839063f1b', 'a5be4ea19dc2872037b2956fcb845de1', 'ec82f287db52c1fe7be3ed79dfb0a06a', '42824af6235a76885dde510273e9d1a7', 'cd3e9be473ea7275bd1b401dce7d08f9', 'c994ea29391a6ac08145be73f75d09ff') GROUP BY kt.kind;
SELECT rt.role AS role_type, COUNT(DISTINCT ci.person_id) AS number_of_people, AVG(mi.info::numeric) AS average_movie_rating, SUM(CASE WHEN k.keyword IN ('drug-abuser', 'obesity') THEN 1 ELSE 0 END) AS count_unhealthy_keywords, COUNT(DISTINCT mi.movie_id) AS number_of_movies FROM cast_info ci JOIN role_type rt ON ci.role_id = rt.id JOIN movie_info mi ON ci.movie_id = mi.movie_id AND mi.info_type_id = ( SELECT id FROM info_type WHERE info = 'rating' ) JOIN keyword k ON mi.movie_id = ANY ( SELECT movie_id FROM movie_info WHERE info = k.keyword ) GROUP BY rt.role HAVING COUNT(DISTINCT ci.person_id) > 10 ORDER BY average_movie_rating DESC;
SELECT t.title AS movie_title, ct.kind AS company_type, rt.role AS role, AVG(t.production_year) AS average_production_year, COUNT(DISTINCT mc.company_id) AS number_of_companies, COUNT(DISTINCT mi.movie_id) AS number_of_movie_info_entries, SUM(CASE WHEN rt.role = 'actor' THEN 1 ELSE 0 END) AS total_actor_roles, SUM(CASE WHEN rt.role = 'director' THEN 1 ELSE 0 END) AS total_director_roles FROM title t JOIN movie_companies mc ON t.id = mc.movie_id JOIN company_type ct ON mc.company_type_id = ct.id JOIN movie_info mi ON t.id = mi.movie_id JOIN role_type rt ON t.id = rt.id WHERE ct.kind IN ('miscellaneous companies', 'special effects companies', 'distributors') AND rt.role IN ('actor', 'guest', 'writer', 'director') AND t.season_nr IS NULL AND t.production_year BETWEEN 2000 AND 2023 GROUP BY t.title, ct.kind, rt.role ORDER BY average_production_year DESC, number_of_companies DESC, number_of_movie_info_entries DESC;
SELECT t.title AS Movie_Title, t.production_year AS Production_Year, COUNT(DISTINCT mk.keyword_id) AS Number_of_Keywords, COUNT(DISTINCT mc.company_id) AS Number_of_Companies_Involved, AVG(t.production_year) OVER () AS Average_Production_Year, COUNT(*) OVER () AS Total_Movies_Analyzed FROM title AS t JOIN movie_keyword AS mk ON t.id = mk.movie_id JOIN movie_companies AS mc ON t.id = mc.movie_id JOIN movie_link AS ml ON t.id = ml.movie_id WHERE ml.link_type_id IN ('12', '11', '13', '6') AND t.series_years IN ('1985-????', '2004-????', '2013-????', '1988-????', '2010-2010') AND t.production_year > (SELECT AVG(production_year) FROM title) GROUP BY t.id HAVING COUNT(DISTINCT mk.keyword_id) > 5 ORDER BY Number_of_Keywords DESC, Production_Year DESC;
SELECT n.name AS actor_name, COUNT(DISTINCT ci.movie_id) AS number_of_movies, AVG(mi_idx.info::numeric) AS average_movie_rating, SUM(CASE WHEN ci.role_id = 1 THEN 1 ELSE 0 END) AS number_of_lead_roles, COUNT(DISTINCT mc.company_id) AS number_of_companies_worked_with FROM cast_info ci JOIN name n ON ci.person_id = n.id JOIN movie_info_idx mi_idx ON ci.movie_id = mi_idx.movie_id AND mi_idx.info_type_id = 101 JOIN movie_companies mc ON ci.movie_id = mc.movie_id WHERE ci.nr_order <= 51 AND mi_idx.info::numeric >= 5.0 GROUP BY n.name HAVING COUNT(DISTINCT ci.movie_id) > 5 ORDER BY average_movie_rating DESC, number_of_movies DESC LIMIT 10;
SELECT cn.name AS company_name, k.keyword AS keyword, COUNT(DISTINCT mk.movie_id) AS number_of_movies, COUNT(DISTINCT an.person_id) AS number_of_aka_names, AVG(cn.imdb_id) AS average_imdb_id_for_company FROM movie_keyword mk INNER JOIN keyword k ON mk.keyword_id = k.id INNER JOIN company_name cn ON cn.country_code = 'us' INNER JOIN aka_name an ON an.person_id != 0 WHERE mk.id IN (4493, 3974, 1711, 3754) AND mk.movie_id IN (18717, 12274, 9073) AND k.id IN (1749, 8745, 6590, 5243, 3691) GROUP BY cn.name, k.keyword ORDER BY number_of_movies DESC, number_of_aka_names DESC;
SELECT COUNT(ci.id) AS total_cast_entries, AVG(t.production_year) AS average_production_year, SUM(CASE WHEN ci.note LIKE '%(as %' THEN 1 ELSE 0 END) AS total_alias_castings, MIN(t.title) AS earliest_title_alphabetically, MAX(t.production_year) AS latest_production_year, AVG(mi_idx.info::NUMERIC) AS avg_info_numeric_value FROM cast_info AS ci JOIN title AS t ON ci.movie_id = t.id JOIN movie_info_idx AS mi_idx ON t.id = mi_idx.movie_id WHERE ci.person_id IN (1095, 1184, 1812, 1636) AND mi_idx.info LIKE '...%' GROUP BY ci.person_id
SELECT mc.company_id, COUNT(DISTINCT mc.movie_id) AS number_of_movies, cs.status_id, AVG(CAST(pi.info AS FLOAT)) FILTER (WHERE pi.info_type_id = 10) AS average_rating FROM movie_companies AS mc JOIN complete_cast AS cs ON mc.movie_id = cs.movie_id JOIN person_info AS pi ON cs.subject_id = pi.person_id GROUP BY mc.company_id, cs.status_id ORDER BY number_of_movies DESC, average_rating DESC;
SELECT kt.kind AS movie_type, COUNT(DISTINCT mi.movie_id) AS total_movies, AVG(CAST(mi_idx.info AS FLOAT)) AS average_rating, SUM(CASE WHEN k.keyword = 'disco-ball' THEN 1 ELSE 0 END) AS disco_ball_keyword_count, SUM(CASE WHEN k.keyword = 'bandana' THEN 1 ELSE 0 END) AS bandana_keyword_count, STRING_AGG(DISTINCT ct.kind, ', ') AS involved_company_types FROM movie_info mi JOIN movie_info_idx mi_idx ON mi.movie_id = mi_idx.movie_id AND mi.info_type_id = mi_idx.info_type_id JOIN kind_type kt ON kt.id = mi.info_type_id JOIN movie_info mii ON mii.movie_id = mi.movie_id JOIN link_type lt ON lt.id = mi_idx.id JOIN keyword k ON k.id = mi_idx.id JOIN company_type ct ON ct.id = mi_idx.id WHERE mi.id IN ('7268657', '7271065', '7267731') AND mi.movie_id IN ('924506', '925955', '929745', '938512', '930430') AND ct.kind IN ('special effects companies', 'miscellaneous companies', 'production companies', 'distributors') AND mi_idx.info SIMILAR TO '(%...[0-9]*[0-9].[0-9]*[0-9]%)' GROUP BY kt.kind;
