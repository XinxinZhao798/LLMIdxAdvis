SELECT cn.name AS character_name, COUNT(DISTINCT cl.movie_id) AS total_linked_movies, COUNT(ci.person_id) AS total_roles_played, AVG(ci.nr_order) AS average_role_order FROM char_name AS cn JOIN cast_info AS ci ON cn.id = ci.person_id JOIN movie_link AS cl ON ci.movie_id = cl.movie_id WHERE cn.name IN ('Boy Negro''s Gang', 'Lazoglu', 'Paco Hernández Gil', 'Tedddy Hart', 'Funcionario prisión', 'Make Up Man') GROUP BY cn.name ORDER BY total_linked_movies DESC, total_roles_played DESC;
SELECT ct.kind AS company_kind, AVG(CAST(mi_idx.info AS NUMERIC)) AS average_rating, COUNT(DISTINCT mk.movie_id) AS num_movies_with_keywords, COUNT(DISTINCT mc.movie_id) AS num_movies_by_company_type, COUNT(DISTINCT aka.name) AS unique_aka_names FROM movie_info_idx mi_idx JOIN info_type it ON mi_idx.info_type_id = it.id AND it.info = 'rating' JOIN movie_keyword mk ON mi_idx.movie_id = mk.movie_id JOIN movie_companies mc ON mk.movie_id = mc.movie_id JOIN company_type ct ON mc.company_type_id = ct.id LEFT JOIN aka_name aka ON aka.person_id = mc.company_id WHERE mk.keyword_id IN (2900, 3761, 2634) AND mc.company_type_id IN (SELECT id FROM company_type WHERE kind LIKE '%production%') AND aka.name_pcode_cf IN ('M65', 'S352', 'C64') GROUP BY ct.kind ORDER BY average_rating DESC;
SELECT ct.kind AS company_type, COUNT(DISTINCT mi_idx.movie_id) AS number_of_movies, AVG(CASE WHEN mi_idx.info_type_id = 100 THEN CAST(mi_idx.info AS FLOAT) END) AS average_rating, SUM(CASE WHEN mi_idx.info_type_id = 101 THEN CAST(mi_idx.info AS INTEGER) END) AS total_budget, COUNT(DISTINCT pi.person_id) AS number_of_persons_involved FROM movie_info_idx mi_idx JOIN company_type ct ON mi_idx.info_type_id = ct.id LEFT JOIN person_info pi ON mi_idx.movie_id = pi.person_id WHERE mi_idx.info_type_id IN (100, 101, 99) GROUP BY ct.kind;
SELECT it.info AS info_category, COUNT(DISTINCT mk.movie_id) AS number_of_movies, COUNT(DISTINCT k.id) AS number_of_unique_keywords, AVG(CAST(mi_idx.info AS numeric)) AS average_movie_info, SUM(CASE WHEN n.gender = 'm' THEN 1 ELSE 0 END) AS male_actors_count, SUM(CASE WHEN n.gender = 'f' THEN 1 ELSE 0 END) AS female_actors_count FROM info_type it JOIN movie_info_idx mi_idx ON it.id = mi_idx.info_type_id JOIN movie_keyword mk ON mi_idx.movie_id = mk.movie_id JOIN keyword k ON mk.keyword_id = k.id LEFT JOIN name n ON mi_idx.movie_id = n.id WHERE it.info IN ('crazy credits', 'bottom 10 rank', 'tech info', 'LD quality program', 'production process protocol') GROUP BY it.info;
SELECT AVG(t.production_year) AS average_production_year, COUNT(DISTINCT t.id) AS total_movies, COUNT(DISTINCT pi.person_id) AS total_people, SUM(CASE WHEN ct.kind = 'complete+verified' THEN 1 ELSE 0 END) AS complete_verified_casts, COUNT(DISTINCT pi.person_id) FILTER (WHERE pi.note IN ('AJ Addo', 'tina ansah', 'Fan Club President')) AS noted_persons FROM title AS t LEFT JOIN complete_cast AS cc ON t.id = cc.movie_id LEFT JOIN comp_cast_type AS ct ON cc.status_id = ct.id LEFT JOIN role_type AS rt ON cc.subject_id = rt.id LEFT JOIN person_info AS pi ON pi.person_id = t.id WHERE t.kind_id = 1 AND t.production_year BETWEEN 1990 AND 2005 AND (ct.id IN (2, 1, 4, 3) OR ct.id IS NULL) AND (pi.person_id IN (904, 1963, 736, 1740234, 1741102) OR pi.person_id IS NULL) GROUP BY t.kind_id;
SELECT kt.kind AS movie_kind, AVG(t.production_year) AS average_production_year, COUNT(DISTINCT t.id) AS total_movies, COUNT(DISTINCT n.id) AS total_actors, SUM(CASE WHEN n.gender = 'F' THEN 1 ELSE 0 END) AS female_actors, SUM(CASE WHEN n.gender = 'M' THEN 1 ELSE 0 END) AS male_actors, COUNT(DISTINCT k.id) AS total_keywords FROM title t JOIN kind_type kt ON t.kind_id = kt.id LEFT JOIN cast_info ci ON t.id = ci.movie_id LEFT JOIN name n ON ci.person_id = n.id LEFT JOIN movie_keyword mk ON t.id = mk.movie_id LEFT JOIN keyword k ON mk.keyword_id = k.id WHERE t.production_year BETWEEN 2000 AND 2020 AND kt.kind IN ('movie', 'tv series', 'video') AND t.season_nr IS NULL GROUP BY kt.kind ORDER BY total_movies DESC, average_production_year DESC;
SELECT rt.ROLE, COUNT(DISTINCT ci.movie_id) AS num_movies, COUNT(ci.person_id) AS num_performances, AVG(at.production_year) AS avg_production_year, SUM(CASE WHEN k.keyword = 'drama' THEN 1 ELSE 0 END) AS drama_keyword_count FROM cast_info ci JOIN role_type rt ON ci.role_id = rt.id JOIN aka_title at ON ci.movie_id = at.movie_id LEFT JOIN (SELECT mk.movie_id, k.keyword FROM movie_keyword mk JOIN keyword k ON mk.keyword_id = k.id) AS k ON ci.movie_id = k.movie_id WHERE rt.id IN ('12', '7', '9', '3') AND ci.person_id IN ('1145', '1200', '1289') AND at.movie_id IN ('19436', '18749', '11251', '18754', '17100') GROUP BY rt.ROLE HAVING COUNT(DISTINCT ci.movie_id) > 1 ORDER BY num_movies DESC, num_performances DESC;
SELECT rt.role, COUNT(DISTINCT n.id) AS number_of_people, AVG(t.production_year) AS average_production_year, MIN(t.production_year) AS earliest_production_year, MAX(t.production_year) AS latest_production_year, SUM(CASE WHEN mi.info = 'Cantonese' THEN 1 ELSE 0 END) AS cantonese_movies, SUM(CASE WHEN mi.info = 'Polish' THEN 1 ELSE 0 END) AS polish_movies, SUM(CASE WHEN mi.info = 'Russian' THEN 1 ELSE 0 END) AS russian_movies, SUM(CASE WHEN mi.info = 'Vietnamese' THEN 1 ELSE 0 END) AS vietnamese_movies, SUM(CASE WHEN mi.info = 'Faroese' THEN 1 ELSE 0 END) AS faroese_movies, SUM(CASE WHEN mi.info = 'Catalan' THEN 1 ELSE 0 END) AS catalan_movies FROM role_type rt JOIN movie_companies mc ON mc.company_type_id = rt.id JOIN title t ON mc.movie_id = t.id JOIN name n ON n.id = mc.company_id JOIN movie_info mi ON mi.movie_id = t.id AND mi.info_type_id = '4' WHERE rt.id = '8' AND rt.role = 'miscellaneous crew' GROUP BY rt.role;
SELECT ct.kind AS company_type, COUNT(DISTINCT mc.movie_id) AS total_movies, AVG(at.production_year) AS average_production_year, SUM(CASE WHEN at.season_nr IN ('6', '22', '9', '1') THEN 1 ELSE 0 END) AS total_seasonal_titles, COUNT(DISTINCT ml.movie_id) AS total_movies_with_links, COUNT(DISTINCT pi.person_id) AS total_people_with_info FROM company_type AS ct JOIN movie_companies AS mc ON ct.id = mc.company_type_id LEFT JOIN aka_title AS at ON mc.movie_id = at.movie_id LEFT JOIN movie_link AS ml ON mc.movie_id = ml.movie_id LEFT JOIN person_info AS pi ON pi.person_id = mc.movie_id WHERE ct.kind IN ('special effects companies', 'miscellaneous companies', 'production companies', 'distributors') GROUP BY ct.kind ORDER BY total_movies DESC;
SELECT COUNT(DISTINCT ci.person_id) AS total_actors, AVG(ci.nr_order) AS average_cast_position, SUM(CASE WHEN lt.link LIKE '%producer%' THEN 1 ELSE 0 END) AS total_producers_linked, COUNT(DISTINCT mk.keyword_id) AS total_unique_keywords, COUNT(DISTINCT mc.company_id) AS total_companies_involved FROM cast_info ci JOIN movie_companies mc ON ci.movie_id = mc.movie_id JOIN movie_keyword mk ON ci.movie_id = mk.movie_id JOIN link_type lt ON mc.company_type_id = lt.id WHERE ci.person_role_id IS NOT NULL AND mc.note IS NULL AND ci.movie_id IN (SELECT movie_id FROM movie_companies WHERE id = '3813') GROUP BY ci.movie_id;
SELECT kt.kind AS kind_of_movie, AVG(mi_idx.info::NUMERIC) AS average_rating, COUNT(DISTINCT t.id) AS number_of_movies, SUM(CASE WHEN mi.info = 'color' THEN 1 ELSE 0 END) AS number_of_color_movies, SUM(CASE WHEN mi.info = 'black and white' THEN 1 ELSE 0 END) AS number_of_black_and_white_movies, COUNT(DISTINCT mk.keyword_id) AS number_of_unique_keywords FROM title AS t JOIN kind_type AS kt ON t.kind_id = kt.id JOIN movie_info AS mi ON t.id = mi.movie_id JOIN movie_info_idx AS mi_idx ON t.id = mi_idx.movie_id JOIN movie_keyword AS mk ON t.id = mk.movie_id WHERE t.production_year IN (1976, 1989, 1952, 1990, 1959, 1967) AND mi.info_type_id IN (SELECT id FROM info_type WHERE info IN ('color', 'black and white')) AND mi_idx.info_type_id = (SELECT id FROM info_type WHERE info = 'rating') GROUP BY kt.kind ORDER BY average_rating DESC;
SELECT AVG(cast_info.nr_order) AS average_cast_order, COUNT(DISTINCT name.id) AS total_actors, COUNT(DISTINCT movie_keyword.movie_id) AS total_movies_with_keywords, SUM(CASE WHEN comp_cast_type.kind = 'complete+verified' THEN 1 ELSE 0 END) AS total_verified_casts, COUNT(DISTINCT movie_link.movie_id) AS total_movie_links, MAX(aka_title.production_year) AS latest_production_year FROM cast_info JOIN name ON cast_info.person_id = name.id JOIN movie_keyword ON cast_info.movie_id = movie_keyword.movie_id JOIN comp_cast_type ON cast_info.role_id = comp_cast_type.id JOIN aka_title ON cast_info.movie_id = aka_title.movie_id JOIN movie_link ON cast_info.movie_id = movie_link.movie_id WHERE comp_cast_type.kind IN ('complete+verified', 'cast', 'crew', 'complete') AND movie_keyword.keyword_id IN (3208, 869, 3853, 1657) AND aka_title.production_year BETWEEN 1990 AND 2020 GROUP BY aka_title.kind_id ORDER BY total_movies_with_keywords DESC, latest_production_year DESC;
SELECT kt.kind AS movie_type, COUNT(DISTINCT ml.movie_id) AS number_of_movies, COUNT(DISTINCT ml.linked_movie_id) AS number_of_linked_movies, AVG(n.imdb_id) AS average_imdb_id, SUM(CASE WHEN n.gender = 'f' THEN 1 ELSE 0 END) AS female_count, SUM(CASE WHEN n.gender = 'm' THEN 1 ELSE 0 END) AS male_count, COUNT(DISTINCT k.id) AS unique_keywords_used FROM movie_link AS ml JOIN complete_cast AS cc ON ml.movie_id = cc.movie_id JOIN kind_type AS kt ON kt.id = cc.status_id JOIN name AS n ON n.id = (SELECT subject_id FROM complete_cast WHERE movie_id = ml.movie_id LIMIT 1) JOIN movie_keyword AS mk ON mk.movie_id = ml.movie_id JOIN keyword AS k ON k.id = mk.keyword_id WHERE kt.id IN (7, 4) AND n.name_pcode_cf IN ('A2343', 'A3152', 'A6216', 'A2324', 'A436', 'A254') AND n.imdb_index = 'IV' AND k.phonetic_code IN ('S4623', 'I5264', 'U5321') AND k.keyword IN ('scavenging-for-food', 'garbage-truck', 'obscenity', 'red-wine', 'sexism', 'glass') GROUP BY kt.kind;
SELECT ct.kind AS company_kind, COUNT(DISTINCT cn.id) AS number_of_companies, COUNT(DISTINCT n.id) AS number_of_related_people, AVG(n.imdb_id) AS average_imdb_id, SUM(CASE WHEN k.keyword = 'business-deal' THEN 1 ELSE 0 END) AS count_business_deal_keywords, MAX(mi.info) AS latest_movie_info FROM company_name cn JOIN company_type ct ON cn.name_pcode_nf = ct.id::varchar JOIN movie_info mi ON mi.info_type_id = ct.id JOIN keyword k ON k.id = mi.movie_id JOIN name n ON n.imdb_id = mi.movie_id WHERE cn.country_code NOT IN ('[pl]', '[us]') AND k.keyword IN ('lunchbox', 'slipper', 'business-deal', 'child-molester') AND ct.kind IN ('special effects companies', 'miscellaneous companies', 'production companies', 'distributors') GROUP BY ct.kind ORDER BY number_of_companies DESC, count_business_deal_keywords DESC;
SELECT t.kind_id, COUNT(DISTINCT t.id) AS total_movies, AVG(t.production_year) AS average_production_year, SUM(CASE WHEN mi.info = 'Estonian' THEN 1 ELSE 0 END) AS total_estonian_movies, SUM(CASE WHEN mi.info = 'German' THEN 1 ELSE 0 END) AS total_german_movies, SUM(CASE WHEN mi.info = 'Dutch' THEN 1 ELSE 0 END) AS total_dutch_movies, SUM(CASE WHEN mi.info = 'Vietnamese' THEN 1 ELSE 0 END) AS total_vietnamese_movies, SUM(CASE WHEN mi.info = 'Greek' THEN 1 ELSE 0 END) AS total_greek_movies, SUM(CASE WHEN mi.info = 'Croatian' THEN 1 ELSE 0 END) AS total_croatian_movies, COUNT(DISTINCT an.id) AS total_aka_names, COUNT(DISTINCT cc.id) AS total_complete_casts, COUNT(DISTINCT lt.id) AS total_link_types FROM title AS t LEFT JOIN movie_info AS mi ON t.id = mi.movie_id AND mi.info_type_id = '4' LEFT JOIN aka_name AS an ON t.id = an.person_id LEFT JOIN complete_cast AS cc ON t.id = cc.movie_id AND cc.subject_id = '1' AND cc.status_id IN ('3', '4') LEFT JOIN link_type AS lt ON lt.link IN ('edited into', 'similar to', 'spin off from') GROUP BY t.kind_id;
SELECT ct.kind AS company_kind, COUNT(DISTINCT cc.movie_id) AS number_of_movies, COUNT(DISTINCT cc.subject_id) AS number_of_subjects, AVG(cc.status_id) AS average_status FROM company_type ct JOIN complete_cast cc ON ct.id = cc.status_id GROUP BY ct.kind HAVING COUNT(DISTINCT cc.movie_id) > 5 ORDER BY number_of_movies DESC, average_status ASC;
SELECT AVG(mi_idx.info::NUMERIC) AS average_movie_rating, COUNT(DISTINCT cn.name) AS number_of_production_companies, COUNT(DISTINCT chn.name) AS number_of_unique_character_names, SUM(CASE WHEN mw.movie_id IS NOT NULL THEN 1 ELSE 0 END) AS number_of_movies_with_keywords FROM movie_info_idx AS mi_idx JOIN movie_keyword AS mw ON mi_idx.movie_id = mw.movie_id JOIN company_name AS cn ON cn.imdb_id = mi_idx.movie_id JOIN char_name AS chn ON chn.imdb_id = mi_idx.movie_id WHERE mi_idx.info_type_id = 101 AND mw.keyword_id IN (918, 3849, 3998, 3575) AND cn.name_pcode_sf IN ('L1242', 'S5261', 'G6425', 'S621', 'A5356', 'W132') AND chn.name_pcode_nf IN ('H61', 'M5316', 'D36', 'D1363') GROUP BY cn.country_code ORDER BY average_movie_rating DESC;
