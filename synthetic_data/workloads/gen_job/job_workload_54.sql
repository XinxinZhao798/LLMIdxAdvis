SELECT AVG(a.production_year) AS average_production_year, COUNT(DISTINCT c.movie_id) AS number_of_movies, rt.ROLE, MAX(p.info) AS latest_person_info, COUNT(DISTINCT cn.id) AS number_of_people_with_role FROM aka_title AS a JOIN movie_companies AS c ON a.movie_id = c.movie_id JOIN role_type AS rt ON rt.ROLE IN ('writer', 'miscellaneous crew', 'production designer', 'actress') JOIN person_info AS p ON p.info_type_id = rt.id JOIN char_name AS cn ON cn.name_pcode_nf IN ('N6361', 'F6326', 'W6356') WHERE a.note IN ('(UK) (reissue title)', '(Hong Kong: English title) (video title)', '(West Germany) (Berlin film festival title)') AND c.company_id IN ('1064', '133') AND c.company_type_id = '1' AND a.production_year >= 2000 GROUP BY rt.ROLE ORDER BY number_of_movies DESC, average_production_year DESC;
SELECT ct.kind AS cast_type_kind, COUNT(DISTINCT ml.movie_id) AS number_of_movies, AVG(mi.info_type_id) AS average_info_type_id, COUNT(DISTINCT rt.id) AS distinct_role_types, SUM(CASE WHEN ml.linked_movie_id IN ('2506545', '2342579', '147212', '15711', '1448011') THEN 1 ELSE 0 END) AS linked_movies_count, STRING_AGG(DISTINCT mi.info, ', ') AS movie_languages FROM movie_link AS ml JOIN movie_info AS mi ON ml.movie_id = mi.movie_id JOIN comp_cast_type AS ct ON ml.link_type_id = ct.id JOIN role_type AS rt ON ct.id = rt.id WHERE mi.info IN ('Tatar', 'Arabic', 'Slovenian', 'Mandarin', 'Maori', 'Icelandic') AND rt.role IN ('actor', 'writer', 'miscellaneous crew', 'director') AND mi.id IN ('7270303', '7268889', '7270059', '7267623', '7271071', '7268128') AND ct.kind IN ('complete+verified', 'cast', 'crew', 'complete') GROUP BY ct.kind;
SELECT COUNT(DISTINCT ci.movie_id) AS number_of_movies, AVG(title.production_year) AS average_production_year, SUM(CASE WHEN n.gender = 'F' THEN 1 ELSE 0 END) AS female_cast_count, SUM(CASE WHEN n.gender = 'M' THEN 1 ELSE 0 END) AS male_cast_count, COUNT(DISTINCT n.id) AS total_cast_members, MIN(title.title) AS earliest_movie_title FROM cast_info ci INNER JOIN name n ON ci.person_id = n.id INNER JOIN title ON ci.movie_id = title.id INNER JOIN movie_info_idx mii ON title.id = mii.movie_id WHERE mii.info LIKE '1000111100' OR mii.info LIKE '....0213.2' OR mii.info LIKE '.....8...2' GROUP BY title.kind_id HAVING COUNT(DISTINCT ci.movie_id) > 5 ORDER BY average_production_year DESC;
SELECT rt.role, AVG(t.production_year) AS average_production_year, COUNT(DISTINCT t.id) AS movie_count FROM role_type rt JOIN movie_info_idx mii ON rt.id = mii.info_type_id JOIN title t ON mii.movie_id = t.id JOIN info_type it ON mii.info_type_id = it.id WHERE it.info = 'LD contrast' AND it.id IN ('74', '69') GROUP BY rt.role ORDER BY movie_count DESC, average_production_year DESC;
SELECT rt.ROLE, AVG(at.production_year) AS avg_production_year, COUNT(DISTINCT at.movie_id) AS movie_count, SUM(unique_name_count) AS unique_names_sum FROM aka_title at JOIN (SELECT id, COUNT(DISTINCT name) as unique_name_count FROM char_name GROUP BY id) cn ON at.movie_id = cn.id JOIN role_type rt ON cn.id = rt.id WHERE at.note IN ('(new title)', '(USA) (working title)') GROUP BY rt.ROLE;
SELECT AVG(akat.production_year) AS average_movie_year, COUNT(DISTINCT n.id) AS unique_actor_count, COUNT(DISTINCT akat.id) AS total_movie_aliases, SUM(CASE WHEN lt.link = 'remake of' THEN 1 ELSE 0 END) AS total_remake_links, SUM(CASE WHEN lt.link = 'edited from' THEN 1 ELSE 0 END) AS total_edited_from_links FROM aka_title akat JOIN name n ON akat.movie_id = n.id JOIN link_type lt ON lt.id = akat.movie_id WHERE akat.phonetic_code IN ('K2545', 'R5321', 'S1232', 'S3425', 'B5314') AND n.name_pcode_cf IN ('A465', 'A4634', 'A5212', 'A2516', 'A5261', 'A3561') AND akat.production_year BETWEEN 1990 AND 2020 AND n.gender = 'M' GROUP BY n.gender;
SELECT COUNT(DISTINCT cn.id) AS num_companies, COUNT(DISTINCT chn.id) AS num_characters, AVG(CAST(mi_idx.info AS DECIMAL)) AS average_movie_rating, SUM(CASE WHEN kt.id = '4' THEN 1 ELSE 0 END) AS num_tv_series, COUNT(DISTINCT cc.movie_id) AS num_movies_with_complete_cast FROM company_name cn LEFT JOIN movie_companies mc ON cn.id = mc.company_id LEFT JOIN char_name chn ON chn.surname_pcode IN ('O416', 'M65', 'L5163') LEFT JOIN complete_cast cc ON mc.movie_id = cc.movie_id LEFT JOIN movie_info_idx mi_idx ON mc.movie_id = mi_idx.movie_id LEFT JOIN kind_type kt ON cc.subject_id = kt.id LEFT JOIN info_type it ON mi_idx.info_type_id = it.id AND it.info = 'rating' WHERE cn.name_pcode_nf IN ('L2416', 'A2321') AND ( cn.id = '152' OR kt.id = '4' OR it.id IN ('29', '49', '97', '78') ) GROUP BY cn.country_code;
SELECT t.kind_id, COUNT(DISTINCT t.id) AS total_titles, AVG(t.production_year) AS average_production_year, SUM(CASE WHEN lt.link = 'featured in' THEN 1 ELSE 0 END) AS featured_in_count, SUM(CASE WHEN lt.link = 'references' THEN 1 ELSE 0 END) AS references_count, SUM(CASE WHEN lt.link = 'spoofed in' THEN 1 ELSE 0 END) AS spoofed_in_count, SUM(CASE WHEN lt.link = 'similar to' THEN 1 ELSE 0 END) AS similar_to_count, SUM(CASE WHEN lt.link = 'features' THEN 1 ELSE 0 END) AS features_count, SUM(CASE WHEN lt.link = 'followed by' THEN 1 ELSE 0 END) AS followed_by_count, COUNT(DISTINCT pi.person_id) AS unique_persons_involved, AVG(CASE WHEN pi.info_type_id = 1 THEN CAST(pi.info AS INTEGER) END) AS average_info_type_1, COUNT(DISTINCT CASE WHEN pi.note IS NOT NULL THEN pi.person_id END) AS count_persons_with_notes FROM title AS t JOIN link_type AS lt ON t.kind_id = lt.id LEFT JOIN person_info AS pi ON t.id = pi.person_id GROUP BY t.kind_id ORDER BY total_titles DESC;
SELECT ct.kind AS company_kind, COUNT(DISTINCT at.id) AS total_movies, AVG(CAST(mi_idx.info AS DECIMAL)) AS average_movie_rating, SUM(CASE WHEN k.keyword = 'staring' THEN 1 ELSE 0 END) AS count_staring_keyword, SUM(CASE WHEN k.keyword = 'disarming-someone' THEN 1 ELSE 0 END) AS count_disarming_keyword FROM company_type AS ct JOIN movie_companies AS mc ON ct.id = mc.company_type_id JOIN aka_title AS at ON mc.movie_id = at.id JOIN movie_info_idx AS mi_idx ON at.id = mi_idx.movie_id LEFT JOIN movie_keyword AS mk ON at.id = mk.movie_id LEFT JOIN keyword AS k ON mk.keyword_id = k.id WHERE ct.kind IN ('production companies', 'distributors') AND mi_idx.info_type_id = (SELECT id FROM info_type WHERE info = 'rating') AND CAST(mi_idx.info AS DECIMAL) >= 5.0 AND at.production_year BETWEEN 2000 AND 2010 GROUP BY ct.kind;
SELECT rt.ROLE, COUNT(ci.id) AS total_roles, AVG(ci.nr_order) AS average_order, SUM(mc.company_id) AS total_company_involvement FROM cast_info ci JOIN role_type rt ON ci.role_id = rt.id JOIN movie_companies mc ON ci.movie_id = mc.movie_id JOIN char_name cn ON ci.person_id = cn.id JOIN link_type lt ON cn.imdb_id = lt.id WHERE cn.surname_pcode IN ('M252', 'E4253', 'S3626', 'D535', 'K6524', 'P3625') AND cn.md5sum IN ('9e82cce9eed474fa357bbbdcdb9e9f99', '808e4e20a938e31d406296247307a377', '314b308705241e3843cfa0f420a3d71d', '161ebf33e0bbb8c7a20bed4ba04289b5') AND lt.link IN ('alternate language version of', 'spin off', 'referenced in', 'remade as', 'references', 'version of') AND lt.id IN ('17', '8', '6') GROUP BY rt.ROLE ORDER BY total_roles DESC;
SELECT COUNT(DISTINCT t.id) AS number_of_movies, AVG(t.production_year) AS average_production_year, SUM(CASE WHEN at.episode_of_id IS NOT NULL THEN 1 ELSE 0 END) AS number_of_episodes, it.info AS info_type_description, COUNT(DISTINCT an.person_id) AS number_of_actors, COUNT(DISTINCT at.movie_id) AS number_of_aka_titles FROM title AS t LEFT JOIN aka_title AS at ON t.id = at.movie_id LEFT JOIN movie_info_idx AS mi_idx ON t.id = mi_idx.movie_id LEFT JOIN info_type AS it ON mi_idx.info_type_id = it.id LEFT JOIN aka_name AS an ON an.id = mi_idx.movie_id WHERE t.production_year BETWEEN 1990 AND 2020 AND (mi_idx.info_type_id IN (100, 101, 99) OR mi_idx.info IS NOT NULL) AND (at.episode_of_id IN (24960, 8508, 3016, 7633) OR at.episode_of_id IS NULL) AND an.surname_pcode IN ('T653', 'E164', 'H56', 'A526') GROUP BY it.info;
SELECT info_type.info AS info_category, COUNT(DISTINCT movie_info.movie_id) AS number_of_movies, AVG(LENGTH(movie_info.info)) AS average_info_length, SUM(CASE WHEN comp_cast_type.kind = 'complete+verified' THEN 1 ELSE 0 END) AS complete_verified_count, SUM(CASE WHEN comp_cast_type.kind = 'cast' THEN 1 ELSE 0 END) AS cast_count, SUM(CASE WHEN comp_cast_type.kind = 'crew' THEN 1 ELSE 0 END) AS crew_count FROM movie_info JOIN info_type ON movie_info.info_type_id = info_type.id JOIN movie_info_idx ON movie_info.movie_id = movie_info_idx.movie_id JOIN comp_cast_type ON movie_info_idx.info_type_id = comp_cast_type.id WHERE info_type.info IN ('LD original title', 'LD quality of source', 'tech info', 'LD master format', 'salary history', 'LD release country') AND comp_cast_type.kind IN ('complete+verified', 'cast', 'crew', 'complete') GROUP BY info_type.info ORDER BY number_of_movies DESC;
SELECT ct.kind AS company_type, COUNT(DISTINCT cn.id) AS number_of_companies, COUNT(DISTINCT t.id) AS number_of_movies, AVG(t.production_year) AS average_production_year, SUM(CASE WHEN cn.country_code = '[us]' THEN 1 ELSE 0 END) AS us_based_companies, COUNT(DISTINCT mk.keyword_id) AS distinct_keywords_used, COUNT(DISTINCT ml.linked_movie_id) AS distinct_linked_movies FROM company_type AS ct JOIN movie_companies AS mc ON ct.id = mc.company_type_id JOIN company_name AS cn ON mc.company_id = cn.id JOIN title AS t ON mc.movie_id = t.id LEFT JOIN movie_keyword AS mk ON t.id = mk.movie_id LEFT JOIN movie_link AS ml ON t.id = ml.movie_id WHERE ct.id IN (3, 4) AND cn.country_code IN ('[mk]', '[ua]', '[kr]', '[ir]', '[ph]') GROUP BY ct.kind ORDER BY number_of_movies DESC;
SELECT COUNT(DISTINCT t.id) AS total_movies, AVG(t.production_year) AS average_production_year, SUM(CASE WHEN ml.link_type_id = 9 THEN 1 ELSE 0 END) AS total_sequels, COUNT(DISTINCT k.id) AS distinct_keywords, COUNT(DISTINCT mi_idx.movie_id) AS movies_with_trivia, MAX(t.production_year) AS latest_movie_year, MIN(t.production_year) AS earliest_movie_year FROM title AS t LEFT JOIN movie_link AS ml ON t.id = ml.movie_id LEFT JOIN movie_info_idx AS mi_idx ON t.id = mi_idx.movie_id LEFT JOIN info_type AS it ON mi_idx.info_type_id = it.id AND it.info = 'trivia' LEFT JOIN keyword AS k ON k.keyword = 'sequel' WHERE t.kind_id IN (SELECT id FROM comp_cast_type WHERE kind IN ('feature', 'tv series')) AND (ml.link_type_id IN (9, 5, 11, 16, 12, 15) OR ml.link_type_id IS NULL) AND (ml.linked_movie_id IN (1606280, 1432513, 1440129, 10552, 453927, 2160552) OR ml.linked_movie_id IS NULL) GROUP BY t.kind_id;
SELECT kt.kind AS movie_kind, COUNT(DISTINCT ci.movie_id) AS number_of_movies, COUNT(ci.person_id) AS number_of_cast_entries, AVG(ci.nr_order) AS average_cast_order, SUM(CASE WHEN rt.role = 'actor' THEN 1 ELSE 0 END) AS total_actors, SUM(CASE WHEN rt.role = 'actress' THEN 1 ELSE 0 END) AS total_actresses, COUNT(DISTINCT CASE WHEN ct.kind = 'production' THEN ci.movie_id END) AS number_of_production_movies, COUNT(DISTINCT CASE WHEN ct.kind = 'distributor' THEN ci.movie_id END) AS number_of_distributed_movies FROM cast_info ci JOIN role_type rt ON ci.role_id = rt.id JOIN kind_type kt ON ci.person_role_id = kt.id JOIN company_type ct ON ci.person_id = ct.id WHERE kt.kind = 'tv movie' AND ct.id IN (3, 4, 2) GROUP BY kt.kind HAVING COUNT(DISTINCT ci.movie_id) > 0;
SELECT it.info AS info_category, COUNT(DISTINCT cc.movie_id) AS number_of_movies, COUNT(DISTINCT cc.id) AS total_complete_cast_records, COUNT(DISTINCT mi_idx.movie_id) AS movies_with_additional_info, AVG(CAST(mi_idx.info AS INTEGER)) FILTER (WHERE it.info = 'votes') AS average_votes, SUM(CAST(mi_idx.info AS INTEGER)) FILTER (WHERE it.info = 'votes') AS total_votes, MIN(CAST(mi_idx.info AS INTEGER)) FILTER (WHERE it.info = 'votes') AS min_votes, MAX(CAST(mi_idx.info AS INTEGER)) FILTER (WHERE it.info = 'votes') AS max_votes, COUNT(DISTINCT lt.id) AS number_of_link_types, STRING_AGG(DISTINCT lt.link, ', ') AS link_types_used FROM complete_cast cc JOIN movie_info_idx mi_idx ON cc.movie_id = mi_idx.movie_id JOIN info_type it ON mi_idx.info_type_id = it.id JOIN link_type lt ON lt.id = mi_idx.info_type_id WHERE cc.status_id <> 0 AND it.info IN ('height', 'tech info', 'votes', 'mini biography') AND lt.link IN ('remake of', 'remade as', 'featured in', 'spin off') GROUP BY it.info;
SELECT COUNT(DISTINCT ci.movie_id) AS total_movies, COUNT(DISTINCT ci.person_id) AS total_actors, AVG(COUNT(ci.person_id)) OVER (PARTITION BY ci.movie_id) AS avg_roles_per_movie, COUNT(DISTINCT mc.company_id) AS total_companies, AVG(COUNT(mc.company_id)) OVER (PARTITION BY ci.movie_id) AS avg_companies_per_movie, COUNT(DISTINCT pi.info) AS total_ratings, AVG(CAST(pi.info AS NUMERIC)) AS average_rating FROM cast_info ci JOIN movie_link ml ON ci.movie_id = ml.movie_id OR ci.movie_id = ml.linked_movie_id JOIN person_info pi ON ci.person_id = pi.person_id LEFT JOIN movie_companies mc ON ci.movie_id = mc.movie_id WHERE ml.link_type_id IN (SELECT id FROM link_type WHERE link IN ('sequel', 'prequel')) AND pi.info_type_id = (SELECT id FROM info_type WHERE info = 'rating') GROUP BY ci.movie_id;
