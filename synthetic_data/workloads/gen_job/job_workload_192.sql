SELECT rt.role AS role_type, COUNT(DISTINCT n.id) AS number_of_people, AVG(n.imdb_id) AS average_imdb_id, SUM(CASE WHEN n.gender = 'F' THEN 1 ELSE 0 END) AS female_count, SUM(CASE WHEN n.gender = 'M' THEN 1 ELSE 0 END) AS male_count, COUNT(DISTINCT k.id) AS unique_keywords_used, COUNT(DISTINCT mi.movie_id) AS movies_with_notes FROM name n INNER JOIN role_type rt ON n.id = rt.id INNER JOIN keyword k ON k.phonetic_code IN ('S56', 'S12', 'S1535', 'B4535', 'A25', 'O123') INNER JOIN movie_info mi ON mi.info_type_id = k.id WHERE mi.note IN ('(some dialogue)', '(English subtitles)', '(Original version)', '(English version)') AND n.name_pcode_nf IN ('C4145', 'T641', 'Q5354', 'G6342', 'E2541') AND rt.role IN ('editor', 'director', 'production designer', 'cinematographer', 'miscellaneous crew') AND n.name IN ('Amores, Joaquín', 'Amor, Miguel Ángel', 'Anderson, Damion', 'Amokrane, Mustapha', 'Anderlik, Maddie', 'André, Emmanuel') GROUP BY rt.role;
SELECT t.title AS Movie_Title, t.production_year AS Production_Year, COUNT(DISTINCT mk.keyword_id) AS Number_of_Keywords, COUNT(DISTINCT mc.company_id) AS Number_of_Companies_Involved, AVG(t.production_year) OVER () AS Average_Production_Year, COUNT(*) OVER () AS Total_Movies_Analyzed FROM title AS t JOIN movie_keyword AS mk ON t.id = mk.movie_id JOIN movie_companies AS mc ON t.id = mc.movie_id JOIN movie_link AS ml ON t.id = ml.movie_id WHERE ml.link_type_id IN ('12', '11', '13', '6') AND t.series_years IN ('1985-????', '2004-????', '2013-????', '1988-????', '2010-2010') AND t.production_year > (SELECT AVG(production_year) FROM title) GROUP BY t.id HAVING COUNT(DISTINCT mk.keyword_id) > 5 ORDER BY Number_of_Keywords DESC, Production_Year DESC;
SELECT it.info AS genre, COUNT(DISTINCT mi.movie_id) AS number_of_movies, AVG(CAST(mi.info AS INTEGER)) AS average_votes, COUNT(DISTINCT ml.movie_id) AS number_of_linked_movies, COUNT(DISTINCT pi.person_id) AS number_of_persons_with_info, COUNT(DISTINCT mk.keyword_id) AS number_of_unique_keywords FROM movie_info mi JOIN info_type it ON mi.info_type_id = it.id AND it.info = 'genres' LEFT JOIN movie_link ml ON mi.movie_id = ml.movie_id AND ml.link_type_id IN (12, 16, 13, 8) LEFT JOIN person_info pi ON pi.info_type_id = 89 LEFT JOIN movie_keyword mk ON mi.movie_id = mk.movie_id WHERE mi.note NOT LIKE '%(interviews)%' AND mi.note NOT LIKE '%(some dialogue)%' AND mi.note NOT LIKE '%(English subtitles)%' AND mi.note NOT LIKE '%(Ukrainian)%' AND mi.note NOT LIKE '%(Original version)%' AND mi.note NOT LIKE '%(English Subtitles)%' GROUP BY genre;
SELECT rt.role, COUNT(DISTINCT ci.movie_id) AS total_movies, AVG(ci.person_count) AS avg_people_per_role FROM ( SELECT c.movie_id, c.role_id, COUNT(c.person_id) AS person_count FROM cast_info AS c INNER JOIN movie_companies AS mc ON c.movie_id = mc.movie_id WHERE (mc.note LIKE '%(USA) (TV)%' OR mc.note LIKE '%(USA) (DVD)%') GROUP BY c.movie_id, c.role_id ) AS ci INNER JOIN role_type AS rt ON ci.role_id = rt.id GROUP BY rt.role ORDER BY total_movies DESC, avg_people_per_role DESC;
SELECT AVG(t.production_year) AS average_production_year, COUNT(DISTINCT k.id) AS number_of_unique_keywords, SUM(CASE WHEN mc.company_type_id = 1 THEN 1 ELSE 0 END) AS number_of_production_companies, COUNT(DISTINCT mk.movie_id) AS number_of_movies_with_keywords, COUNT(DISTINCT t.id) AS total_movies FROM title AS t JOIN movie_keyword AS mk ON t.id = mk.movie_id JOIN keyword AS k ON mk.keyword_id = k.id JOIN movie_companies AS mc ON t.id = mc.movie_id JOIN complete_cast AS cc ON t.id = cc.movie_id WHERE t.production_year > 1990 AND mc.company_type_id IN (1, 2, 3) AND cc.status_id = 1 AND k.phonetic_code IN ('W25', 'P4232', 'G4323') GROUP BY t.kind_id HAVING COUNT(DISTINCT mc.company_id) > 5 ORDER BY average_production_year DESC;
