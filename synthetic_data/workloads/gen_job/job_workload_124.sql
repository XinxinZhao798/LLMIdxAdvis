SELECT rt.ROLE, COUNT(DISTINCT ci.movie_id) AS number_of_movies, AVG(ci.nr_order) AS average_cast_order, COUNT(DISTINCT name.id) AS number_of_unique_actors FROM cast_info ci JOIN role_type rt ON ci.role_id = rt.id JOIN name ON ci.person_id = name.id WHERE rt.id IN (1) AND ci.nr_order IS NOT NULL AND name.md5sum IN ('0d93c2f49007eb923f1f3983f0a8cc6b', 'c73602ee6ad37663369ca6e3bd40e7dd', 'db97c7dc12820b568f8351333075a92d', '53ebf953411448090e3e779bf1486727', 'f22535a12044b89484f9cba769cf437a', '6f608ba1bd4dd87eac0e663a877f54bc') GROUP BY rt.ROLE;
SELECT k.keyword, COUNT(DISTINCT ml.movie_id) AS linked_movies_count, AVG(sub_person_roles.roles_count) AS avg_roles_per_person, COUNT(DISTINCT an.id) AS unique_pseudonyms_count FROM keyword AS k LEFT JOIN movie_keyword AS mk ON k.id = mk.keyword_id LEFT JOIN movie_link AS ml ON mk.movie_id = ml.movie_id LEFT JOIN person_info AS pi ON pi.info_type_id = k.id LEFT JOIN (SELECT pi.person_id, COUNT(DISTINCT pi.info_type_id) AS roles_count FROM person_info AS pi INNER JOIN role_type AS rt ON pi.info_type_id = rt.id WHERE rt.id IN (1, 8, 7, 5) GROUP BY pi.person_id ) AS sub_person_roles ON pi.person_id = sub_person_roles.person_id LEFT JOIN aka_name AS an ON pi.person_id = an.person_id WHERE k.keyword IN ('murder', 'mystery', 'thriller') AND pi.info_type_id IN (70, 2, 75, 36, 50) GROUP BY k.keyword;
SELECT t.production_year, COUNT(DISTINCT t.id) AS total_titles, AVG(t.production_year) AS avg_production_year, SUM(CASE WHEN k.keyword = 'medical-emergency' THEN 1 ELSE 0 END) AS count_medical_emergency, COUNT(DISTINCT cc.movie_id) AS total_movies_with_complete_cast, COUNT(DISTINCT char_name.name) AS total_character_names FROM title AS t LEFT JOIN keyword AS k ON t.phonetic_code = k.phonetic_code LEFT JOIN complete_cast AS cc ON t.id = cc.movie_id LEFT JOIN char_name ON char_name.surname_pcode = t.md5sum WHERE t.production_year BETWEEN 1990 AND 2000 AND cc.status_id IN (3, 4) AND (k.keyword = 'audi-rs5' OR k.keyword = 'second-chance' OR k.keyword = 'little-boy') GROUP BY t.production_year ORDER BY total_titles DESC;
SELECT mi.info AS genre, COUNT(DISTINCT mi.movie_id) AS number_of_movies, AVG(mii.info::numeric) AS average_movie_length, SUM(CASE WHEN lt.LINK = 'followed by' THEN 1 ELSE 0 END) AS sequel_count FROM movie_info mi JOIN movie_info_idx mii ON mi.movie_id = mii.movie_id AND mi.info_type_id = mii.info_type_id LEFT JOIN link_type lt ON lt.id = mii.info_type_id WHERE mi.info_type_id = 4 AND mii.movie_id IN ('19615', '11115', '18537', '8949', '8884') AND lt.LINK IN ('similar to', 'features', 'followed by', 'alternate language version of') GROUP BY genre ORDER BY number_of_movies DESC, average_movie_length DESC;
SELECT AVG(ak.title_count) AS average_titles_per_movie, SUM(mc.company_count) AS total_companies_involved, COUNT(DISTINCT n.id) AS unique_actors_count FROM (SELECT movie_id, COUNT(*) AS title_count FROM aka_title GROUP BY movie_id) ak JOIN aka_title at ON ak.movie_id = at.movie_id JOIN (SELECT movie_id, COUNT(*) AS company_count FROM movie_companies GROUP BY movie_id) mc ON at.movie_id = mc.movie_id JOIN complete_cast cc ON at.movie_id = cc.movie_id JOIN comp_cast_type cct ON cc.subject_id = cct.id JOIN name n ON cc.movie_id = n.id JOIN movie_companies mcom ON mcom.movie_id = ak.movie_id JOIN company_type ct ON mcom.company_type_id = ct.id JOIN link_type lt ON lt.id = 15 WHERE cct.kind = 'actors' AND ct.kind LIKE '%production%' AND lt.link = 'features' AND at.production_year BETWEEN 2000 AND 2010 GROUP BY ak.movie_id;
SELECT lt.LINK AS link_type, COUNT(DISTINCT ml.movie_id) AS num_movies, COUNT(ml.id) AS total_links, AVG(sub_ml.movie_links_count) AS average_links_per_movie FROM movie_link AS ml JOIN link_type AS lt ON ml.link_type_id = lt.id JOIN movie_info_idx AS miidx ON ml.movie_id = miidx.movie_id JOIN (SELECT movie_id, COUNT(id) AS movie_links_count FROM movie_link GROUP BY movie_id) AS sub_ml ON sub_ml.movie_id = ml.movie_id WHERE miidx.info_type_id IN (SELECT id FROM company_type WHERE kind = 'special effects companies') GROUP BY lt.LINK;
SELECT lt.LINK AS link_type, COUNT(DISTINCT ml.movie_id) AS total_movies, AVG(ak.production_year) AS average_production_year, SUM(CASE WHEN ak.note LIKE '%(USA)%' THEN 1 ELSE 0 END) AS total_us_titles, COUNT(DISTINCT mk.keyword_id) AS distinct_keywords_used, COUNT(DISTINCT n.id) AS number_of_contributors FROM movie_link AS ml JOIN link_type AS lt ON ml.link_type_id = lt.id JOIN aka_title AS ak ON ml.movie_id = ak.movie_id JOIN movie_keyword AS mk ON ml.movie_id = mk.movie_id JOIN name AS n ON ak.id = n.id WHERE ak.title IS NOT NULL AND n.gender IN ('m', 'f') AND lt.id IN (3, 6) GROUP BY lt.LINK ORDER BY total_movies DESC;
SELECT COUNT(DISTINCT n.id) AS total_actors, AVG(t.production_year) AS average_production_year, SUM(CASE WHEN n.gender = 'F' THEN 1 ELSE 0 END) AS female_actors_count, SUM(CASE WHEN n.gender = 'M' THEN 1 ELSE 0 END) AS male_actors_count, COUNT(DISTINCT t.id) AS total_titles, MAX(t.production_year) AS latest_production_year, MIN(t.production_year) AS earliest_production_year, COUNT(DISTINCT k.id) AS total_keywords, t.series_years, n.surname_pcode FROM name AS n INNER JOIN title AS t ON n.id = t.id LEFT JOIN keyword AS k ON k.id = t.id WHERE n.surname_pcode IN ('A424', 'A414') AND t.series_years LIKE '1993-____' AND (k.id = '74' OR k.id = '8451') GROUP BY t.series_years, n.surname_pcode ORDER BY total_actors DESC, average_production_year DESC;
SELECT cn.name AS company_name, COUNT(DISTINCT mi_idx.movie_id) AS number_of_movies, AVG(CAST(mi_idx.info AS NUMERIC)) AS average_runtime, SUM(CASE WHEN it.info = 'locations' THEN 1 ELSE 0 END) AS total_locations, COUNT(DISTINCT mk.keyword_id) AS unique_keywords, COUNT(DISTINCT cc.movie_id) AS complete_cast_movies FROM movie_info_idx AS mi_idx JOIN info_type AS it ON mi_idx.info_type_id = it.id JOIN movie_keyword AS mk ON mi_idx.movie_id = mk.movie_id JOIN complete_cast AS cc ON mi_idx.movie_id = cc.movie_id JOIN company_name AS cn ON cn.imdb_id = mi_idx.movie_id WHERE it.info IN ('runtimes', 'locations') AND cn.name_pcode_nf = 'G2642' GROUP BY cn.name ORDER BY average_runtime DESC, number_of_movies DESC;
