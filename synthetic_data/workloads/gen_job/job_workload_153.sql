SELECT cct.kind AS cast_type, COUNT(DISTINCT mi.movie_id) AS total_movies, COUNT(DISTINCT k.id) AS total_keywords, AVG(COUNT(k.id)) OVER (PARTITION BY cct.kind) AS avg_keywords_per_movie FROM comp_cast_type AS cct JOIN movie_info_idx AS mi ON cct.id = mi.info_type_id JOIN keyword AS k ON mi.movie_id = k.id WHERE cct.kind IN ('complete', 'complete+verified') GROUP BY cct.kind;
SELECT cn.country_code, COUNT(DISTINCT ml.movie_id) AS total_movies, COUNT(DISTINCT ml.linked_movie_id) AS total_linked_movies, SUM(cc.subject_id) AS total_subjects, AVG(cc.status_id) AS average_status_id FROM movie_link AS ml JOIN complete_cast AS cc ON ml.movie_id = cc.movie_id JOIN company_name AS cn ON ml.movie_id = cn.imdb_id WHERE ml.movie_id IN (16753, 14650) GROUP BY cn.country_code ORDER BY total_movies DESC;
SELECT t.production_year, COUNT(DISTINCT t.id) AS movie_count, AVG(keyword_count) AS average_keywords_per_movie, COUNT(DISTINCT ci.person_id) AS distinct_actor_count FROM title t LEFT JOIN ( SELECT movie_id, COUNT(keyword_id) AS keyword_count FROM movie_keyword GROUP BY movie_id ) AS mk ON t.id = mk.movie_id LEFT JOIN cast_info ci ON t.id = ci.movie_id AND ci.role_id = (SELECT id FROM role_type WHERE role = 'actor') LEFT JOIN name n ON ci.person_id = n.id WHERE t.production_year IS NOT NULL GROUP BY t.production_year ORDER BY t.production_year;
SELECT AVG(ml.link_type_id) AS average_link_type, COUNT(DISTINCT cn.id) AS total_unique_characters, SUM(CASE WHEN mi.info_type_id = 2 THEN 1 ELSE 0 END) AS total_drama_movies, MIN(cn.name) AS first_character_name FROM char_name cn JOIN movie_link ml ON cn.imdb_id = ml.movie_id JOIN movie_info mi ON ml.movie_id = mi.movie_id WHERE cn.imdb_index = 'tt' AND mi.info LIKE '%Drama%' GROUP BY cn.imdb_id HAVING COUNT(DISTINCT ml.id) > 3;
SELECT kt.kind, COUNT(DISTINCT t.id) AS num_productions, AVG(cast_count.num_cast) AS avg_cast_members, MAX(t.production_year) AS latest_production_year, MIN(t.production_year) AS earliest_production_year FROM title t JOIN kind_type kt ON t.kind_id = kt.id LEFT JOIN ( SELECT movie_id, COUNT(*) AS num_cast FROM cast_info GROUP BY movie_id ) cast_count ON t.id = cast_count.movie_id GROUP BY kt.kind ORDER BY num_productions DESC, avg_cast_members DESC;
SELECT it.info AS info_category, COUNT(*) AS total_entries, COUNT(DISTINCT mc.movie_id) AS distinct_movies_involved, COUNT(DISTINCT mc.company_id) AS distinct_companies_involved FROM movie_info mi JOIN info_type it ON mi.info_type_id = it.id JOIN movie_companies mc ON mi.movie_id = mc.movie_id WHERE it.info IN ('crazy credits', 'locations', 'mpaa', 'LD group genre', 'LD number of chapter stops') GROUP BY it.info ORDER BY total_entries DESC;
SELECT kt.kind, AVG(ci.nr_order) AS average_cast_order, COUNT(DISTINCT ml.movie_id) AS total_linked_movies, SUM(CASE WHEN cc.status_id = 4 THEN 1 ELSE 0 END) AS total_complete_status_4, COUNT(DISTINCT pi.person_id) AS unique_persons_with_info FROM kind_type kt LEFT JOIN movie_link ml ON kt.id = ml.link_type_id LEFT JOIN complete_cast cc ON ml.movie_id = cc.movie_id LEFT JOIN cast_info ci ON ml.movie_id = ci.movie_id LEFT JOIN person_info pi ON ci.person_id = pi.person_id WHERE ml.movie_id IN (50, 8753, 6613, 11172, 11020, 10583) AND ml.link_type_id IN (4, 13, 9) AND cc.subject_id = 1 AND cc.status_id IN (4, 3) AND pi.note IN ('matt-282', 'K-maf', '2Fun', 'Todd Adelman') AND pi.id IN (4001, 3574) AND ci.person_role_id IN (533, 546, 1445) GROUP BY kt.kind;
SELECT kt.kind, COUNT(DISTINCT cc.movie_id) AS number_of_movies, AVG(cc.status_id) AS average_status_id, SUM(CASE WHEN n.gender = 'f' THEN 1 ELSE 0 END) AS female_cast_count, SUM(CASE WHEN n.gender = 'm' THEN 1 ELSE 0 END) AS male_cast_count FROM complete_cast cc JOIN kind_type kt ON cc.subject_id = kt.id JOIN name n ON cc.movie_id = n.id WHERE kt.kind IN ('video movie', 'tv series') GROUP BY kt.kind ORDER BY number_of_movies DESC;
SELECT AVG(CASE WHEN mi.info_type_id = 101 THEN mi.info::NUMERIC END) AS average_rating, COUNT(DISTINCT ci.movie_id) AS total_movies_with_cast, COUNT(DISTINCT mc.company_id) AS total_companies_involved, SUM(CASE WHEN t.kind_id = 1 THEN 1 ELSE 0 END) AS total_movies, SUM(CASE WHEN t.kind_id = 2 THEN 1 ELSE 0 END) AS total_tv_shows FROM title t LEFT JOIN movie_info mi ON mi.movie_id = t.id AND mi.info_type_id = 101 LEFT JOIN movie_companies mc ON t.id = mc.movie_id LEFT JOIN aka_title at ON at.movie_id = t.id LEFT JOIN comp_cast_type cct ON cct.id = t.kind_id LEFT JOIN movie_link ml ON ml.movie_id = t.id LEFT JOIN cast_info ci ON ci.movie_id = t.id WHERE t.production_year BETWEEN 1990 AND 2000 AND (cct.kind = 'cast' OR cct.kind IS NULL) AND (mi.info::NUMERIC > 5 OR mi.info IS NULL) AND mc.movie_id IN ('27126', '18504', '29107', '9067', '19664') AND mc.id IN ('2907', '3863', '4319') AND (at.title LIKE 'äÎÅ×ÎÉË ÕÂÉÊÃÙ' OR at.title IS NULL) AND (mi.note LIKE '%(only a few lines)%' OR mi.note IS NULL) GROUP BY t.kind_id;
SELECT rt.ROLE, COUNT(DISTINCT ci.movie_id) AS number_of_movies, AVG(n.imdb_id) AS average_imdb_id, SUM(ci.nr_order) AS total_order_sum, COUNT(DISTINCT ci.person_id) AS unique_actors, COUNT(DISTINCT mi.movie_id) AS movies_with_info, COUNT(DISTINCT ml.linked_movie_id) AS linked_movies_count FROM role_type rt JOIN cast_info ci ON rt.id = ci.role_id JOIN name n ON ci.person_id = n.id LEFT JOIN movie_info mi ON ci.movie_id = mi.movie_id LEFT JOIN movie_link ml ON ci.movie_id = ml.movie_id WHERE ci.nr_order IS NOT NULL AND mi.info_type_id IN (SELECT id FROM info_type WHERE info = 'rating') AND ci.movie_id IN ('929798', '929796', '924886', '927401', '924550', '927661') AND ci.person_id IN ('1575', '1023', '1432', '1713') AND ml.linked_movie_id IN ('1915722', '1526520') AND n.gender IN ('M', 'F') GROUP BY rt.ROLE ORDER BY number_of_movies DESC;
SELECT AVG(ci.nr_order) AS average_cast_order, COUNT(DISTINCT ci.person_id) AS total_unique_actors, SUM(CASE WHEN cc.status_id = 4 THEN 1 ELSE 0 END) AS count_complete_status, SUM(CASE WHEN cc.status_id = 3 THEN 1 ELSE 0 END) AS count_incomplete_status, COUNT(DISTINCT an.id) AS total_aka_names FROM cast_info AS ci JOIN complete_cast AS cc ON ci.movie_id = cc.movie_id LEFT JOIN aka_name AS an ON ci.person_id = an.person_id WHERE ci.role_id = 1 AND cc.id IN (1863, 310, 417, 31, 2902, 329) GROUP BY ci.movie_id;
SELECT kt.kind AS movie_kind, COUNT(DISTINCT t.id) AS total_movies, AVG(t.production_year) AS average_production_year, COUNT(DISTINCT a.id) AS total_alternate_titles, COUNT(DISTINCT n.id) AS total_unique_actors, SUM(CASE WHEN ml.link_type_id = 1 THEN 1 ELSE 0 END) AS total_sequels FROM kind_type kt JOIN aka_title a ON kt.id = a.kind_id JOIN title t ON a.movie_id = t.id JOIN cast_info ci ON t.id = ci.movie_id JOIN name n ON ci.person_id = n.id LEFT JOIN movie_link ml ON t.id = ml.movie_id AND ml.link_type_id = 1 GROUP BY kt.kind ORDER BY total_movies DESC;
SELECT rt.role, COUNT(DISTINCT ci.movie_id) AS total_movies, AVG(ci.person_count) AS avg_people_per_role FROM ( SELECT c.movie_id, c.role_id, COUNT(c.person_id) AS person_count FROM cast_info AS c INNER JOIN movie_companies AS mc ON c.movie_id = mc.movie_id WHERE (mc.note LIKE '%(USA) (TV)%' OR mc.note LIKE '%(USA) (DVD)%') GROUP BY c.movie_id, c.role_id ) AS ci INNER JOIN role_type AS rt ON ci.role_id = rt.id GROUP BY rt.role ORDER BY total_movies DESC, avg_people_per_role DESC;
SELECT rt.ROLE, COUNT(ci.id) AS num_roles, AVG(ci.nr_order) AS avg_order, COUNT(DISTINCT ci.person_id) AS unique_actors, COUNT(DISTINCT cn.id) AS character_count FROM cast_info ci JOIN role_type rt ON ci.role_id = rt.id LEFT JOIN char_name cn ON ci.person_role_id = cn.id GROUP BY rt.ROLE ORDER BY num_roles DESC;
SELECT rt.ROLE AS role, COUNT(DISTINCT ci.person_id) AS unique_person_count, AVG(t.production_year) AS average_production_year, SUM(CASE WHEN cn.country_code = '[us]' THEN 1 ELSE 0 END) AS total_us_produced_movies, COUNT(DISTINCT t.id) AS total_movies FROM cast_info ci JOIN title t ON ci.movie_id = t.id JOIN role_type rt ON ci.role_id = rt.id JOIN company_name cn ON cn.imdb_id = t.imdb_id WHERE t.series_years IN ('1985-1987', '2000-2004', '2010-2011') AND t.episode_of_id IS NULL AND rt.ROLE IN ('producer', 'costume designer', 'director') AND ci.role_id = rt.id AND (cn.country_code IN ('[md]', '[ro]', '[kr]', '[br]', '[sa]') OR cn.country_code = '[us]') GROUP BY rt.ROLE;
SELECT cn.name AS company_name, COUNT(DISTINCT t.movie_id) AS total_movies, AVG(t.production_year) AS average_production_year, COUNT(DISTINCT CASE WHEN kt.kind = 'episode' THEN t.movie_id END) AS total_episodes, COUNT(DISTINCT CASE WHEN kt.kind = 'video game' THEN t.movie_id END) AS total_video_games FROM company_name cn JOIN movie_companies mc ON cn.id = mc.company_id JOIN aka_title t ON mc.movie_id = t.movie_id JOIN kind_type kt ON t.kind_id = kt.id WHERE cn.country_code = '[us]' AND t.production_year > 2000 GROUP BY cn.name ORDER BY total_movies DESC, average_production_year DESC;
SELECT ct.kind AS company_kind, AVG(at.production_year) AS average_production_year, COUNT(DISTINCT k.id) AS unique_keywords_count, COUNT(DISTINCT at.id) AS alternate_titles_count, SUM(CASE WHEN mic.info_type_id = '100' THEN 1 ELSE 0 END) AS count_info_type_100, SUM(CASE WHEN mic.info_type_id = '101' THEN 1 ELSE 0 END) AS count_info_type_101, SUM(CASE WHEN mic.info_type_id = '99' THEN 1 ELSE 0 END) AS count_info_type_99 FROM movie_companies AS mc JOIN company_type AS ct ON mc.company_type_id = ct.id JOIN aka_title AS at ON mc.movie_id = at.movie_id JOIN movie_info_idx AS mic ON mc.movie_id = mic.movie_id LEFT JOIN keyword AS k ON at.movie_id = k.id WHERE ct.kind = 'miscellaneous companies' AND mc.id IN ('1733', '1292', '472', '1920', '683', '4338') GROUP BY ct.kind;
SELECT cn.name AS company_name, COUNT(DISTINCT pers_info.movie_id) AS number_of_movies, AVG(pers_info.avg_actor_age) AS average_actor_age, SUM(CASE WHEN mi_idx.info = 'color' THEN 1 ELSE 0 END) AS color_movie_count, SUM(CASE WHEN mi_idx.info = 'black and white' THEN 1 ELSE 0 END) AS bw_movie_count FROM company_name cn JOIN movie_info_idx mi_idx ON cn.imdb_id = mi_idx.movie_id JOIN (SELECT ci.movie_id, AVG(CAST(info AS INTEGER)) AS avg_actor_age FROM cast_info ci JOIN person_info pi ON ci.person_id = pi.person_id AND pi.info_type_id = 1 WHERE ci.role_id = (SELECT id FROM cast_info WHERE note = 'actor' LIMIT 1) GROUP BY ci.movie_id) pers_info ON mi_idx.movie_id = pers_info.movie_id WHERE cn.name_pcode_sf IN ('I5164', 'C3132') GROUP BY cn.name;
SELECT rt.ROLE, COUNT(DISTINCT ci.person_id) AS num_of_people, AVG(ci.nr_order) AS average_order, SUM(CASE WHEN cct.kind = 'complete+verified' THEN 1 ELSE 0 END) AS num_complete_verified, cn.country_code, COUNT(DISTINCT mk.keyword_id) AS num_of_keywords, AVG(CASE WHEN mi.info SIMILAR TO '[0-9]+\.[0-9]' THEN CAST(mi.info AS FLOAT) ELSE NULL END) AS average_info_numeric FROM cast_info ci INNER JOIN role_type rt ON ci.role_id = rt.id LEFT JOIN comp_cast_type cct ON ci.person_role_id = cct.id LEFT JOIN company_name cn ON ci.person_id = cn.imdb_id LEFT JOIN movie_keyword mk ON ci.movie_id = mk.movie_id LEFT JOIN movie_info_idx mi ON ci.movie_id = mi.movie_id WHERE mi.movie_id::VARCHAR LIKE '%19410%' AND mi.info SIMILAR TO '(0|84|349|11\.7)%' AND mk.id IN (1932, 3564, 2558, 997, 3482, 1435) GROUP BY rt.ROLE, cn.country_code ORDER BY num_of_people DESC, average_order ASC;
SELECT ct.kind AS company_type, kt.kind AS movie_type, COUNT(DISTINCT ci.movie_id) AS num_movies, AVG(ci.nr_order) AS average_cast_order, SUM(CASE WHEN ci.role_id = 1 THEN 1 ELSE 0 END) AS num_lead_roles, COUNT(DISTINCT cn.id) AS num_unique_characters FROM movie_companies AS mc JOIN comp_cast_type AS ct ON mc.company_type_id = ct.id JOIN kind_type AS kt ON kt.kind = 'movie' JOIN cast_info AS ci ON mc.movie_id = ci.movie_id JOIN char_name AS cn ON cn.id = ci.person_id WHERE mc.company_id IN (1227, 1142) AND cn.surname_pcode IN ('B62', 'C534', 'D6354') GROUP BY ct.kind, kt.kind ORDER BY num_movies DESC;
SELECT cn.country_code, ct.kind AS genre, COUNT(t.id) AS total_movies, AVG(t.production_year) AS avg_production_year, SUM(CASE WHEN ml.link_type_id = 1 THEN 1 ELSE 0 END) AS total_sequels FROM title AS t JOIN company_name AS cn ON t.id = cn.imdb_id JOIN comp_cast_type AS ct ON t.kind_id = ct.id LEFT JOIN movie_link AS ml ON t.id = ml.movie_id AND ml.link_type_id = 1 WHERE t.production_year BETWEEN 2000 AND 2020 AND cn.country_code IN ('US', 'GB', 'CA') GROUP BY cn.country_code, ct.kind ORDER BY cn.country_code, total_movies DESC;
SELECT n.gender, COUNT(DISTINCT ci.person_id) AS unique_actors, COUNT(DISTINCT ci.movie_id) AS movies_participated, AVG(ci.nr_order) AS average_cast_order, SUM(CASE WHEN kt.kind = 'movie' THEN 1 ELSE 0 END) AS total_movies, SUM(CASE WHEN kt.kind = 'tv' THEN 1 ELSE 0 END) AS total_tv_shows, MAX(ci.nr_order) AS highest_cast_position, MIN(ci.nr_order) AS lowest_cast_position FROM cast_info ci JOIN movie_companies mc ON ci.movie_id = mc.movie_id JOIN kind_type kt ON mc.company_type_id = kt.id JOIN name n ON ci.person_id = n.id WHERE ci.note NOT LIKE '%archive footage%' AND n.gender = 'm' GROUP BY n.gender;
