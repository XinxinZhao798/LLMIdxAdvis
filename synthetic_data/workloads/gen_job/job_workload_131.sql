SELECT COUNT(DISTINCT akat.movie_id) AS total_movies, AVG(CAST(akat.production_year AS DECIMAL)) AS average_production_year, SUM(CASE WHEN mi.note IS NOT NULL THEN 1 ELSE 0 END) AS total_movies_with_notes, COUNT(DISTINCT mk.keyword_id) AS unique_keywords_used, COUNT(DISTINCT mc.company_id) AS total_companies_involved, SUM(CASE WHEN it.info = 'English' THEN 1 ELSE 0 END) AS total_english_language_movies FROM aka_title akat JOIN movie_info mi ON akat.movie_id = mi.movie_id JOIN movie_info_idx miidx ON akat.movie_id = miidx.movie_id JOIN movie_keyword mk ON akat.movie_id = mk.movie_id JOIN movie_companies mc ON akat.movie_id = mc.movie_id JOIN info_type it ON mi.info_type_id = it.id WHERE akat.production_year IN (1979, 1966) AND mc.company_type_id IN (SELECT id FROM link_type WHERE id = 7) AND mk.id IN (3803, 847) GROUP BY akat.kind_id;
SELECT kt.kind AS movie_kind, COUNT(DISTINCT mc.movie_id) AS number_of_movies, COUNT(DISTINCT mc.company_id) AS number_of_companies, SUM(pi.id) AS total_person_info_records, COUNT(DISTINCT k.id) AS unique_keywords_count FROM movie_companies AS mc JOIN kind_type AS kt ON mc.company_type_id = kt.id JOIN name AS n ON mc.movie_id = n.id JOIN person_info AS pi ON pi.person_id = n.id JOIN keyword AS k ON k.id = pi.id WHERE kt.id IN ('7', '6', '2', '5') AND k.keyword IN ('24-hours', 'compassion') AND n.surname_pcode IN ('A415', 'A4') AND pi.note IN ('Jack Backstreet', 'Zaid Adham', 'David Adler', 'John Dream', 'Trace''s Publicist') GROUP BY kt.kind ORDER BY number_of_movies DESC;
SELECT kt.kind AS movie_type, AVG(a.production_year) AS average_production_year, COUNT(DISTINCT mk.movie_id) AS movie_count, SUM(mi.info::integer) AS total_info_numeric, COUNT(DISTINCT c.person_id) AS unique_actors_count FROM aka_title a JOIN kind_type kt ON a.kind_id = kt.id JOIN movie_info_idx mi ON a.movie_id = mi.movie_id JOIN movie_keyword mk ON a.movie_id = mk.movie_id JOIN cast_info c ON a.movie_id = c.movie_id WHERE a.production_year BETWEEN 1990 AND 2000 AND mk.keyword_id IN (780, 3464, 2349, 1994, 1285, 705) AND mi.movie_id IN (13634, 18372, 13503, 18944, 19411, 8878) AND mi.info SIMILAR TO '[0-9]+' AND c.role_id = 1 GROUP BY kt.kind ORDER BY movie_count DESC;
SELECT AVG(at.note_length) AS avg_note_length, COUNT(DISTINCT kw.id) AS num_unique_keywords, COUNT(DISTINCT at.id) AS num_titles, SUM(CASE WHEN at.episode_nr = 155 THEN 1 ELSE 0 END) AS num_episode_155, STRING_AGG(DISTINCT kw.keyword, ', ') AS keywords_list FROM ( SELECT id, movie_id, episode_nr, LENGTH(note) AS note_length FROM aka_title WHERE note LIKE '%(Australia) (fake working title)%' ) AS at JOIN movie_companies AS mc ON at.movie_id = mc.movie_id JOIN company_name AS cn ON mc.company_id = cn.id JOIN company_type AS ct ON mc.company_type_id = ct.id JOIN keyword AS kw ON cn.country_code = kw.phonetic_code WHERE kw.keyword IN ('handcuffed-to-someone', 'religious', 'drug-trafficking', 'conservatory', 'scientology', 'horse-riding') AND ct.kind = 'production companies' GROUP BY cn.country_code;
SELECT ct.kind as company_type, avg(at.production_year) as average_production_year, count(distinct at.id) as total_movies, count(distinct ml.movie_id) as total_linked_movies, sum(CASE WHEN at.kind_id = 3 THEN 1 ELSE 0 END) as total_kind_id_3, sum(CASE WHEN at.kind_id = 4 THEN 1 ELSE 0 END) as total_kind_id_4 FROM aka_title at JOIN movie_link ml ON at.movie_id = ml.movie_id JOIN company_type ct ON ml.link_type_id = ct.id WHERE at.kind_id IN (3, 4) AND ml.linked_movie_id IN (766538, 436, 2392833, 1659295, 2490166) AND at.production_year > 2000 GROUP BY ct.kind;
SELECT ct.kind AS company_type, COUNT(DISTINCT mc.company_id) AS number_of_companies, COUNT(DISTINCT mc.movie_id) AS number_of_movies, AVG(k.id) AS average_keyword_id, SUM(CASE WHEN k.keyword = 'personal-stories' THEN 1 ELSE 0 END) AS count_personal_stories, SUM(CASE WHEN k.keyword = 'toyota-starlet' THEN 1 ELSE 0 END) AS count_toyota_starlet FROM movie_companies AS mc JOIN company_type AS ct ON mc.company_type_id = ct.id JOIN company_name AS cn ON mc.company_id = cn.id JOIN keyword AS k ON k.phonetic_code = cn.name_pcode_nf GROUP BY ct.kind ORDER BY number_of_companies DESC, number_of_movies DESC;
SELECT cc.kind AS cast_type, COUNT(DISTINCT ci.movie_id) AS number_of_movies, AVG(ci.nr_order) AS average_cast_order, COUNT(DISTINCT cn.id) AS number_of_companies, lt.link AS link_type, COUNT(DISTINCT ml.linked_movie_id) AS number_of_linked_movies FROM cast_info ci JOIN comp_cast_type cc ON ci.role_id = cc.id JOIN complete_cast c ON ci.movie_id = c.movie_id JOIN company_name cn ON cn.country_code LIKE 'US%' JOIN movie_link ml ON ci.movie_id = ml.movie_id JOIN link_type lt ON ml.link_type_id = lt.id WHERE cc.kind IN ('complete+verified', 'complete', 'cast') AND lt.link IN ('spoofs', 'spoofed in', 'follows', 'edited into', 'referenced in') GROUP BY cc.kind, lt.link ORDER BY number_of_movies DESC, average_cast_order ASC;
SELECT kt.kind AS movie_kind, AVG(t.production_year) AS avg_production_year, SUM(CASE WHEN rt.role = 'actress' THEN 1 ELSE 0 END) AS total_actress_roles, SUM(CASE WHEN rt.role = 'producer' THEN 1 ELSE 0 END) AS total_producer_roles, COUNT(DISTINCT mc.company_id) AS number_of_companies_involved FROM title AS t JOIN kind_type AS kt ON t.kind_id = kt.id LEFT JOIN movie_companies AS mc ON t.id = mc.movie_id LEFT JOIN movie_info AS mi ON t.id = mi.movie_id LEFT JOIN role_type AS rt ON mi.info_type_id = rt.id AND rt.role IN ('actress', 'producer') GROUP BY kt.kind ORDER BY number_of_companies_involved DESC, avg_production_year;
SELECT rt.ROLE, COUNT(mc.movie_id) AS number_of_movies, AVG(alt.production_year) AS average_production_year, SUM(CASE WHEN lt.LINK = 'sequel' THEN 1 ELSE 0 END) AS sequel_count, COUNT(DISTINCT mc.company_id) AS distinct_companies_involved FROM aka_title alt INNER JOIN movie_companies mc ON alt.movie_id = mc.movie_id INNER JOIN link_type lt ON lt.id = alt.kind_id INNER JOIN role_type rt ON rt.id = mc.company_type_id WHERE rt.id IN ('1', '8') GROUP BY rt.ROLE ORDER BY number_of_movies DESC;
SELECT t.kind_id, t.production_year, COUNT(DISTINCT t.id) AS number_of_titles, COUNT(DISTINCT n.id) AS number_of_unique_persons, AVG(CAST(mi.info AS FLOAT)) AS average_movie_length, SUM(CASE WHEN at.episode_nr IS NOT NULL THEN 1 ELSE 0 END) AS number_of_episodes FROM title t LEFT JOIN aka_title at ON t.id = at.movie_id LEFT JOIN movie_info_idx mi ON t.id = mi.movie_id AND mi.info_type_id = 100 LEFT JOIN complete_cast cc ON t.id = cc.movie_id LEFT JOIN name n ON cc.subject_id = n.id WHERE t.production_year BETWEEN 2000 AND 2020 AND t.kind_id IN (1, 2, 3) GROUP BY t.kind_id, t.production_year ORDER BY t.kind_id, t.production_year;
SELECT kt.kind, COUNT(DISTINCT mc.movie_id) AS number_of_movies, COUNT(DISTINCT ci.person_id) AS number_of_people, AVG(mc.company_id) AS average_company_id, SUM(CASE WHEN ct.kind = 'producer' THEN 1 ELSE 0 END) AS number_of_producers, MAX(ci.nr_order) AS max_cast_order FROM movie_companies mc JOIN company_type ct ON mc.company_type_id = ct.id JOIN kind_type kt ON ct.id = kt.id LEFT JOIN cast_info ci ON mc.movie_id = ci.movie_id WHERE kt.kind IN ('movie', 'tv series', 'tv movie') AND ct.kind IN ('distributor', 'producer') GROUP BY kt.kind ORDER BY number_of_movies DESC;
SELECT kt.kind AS content_type, COUNT(DISTINCT chn.id) AS unique_characters, AVG(comp_cast_type.id) AS average_comp_cast_type_id, COUNT(DISTINCT company_type.id) AS number_of_company_types FROM char_name AS chn JOIN kind_type AS kt ON chn.id = kt.id JOIN comp_cast_type ON chn.id = comp_cast_type.id JOIN company_type ON chn.id = company_type.id WHERE kt.kind IN ('tv movie', 'tv series', 'video game', 'movie', 'episode', 'video movie') AND company_type.kind IN ('special effects companies', 'miscellaneous companies', 'production companies', 'distributors') GROUP BY kt.kind ORDER BY unique_characters DESC, average_comp_cast_type_id;
SELECT it.info AS info_type_description, COUNT(DISTINCT at.id) AS number_of_alternate_titles, AVG(at.production_year) AS average_production_year, SUM(CASE WHEN ml.link_type_id = 5 THEN 1 ELSE 0 END) AS count_type_5_links, SUM(CASE WHEN ml.link_type_id = 13 THEN 1 ELSE 0 END) AS count_type_13_links, SUM(CASE WHEN ml.link_type_id = 15 THEN 1 ELSE 0 END) AS count_type_15_links, SUM(CASE WHEN ml.link_type_id = 7 THEN 1 ELSE 0 END) AS count_type_7_links, SUM(CASE WHEN ml.link_type_id = 16 THEN 1 ELSE 0 END) AS count_type_16_links, COUNT(DISTINCT cn.id) AS number_of_unique_characters FROM aka_title at JOIN movie_link ml ON at.movie_id = ml.movie_id JOIN info_type it ON it.id = ml.link_type_id JOIN char_name cn ON cn.md5sum = at.md5sum WHERE at.id IN (4738, 7311, 11190, 4033, 11219) AND ml.link_type_id IN (5, 13, 15, 7, 16) AND cn.name IN ('Allday, Dave', 'Algarra, Ma. Luisa', 'Allan, Clifford', 'Allgood, Frances V.') AND it.id = 75 GROUP BY it.info;
