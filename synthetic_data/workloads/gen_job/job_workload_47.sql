SELECT AVG(mc.movie_id) AS average_movie_id, COUNT(DISTINCT cn.id) AS number_of_companies, SUM(CASE WHEN mi.info_type_id = 4 THEN 1 ELSE 0 END) AS info_type_count, cct.kind AS cast_type_kind, COUNT(DISTINCT k.id) AS unique_keywords_used, MAX(cn.name) AS largest_company_name FROM movie_companies AS mc JOIN company_name AS cn ON mc.company_id = cn.id JOIN company_type AS ct ON mc.company_type_id = ct.id JOIN comp_cast_type AS cct ON mc.company_type_id = cct.id JOIN movie_info AS mi ON mc.movie_id = mi.movie_id JOIN keyword AS k ON mi.info = k.keyword WHERE cn.country_code = '[py]' AND (mi.info = 'Urdu' OR mi.info = 'Turkish' OR mi.info = 'Vietnamese' OR mi.info = 'Estonian') AND (cct.kind = 'complete+verified' OR cct.kind = 'cast' OR cct.kind = 'crew' OR cct.kind = 'complete') AND (k.id IN (2454, 1707, 7050, 8101)) GROUP BY cct.kind;
SELECT cn.name AS company_name, COUNT(DISTINCT mk.movie_id) AS number_of_movies_with_keywords, COUNT(DISTINCT ml.movie_id) AS number_of_linked_movies, COUNT(DISTINCT ml.linked_movie_id) AS number_of_movies_linked_to, AVG(cn.imdb_id) AS average_imdb_id FROM company_name cn LEFT JOIN movie_companies mc ON cn.id = mc.company_id LEFT JOIN movie_keyword mk ON mc.movie_id = mk.movie_id LEFT JOIN movie_link ml ON mc.movie_id = ml.movie_id OR mc.movie_id = ml.linked_movie_id WHERE cn.country_code NOT IN ('[pl]') AND cn.name_pcode_sf IN ('V6251', 'D1253', 'A4562', 'D5351', 'T5626') AND (ml.link_type_id IN (5, 3, 13) OR ml.link_type_id IS NULL) GROUP BY cn.name ORDER BY number_of_movies_with_keywords DESC, number_of_linked_movies DESC, number_of_movies_linked_to DESC, average_imdb_id DESC LIMIT 10;
SELECT kt.kind AS movie_kind, COUNT(DISTINCT ml.movie_id) AS number_of_movies, COUNT(DISTINCT ml.linked_movie_id) AS number_of_linked_movies, LT.LINK AS link_type, AVG(pi.person_id) AS average_person_id, SUM(CASE WHEN mk.keyword_id = '3986' THEN 1 ELSE 0 END) AS count_of_keyword_3986, SUM(CASE WHEN mk.keyword_id = '3808' THEN 1 ELSE 0 END) AS count_of_keyword_3808, SUM(CASE WHEN mk.keyword_id = '4322' THEN 1 ELSE 0 END) AS count_of_keyword_4322 FROM movie_link AS ml JOIN link_type AS LT ON ml.link_type_id = LT.id JOIN kind_type AS kt ON kt.id IN ('6', '5') JOIN movie_keyword AS mk ON mk.movie_id = ml.movie_id LEFT JOIN person_info AS pi ON pi.person_id = ml.movie_id AND pi.info_type_id = mk.keyword_id WHERE mk.movie_id = '8874' AND LT.link IN ('features', 'referenced in', 'spin off', 'edited from', 'remade as', 'unknown link') GROUP BY kt.kind, LT.LINK;
SELECT kt.kind AS movie_type, COUNT(t.id) AS total_movies, AVG(t.production_year) AS avg_production_year, MIN(t.production_year) AS earliest_production_year, MAX(t.production_year) AS latest_production_year FROM title t JOIN (SELECT id, kind FROM comp_cast_type WHERE kind IN ('director', 'actor')) cct ON t.kind_id = cct.id LEFT JOIN (SELECT id, kind FROM kind_type) kt ON t.kind_id = kt.id GROUP BY kt.kind ORDER BY total_movies DESC;
SELECT kt.kind AS movie_type, COUNT(DISTINCT t.id) AS total_movies, AVG(t.production_year) AS average_production_year, SUM(CASE WHEN n.gender = 'm' THEN 1 ELSE 0 END) AS male_actors_count, SUM(CASE WHEN n.gender = 'f' THEN 1 ELSE 0 END) AS female_actors_count, COUNT(DISTINCT k.id) AS distinct_keywords_used FROM title t INNER JOIN kind_type kt ON t.kind_id = kt.id LEFT JOIN movie_keyword mk ON t.id = mk.movie_id LEFT JOIN keyword k ON mk.keyword_id = k.id LEFT JOIN char_name cn ON t.id = cn.imdb_id LEFT JOIN name n ON cn.id = n.id WHERE t.production_year >= 2000 AND (n.surname_pcode = 'A41' OR n.surname_pcode = 'A42' OR n.surname_pcode = 'A435') GROUP BY kt.kind ORDER BY total_movies DESC;
SELECT ct.kind AS company_kind, AVG(at.production_year) AS average_production_year, COUNT(DISTINCT k.id) AS unique_keywords_count, COUNT(DISTINCT at.id) AS alternate_titles_count, SUM(CASE WHEN mic.info_type_id = '100' THEN 1 ELSE 0 END) AS count_info_type_100, SUM(CASE WHEN mic.info_type_id = '101' THEN 1 ELSE 0 END) AS count_info_type_101, SUM(CASE WHEN mic.info_type_id = '99' THEN 1 ELSE 0 END) AS count_info_type_99 FROM movie_companies AS mc JOIN company_type AS ct ON mc.company_type_id = ct.id JOIN aka_title AS at ON mc.movie_id = at.movie_id JOIN movie_info_idx AS mic ON mc.movie_id = mic.movie_id LEFT JOIN keyword AS k ON at.movie_id = k.id WHERE ct.kind = 'miscellaneous companies' AND mc.id IN ('1733', '1292', '472', '1920', '683', '4338') GROUP BY ct.kind;
SELECT kt.kind AS movie_kind, COUNT(DISTINCT ci.movie_id) AS total_movies, AVG(ci.nr_order) AS average_cast_order, SUM(CASE WHEN ci.person_id = 1867 THEN 1 ELSE 0 END) AS total_movies_person_1867, SUM(CASE WHEN ci.person_id = 1769 THEN 1 ELSE 0 END) AS total_movies_person_1769, SUM(CASE WHEN ci.person_id = 1459 THEN 1 ELSE 0 END) AS total_movies_person_1459, COUNT(DISTINCT cn.id) AS total_companies, COUNT(DISTINCT mi.info) AS distinct_movie_info_types FROM kind_type AS kt JOIN movie_info AS mi ON mi.movie_id = kt.id JOIN cast_info AS ci ON ci.movie_id = kt.id JOIN company_name AS cn ON cn.imdb_id = ci.movie_id WHERE kt.kind = 'movie' AND ci.person_id IN (1867, 1769, 1459, 1473, 1640, 1126) AND ci.movie_id IN (152924, 2374081, 1326173, 1098477, 1321487, 1288531) GROUP BY kt.kind;
SELECT ct.kind AS company_type, cn.country_code, COUNT(DISTINCT k.id) AS unique_keywords_count, COUNT(DISTINCT t.id) AS total_movies, SUM(CASE WHEN t.production_year > 2000 THEN 1 ELSE 0 END) AS movies_after_2000 FROM company_name cn JOIN company_type ct ON cn.id = ct.id JOIN title t ON t.production_year IS NOT NULL JOIN movie_keyword mk ON t.id = mk.movie_id JOIN keyword k ON mk.keyword_id = k.id WHERE cn.country_code != 'US' AND k.keyword IN ('high-powered-gun', 'airforce', 'harpoon', 'creek') AND t.kind_id != 1 GROUP BY ct.kind, cn.country_code ORDER BY total_movies DESC;
SELECT kt.kind AS movie_kind, rt.ROLE AS role_type, COUNT(DISTINCT ci.movie_id) AS total_movies, COUNT(DISTINCT ci.person_id) AS total_people, AVG(ci.nr_order) AS average_cast_position, SUM(CASE WHEN rt.ROLE = 'producer' THEN 1 ELSE 0 END) AS total_producers, SUM(CASE WHEN rt.ROLE = 'actor' THEN 1 ELSE 0 END) AS total_actors FROM cast_info ci JOIN role_type rt ON ci.role_id = rt.id JOIN kind_type kt ON kt.id = (SELECT id FROM kind_type WHERE id = ci.person_role_id) JOIN movie_companies mc ON mc.movie_id = ci.movie_id JOIN company_name cn ON cn.id = mc.company_id WHERE rt.id IN (4, 5) GROUP BY kt.kind, rt.ROLE ORDER BY total_movies DESC, average_cast_position ASC;
SELECT ct.kind AS company_kind, cn.country_code, COUNT(DISTINCT cn.id) AS total_companies, AVG(cn.imdb_id) AS average_imdb_id, COUNT(DISTINCT k.phonetic_code) AS unique_keyword_phonetic_codes FROM company_name cn JOIN company_type ct ON cn.id = ct.id LEFT JOIN keyword k ON cn.id = k.id GROUP BY ct.kind, cn.country_code ORDER BY total_companies DESC, unique_keyword_phonetic_codes DESC;
SELECT cc.kind AS cast_kind, AVG(cc.id) AS average_cast_id, CN.name AS company_name, COUNT(*) AS number_of_movies, SUM(MI.id) AS sum_movie_info_id, AVG(MI.info_type_id) AS average_info_type_id FROM cast_info CI JOIN comp_cast_type CC ON CI.person_role_id = CC.id JOIN company_name CN ON CN.country_code = CI.note JOIN movie_info_idx MI ON CI.movie_id = MI.movie_id WHERE CI.nr_order IN (56, 62, 2, 74) AND CI.movie_id IN (1884275, 2284142, 1084092) AND CN.country_code IN ('[xyu]', '[suhh]', '[lv]', '[nl]', '[cn]') AND CN.name_pcode_sf IN ('W4216', 'A4526', 'S4163', 'C1616') GROUP BY cc.kind, CN.name ORDER BY number_of_movies DESC, company_name;
SELECT k.keyword, COUNT(DISTINCT ml.movie_id) AS linked_movies_count, AVG(sub_person_roles.roles_count) AS avg_roles_per_person, COUNT(DISTINCT an.id) AS unique_pseudonyms_count FROM keyword AS k LEFT JOIN movie_keyword AS mk ON k.id = mk.keyword_id LEFT JOIN movie_link AS ml ON mk.movie_id = ml.movie_id LEFT JOIN person_info AS pi ON pi.info_type_id = k.id LEFT JOIN (SELECT pi.person_id, COUNT(DISTINCT pi.info_type_id) AS roles_count FROM person_info AS pi INNER JOIN role_type AS rt ON pi.info_type_id = rt.id WHERE rt.id IN (1, 8, 7, 5) GROUP BY pi.person_id ) AS sub_person_roles ON pi.person_id = sub_person_roles.person_id LEFT JOIN aka_name AS an ON pi.person_id = an.person_id WHERE k.keyword IN ('murder', 'mystery', 'thriller') AND pi.info_type_id IN (70, 2, 75, 36, 50) GROUP BY k.keyword;
SELECT it.info AS info_type, COUNT(*) AS total_movies, AVG(CAST(mi.info AS INTEGER)) AS average_info_value, SUM(CAST(mi.info AS INTEGER)) AS sum_info_value, COUNT(DISTINCT cc.movie_id) AS count_distinct_movies FROM movie_info_idx mi JOIN info_type it ON mi.info_type_id = it.id LEFT JOIN complete_cast cc ON mi.movie_id = cc.movie_id WHERE it.id IN (27, 34, 97, 20, 80, 54) AND mi.movie_id IN (19576, 19282, 18727, 13977, 7344) GROUP BY it.info;
SELECT AVG(at.production_year) AS average_production_year, COUNT(DISTINCT comp.id) AS number_of_companies, SUM(CASE WHEN cc.status_id = 4 THEN 1 ELSE 0 END) AS full_cast_movies, COUNT(DISTINCT mk.id) AS number_of_keywords, MAX(pi.id) AS max_person_info_id FROM aka_title AS at JOIN movie_companies AS mc ON mc.movie_id = at.movie_id JOIN company_name AS comp ON mc.company_id = comp.id JOIN complete_cast AS cc ON at.movie_id = cc.movie_id JOIN movie_keyword AS mk ON at.movie_id = mk.movie_id LEFT JOIN person_info AS pi ON pi.person_id = at.movie_id WHERE at.kind_id = 1 AND mc.company_type_id IN (1, 2) AND cc.status_id IN (3, 4) AND at.production_year BETWEEN 1990 AND 2000 GROUP BY at.production_year ORDER BY average_production_year DESC;
SELECT ct.kind AS company_type, COUNT(mc.id) AS total_movies, AVG(mi_idx.info::numeric) AS average_movie_info, SUM(CASE WHEN rt.role = 'director' THEN 1 ELSE 0 END) AS total_directors, SUM(CASE WHEN rt.role = 'editor' THEN 1 ELSE 0 END) AS total_editors FROM movie_companies AS mc JOIN company_type AS ct ON mc.company_type_id = ct.id JOIN movie_info_idx AS mi_idx ON mc.movie_id = mi_idx.movie_id JOIN role_type AS rt ON rt.id = mc.company_type_id WHERE mi_idx.info_type_id IN (100, 101, 99) AND ct.id IN (SELECT id FROM comp_cast_type WHERE kind IN ('complete+verified', 'cast', 'crew', 'complete')) AND rt.id IN (9, 3, 10, 8, 11, 6) GROUP BY ct.kind ORDER BY total_movies DESC;
SELECT AVG(mi_idx.info::NUMERIC) AS average_movie_rating, COUNT(DISTINCT cn.name) AS number_of_production_companies, COUNT(DISTINCT chn.name) AS number_of_unique_character_names, SUM(CASE WHEN mw.movie_id IS NOT NULL THEN 1 ELSE 0 END) AS number_of_movies_with_keywords FROM movie_info_idx AS mi_idx JOIN movie_keyword AS mw ON mi_idx.movie_id = mw.movie_id JOIN company_name AS cn ON cn.imdb_id = mi_idx.movie_id JOIN char_name AS chn ON chn.imdb_id = mi_idx.movie_id WHERE mi_idx.info_type_id = 101 AND mw.keyword_id IN (918, 3849, 3998, 3575) AND cn.name_pcode_sf IN ('L1242', 'S5261', 'G6425', 'S621', 'A5356', 'W132') AND chn.name_pcode_nf IN ('H61', 'M5316', 'D36', 'D1363') GROUP BY cn.country_code ORDER BY average_movie_rating DESC;
SELECT AVG(mc.company_id) AS average_company_id, COUNT(DISTINCT ml.movie_id) AS linked_movies_count, SUM(CASE WHEN mi.info = 'Tatar' THEN 1 ELSE 0 END) AS tatar_movies_count, SUM(CASE WHEN mi.info = 'Hebrew' THEN 1 ELSE 0 END) AS hebrew_movies_count, SUM(CASE WHEN mi.info = 'Inuktitut' THEN 1 ELSE 0 END) AS inuktitut_movies_count, COUNT(DISTINCT an.person_id) AS unique_actors_count FROM movie_companies AS mc JOIN movie_link AS ml ON mc.movie_id = ml.movie_id JOIN movie_info AS mi ON mc.movie_id = mi.movie_id LEFT JOIN aka_name AS an ON an.surname_pcode = mi.info WHERE an.name_pcode_cf IN ('V3415', 'A5163', 'B6525') AND mi.info IN ('Tatar', 'Hebrew', 'Inuktitut') GROUP BY mc.company_type_id;
SELECT COUNT(DISTINCT ci.person_id) AS total_actors, AVG(ci.nr_order) AS average_cast_position, SUM(CASE WHEN lt.link LIKE '%producer%' THEN 1 ELSE 0 END) AS total_producers_linked, COUNT(DISTINCT mk.keyword_id) AS total_unique_keywords, COUNT(DISTINCT mc.company_id) AS total_companies_involved FROM cast_info ci JOIN movie_companies mc ON ci.movie_id = mc.movie_id JOIN movie_keyword mk ON ci.movie_id = mk.movie_id JOIN link_type lt ON mc.company_type_id = lt.id WHERE ci.person_role_id IS NOT NULL AND mc.note IS NULL AND ci.movie_id IN (SELECT movie_id FROM movie_companies WHERE id = '3813') GROUP BY ci.movie_id;
SELECT AVG(CAST(mi.info AS FLOAT)) AS average_rating, COUNT(DISTINCT mc.movie_id) AS number_of_movies, cn.name AS company_name, rt.ROLE AS role_type, COUNT(DISTINCT ci.person_id) AS number_of_actors FROM movie_companies AS mc JOIN company_name AS cn ON mc.company_id = cn.id JOIN movie_info AS mi ON mc.movie_id = mi.movie_id AND mi.info_type_id = 101 JOIN cast_info AS ci ON mc.movie_id = ci.movie_id JOIN role_type AS rt ON ci.role_id = rt.id WHERE cn.name_pcode_nf IN ('C5342', 'A6514', 'W6321', 'S2', 'M1653', 'A3532') AND mc.company_id IN ('1199', '263', '157', '78') AND mi.id IN ('7268010', '7269101', '7266891', '7268390', '7270852', '7269590') GROUP BY cn.name, rt.ROLE ORDER BY average_rating DESC, number_of_movies DESC, number_of_actors DESC;
SELECT lt.LINK, COUNT(DISTINCT ml.movie_id) AS total_movies, COUNT(DISTINCT ml.linked_movie_id) AS total_linked_movies, AVG(CAST(mi.info AS NUMERIC)) FILTER (WHERE it.info = 'rating') AS average_rating, SUM(CAST(mi.info AS NUMERIC)) FILTER (WHERE it.info = 'budget') AS total_budget FROM movie_link AS ml JOIN link_type AS lt ON ml.link_type_id = lt.id JOIN movie_info AS mi ON ml.movie_id = mi.movie_id JOIN movie_info AS it ON mi.info_type_id = it.id WHERE ml.movie_id IN ('11225', '16185', '8060') OR ml.linked_movie_id IN ('438568', '10238', '2451792', '1949408') AND mi.note IN ('(English subtitles)', '(Original Version)', '(a few lines)', '(Original version)') GROUP BY lt.LINK;
SELECT t.kind_id, t.production_year, COUNT(DISTINCT t.id) AS number_of_titles, COUNT(DISTINCT n.id) AS number_of_unique_persons, AVG(CAST(mi.info AS FLOAT)) AS average_movie_length, SUM(CASE WHEN at.episode_nr IS NOT NULL THEN 1 ELSE 0 END) AS number_of_episodes FROM title t LEFT JOIN aka_title at ON t.id = at.movie_id LEFT JOIN movie_info_idx mi ON t.id = mi.movie_id AND mi.info_type_id = 100 LEFT JOIN complete_cast cc ON t.id = cc.movie_id LEFT JOIN name n ON cc.subject_id = n.id WHERE t.production_year BETWEEN 2000 AND 2020 AND t.kind_id IN (1, 2, 3) GROUP BY t.kind_id, t.production_year ORDER BY t.kind_id, t.production_year;
SELECT ct.kind AS company_type, COUNT(DISTINCT cc.movie_id) AS total_movies, COUNT(DISTINCT ml.movie_id) AS total_linked_movies, AVG(CAST(mi.info AS NUMERIC)) FILTER (WHERE it.info = 'budget') AS average_movie_budget, SUM(CAST(mi.info AS INTEGER)) FILTER (WHERE it.info = 'votes') AS total_movie_votes FROM company_type ct JOIN movie_companies mc ON mc.company_type_id = ct.id JOIN complete_cast cc ON cc.movie_id = mc.movie_id JOIN movie_link ml ON ml.movie_id = mc.movie_id JOIN movie_info mi ON mi.movie_id = mc.movie_id JOIN info_type it ON it.id = mi.info_type_id WHERE ct.kind IN ('distributors', 'special effects companies', 'production companies') AND cc.status_id IN (3, 4) AND mi.movie_id IN ('932270', '939910') AND mi.info IN ('Gujarati', 'Tagalog', 'French', 'Portuguese') GROUP BY ct.kind ORDER BY total_movies DESC, average_movie_budget DESC;
SELECT ct.kind AS company_kind, COUNT(DISTINCT cn.id) AS total_companies, AVG(ci.nr_order) AS average_order, SUM(CASE WHEN cct.kind = 'cast' THEN 1 ELSE 0 END) AS total_cast_roles, SUM(CASE WHEN cct.kind = 'crew' THEN 1 ELSE 0 END) AS total_crew_roles FROM company_name cn JOIN company_type ct ON cn.id = ct.id JOIN movie_companies mc ON cn.id = mc.company_id JOIN cast_info ci ON mc.movie_id = ci.movie_id JOIN comp_cast_type cct ON ci.person_role_id = cct.id WHERE (cn.name = 'Laska Productions' OR cn.name = 'Curzon Film World' OR cn.name = 'Jernigan Films' OR cn.name = 'Clark Productions') AND ct.kind IN ('production companies', 'distributors') AND ci.person_id IN (1732, 1053, 1788, 1668, 1056, 1817) AND ci.person_role_id IN (374, 366) AND cct.id IN (1, 2, 3, 4) GROUP BY ct.kind;
SELECT n.gender, COUNT(DISTINCT n.id) AS total_actors, SUM(mc.movie_id) AS total_movie_production_involvements, MIN(aka.title) AS earliest_movie_title FROM name AS n JOIN aka_name AS an ON n.id = an.person_id JOIN aka_title AS aka ON aka.id = an.id JOIN movie_companies AS mc ON mc.movie_id = aka.movie_id GROUP BY n.gender HAVING COUNT(DISTINCT n.id) > 10 ORDER BY total_actors DESC LIMIT 5;
