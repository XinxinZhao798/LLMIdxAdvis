SELECT COUNT(DISTINCT at.id) AS number_of_titles, AVG(at.production_year) AS average_production_year, rt.role AS role_type, COUNT(DISTINCT mi.id) AS number_of_movie_infos, SUM(CASE WHEN at.kind_id = '1' THEN 1 ELSE 0 END) AS number_of_movies, SUM(CASE WHEN at.kind_id = '2' THEN 1 ELSE 0 END) AS number_of_tv_shows, COUNT(DISTINCT at.episode_of_id) AS number_of_unique_series, MAX(at.season_nr) AS max_season_number, MAX(at.episode_nr) AS max_episode_number FROM aka_title at JOIN movie_info mi ON at.movie_id = mi.movie_id JOIN role_type rt ON mi.info_type_id = rt.id WHERE at.production_year BETWEEN 1990 AND 2020 AND mi.info LIKE '%color%' GROUP BY rt.role ORDER BY number_of_titles DESC, average_production_year;
SELECT kt.kind AS movie_type, AVG(akat.production_year) AS average_production_year, COUNT(DISTINCT ci.person_id) AS number_of_actors, COUNT(DISTINCT mk.movie_id) AS number_of_movies_with_keywords, SUM(CASE WHEN cct.kind = 'complete+verified' THEN 1 ELSE 0 END) AS total_complete_verified_casts, COUNT(DISTINCT mc.company_id) AS number_of_different_companies_involved FROM aka_title akat JOIN kind_type kt ON akat.kind_id = kt.id JOIN cast_info ci ON akat.movie_id = ci.movie_id JOIN movie_keyword mk ON akat.movie_id = mk.movie_id JOIN comp_cast_type cct ON ci.person_role_id = cct.id JOIN movie_companies mc ON akat.movie_id = mc.movie_id WHERE ci.person_role_id = 1215 AND mk.id = 1952 AND mc.id IN (4224, 2075, 3671, 3125, 1386) GROUP BY kt.kind;
SELECT t.kind_id, COUNT(DISTINCT t.id) AS total_movies, AVG(t.production_year) AS average_production_year, SUM(CASE WHEN mi.info = 'Estonian' THEN 1 ELSE 0 END) AS total_estonian_movies, SUM(CASE WHEN mi.info = 'German' THEN 1 ELSE 0 END) AS total_german_movies, SUM(CASE WHEN mi.info = 'Dutch' THEN 1 ELSE 0 END) AS total_dutch_movies, SUM(CASE WHEN mi.info = 'Vietnamese' THEN 1 ELSE 0 END) AS total_vietnamese_movies, SUM(CASE WHEN mi.info = 'Greek' THEN 1 ELSE 0 END) AS total_greek_movies, SUM(CASE WHEN mi.info = 'Croatian' THEN 1 ELSE 0 END) AS total_croatian_movies, COUNT(DISTINCT an.id) AS total_aka_names, COUNT(DISTINCT cc.id) AS total_complete_casts, COUNT(DISTINCT lt.id) AS total_link_types FROM title AS t LEFT JOIN movie_info AS mi ON t.id = mi.movie_id AND mi.info_type_id = '4' LEFT JOIN aka_name AS an ON t.id = an.person_id LEFT JOIN complete_cast AS cc ON t.id = cc.movie_id AND cc.subject_id = '1' AND cc.status_id IN ('3', '4') LEFT JOIN link_type AS lt ON lt.link IN ('edited into', 'similar to', 'spin off from') GROUP BY t.kind_id;
SELECT c.name AS company_name, COUNT(DISTINCT mc.movie_id) AS number_of_movies, COUNT(DISTINCT mk.keyword_id) AS number_of_keywords, COUNT(DISTINCT ml.linked_movie_id) AS number_of_linked_movies, SUM(CASE WHEN c.name_pcode_sf = 'M2462' THEN 1 ELSE 0 END) AS count_M2462, SUM(CASE WHEN c.name_pcode_sf = 'P5323' THEN 1 ELSE 0 END) AS count_P5323 FROM company_name c JOIN movie_companies mc ON c.id = mc.company_id LEFT JOIN movie_keyword mk ON mc.movie_id = mk.movie_id LEFT JOIN movie_link ml ON mc.movie_id = ml.movie_id GROUP BY c.name ORDER BY number_of_movies DESC, number_of_keywords DESC;
SELECT kt.kind AS movie_kind, COUNT(DISTINCT ci.movie_id) AS number_of_movies, AVG(at.production_year) AS average_production_year, SUM(CASE WHEN it.info = 'budget' THEN CAST(mi.info AS MONEY) ELSE 0::MONEY END) AS total_budget, COUNT(DISTINCT ci.person_id) AS number_of_actors, COUNT(DISTINCT mc.company_id) AS number_of_companies_involved FROM movie_info mi JOIN movie_companies mc ON mi.movie_id = mc.movie_id JOIN cast_info ci ON mi.movie_id = ci.movie_id JOIN aka_title at ON ci.movie_id = at.movie_id JOIN kind_type kt ON kt.id = at.kind_id JOIN info_type it ON it.id = mi.info_type_id WHERE it.info IN ('budget', 'box office gross') AND kt.kind IN ('actor', 'actress') AND mc.company_type_id IN (1, 2) GROUP BY kt.kind;
SELECT rt.ROLE AS role_type, COUNT(DISTINCT ci.person_id) AS number_of_people, AVG(ci.nr_order) AS average_nr_order, COUNT(DISTINCT t.id) AS number_of_movies, SUM(CASE WHEN cc.status_id = 1 THEN 1 ELSE 0 END) AS complete_cast_count, MIN(t.production_year) AS earliest_production_year, MAX(t.production_year) AS latest_production_year FROM cast_info ci JOIN role_type rt ON ci.role_id = rt.id JOIN title t ON ci.movie_id = t.id LEFT JOIN complete_cast cc ON t.id = cc.movie_id AND cc.subject_id = 1 WHERE t.kind_id IN (2, 7) AND (ci.person_role_id IS NULL OR ci.person_role_id IN (1264, 1098, 226, 448, 1154)) AND t.production_year BETWEEN 1990 AND 2023 GROUP BY rt.ROLE ORDER BY number_of_people DESC;
SELECT kt.kind, COUNT(DISTINCT mc.movie_id) AS total_movies, AVG(cast_info.nr_order) AS average_cast_order, SUM(case when cn.country_code = 'US' THEN 1 ELSE 0 END) AS total_us_companies, COUNT(DISTINCT mk.keyword_id) AS unique_keywords FROM movie_companies mc JOIN company_name cn ON mc.company_id = cn.id JOIN kind_type kt ON kt.kind IN ('episode', 'video game', 'video movie', 'tv movie', 'tv mini series', 'tv series') JOIN movie_keyword mk ON mk.movie_id = mc.movie_id JOIN cast_info ON cast_info.movie_id = mc.movie_id WHERE mk.movie_id IN ('12147', '11128', '12146') GROUP BY kt.kind ORDER BY total_movies DESC;
SELECT kt.kind AS movie_kind, AVG(aka.production_year) AS average_production_year, COUNT(ci.person_id) AS total_cast_count, SUM(CASE WHEN ci.role_id = 1 THEN 1 ELSE 0 END) AS actor_count, SUM(CASE WHEN ci.role_id = 2 THEN 1 ELSE 0 END) AS actress_count FROM aka_title AS aka JOIN kind_type AS kt ON aka.kind_id = kt.id JOIN cast_info AS ci ON aka.movie_id = ci.movie_id JOIN movie_info AS mi ON aka.movie_id = mi.movie_id JOIN person_info AS pi ON ci.person_id = pi.person_id WHERE aka.title LIKE '%The Hobbits%' OR aka.id IN (34831, 39506, 43821, 20330) OR mi.movie_id IN (18783, 19260, 8743, 8393) GROUP BY kt.kind ORDER BY average_production_year DESC;
SELECT CN.name AS company_name, COUNT(DISTINCT AN.id) AS total_aliases, AVG(AT.production_year) AS average_production_year, SUM(CASE WHEN N.gender = 'M' THEN 1 ELSE 0 END) AS male_actors_count, SUM(CASE WHEN N.gender = 'F' THEN 1 ELSE 0 END) AS female_actors_count FROM company_name CN JOIN aka_title AT ON CN.id = AT.movie_id JOIN aka_name AN ON AN.person_id = AT.movie_id JOIN name N ON N.id = AN.person_id WHERE CN.country_code = 'US' AND AT.production_year >= 2000 AND N.gender IN ('M', 'F') GROUP BY CN.name;
SELECT kt.kind AS movie_kind, COUNT(DISTINCT ci.movie_id) AS total_movies, AVG(ci.nr_order) AS average_cast_order, COUNT(DISTINCT pi.person_id) AS total_actors, COUNT(DISTINCT pi2.person_id) AS total_crew_members, COUNT(DISTINCT lt.id) AS total_link_types_used FROM cast_info ci JOIN kind_type kt ON ci.person_role_id = kt.id JOIN person_info pi ON ci.person_id = pi.person_id JOIN person_info pi2 ON ci.person_role_id = pi2.person_id AND pi2.info_type_id = ci.role_id JOIN link_type lt ON ci.role_id = lt.id WHERE ci.person_role_id IN (675, 613) AND pi.note NOT IN ('Jon C. Hopwood', 'CelebrityLoop.com', 'Adler and Associates Entertainment', 'Self.', 'ali aga') AND pi.info NOT IN ('15 August 1966', 'First president to live in the White House.', 'Rejowiec Fabryczny, Lubelskie, Poland') AND lt.id IN (15, 11, 8, 17) AND lt.link IN ('featured in', 'edited from', 'unknown link', 'spin off from', 'followed by') GROUP BY kt.kind;
SELECT AVG(CAST(mi.info AS FLOAT)) AS average_rating, COUNT(DISTINCT mc.movie_id) AS number_of_movies, cn.name AS company_name, rt.ROLE AS role_type, COUNT(DISTINCT ci.person_id) AS number_of_actors FROM movie_companies AS mc JOIN company_name AS cn ON mc.company_id = cn.id JOIN movie_info AS mi ON mc.movie_id = mi.movie_id AND mi.info_type_id = 101 JOIN cast_info AS ci ON mc.movie_id = ci.movie_id JOIN role_type AS rt ON ci.role_id = rt.id WHERE cn.name_pcode_nf IN ('C5342', 'A6514', 'W6321', 'S2', 'M1653', 'A3532') AND mc.company_id IN ('1199', '263', '157', '78') AND mi.id IN ('7268010', '7269101', '7266891', '7268390', '7270852', '7269590') GROUP BY cn.name, rt.ROLE ORDER BY average_rating DESC, number_of_movies DESC, number_of_actors DESC;
SELECT kt.kind AS movie_type, COUNT(DISTINCT t.id) AS total_titles, AVG(CAST(t.production_year AS NUMERIC)) AS average_production_year, SUM(CASE WHEN n.gender = 'm' THEN 1 ELSE 0 END) AS male_actor_count, SUM(CASE WHEN n.gender = 'f' THEN 1 ELSE 0 END) AS female_actor_count, COUNT(DISTINCT n.id) AS total_actors, COUNT(DISTINCT ml.linked_movie_id) AS linked_movies_count, COUNT(DISTINCT cc.id) AS complete_cast_entries FROM kind_type AS kt JOIN aka_title AS t ON kt.id = t.kind_id LEFT JOIN movie_link AS ml ON t.movie_id = ml.movie_id LEFT JOIN complete_cast AS cc ON t.movie_id = cc.movie_id LEFT JOIN cast_info AS ci ON t.id = ci.movie_id LEFT JOIN name AS n ON ci.person_id = n.id WHERE kt.kind IN ('movie', 'tv movie', 'episode', 'tv series', 'video movie') AND cc.subject_id = 1 AND (n.gender IS NULL OR n.gender IN ('m', 'f')) GROUP BY kt.kind ORDER BY total_titles DESC;
SELECT kt.kind AS movie_kind, COUNT(*) AS total_movies, AVG(t.production_year) AS average_production_year, SUM(CASE WHEN mi.info = 'color' THEN 1 ELSE 0 END) AS color_movie_count, SUM(CASE WHEN mi.info = 'black and white' THEN 1 ELSE 0 END) AS black_and_white_movie_count FROM title AS t JOIN kind_type AS kt ON t.kind_id = kt.id JOIN movie_info AS mi ON t.id = mi.movie_id WHERE t.production_year BETWEEN 2000 AND 2010 AND mi.info_type_id IN (SELECT id FROM info_type WHERE info IN ('color', 'black and white')) GROUP BY kt.kind HAVING COUNT(*) > 100 ORDER BY total_movies DESC, average_production_year;
SELECT COUNT(DISTINCT mc.movie_id) AS number_of_movies, AVG(mi_idx.info::NUMERIC) AS average_movie_length, SUM(CASE WHEN n.gender = 'F' THEN 1 ELSE 0 END) AS female_cast_count, SUM(CASE WHEN n.gender = 'M' THEN 1 ELSE 0 END) AS male_cast_count, COUNT(DISTINCT mk.keyword_id) AS number_of_unique_keywords FROM movie_companies AS mc JOIN movie_info_idx AS mi_idx ON mc.movie_id = mi_idx.movie_id AND mi_idx.info_type_id = 1 JOIN movie_info AS mi ON mc.movie_id = mi.movie_id JOIN movie_keyword AS mk ON mc.movie_id = mk.movie_id JOIN name AS n ON n.id = ANY (ARRAY [9129, 3874, 7033, 7761, 6454]) WHERE mc.company_type_id IN (1, 2) AND mi.note LIKE '%(a few words)%' GROUP BY mc.company_id ORDER BY number_of_movies DESC, average_movie_length;
SELECT kt.kind AS movie_kind, AVG(t.production_year) AS average_production_year, SUM(CASE WHEN cn.country_code IN ('[cshh]', '[jp]') THEN 1 ELSE 0 END) AS total_japanese_czech_movies, COUNT(DISTINCT t.title) AS unique_movie_titles, COUNT(DISTINCT cn.name) AS unique_company_names, MAX(t.episode_nr) AS highest_episode_number FROM title AS t JOIN kind_type AS kt ON t.kind_id = kt.id LEFT JOIN movie_info AS mi ON t.id = mi.movie_id LEFT JOIN company_name AS cn ON cn.name_pcode_nf IN ('Z1625', 'R431', 'V4535', 'L2353') WHERE kt.kind IN ('video movie', 'episode', 'movie', 'tv movie', 'video game') AND (t.episode_of_id = 34110 OR t.episode_nr IN (432, 50)) AND mi.id IN (7267112, 7268729, 7266379, 7269917, 7267091) GROUP BY kt.kind;
SELECT n.name AS actor_name, COUNT(DISTINCT ci.movie_id) AS movies_participated, AVG(mi_idx_nr_order.avg_nr_order) AS average_cast_order, SUM(CASE WHEN mi_info.info LIKE '%budget%' THEN 1 ELSE 0 END) AS budget_movies_count, MAX(CASE WHEN mi_info.info_type_id = (SELECT id FROM movie_info_idx WHERE info = 'release dates') THEN mi_info.info ELSE NULL END) AS latest_release_date FROM name n JOIN cast_info ci ON ci.person_id = n.id LEFT JOIN (SELECT movie_id, AVG(nr_order) AS avg_nr_order FROM cast_info GROUP BY movie_id) mi_idx_nr_order ON mi_idx_nr_order.movie_id = ci.movie_id LEFT JOIN movie_info mi_info ON mi_info.movie_id = ci.movie_id WHERE n.gender = 'm' AND n.surname_pcode IN ('A416', 'A43', 'A413', 'A462') GROUP BY n.name ORDER BY movies_participated DESC, average_cast_order;
