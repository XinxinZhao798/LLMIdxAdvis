SELECT kt.kind AS movie_kind, AVG(t.production_year) AS average_production_year, SUM(CASE WHEN cn.country_code IN ('[cshh]', '[jp]') THEN 1 ELSE 0 END) AS total_japanese_czech_movies, COUNT(DISTINCT t.title) AS unique_movie_titles, COUNT(DISTINCT cn.name) AS unique_company_names, MAX(t.episode_nr) AS highest_episode_number FROM title AS t JOIN kind_type AS kt ON t.kind_id = kt.id LEFT JOIN movie_info AS mi ON t.id = mi.movie_id LEFT JOIN company_name AS cn ON cn.name_pcode_nf IN ('Z1625', 'R431', 'V4535', 'L2353') WHERE kt.kind IN ('video movie', 'episode', 'movie', 'tv movie', 'video game') AND (t.episode_of_id = 34110 OR t.episode_nr IN (432, 50)) AND mi.id IN (7267112, 7268729, 7266379, 7269917, 7267091) GROUP BY kt.kind;
SELECT it.info AS company_role, COUNT(DISTINCT mc.movie_id) AS number_of_movies, COUNT(DISTINCT mc.company_id) AS number_of_companies, AVG(CAST(coalesce(an.name_pcode_cf, '0') AS INTEGER)) AS avg_name_code_cf, SUM(CAST(coalesce(an.name_pcode_nf, '0') AS INTEGER)) AS total_name_code_nf FROM movie_companies mc JOIN role_type rt ON mc.company_type_id = rt.id JOIN info_type it ON rt.id = it.id LEFT JOIN aka_name an ON mc.movie_id = an.person_id WHERE mc.id IN (2557, 2170, 250, 4955, 466) GROUP BY it.info ORDER BY number_of_movies DESC;
SELECT COUNT(DISTINCT ci.person_id) AS total_actors, SUM(CASE WHEN ct.kind = 'production' THEN 1 ELSE 0 END) AS production_companies_count, AVG(t.production_year) AS average_production_year, MIN(t.title) AS oldest_movie_title, MAX(t.title) AS latest_movie_title, COUNT(DISTINCT mi.movie_id) AS total_movies_with_info FROM title t LEFT JOIN cast_info ci ON t.id = ci.movie_id LEFT JOIN movie_info mi ON t.id = mi.movie_id LEFT JOIN movie_companies mc ON t.id = mc.movie_id LEFT JOIN company_type ct ON mc.company_type_id = ct.id WHERE t.title = 'Vengence' AND t.production_year >= 2000 AND (t.episode_nr IN ('119', '9622', '13530', '255', '26') OR t.episode_nr IS NULL) GROUP BY t.production_year ORDER BY t.production_year ASC;
SELECT COUNT(DISTINCT ci.person_id) AS total_actors, AVG(ci.nr_order) AS average_cast_order, SUM(CASE WHEN ci.role_id = 1 THEN 1 ELSE 0 END) AS total_leading_roles, COUNT(DISTINCT mk.movie_id) AS total_movies_with_keywords, COUNT(DISTINCT mc.company_id) AS total_production_companies_involved, COUNT(DISTINCT cc.movie_id) AS total_movies_with_complete_cast FROM cast_info ci LEFT JOIN movie_keyword mk ON ci.movie_id = mk.movie_id LEFT JOIN movie_companies mc ON ci.movie_id = mc.movie_id LEFT JOIN complete_cast cc ON ci.movie_id = cc.movie_id WHERE ci.note NOT LIKE '%(uncredited)%' AND mk.keyword_id IN (3630, 3933, 2868, 3441, 70) AND ci.role_id = 1;
SELECT COUNT(DISTINCT ci.movie_id) AS number_of_movies, AVG(mi_idx.info::numeric) AS average_movie_rating, SUM(CASE WHEN ci.note LIKE '%(producer)%' THEN 1 ELSE 0 END) AS total_producer_mentions, cct.kind AS cast_type_kind, MIN(cn.name) AS company_name, MAX(ci.nr_order) AS highest_cast_order FROM cast_info AS ci JOIN comp_cast_type AS cct ON ci.person_role_id = cct.id JOIN company_name AS cn ON cn.id = ci.person_id JOIN movie_keyword AS mk ON ci.movie_id = mk.movie_id JOIN person_info AS pi ON ci.person_id = pi.person_id JOIN link_type AS lt ON ci.role_id = lt.id LEFT JOIN movie_info_idx AS mi_idx ON mi_idx.movie_id = ci.movie_id WHERE cct.kind IN ('complete', 'complete+verified') AND cn.name_pcode_sf IN ('C6532', 'L2653', 'U53', 'D252') AND (ci.note LIKE '%(producer)%' OR ci.note IS NULL) AND lt.id IN ('7', '15') GROUP BY cct.kind ORDER BY average_movie_rating DESC;
SELECT kt.kind AS movie_kind, COUNT(DISTINCT ci.movie_id) AS total_movies, AVG(ci.nr_order) AS average_cast_order, SUM(CASE WHEN ci.person_id = 1867 THEN 1 ELSE 0 END) AS total_movies_person_1867, SUM(CASE WHEN ci.person_id = 1769 THEN 1 ELSE 0 END) AS total_movies_person_1769, SUM(CASE WHEN ci.person_id = 1459 THEN 1 ELSE 0 END) AS total_movies_person_1459, COUNT(DISTINCT cn.id) AS total_companies, COUNT(DISTINCT mi.info) AS distinct_movie_info_types FROM kind_type AS kt JOIN movie_info AS mi ON mi.movie_id = kt.id JOIN cast_info AS ci ON ci.movie_id = kt.id JOIN company_name AS cn ON cn.imdb_id = ci.movie_id WHERE kt.kind = 'movie' AND ci.person_id IN (1867, 1769, 1459, 1473, 1640, 1126) AND ci.movie_id IN (152924, 2374081, 1326173, 1098477, 1321487, 1288531) GROUP BY kt.kind;
SELECT kt.kind AS movie_kind, AVG(at.production_year) AS average_production_year, COUNT(DISTINCT ci.movie_id) AS number_of_movies, COUNT(DISTINCT ci.person_id) AS number_of_actors, SUM(CASE WHEN ci.role_id = 1 THEN 1 ELSE 0 END) AS number_of_lead_roles, COUNT(DISTINCT cn.id) AS number_of_unique_characters FROM cast_info ci JOIN aka_title at ON ci.movie_id = at.movie_id JOIN kind_type kt ON at.kind_id = kt.id JOIN char_name cn ON ci.person_role_id = cn.id WHERE at.production_year BETWEEN 1990 AND 2000 AND kt.kind = 'feature' GROUP BY kt.kind;
SELECT ct.kind AS company_type, AVG(t.production_year) AS avg_production_year, COUNT(DISTINCT t.id) AS total_movies, SUM(CASE WHEN t.kind_id = 1 THEN 1 ELSE 0 END) AS feature_film_count, MAX(t.production_year) AS latest_production_year, MIN(t.production_year) AS oldest_production_year FROM title t JOIN movie_companies mc ON t.id = mc.movie_id JOIN company_name cn ON mc.company_id = cn.id JOIN company_type ct ON mc.company_type_id = ct.id WHERE mc.movie_id IN ('14798', '11461', '25704', '25878', '18921', '29151') GROUP BY ct.kind ORDER BY total_movies DESC;
SELECT kt.kind, AVG(CAST(mi.info AS NUMERIC)) AS average_rating, COUNT(DISTINCT t.id) AS total_movies, COUNT(DISTINCT n.id) AS total_directors, MAX(t.production_year) AS latest_movie_year FROM title AS t JOIN kind_type AS kt ON t.kind_id = kt.id JOIN movie_info AS mi ON t.id = mi.movie_id LEFT JOIN person_info AS pi ON pi.person_id = t.id AND pi.info_type_id = mi.info_type_id JOIN name AS n ON n.id = pi.person_id WHERE mi.info_type_id = 4 AND kt.id IN (4, 5, 1, 6, 3) AND ( mi.note IS NULL OR mi.note IN ('(Original version)', '(none)', '(some dialogue)') ) GROUP BY kt.kind ORDER BY average_rating DESC, total_movies DESC;
SELECT ct.kind AS company_kind, it.info AS info_category, AVG(t.production_year) AS average_production_year, COUNT(t.id) AS total_titles, SUM(CASE WHEN p.info = 'Adams, Terry Wayne' THEN 1 ELSE 0 END) AS count_terry_wayne_adams_mentions, SUM(CASE WHEN p.info = '14 March 1879' THEN 1 ELSE 0 END) AS count_14_march_1879_mentions FROM title AS t JOIN company_type AS ct ON t.kind_id = ct.id JOIN person_info AS p ON p.info_type_id = ct.id JOIN info_type AS it ON p.info_type_id = it.id WHERE t.production_year BETWEEN 1990 AND 2020 GROUP BY ct.kind, it.info HAVING COUNT(t.id) > 10;
SELECT AVG(CAST(mi.info AS NUMERIC)) as average_rating, COUNT(DISTINCT at.id) as total_alternate_titles, COUNT(DISTINCT cn.id) as total_companies_involved, MAX(t.production_year) as latest_production_year, MIN(t.production_year) as earliest_production_year FROM title t LEFT JOIN movie_info_idx miidx ON miidx.movie_id = t.id LEFT JOIN info_type it ON it.id = miidx.info_type_id AND it.info = 'rating' LEFT JOIN movie_info mi ON mi.movie_id = t.id AND mi.info_type_id = it.id LEFT JOIN aka_title at ON at.movie_id = t.id LEFT JOIN movie_companies mc ON mc.movie_id = t.id LEFT JOIN company_name cn ON cn.id = mc.company_id LEFT JOIN complete_cast cc ON cc.movie_id = t.id WHERE t.production_year BETWEEN 2000 AND 2023 AND cn.country_code = '[us]' GROUP BY t.id;
SELECT AVG(keyword_summary.keyword_count) AS average_movie_keywords, SUM(role_summary.total_roles) AS sum_total_roles, COUNT(DISTINCT cct.kind) AS distinct_cast_types, AVG(CAST(mi_idx.info AS integer)) AS average_movie_votes FROM (SELECT mk.movie_id, COUNT(mk.keyword_id) AS keyword_count FROM movie_keyword AS mk GROUP BY mk.movie_id) AS keyword_summary JOIN (SELECT ci.movie_id, ci.person_role_id, COUNT(ci.id) AS total_roles FROM cast_info AS ci GROUP BY ci.movie_id, ci.person_role_id) AS role_summary ON keyword_summary.movie_id = role_summary.movie_id JOIN movie_info_idx AS mi_idx ON keyword_summary.movie_id = mi_idx.movie_id AND mi_idx.info_type_id = 1 JOIN comp_cast_type AS cct ON role_summary.person_role_id = cct.id WHERE CAST(mi_idx.info AS integer) > 10000 GROUP BY mi_idx.info_type_id;
SELECT COUNT(DISTINCT t.id) AS total_movies, AVG(t.production_year) AS average_production_year, COUNT(DISTINCT mc.company_id) AS number_of_companies, SUM(CASE WHEN lt.link LIKE '%remake of%' THEN 1 ELSE 0 END) AS total_remake_movies, COUNT(DISTINCT pi.person_id) AS number_of_persons_with_info, SUM(CASE WHEN rt.role = 'actress' THEN 1 ELSE 0 END) AS total_actress_roles FROM title AS t LEFT JOIN movie_companies AS mc ON t.id = mc.movie_id LEFT JOIN person_info AS pi ON pi.info IN ('Sand Springs, Oklahoma, USA', 'Wilmington, Delaware, USA', '29 January 1982') LEFT JOIN role_type AS rt ON rt.role IN ('editor', 'composer', 'actress') LEFT JOIN link_type AS lt ON lt.link IN ('remake of', 'spin off from', 'spoofs') WHERE t.production_year > 2000 AND mc.company_type_id = '1' AND (lt.id IN ('5', '2', '1', '15', '17') OR lt.id IS NULL) GROUP BY t.kind_id ORDER BY total_movies DESC;
SELECT AVG(CAST(mii.info AS numeric)) AS average_movie_rating, COUNT(DISTINCT mk.movie_id) AS number_of_movies, COUNT(DISTINCT pi.person_id) AS number_of_people, SUM(CASE WHEN lt.link = 'version of' THEN 1 ELSE 0 END) AS version_of_count, SUM(CASE WHEN lt.link = 'edited from' THEN 1 ELSE 0 END) AS edited_from_count FROM movie_info_idx AS mii JOIN movie_keyword AS mk ON mii.movie_id = mk.movie_id JOIN person_info AS pi ON pi.info_type_id = mii.info_type_id AND pi.note IN ('Archie York', 'InVerse PR/Infonet', 'E.A.', 'Bobbie Merritt/THE ENTERTAINMENT GROUP') LEFT JOIN link_type AS lt ON lt.id IN (12, 3) WHERE mii.note IS NOT NULL GROUP BY mii.info_type_id;
