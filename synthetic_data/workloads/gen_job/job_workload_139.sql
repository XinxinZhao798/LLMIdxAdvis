SELECT a_t.title AS alternate_title, COUNT(c_i.id) AS total_cast_members, AVG(mi_idx.info::numeric) AS average_movie_rating, SUM(CASE WHEN a_t.production_year > 2000 THEN 1 ELSE 0 END) AS post_2000_titles_count FROM aka_title AS a_t JOIN cast_info AS c_i ON a_t.movie_id = c_i.movie_id JOIN movie_info_idx AS mi_idx ON a_t.movie_id = mi_idx.movie_id WHERE mi_idx.info_type_id = 100 AND a_t.movie_id IN ('8428', '19659') GROUP BY a_t.title;
SELECT cct.kind AS cast_type_kind, it.info AS info_type, AVG(t.production_year) AS average_production_year, COUNT(DISTINCT t.id) AS count_of_movies, SUM(CASE WHEN ml.linked_movie_id IS NOT NULL THEN 1 ELSE 0 END) AS sum_of_linked_movies FROM title t JOIN comp_cast_type cct ON t.kind_id = cct.id JOIN complete_cast cc ON t.id = cc.movie_id JOIN movie_info mi ON t.id = mi.movie_id JOIN info_type it ON mi.info_type_id = it.id LEFT JOIN movie_link ml ON t.id = ml.movie_id WHERE cc.status_id IN ('3', '4') GROUP BY cct.kind, it.info ORDER BY count_of_movies DESC, sum_of_linked_movies DESC;
SELECT ct.kind AS company_kind, rt.ROLE AS role_type, AVG(t.production_year) AS average_production_year, COUNT(DISTINCT mc.movie_id) AS number_of_movies, SUM(CASE WHEN t.kind_id = 1 THEN 1 ELSE 0 END) AS number_of_feature_films FROM movie_companies AS mc JOIN company_type AS ct ON mc.company_type_id = ct.id JOIN role_type AS rt ON mc.company_type_id = rt.id JOIN title AS t ON mc.movie_id = t.id GROUP BY ct.kind, rt.ROLE ORDER BY number_of_movies DESC;
SELECT it.info AS info_category, COUNT(DISTINCT pi.person_id) AS number_of_people, AVG(CASE WHEN it.info = 'gross' THEN CAST(pi.info AS NUMERIC) END) AS average_gross, SUM(CASE WHEN it.info = 'LD quality program' THEN 1 ELSE 0 END) AS LD_quality_programs FROM person_info AS pi JOIN info_type AS it ON pi.info_type_id = it.id WHERE it.id IN (22, 25, 105) GROUP BY it.info ORDER BY info_category;
SELECT n.gender, COUNT(DISTINCT n.id) AS number_of_people, AVG(mi_idx.info::numeric) AS average_movie_rating, SUM(CASE WHEN lt.LINK = 'sequel' THEN 1 ELSE 0 END) AS count_sequel_links, COUNT(DISTINCT k.id) AS number_of_keywords, COUNT(DISTINCT an.id) AS number_of_aka_names FROM name AS n LEFT JOIN aka_name AS an ON n.id = an.person_id LEFT JOIN movie_link AS ml ON ml.movie_id IN (SELECT movie_id FROM movie_info_idx WHERE id IN (1031, 375, 3321, 4177, 537)) LEFT JOIN link_type AS lt ON ml.link_type_id = lt.id LEFT JOIN movie_info_idx AS mi_idx ON ml.movie_id = mi_idx.movie_id AND mi_idx.info_type_id = 101 LEFT JOIN movie_keyword AS mk ON ml.movie_id = mk.movie_id LEFT JOIN keyword AS k ON mk.keyword_id = k.id GROUP BY n.gender HAVING COUNT(DISTINCT k.id) > 5 ORDER BY average_movie_rating DESC;
SELECT ct.kind AS cast_type, AVG(t.production_year) AS avg_production_year, COUNT(DISTINCT cn.id) AS total_companies, SUM(CASE WHEN pi.info_type_id = 17 THEN 1 ELSE 0 END) AS count_info_type_17, COUNT(DISTINCT k.id) AS total_keywords, COUNT(DISTINCT t.id) FILTER (WHERE t.production_year > 2010) AS titles_after_2010 FROM title AS t JOIN comp_cast_type AS ct ON t.kind_id = ct.id LEFT JOIN company_name AS cn ON cn.md5sum IN ('46757a84e182ecbce2485bbe4f94c35c', '042c3abaa3eee3219096099e572cbd78', '055c9414a7d1b5428c44a7840e634a28') LEFT JOIN person_info AS pi ON pi.info IN ('Elektra', '23 September 1989') LEFT JOIN keyword AS k ON k.keyword LIKE '%' LEFT JOIN link_type AS lt ON lt.link = 'similar to' AND lt.id = 13 WHERE (t.episode_of_id = '86208' OR cn.name_pcode_nf = 'M6421') GROUP BY ct.kind;
SELECT rt.ROLE, COUNT(DISTINCT ml.movie_id) AS num_movies, AVG(CAST(mi_idx.info AS NUMERIC)) AS average_rating, COUNT(DISTINCT cn.id) AS num_companies_involved, STRING_AGG(DISTINCT it.info, ', ') AS related_info_types FROM role_type rt JOIN movie_link ml ON ml.link_type_id = rt.id AND ml.linked_movie_id IN (792877, 2127586) JOIN company_name cn ON cn.country_code LIKE '%[us]%' JOIN info_type it ON it.id IN (98, 17, 71, 5) AND it.info LIKE '%rating%' LEFT JOIN movie_info_idx mi_idx ON mi_idx.movie_id = ml.movie_id AND mi_idx.info_type_id = it.id WHERE rt.id IN (6, 7) AND rt.ROLE IN ('actor', 'cinematographer', 'producer') GROUP BY rt.ROLE ORDER BY num_movies DESC, average_rating DESC;
SELECT t.production_year, COUNT(DISTINCT mk.movie_id) AS number_of_movies_with_keywords, COUNT(DISTINCT mc.company_id) AS number_of_companies_involved, AVG(mi.info::numeric) AS average_movie_info, SUM(CASE WHEN k.phonetic_code = 'V6413' THEN 1 ELSE 0 END) AS count_of_keyword_V6413, MAX(t.title) AS latest_movie_title FROM title t LEFT JOIN movie_keyword mk ON t.id = mk.movie_id LEFT JOIN keyword k ON mk.keyword_id = k.id LEFT JOIN movie_companies mc ON t.id = mc.movie_id LEFT JOIN movie_info_idx mi ON t.id = mi.movie_id AND mi.info_type_id = 1 WHERE t.production_year BETWEEN 1990 AND 2000 AND t.kind_id = 1 AND (k.phonetic_code IN ('V6413', 'V632', 'M61', 'F5326', 'U1263', 'L261') OR k.phonetic_code IS NULL) GROUP BY t.production_year ORDER BY t.production_year DESC;
SELECT t.kind_id, COUNT(DISTINCT t.id) AS total_titles, AVG(t.production_year) AS average_production_year, SUM(CASE WHEN lt.link = 'featured in' THEN 1 ELSE 0 END) AS featured_in_count, SUM(CASE WHEN lt.link = 'references' THEN 1 ELSE 0 END) AS references_count, SUM(CASE WHEN lt.link = 'spoofed in' THEN 1 ELSE 0 END) AS spoofed_in_count, SUM(CASE WHEN lt.link = 'similar to' THEN 1 ELSE 0 END) AS similar_to_count, SUM(CASE WHEN lt.link = 'features' THEN 1 ELSE 0 END) AS features_count, SUM(CASE WHEN lt.link = 'followed by' THEN 1 ELSE 0 END) AS followed_by_count, COUNT(DISTINCT pi.person_id) AS unique_persons_involved, AVG(CASE WHEN pi.info_type_id = 1 THEN CAST(pi.info AS INTEGER) END) AS average_info_type_1, COUNT(DISTINCT CASE WHEN pi.note IS NOT NULL THEN pi.person_id END) AS count_persons_with_notes FROM title AS t JOIN link_type AS lt ON t.kind_id = lt.id LEFT JOIN person_info AS pi ON t.id = pi.person_id GROUP BY t.kind_id ORDER BY total_titles DESC;
SELECT cct.kind AS cast_type, AVG(nm.imdb_id) AS average_imdb_id, COUNT(DISTINCT an.name) AS unique_aka_names, COUNT(*) AS total_entries, SUM(CASE WHEN an.surname_pcode = 'P1' THEN 1 ELSE 0 END) AS surname_pcode_P1_count FROM name nm JOIN aka_name an ON nm.id = an.person_id JOIN complete_cast cc ON nm.id = cc.subject_id JOIN comp_cast_type cct ON cc.status_id = cct.id WHERE an.name IN ('Aldhaheri, Saeed Ali Mohammed', 'Allen-Turner, Knitted Richard', 'Allen, Clinton Layne', 'Burpee, Luke', 'Algrang, Manfred Anton', 'Alfons√≥') GROUP BY cct.kind
SELECT k.keyword, AVG(at.production_year) AS avg_production_year, COUNT(DISTINCT at.movie_id) AS total_movies, COUNT(DISTINCT at.kind_id) AS different_kinds FROM keyword AS k JOIN movie_info AS mi ON mi.info LIKE '%' || k.keyword || '%' JOIN aka_title AS at ON at.movie_id = mi.movie_id WHERE k.keyword IN ('stewardess', 'lost-film', 'reality', 'honeymoon', 'murder-mystery') AND at.note LIKE '%lost film%' GROUP BY k.keyword;
SELECT kt.kind, AVG(at.production_year) AS avg_production_year, COUNT(DISTINCT at.title) AS title_count, SUM(CASE WHEN cn.id IS NOT NULL THEN 1 ELSE 0 END) AS unique_character_count FROM aka_title AS at JOIN kind_type AS kt ON at.kind_id = kt.id LEFT JOIN movie_info AS mi ON at.movie_id = mi.movie_id LEFT JOIN char_name AS cn ON mi.movie_id = cn.id WHERE at.production_year IS NOT NULL GROUP BY kt.kind ORDER BY avg_production_year DESC, title_count DESC;
SELECT kt.kind AS movie_kind, AVG(alt.production_year) AS average_production_year, COUNT(DISTINCT alt.movie_id) AS number_of_movies, COUNT(DISTINCT mi.movie_id) AS number_of_movies_with_info, SUM(CASE WHEN rt.id = 1 THEN 1 ELSE 0 END) AS number_of_directors, COUNT(DISTINCT lt.id) AS number_of_link_types FROM aka_title alt JOIN kind_type kt ON alt.kind_id = kt.id JOIN movie_info mi ON alt.movie_id = mi.movie_id LEFT JOIN role_type rt ON mi.info_type_id = rt.id LEFT JOIN link_type lt ON mi.info_type_id = lt.id WHERE alt.phonetic_code IN ('W6', 'R2323', 'M6362', 'H4236', 'L4', 'G5214') AND rt.id IN ('10', '1', '2', '8', '3', '12') AND lt.link IN ('spin off from', 'similar to', 'spin off', 'remake of', 'edited from', 'features') AND lt.id IN ('7', '16', '5', '8', '13') AND alt.production_year IS NOT NULL GROUP BY kt.kind;
SELECT it.info AS genre, COUNT(mi.movie_id) AS number_of_movies, AVG(LENGTH(mi.info)) AS average_info_length, SUM(CASE WHEN an.name_pcode_cf IN ('A5143', 'F2162', 'B362', 'M2462') THEN 1 ELSE 0 END) AS count_actors_with_pcode FROM movie_info mi JOIN info_type it ON mi.info_type_id = it.id LEFT JOIN aka_name an ON an.person_id = mi.movie_id WHERE it.id = 40 AND mi.info IN ('Tagalog', 'Persian') GROUP BY it.info;
SELECT rt.ROLE, ct.kind, AVG(cast(chn.imdb_id as numeric)) AS avg_imdb_id, COUNT(chn.id) AS num_characters, SUM(chn.imdb_id) AS sum_imdb_id FROM char_name AS chn JOIN role_type AS rt ON chn.id = rt.id JOIN company_type AS ct ON rt.id = ct.id WHERE rt.ROLE = 'miscellaneous crew' AND ct.kind IN ('miscellaneous companies', 'special effects companies') GROUP BY rt.ROLE, ct.kind;
SELECT ct.kind AS company_type, AVG(cast_info.nr_order) AS average_cast_order, COUNT(DISTINCT aka_title.movie_id) AS unique_movies_count, SUM(CASE WHEN aka_title.note = '(Australia) (subtitle)' THEN 1 ELSE 0 END) AS subtitle_count_australia, COUNT(DISTINCT name.id) AS number_of_actors FROM company_name JOIN company_type ct ON company_name.id = ct.id JOIN cast_info ON cast_info.person_role_id IN (1085, 1377, 785, 931, 155, 1103) JOIN aka_title ON aka_title.movie_id = cast_info.movie_id JOIN name ON name.id = cast_info.person_id LEFT JOIN movie_link ON movie_link.movie_id = aka_title.movie_id AND movie_link.link_type_id = 6 WHERE company_name.md5sum IN ('95cfc537e91c24f4cdc46ebabba6ee92', '61e6938b1d826bba25234363eac1a650') GROUP BY ct.kind;
SELECT lt.LINK AS link_type, COUNT(DISTINCT ml.movie_id) AS number_of_movies, AVG(mi_idx_rank.info::FLOAT) AS average_movie_rank, COUNT(DISTINCT pi.person_id) AS number_of_people_involved, COUNT(DISTINCT mc.company_id) AS number_of_companies_involved FROM link_type AS lt JOIN movie_link AS ml ON lt.id = ml.link_type_id LEFT JOIN movie_info AS mi_idx_rank ON mi_idx_rank.movie_id = ml.movie_id AND mi_idx_rank.info_type_id = (SELECT id FROM info_type WHERE info = 'rank') LEFT JOIN movie_companies AS mc ON mc.movie_id = ml.movie_id LEFT JOIN person_info AS pi ON pi.info_type_id = (SELECT id FROM info_type WHERE info = 'biography') AND pi.info LIKE '%actor%' WHERE lt.link IN ('follows', 'edited from') AND (mc.note LIKE '(2009)%' OR mc.note LIKE '(2012)%' OR mc.note LIKE '(2000-????)%') AND ml.movie_id IN ('7361', '14633') GROUP BY lt.LINK ORDER BY average_movie_rank DESC;
SELECT rt.ROLE, COUNT(DISTINCT it.id) AS info_type_count, AVG(lt.id) AS average_link_type_id, COUNT(DISTINCT lt.id) AS link_type_count FROM role_type rt LEFT JOIN info_type it ON rt.id = it.id LEFT JOIN link_type lt ON rt.id = lt.id GROUP BY rt.ROLE ORDER BY info_type_count DESC, average_link_type_id ASC;
