SELECT AVG(CAST(mi.info AS FLOAT)) AS average_rating, COUNT(DISTINCT mc.movie_id) AS number_of_movies, cn.name AS company_name, rt.ROLE AS role_type, COUNT(DISTINCT ci.person_id) AS number_of_actors FROM movie_companies AS mc JOIN company_name AS cn ON mc.company_id = cn.id JOIN movie_info AS mi ON mc.movie_id = mi.movie_id AND mi.info_type_id = 101 JOIN cast_info AS ci ON mc.movie_id = ci.movie_id JOIN role_type AS rt ON ci.role_id = rt.id WHERE cn.name_pcode_nf IN ('C5342', 'A6514', 'W6321', 'S2', 'M1653', 'A3532') AND mc.company_id IN ('1199', '263', '157', '78') AND mi.id IN ('7268010', '7269101', '7266891', '7268390', '7270852', '7269590') GROUP BY cn.name, rt.ROLE ORDER BY average_rating DESC, number_of_movies DESC, number_of_actors DESC;
SELECT kt.kind, AVG(t.production_year) AS avg_production_year, COUNT(DISTINCT t.id) AS number_of_titles, COUNT(DISTINCT mc.company_id) AS number_of_companies, COUNT(DISTINCT ml.linked_movie_id) AS number_of_linked_movies FROM title AS t JOIN kind_type AS kt ON t.kind_id = kt.id LEFT JOIN movie_companies AS mc ON t.id = mc.movie_id LEFT JOIN movie_link AS ml ON t.id = ml.movie_id WHERE kt.kind IN ('tv series', 'episode', 'tv mini series') AND mc.company_type_id = '1' AND t.production_year BETWEEN 2005 AND 2015 GROUP BY kt.kind;
SELECT ct.kind AS company_type, AVG(t.production_year) AS average_production_year, COUNT(DISTINCT mc.movie_id) AS total_movies, COUNT(DISTINCT ml.movie_id) AS total_movie_links, SUM(CASE WHEN t.kind_id = 2 THEN 1 ELSE 0 END) AS count_of_series, COUNT(DISTINCT t.id) FILTER (WHERE t.title = 'It Came from the Nightosphere' OR t.title = 'Wes Craven Presents Don''t Look Down') AS specific_titles_count FROM title t JOIN movie_companies mc ON t.id = mc.movie_id JOIN comp_cast_type ct ON mc.company_type_id = ct.id LEFT JOIN movie_link ml ON t.id = ml.movie_id WHERE ct.id IN (2, 3) AND mc.company_type_id = 1 AND (ml.link_type_id IN (12, 1, 13, 15) OR ml.link_type_id IS NULL) GROUP BY ct.kind
SELECT kt.kind AS Movie_Type, AVG(t.production_year) AS Average_Production_Year, COUNT(DISTINCT t.id) AS Total_Movies, COUNT(DISTINCT cc.id) AS Total_Complete_Casts, SUM(CASE WHEN t.season_nr IS NOT NULL THEN 1 ELSE 0 END) AS Total_Seasons FROM title AS t JOIN kind_type AS kt ON t.kind_id = kt.id LEFT JOIN complete_cast AS cc ON t.id = cc.movie_id LEFT JOIN movie_info AS mi ON t.id = mi.movie_id WHERE t.production_year IS NOT NULL AND kt.kind IN ('movie', 'tv movie', 'video movie', 'video game') GROUP BY kt.kind ORDER BY Total_Movies DESC;
SELECT kt.kind, COUNT(DISTINCT mk.movie_id) AS number_of_movies, AVG(CAST(mi.info AS INTEGER)) AS average_rating, SUM(CASE WHEN n.gender = 'M' THEN 1 ELSE 0 END) AS male_actors, SUM(CASE WHEN n.gender = 'F' THEN 1 ELSE 0 END) AS female_actors, COUNT(DISTINCT ml.linked_movie_id) AS number_of_linked_movies FROM kind_type kt JOIN movie_info mi ON mi.info_type_id = 4 JOIN movie_keyword mk ON mk.movie_id = mi.movie_id JOIN name n ON n.surname_pcode IN ('A43', 'A415', 'A451', 'A412') JOIN movie_link ml ON ml.movie_id = mk.movie_id WHERE kt.id IN (SELECT id FROM kind_type WHERE kind IN ('movie', 'tv series', 'video game', 'video movie', 'episode')) AND ml.linked_movie_id = 2405240 GROUP BY kt.kind;
SELECT it.info AS info_category, COUNT(DISTINCT mc.movie_id) AS number_of_movies, COUNT(DISTINCT mc.company_id) AS number_of_companies, AVG(n.imdb_id) AS average_imdb_id, SUM(CASE WHEN n.gender = 'M' THEN 1 ELSE 0 END) AS male_count, SUM(CASE WHEN n.gender = 'F' THEN 1 ELSE 0 END) AS female_count, MAX(n.name) AS max_name FROM movie_companies mc JOIN person_info pi ON mc.company_id = pi.person_id JOIN info_type it ON pi.info_type_id = it.id JOIN name n ON pi.person_id = n.id GROUP BY it.info ORDER BY number_of_movies DESC, number_of_companies DESC;
SELECT ct.kind AS company_type, AVG(t.production_year) AS average_production_year, COUNT(DISTINCT t.id) AS number_of_movies, SUM(CASE WHEN ak.season_nr IS NOT NULL THEN 1 ELSE 0 END) AS number_of_series_episodes, COUNT(DISTINCT mk.keyword_id) AS unique_keywords_used, COUNT(DISTINCT ml.linked_movie_id) AS number_of_linked_movies FROM title AS t LEFT JOIN aka_title AS ak ON t.id = ak.movie_id LEFT JOIN movie_companies AS mc ON t.id = mc.movie_id LEFT JOIN company_type AS ct ON mc.company_type_id = ct.id LEFT JOIN movie_keyword AS mk ON t.id = mk.movie_id LEFT JOIN movie_link AS ml ON t.id = ml.movie_id WHERE t.production_year BETWEEN 2000 AND 2010 AND mc.note LIKE '%(TV)%' AND (ak.season_nr IN ('13', '5', '19') OR ak.season_nr IS NULL) AND (ak.production_year = '2008' OR ak.production_year IS NULL) GROUP BY ct.kind ORDER BY average_production_year DESC, number_of_movies DESC;
SELECT kt.kind AS movie_kind, AVG(CASE WHEN rt.ROLE = 'director' THEN 1 ELSE 0 END) AS avg_director_presence, COUNT(DISTINCT ml.movie_id) AS num_movies_linked, MAX(t.production_year) AS latest_production_year, MIN(t.production_year) AS earliest_production_year, SUM(CASE WHEN mi.info_type_id = 2 AND mi.info = 'color' THEN 1 ELSE 0 END) AS total_color_movies, COUNT(DISTINCT t.id) AS total_movies FROM title t LEFT JOIN kind_type kt ON t.kind_id = kt.id LEFT JOIN movie_link ml ON t.id = ml.movie_id LEFT JOIN movie_info mi ON t.id = mi.movie_id LEFT JOIN role_type rt ON mi.info_type_id = rt.id WHERE t.production_year BETWEEN 1990 AND 2020 AND kt.kind IN ('movie', 'tv series', 'video game') AND (ml.link_type_id IN (5, 12, 16) OR ml.link_type_id IS NULL) AND (ml.linked_movie_id IN (1639371, 2307098) OR ml.linked_movie_id IS NULL) AND rt.ROLE IN ('director', 'actor', 'producer') GROUP BY kt.kind ORDER BY total_movies DESC;
SELECT kt.kind AS movie_kind, COUNT(DISTINCT t.movie_id) AS total_movies, AVG(CASE WHEN mc.note LIKE '%(worldwide) (all media)%' THEN 1 ELSE NULL END) * 100 AS percentage_worldwide_distribution, COUNT(DISTINCT lt.id) FILTER (WHERE lt.link LIKE '%remake of%') AS total_remakes, AVG(t.production_year) AS average_production_year, COUNT(DISTINCT ml.linked_movie_id) FILTER (WHERE ml.link_type_id IN ('17', '16')) AS total_sequel_or_prequels, COUNT(DISTINCT n.id) AS total_actors_involved FROM kind_type AS kt JOIN aka_title AS t ON kt.id = t.kind_id LEFT JOIN movie_companies AS mc ON t.movie_id = mc.movie_id LEFT JOIN link_type AS lt ON lt.id = mc.company_type_id LEFT JOIN movie_link AS ml ON t.movie_id = ml.movie_id LEFT JOIN movie_info AS mi ON t.movie_id = mi.movie_id AND mi.info_type_id = '4' LEFT JOIN name AS n ON n.imdb_id = t.movie_id GROUP BY kt.kind;
SELECT kt.kind as Movie_Type, AVG(t.production_year) as Average_Production_Year, COUNT(DISTINCT t.id) as Total_Movies, COUNT(DISTINCT ml.movie_id) as Movies_With_Links, SUM(CASE WHEN t.series_years LIKE '2004-____' THEN 1 ELSE 0 END) as Movies_From_2004_onwards FROM title t JOIN kind_type kt ON t.kind_id = kt.id LEFT JOIN movie_link ml ON t.id = ml.movie_id AND ml.link_type_id IN ('16', '13', '8') WHERE kt.kind IN ('tv mini series', 'tv movie', 'video game', 'movie') GROUP BY kt.kind;
SELECT COUNT(DISTINCT cn.id) AS num_companies, AVG(t.production_year) AS avg_production_year, SUM(CASE WHEN rt.ROLE = 'actor' THEN 1 ELSE 0 END) AS total_actor_roles, SUM(CASE WHEN rt.ROLE = 'actress' THEN 1 ELSE 0 END) AS total_actress_roles, COUNT(DISTINCT n.id) AS num_actors, COUNT(DISTINCT t.id) AS num_titles FROM name AS n JOIN char_name AS chn ON n.name_pcode_nf = chn.name_pcode_nf JOIN role_type AS rt ON n.id = chn.id JOIN title AS t ON t.phonetic_code IN ('A1265', 'M3151', 'R5434') JOIN movie_companies AS mc ON mc.movie_id = t.id JOIN company_name AS cn ON cn.id = mc.company_id WHERE t.production_year BETWEEN 1990 AND 2000 AND chn.md5sum IN ('c8d3a477c4092e8d35d54ee4e2a854a7', '7887e4403fb219782fde01f150e22f05', 'b90077cfb2486002f9581b5cd2a1a04b', 'b6658816fc7029718e649600b2cc328e') GROUP BY t.production_year;
SELECT cn.country_code, COUNT(DISTINCT cn.id) AS num_companies, AVG(mi_idx.id) AS avg_movie_info_idx_id, SUM(CASE WHEN mi.info_type_id = mi_idx.info_type_id THEN 1 ELSE 0 END) AS sum_matching_info_types, COUNT(DISTINCT pi.person_id) AS num_people FROM company_name AS cn LEFT JOIN movie_info_idx AS mi_idx ON cn.imdb_id = mi_idx.movie_id LEFT JOIN movie_info AS mi ON mi.movie_id = mi_idx.movie_id LEFT JOIN person_info AS pi ON pi.info_type_id = mi.info_type_id WHERE cn.country_code = '[be]' AND mi_idx.movie_id IN ('925666', '929198', '939783', '925877', '930515', '925116') AND cn.md5sum IN ('6490953d16a7d7a36b9daafe4a9e84b6', 'b68f1bd9708e765d511e6e251f56419a', '11b8906a4c994a2996176bba270124ac', '8eb39544eea1fca12f1a46d1747c807c') GROUP BY cn.country_code;
SELECT c.name AS company_name, COUNT(DISTINCT t.id) AS number_of_movies, AVG(t.production_year) AS average_production_year, COUNT(DISTINCT k.keyword_id) AS distinct_keywords, COUNT(DISTINCT ml.linked_movie_id) AS linked_movies_count, COUNT(DISTINCT n.id) AS number_of_cast_members, SUM(CASE WHEN t.kind_id = 1 THEN 1 ELSE 0 END) AS number_of_feature_films, SUM(CASE WHEN t.kind_id = 2 THEN 1 ELSE 0 END) AS number_of_tv_shows, SUM(CASE WHEN t.kind_id = 3 THEN 1 ELSE 0 END) AS number_of_video_games FROM company_name c LEFT JOIN movie_keyword mk ON mk.movie_id = c.imdb_id LEFT JOIN movie_link ml ON ml.movie_id = c.imdb_id LEFT JOIN complete_cast cc ON cc.movie_id = c.imdb_id LEFT JOIN title t ON t.id = c.imdb_id LEFT JOIN name n ON n.imdb_id = c.imdb_id LEFT JOIN movie_keyword k ON k.movie_id = t.id WHERE c.name IN ('Crown International Pictures', 'Hisa-Film-Vertrieb GmbH', 'Quality Special Products', 'Hem Films', 'H & H Warranted Productions') GROUP BY c.name ORDER BY number_of_movies DESC;
SELECT kind.id AS kind_id, COUNT(DISTINCT aka_title.movie_id) AS number_of_movies, AVG(aka_title.production_year) AS average_production_year, COUNT(DISTINCT movie_info_idx.info_type_id) AS unique_info_types_count, SUM(CASE WHEN info_type.info = 'locations' THEN 1 ELSE 0 END) AS locations_count, SUM(CASE WHEN info_type.info = 'adaption' THEN 1 ELSE 0 END) AS adaption_count, SUM(CASE WHEN info_type.info = 'LD disc format' THEN 1 ELSE 0 END) AS ld_disc_format_count, SUM(CASE WHEN info_type.info = 'quotes' THEN 1 ELSE 0 END) AS quotes_count FROM aka_title JOIN movie_info_idx ON aka_title.movie_id = movie_info_idx.movie_id JOIN info_type ON movie_info_idx.info_type_id = info_type.id JOIN (SELECT id, kind_id FROM aka_title GROUP BY id, kind_id) AS kind ON aka_title.kind_id = kind.id GROUP BY kind.id ORDER BY number_of_movies DESC;
SELECT kt.kind AS movie_type, COUNT(DISTINCT mi.movie_id) AS total_movies, AVG(CAST(mi_idx.info AS FLOAT)) AS average_rating, SUM(CASE WHEN k.keyword = 'disco-ball' THEN 1 ELSE 0 END) AS disco_ball_keyword_count, SUM(CASE WHEN k.keyword = 'bandana' THEN 1 ELSE 0 END) AS bandana_keyword_count, STRING_AGG(DISTINCT ct.kind, ', ') AS involved_company_types FROM movie_info mi JOIN movie_info_idx mi_idx ON mi.movie_id = mi_idx.movie_id AND mi.info_type_id = mi_idx.info_type_id JOIN kind_type kt ON kt.id = mi.info_type_id JOIN movie_info mii ON mii.movie_id = mi.movie_id JOIN link_type lt ON lt.id = mi_idx.id JOIN keyword k ON k.id = mi_idx.id JOIN company_type ct ON ct.id = mi_idx.id WHERE mi.id IN ('7268657', '7271065', '7267731') AND mi.movie_id IN ('924506', '925955', '929745', '938512', '930430') AND ct.kind IN ('special effects companies', 'miscellaneous companies', 'production companies', 'distributors') AND mi_idx.info SIMILAR TO '(%...[0-9]*[0-9].[0-9]*[0-9]%)' GROUP BY kt.kind;
SELECT n.name AS actor_name, COUNT(DISTINCT cn.id) AS character_count, AVG(mk.keyword_id) AS average_keyword_id, SUM(CASE WHEN ml.link_type_id = 1 THEN 1 ELSE 0 END) AS direct_movie_links, COUNT(DISTINCT ml.movie_id) AS linked_movies_count FROM name n JOIN aka_name an ON n.id = an.person_id JOIN char_name cn ON an.id = cn.imdb_id JOIN movie_keyword mk ON cn.id = mk.movie_id JOIN movie_link ml ON mk.movie_id = ml.movie_id WHERE n.gender = 'm' GROUP BY n.name;
SELECT ct.kind AS company_kind, COUNT(DISTINCT mc.movie_id) AS total_movies_produced, AVG(cast_member_count) AS average_cast_members_per_movie, SUM(link_count) AS total_movie_links FROM movie_companies AS mc JOIN company_type AS ct ON mc.company_type_id = ct.id LEFT JOIN (SELECT movie_id, COUNT(*) AS cast_member_count FROM cast_info GROUP BY movie_id) AS ci ON mc.movie_id = ci.movie_id LEFT JOIN (SELECT movie_id, COUNT(*) AS link_count FROM movie_link GROUP BY movie_id) AS ml ON mc.movie_id = ml.movie_id GROUP BY ct.kind ORDER BY total_movies_produced DESC;
SELECT it.info AS information_type, COUNT(DISTINCT mi_idx.movie_id) AS number_of_movies, AVG(CAST(mi_idx.info AS NUMERIC)) AS average_info_value, COUNT(DISTINCT ml.movie_id) AS number_of_related_movies, COUNT(DISTINCT n.id) AS number_of_unique_actors, SUM(CASE WHEN rt.role = 'writer' THEN 1 ELSE 0 END) AS writers_count, SUM(CASE WHEN rt.role = 'composer' THEN 1 ELSE 0 END) AS composers_count, SUM(CASE WHEN rt.role = 'costume designer' THEN 1 ELSE 0 END) AS costume_designers_count FROM info_type it LEFT JOIN movie_info_idx mi_idx ON it.id = mi_idx.info_type_id LEFT JOIN movie_link ml ON mi_idx.movie_id = ml.movie_id LEFT JOIN link_type lt ON ml.link_type_id = lt.id LEFT JOIN complete_cast cc ON mi_idx.movie_id = cc.movie_id LEFT JOIN name n ON cc.subject_id = n.id LEFT JOIN role_type rt ON cc.status_id = rt.id WHERE it.info IN ('LD year', 'top 250 rank', 'keywords', 'LD disc format', 'release dates') AND lt.link IN ('spin off from', 'spoofed in', 'featured in') AND rt.role IN ('costume designer', 'composer', 'writer', 'miscellaneous crew') GROUP BY it.info;
SELECT kt.kind AS movie_kind, AVG(t.production_year) AS average_production_year, COUNT(DISTINCT an.person_id) AS unique_actors_with_alternate_names, COUNT(DISTINCT cn.id) AS number_of_companies, SUM(CASE WHEN t.production_year > 2000 THEN 1 ELSE 0 END) AS movies_produced_after_2000 FROM aka_name an INNER JOIN name n ON an.person_id = n.id INNER JOIN aka_title at ON n.id = at.movie_id INNER JOIN title t ON at.movie_id = t.id INNER JOIN kind_type kt ON t.kind_id = kt.id INNER JOIN company_name cn ON t.id = cn.imdb_id LEFT JOIN char_name chn ON an.person_id = chn.id WHERE (chn.name = 'Clarkson' OR chn.name = 'Miguelito' OR chn.name = 'Basket coach') GROUP BY kt.kind;
SELECT ct.kind AS cast_type, AVG(mc.company_id) AS average_company_id, SUM(CASE WHEN mi.info_type_id = 1 THEN 1 ELSE 0 END) AS count_genre_info, COUNT(DISTINCT k.id) AS unique_keyword_count, MAX(mi.movie_id) AS max_movie_id FROM comp_cast_type ct JOIN complete_cast cc ON ct.id = cc.subject_id JOIN movie_companies mc ON cc.movie_id = mc.movie_id JOIN movie_info mi ON mc.movie_id = mi.movie_id JOIN keyword k ON k.id = ANY(ARRAY[6997, 6526]) WHERE mc.company_type_id BETWEEN 1 AND 5 AND mi.info_type_id IN (1, 2, 3, 4) AND mi.note IS NOT NULL AND cc.status_id IN (SELECT id FROM link_type WHERE id IN (4, 8, 12)) GROUP BY ct.kind ORDER BY unique_keyword_count DESC, average_company_id;
