SELECT rt.ROLE AS role_type, COUNT(DISTINCT ci.person_id) AS total_actors, AVG(ci.nr_order) AS average_order, SUM(case when pi.info_type_id = 27 then 1 else 0 end) AS num_actors_with_biography, MIN(mi.info) AS earliest_movie_date, MAX(mi.info) AS latest_movie_date, COUNT(DISTINCT mi.movie_id) AS movie_count FROM cast_info ci JOIN role_type rt ON ci.role_id = rt.id LEFT JOIN person_info pi ON ci.person_id = pi.person_id AND pi.info_type_id = 27 JOIN movie_info mi ON ci.movie_id = mi.movie_id WHERE ci.role_id IN (SELECT id FROM role_type WHERE ROLE IN ('actor', 'actress')) AND mi.info_type_id = 3 GROUP BY rt.ROLE ORDER BY total_actors DESC, average_order;
SELECT COUNT(DISTINCT cn.id) AS character_count, COUNT(DISTINCT mc.movie_id) AS movie_count, COUNT(DISTINCT mc.company_id) AS company_count, AVG(kw.id) AS average_keyword_id, SUM(mc.company_type_id) AS total_company_types FROM char_name AS cn INNER JOIN movie_companies AS mc ON cn.id = mc.company_id INNER JOIN keyword AS kw ON kw.id = mc.movie_id GROUP BY mc.company_type_id ORDER BY character_count DESC, movie_count DESC;
SELECT c.name AS company_name, c.country_code, COUNT(DISTINCT t.id) AS number_of_titles, AVG(t.production_year) AS average_production_year, SUM(CASE WHEN p.gender = 'M' THEN 1 ELSE 0 END) AS number_of_male_contributors, SUM(CASE WHEN p.gender = 'F' THEN 1 ELSE 0 END) AS number_of_female_contributors, COUNT(DISTINCT pi.person_id) AS number_of_contributors FROM company_name AS c JOIN aka_title AS t ON c.id = t.movie_id JOIN movie_info_idx AS mi ON t.movie_id = mi.movie_id JOIN person_info AS pi ON pi.person_id = mi.movie_id JOIN name AS p ON pi.person_id = p.id WHERE c.country_code LIKE 'US%' AND mi.info_type_id IN (100, 101, 99) GROUP BY c.name, c.country_code ORDER BY number_of_titles DESC;
SELECT MAX(cn.name) AS company_name, ct.kind AS company_kind, COUNT(DISTINCT cn.id) AS num_companies, AVG(cn.imdb_id) AS average_imdb_id, COUNT(DISTINCT cct.id) AS cast_type_count, SUM(CASE WHEN cn.country_code = 'US' THEN 1 ELSE 0 END) AS us_based_companies, COUNT(DISTINCT it.id) AS info_type_count, COUNT(DISTINCT lt.id) AS link_type_count FROM company_name cn JOIN company_type ct ON cn.id = ct.id JOIN comp_cast_type cct ON cn.id = cct.id JOIN info_type it ON cn.id = it.id JOIN link_type lt ON cn.id = lt.id WHERE cn.country_code IN ('US', 'JP', 'FR') AND cn.name_pcode_sf IN ('M3652', 'A6163', 'L2641', 'D6123') AND ct.id IN (1, 2, 3, 4) AND ct.kind IN ('special effects companies', 'miscellaneous companies', 'production companies', 'distributors') GROUP BY ct.kind ORDER BY us_based_companies DESC, num_companies DESC;
SELECT ct.kind AS company_type, COUNT(DISTINCT mi.movie_id) AS number_of_movies, AVG(mi.info_type_id) AS average_info_type_id, SUM(CASE WHEN lt.link = 'featured in' THEN 1 ELSE 0 END) AS featured_in_count, SUM(CASE WHEN lt.link = 'version of' THEN 1 ELSE 0 END) AS version_of_count, COUNT(DISTINCT CASE WHEN rt.role = 'actor' THEN mi.movie_id END) AS actor_movie_count FROM movie_info mi JOIN company_type ct ON mi.info_type_id = ct.id JOIN link_type lt ON mi.id = lt.id JOIN role_type rt ON mi.id = rt.id WHERE mi.movie_id IN (925851, 931906, 924737, 927210, 924162) GROUP BY ct.kind ORDER BY number_of_movies DESC;
SELECT it.info AS info_category, COUNT(DISTINCT pi.person_id) AS number_of_people, AVG(CASE WHEN it.info = 'gross' THEN CAST(pi.info AS NUMERIC) END) AS average_gross, SUM(CASE WHEN it.info = 'LD quality program' THEN 1 ELSE 0 END) AS LD_quality_programs FROM person_info AS pi JOIN info_type AS it ON pi.info_type_id = it.id WHERE it.id IN (22, 25, 105) GROUP BY it.info ORDER BY info_category;
SELECT ct.kind AS company_kind, COUNT(DISTINCT mc.movie_id) AS number_of_movies, AVG(CAST(mi_idx.info AS numeric)) AS average_rating, SUM(CASE WHEN cct.kind = 'complete+verified' THEN 1 ELSE 0 END) AS complete_verified_casts, COUNT(DISTINCT cn.id) AS number_of_actors FROM movie_companies AS mc JOIN company_type AS ct ON mc.company_type_id = ct.id LEFT JOIN movie_info_idx AS mi_idx ON mc.movie_id = mi_idx.movie_id LEFT JOIN complete_cast AS cc ON mc.movie_id = cc.movie_id LEFT JOIN comp_cast_type AS cct ON cc.status_id = cct.id LEFT JOIN char_name AS cn ON cc.subject_id = cn.id WHERE mc.movie_id IN (27359, 1639517, 1663098) AND mc.company_id IN (SELECT company_id FROM movie_companies WHERE company_type_id IN (1, 2)) GROUP BY ct.kind HAVING COUNT(DISTINCT mc.movie_id) > 1 ORDER BY number_of_movies DESC, average_rating DESC;
SELECT kt.kind AS movie_kind, rt.ROLE AS role_type, AVG(ci.nr_order) AS avg_cast_order, COUNT(DISTINCT mk.keyword_id) AS keyword_count, COUNT(DISTINCT ml.linked_movie_id) AS linked_movies_count, COUNT(DISTINCT at.movie_id) AS aka_titles_count, SUM(CASE WHEN ci.person_role_id IS NOT NULL THEN 1 ELSE 0 END) AS credited_roles_count FROM cast_info ci JOIN role_type rt ON ci.role_id = rt.id JOIN kind_type kt ON kt.id = (SELECT kind_id FROM aka_title WHERE movie_id = ci.movie_id LIMIT 1) JOIN movie_keyword mk ON mk.movie_id = ci.movie_id JOIN movie_link ml ON ml.movie_id = ci.movie_id LEFT JOIN aka_title at ON at.movie_id = ci.movie_id WHERE ci.nr_order IN (21, 36) AND rt.id IN (7, 12, 10) AND rt.ROLE IN ('director', 'production designer', 'editor', 'costume designer') GROUP BY kt.kind, rt.ROLE;
SELECT rt.role AS role_type, COUNT(ml.movie_id) AS number_of_movies, AVG(it.id) AS average_info_type_id, SUM(CASE WHEN ml.link_type_id = 8 THEN 1 ELSE 0 END) AS count_link_type_8, SUM(CASE WHEN ml.link_type_id = 11 THEN 1 ELSE 0 END) AS count_link_type_11, SUM(CASE WHEN ml.link_type_id = 3 THEN 1 ELSE 0 END) AS count_link_type_3 FROM movie_link AS ml JOIN role_type AS rt ON rt.id = ml.link_type_id JOIN info_type AS it ON it.id = ml.link_type_id GROUP BY rt.role ORDER BY number_of_movies DESC, average_info_type_id DESC;
