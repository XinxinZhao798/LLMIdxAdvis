SELECT cn.country_code, COUNT(DISTINCT cn.id) AS total_companies, AVG(cn.imdb_id) AS average_imdb_id, SUM(CASE WHEN lt.id = '11' THEN 1 ELSE 0 END) AS count_link_type_11, COUNT(DISTINCT mi.movie_id) AS total_movies, COUNT(CASE WHEN mi.info_type_id = '4' THEN 1 ELSE NULL END) AS count_info_type_4 FROM company_name cn JOIN movie_info mi ON cn.imdb_id = mi.movie_id LEFT JOIN link_type lt ON cn.id = lt.id GROUP BY cn.country_code ORDER BY total_companies DESC, average_imdb_id;
SELECT kt.kind AS movie_type, AVG(at.production_year) AS average_production_year, COUNT(DISTINCT ci.movie_id) AS total_movies, COUNT(DISTINCT ci.person_id) AS total_actors, SUM(CASE WHEN mc.note LIKE '%(TV)%' THEN 1 ELSE 0 END) AS total_tv_movies, SUM(CASE WHEN mc.note LIKE '%(DVD)%' THEN 1 ELSE 0 END) AS total_dvd_movies, SUM(CASE WHEN mc.note LIKE '%(VHS)%' THEN 1 ELSE 0 END) AS total_vhs_movies FROM kind_type kt JOIN aka_title at ON kt.id = at.kind_id JOIN movie_companies mc ON at.movie_id = mc.movie_id JOIN cast_info ci ON at.movie_id = ci.movie_id GROUP BY kt.kind;
SELECT kt.kind, COUNT(DISTINCT t.id) AS num_movies, AVG(t.production_year) AS avg_production_year, COUNT(DISTINCT k.id) AS num_keywords, COUNT(DISTINCT mc.company_id) AS num_companies, COUNT(DISTINCT ml.linked_movie_id) AS num_linked_movies FROM title t JOIN kind_type kt ON t.kind_id = kt.id LEFT JOIN movie_keyword mk ON t.id = mk.movie_id LEFT JOIN keyword k ON mk.keyword_id = k.id LEFT JOIN movie_companies mc ON t.id = mc.movie_id LEFT JOIN movie_link ml ON t.id = ml.movie_id WHERE kt.kind IN ('movie', 'tv mini series', 'video game') AND t.production_year > 2010 AND k.keyword IN ('meadow', 'dry-ice', 'firing-squad', 'hurt', 'wall-phone') GROUP BY kt.kind ORDER BY num_movies DESC;
SELECT COUNT(DISTINCT at.id) AS total_alternate_titles, COUNT(DISTINCT ci.id) AS total_cast_members, AVG(at.production_year) AS average_production_year, SUM(mc.company_id) AS total_companies_involved, COUNT(DISTINCT cc.id) AS total_complete_casts, STRING_AGG(DISTINCT lt.LINK, '; ') AS link_types_used FROM aka_title AS at JOIN cast_info AS ci ON at.movie_id = ci.movie_id JOIN movie_companies AS mc ON at.movie_id = mc.movie_id JOIN complete_cast AS cc ON at.movie_id = cc.movie_id JOIN link_type AS lt ON cc.status_id = lt.id WHERE at.production_year > 2000 AND ci.note IS NOT NULL AND cc.id IN ('2731', '2678', '7', '3665') AND at.season_nr IN (8, 4, 11, 22) AND at.md5sum IN ('ae1ec4b6524d40f203cb722b6e74c9d6', '51978b45ff1151ec3cc873180401b93c') GROUP BY at.kind_id ORDER BY total_alternate_titles DESC, average_production_year;
SELECT cct.kind, COUNT(DISTINCT mi_idx.movie_id) AS number_of_movies, AVG(CAST(mi_idx.info AS INTEGER)) AS average_votes, COUNT(DISTINCT pi.person_id) AS number_of_people, SUM(CASE WHEN pi.info LIKE '%1971%' THEN 1 ELSE 0 END) AS count_people_born_1971, SUM(CASE WHEN pi.info LIKE '%O-chan%' THEN 1 ELSE 0 END) AS count_people_with_Ochan_info FROM comp_cast_type cct JOIN movie_info_idx mi_idx ON cct.id = mi_idx.info_type_id JOIN person_info pi ON pi.info_type_id = mi_idx.info_type_id WHERE cct.kind = 'crew' GROUP BY cct.kind;
SELECT lt.LINK as link_type, AVG(ml.id) as average_movie_link_id, SUM(ml.linked_movie_id) as total_linked_movie_id, COUNT(ml.movie_id) as total_movies, COUNT(DISTINCT ml.movie_id) as unique_movies_linked, CCT.kind as comp_cast_type_kind, COUNT(CCT.id) as comp_cast_type_count FROM movie_link as ml JOIN link_type as lt ON ml.link_type_id = lt.id JOIN comp_cast_type as CCT ON CCT.id = ml.link_type_id GROUP BY lt.LINK, CCT.kind ORDER BY total_movies DESC;
SELECT kt.kind AS movie_kind, AVG(t.production_year) AS average_production_year, COUNT(DISTINCT t.id) AS total_movies, COUNT(DISTINCT mi.info) AS unique_info_types, SUM(CASE WHEN t.season_nr IN ('8', '20', '12', '24', '33') THEN 1 ELSE 0 END) AS count_specific_seasons, COUNT(DISTINCT pi.person_id) AS total_persons_involved FROM title AS t JOIN kind_type AS kt ON t.kind_id = kt.id LEFT JOIN movie_info_idx AS mi ON t.id = mi.movie_id LEFT JOIN person_info AS pi ON pi.person_id = t.id GROUP BY kt.kind ORDER BY total_movies DESC;
SELECT ct.kind AS company_type, AVG(CAST(mi.info AS NUMERIC)) AS average_rating, COUNT(DISTINCT mk.movie_id) AS movie_count, COUNT(k.id) AS keyword_count, SUM(CASE WHEN it.info = 'LD official retail price' THEN CAST(mi.info AS NUMERIC) ELSE 0 END) AS total_official_retail_price FROM company_type ct JOIN movie_info mi ON ct.id = mi.info_type_id JOIN movie_keyword mk ON mi.movie_id = mk.movie_id JOIN keyword k ON mk.keyword_id = k.id JOIN info_type it ON mi.info_type_id = it.id WHERE mk.keyword_id IN (2506, 2862, 589, 3476, 4237) AND k.phonetic_code IN ('D1653', 'H532', 'M6321', 'H4326', 'F2426', 'A3513') AND it.id IN (15, 16, 18, 76, 39, 111) AND mi.movie_id IN (9091, 13237, 927238) AND (mi.note ILIKE '%(English subtitles)%' OR mi.note ILIKE '%(Original version)%') GROUP BY ct.kind;
SELECT AVG(ati.production_year) AS average_production_year, COUNT(DISTINCT ci.movie_id) AS total_movies, COUNT(DISTINCT ci.person_id) AS total_people_involved, SUM(CASE WHEN ci.role_id = 1 THEN 1 ELSE 0 END) AS total_actors, SUM(CASE WHEN ci.role_id = 2 THEN 1 ELSE 0 END) AS total_directors, MAX(ati.title) AS latest_added_alternative_title FROM cast_info ci JOIN aka_title ati ON ati.movie_id = ci.movie_id WHERE ati.production_year BETWEEN 1990 AND 2000 AND ci.person_role_id IN ('902', '627', '757', '669') AND ci.id IN ('18028', '15918', '15273', '16871') GROUP BY ati.movie_id ORDER BY total_movies DESC, total_people_involved DESC;
SELECT a.title AS alternate_title, AVG(kt.production_year) AS avg_production_year, COUNT(DISTINCT n.id) AS number_of_contributors, SUM(CASE WHEN kw.keyword = 'ball' THEN 1 ELSE 0 END) AS ball_keyword_count, SUM(CASE WHEN kw.keyword = 'advisor' THEN 1 ELSE 0 END) AS advisor_keyword_count FROM aka_title a INNER JOIN keyword kw ON kw.phonetic_code = a.phonetic_code INNER JOIN aka_title kt ON kt.id = a.movie_id AND kt.kind_id = a.kind_id LEFT JOIN name n ON n.name_pcode_cf = a.phonetic_code WHERE a.movie_id IN ('1644521', '1664207') GROUP BY a.title;
SELECT COUNT(DISTINCT mk.movie_id) AS total_movies, k.keyword, AVG(lt.id) AS average_link_type_id, SUM(CASE WHEN k.phonetic_code = 'T2351' THEN 1 ELSE 0 END) AS count_t2351, SUM(CASE WHEN k.phonetic_code = 'D35' THEN 1 ELSE 0 END) AS count_d35 FROM movie_keyword AS mk JOIN keyword AS k ON mk.keyword_id = k.id JOIN link_type AS lt ON mk.id = lt.id GROUP BY k.keyword ORDER BY total_movies DESC, k.keyword;
SELECT a.imdb_index AS imdb_index_version, AVG(a.production_year) AS average_production_year, COUNT(DISTINCT c.person_id) AS number_of_people_involved, COUNT(DISTINCT k.id) AS number_of_unique_keywords, lt.LINK AS link_type_description FROM aka_title a JOIN cast_info c ON a.movie_id = c.movie_id JOIN movie_keyword mk ON a.movie_id = mk.movie_id JOIN keyword k ON mk.keyword_id = k.id JOIN movie_link ml ON a.movie_id = ml.movie_id JOIN link_type lt ON ml.link_type_id = lt.id WHERE a.imdb_index IN ('I', 'II', 'III', 'IV') AND lt.LINK IN ('remake of', 'version of') GROUP BY a.imdb_index, lt.LINK ORDER BY average_production_year DESC;
SELECT kt.kind AS content_type, COUNT(*) AS total_titles, AVG(cn.imdb_id) AS average_imdb_id, COUNT(DISTINCT cn.country_code) AS unique_country_codes, SUM(CASE WHEN an.imdb_index = 'I' THEN 1 ELSE 0 END) AS count_primary_aka_names FROM kind_type AS kt JOIN company_name AS cn ON cn.id = kt.id LEFT JOIN aka_name AS an ON an.person_id = cn.id WHERE kt.id IN ('4', '3', '5', '6', '1', '2') GROUP BY kt.kind ORDER BY total_titles DESC;
SELECT AVG(aka_title.production_year) AS avg_production_year, COUNT(DISTINCT movie_keyword.keyword_id) AS num_keywords, COUNT(DISTINCT aka_title.movie_id) AS num_movies, AVG(COUNT(DISTINCT aka_title.movie_id)) OVER (PARTITION BY aka_title.production_year) AS avg_num_movies_per_year FROM aka_title JOIN complete_cast ON aka_title.movie_id = complete_cast.movie_id JOIN movie_keyword ON aka_title.movie_id = movie_keyword.movie_id WHERE complete_cast.status_id = 1 GROUP BY aka_title.production_year;
SELECT AVG(CAST(mi.info AS FLOAT)) AS average_rating, COUNT(DISTINCT mk.keyword_id) AS number_of_keywords, COUNT(DISTINCT cn.id) AS number_of_companies, cn.country_code FROM movie_info mi JOIN movie_keyword mk ON mi.movie_id = mk.movie_id JOIN company_name cn ON cn.imdb_id = mi.movie_id WHERE mi.info_type_id = (SELECT id FROM info_type WHERE info = 'rating') AND cn.country_code = 'US' GROUP BY cn.country_code;
