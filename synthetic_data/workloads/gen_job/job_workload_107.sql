SELECT ct.kind AS company_type_kind, AVG(name.imdb_id) AS avg_imdb_id, COUNT(DISTINCT aka_name.person_id) AS unique_aka_person_count, SUM(CASE WHEN pi.info_type_id = '22' THEN 1 ELSE 0 END) AS count_info_type_22, MAX(mc.note) AS max_movie_company_note FROM movie_companies AS mc JOIN comp_cast_type AS cct ON mc.company_type_id = cct.id JOIN name ON name.id = mc.company_id JOIN aka_name ON aka_name.person_id = name.id LEFT JOIN person_info AS pi ON pi.person_id = name.id JOIN company_type AS ct ON ct.id = mc.company_type_id WHERE cct.kind = 'crew' AND name.surname_pcode IN ('A43', 'A432') AND name.md5sum IN ('95a7b086dc6ce3e141f3acbc8b45cc12', '27e967b3984165c80f751a75ef91e3fc') GROUP BY ct.kind;
SELECT ct.kind AS company_type, AVG(t.production_year) AS average_production_year, COUNT(DISTINCT mc.movie_id) AS total_movies, COUNT(DISTINCT ml.movie_id) AS total_movie_links, SUM(CASE WHEN t.kind_id = 2 THEN 1 ELSE 0 END) AS count_of_series, COUNT(DISTINCT t.id) FILTER (WHERE t.title = 'It Came from the Nightosphere' OR t.title = 'Wes Craven Presents Don''t Look Down') AS specific_titles_count FROM title t JOIN movie_companies mc ON t.id = mc.movie_id JOIN comp_cast_type ct ON mc.company_type_id = ct.id LEFT JOIN movie_link ml ON t.id = ml.movie_id WHERE ct.id IN (2, 3) AND mc.company_type_id = 1 AND (ml.link_type_id IN (12, 1, 13, 15) OR ml.link_type_id IS NULL) GROUP BY ct.kind
SELECT kt.kind AS movie_type, COUNT(DISTINCT t.id) AS number_of_movies, AVG(t.production_year) AS average_production_year, COUNT(DISTINCT mc.company_id) AS number_of_production_companies, COUNT(DISTINCT pi.person_id) AS number_of_individual_contributors, SUM(CASE WHEN t.md5sum IN ('1f1ce7379075bf949e40cb57616b3f4d', '0d05192e412a817cc87628ae56d58d5b') THEN 1 ELSE 0 END) AS count_of_specific_md5sum FROM title t JOIN kind_type kt ON t.kind_id = kt.id JOIN movie_companies mc ON t.id = mc.movie_id JOIN company_type ct ON mc.company_type_id = ct.id JOIN person_info pi ON pi.person_id = t.id WHERE ct.kind = 'production' AND t.production_year BETWEEN 1990 AND 2020 GROUP BY kt.kind ORDER BY number_of_movies DESC;
SELECT n.gender, COUNT(DISTINCT ci.person_id) AS unique_actors, COUNT(DISTINCT ci.movie_id) AS movies_participated, AVG(ci.nr_order) AS average_cast_order, SUM(CASE WHEN kt.kind = 'movie' THEN 1 ELSE 0 END) AS total_movies, SUM(CASE WHEN kt.kind = 'tv' THEN 1 ELSE 0 END) AS total_tv_shows, MAX(ci.nr_order) AS highest_cast_position, MIN(ci.nr_order) AS lowest_cast_position FROM cast_info ci JOIN movie_companies mc ON ci.movie_id = mc.movie_id JOIN kind_type kt ON mc.company_type_id = kt.id JOIN name n ON ci.person_id = n.id WHERE ci.note NOT LIKE '%archive footage%' AND n.gender = 'm' GROUP BY n.gender;
SELECT kt.kind AS movie_kind, COUNT(DISTINCT cn.id) AS number_of_char_names, AVG(mi_idx.info::numeric) AS average_movie_info, SUM(CASE WHEN an.imdb_index = 'I' THEN 1 ELSE 0 END) AS indexed_aka_names_count FROM kind_type AS kt JOIN movie_info_idx AS mi_idx ON mi_idx.info_type_id = kt.id LEFT JOIN char_name AS cn ON cn.imdb_id = mi_idx.movie_id LEFT JOIN aka_name AS an ON an.person_id = mi_idx.movie_id WHERE kt.id IN (SELECT DISTINCT info_type_id FROM movie_info_idx) AND cn.id IN ('60670', '10694') AND mi_idx.note IS NOT NULL GROUP BY kt.kind;
SELECT AVG(akat.production_year) AS average_production_year, COUNT(DISTINCT akat.movie_id) AS total_movies, CK.keyword, COUNT(DISTINCT chn.id) AS total_characters, SUM(CASE WHEN akat.kind_id = 1 THEN 1 ELSE 0 END) AS total_movies_kind_1, SUM(CASE WHEN akat.kind_id = 2 THEN 1 ELSE 0 END) AS total_movies_kind_2 FROM aka_title AS akat JOIN char_name AS chn ON akat.movie_id = chn.id JOIN keyword AS CK ON CK.id = akat.id WHERE akat.production_year BETWEEN 1990 AND 2020 AND CK.phonetic_code IN ('L165', 'M4236', 'B61') AND chn.surname_pcode IN ('D6452', 'A6245', 'V5612', 'C4532', 'O6252', 'P635') GROUP BY CK.keyword ORDER BY total_movies DESC, average_production_year DESC;
SELECT kt.kind AS movie_kind, AVG(t.production_year) AS avg_production_year, SUM(CASE WHEN rt.role = 'actress' THEN 1 ELSE 0 END) AS total_actress_roles, SUM(CASE WHEN rt.role = 'producer' THEN 1 ELSE 0 END) AS total_producer_roles, COUNT(DISTINCT mc.company_id) AS number_of_companies_involved FROM title AS t JOIN kind_type AS kt ON t.kind_id = kt.id LEFT JOIN movie_companies AS mc ON t.id = mc.movie_id LEFT JOIN movie_info AS mi ON t.id = mi.movie_id LEFT JOIN role_type AS rt ON mi.info_type_id = rt.id AND rt.role IN ('actress', 'producer') GROUP BY kt.kind ORDER BY number_of_companies_involved DESC, avg_production_year;
SELECT kt.kind AS movie_type, COUNT(DISTINCT ci.movie_id) AS movie_count, AVG(ci.nr_order) AS average_order_of_appearance, COUNT(DISTINCT pi.person_id) AS distinct_actors_count, SUM(CASE WHEN ci.role_id = 1 THEN 1 ELSE 0 END) AS total_lead_roles FROM cast_info ci JOIN kind_type kt ON ci.role_id = kt.id LEFT JOIN person_info pi ON ci.person_id = pi.person_id WHERE ci.person_role_id IN (1344, 1214) GROUP BY kt.kind ORDER BY movie_count DESC;
SELECT it.id AS link_type_id, COUNT(DISTINCT ml.movie_id) AS linked_movie_count, AVG(CAST(ml.movie_id AS numeric)) AS average_movie_imdb_id, COUNT(DISTINCT cn.name) AS distinct_character_count FROM movie_link AS ml JOIN char_name AS cn ON cn.imdb_id = ml.movie_id JOIN info_type AS it ON it.id = ml.link_type_id WHERE cn.md5sum IN ( '9c88a1d05f3506772ca5e69f66dc1249', '636fad97342736741e6911a8771502e5', '328bda83d9fc509b059cfde00bcd1636', 'a69ed1d744f3064af88264ac95a13e8f', 'c4f803b9dca9a572c24d55895e9eaf0a' ) AND ml.link_type_id IN ('4', '5', '9', '17') GROUP BY it.id ORDER BY linked_movie_count DESC, average_movie_imdb_id;
SELECT COUNT(DISTINCT ci.person_id) AS total_actors, AVG(kt.keyword_count) AS average_keywords_per_movie, MAX(t.production_year) AS latest_production_year, SUM(CASE WHEN ci.person_id IN (1674, 1343) THEN 1 ELSE 0 END) AS appearances_of_selected_actors FROM title t JOIN cast_info ci ON t.id = ci.movie_id JOIN (SELECT movie_id, COUNT(keyword_id) AS keyword_count FROM movie_keyword GROUP BY movie_id) kt ON kt.movie_id = t.id WHERE t.episode_of_id IN ('133358', '192556', '167400', '84369') AND t.kind_id != 7 GROUP BY t.production_year ORDER BY latest_production_year DESC;
SELECT CT.kind AS cast_type, COUNT(DISTINCT ml.movie_id) AS total_movies, AVG(CASE WHEN mi.info_type_id = 4 THEN CAST(mi.info AS INTEGER) END) AS avg_movie_length, SUM(CASE WHEN mi.info_type_id = 2 THEN CAST(mi.info AS NUMERIC) END) AS total_budget, COUNT(DISTINCT an.person_id) AS total_unique_actors FROM movie_link AS ml JOIN comp_cast_type AS CT ON ml.link_type_id = CT.id LEFT JOIN movie_info AS mi ON ml.movie_id = mi.movie_id LEFT JOIN aka_name AS an ON an.person_id = ml.linked_movie_id WHERE ml.link_type_id IN ('11', '17', '1', '16', '3') AND ml.movie_id IN ('16168', '2666', '6637', '12189') AND an.name_pcode_nf = 'Y2462' AND CT.kind = 'complete' GROUP BY CT.kind;
SELECT COUNT(DISTINCT t.id) AS total_movies, AVG(t.production_year) AS average_production_year, COUNT(DISTINCT at.id) AS total_aka_titles, COUNT(DISTINCT ml.movie_id) AS total_linked_movies, COUNT(DISTINCT cn.id) AS total_characters, COUNT(DISTINCT lt.id) AS total_link_types FROM title t LEFT JOIN aka_title at ON t.id = at.movie_id LEFT JOIN movie_link ml ON t.id = ml.movie_id LEFT JOIN char_name cn ON cn.imdb_id = t.imdb_id LEFT JOIN link_type lt ON lt.id = ml.link_type_id WHERE t.production_year > 2000 AND (at.production_year BETWEEN 2000 AND 2010 OR at.production_year IS NULL) AND lt.id IN ('103', '6', '43', '37', '45') GROUP BY t.id;
SELECT mk.movie_id, COUNT(DISTINCT mk.keyword_id) AS total_keywords, AVG(LENGTH(pi.note)) AS average_note_length, COUNT(DISTINCT lt.id) AS total_distinct_link_types FROM movie_keyword AS mk LEFT JOIN person_info AS pi ON mk.movie_id = pi.person_id LEFT JOIN link_type AS lt ON mk.movie_id = lt.id WHERE mk.keyword_id IN (820, 3672, 3996, 3616, 1099) GROUP BY mk.movie_id ORDER BY total_keywords DESC, average_note_length DESC;
SELECT ct.kind AS company_kind, AVG(mc.id) AS average_movie_company_id, COUNT(DISTINCT k.id) AS total_distinct_keywords, SUM(CASE WHEN at.production_year > 2000 THEN 1 ELSE 0 END) AS movies_after_2000, COUNT(DISTINCT rt.id) AS total_distinct_roles FROM movie_companies AS mc JOIN company_type AS ct ON mc.company_type_id = ct.id JOIN aka_title AS at ON mc.movie_id = at.movie_id JOIN movie_link AS ml ON at.movie_id = ml.movie_id JOIN keyword AS k ON k.id = ml.id JOIN role_type AS rt ON rt.id = ml.link_type_id GROUP BY ct.kind HAVING COUNT(DISTINCT at.id) > 5;
SELECT rt.ROLE, COUNT(DISTINCT ci.person_id) AS number_of_people, AVG(mc.company_id) AS average_company_id, SUM(CASE WHEN t.production_year > 2000 THEN 1 ELSE 0 END) AS movies_after_2000, COUNT(DISTINCT t.id) AS total_movies FROM cast_info ci JOIN role_type rt ON ci.role_id = rt.id JOIN title t ON ci.movie_id = t.id JOIN movie_companies mc ON t.id = mc.movie_id WHERE rt.ROLE IN ('director', 'production designer', 'costume designer', 'composer') AND t.production_year BETWEEN 1990 AND 2020 GROUP BY rt.ROLE ORDER BY number_of_people DESC;
SELECT n.name AS actor_name, AVG(t.production_year) AS average_production_year, COUNT(DISTINCT ci.movie_id) AS total_movies, COUNT(DISTINCT ci.role_id) AS distinct_roles FROM cast_info ci JOIN name n ON ci.person_id = n.id JOIN title t ON ci.movie_id = t.id WHERE n.name LIKE 'Anderson,%' AND t.production_year >= 2000 GROUP BY n.name ORDER BY total_movies DESC, average_production_year DESC;
SELECT AVG(ak.production_year) AS average_production_year, COUNT(DISTINCT cn.id) AS number_of_companies, COUNT(DISTINCT mk.movie_id) AS number_of_movies_with_keywords, SUM(CASE WHEN cc.subject_id = 1 THEN 1 ELSE 0 END) AS total_movies_with_complete_cast, MAX(pi.note) AS most_recent_person_note FROM aka_title ak JOIN movie_info mi ON ak.movie_id = mi.movie_id JOIN movie_keyword mk ON ak.movie_id = mk.movie_id JOIN company_name cn ON cn.country_code NOT IN ('[pl]') LEFT JOIN complete_cast cc ON ak.movie_id = cc.movie_id LEFT JOIN person_info pi ON pi.info_type_id = mi.info_type_id WHERE mi.info_type_id = '4' AND (pi.note IN ('Be Free Films', 'Autor', 'Fan Club President', 'Nick van de Wall', 'hwatson4964@excite.com', 'Anon.') OR pi.note IS NULL) AND ak.title IN ('DR-Dokumentar: 28. maj', 'I Want to Rob Jeff Goldblum') GROUP BY ak.kind_id ORDER BY average_production_year DESC;
SELECT kt.kind AS movie_kind, COUNT(DISTINCT mi_idx.movie_id) AS total_movies, AVG(CAST(mi_idx.info AS INTEGER)) AS average_movie_rating, SUM(CASE WHEN cn.country_code = '[sd]' THEN 1 ELSE 0 END) AS sudanese_company_movies, SUM(CASE WHEN cn.country_code = '[dz]' THEN 1 ELSE 0 END) AS algerian_company_movies, SUM(CASE WHEN cn.country_code = '[dm]' THEN 1 ELSE 0 END) AS dominican_company_movies, COUNT(DISTINCT k.id) AS total_unique_keywords FROM movie_info_idx AS mi_idx JOIN kind_type AS kt ON mi_idx.info_type_id = kt.id JOIN movie_info_idx AS mi_votes ON mi_idx.movie_id = mi_votes.movie_id AND mi_votes.info_type_id = 41 JOIN company_name AS cn ON mi_idx.movie_id = cn.imdb_id LEFT JOIN movie_keyword AS mk ON mi_idx.movie_id = mk.movie_id LEFT JOIN keyword AS k ON mk.keyword_id = k.id WHERE mi_idx.info_type_id IN (112, 72) AND kt.id IN (2, 1, 3) GROUP BY kt.kind;
SELECT cct.kind AS cast_type_kind, COUNT(DISTINCT mk.movie_id) AS number_of_movies, AVG(kt.id) AS average_kind_type_id, SUM(mk.keyword_id) AS total_keyword_id_sum FROM comp_cast_type cct JOIN movie_keyword mk ON cct.id = mk.movie_id JOIN kind_type kt ON mk.movie_id = kt.id WHERE cct.kind IN ('complete+verified', 'cast', 'crew', 'complete') AND mk.movie_id IN (13927, 7318, 9248, 15407) GROUP BY cct.kind ORDER BY number_of_movies DESC;
