SELECT kt.kind AS movie_kind, COUNT(DISTINCT ci.movie_id) AS number_of_movies, AVG(mi_idx.info::integer) AS average_rating, SUM(CASE WHEN cn.country_code = '[us]' THEN 1 ELSE 0 END) AS number_of_us_companies_involved, COUNT(DISTINCT ci.person_id) AS number_of_cast_members FROM movie_companies AS mc JOIN kind_type AS kt ON kt.id = mc.company_type_id JOIN cast_info AS ci ON ci.movie_id = mc.movie_id JOIN company_name AS cn ON cn.id = mc.company_id JOIN movie_info_idx AS mi_idx ON mi_idx.movie_id = mc.movie_id AND mi_idx.info_type_id = 101 WHERE mc.movie_id IN (19315, 15715, 19236, 19775, 18865, 11243) AND mc.note LIKE '%(TV)%' AND kt.kind IN ('movie', 'episode') AND cn.name_pcode_sf IN ('B5261', 'H1535', 'T5642', 'W5214', 'C3163', 'K2145') GROUP BY kt.kind;
SELECT kt.kind AS movie_kind, COUNT(DISTINCT ci.movie_id) AS num_movies, COUNT(DISTINCT ci.person_id) AS num_people_involved, AVG(ci.nr_order) AS avg_cast_order, SUM(case when mi_idx.info_type_id = '100' THEN 1 ELSE 0 END) AS count_type_100, SUM(case when mi_idx.info_type_id = '101' THEN 1 ELSE 0 END) AS count_type_101, SUM(case when mi_idx.info_type_id = '99' THEN 1 ELSE 0 END) AS count_type_99 FROM cast_info ci JOIN kind_type kt ON ci.role_id = kt.id JOIN movie_info_idx mi_idx ON ci.movie_id = mi_idx.movie_id WHERE mi_idx.info_type_id IN ('100', '101', '99') AND ci.person_role_id = (SELECT id FROM info_type WHERE id = '94') GROUP BY kt.kind;
SELECT AVG(mc.company_id) AS average_company_id, COUNT(DISTINCT ml.movie_id) AS linked_movies_count, SUM(CASE WHEN mi.info = 'Tatar' THEN 1 ELSE 0 END) AS tatar_movies_count, SUM(CASE WHEN mi.info = 'Hebrew' THEN 1 ELSE 0 END) AS hebrew_movies_count, SUM(CASE WHEN mi.info = 'Inuktitut' THEN 1 ELSE 0 END) AS inuktitut_movies_count, COUNT(DISTINCT an.person_id) AS unique_actors_count FROM movie_companies AS mc JOIN movie_link AS ml ON mc.movie_id = ml.movie_id JOIN movie_info AS mi ON mc.movie_id = mi.movie_id LEFT JOIN aka_name AS an ON an.surname_pcode = mi.info WHERE an.name_pcode_cf IN ('V3415', 'A5163', 'B6525') AND mi.info IN ('Tatar', 'Hebrew', 'Inuktitut') GROUP BY mc.company_type_id;
SELECT kt.kind AS movie_kind, COUNT(DISTINCT ci.movie_id) AS number_of_movies, AVG(ci.nr_order) AS average_cast_order, COUNT(DISTINCT cn.id) AS number_of_characters, SUM(CASE WHEN mi_idx.info_type_id = '100' THEN 1 ELSE 0 END) AS count_of_type_100_info, SUM(CASE WHEN mi_idx.info_type_id = '101' THEN 1 ELSE 0 END) AS count_of_type_101_info FROM cast_info ci JOIN kind_type kt ON ci.role_id = kt.id JOIN char_name cn ON ci.person_id = cn.id JOIN movie_info_idx mi_idx ON ci.movie_id = mi_idx.movie_id WHERE ci.person_id IN ('1761', '1644', '1317', '1004') AND cn.name_pcode_nf IN ('W4126', 'D563', 'P3632') AND kt.id IN ('7', '3', '5') AND mi_idx.info_type_id IN ('100', '101') GROUP BY kt.kind;
SELECT ci.person_id, ci.role_id, COUNT(ci.movie_id) AS total_movies, AVG(ci.nr_order) AS avg_cast_position, COUNT(DISTINCT cc.movie_id) AS complete_cast_movies, COUNT(DISTINCT lt.id) AS unique_link_types FROM cast_info ci LEFT JOIN complete_cast cc ON ci.movie_id = cc.movie_id LEFT JOIN link_type lt ON ci.person_role_id = lt.id GROUP BY ci.person_id, ci.role_id ORDER BY total_movies DESC, avg_cast_position;
SELECT ct.kind AS company_type, AVG(CAST(mi_idx.info AS INTEGER)) AS average_movie_rating, SUM(CASE WHEN k.phonetic_code IN ('S1521', 'I5315', 'A3252', 'G2436', 'P163', 'R5161') THEN 1 ELSE 0 END) AS count_specific_keywords, COUNT(DISTINCT at.id) AS count_distinct_titles, COUNT(DISTINCT cn.id) AS count_distinct_companies, MAX(at.production_year) AS latest_production_year, MIN(at.production_year) AS earliest_production_year FROM company_type AS ct JOIN company_name AS cn ON ct.id = cn.id JOIN movie_info_idx AS mi_idx ON mi_idx.movie_id = cn.imdb_id JOIN movie_keyword AS mk ON mk.movie_id = mi_idx.movie_id JOIN keyword AS k ON k.id = mk.keyword_id JOIN aka_title AS at ON at.movie_id = mk.movie_id WHERE ct.kind IN ('special effects companies', 'miscellaneous companies', 'production companies', 'distributors') AND k.id IN ('2313', '8814', '3289', '2874', '8924') GROUP BY ct.kind;
SELECT t.kind_id, COUNT(DISTINCT t.id) AS total_movies, AVG(t.production_year) AS average_production_year, COUNT(DISTINCT ci.person_id) AS total_actors_involved, SUM(CASE WHEN ml.link_type_id = 1 THEN 1 ELSE 0 END) AS total_sequels_linked, MAX(ci.nr_order) AS highest_cast_order FROM title t JOIN cast_info ci ON t.id = ci.movie_id LEFT JOIN movie_link ml ON t.id = ml.movie_id GROUP BY t.kind_id HAVING COUNT(DISTINCT ci.person_id) > 10 ORDER BY total_movies DESC;
SELECT mi_idx.movie_id, COUNT(DISTINCT a.person_id) AS unique_person_count, COUNT(a.id) AS total_aka_names, AVG(COUNT(a.id)) OVER () AS avg_aka_names_per_movie FROM movie_info_idx mi_idx LEFT JOIN aka_name a ON a.person_id = mi_idx.movie_id GROUP BY mi_idx.movie_id ORDER BY unique_person_count DESC, total_aka_names DESC;
SELECT kt.kind AS content_type, COUNT(*) AS total_titles, AVG(cn.imdb_id) AS average_imdb_id, COUNT(DISTINCT cn.country_code) AS unique_country_codes, SUM(CASE WHEN an.imdb_index = 'I' THEN 1 ELSE 0 END) AS count_primary_aka_names FROM kind_type AS kt JOIN company_name AS cn ON cn.id = kt.id LEFT JOIN aka_name AS an ON an.person_id = cn.id WHERE kt.id IN ('4', '3', '5', '6', '1', '2') GROUP BY kt.kind ORDER BY total_titles DESC;
SELECT rt.ROLE, COUNT(DISTINCT ci.person_id) AS total_people, AVG(CASE WHEN pi.info_type_id = 3 THEN pi.info::NUMERIC ELSE NULL END) AS average_salary, COUNT(DISTINCT mi_idx.movie_id) AS total_movies, SUM(CASE WHEN pi.info LIKE '%(1980s)%' THEN 1 ELSE 0 END) AS eighties_count FROM cast_info ci JOIN role_type rt ON ci.role_id = rt.id LEFT JOIN person_info pi ON ci.person_id = pi.person_id LEFT JOIN name n ON ci.person_id = n.id LEFT JOIN movie_info_idx mi_idx ON ci.movie_id = mi_idx.movie_id AND mi_idx.info_type_id = 4 WHERE ci.note NOT LIKE '%(credit only)%' AND n.name_pcode_nf IN ('M2424', 'R5434', 'N6416', 'P5232', 'J2545', 'M6235') GROUP BY rt.ROLE ORDER BY total_people DESC;
SELECT it.info AS info_category, COUNT(DISTINCT mc.movie_id) AS number_of_movies, AVG(CAST(mi_idx.info AS INTEGER)) AS average_rating, SUM(CASE WHEN mc.company_type_id = 1 THEN 1 ELSE 0 END) AS number_of_production_companies, SUM(CASE WHEN mc.company_type_id = 2 THEN 1 ELSE 0 END) AS number_of_distributors, COUNT(DISTINCT pi.person_id) AS number_of_people_involved, COUNT(DISTINCT ml.linked_movie_id) AS number_of_linked_movies FROM movie_info_idx AS mi_idx JOIN info_type AS it ON mi_idx.info_type_id = it.id JOIN movie_companies AS mc ON mi_idx.movie_id = mc.movie_id JOIN person_info AS pi ON mi_idx.movie_id = pi.person_id JOIN movie_link AS ml ON mi_idx.movie_id = ml.movie_id WHERE it.id IN (18, 57, 72, 5, 81) AND mc.id = 1085 AND mi_idx.id = 21 AND mc.note IS NOT NULL AND mi_idx.movie_id IN (8975, 19179, 18832, 8413, 9810) GROUP BY it.info ORDER BY number_of_movies DESC;
SELECT a.title AS alternate_title, m.title AS original_title, COUNT(DISTINCT n.id) AS number_of_actors, AVG(CAST(mi.info AS numeric)) AS average_rating, SUM(CASE WHEN n.gender = 'M' THEN 1 ELSE 0 END) AS male_actors, SUM(CASE WHEN n.gender = 'F' THEN 1 ELSE 0 END) AS female_actors FROM aka_title AS a JOIN movie_info AS mi ON a.movie_id = mi.movie_id JOIN title AS m ON a.movie_id = m.id JOIN cast_info AS ci ON m.id = ci.movie_id JOIN name AS n ON ci.person_id = n.id WHERE mi.info_type_id = (SELECT id FROM info_type WHERE info = 'rating') AND a.kind_id = (SELECT id FROM kind_type WHERE kind = 'movie') AND m.production_year BETWEEN 2000 AND 2010 AND n.name IN ('Ando, Tadao', 'Amey, Ian') GROUP BY a.title, m.title ORDER BY average_rating DESC;
SELECT kt.kind AS movie_kind, COUNT(DISTINCT mi_idx.movie_id) AS total_movies, AVG(CAST(mi_idx.info AS INTEGER)) AS average_movie_rating, SUM(CASE WHEN cn.country_code = '[sd]' THEN 1 ELSE 0 END) AS sudanese_company_movies, SUM(CASE WHEN cn.country_code = '[dz]' THEN 1 ELSE 0 END) AS algerian_company_movies, SUM(CASE WHEN cn.country_code = '[dm]' THEN 1 ELSE 0 END) AS dominican_company_movies, COUNT(DISTINCT k.id) AS total_unique_keywords FROM movie_info_idx AS mi_idx JOIN kind_type AS kt ON mi_idx.info_type_id = kt.id JOIN movie_info_idx AS mi_votes ON mi_idx.movie_id = mi_votes.movie_id AND mi_votes.info_type_id = 41 JOIN company_name AS cn ON mi_idx.movie_id = cn.imdb_id LEFT JOIN movie_keyword AS mk ON mi_idx.movie_id = mk.movie_id LEFT JOIN keyword AS k ON mk.keyword_id = k.id WHERE mi_idx.info_type_id IN (112, 72) AND kt.id IN (2, 1, 3) GROUP BY kt.kind;
SELECT kt.kind AS movie_kind, AVG(t.production_year) AS average_production_year, COUNT(DISTINCT mc.company_id) AS number_of_companies_involved, SUM(CASE WHEN it.info = 'rentals' THEN 1 ELSE 0 END) AS rental_info_count, COUNT(DISTINCT n.id) AS number_of_actors FROM title AS t JOIN kind_type AS kt ON t.kind_id = kt.id JOIN movie_companies AS mc ON t.id = mc.movie_id LEFT JOIN info_type AS it ON it.info = 'rentals' OR it.info = 'LD disc format' LEFT JOIN complete_cast AS cc ON t.id = cc.movie_id LEFT JOIN name AS n ON cc.subject_id = n.id WHERE t.production_year > 1990 AND kt.kind IN ('tv movie', 'movie') AND mc.movie_id IN (29084, 12692, 23482, 19661, 19291, 18927) GROUP BY kt.kind ORDER BY average_production_year DESC, number_of_companies_involved;
SELECT ct.kind AS cast_type, AVG(mi_idx.info::NUMERIC) AS average_rating, COUNT(DISTINCT cc.movie_id) AS total_movies, COUNT(DISTINCT lt.id) AS link_types_count, SUM(CASE WHEN rt.id IN (10, 5, 3, 8, 11, 6) THEN 1 ELSE 0 END) AS specific_role_count FROM complete_cast cc JOIN comp_cast_type ct ON cc.subject_id = ct.id JOIN movie_info_idx mi_idx ON cc.movie_id = mi_idx.movie_id AND mi_idx.info_type_id = 4 JOIN link_type lt ON lt.id IN (3, 8, 10) AND lt.link = 'features' JOIN role_type rt ON rt.id IN (10, 5, 3, 8, 11, 6) JOIN movie_info mi ON mi.movie_id = cc.movie_id WHERE cc.movie_id IN (1642852, 1666892) AND cc.status_id = 1 GROUP BY ct.kind;
SELECT ct.kind AS company_type, COUNT(DISTINCT mc.movie_id) AS total_movies, COUNT(DISTINCT mc.company_id) AS total_companies, AVG(mi_idx.info::numeric) AS average_movie_length, SUM(CASE WHEN an.name = 'Alan, Shane' THEN 1 ELSE 0 END) AS count_alan_shane_movies FROM movie_companies AS mc JOIN company_type AS ct ON mc.company_type_id = ct.id LEFT JOIN movie_info_idx AS mi_idx ON mc.movie_id = mi_idx.movie_id AND mi_idx.info_type_id = 3 LEFT JOIN aka_name AS an ON mc.movie_id = an.person_id AND an.name_pcode_nf = 'M2465' WHERE ct.kind IN ('production companies', 'special effects companies') AND mi_idx.note IS NULL GROUP BY ct.kind ORDER BY total_movies DESC;
SELECT lt.LINK AS link_type, COUNT(DISTINCT ml.movie_id) AS number_of_movies, AVG(mi_idx_rank.info::FLOAT) AS average_movie_rank, COUNT(DISTINCT pi.person_id) AS number_of_people_involved, COUNT(DISTINCT mc.company_id) AS number_of_companies_involved FROM link_type AS lt JOIN movie_link AS ml ON lt.id = ml.link_type_id LEFT JOIN movie_info AS mi_idx_rank ON mi_idx_rank.movie_id = ml.movie_id AND mi_idx_rank.info_type_id = (SELECT id FROM info_type WHERE info = 'rank') LEFT JOIN movie_companies AS mc ON mc.movie_id = ml.movie_id LEFT JOIN person_info AS pi ON pi.info_type_id = (SELECT id FROM info_type WHERE info = 'biography') AND pi.info LIKE '%actor%' WHERE lt.link IN ('follows', 'edited from') AND (mc.note LIKE '(2009)%' OR mc.note LIKE '(2012)%' OR mc.note LIKE '(2000-????)%') AND ml.movie_id IN ('7361', '14633') GROUP BY lt.LINK ORDER BY average_movie_rank DESC;
SELECT kt.kind, COUNT(DISTINCT mk.movie_id) AS number_of_movies, AVG(CAST(mi.info AS INTEGER)) AS average_rating, SUM(CASE WHEN n.gender = 'M' THEN 1 ELSE 0 END) AS male_actors, SUM(CASE WHEN n.gender = 'F' THEN 1 ELSE 0 END) AS female_actors, COUNT(DISTINCT ml.linked_movie_id) AS number_of_linked_movies FROM kind_type kt JOIN movie_info mi ON mi.info_type_id = 4 JOIN movie_keyword mk ON mk.movie_id = mi.movie_id JOIN name n ON n.surname_pcode IN ('A43', 'A415', 'A451', 'A412') JOIN movie_link ml ON ml.movie_id = mk.movie_id WHERE kt.id IN (SELECT id FROM kind_type WHERE kind IN ('movie', 'tv series', 'video game', 'video movie', 'episode')) AND ml.linked_movie_id = 2405240 GROUP BY kt.kind;
SELECT rt.role AS role, COUNT(DISTINCT an.id) AS num_people, AVG(t.production_year) AS avg_production_year, SUM(CASE WHEN ml.link_type_id = 4 THEN 1 ELSE 0 END) AS num_sequels, COUNT(DISTINCT t.id) AS num_titles FROM role_type rt JOIN aka_name an ON rt.id = an.person_id JOIN title t ON an.person_id = t.id LEFT JOIN movie_link ml ON t.id = ml.movie_id AND ml.link_type_id = 4 WHERE rt.role IN ('composer', 'writer', 'actor', 'costume designer', 'producer', 'actress') AND rt.id IN ('4', '6', '7', '2', '9') AND an.name_pcode_cf IN ('A5314', 'T215', 'W4123', 'A2425', 'C6456') AND t.production_year BETWEEN 2000 AND 2020 GROUP BY rt.role ORDER BY num_people DESC, avg_production_year DESC, num_sequels DESC, num_titles DESC;
SELECT country_stats.country_code, COUNT(DISTINCT mc.movie_id) AS number_of_movies, COUNT(DISTINCT cn.id) AS number_of_companies, AVG(cast(mi_idx.info AS FLOAT)) FILTER (WHERE mi_idx.info_type_id = 1) AS average_rating FROM movie_companies AS mc JOIN company_name AS cn ON mc.company_id = cn.id JOIN movie_info_idx AS mi_idx ON mc.movie_id = mi_idx.movie_id, LATERAL ( SELECT cn.country_code FROM company_name AS cn WHERE mc.company_id = cn.id ) AS country_stats WHERE cn.name_pcode_sf IN ('R5621', 'M4561', 'K352', 'W1432', 'S5253') AND mi_idx.note NOT IN ('a', 'b', 'c') AND mc.note SIMILAR TO '%(\(TV\)|\(Internet\))%' GROUP BY country_stats.country_code ORDER BY number_of_movies DESC, average_rating DESC;
SELECT cn.name AS company_name, COUNT(mc.movie_id) AS number_of_movies, AVG(cast(mi_idx.info AS numeric)) AS average_movie_rating, SUM(CASE WHEN lt.LINK = 'distributor' THEN 1 ELSE 0 END) AS distribution_deals_count FROM movie_companies AS mc JOIN company_name AS cn ON mc.company_id = cn.id JOIN link_type AS lt ON mc.company_type_id = lt.id LEFT JOIN movie_info_idx AS mi_idx ON mc.movie_id = mi_idx.movie_id WHERE mc.company_id IN ('908', '1169', '855') AND mc.company_type_id = '1' AND cn.name IN ('StudioCanal', 'Dollhouse', 'Images Film Library', 'Creative Video Features', 'Afterschool Special', 'Star Creations International') GROUP BY cn.name ORDER BY number_of_movies DESC, average_movie_rating DESC;
SELECT kt.kind AS movie_kind, COUNT(DISTINCT t.id) AS total_titles, AVG(t.production_year) AS average_production_year, SUM(CASE WHEN k.keyword = 'award' THEN 1 ELSE 0 END) AS total_award_keywords, SUM(CASE WHEN ci.nr_order IS NOT NULL THEN 1 ELSE 0 END) AS total_cast_order_info FROM aka_title AS t JOIN kind_type AS kt ON t.kind_id = kt.id LEFT JOIN movie_keyword AS mk ON t.movie_id = mk.movie_id LEFT JOIN keyword AS k ON mk.keyword_id = k.id LEFT JOIN cast_info AS ci ON t.movie_id = ci.movie_id WHERE kt.kind IN ('tv mini series', 'video movie', 'episode', 'tv movie') AND (k.phonetic_code = 'F3654' OR k.phonetic_code = 'E2135') AND t.season_nr IN (36, 9, 28, 2, 16, 3) AND NOT EXISTS ( SELECT 1 FROM movie_companies AS mc WHERE mc.movie_id = t.movie_id AND mc.note LIKE '%(USA)%' ) GROUP BY kt.kind ORDER BY total_titles DESC, average_production_year DESC;
SELECT kt.kind AS movie_kind, COUNT(DISTINCT ml.movie_id) AS total_movies, COUNT(DISTINCT ci.person_id) AS total_individuals_involved, AVG(CAST(mi_idx.info AS NUMERIC)) AS average_rating, SUM(CASE WHEN lt.link = 'references' THEN 1 ELSE 0 END) AS total_references, STRING_AGG(DISTINCT k.keyword, ', ') AS associated_keywords FROM movie_link AS ml JOIN link_type AS lt ON ml.link_type_id = lt.id JOIN movie_info_idx AS mi_idx ON ml.movie_id = mi_idx.movie_id JOIN keyword AS k ON mi_idx.info_type_id = k.id JOIN kind_type AS kt ON mi_idx.info_type_id = kt.id JOIN cast_info AS ci ON ml.movie_id = ci.movie_id WHERE ml.link_type_id IN (4, 2, 13, 1, 11, 9) AND lt.link IN ('unknown link', 'references') AND mi_idx.info_type_id IN (SELECT id FROM info_type WHERE info = 'rating') AND kt.id IN (SELECT id FROM kind_type WHERE kind LIKE '%movie%') AND ci.note IN ('(producer)', '(executive producer)') GROUP BY kt.kind;
SELECT kt.kind AS movie_kind, COUNT(DISTINCT mi_idx.movie_id) AS total_movies, COUNT(DISTINCT mk.movie_id) AS total_movies_with_keywords, AVG(CAST(mi_idx.info AS NUMERIC)) AS average_info_num, SUM(CAST(CASE WHEN mi_idx.info LIKE '%1%' THEN 1 ELSE 0 END AS INTEGER)) AS count_info_with_1 FROM movie_info_idx mi_idx JOIN movie_keyword mk ON mi_idx.movie_id = mk.movie_id JOIN kind_type kt ON mi_idx.info_type_id = kt.id JOIN movie_link ml ON mi_idx.movie_id = ml.movie_id JOIN name n ON ml.movie_id = n.id WHERE n.md5sum IN ('801a5d533ecc2c88317db66319d4aad9', 'caa370cb4f3c3b62016775d613ce5575', '4fc8edf0bba0a30ce337c1c452a645f0') AND ml.linked_movie_id IN (1412141, 604005, 716090) AND mi_idx.info SIMILAR TO '%[0-9]%' AND mk.keyword_id IN ( SELECT id FROM keyword WHERE keyword IN ('wind-up-toy', 'money-in-title', 'suicide-pill') ) GROUP BY kt.kind ORDER BY total_movies_with_keywords DESC;
SELECT cct.kind AS cast_type_kind, AVG(mi_idx.info::numeric) AS average_movie_length, COUNT(DISTINCT mk.movie_id) AS number_of_movies_with_keywords, COUNT(DISTINCT pi.person_id) AS number_of_people_with_info FROM comp_cast_type cct JOIN movie_info_idx mi_idx ON cct.id = mi_idx.info_type_id JOIN movie_keyword mk ON mi_idx.movie_id = mk.movie_id JOIN person_info pi ON pi.info_type_id = mi_idx.info_type_id WHERE mk.keyword_id IN (3246, 2661, 3786) AND mi_idx.info_type_id = cct.id AND pi.info_type_id = cct.id GROUP BY cct.kind;
SELECT kt.kind, AVG(CAST(mi.info AS NUMERIC)) AS average_rating, COUNT(DISTINCT n.id) AS total_actors, COUNT(DISTINCT k.id) AS total_keywords, COUNT(DISTINCT mc.movie_id) AS total_movies, MIN(mi.info) AS lowest_rating, MAX(mi.info) AS highest_rating FROM movie_companies AS mc JOIN kind_type AS kt ON mc.company_type_id = kt.id JOIN movie_companies AS mc2 ON mc2.movie_id = mc.movie_id JOIN person_info AS mi ON mi.person_id = mc2.company_id AND mi.info_type_id = 101 /* Assuming 101 is the type_id for ratings */ JOIN movie_keyword AS mk ON mk.movie_id = mc.movie_id JOIN keyword AS k ON k.id = mk.keyword_id JOIN cast_info AS ci ON ci.movie_id = mc.movie_id JOIN name AS n ON n.id = ci.person_id WHERE kt.kind = 'production' AND mc.note IS NOT NULL AND mi.info SIMILAR TO '[0-9]+(\.[0-9]+)?' AND mi.info > '0' GROUP BY kt.kind
SELECT kt.kind, COUNT(DISTINCT cn.id) as number_of_companies, COUNT(DISTINCT pi.person_id) as number_of_people, AVG(CASE WHEN pi.note SIMILAR TO '%(Coverland|Chris Hendren|maria afsharian|CelebrityLoop.com)%' THEN CAST(pi.info AS NUMERIC) ELSE NULL END) as average_info_rating, SUM(CASE WHEN kt.kind = 'video movie' THEN 1 ELSE 0 END) as video_movie_count, SUM(CASE WHEN kt.kind = 'tv mini series' THEN 1 ELSE 0 END) as tv_mini_series_count, SUM(CASE WHEN kt.kind = 'video game' THEN 1 ELSE 0 END) as video_game_count FROM company_name cn JOIN kind_type kt ON cn.id = kt.id JOIN person_info pi ON cn.id = pi.person_id WHERE cn.country_code NOT IN ('US', 'GB') AND pi.info_type_id BETWEEN 1 AND 5 AND kt.id IN ('1', '2', '4', '5', '7') GROUP BY kt.kind ORDER BY number_of_companies DESC;
SELECT kt.kind AS movie_type, COUNT(DISTINCT at.id) AS total_alternate_titles, AVG(cc.status_id) AS average_status_id, SUM(CASE WHEN at.kind_id = 7 THEN 1 ELSE 0 END) AS total_tv_shows, SUM(CASE WHEN at.kind_id = 2 THEN 1 ELSE 0 END) AS total_movies, COUNT(DISTINCT mi.id) AS total_movie_info_entries, COUNT(DISTINCT cc.id) AS total_complete_cast_entries FROM aka_title at JOIN kind_type kt ON at.kind_id = kt.id JOIN complete_cast cc ON at.movie_id = cc.movie_id LEFT JOIN movie_info_idx mi ON at.movie_id = mi.movie_id GROUP BY kt.kind ORDER BY total_alternate_titles DESC;
SELECT kt.kind AS movie_kind, AVG(aka_title.production_year) AS average_production_year, COUNT(DISTINCT aka_title.movie_id) AS total_movies, COUNT(DISTINCT movie_companies.company_id) AS total_companies_involved, SUM(case when aka_title.season_nr is not null then 1 else 0 end) AS total_seasons, COUNT(DISTINCT role_type.id) AS total_unique_roles FROM aka_title JOIN kind_type AS kt ON aka_title.kind_id = kt.id JOIN movie_companies ON aka_title.movie_id = movie_companies.movie_id JOIN company_type AS ct ON movie_companies.company_type_id = ct.id JOIN role_type ON role_type.id = movie_companies.company_id WHERE ct.kind = 'production companies' AND role_type.role IN ('guest', 'writer', 'miscellaneous crew', 'cinematographer') AND aka_title.imdb_index IN ('III', 'IV', 'I', 'II') AND aka_title.production_year BETWEEN 1990 AND 2020 GROUP BY kt.kind ORDER BY total_movies DESC;
SELECT COUNT(DISTINCT n.id) AS total_actors, AVG(t.production_year) AS average_production_year, SUM(CASE WHEN rt.role = 'actor' THEN 1 ELSE 0 END) AS total_actor_roles, SUM(CASE WHEN rt.role = 'composer' THEN 1 ELSE 0 END) AS total_composer_roles FROM name n JOIN aka_name ak ON n.id = ak.person_id JOIN role_type rt ON ak.id = rt.id JOIN title t ON ak.id = t.id JOIN movie_info_idx mi_idx ON t.id = mi_idx.movie_id JOIN movie_link ml ON t.id = ml.movie_id JOIN keyword k ON mi_idx.id = k.id JOIN company_type ct ON ml.id = ct.id WHERE t.production_year BETWEEN 1990 AND 2020 AND k.phonetic_code IN ('W2365', 'G5235', 'D26') AND ct.kind IN ('distributors', 'miscellaneous companies') AND mi_idx.info LIKE '%...0..0223%' GROUP BY t.kind_id;
