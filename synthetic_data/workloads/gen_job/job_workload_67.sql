SELECT ct.kind AS cast_type, AVG(mk.keyword_id) AS average_keyword_id, COUNT(DISTINCT at.id) AS total_alternate_titles, COUNT(DISTINCT cn.id) AS total_companies, SUM(CASE WHEN ml.linked_movie_id = 1910055 THEN 1 ELSE 0 END) AS count_linked_to_movie_1910055, COUNT(DISTINCT ml.movie_id) FILTER (WHERE ml.link_type_id BETWEEN 2 AND 3) AS count_movie_links_type_2_3, COUNT(DISTINCT cn.id) FILTER (WHERE cn.country_code IN ('[lb]', '[cn]', '[na]', '[in]', '[kr]', '[xyu]')) AS count_movies_non_english_speaking_countries FROM comp_cast_type AS ct LEFT JOIN aka_title AS at ON ct.id = at.kind_id LEFT JOIN movie_keyword AS mk ON at.movie_id = mk.movie_id LEFT JOIN company_name AS cn ON cn.name_pcode_nf = 'A6453' LEFT JOIN movie_link AS ml ON at.movie_id = ml.movie_id WHERE ct.id IN (2, 3) AND mk.movie_id IN (18826, 18728, 18726, 12088, 18819, 15536) AND mk.id IN (886, 4673, 4280, 2228, 1485, 4805) GROUP BY ct.kind;
SELECT AVG(CASE WHEN mc.company_type_id = 1 THEN mi_box_office.info::NUMERIC ELSE NULL END) AS avg_box_office_producer, AVG(CASE WHEN mc.company_type_id = 2 THEN mi_box_office.info::NUMERIC ELSE NULL END) AS avg_box_office_distributor, COUNT(DISTINCT mc.movie_id) FILTER (WHERE mc.company_type_id = 1) AS num_movies_produced, COUNT(DISTINCT mc.movie_id) FILTER (WHERE mc.company_type_id = 2) AS num_movies_distributed, COUNT(DISTINCT cn.id) AS num_companies, COUNT(DISTINCT an.person_id) AS num_persons_with_aka FROM movie_companies mc JOIN company_name cn ON mc.company_id = cn.id JOIN movie_info mi_box_office ON mc.movie_id = mi_box_office.movie_id AND mi_box_office.info_type_id = 107 LEFT JOIN aka_name an ON cn.id = an.person_id WHERE cn.country_code = 'US' AND mi_box_office.info ~ '^\d+$' GROUP BY cn.country_code;
SELECT AVG(ak.production_year) AS average_production_year, COUNT(DISTINCT ak.title) AS unique_titles_count, COUNT(DISTINCT cn.name) AS unique_character_names, COUNT(DISTINCT mk.keyword_id) AS total_keywords_used, COUNT(DISTINCT cc.id) AS complete_cast_records, SUM(CASE WHEN ak.kind_id = 1 THEN 1 ELSE 0 END) AS feature_film_count FROM aka_title ak JOIN movie_keyword mk ON ak.movie_id = mk.movie_id JOIN char_name cn ON ak.movie_id = cn.id JOIN complete_cast cc ON ak.movie_id = cc.movie_id WHERE mk.keyword_id IN ('4162', '3164', '2594', '2742', '2189') AND ak.movie_id IN ('8850', '8984') GROUP BY ak.movie_id;
SELECT MIN(n.name) AS actor_name, AVG(CASE WHEN mi.info_type_id = (SELECT id FROM info_type WHERE info = 'runtime') THEN mi.info::FLOAT ELSE NULL END) AS average_movie_length, COUNT(DISTINCT k.id) AS unique_keywords_count, SUM(CASE WHEN ct.id = '1' THEN 1 ELSE 0 END) AS production_company_movies, SUM(CASE WHEN ct.id = '2' THEN 1 ELSE 0 END) AS distributor_movies, COUNT(DISTINCT a_t.id) AS total_movies_count FROM name AS n JOIN aka_name AS an ON n.id = an.person_id JOIN movie_info AS mi ON mi.movie_id = an.id JOIN movie_keyword AS mk ON mk.movie_id = an.id JOIN keyword AS k ON k.id = mk.keyword_id JOIN aka_title AS a_t ON a_t.movie_id = an.id JOIN movie_companies AS mc ON mc.movie_id = an.id JOIN company_type AS ct ON ct.id = mc.company_type_id WHERE n.name_pcode_nf = 'J4163' AND ct.id IN ('1', '2', '3', '4') GROUP BY n.id;
SELECT ct.kind as company_type, avg(at.production_year) as average_production_year, count(distinct at.id) as total_movies, count(distinct ml.movie_id) as total_linked_movies, sum(CASE WHEN at.kind_id = 3 THEN 1 ELSE 0 END) as total_kind_id_3, sum(CASE WHEN at.kind_id = 4 THEN 1 ELSE 0 END) as total_kind_id_4 FROM aka_title at JOIN movie_link ml ON at.movie_id = ml.movie_id JOIN company_type ct ON ml.link_type_id = ct.id WHERE at.kind_id IN (3, 4) AND ml.linked_movie_id IN (766538, 436, 2392833, 1659295, 2490166) AND at.production_year > 2000 GROUP BY ct.kind;
