SELECT AVG(CAST(mi.info AS NUMERIC)) AS average_movie_length, SUM(CAST(mi_idx.info AS INTEGER)) AS total_votes, COUNT(DISTINCT cn.id) AS number_of_characters, MAX(cn.name) AS longest_character_name FROM movie_info mi JOIN movie_info_idx mi_idx ON mi.movie_id = mi_idx.movie_id AND mi.info_type_id = mi_idx.info_type_id JOIN char_name cn ON cn.id = mi.id WHERE mi.info_type_id = '4' AND mi_idx.info ~ '^\d+$' AND mi.movie_id IN ('8983', '18800', '19279', '12551') AND cn.name <> 'Clawed Stalker' GROUP BY mi.info_type_id;
SELECT it.info AS InfoType, COUNT(DISTINCT ci.movie_id) AS NumberOfMovies, COUNT(DISTINCT ci.person_id) AS NumberOfPeople, AVG(ci.nr_order) AS AverageCastOrder, COUNT(DISTINCT cc.movie_id) AS CompleteMoviesCount, MAX(n.name) AS MostCommonName, SUM(CASE WHEN n.gender = 'm' THEN 1 ELSE 0 END) AS MaleCount, SUM(CASE WHEN n.gender <> 'm' THEN 1 ELSE 0 END) AS NonMaleCount, mi.info AS MovieInfo FROM cast_info ci JOIN complete_cast cc ON ci.movie_id = cc.movie_id JOIN info_type it ON ci.role_id = it.id JOIN movie_info_idx mi ON ci.movie_id = mi.movie_id JOIN name n ON ci.person_id = n.id WHERE ci.role_id IN (100, 101, 99) AND n.surname_pcode IN ('A452', 'A424') AND n.gender = 'm' AND mi.info_type_id IN (100, 101, 99) GROUP BY it.info, mi.info ORDER BY NumberOfMovies DESC, NumberOfPeople DESC;
SELECT n.name AS actor_name, COUNT(ci.person_id) AS total_movies, AVG(t.production_year) AS average_production_year, SUM(CASE WHEN ct.kind = 'distributors' THEN 1 ELSE 0 END) AS total_distributions, COUNT(DISTINCT k.id) AS unique_keywords_used FROM name AS n JOIN cast_info AS ci ON n.id = ci.person_id JOIN title AS t ON ci.movie_id = t.id JOIN movie_companies AS mc ON t.id = mc.movie_id JOIN company_type AS ct ON mc.company_type_id = ct.id LEFT JOIN keyword AS k ON t.id = k.id WHERE n.name IN ('Anderson, Adisa', 'Amer, Hammomi', 'Anderson, Franklyn J.') GROUP BY n.name ORDER BY total_movies DESC, average_production_year DESC;
SELECT rt.ROLE, ct.kind, AVG(cast(chn.imdb_id as numeric)) AS avg_imdb_id, COUNT(chn.id) AS num_characters, SUM(chn.imdb_id) AS sum_imdb_id FROM char_name AS chn JOIN role_type AS rt ON chn.id = rt.id JOIN company_type AS ct ON rt.id = ct.id WHERE rt.ROLE = 'miscellaneous crew' AND ct.kind IN ('miscellaneous companies', 'special effects companies') GROUP BY rt.ROLE, ct.kind;
SELECT AVG(at.production_year) AS average_production_year, COUNT(DISTINCT ml.movie_id) AS count_of_movies_with_links, COUNT(DISTINCT at.movie_id) AS count_of_alternate_titles, SUM(CASE WHEN at.kind_id = 1 THEN 1 ELSE 0 END) AS count_of_movies, SUM(CASE WHEN at.kind_id = 3 THEN 1 ELSE 0 END) AS count_of_tv_shows, COUNT(DISTINCT k.id) AS count_of_unique_keywords FROM aka_title at LEFT JOIN movie_link ml ON at.movie_id = ml.movie_id LEFT JOIN keyword k ON at.title LIKE CONCAT('%', k.keyword, '%') WHERE at.production_year > 2000 AND (ml.id IN (4856, 1568, 48, 747, 1537, 3901) OR ml.linked_movie_id = 2323856) AND at.episode_nr IN (38, 29, 26, 64, 24) AND k.phonetic_code IS NOT NULL GROUP BY at.kind_id;
SELECT cct.kind AS cast_type, AVG(t.production_year) AS average_production_year, COUNT(DISTINCT k.id) AS unique_keywords_count, SUM(CASE WHEN t.kind_id = cct.id AND cct.kind = 'complete+verified' THEN 1 ELSE 0 END) AS total_complete_verified_titles, COUNT(*) AS total_titles FROM title t LEFT JOIN comp_cast_type cct ON t.kind_id = cct.id LEFT JOIN keyword k ON k.phonetic_code = t.phonetic_code GROUP BY cct.kind ORDER BY total_complete_verified_titles DESC;
SELECT n.name AS actor_name, COUNT(DISTINCT ci.movie_id) AS movies_participated, AVG(mi_idx_nr_order.avg_nr_order) AS average_cast_order, SUM(CASE WHEN mi_info.info LIKE '%budget%' THEN 1 ELSE 0 END) AS budget_movies_count, MAX(CASE WHEN mi_info.info_type_id = (SELECT id FROM movie_info_idx WHERE info = 'release dates') THEN mi_info.info ELSE NULL END) AS latest_release_date FROM name n JOIN cast_info ci ON ci.person_id = n.id LEFT JOIN (SELECT movie_id, AVG(nr_order) AS avg_nr_order FROM cast_info GROUP BY movie_id) mi_idx_nr_order ON mi_idx_nr_order.movie_id = ci.movie_id LEFT JOIN movie_info mi_info ON mi_info.movie_id = ci.movie_id WHERE n.gender = 'm' AND n.surname_pcode IN ('A416', 'A43', 'A413', 'A462') GROUP BY n.name ORDER BY movies_participated DESC, average_cast_order;
SELECT cn.name AS company_name, COUNT(mc.movie_id) AS number_of_movies, AVG(cast(mi_idx.info AS numeric)) AS average_movie_rating, SUM(CASE WHEN lt.LINK = 'distributor' THEN 1 ELSE 0 END) AS distribution_deals_count FROM movie_companies AS mc JOIN company_name AS cn ON mc.company_id = cn.id JOIN link_type AS lt ON mc.company_type_id = lt.id LEFT JOIN movie_info_idx AS mi_idx ON mc.movie_id = mi_idx.movie_id WHERE mc.company_id IN ('908', '1169', '855') AND mc.company_type_id = '1' AND cn.name IN ('StudioCanal', 'Dollhouse', 'Images Film Library', 'Creative Video Features', 'Afterschool Special', 'Star Creations International') GROUP BY cn.name ORDER BY number_of_movies DESC, average_movie_rating DESC;
SELECT ct.kind AS company_kind, COUNT(DISTINCT n.id) AS number_of_people, AVG(t.production_year) AS average_production_year, SUM(CASE WHEN t.season_nr IS NOT NULL THEN 1 ELSE 0 END) AS total_series_episodes, COUNT(DISTINCT at.id) AS number_of_alternate_titles FROM name n JOIN aka_name an ON n.id = an.person_id JOIN title t ON n.id = t.id JOIN aka_title at ON t.id = at.movie_id JOIN company_type ct ON ct.kind = 'production companies' GROUP BY ct.kind;
SELECT ct.kind AS cast_type, AVG(mi_idx.info::numeric) AS average_info_numeric, COUNT(DISTINCT cn.id) AS number_of_companies, COUNT(DISTINCT k.id) AS number_of_keywords, MAX(cn.name) AS largest_company_name FROM comp_cast_type AS ct JOIN movie_info_idx AS mi_idx ON mi_idx.info_type_id = ct.id JOIN company_name AS cn ON cn.id = mi_idx.movie_id JOIN keyword AS k ON k.id = mi_idx.info_type_id JOIN movie_link AS ml ON ml.movie_id = mi_idx.movie_id JOIN role_type AS rt ON rt.id = ml.link_type_id WHERE cn.name_pcode_nf IN ('C252', 'T5252', 'D5213', 'B4242', 'K1253', 'E4261') AND rt.ROLE LIKE '%producer%' GROUP BY ct.kind ORDER BY average_info_numeric DESC;
SELECT rt.role AS role_type, COUNT(DISTINCT n.id) AS number_of_people, AVG(n.imdb_id) AS average_imdb_id, SUM(CASE WHEN n.gender = 'F' THEN 1 ELSE 0 END) AS female_count, SUM(CASE WHEN n.gender = 'M' THEN 1 ELSE 0 END) AS male_count, COUNT(DISTINCT k.id) AS unique_keywords_used, COUNT(DISTINCT mi.movie_id) AS movies_with_notes FROM name n INNER JOIN role_type rt ON n.id = rt.id INNER JOIN keyword k ON k.phonetic_code IN ('S56', 'S12', 'S1535', 'B4535', 'A25', 'O123') INNER JOIN movie_info mi ON mi.info_type_id = k.id WHERE mi.note IN ('(some dialogue)', '(English subtitles)', '(Original version)', '(English version)') AND n.name_pcode_nf IN ('C4145', 'T641', 'Q5354', 'G6342', 'E2541') AND rt.role IN ('editor', 'director', 'production designer', 'cinematographer', 'miscellaneous crew') AND n.name IN ('Amores, Joaquín', 'Amor, Miguel Ángel', 'Anderson, Damion', 'Amokrane, Mustapha', 'Anderlik, Maddie', 'André, Emmanuel') GROUP BY rt.role;
SELECT cn.name AS company_name, AVG(CAST(mi_idx.info AS NUMERIC)) AS average_rating, COUNT(DISTINCT rt.id) AS number_of_roles, SUM(CASE WHEN cn.name_pcode_sf = 'Y5214' THEN 1 ELSE 0 END) AS count_Y5214_companies, SUM(CASE WHEN cn.name_pcode_sf = 'F2536' THEN 1 ELSE 0 END) AS count_F2536_companies FROM company_name AS cn JOIN movie_companies AS mc ON mc.company_id = cn.id JOIN movie_info_idx AS mi_idx ON mi_idx.movie_id = mc.movie_id JOIN cast_info AS ci ON ci.movie_id = mc.movie_id JOIN role_type AS rt ON rt.id = ci.role_id WHERE mi_idx.info_type_id = (SELECT id FROM info_type WHERE info = 'rating') GROUP BY cn.name HAVING COUNT(DISTINCT rt.id) > 1 ORDER BY average_rating DESC;
