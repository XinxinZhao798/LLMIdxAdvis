SELECT ct.kind AS company_type, AVG(pi.info::NUMERIC) AS average_salary, SUM(CASE WHEN cn.country_code = 'US' THEN 1 ELSE 0 END) AS number_of_us_companies, COUNT(DISTINCT cn.id) AS total_companies FROM company_name AS cn JOIN company_type AS ct ON cn.id = ct.id LEFT JOIN person_info AS pi ON cn.imdb_id = pi.person_id WHERE pi.info_type_id = 2 AND ct.kind = 'Production' GROUP BY ct.kind ORDER BY average_salary DESC;
SELECT it.info AS information_type, COUNT(DISTINCT mk.movie_id) AS number_of_movies, AVG(mc.company_id) AS average_company_id, SUM(CASE WHEN mc.company_id = 763 THEN 1 ELSE 0 END) AS count_specific_company, COUNT(DISTINCT mc.company_id) AS count_distinct_companies FROM movie_keyword AS mk INNER JOIN movie_companies AS mc ON mk.movie_id = mc.movie_id INNER JOIN complete_cast AS cc ON mc.movie_id = cc.movie_id INNER JOIN info_type AS it ON it.id = mc.company_type_id WHERE cc.status_id BETWEEN 1 AND 5 AND mc.company_id IN (763, 1012, 1500) AND mk.keyword_id BETWEEN 100 AND 200 GROUP BY it.info ORDER BY number_of_movies DESC, average_company_id;
SELECT kt.kind AS movie_kind, AVG(at.production_year) AS avg_production_year, COUNT(DISTINCT mk.movie_id) AS num_movies_with_keywords, SUM(CASE WHEN cc.status_id = '3' THEN 1 ELSE 0 END) AS count_complete_cast_status_3, SUM(CASE WHEN cc.status_id = '4' THEN 1 ELSE 0 END) AS count_complete_cast_status_4, COUNT(DISTINCT ml.movie_id) AS num_linked_movies FROM aka_title at JOIN kind_type kt ON at.kind_id = kt.id LEFT JOIN movie_keyword mk ON at.movie_id = mk.movie_id LEFT JOIN complete_cast cc ON at.movie_id = cc.movie_id LEFT JOIN movie_link ml ON at.movie_id = ml.movie_id GROUP BY kt.kind ORDER BY num_movies_with_keywords DESC, avg_production_year DESC;
SELECT mc.company_id, COUNT(mc.movie_id) AS num_movies, AVG(t.production_year) AS avg_production_year, SUM(CASE WHEN cc.status_id = 1 THEN 1 ELSE 0 END) AS num_completed_cast, MAX(t.production_year) AS latest_production_year, MIN(t.production_year) AS earliest_production_year FROM movie_companies AS mc JOIN title AS t ON mc.movie_id = t.id LEFT JOIN complete_cast AS cc ON t.id = cc.movie_id WHERE t.md5sum = '12d48ee4d0d61ef22a7ce0c5a1d93caf' GROUP BY mc.company_id ORDER BY num_movies DESC;
SELECT c.id AS company_id, c.name AS company_name, COUNT(DISTINCT m.id) AS number_of_movies, AVG(mi_numeric.info::FLOAT) AS average_movie_length, SUM(CASE WHEN ci.role_id = 1 THEN 1 ELSE 0 END) AS number_of_actors, COUNT(DISTINCT k.id) AS number_of_unique_keywords, MAX(ci.nr_order) AS max_cast_order, MIN(mc.note) AS earliest_production_note FROM movie_companies mc JOIN company_name c ON mc.company_id = c.id JOIN title m ON mc.movie_id = m.id LEFT JOIN movie_info mi ON m.id = mi.movie_id LEFT JOIN movie_info_idx mi_idx ON m.id = mi_idx.movie_id LEFT JOIN info_type it1 ON mi.info_type_id = it1.id AND it1.info = 'running time' LEFT JOIN cast_info ci ON m.id = ci.movie_id LEFT JOIN movie_keyword mk ON m.id = mk.movie_id LEFT JOIN keyword k ON mk.keyword_id = k.id LEFT JOIN movie_info mi_numeric ON m.id = mi_numeric.movie_id AND mi_numeric.info_type_id = it1.id WHERE c.country_code = '[us]' AND mi_numeric.info ~ '^[0-9]+(\.[0-9]+)?$' GROUP BY c.id, c.name ORDER BY number_of_movies DESC, average_movie_length DESC LIMIT 10;
SELECT mi.info AS genre, AVG(CAST(mi_idx.info AS numeric)) AS average_rating, COUNT(DISTINCT at.id) AS number_of_alternate_titles, at.production_year FROM movie_info mi INNER JOIN aka_title at ON mi.movie_id = at.movie_id INNER JOIN movie_info_idx mi_idx ON mi.movie_id = mi_idx.movie_id WHERE mi.info_type_id = 3 AND mi_idx.info_type_id = 1 AND at.production_year IS NOT NULL GROUP BY mi.info, at.production_year ORDER BY at.production_year DESC, average_rating DESC;
SELECT lt.LINK AS link_type, COUNT(*) AS total_links, AVG(ml.movie_id) AS average_movie_id, SUM(CASE WHEN pi.info_type_id = 7 THEN 1 ELSE 0 END) AS count_info_with_type_7, MAX(pi.note) AS latest_note FROM movie_link AS ml JOIN link_type AS lt ON ml.link_type_id = lt.id JOIN person_info AS pi ON ml.movie_id = pi.person_id GROUP BY lt.LINK ORDER BY total_links DESC;
SELECT rt.role AS role_type, AVG(at.production_year) AS avg_production_year, COUNT(DISTINCT ci.movie_id) AS total_movies_with_writers, COUNT(DISTINCT ci.person_id) AS total_different_writers, SUM(CASE WHEN at.title ILIKE 'The %' THEN 1 ELSE 0 END) AS movies_beginning_with_the FROM cast_info ci INNER JOIN role_type rt ON ci.role_id = rt.id AND rt.role = 'writer' LEFT JOIN aka_title at ON ci.movie_id = at.movie_id WHERE at.kind_id = 1 AND rt.id = 11 GROUP BY rt.role;
SELECT ct.kind AS company_type, COUNT(DISTINCT cn.id) AS number_of_companies, COUNT(DISTINCT t.id) AS number_of_movies, AVG(t.production_year) AS average_production_year, SUM(CASE WHEN cn.country_code = '[us]' THEN 1 ELSE 0 END) AS us_based_companies, COUNT(DISTINCT mk.keyword_id) AS distinct_keywords_used, COUNT(DISTINCT ml.linked_movie_id) AS distinct_linked_movies FROM company_type AS ct JOIN movie_companies AS mc ON ct.id = mc.company_type_id JOIN company_name AS cn ON mc.company_id = cn.id JOIN title AS t ON mc.movie_id = t.id LEFT JOIN movie_keyword AS mk ON t.id = mk.movie_id LEFT JOIN movie_link AS ml ON t.id = ml.movie_id WHERE ct.id IN (3, 4) AND cn.country_code IN ('[mk]', '[ua]', '[kr]', '[ir]', '[ph]') GROUP BY ct.kind ORDER BY number_of_movies DESC;
SELECT kt.kind AS movie_type, COUNT(DISTINCT t.id) AS total_movies, AVG(t.production_year) AS average_production_year, SUM(CASE WHEN mc.company_type_id = 1 THEN 1 ELSE 0 END) AS total_produced_by_company_type_1, COUNT(DISTINCT n.id) AS total_actors_involved, AVG(CAST(n.gender AS integer)) AS average_gender_code FROM title t JOIN kind_type kt ON t.kind_id = kt.id LEFT JOIN movie_companies mc ON t.id = mc.movie_id LEFT JOIN complete_cast cc ON cc.movie_id = t.id LEFT JOIN name n ON n.id = cc.subject_id AND cc.status_id = 1 GROUP BY kt.kind ORDER BY total_movies DESC;
SELECT COUNT(DISTINCT ci.movie_id) AS number_of_movies, AVG(mi_idx_cnt.count) AS average_keywords_per_movie, SUM(case when n.gender = 'M' then 1 else 0 end) AS male_actors_count, SUM(case when f.gender = 'F' then 1 else 0 end) AS female_actors_count, MIN(n.name) AS most_common_male_actor_name, MIN(f.name) AS most_common_female_actor_name FROM cast_info ci LEFT JOIN name n ON ci.person_id = n.id AND n.gender = 'M' LEFT JOIN name f ON ci.person_id = f.id AND f.gender = 'F' LEFT JOIN ( SELECT movie_id, COUNT(keyword_id) AS count FROM movie_keyword GROUP BY movie_id ) mi_idx_cnt ON ci.movie_id = mi_idx_cnt.movie_id WHERE ci.nr_order = 1 GROUP BY ci.person_id;
SELECT lt.LINK AS link_type, COUNT(DISTINCT ml.movie_id) AS number_of_movies, AVG(t.production_year) AS average_production_year, SUM(CASE WHEN n.gender = 'f' THEN 1 ELSE 0 END) AS female_cast_count, SUM(CASE WHEN n.gender = 'm' THEN 1 ELSE 0 END) AS male_cast_count FROM movie_link AS ml JOIN link_type AS lt ON ml.link_type_id = lt.id JOIN title AS t ON ml.movie_id = t.id JOIN movie_info_idx AS miidx ON miidx.movie_id = t.id JOIN info_type AS it ON miidx.info_type_id = it.id JOIN name AS n ON n.id = miidx.movie_id WHERE lt.id IN (13, 14, 8, 18, 4) AND ml.movie_id IN (10590, 11494) AND n.name_pcode_cf IN ('A4534', 'A31') GROUP BY lt.LINK ORDER BY number_of_movies DESC, average_production_year;
SELECT kt.kind AS movie_kind, COUNT(DISTINCT mc.movie_id) AS number_of_movies, AVG(mi_numeric.info::NUMERIC) AS average_budget, SUM(CASE WHEN mc.company_id = '1187' THEN 1 ELSE 0 END) AS movies_with_company_1187, SUM(CASE WHEN mc.company_id = '1024' THEN 1 ELSE 0 END) AS movies_with_company_1024, COUNT(DISTINCT ml.link_type_id) AS distinct_link_types FROM movie_companies AS mc JOIN movie_info AS mi ON mc.movie_id = mi.movie_id JOIN kind_type AS kt ON mi.info_type_id = kt.id LEFT JOIN movie_link AS ml ON mc.movie_id = ml.movie_id LEFT JOIN movie_info AS mi_numeric ON mc.movie_id = mi_numeric.movie_id AND mi_numeric.info_type_id = ( SELECT id FROM info_type WHERE info = 'budget' ) WHERE mc.company_id IN ('1187', '1024', '1009', '1239', '1034') AND mi.info_type_id IN ( SELECT id FROM info_type WHERE info = 'budget' ) AND mc.movie_id IN ('18864', '18945') GROUP BY kt.kind;
SELECT kt.kind, COUNT(DISTINCT ci.movie_id) AS number_of_movies, AVG(ci.nr_order) AS average_cast_order, COUNT(DISTINCT ci.person_id) AS number_of_actors, SUM(CASE WHEN mi_idx.info_type_id = 1 THEN 1 ELSE 0 END) AS count_of_info_type_1, AVG(CASE WHEN mi_idx.info_type_id = 1 THEN CAST(mi_idx.info AS FLOAT) ELSE NULL END) AS average_info_value_for_type_1 FROM cast_info ci JOIN kind_type kt ON ci.role_id = kt.id LEFT JOIN movie_info_idx mi_idx ON ci.movie_id = mi_idx.movie_id GROUP BY kt.kind ORDER BY number_of_movies DESC;
SELECT kt.kind AS movie_kind, COUNT(DISTINCT n.id) AS total_actors, COUNT(DISTINCT mi.movie_id) AS total_movies, AVG(CAST(mi.info AS FLOAT)) FILTER (WHERE it.info = 'rating') AS average_rating, COUNT(DISTINCT k.id) AS total_keywords, COUNT(DISTINCT mi.info) FILTER (WHERE it.info = 'release dates') AS total_release_dates FROM kind_type AS kt JOIN title AS t ON kt.id = t.kind_id JOIN movie_info AS mi ON t.id = mi.movie_id JOIN info_type AS it ON mi.info_type_id = it.id LEFT JOIN movie_keyword AS mk ON t.id = mk.movie_id LEFT JOIN keyword AS k ON mk.keyword_id = k.id LEFT JOIN cast_info AS ci ON t.id = ci.movie_id LEFT JOIN name AS n ON ci.person_id = n.id WHERE kt.kind IN ('movie', 'tv series', 'video game') AND n.gender = 'm' AND it.id IN ('17', '71', '44', '69', '79', '64') AND mi.id IN ('7266297', '7266302', '7266333', '7267324', '7267795') AND t.production_year BETWEEN 2000 AND 2010 GROUP BY kt.kind;
SELECT ct.kind AS cast_type, AVG(movcomp_notes.note_length) AS average_note_length, COUNT(DISTINCT movcomp.movie_id) AS number_of_movies, COUNT(DISTINCT comp.name) AS number_of_companies, SUM(CASE WHEN movcomp.company_type_id = 1 THEN 1 ELSE 0 END) AS number_of_producers, MAX(comp_cast.subject_id) AS max_subject_id_for_cast_type FROM complete_cast AS comp_cast JOIN comp_cast_type AS ct ON comp_cast.subject_id = ct.id JOIN movie_companies AS movcomp ON movcomp.movie_id = comp_cast.movie_id JOIN company_name AS comp ON movcomp.company_id = comp.id LEFT JOIN (SELECT movie_id, LENGTH(note) AS note_length FROM movie_companies) AS movcomp_notes ON movcomp.movie_id = movcomp_notes.movie_id WHERE comp_cast.id IN (4264, 2513, 575, 1032) AND comp_cast.subject_id = 1 AND ct.id = 4 GROUP BY ct.kind;
SELECT cn.name AS company_name, COUNT(at.id) AS number_of_titles, AVG(at.production_year) AS average_production_year, kt.kind AS movie_kind, COUNT(DISTINCT at.movie_id) AS unique_movies FROM aka_title at JOIN company_name cn ON at.movie_id = cn.id JOIN comp_cast_type kt ON at.kind_id = kt.id WHERE cn.name_pcode_sf IN ('G3532', 'J2614') AND cn.name IN ('CHASE', 'Lowbrow Customs', 'Universal Film R. T.', 'Aloisia Film', 'Home on the Range Productions') GROUP BY cn.name, kt.kind ORDER BY number_of_titles DESC, average_production_year DESC;
SELECT ct.kind AS company_kind, AVG(mi_idx.info::NUMERIC) AS average_movie_length, COUNT(DISTINCT ch_name.id) AS unique_character_count, COUNT(DISTINCT cn_name.id) AS unique_company_count, SUM(CASE WHEN ml.link_type_id = 2 THEN 1 ELSE 0 END) AS sequel_link_count FROM movie_info_idx AS mi_idx JOIN company_name AS cn_name ON cn_name.imdb_id = mi_idx.movie_id JOIN company_type AS ct ON cn_name.id = ct.id JOIN char_name AS ch_name ON ch_name.imdb_id = mi_idx.movie_id JOIN movie_link AS ml ON ml.movie_id = mi_idx.movie_id WHERE mi_idx.info_type_id = 1 AND ct.kind IN ('special effects companies', 'miscellaneous companies', 'production companies', 'distributors') AND ch_name.name IN ('Dr. Carlos Ventura', 'John Hartman Jr.', 'Paw Slawson', 'Pera', 'The Jester', 'Guitarist') GROUP BY ct.kind;
SELECT COUNT(DISTINCT t.id) AS number_of_movies, AVG(t.production_year) AS average_production_year, SUM(CASE WHEN t.kind_id = 1 THEN 1 ELSE 0 END) AS number_of_feature_films, SUM(CASE WHEN t.kind_id = 2 THEN 1 ELSE 0 END) AS number_of_tv_shows, COUNT(DISTINCT n.id) AS number_of_cast_members, COUNT(DISTINCT cc.subject_id) AS number_of_cast_types, AVG(cc.status_id) AS average_status_id FROM title AS t JOIN complete_cast AS cc ON t.id = cc.movie_id JOIN name AS n ON cc.subject_id = n.id WHERE cc.status_id = 4 AND t.production_year > 1990 GROUP BY t.kind_id ORDER BY number_of_movies DESC, average_production_year DESC;
SELECT kt.kind AS movie_type, COUNT(DISTINCT mk.movie_id) AS num_movies, AVG(cn.imdb_id::NUMERIC) AS average_imdb_id, SUM(CASE WHEN cn.country_code = 'us' THEN 1 ELSE 0 END) AS num_us_companies, COUNT(DISTINCT cn.id) AS num_companies_involved FROM movie_keyword AS mk JOIN movie_info AS mi ON mk.movie_id = mi.movie_id JOIN kind_type AS kt ON mi.info_type_id = kt.id AND kt.id IN ('2', '3', '4', '5', '6') JOIN company_name AS cn ON mk.movie_id = cn.imdb_id WHERE (mk.keyword_id IN ('3195', '2832', '4019', '2965', '3002') OR mi.info IN ('Albanian', 'Norwegian', 'Ladino', 'Filipino', 'Estonian')) AND cn.name_pcode_nf IN ('R5365', 'C514', 'E5314', 'L532') AND cn.id IN ('23278', '44380', '28077', '6858', '43412', '27250') GROUP BY kt.kind;
SELECT cn.country_code, COUNT(DISTINCT mc.movie_id) AS number_of_movies, AVG(m_link.link_type_id) AS average_link_type_id, SUM(CASE WHEN n.gender = 'M' THEN 1 ELSE 0 END) AS male_actors_count, SUM(CASE WHEN n.gender = 'F' THEN 1 ELSE 0 END) AS female_actors_count FROM company_name cn JOIN movie_companies mc ON cn.id = mc.company_id JOIN movie_link m_link ON mc.movie_id = m_link.movie_id JOIN name n ON n.name_pcode_nf IN ('A6354', 'D1345') WHERE mc.company_type_id = 1 GROUP BY cn.country_code HAVING COUNT(DISTINCT mc.movie_id) > 10 ORDER BY number_of_movies DESC;
SELECT cct.kind AS cast_type, ct.kind AS company_kind, COUNT(DISTINCT k.id) AS keyword_count, AVG(LENGTH(k.keyword)) AS average_keyword_length, COUNT(DISTINCT lt.id) AS link_type_count FROM comp_cast_type cct JOIN company_type ct ON cct.id = ct.id LEFT JOIN keyword k ON SUBSTRING(k.phonetic_code, 1, 1) = 'A' LEFT JOIN link_type lt ON LENGTH(lt.link) > 10 GROUP BY cct.kind, ct.kind ORDER BY keyword_count DESC, average_keyword_length DESC;
