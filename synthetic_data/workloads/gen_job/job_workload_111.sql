SELECT ct.kind AS company_kind, AVG(mi_idx.info::numeric) AS average_rating, COUNT(DISTINCT mc.movie_id) AS number_of_movies, COUNT(DISTINCT c.id) AS number_of_casts, SUM(CASE WHEN mc.note IS NOT NULL THEN 1 ELSE 0 END) AS noted_movie_companies FROM company_type ct JOIN movie_companies mc ON ct.id = mc.company_type_id JOIN movie_info_idx mi_idx ON mc.movie_id = mi_idx.movie_id AND mi_idx.info_type_id = 101 JOIN complete_cast c ON mc.movie_id = c.movie_id WHERE ct.kind IN ('production companies', 'distributors') AND mi_idx.movie_id IN ('30178', '12242', '20540', '27059', '12152', '12149') AND mi_idx.info::numeric >= 1 AND mi_idx.info::numeric <= 10 GROUP BY ct.kind;
SELECT cc.kind AS company_cast_type, COUNT(DISTINCT mc.movie_id) AS number_of_movies, COUNT(DISTINCT cn.id) AS number_of_companies, AVG(name.length) AS average_name_length FROM movie_companies AS mc JOIN comp_cast_type AS cc ON mc.company_type_id = cc.id JOIN company_name AS cn ON mc.company_id = cn.id JOIN (SELECT id, CHAR_LENGTH(name) AS length FROM name WHERE gender = 'm') AS name ON name.id = mc.movie_id WHERE mc.movie_id IN ('18930', '11158', '28073', '9831', '18529', '30177') AND cc.kind IN ('complete', 'crew', 'cast') GROUP BY cc.kind;
SELECT at.title AS alternate_title, COUNT(DISTINCT an.id) AS number_of_alternate_names, AVG(CAST(cc.status_id AS DECIMAL)) AS average_status_id, SUM(CASE WHEN n.gender = 'm' THEN 1 ELSE 0 END) AS male_count, SUM(CASE WHEN n.gender <> 'm' THEN 1 ELSE 0 END) AS female_count, COUNT(DISTINCT cc.id) AS complete_cast_count, MIN(at.production_year) AS earliest_production_year, MAX(at.production_year) AS latest_production_year FROM aka_title at JOIN aka_name an ON at.movie_id = an.person_id JOIN complete_cast cc ON at.movie_id = cc.movie_id JOIN name n ON an.person_id = n.id WHERE cc.subject_id = 1 AND cc.status_id IN (3, 4) AND n.gender = 'm' AND n.imdb_index IN ('V', 'VI', 'II') AND an.md5sum = 'f20a817147ce1df99c8e3b5614dbee2f' AND at.season_nr IN (28, 2, 5, 14, 37, 9) AND at.movie_id IN (1701837, 1248358, 1697981, 1674394, 1633043) GROUP BY at.title;
SELECT kt.kind AS movie_kind, COUNT(distinct t.id) AS number_of_movies, AVG(t.production_year) AS average_production_year, SUM(CASE WHEN cct.kind = 'complete+verified' THEN 1 ELSE 0 END) AS total_complete_verified, SUM(CASE WHEN cct.kind = 'crew' THEN 1 ELSE 0 END) AS total_crew, SUM(CASE WHEN cct.kind = 'cast' THEN 1 ELSE 0 END) AS total_cast, COUNT(distinct mk.keyword_id) AS number_of_keywords FROM title t JOIN kind_type kt ON t.kind_id = kt.id LEFT JOIN comp_cast_type cct ON t.id = cct.id LEFT JOIN movie_keyword mk ON t.id = mk.movie_id WHERE kt.id IN (2, 6) AND kt.kind = 'video movie' AND cct.kind IN ('complete+verified', 'crew', 'cast') AND cct.id IN (2, 1, 4, 3) GROUP BY kt.kind ORDER BY number_of_movies DESC;
SELECT at.production_year, ct.kind AS cast_type, COUNT(DISTINCT at.id) AS number_of_titles, COUNT(DISTINCT at.movie_id) AS number_of_movies, COUNT(DISTINCT ml.movie_id) AS movies_with_links, COUNT(DISTINCT ml.linked_movie_id) AS linked_movies, AVG(at.season_nr) AS average_season_number, SUM(at.episode_nr) AS total_episode_count FROM aka_title AS at JOIN comp_cast_type AS ct ON at.kind_id = ct.id LEFT JOIN movie_link AS ml ON at.movie_id = ml.movie_id WHERE at.production_year > 2000 AND ml.link_type_id IN ('10', '2', '4') AND ct.kind IN ('complete+verified', 'cast', 'crew', 'complete') GROUP BY at.production_year, ct.kind ORDER BY at.production_year DESC, number_of_titles DESC;
SELECT kt.kind AS movie_type, AVG(mi_idx.info::numeric) AS average_rating, COUNT(DISTINCT mk.movie_id) AS movie_count, COUNT(DISTINCT cn.id) AS company_count, COUNT(DISTINCT n.id) AS actor_count FROM movie_info mi JOIN kind_type kt ON mi.movie_id = kt.id JOIN movie_info_idx mi_idx ON mi.movie_id = mi_idx.movie_id JOIN movie_keyword mk ON mi.movie_id = mk.movie_id JOIN company_name cn ON mi.movie_id = cn.imdb_id JOIN cast_info ci ON ci.movie_id = mi.movie_id JOIN name n ON ci.person_id = n.id WHERE kt.id IN ('7', '1', '4') AND cn.name_pcode_sf IN ('F2365', 'Z3132', 'Y6253', 'F4231') AND mk.keyword_id IN ('3887', '4275', '3550', '4202') AND mi_idx.info_type_id = (SELECT id FROM info_type WHERE info = 'rating') AND ci.role_id = (SELECT id FROM role_type WHERE role = 'actor') GROUP BY kt.kind;
SELECT AVG(mi_idx.info::numeric) AS average_rating, COUNT(DISTINCT k.id) AS total_unique_keywords, COUNT(DISTINCT n.id) AS total_unique_writers, SUM(CASE WHEN cn.surname_pcode = 'M1236' THEN 1 ELSE 0 END) AS count_of_m1236_surname_writers FROM keyword AS k LEFT JOIN movie_keyword AS mk ON k.id = mk.keyword_id LEFT JOIN movie_info_idx AS mi_idx ON mk.movie_id = mi_idx.movie_id AND mi_idx.info_type_id = 101 LEFT JOIN cast_info AS ci ON mk.movie_id = ci.movie_id LEFT JOIN char_name AS cn ON ci.person_id = cn.id AND ci.role_id = 2 LEFT JOIN name AS n ON ci.person_id = n.id AND n.gender = 'm' WHERE k.keyword IN ('airforce-one', 'mexican-revolutionary', 'full-house', 'gay-hollywood', 'overactive-imagination') AND cn.surname_pcode IN ('M1236', 'H3245', 'Z12', 'F236') AND ci.role_id IN (SELECT id FROM comp_cast_type WHERE kind = 'writer') GROUP BY ci.movie_id;
SELECT COUNT(DISTINCT t.id) AS total_movies, AVG(t.production_year) AS average_production_year, MAX(t.production_year) AS latest_production_year, MIN(t.production_year) AS oldest_production_year, COUNT(DISTINCT k.keyword_id) AS unique_keywords, COUNT(DISTINCT cn.id) AS total_companies_involved, COUNT(DISTINCT at.id) AS total_alternate_titles FROM title AS t JOIN movie_keyword AS k ON t.id = k.movie_id JOIN company_name AS cn ON cn.id = t.id LEFT JOIN aka_title AS at ON t.id = at.movie_id WHERE t.production_year >= 2000 AND t.production_year <= 2010 GROUP BY t.kind_id HAVING COUNT(DISTINCT cn.country_code) > 1;
SELECT cn.name AS company_name, COUNT(DISTINCT at.title) AS total_titles, AVG(at.production_year) AS average_production_year, COUNT(DISTINCT mk.keyword_id) AS unique_keywords, AVG(LENGTH(at.title)) AS average_title_length FROM company_name cn LEFT JOIN aka_title at ON cn.id = at.movie_id LEFT JOIN movie_keyword mk ON at.movie_id = mk.movie_id WHERE cn.country_code = 'US' GROUP BY cn.name ORDER BY total_titles DESC;
SELECT rt.role AS role_type, AVG(at.production_year) AS avg_production_year, COUNT(DISTINCT ci.movie_id) AS total_movies_with_writers, COUNT(DISTINCT ci.person_id) AS total_different_writers, SUM(CASE WHEN at.title ILIKE 'The %' THEN 1 ELSE 0 END) AS movies_beginning_with_the FROM cast_info ci INNER JOIN role_type rt ON ci.role_id = rt.id AND rt.role = 'writer' LEFT JOIN aka_title at ON ci.movie_id = at.movie_id WHERE at.kind_id = 1 AND rt.id = 11 GROUP BY rt.role;
SELECT kt.kind, AVG(t.production_year) AS avg_production_year, COUNT(DISTINCT t.id) AS number_of_titles, COUNT(DISTINCT mc.company_id) AS number_of_companies, COUNT(DISTINCT ml.linked_movie_id) AS number_of_linked_movies FROM title AS t JOIN kind_type AS kt ON t.kind_id = kt.id LEFT JOIN movie_companies AS mc ON t.id = mc.movie_id LEFT JOIN movie_link AS ml ON t.id = ml.movie_id WHERE kt.kind IN ('tv series', 'episode', 'tv mini series') AND mc.company_type_id = '1' AND t.production_year BETWEEN 2005 AND 2015 GROUP BY kt.kind;
SELECT kt.kind AS movie_kind, AVG(CASE WHEN rt.ROLE = 'director' THEN 1 ELSE 0 END) AS avg_director_presence, COUNT(DISTINCT ml.movie_id) AS num_movies_linked, MAX(t.production_year) AS latest_production_year, MIN(t.production_year) AS earliest_production_year, SUM(CASE WHEN mi.info_type_id = 2 AND mi.info = 'color' THEN 1 ELSE 0 END) AS total_color_movies, COUNT(DISTINCT t.id) AS total_movies FROM title t LEFT JOIN kind_type kt ON t.kind_id = kt.id LEFT JOIN movie_link ml ON t.id = ml.movie_id LEFT JOIN movie_info mi ON t.id = mi.movie_id LEFT JOIN role_type rt ON mi.info_type_id = rt.id WHERE t.production_year BETWEEN 1990 AND 2020 AND kt.kind IN ('movie', 'tv series', 'video game') AND (ml.link_type_id IN (5, 12, 16) OR ml.link_type_id IS NULL) AND (ml.linked_movie_id IN (1639371, 2307098) OR ml.linked_movie_id IS NULL) AND rt.ROLE IN ('director', 'actor', 'producer') GROUP BY kt.kind ORDER BY total_movies DESC;
SELECT ct.kind AS company_kind, COUNT(DISTINCT an.id) AS number_of_aka_names, AVG(cn.imdb_id) AS average_char_imdb_id, SUM(CASE WHEN lt.id IN (5, 7) THEN 1 ELSE 0 END) AS count_link_type_5_or_7 FROM aka_name an JOIN char_name cn ON an.person_id = cn.id JOIN company_type ct ON ct.kind LIKE '%companies' JOIN link_type lt ON lt.id = an.id % 10 WHERE an.person_id = 2704491 AND an.name IN ('Allaudin', 'McKean, Scott', 'Alles, J.') AND cn.id IN ('99259', '3288', '99679', '23104', '45337') AND ct.kind IN ('special effects companies', 'miscellaneous companies', 'production companies', 'distributors') AND lt.id IN (12, 17, 9, 8, 5, 7) GROUP BY ct.kind;
SELECT kt.kind, AVG(mi_idx_nr_count.count) AS average_number_of_facts, SUM(cast_member_count.count) AS total_cast_members, COUNT(DISTINCT ci.movie_id) AS number_of_movies, COUNT(DISTINCT n.id) AS number_of_actors FROM kind_type kt LEFT JOIN ( SELECT movie_id, COUNT(*) AS count FROM movie_info_idx GROUP BY movie_id ) mi_idx_nr_count ON mi_idx_nr_count.movie_id = kt.id LEFT JOIN ( SELECT movie_id, COUNT(*) AS count FROM cast_info GROUP BY movie_id ) cast_member_count ON cast_member_count.movie_id = kt.id LEFT JOIN cast_info ci ON ci.movie_id = kt.id LEFT JOIN name n ON n.id = ci.person_id WHERE kt.kind IN ('tv series', 'video game', 'episode', 'tv mini series', 'video movie') AND ci.nr_order IN (41, 43, 49, 3) GROUP BY kt.kind ORDER BY average_number_of_facts DESC;
SELECT cn.name AS company_name, COUNT(DISTINCT mi_idx.movie_id) AS number_of_movies, AVG(CAST(mi_idx.info AS NUMERIC)) AS average_runtime, SUM(CASE WHEN it.info = 'locations' THEN 1 ELSE 0 END) AS total_locations, COUNT(DISTINCT mk.keyword_id) AS unique_keywords, COUNT(DISTINCT cc.movie_id) AS complete_cast_movies FROM movie_info_idx AS mi_idx JOIN info_type AS it ON mi_idx.info_type_id = it.id JOIN movie_keyword AS mk ON mi_idx.movie_id = mk.movie_id JOIN complete_cast AS cc ON mi_idx.movie_id = cc.movie_id JOIN company_name AS cn ON cn.imdb_id = mi_idx.movie_id WHERE it.info IN ('runtimes', 'locations') AND cn.name_pcode_nf = 'G2642' GROUP BY cn.name ORDER BY average_runtime DESC, number_of_movies DESC;
SELECT CT.kind AS company_kind, AVG(CAST(MI.info AS FLOAT)) AS average_rating, COUNT(DISTINCT CI.person_id) AS total_cast_members, COUNT(DISTINCT MC.movie_id) AS number_of_movies FROM movie_companies AS MC JOIN company_type AS CT ON MC.company_type_id = CT.id JOIN movie_info AS MI ON MC.movie_id = MI.movie_id AND MI.info_type_id = 101 JOIN cast_info AS CI ON MC.movie_id = CI.movie_id WHERE (MC.note LIKE '%(TV)' OR MC.note IS NULL) AND CT.kind IN ('special effects companies', 'miscellaneous companies', 'production companies', 'distributors') AND CI.role_id = 1 GROUP BY CT.kind ORDER BY average_rating DESC;
SELECT AVG(CAST(mi_idx.info AS numeric)) AS average_rating, COUNT(DISTINCT t.id) AS total_movies, COUNT(DISTINCT mc.company_id) AS total_companies_involved, SUM(CASE WHEN t.production_year > 2000 THEN 1 ELSE 0 END) AS movies_after_2000 FROM title AS t JOIN movie_info_idx AS mi_idx ON t.id = mi_idx.movie_id JOIN movie_companies AS mc ON t.id = mc.movie_id JOIN company_name AS cn ON mc.company_id = cn.id JOIN company_type AS ct ON mc.company_type_id = ct.id JOIN info_type AS it ON mi_idx.info_type_id = it.id WHERE it.info = 'rating' AND cn.country_code IS NOT NULL AND ct.kind <> 'production companies' AND t.kind_id NOT IN (SELECT id FROM comp_cast_type WHERE kind = 'tv series') GROUP BY cn.country_code, ct.kind ORDER BY average_rating DESC, total_movies DESC;
SELECT rt.ROLE AS role_type, COUNT(DISTINCT n.id) AS total_actors, AVG(nk.keyword_count) AS average_keywords_per_actor, SUM(nk.keyword_count) AS total_keywords FROM name AS n INNER JOIN ( SELECT mk.movie_id, COUNT(*) AS keyword_count FROM movie_keyword AS mk INNER JOIN keyword AS k ON mk.keyword_id = k.id WHERE k.phonetic_code IN ('H525', 'C4252', 'P3624', 'A543', 'F6526', 'M1525') GROUP BY mk.movie_id ) AS nk ON nk.movie_id = n.id INNER JOIN role_type AS rt ON rt.id IN ('1', '2', '6', '10', '5', '4') INNER JOIN movie_companies AS mc ON mc.movie_id = nk.movie_id WHERE n.gender IS NOT NULL GROUP BY rt.ROLE ORDER BY total_actors DESC;
SELECT cn.name AS company_name, cn.country_code, COUNT(DISTINCT mc.movie_id) AS total_movies_produced, AVG(cn.imdb_id) AS average_movie_imdb_id, COUNT(DISTINCT k.id) AS total_unique_keywords FROM movie_companies mc JOIN company_name cn ON mc.company_id = cn.id JOIN kind_type kt ON mc.company_type_id = kt.id JOIN movie_info_idx mi ON mc.movie_id = mi.movie_id LEFT JOIN keyword k ON mi.info = k.keyword WHERE kt.id IN ('5', '2', '4', '1', '7') AND mc.note IN ('(2001-) (USA) (TV)', '(????) (Czech Republic) (TV)') AND mi.movie_id IN ('19232', '19598', '10553', '12245') GROUP BY cn.name, cn.country_code ORDER BY total_movies_produced DESC;
SELECT ct.kind AS company_type, COUNT(DISTINCT cn.id) AS number_of_companies, COUNT(DISTINCT ci.person_id) AS number_of_actors, AVG(ci.nr_order) AS average_cast_order, SUM(CASE WHEN t.production_year > 2000 THEN 1 ELSE 0 END) AS films_after_2000, MAX(t.production_year) AS latest_production_year FROM company_name cn JOIN company_type ct ON cn.id = ct.id JOIN cast_info ci ON ci.movie_id = cn.id JOIN title t ON ci.movie_id = t.id GROUP BY ct.kind ORDER BY number_of_companies DESC;
SELECT kt.kind AS movie_kind, AVG(title.production_year) AS average_production_year, COUNT(DISTINCT cast_info.person_id) AS number_of_actors, COUNT(DISTINCT company_name.id) AS number_of_companies, SUM(case when cast_info.role_id = 1 then 1 else 0 end) AS number_of_lead_roles, MAX(movie_info.info) AS longest_movie_info FROM title JOIN kind_type AS kt ON title.kind_id = kt.id JOIN cast_info ON title.id = cast_info.movie_id JOIN movie_companies ON title.id = movie_companies.movie_id JOIN company_name ON movie_companies.company_id = company_name.id JOIN movie_info ON title.id = movie_info.movie_id WHERE title.production_year >= 2000 AND cast_info.role_id = 1 AND movie_companies.company_type_id IN (SELECT id FROM company_name WHERE country_code = 'US') GROUP BY kt.kind ORDER BY average_production_year DESC, number_of_actors DESC;
SELECT kt.kind, COUNT(DISTINCT cc.movie_id) AS total_movies, COUNT(DISTINCT mk.keyword_id) AS total_unique_keywords, SUM(CASE WHEN mk.keyword_id = 1849 THEN 1 ELSE 0 END) AS keyword_1849_count, SUM(CASE WHEN mk.keyword_id = 830 THEN 1 ELSE 0 END) AS keyword_830_count, SUM(CASE WHEN mk.keyword_id = 3752 THEN 1 ELSE 0 END) AS keyword_3752_count, AVG(cc.status_id) AS average_status_id FROM complete_cast AS cc JOIN movie_keyword AS mk ON cc.movie_id = mk.movie_id JOIN kind_type AS kt ON cc.subject_id = kt.id WHERE kt.kind IN ('video movie', 'tv series', 'video game') GROUP BY kt.kind;
