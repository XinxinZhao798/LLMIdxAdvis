SELECT s_state, s_city, COUNT(DISTINCT s_store_sk) AS num_stores, SUM(inv_quantity_on_hand) AS total_inventory, AVG(cd_purchase_estimate) AS avg_purchase_estimate, COUNT(DISTINCT wp_web_page_sk) AS num_web_pages, SUM(wp_link_count) AS total_link_count, COUNT(CASE WHEN cd_credit_rating = 'High Risk' THEN 1 END) AS high_risk_customers, COUNT(CASE WHEN cd_credit_rating = 'Low Risk' THEN 1 END) AS low_risk_customers, AVG(cd_dep_count) AS avg_dep_count, SUM(cd_dep_employed_count) AS total_dep_employed_count, AVG(s_number_employees) AS avg_store_employees, AVG(s_floor_space) AS avg_store_floor_space FROM store LEFT JOIN inventory ON s_store_sk = inv_warehouse_sk LEFT JOIN customer_demographics ON s_market_id = cd_demo_sk LEFT JOIN web_page ON s_store_sk = wp_customer_sk WHERE s_rec_end_date IS NULL AND wp_char_count IN (1147, 1711, 6577) AND inv_quantity_on_hand IN (505, 375, 593, 141, 402, 949) AND s_suite_number IN ('Suite D', 'Suite 80', 'Suite 190', 'Suite 100') AND s_division_name = 'Unknown' AND cd_dep_employed_count = 0 AND cd_credit_rating IN ('High Risk', 'Low Risk', 'Good', 'Unknown') GROUP BY s_state, s_city ORDER BY s_state, s_city;
SELECT p.p_promo_name, p.p_purpose, p.p_discount_active, SUM(ss.ss_quantity) as total_store_sales_quantity, AVG(ss.ss_sales_price) as avg_store_sales_price, SUM(ws.ws_quantity) as total_web_sales_quantity, AVG(ws.ws_sales_price) as avg_web_sales_price, (SUM(ss.ss_net_paid) + SUM(ws.ws_net_paid)) as total_net_paid, (SUM(ss.ss_net_paid_inc_tax) + SUM(ws.ws_net_paid_inc_tax)) as total_net_paid_inc_tax, (SUM(ss.ss_net_profit) + SUM(ws.ws_net_profit)) as total_net_profit FROM promotion p LEFT JOIN store_sales ss ON p.p_promo_sk = ss.ss_promo_sk LEFT JOIN web_sales ws ON p.p_promo_sk = ws.ws_promo_sk WHERE p.p_channel_tv = 'N' AND p.p_purpose <> 'Unknown' GROUP BY p.p_promo_name, p.p_purpose, p.p_discount_active ORDER BY total_net_profit DESC, total_net_paid DESC, avg_store_sales_price DESC, avg_web_sales_price DESC;
SELECT i.i_category, SUM(ss.ss_ext_sales_price) AS total_sales, AVG(i.i_wholesale_cost) AS avg_wholesale_cost, COUNT(DISTINCT ss.ss_item_sk) AS unique_items_sold, COUNT(ss.ss_ticket_number) AS total_transactions FROM store_sales ss JOIN item i ON ss.ss_item_sk = i.i_item_sk JOIN store s ON ss.ss_store_sk = s.s_store_sk WHERE s.s_tax_precentage BETWEEN 0.03 AND 0.11 AND i.i_current_price BETWEEN 30 AND 90 GROUP BY i.i_category ORDER BY total_sales DESC, i.i_category;
SELECT i.i_category, cd.cd_education_status, cd.cd_marital_status, COUNT(DISTINCT i.i_item_sk) AS item_count, AVG(i.i_current_price) AS avg_current_price, AVG(i.i_wholesale_cost) AS avg_wholesale_cost FROM item i JOIN customer_demographics cd ON cd.cd_demo_sk = i.i_manager_id JOIN household_demographics hd ON hd.hd_demo_sk = i.i_manager_id WHERE i.i_rec_start_date <= CURRENT_DATE AND (i.i_rec_end_date IS NULL OR i.i_rec_end_date > CURRENT_DATE) AND cd.cd_gender IN ('M', 'F') AND cd.cd_marital_status IN ('D', 'U', 'S', 'M', 'W') GROUP BY i.i_category, cd.cd_education_status, cd.cd_marital_status ORDER BY i.i_category, cd.cd_education_status, cd.cd_marital_status;
SELECT c.cp_catalog_page_id, i.i_category, AVG(i.i_current_price) AS avg_current_price, SUM(sr.sr_return_amt) AS total_return_amount, COUNT(DISTINCT sr.sr_customer_sk) AS unique_customers_returning, SUM(wr.wr_return_amt_inc_tax) AS total_web_return_amount_inc_tax, AVG(wr.wr_return_ship_cost) AS avg_web_return_shipping_cost FROM catalog_page AS c JOIN item AS i ON c.cp_catalog_page_sk = i.i_item_sk LEFT JOIN store_returns AS sr ON i.i_item_sk = sr.sr_item_sk LEFT JOIN web_returns AS wr ON i.i_item_sk = wr.wr_item_sk WHERE c.cp_catalog_page_id IN ('AAAAAAAANDFAAAAA', 'AAAAAAAAJNJAAAAA', 'AAAAAAAALHEAAAAA') AND i.i_container = 'Unknown' AND sr.sr_customer_sk IN ('61916', '43478', '92201', '83008') AND sr.sr_item_sk IN ('1729', '3840', '8482') AND wr.wr_return_amt_inc_tax IN ('1793.82', '1539.82', '362.24', '311.63', '176.62', '164.88') AND wr.wr_return_ship_cost IN ('78.85', '1576.94', '590.04') GROUP BY c.cp_catalog_page_id, i.i_category ORDER BY total_return_amount DESC, total_web_return_amount_inc_tax DESC;
SELECT ws.web_site_id, ws.web_name, c.c_birth_country, SUM(wsl.ws_sales_price) AS total_sales, AVG(wsl.ws_sales_price) AS average_sales, COUNT(DISTINCT wsl.ws_order_number) AS total_orders, COUNT(DISTINCT wsl.ws_item_sk) AS total_items_sold, s.s_store_name, s.s_market_manager FROM web_sales wsl JOIN web_site ws ON wsl.ws_web_site_sk = ws.web_site_sk JOIN customer c ON wsl.ws_bill_customer_sk = c.c_customer_sk JOIN store s ON s.s_market_id = ws.web_mkt_id WHERE (s.s_store_name LIKE '%ought%' OR s.s_store_name LIKE '%ation%' OR s.s_store_name LIKE '%anti%') AND s.s_market_manager = 'Charles Bartley' AND ws.web_suite_number IN ('Suite 150', 'Suite 260', 'Suite 350', 'Suite 450', 'Suite 280', 'Suite 470') AND c.c_first_sales_date_sk = '2451321' GROUP BY ws.web_site_id, ws.web_name, c.c_birth_country, s.s_store_name, s.s_market_manager ORDER BY total_sales DESC, average_sales DESC;
SELECT ws_site.web_market_manager, SUM(ws.ws_sales_price) AS total_sales, AVG(ws.ws_sales_price) AS average_sales, COUNT(ws.ws_order_number) AS number_of_orders, COUNT(DISTINCT ws.ws_item_sk) AS number_of_items_sold, SUM(sr.sr_return_amt) AS total_returns, AVG(sr.sr_return_amt) AS average_return_amount, COUNT(DISTINCT sr.sr_ticket_number) AS number_of_returns FROM web_sales ws JOIN web_site ws_site ON ws.ws_web_site_sk = ws_site.web_site_sk LEFT JOIN store_returns sr ON ws.ws_bill_customer_sk = sr.sr_customer_sk AND ws.ws_item_sk = sr.sr_item_sk WHERE ws_site.web_open_date_sk IN (2450594, 2450798, 2450747, 2450577, 2450807, 2450645) GROUP BY ws_site.web_market_manager ORDER BY total_sales DESC;
SELECT cd.cd_gender, cd.cd_marital_status, s.s_state, COUNT(wr.wr_order_number) AS total_returns, SUM(wr.wr_return_amt_inc_tax) AS total_return_amount, AVG(wr.wr_return_amt_inc_tax) AS average_return_amount, AVG(wr.wr_fee) AS average_fee FROM web_returns wr JOIN customer_demographics cd ON wr.wr_returning_cdemo_sk = cd.cd_demo_sk JOIN store s ON wr.wr_returning_addr_sk = s.s_store_sk WHERE wr.wr_returning_addr_sk IN (38908, 38512, 43731, 22184, 44035) AND wr.wr_refunded_hdemo_sk IN (3650, 1143, 1326, 7105) AND s.s_state = 'CA' GROUP BY cd.cd_gender, cd.cd_marital_status, s.s_state ORDER BY total_return_amount DESC, total_returns DESC;
