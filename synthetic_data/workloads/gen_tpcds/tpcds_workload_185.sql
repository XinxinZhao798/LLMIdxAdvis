SELECT s.s_store_name, s.s_city, s.s_state, s_market_desc, AVG(s.s_number_employees) AS average_employees, AVG(s.s_floor_space) AS average_floor_space, COUNT(DISTINCT s.s_store_sk) AS total_stores, SUM(wp.wp_char_count) AS total_char_count, SUM(wp.wp_link_count) AS total_link_count, SUM(wp.wp_image_count) AS total_image_count, COUNT(DISTINCT wp.wp_web_page_sk) AS total_web_pages, AVG(ib.ib_upper_bound - ib.ib_lower_bound) AS average_income_band_range FROM store s JOIN web_page wp ON s.s_store_sk = wp.wp_customer_sk LEFT JOIN income_band ib ON s.s_market_id = ib.ib_income_band_sk WHERE s.s_rec_start_date <= CURRENT_DATE AND (s.s_rec_end_date IS NULL OR s.s_rec_end_date > CURRENT_DATE) AND (wp.wp_web_page_sk = 33 OR wp.wp_web_page_sk = 6) GROUP BY s.s_store_name, s.s_city, s.s_state, s_market_desc ORDER BY s.s_state, s.s_city, s.s_store_name;
SELECT d_year, d_quarter_name, ca_state, SUM(ws_net_profit) AS total_net_profit, AVG(sr_return_amt_inc_tax) AS avg_return_amount_inc_tax, COUNT(DISTINCT ws_order_number) AS total_orders, COUNT(DISTINCT sr_ticket_number) AS total_returns FROM web_sales JOIN date_dim ON ws_sold_date_sk = d_date_sk JOIN customer_address ON ws_ship_addr_sk = ca_address_sk JOIN store_returns ON ws_order_number = sr_ticket_number AND ws_item_sk = sr_item_sk AND ws_bill_customer_sk = sr_customer_sk WHERE d_year = 2001 AND ca_state IN ('CA', 'NY', 'TX') AND ws_ship_mode_sk IN (15, 9, 19) AND ws_net_profit > 0 AND ws_ship_customer_sk IN (91411, 13153, 53110, 78552, 62671) AND sr_return_amt_inc_tax IN (211.69, 1118.88) AND sr_customer_sk IN (30509, 42705, 90022, 87597) GROUP BY d_year, d_quarter_name, ca_state ORDER BY total_net_profit DESC, avg_return_amount_inc_tax DESC;
SELECT c.c_salutation, cd.cd_gender, cd.cd_education_status, cd.cd_credit_rating, COUNT(*) AS total_customers, SUM(ws.ws_quantity) AS total_quantity_sold, AVG(ws.ws_sales_price) AS average_sales_price, SUM(ws.ws_net_paid) AS total_net_paid, SUM(ws.ws_net_profit) AS total_net_profit, COUNT(DISTINCT ws.ws_promo_sk) AS number_of_promotions_used FROM customer c JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk JOIN web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk JOIN promotion p ON ws.ws_promo_sk = p.p_promo_sk WHERE c.c_salutation IN ('Sir', 'Miss', 'Mrs.', 'Ms.') AND cd.cd_demo_sk IN ('17361', '17821', '17056', '18235') AND ws.ws_list_price = '160.03' AND ws.ws_ship_cdemo_sk IN ('887064', '1910407', '1755166', '369305', '1188209') GROUP BY c.c_salutation, cd.cd_gender, cd.cd_education_status, cd.cd_credit_rating ORDER BY total_net_profit DESC, total_customers DESC, average_sales_price DESC;
SELECT dd.d_year, dd.d_quarter_name, ca.ca_state, COUNT(DISTINCT ws.ws_order_number) AS total_orders, SUM(ws.ws_quantity) AS total_quantity, SUM(ws.ws_net_paid) AS total_net_paid, AVG(ws.ws_sales_price) AS average_sales_price, SUM(ws.ws_net_profit) AS total_net_profit FROM web_sales ws JOIN date_dim dd ON ws.ws_sold_date_sk = dd.d_date_sk JOIN customer_address ca ON ws.ws_bill_addr_sk = ca.ca_address_sk WHERE dd.d_year = 2002 AND ca.ca_country = 'United States' AND ws.ws_net_paid_inc_ship_tax > 1000 GROUP BY dd.d_year, dd.d_quarter_name, ca.ca_state ORDER BY dd.d_year, dd.d_quarter_name, ca.ca_state;
SELECT dd.d_year, dd.d_quarter_name, i.i_category, i.i_brand, COUNT(DISTINCT ws.web_site_sk) AS number_of_websites, COUNT(DISTINCT wp.wp_web_page_sk) AS number_of_web_pages, COUNT(DISTINCT wr.wr_order_number) AS number_of_returns, SUM(wr.wr_return_amt) AS total_return_amount, AVG(wr.wr_return_quantity) AS avg_return_quantity, AVG(wr.wr_fee) AS avg_return_fee, hd.hd_dep_count, ib.ib_lower_bound AS income_band_lower_bound, ib.ib_upper_bound AS income_band_upper_bound, SUM(hd.hd_vehicle_count) AS total_vehicles FROM web_returns wr JOIN date_dim dd ON wr.wr_returned_date_sk = dd.d_date_sk JOIN web_page wp ON wr.wr_web_page_sk = wp.wp_web_page_sk JOIN item i ON wr.wr_item_sk = i.i_item_sk JOIN web_site ws ON wp.wp_web_page_sk = ws.web_site_sk JOIN household_demographics hd ON wr.wr_returning_hdemo_sk = hd.hd_demo_sk JOIN income_band ib ON hd.hd_income_band_sk = ib.ib_income_band_sk WHERE dd.d_year = 2001 AND i.i_category_id IN (1, 2, 3) AND wr.wr_return_tax > 100 AND hd.hd_income_band_sk = 10 AND wr.wr_refunded_cash BETWEEN 300 AND 4000 GROUP BY dd.d_year, dd.d_quarter_name, i.i_category, i.i_brand, hd.hd_dep_count, ib.ib_lower_bound, ib.ib_upper_bound ORDER BY total_return_amount DESC, avg_return_quantity DESC, avg_return_fee DESC, number_of_websites, number_of_web_pages;
SELECT i.i_category AS item_category, c.c_birth_month AS customer_birth_month, w.web_zip AS web_site_zip, COUNT(DISTINCT ws.ws_order_number) AS total_orders, SUM(ws.ws_net_paid) AS total_revenue, AVG(ws.ws_ext_discount_amt) AS average_discount, AVG(ws.ws_net_profit) AS average_profit FROM web_sales ws JOIN item i ON ws.ws_item_sk = i.i_item_sk JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk WHERE ws.ws_sold_date_sk BETWEEN 2450815 AND 2450915 AND i.i_item_sk IN (10310, 10207, 12818, 10796) AND w.web_zip IN ('35709', '31904') AND c.c_birth_month IN (3, 5) GROUP BY item_category, customer_birth_month, web_site_zip ORDER BY item_category, customer_birth_month, web_site_zip;
SELECT r.r_reason_desc AS reason_for_return, COUNT(*) AS total_returns, AVG(cr.cr_return_amount) AS avg_return_amount, SUM(cr.cr_return_amount) AS total_return_amount, cd.cd_gender AS customer_gender, cd.cd_education_status AS customer_education, w.w_warehouse_name AS warehouse_name, w.w_city AS warehouse_city, w.w_state AS warehouse_state FROM catalog_returns cr JOIN reason r ON cr.cr_reason_sk = r.r_reason_sk JOIN customer_demographics cd ON cr.cr_returning_cdemo_sk = cd.cd_demo_sk JOIN warehouse w ON cr.cr_warehouse_sk = w.w_warehouse_sk GROUP BY r.r_reason_desc, cd.cd_gender, cd.cd_education_status, w.w_warehouse_name, w.w_city, w.w_state ORDER BY total_returns DESC, total_return_amount DESC LIMIT 100;
SELECT r.r_reason_desc, sm.sm_type AS shipping_type, COUNT(DISTINCT cr.cr_order_number) AS total_returns, SUM(cr.cr_return_quantity) AS total_returned_qty, AVG(cr.cr_return_amount) AS avg_return_amount, SUM(cr.cr_return_amt_inc_tax) AS total_return_inc_tax, SUM(cr.cr_fee) AS total_fees, SUM(cr.cr_net_loss) AS total_net_loss, COUNT(DISTINCT s.s_store_sk) AS num_stores_with_returns, AVG(s.s_number_employees) AS avg_store_employees, AVG(s.s_floor_space) AS avg_store_floor_space, SUM(sr.sr_return_amt) AS total_store_return_amt, SUM(sr.sr_return_amt_inc_tax) AS total_store_return_inc_tax FROM catalog_returns cr JOIN reason r ON cr.cr_reason_sk = r.r_reason_sk JOIN ship_mode sm ON cr.cr_ship_mode_sk = sm.sm_ship_mode_sk LEFT JOIN store_returns sr ON cr.cr_item_sk = sr.sr_item_sk AND cr.cr_order_number = sr.sr_ticket_number LEFT JOIN store s ON sr.sr_store_sk = s.s_store_sk WHERE r.r_reason_desc IN ('Gift exchange', 'duplicate purchase', 'Did not like the make', 'Found a better extended warranty in a store') AND sm.sm_code IN ('SEA', 'BIKE', 'AIR', 'SURFACE') AND (s.s_street_number IN ('337', '255', '175') OR s.s_state = 'TN') GROUP BY r.r_reason_desc, shipping_type ORDER BY total_returns DESC;
SELECT s.s_store_id, s.s_store_name, s.s_city, s.s_state, s.s_country, s.s_tax_precentage, COUNT(DISTINCT inv.inv_item_sk) AS unique_items, SUM(inv.inv_quantity_on_hand) AS total_inventory, AVG(inv.inv_quantity_on_hand) AS avg_inventory, MAX(i.i_current_price) AS max_item_price, MIN(i.i_current_price) AS min_item_price, AVG(i.i_current_price) AS avg_item_price, COUNT(DISTINCT ca.ca_address_sk) AS customer_address_count, SUM(CASE WHEN d.d_weekend = 'Y' THEN 1 ELSE 0 END) AS weekend_days, SUM(CASE WHEN d.d_holiday = 'Y' THEN 1 ELSE 0 END) AS holiday_days FROM store s JOIN inventory inv ON s.s_store_sk = inv.inv_warehouse_sk JOIN item i ON inv.inv_item_sk = i.i_item_sk JOIN date_dim d ON inv.inv_date_sk = d.d_date_sk JOIN customer_address ca ON s.s_zip = ca.ca_zip WHERE s.s_country = 'United States' AND d.d_month_seq IN (68, 76, 131) AND d.d_current_day = 'N' AND d.d_last_dom IN (2419461, 2416174, 2419399) AND d.d_week_seq IN (41, 224, 47) AND inv.inv_warehouse_sk IN (2, 1) AND inv.inv_item_sk IN (6787, 15910, 13876) AND i.i_item_id IN ('AAAAAAAAJEGAAAAA', 'AAAAAAAAOICBAAAA', 'AAAAAAAAKECBAAAA') AND i.i_rec_start_date IN ('2001-10-27', '1999-10-28', '1997-10-27') AND i.i_current_price IN (9.36, 0.92, 7.12) AND i.i_container = 'Unknown' AND ca.ca_street_number IN ('244', '496', '119') AND ca.ca_zip IN ('82293', '14244', '98877') GROUP BY s.s_store_id, s.s_store_name, s.s_city, s.s_state, s.s_country, s.s_tax_precentage ORDER BY s.s_store_name, total_inventory DESC;
SELECT p.p_promo_name, SUM(cs_quantity) AS total_quantity_sold, AVG(cs_sales_price) AS average_sales_price, SUM(cs_net_paid) AS total_net_paid, SUM(cs_net_profit) AS total_net_profit FROM catalog_sales cs JOIN promotion p ON cs.cs_promo_sk = p.p_promo_sk WHERE cs.cs_sold_date_sk IN (SELECT d_date_sk FROM date_dim WHERE d_year = 2003) AND p.p_channel_email = 'Y' AND cs.cs_net_paid > 0 AND cs.cs_net_profit > 0 GROUP BY p.p_promo_name ORDER BY total_net_profit DESC, total_quantity_sold DESC;
SELECT d_year, d_quarter_name, COUNT(DISTINCT cs_order_number) AS total_orders, SUM(cs_quantity) AS total_quantity, AVG(cs_sales_price) AS average_sales_price, SUM(cs_net_profit) AS total_net_profit FROM catalog_sales JOIN date_dim ON catalog_sales.cs_sold_date_sk = date_dim.d_date_sk JOIN customer ON catalog_sales.cs_bill_customer_sk = customer.c_customer_sk JOIN warehouse ON catalog_sales.cs_warehouse_sk = warehouse.w_warehouse_sk WHERE d_year = 2003 AND d_quarter_seq IN (1, 27, 15, 31, 53, 21) AND c_birth_country = 'United States' AND w_country = 'United States' GROUP BY d_year, d_quarter_name ORDER BY d_year, d_quarter_name;
SELECT w.w_city AS warehouse_city, i.i_manufact AS item_manufacturer, i.i_brand AS item_brand, i.i_category AS item_category, COUNT(DISTINCT i.i_item_sk) AS item_count, AVG(i.i_current_price) AS avg_price, SUM(inv.inv_quantity_on_hand) AS total_quantity, AVG(ca.ca_gmt_offset) AS avg_gmt_offset, cd.cd_education_status AS customer_education_status, COUNT(DISTINCT ca.ca_address_sk) AS customer_address_count FROM inventory inv JOIN item i ON inv.inv_item_sk = i.i_item_sk JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk JOIN customer_address ca ON w.w_state = ca.ca_state JOIN customer_demographics cd ON ca.ca_zip = cd.cd_purchase_estimate::character varying WHERE w.w_city = 'Fairview' AND i.i_manufact = 'ableeseeing' AND i.i_brand = 'edu packbrand #7' AND inv.inv_date_sk BETWEEN 100 AND 200 AND ca.ca_county LIKE 'Fairview%' GROUP BY w.w_city, i.i_manufact, i.i_brand, i.i_category, cd.cd_education_status ORDER BY w.w_city, i.i_manufact, i.i_brand, i.i_category, cd.cd_education_status;
SELECT s.s_store_name, s.s_city, s.s_state, SUM(ss.ss_quantity) AS total_quantity_sold, AVG(ss.ss_sales_price) AS average_sales_price, COUNT(DISTINCT ss.ss_ticket_number) AS number_of_sales_transactions, SUM(ss.ss_net_profit) AS total_net_profit FROM store_sales ss JOIN store s ON ss.ss_store_sk = s.s_store_sk JOIN warehouse w ON s.s_zip = w.w_zip JOIN ship_mode sm ON w.w_country = sm.sm_carrier WHERE ss.ss_sold_date_sk BETWEEN 2451189 AND 2451200 AND ss.ss_quantity > 50 GROUP BY s.s_store_name, s.s_city, s.s_state ORDER BY total_net_profit DESC, total_quantity_sold DESC LIMIT 10;
SELECT ca_state, sm_type, COUNT(DISTINCT cs_order_number) AS total_orders, SUM(cs_quantity) AS total_quantity, AVG(cs_sales_price) AS avg_sales_price, SUM(cs_net_profit) AS total_profit FROM catalog_sales JOIN customer_address ON cs_ship_addr_sk = ca_address_sk JOIN ship_mode ON cs_ship_mode_sk = sm_ship_mode_sk JOIN catalog_page ON cs_catalog_page_sk = cp_catalog_page_sk WHERE cp_catalog_page_number IN (73, 12, 56, 26) AND ca_country = 'United States' AND sm_type = 'AIR' GROUP BY ca_state, sm_type ORDER BY total_profit DESC;
SELECT ib.ib_income_band_sk, ib.ib_lower_bound, ib.ib_upper_bound, td.t_am_pm, AVG(ws.ws_sales_price) AS avg_sales_price, SUM(ws.ws_quantity) AS total_sales_quantity, SUM(wr.wr_return_quantity) AS total_return_quantity, SUM(wr.wr_net_loss) AS total_net_loss FROM web_sales ws JOIN household_demographics hd ON ws.ws_bill_hdemo_sk = hd.hd_demo_sk JOIN income_band ib ON hd.hd_income_band_sk = ib.ib_income_band_sk JOIN time_dim td ON ws.ws_sold_time_sk = td.t_time_sk LEFT JOIN web_returns wr ON ws.ws_order_number = wr.wr_order_number AND td.t_time_sk = wr.wr_returned_time_sk WHERE td.t_am_pm = 'AM' GROUP BY ib.ib_income_band_sk, ib.ib_lower_bound, ib.ib_upper_bound, td.t_am_pm ORDER BY ib.ib_income_band_sk, td.t_am_pm;
SELECT dd.d_year, dd.d_quarter_name, ca.ca_state, COUNT(cp.cp_catalog_page_sk) AS num_catalog_pages, AVG(dd.d_dom) AS avg_day_of_month, SUM(CASE WHEN dd.d_holiday = 'Y' THEN 1 ELSE 0 END) AS num_holidays, SUM(CASE WHEN dd.d_weekend = 'Y' THEN 1 ELSE 0 END) AS num_weekend_days FROM date_dim dd JOIN catalog_page cp ON dd.d_date_sk BETWEEN cp.cp_start_date_sk AND cp.cp_end_date_sk JOIN customer_address ca ON ca.ca_zip = SUBSTRING(cp.cp_description FROM 1 FOR 10) WHERE dd.d_year IN (1910, 1912, 1908, 1905) AND dd.d_dow IN ('6', '0', '4', '1') AND ca.ca_country = 'United States' AND dd.d_dom BETWEEN 1 AND 15 GROUP BY dd.d_year, dd.d_quarter_name, ca.ca_state ORDER BY dd.d_year, dd.d_quarter_name, ca.ca_state;
SELECT dd.d_year, dd.d_quarter_name, w.w_state, SUM(inv.inv_quantity_on_hand) AS total_inventory, AVG(inv.inv_quantity_on_hand) AS avg_inventory, COUNT(DISTINCT inv.inv_warehouse_sk) AS number_of_warehouses, COUNT(DISTINCT web.web_site_sk) AS number_of_websites, SUM(cc.cc_employees) AS total_employees, AVG(cc.cc_tax_percentage) AS avg_tax_percentage FROM inventory inv JOIN date_dim dd ON inv.inv_date_sk = dd.d_date_sk JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk JOIN web_site web ON web.web_state = w.w_state JOIN call_center cc ON cc.cc_state = w.w_state WHERE inv.inv_quantity_on_hand IN (232, 844, 624) AND dd.d_year = 2023 AND web.web_open_date_sk <= dd.d_date_sk AND (web.web_close_date_sk IS NULL OR web.web_close_date_sk >= dd.d_date_sk) AND cc.cc_open_date_sk <= dd.d_date_sk AND (cc.cc_closed_date_sk IS NULL OR cc.cc_closed_date_sk >= dd.d_date_sk) GROUP BY dd.d_year, dd.d_quarter_name, w.w_state ORDER BY dd.d_year, dd.d_quarter_name, w.w_state;
SELECT s.s_store_name, s.s_street_name, s.s_street_type, s.s_city, s.s_state, s.s_zip, SUM(sr.sr_return_amt_inc_tax) AS total_store_refunds, AVG(sr.sr_return_amt_inc_tax) AS avg_store_refund, COUNT(sr.sr_return_amt_inc_tax) AS num_store_returns, SUM(wr.wr_return_amt_inc_tax) AS total_web_refunds, AVG(wr.wr_return_amt_inc_tax) AS avg_web_refund, COUNT(wr.wr_return_amt_inc_tax) AS num_web_returns FROM store s LEFT JOIN store_returns sr ON s.s_store_sk = sr.sr_store_sk LEFT JOIN date_dim d_store ON sr.sr_returned_date_sk = d_store.d_date_sk LEFT JOIN web_returns wr ON s.s_store_sk = wr.wr_returning_customer_sk LEFT JOIN date_dim d_web ON wr.wr_returned_date_sk = d_web.d_date_sk WHERE s.s_street_type IN ('Road', 'Circle', 'Court') AND (d_store.d_quarter_name = '1906Q2' OR d_web.d_quarter_name = '1906Q2') GROUP BY s.s_store_name, s.s_street_name, s.s_street_type, s.s_city, s.s_state, s.s_zip ORDER BY total_store_refunds DESC, total_web_refunds DESC;
SELECT s.s_store_name, c.c_first_name, c.c_last_name, COUNT(ss.ss_ticket_number) AS total_sales_transactions, SUM(ss.ss_quantity) AS total_items_sold, AVG(ss.ss_sales_price) AS average_sales_price, SUM(ss.ss_net_paid) AS total_net_paid, SUM(ss.ss_net_paid_inc_tax) AS total_net_paid_inc_tax, SUM(ss.ss_net_profit) AS total_net_profit FROM store_sales ss JOIN store s ON ss.ss_store_sk = s.s_store_sk JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk WHERE s.s_floor_space IN (9026222, 7557959, 9341467, 6995995, 5219562) AND c.c_current_hdemo_sk IN (6755, 780, 352, 3208, 1770) AND c.c_email_address IN ('Joseph.Hilton@io2VIr.org', 'Scott.Goodman@EN4g6ehG4eh1.com', 'Charles.Fink@5cPLD.com', 'Rosa.Nixon@ghkTsItbO5o8hKtVkdI.com') GROUP BY s.s_store_name, c.c_first_name, c.c_last_name ORDER BY total_net_profit DESC, total_net_paid DESC;
SELECT hd.hd_income_band_sk, p.p_channel_details, COUNT(DISTINCT cs.cs_order_number) AS total_orders, SUM(cs.cs_quantity) AS total_quantity, AVG(cs.cs_sales_price) AS average_sales_price, SUM(cs.cs_net_paid) AS total_net_paid, SUM(cs.cs_net_paid_inc_tax) AS total_net_paid_inc_tax, SUM(cs.cs_net_paid_inc_ship) AS total_net_paid_inc_ship, SUM(cs.cs_net_paid_inc_ship_tax) AS total_net_paid_inc_ship_tax, SUM(cs.cs_net_profit) AS total_net_profit FROM catalog_sales cs JOIN household_demographics hd ON cs.cs_bill_hdemo_sk = hd.hd_demo_sk JOIN promotion p ON cs.cs_promo_sk = p.p_promo_sk WHERE hd.hd_income_band_sk IN (12, 6, 4) AND p.p_promo_sk IN (262, 88, 196, 231, 119, 83) AND cs.cs_net_paid IN (499.47, 9920.40) GROUP BY hd.hd_income_band_sk, p.p_channel_details ORDER BY hd.hd_income_band_sk, p.p_channel_details;
SELECT cc.cc_call_center_id, cc.cc_name, cc.cc_city, cc.cc_state, SUM(cr.cr_return_quantity) AS total_catalog_return_quantity, SUM(cr.cr_return_amount) AS total_catalog_return_amt, AVG(cr.cr_return_amount) AS avg_catalog_return_amt, COUNT(cr.cr_return_amount) AS count_catalog_returns, AVG(cc.cc_tax_percentage) AS avg_call_center_tax_percentage, ws.web_site_id, ws.web_name, ws.web_city, ws.web_state, SUM(wr.wr_return_quantity) AS total_web_return_quantity, SUM(wr.wr_return_amt) AS total_web_return_amt, AVG(wr.wr_return_amt) AS avg_web_return_amt, COUNT(wr.wr_return_amt) AS count_web_returns, AVG(ws.web_tax_percentage) AS avg_web_tax_percentage FROM call_center cc LEFT JOIN catalog_returns cr ON cc.cc_call_center_sk = cr.cr_call_center_sk LEFT JOIN web_site ws ON cc.cc_company = ws.web_company_id LEFT JOIN web_returns wr ON ws.web_site_sk = wr.wr_web_page_sk WHERE (cr.cr_returning_hdemo_sk IN (1311, 6200, 1588, 925, 5366, 4174) OR cr.cr_returning_hdemo_sk IS NULL) AND (cr.cr_reason_sk = 16 OR cr.cr_reason_sk IS NULL) AND cc.cc_rec_start_date <= CURRENT_DATE AND (cc.cc_rec_end_date IS NULL OR cc.cc_rec_end_date > CURRENT_DATE) AND ws.web_rec_start_date <= CURRENT_DATE AND (ws.web_rec_end_date IS NULL OR ws.web_rec_end_date > CURRENT_DATE) GROUP BY cc.cc_call_center_id, cc.cc_name, cc.cc_city, cc.cc_state, ws.web_site_id, ws.web_name, ws.web_city, ws.web_state ORDER BY total_catalog_return_amt DESC, total_web_return_amt DESC;
SELECT ca.ca_state, COUNT(DISTINCT c.c_customer_sk) AS total_customers, SUM(sr.sr_return_amt) AS total_return_amount, AVG(sr.sr_return_amt) AS average_return_amount, SUM(sr.sr_return_quantity) AS total_return_quantity, COUNT(DISTINCT sr.sr_ticket_number) AS total_returns, COUNT(DISTINCT CASE WHEN c.c_preferred_cust_flag = 'Y' THEN sr.sr_ticket_number ELSE NULL END) AS preferred_customer_returns FROM store_returns sr JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk WHERE sr.sr_return_tax BETWEEN 5 AND 130 AND c.c_last_review_date_sk IN (2452499, 2452496, 2452479, 2452342) AND sr.sr_item_sk IN (13538, 16733, 1766, 2599, 3017, 9220) GROUP BY ca.ca_state ORDER BY total_return_amount DESC;
SELECT cp.cp_department, cp.cp_catalog_number, ca.ca_state, cd.cd_education_status, COUNT(DISTINCT c.c_customer_sk) AS number_of_customers, SUM(sr.sr_return_quantity) AS total_returned_quantity, AVG(sr.sr_return_amt) AS average_return_amount, SUM(sr.sr_net_loss) AS total_net_loss FROM store_returns sr JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk JOIN catalog_page cp ON cp.cp_catalog_number = ANY('{42, 25, 9}'::integer[]) WHERE cd.cd_education_status = 'College' AND ca.ca_street_number IN ('2', '843', '939', '802', '540') AND sr.sr_returned_date_sk IS NOT NULL GROUP BY cp.cp_department, cp.cp_catalog_number, ca.ca_state, cd.cd_education_status ORDER BY total_net_loss DESC, total_returned_quantity DESC;
SELECT cd.cd_education_status, sm.sm_type, p.p_promo_name, COUNT(DISTINCT ss.ss_ticket_number) AS total_sales_transactions, SUM(ss.ss_quantity) AS total_quantity_sold, AVG(ss.ss_sales_price) AS average_sales_price, SUM(ss.ss_net_paid) AS total_net_paid, SUM(ss.ss_net_paid_inc_tax) AS total_net_paid_inc_tax, SUM(ss.ss_net_profit) AS total_net_profit, COUNT(DISTINCT CASE WHEN cd.cd_credit_rating = 'High Risk' THEN ss.ss_ticket_number END) AS high_risk_sales_transactions, COUNT(DISTINCT CASE WHEN cd.cd_credit_rating = 'Low Risk' THEN ss.ss_ticket_number END) AS low_risk_sales_transactions, COUNT(DISTINCT CASE WHEN cd.cd_credit_rating = 'Unknown' THEN ss.ss_ticket_number END) AS unknown_risk_sales_transactions FROM store_sales ss JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk JOIN ship_mode sm ON sm.sm_ship_mode_sk = ss.ss_addr_sk JOIN promotion p ON ss.ss_promo_sk = p.p_promo_sk WHERE cd.cd_purchase_estimate IN ('2000', '1000', '4500') AND cd.cd_dep_employed_count = '0' AND sm.sm_ship_mode_sk IN ('13', '8', '20') AND sm.sm_type IN ('OVERNIGHT', 'NEXT DAY', 'EXPRESS') AND p.p_promo_name SIMILAR TO '%(eing|ation|able)%' AND p.p_promo_id IN ('AAAAAAAAJEAAAAAA', 'AAAAAAAALABAAAAA', 'AAAAAAAALNAAAAAA') AND p.p_channel_email = 'N' AND p.p_channel_event = 'N' AND ss.ss_ext_wholesale_cost IN ('3979.00', '2858.52', '5927.86') AND ss.ss_addr_sk IN ('19112', '41507', '33733') AND ss.ss_wholesale_cost IN ('17.80', '5.24', '22.67') AND ss.ss_sold_time_sk IN ('35178', '54001', '41756') GROUP BY cd.cd_education_status, sm.sm_type, p.p_promo_name ORDER BY total_net_profit DESC, total_sales_transactions DESC, average_sales_price DESC;
SELECT ws.web_site_id, ws.web_name, AVG(sr.sr_return_amt_inc_tax) AS avg_return_amount_inc_tax, SUM(sr.sr_return_quantity) AS total_return_quantity, SUM(sr.sr_net_loss) AS total_net_loss, COUNT(DISTINCT inv.inv_item_sk) AS number_of_distinct_items_in_inventory, AVG(inv.inv_quantity_on_hand) AS avg_quantity_on_hand_per_warehouse, COUNT(DISTINCT inv.inv_warehouse_sk) AS number_of_warehouses FROM web_site ws LEFT JOIN store_returns sr ON ws.web_site_sk = sr.sr_store_sk LEFT JOIN inventory inv ON sr.sr_item_sk = inv.inv_item_sk WHERE ws.web_street_number IN ('805', '887', '247', '671', '835') AND inv.inv_date_sk = 2450815 AND sr.sr_hdemo_sk IN ('2871', '5640') AND inv.inv_warehouse_sk IN ('1', '2') GROUP BY ws.web_site_id, ws.web_name ORDER BY avg_return_amount_inc_tax DESC, total_return_quantity DESC, total_net_loss DESC;
SELECT dd.d_year, dd.d_quarter_name, SUM(cr.cr_return_amount) AS total_return_amount, AVG(cr.cr_return_amount) AS avg_return_amount, COUNT(DISTINCT cr.cr_item_sk) AS distinct_items_returned, COUNT(DISTINCT cr.cr_returning_customer_sk) AS distinct_customers_returned, SUM(i.i_current_price * cr.cr_return_quantity) AS total_sales_lost, COUNT(DISTINCT wp.wp_web_page_sk) AS distinct_web_pages_accessed, SUM(wp.wp_char_count) AS total_web_chars FROM catalog_returns cr JOIN date_dim dd ON cr.cr_returned_date_sk = dd.d_date_sk JOIN item i ON cr.cr_item_sk = i.i_item_sk LEFT JOIN web_page wp ON dd.d_date_sk = wp.wp_access_date_sk WHERE dd.d_current_day = 'N' AND dd.d_day_name IN ('Wednesday', 'Monday', 'Saturday', 'Thursday', 'Tuesday') AND cr.cr_returning_addr_sk IN ('13215', '22286', '5756', '38251', '6237') GROUP BY dd.d_year, dd.d_quarter_name ORDER BY dd.d_year, dd.d_quarter_name;
SELECT r_reason_desc, w_state, COUNT(DISTINCT cr_order_number) AS total_catalog_returns, SUM(cr_return_quantity) AS total_returned_quantity, SUM(cr_return_amount) AS total_refund_amount, AVG(cr_return_amount) AS avg_refund_amount_per_return, SUM(cr_fee) AS total_fees, SUM(cr_net_loss) AS total_net_loss FROM catalog_returns JOIN reason ON catalog_returns.cr_reason_sk = reason.r_reason_sk JOIN warehouse ON catalog_returns.cr_warehouse_sk = warehouse.w_warehouse_sk GROUP BY r_reason_desc, w_state ORDER BY total_refund_amount DESC, total_returned_quantity DESC;
SELECT t_shift, EXTRACT(YEAR FROM TO_TIMESTAMP(t_time_id, 'YYYYMMDDHH24MISS')) AS sale_year, SUM(cs_quantity) AS total_quantity_sold, AVG(cs_sales_price) AS average_sales_price, COUNT(DISTINCT cs_order_number) AS number_of_orders, SUM(ws_quantity) AS total_quantity_web_sold, AVG(ws_sales_price) AS average_web_sales_price, COUNT(DISTINCT ws_order_number) AS number_of_web_orders, SUM(wr_return_quantity) AS total_quantity_returned, AVG(wr_return_amt) AS average_return_amount, COUNT(DISTINCT wr_order_number) AS number_of_returns, (SUM(cs_net_profit) + SUM(ws_net_profit) - SUM(wr_net_loss)) AS total_net_profit FROM catalog_sales JOIN time_dim ON cs_sold_time_sk = t_time_sk JOIN web_sales ON cs_order_number = ws_order_number AND cs_item_sk = ws_item_sk JOIN web_returns ON cs_order_number = wr_order_number AND cs_item_sk = wr_item_sk WHERE t_time IN ('2095', '1273', '731', '4867', '571', '4658') AND t_time_id IN ('AAAAAAAACEEAAAAA', 'AAAAAAAAJGMAAAAA', 'AAAAAAAABJLAAAAA', 'AAAAAAAAFHIAAAAA', 'AAAAAAAAFOLAAAAA') GROUP BY t_shift, sale_year ORDER BY sale_year, t_shift;
SELECT ws.web_site_id, ws.web_name, td.t_shift, td.t_hour, COUNT(wr.wr_order_number) AS return_count, SUM(wr.wr_return_quantity) AS total_return_quantity, AVG(wr.wr_return_amt_inc_tax) AS avg_return_amt_inc_tax, SUM(wr.wr_return_amt_inc_tax) AS sum_return_amt_inc_tax, SUM(wr.wr_fee) AS total_fee, SUM(wr.wr_return_ship_cost) AS total_return_ship_cost, SUM(wr.wr_net_loss) AS total_net_loss FROM web_returns wr JOIN time_dim td ON wr.wr_returned_time_sk = td.t_time_sk JOIN web_site ws ON wr.wr_web_page_sk = ws.web_site_sk WHERE wr.wr_return_amt_inc_tax >= 100.00 AND td.t_shift = 'Evening' GROUP BY ws.web_site_id, ws.web_name, td.t_shift, td.t_hour ORDER BY ws.web_site_id, td.t_hour;
SELECT dd.d_year, dd.d_quarter_name, SUM(ws.ws_quantity) AS total_quantity_sold, AVG(ws.ws_sales_price) AS average_sales_price, COUNT(DISTINCT ws.ws_order_number) AS total_orders, SUM(ws.ws_net_paid) AS total_net_paid, SUM(ws.ws_net_profit) AS total_net_profit FROM web_sales ws JOIN date_dim dd ON ws.ws_sold_date_sk = dd.d_date_sk WHERE dd.d_year = 2022 GROUP BY dd.d_year, dd.d_quarter_name ORDER BY dd.d_year, dd.d_quarter_name;
