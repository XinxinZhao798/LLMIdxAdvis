SELECT cc.cc_name AS CallCenter, SUM(cr.cr_return_amount) AS TotalReturnAmount, AVG(cr.cr_return_amount) AS AverageReturnAmount, COUNT(cr.cr_order_number) AS NumberOfReturns, r.r_reason_desc AS ReturnReason, ib.ib_lower_bound AS IncomeBandLowerBound, ib.ib_upper_bound AS IncomeBandUpperBound, COUNT(DISTINCT ws.ws_order_number) AS NumberOfWebSales, SUM(ws.ws_net_profit) AS TotalWebSalesProfit FROM catalog_returns cr INNER JOIN call_center cc ON cr.cr_call_center_sk = cc.cc_call_center_sk INNER JOIN reason r ON cr.cr_reason_sk = r.r_reason_sk INNER JOIN income_band ib ON cr.cr_refunded_cdemo_sk = ib.ib_income_band_sk LEFT JOIN web_sales ws ON cr.cr_order_number = ws.ws_order_number WHERE cc.cc_market_manager IN ('Julius Durham', 'Matthew Clifton', 'Gary Colburn', 'Julius Tran') AND ib.ib_upper_bound IN (50000, 130000, 180000, 60000, 160000) AND ib.ib_lower_bound IN (0, 50001, 170001, 60001, 110001, 90001) AND ws.ws_warehouse_sk IN (3, 1, 2, 5) AND cc.cc_call_center_id IN ('AAAAAAAACAAAAAAA', 'AAAAAAAABAAAAAAA', 'AAAAAAAAEAAAAAAA') GROUP BY CallCenter, ReturnReason, IncomeBandLowerBound, IncomeBandUpperBound ORDER BY TotalReturnAmount DESC, NumberOfReturns DESC, TotalWebSalesProfit DESC;
SELECT i.i_category AS item_category, AVG(i.i_current_price) AS avg_current_price, COUNT(i.i_item_sk) AS total_item_count, AVG(i.i_wholesale_cost) AS avg_wholesale_cost, AVG(cd.cd_purchase_estimate) FILTER (WHERE cd.cd_credit_rating = 'Good') AS avg_good_credit_purchase_estimate, AVG(cd.cd_purchase_estimate) FILTER (WHERE cd.cd_credit_rating = 'High Risk') AS avg_high_risk_credit_purchase_estimate, AVG(cd.cd_purchase_estimate) FILTER (WHERE cd.cd_credit_rating = 'Low Risk') AS avg_low_risk_credit_purchase_estimate FROM item i JOIN promotion p ON i.i_item_sk = p.p_item_sk JOIN customer c ON p.p_start_date_sk <= c.c_first_sales_date_sk AND p.p_end_date_sk >= c.c_first_sales_date_sk JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk WHERE i.i_category IN ('Home', 'Electronics', 'Sports') AND c.c_first_sales_date_sk = '2452263' AND p.p_discount_active = '1' GROUP BY i.i_category ORDER BY avg_current_price DESC;
SELECT cd.cd_education_status, d.d_year, SUM(ss_ext_sales_price) AS total_sales, AVG(ss_ext_sales_price) AS avg_sales_amount, COUNT(cr.cr_order_number) AS total_returns, AVG(cr.cr_return_amount) AS avg_return_amount FROM customer_demographics cd JOIN store_sales ss ON cd.cd_demo_sk = ss.ss_cdemo_sk JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk LEFT JOIN catalog_returns cr ON ss.ss_ticket_number = cr.cr_order_number WHERE d.d_year IN (1998, 1999, 2000) GROUP BY cd.cd_education_status, d.d_year ORDER BY cd.cd_education_status, d.d_year;
SELECT s.s_state AS store_state, s.s_city AS store_city, SUM(s.s_floor_space) AS total_store_floor_space, SUM(s.s_number_employees) AS total_store_employees, AVG(s.s_tax_precentage) AS avg_store_tax_percentage, COUNT(DISTINCT w.w_warehouse_sk) AS total_warehouses, SUM(w.w_warehouse_sq_ft) AS total_warehouse_sq_ft, AVG(wp.wp_image_count) AS avg_webpage_image_count, AVG(wp.wp_link_count) AS avg_webpage_link_count FROM store s LEFT JOIN warehouse w ON s.s_city = w.w_city AND s.s_state = w.w_state LEFT JOIN web_page wp ON s.s_store_sk = wp.wp_customer_sk WHERE s.s_geography_class = 'Unknown' AND w.w_street_name IN ('View First', 'Wilson Elm', '6th', 'Ash Laurel') AND w.w_warehouse_id IN ('AAAAAAAACAAAAAAA', 'AAAAAAAAFAAAAAAA', 'AAAAAAAADAAAAAAA') AND wp.wp_url = 'http://www.foo.com' AND wp.wp_web_page_sk IN ('33', '24', '36', '14', '7', '49') GROUP BY s.s_state, s.s_city ORDER BY s.s_state, s.s_city;
SELECT i.i_category, SUM(ss.ss_ext_sales_price) AS total_sales, AVG(i.i_wholesale_cost) AS avg_wholesale_cost, COUNT(DISTINCT ss.ss_item_sk) AS unique_items_sold, COUNT(ss.ss_ticket_number) AS total_transactions FROM store_sales ss JOIN item i ON ss.ss_item_sk = i.i_item_sk JOIN store s ON ss.ss_store_sk = s.s_store_sk WHERE s.s_tax_precentage BETWEEN 0.03 AND 0.11 AND i.i_current_price BETWEEN 30 AND 90 GROUP BY i.i_category ORDER BY total_sales DESC, i.i_category;
SELECT dd.d_year, dd.d_quarter_name, SUM(cs.cs_quantity) AS total_catalog_quantity, AVG(cs.cs_sales_price) AS average_catalog_sales_price, SUM(cs.cs_net_profit) AS total_catalog_net_profit, SUM(ws.ws_quantity) AS total_web_quantity, AVG(ws.ws_sales_price) AS average_web_sales_price, SUM(ws.ws_net_profit) AS total_web_net_profit, SUM(cs.cs_quantity) + SUM(ws.ws_quantity) AS total_combined_quantity, AVG(cs.cs_sales_price * cs.cs_quantity + ws.ws_sales_price * ws.ws_quantity) / AVG(cs.cs_quantity + ws.ws_quantity) AS average_combined_sales_price, SUM(cs.cs_net_profit) + SUM(ws.ws_net_profit) AS total_combined_net_profit FROM date_dim dd LEFT JOIN catalog_sales cs ON dd.d_date_sk = cs.cs_sold_date_sk LEFT JOIN web_sales ws ON dd.d_date_sk = ws.ws_sold_date_sk WHERE dd.d_year = 2001 AND dd.d_current_quarter = 'N' GROUP BY dd.d_year, dd.d_quarter_name ORDER BY dd.d_year, dd.d_quarter_name;
SELECT dd.d_year, cc.cc_country, SUM(ss.ss_quantity) AS total_quantity_sold, AVG(ss.ss_sales_price) AS avg_sales_price, COUNT(DISTINCT wp.wp_web_page_sk) AS webpage_count, SUM(ss.ss_net_paid) - SUM(ss.ss_net_paid_inc_tax) AS total_tax_collected FROM store_sales ss JOIN date_dim dd ON ss.ss_sold_date_sk = dd.d_date_sk JOIN call_center cc ON cc.cc_call_center_sk = ss.ss_store_sk LEFT JOIN web_page wp ON dd.d_date_sk = wp.wp_access_date_sk WHERE dd.d_current_week = 'N' AND cc.cc_country = 'United States' AND cc.cc_call_center_sk IN ('3', '1', '5') AND wp.wp_image_count IN ('1', '2', '4', '5', '6', '7') GROUP BY dd.d_year, cc.cc_country ORDER BY dd.d_year, total_quantity_sold DESC;
