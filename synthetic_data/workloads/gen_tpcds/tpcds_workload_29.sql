SELECT cc_state, COUNT(DISTINCT cc_call_center_sk) AS num_call_centers, AVG(cc_employees) AS avg_employees, SUM(cc_sq_ft) AS total_square_footage, ca.ca_state AS customer_state, COUNT(DISTINCT ca.ca_address_sk) AS num_customer_addresses, AVG(ca.ca_gmt_offset) AS avg_customer_gmt_offset, sm.sm_type AS ship_mode_type, COUNT(DISTINCT sm.sm_ship_mode_sk) AS num_ship_modes, MAX(sm.sm_contract) AS longest_ship_contract FROM call_center cc JOIN customer_address ca ON cc_state = ca.ca_state JOIN ship_mode sm ON TRUE WHERE cc_street_type = 'Way' AND ca.ca_gmt_offset IN ('-9.00', '-6.00', '-10.00', '-5.00', '-7.00') AND sm.sm_ship_mode_id = 'AAAAAAAAJAAAAAAA' GROUP BY cc_state, ca.ca_state, sm.sm_type ORDER BY cc_state, ca.ca_state, sm.sm_type;
SELECT cd.cd_education_status, sm.sm_type, p.p_promo_name, COUNT(DISTINCT ss.ss_ticket_number) AS total_sales_transactions, SUM(ss.ss_quantity) AS total_quantity_sold, AVG(ss.ss_sales_price) AS average_sales_price, SUM(ss.ss_net_paid) AS total_net_paid, SUM(ss.ss_net_paid_inc_tax) AS total_net_paid_inc_tax, SUM(ss.ss_net_profit) AS total_net_profit, COUNT(DISTINCT CASE WHEN cd.cd_credit_rating = 'High Risk' THEN ss.ss_ticket_number END) AS high_risk_sales_transactions, COUNT(DISTINCT CASE WHEN cd.cd_credit_rating = 'Low Risk' THEN ss.ss_ticket_number END) AS low_risk_sales_transactions, COUNT(DISTINCT CASE WHEN cd.cd_credit_rating = 'Unknown' THEN ss.ss_ticket_number END) AS unknown_risk_sales_transactions FROM store_sales ss JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk JOIN ship_mode sm ON sm.sm_ship_mode_sk = ss.ss_addr_sk JOIN promotion p ON ss.ss_promo_sk = p.p_promo_sk WHERE cd.cd_purchase_estimate IN ('2000', '1000', '4500') AND cd.cd_dep_employed_count = '0' AND sm.sm_ship_mode_sk IN ('13', '8', '20') AND sm.sm_type IN ('OVERNIGHT', 'NEXT DAY', 'EXPRESS') AND p.p_promo_name SIMILAR TO '%(eing|ation|able)%' AND p.p_promo_id IN ('AAAAAAAAJEAAAAAA', 'AAAAAAAALABAAAAA', 'AAAAAAAALNAAAAAA') AND p.p_channel_email = 'N' AND p.p_channel_event = 'N' AND ss.ss_ext_wholesale_cost IN ('3979.00', '2858.52', '5927.86') AND ss.ss_addr_sk IN ('19112', '41507', '33733') AND ss.ss_wholesale_cost IN ('17.80', '5.24', '22.67') AND ss.ss_sold_time_sk IN ('35178', '54001', '41756') GROUP BY cd.cd_education_status, sm.sm_type, p.p_promo_name ORDER BY total_net_profit DESC, total_sales_transactions DESC, average_sales_price DESC;
SELECT d_year, web_country, SUM(ws_net_paid_inc_ship_tax) AS total_revenue, AVG(ws_net_paid_inc_ship_tax) AS avg_order_value, COUNT(DISTINCT ws_order_number) AS total_orders, SUM(ws_quantity) AS total_units_sold, SUM(ws_ext_wholesale_cost) AS total_cost, (SUM(ws_net_paid_inc_ship_tax) - SUM(ws_ext_wholesale_cost)) AS total_profit FROM web_sales JOIN web_site ON ws_web_site_sk = web_site_sk JOIN date_dim ON ws_sold_date_sk = d_date_sk WHERE web_country = 'United States' AND d_year = 2001 GROUP BY d_year, web_country ORDER BY total_revenue DESC;
SELECT cd.cd_education_status, ib.ib_lower_bound, ib.ib_upper_bound, AVG(cs.cs_sales_price) AS avg_sales_price, SUM(cs.cs_ext_discount_amt) AS total_discount, COUNT(cs.cs_order_number) AS total_orders FROM customer_demographics cd JOIN catalog_sales cs ON cd.cd_demo_sk = cs.cs_bill_cdemo_sk JOIN income_band ib ON (cd.cd_purchase_estimate BETWEEN ib.ib_lower_bound AND ib.ib_upper_bound) GROUP BY cd.cd_education_status, ib.ib_lower_bound, ib.ib_upper_bound ORDER BY cd.cd_education_status, ib.ib_lower_bound;
SELECT w_state, w_city, i_category, i_class, i_brand, AVG(i_current_price) AS avg_price, SUM(inv_quantity_on_hand) AS total_inventory, COUNT(DISTINCT i_item_sk) AS unique_items_count, MAX(i_current_price) AS max_price, MIN(i_current_price) AS min_price, COUNT(DISTINCT hd_demo_sk) AS unique_households, AVG(hd_dep_count) AS avg_dependency_count FROM warehouse w JOIN inventory inv ON w.w_warehouse_sk = inv.inv_warehouse_sk JOIN item i ON inv.inv_item_sk = i.i_item_sk LEFT JOIN household_demographics hd ON hd.hd_income_band_sk = i.i_brand_id WHERE w.w_zip = '35709' AND w.w_state = 'TN' AND w.w_street_type IN ('Dr.', 'Drive', 'Parkway') AND w.w_city = 'Fairview' AND inv.inv_date_sk = 2450815 AND inv.inv_quantity_on_hand IN (396, 595, 454) AND inv.inv_warehouse_sk IN (2, 1) AND i.i_container = 'Unknown' AND i.i_item_sk IN (4699, 4967, 949) AND hd.hd_dep_count IN (4, 1, 6) AND hd.hd_income_band_sk IN (9, 18, 10) GROUP BY w_state, w_city, i_category, i_class, i_brand ORDER BY total_inventory DESC, avg_price DESC;
SELECT ca.ca_state, COUNT(DISTINCT ss.ss_ticket_number) AS total_sales_transactions, SUM(ss.ss_net_paid) AS total_sales_amount, AVG(ss.ss_net_paid) AS average_sales_amount, SUM(ss.ss_quantity) AS total_quantity_sold FROM store_sales AS ss JOIN customer_address AS ca ON ss.ss_addr_sk = ca.ca_address_sk JOIN inventory AS inv ON ss.ss_item_sk = inv.inv_item_sk AND ss.ss_sold_date_sk = inv.inv_date_sk WHERE ca.ca_location_type = 'single family' AND inv.inv_warehouse_sk IN (1, 2) GROUP BY ca.ca_state ORDER BY total_sales_amount DESC;
SELECT site.web_name AS website_name, COUNT(DISTINCT ss.ss_ticket_number) AS store_sales_transactions, COUNT(DISTINCT ws.ws_order_number) AS web_sales_transactions, SUM(ss.ss_net_paid_inc_tax) AS total_store_sales, SUM(ws.ws_net_paid_inc_ship_tax) AS total_web_sales, AVG(ss.ss_quantity) AS avg_store_quantity_sold, AVG(ws.ws_quantity) AS avg_web_quantity_sold, cp.cp_department AS department, SUM(CASE WHEN ss.ss_hdemo_sk IN (1437, 496, 6460, 2527, 4508, 4026) THEN ss.ss_net_profit ELSE 0 END) AS store_profit_from_selected_hdemo, SUM(CASE WHEN ws.ws_web_site_sk IN (SELECT web_site_sk FROM web_site WHERE web_company_id IN (3, 5, 2)) THEN ws.ws_net_profit ELSE 0 END) AS web_profit_from_selected_companies FROM store_sales ss FULL OUTER JOIN web_sales ws ON ss.ss_item_sk = ws.ws_item_sk AND ss.ss_sold_date_sk = ws.ws_sold_date_sk LEFT JOIN catalog_page cp ON ws.ws_web_page_sk = cp.cp_catalog_page_sk LEFT JOIN web_site site ON ws.ws_web_site_sk = site.web_site_sk WHERE (cp.cp_catalog_page_sk IN (10, 2795, 1844, 4860) OR cp.cp_catalog_page_sk IS NULL) GROUP BY site.web_name, cp.cp_department ORDER BY total_store_sales DESC, total_web_sales DESC;
SELECT web.web_name AS website_name, cp.cp_department AS catalog_department, hd.hd_vehicle_count AS vehicle_count, r.r_reason_desc AS return_reason, COUNT(cr.cr_item_sk) AS total_returns, SUM(cr.cr_return_quantity) AS total_returned_quantity, AVG(cr.cr_return_amount) AS avg_return_amount, SUM(cr.cr_return_amount) AS total_return_amount, AVG(cr.cr_return_amt_inc_tax) AS avg_return_amount_incl_tax, SUM(cr.cr_return_amt_inc_tax) AS total_return_amount_incl_tax, SUM(cr.cr_fee) AS total_fees, SUM(cr.cr_net_loss) AS total_net_loss FROM web_site web JOIN catalog_returns cr ON web.web_site_sk = cr.cr_returning_addr_sk JOIN catalog_page cp ON cr.cr_catalog_page_sk = cp.cp_catalog_page_sk JOIN reason r ON cr.cr_reason_sk = r.r_reason_sk JOIN household_demographics hd ON cr.cr_returning_hdemo_sk = hd.hd_demo_sk WHERE web.web_company_id IN ('4', '1', '3') AND cp.cp_end_date_sk IN ('2451144', '2451389') AND hd.hd_vehicle_count IN ('3', '1', '4', '0') GROUP BY web_name, cp_department, vehicle_count, return_reason ORDER BY total_returns DESC, total_return_amount DESC;
SELECT dd.d_year, dd.d_quarter_name, COUNT(DISTINCT cr.cr_order_number) AS catalog_return_orders, SUM(cr.cr_return_quantity) AS total_catalog_returned_qty, AVG(cr.cr_return_amount) AS avg_catalog_return_amount, SUM(cr.cr_net_loss) AS total_catalog_net_loss, COUNT(DISTINCT wr.wr_order_number) AS web_return_orders, SUM(wr.wr_return_quantity) AS total_web_returned_qty, AVG(wr.wr_return_amt) AS avg_web_return_amount, SUM(wr.wr_net_loss) AS total_web_net_loss, COUNT(DISTINCT h.hd_demo_sk) AS unique_households_affected, SUM(CASE WHEN i.i_rec_end_date = '2001-10-26' THEN cr.cr_return_quantity ELSE 0 END) AS qty_items_end_date_oct26 FROM date_dim dd LEFT JOIN catalog_returns cr ON dd.d_date_sk = cr.cr_returned_date_sk LEFT JOIN web_returns wr ON dd.d_date_sk = wr.wr_returned_date_sk LEFT JOIN item i ON cr.cr_item_sk = i.i_item_sk OR wr.wr_item_sk = i.i_item_sk LEFT JOIN household_demographics h ON cr.cr_returning_hdemo_sk = h.hd_demo_sk OR wr.wr_returning_hdemo_sk = h.hd_demo_sk WHERE dd.d_date IS NOT NULL AND (cr.cr_return_amount > 0 OR wr.wr_return_amt > 0) AND (cr.cr_reason_sk = 28 OR wr.wr_reason_sk = 28) GROUP BY dd.d_year, dd.d_quarter_name ORDER BY dd.d_year, dd.d_quarter_name;
SELECT s.s_store_name, ib.hd_income_band_sk, hd.hd_buy_potential, SUM(ss.ss_net_paid) AS total_sales, AVG(ss.ss_sales_price) AS average_sales_price, COUNT(DISTINCT ss.ss_ticket_number) AS transaction_count FROM store_sales ss JOIN store s ON ss.ss_store_sk = s.s_store_sk JOIN household_demographics hd ON ss.ss_hdemo_sk = hd.hd_demo_sk LEFT JOIN household_demographics ib ON hd.hd_income_band_sk = ib.hd_income_band_sk WHERE hd.hd_income_band_sk = 9 GROUP BY s.s_store_name, ib.hd_income_band_sk, hd.hd_buy_potential ORDER BY total_sales DESC, average_sales_price DESC;
SELECT s.s_store_name, s.s_city, s.s_state, COUNT(DISTINCT c.c_customer_sk) AS number_of_customers, SUM(cd.cd_purchase_estimate) AS total_purchase_estimate, AVG(cd.cd_dep_count) AS avg_dependents, AVG(cd.cd_dep_employed_count) AS avg_employed_dependents, AVG(cd.cd_dep_college_count) AS avg_college_dependents, AVG(hd.hd_vehicle_count) AS avg_vehicle_count, ib.ib_lower_bound AS income_band_lower_bound, ib.ib_upper_bound AS income_band_upper_bound FROM store s JOIN customer c ON s.s_store_sk = c.c_current_addr_sk JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk JOIN income_band ib ON hd.hd_income_band_sk = ib.ib_income_band_sk WHERE s.s_rec_start_date = '2001-03-13' AND s.s_number_employees IN (229, 271) AND EXISTS ( SELECT 1 FROM web_page wp WHERE wp.wp_customer_sk = c.c_customer_sk AND wp.wp_access_date_sk IN (2452583, 2452648) ) GROUP BY s.s_store_name, s.s_city, s.s_state, ib.ib_lower_bound, ib.ib_upper_bound ORDER BY s.s_store_name, s.s_city, s.s_state;
SELECT dd.d_year AS sale_year, dd.d_moy AS sale_month, dd.d_dom AS sale_day, COUNT(DISTINCT ss.ss_ticket_number) AS store_sales_count, SUM(ss.ss_quantity) AS store_items_sold, AVG(ss.ss_sales_price) AS avg_store_sale_price, SUM(cs.cs_net_paid_inc_tax) AS catalog_total_revenue_inc_tax, SUM(ws.ws_net_paid_inc_ship_tax) AS web_total_revenue_inc_ship_tax, AVG(cc.cc_employees) AS avg_call_center_employees, ws.ws_web_site_sk, web_site.web_name FROM store_sales ss JOIN date_dim dd ON ss.ss_sold_date_sk = dd.d_date_sk JOIN catalog_sales cs ON ss.ss_sold_date_sk = cs.cs_sold_date_sk JOIN web_sales ws ON ss.ss_sold_date_sk = ws.ws_sold_date_sk JOIN call_center cc ON cs.cs_call_center_sk = cc.cc_call_center_sk JOIN web_site ON ws.ws_web_site_sk = web_site.web_site_sk WHERE dd.d_year = 2000 AND ss.ss_list_price BETWEEN 100 AND 200 AND ws.ws_quantity IN (64, 84, 57) AND cc.cc_open_date_sk IS NOT NULL AND ws.ws_web_page_sk IN (211, 510, 171, 90, 132, 78) AND dd.d_last_dom IN ('2418669', '2418489', '2415993', '2419340', '2418000', '2417392') GROUP BY sale_year, sale_month, sale_day, ws.ws_web_site_sk, web_site.web_name ORDER BY sale_year, sale_month, sale_day, ws.ws_web_site_sk;
SELECT s.s_store_name, s.s_company_name, COUNT(DISTINCT wr.wr_order_number) AS total_returns, SUM(wr.wr_return_amt) AS total_return_amount, AVG(wr.wr_return_quantity) AS average_return_quantity, SUM(wr.wr_return_amt_inc_tax) AS total_return_amount_incl_tax, SUM(wr.wr_fee) AS total_fees, SUM(wr.wr_net_loss) AS total_net_loss, cd.cd_education_status, AVG(cd.cd_purchase_estimate) AS average_purchase_estimate, COUNT(DISTINCT wp.wp_web_page_sk) AS total_web_pages_involved, td.t_shift, SUM(CASE WHEN td.t_am_pm = 'PM' THEN 1 ELSE 0 END) AS returns_in_pm, SUM(CASE WHEN td.t_am_pm = 'AM' THEN 1 ELSE 0 END) AS returns_in_am FROM store s JOIN web_returns wr ON s.s_store_sk = wr.wr_returning_addr_sk JOIN customer_demographics cd ON wr.wr_returning_cdemo_sk = cd.cd_demo_sk JOIN web_page wp ON wr.wr_web_page_sk = wp.wp_web_page_sk JOIN time_dim td ON wr.wr_returned_time_sk = td.t_time_sk WHERE s.s_tax_precentage BETWEEN 0.06 AND 0.08 AND s.s_company_name <> 'Unknown' AND wp.wp_type = 'feedback' AND wp.wp_rec_start_date > '1999-09-04' AND td.t_minute IN (50, 18) GROUP BY s.s_store_name, s.s_company_name, cd.cd_education_status, td.t_shift ORDER BY total_returns DESC, total_return_amount DESC;
SELECT ws.ws_web_site_sk, web.web_name, web.web_class, COUNT(DISTINCT ws.ws_order_number) AS total_orders, SUM(ws.ws_quantity) AS total_quantity_sold, SUM(ws.ws_net_paid) AS total_net_paid, SUM(ws.ws_net_paid_inc_tax) AS total_net_paid_inc_tax, AVG(ws.ws_sales_price) AS average_sales_price, SUM(ws.ws_coupon_amt) AS total_coupon_amt_used, sm.sm_type AS shipping_type, sm.sm_carrier AS shipping_carrier, COUNT(DISTINCT ws.ws_warehouse_sk) AS total_warehouses_used, t.t_shift AS time_shift, COUNT(DISTINCT ws.ws_ship_mode_sk) AS total_ship_modes_used FROM web_sales ws JOIN web_site web ON ws.ws_web_site_sk = web.web_site_sk JOIN time_dim t ON ws.ws_sold_time_sk = t.t_time_sk JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk WHERE web.web_country = 'United States' AND ws.ws_coupon_amt IN (1426.08, 70.99, 196.19) AND t.t_minute IN (33, 5, 49, 22, 42, 10) AND ws.ws_web_site_sk IN (4, 3, 28, 16, 7, 26) GROUP BY ws.ws_web_site_sk, web.web_name, web.web_class, sm.sm_type, sm.sm_carrier, t.t_shift ORDER BY total_net_paid DESC;
SELECT cp.cp_department, COUNT(DISTINCT cp.cp_catalog_page_sk) AS number_of_catalog_pages, AVG(cd.cd_purchase_estimate) AS average_purchase_estimate, SUM(inv.inv_quantity_on_hand) AS total_inventory, COUNT(DISTINCT cd.cd_demo_sk) FILTER (WHERE cd.cd_credit_rating = 'High Risk') AS high_risk_customer_count, COUNT(DISTINCT cd.cd_demo_sk) FILTER (WHERE cd.cd_credit_rating = 'Unknown') AS unknown_credit_rating_count, SUM(cd.cd_dep_college_count) AS total_college_dependents FROM catalog_page cp JOIN customer_demographics cd ON cp.cp_catalog_page_sk = cd.cd_demo_sk JOIN inventory inv ON cp.cp_catalog_page_sk = inv.inv_warehouse_sk WHERE cp.cp_department = 'DEPARTMENT' GROUP BY cp.cp_department ORDER BY number_of_catalog_pages DESC;
SELECT w_warehouse_name, cd_credit_rating, AVG(cr_return_amount) AS avg_return_amount, SUM(cr_return_quantity) AS total_return_quantity, COUNT(DISTINCT cr_order_number) AS total_orders_returned, SUM(cr_net_loss) AS total_net_loss FROM catalog_returns INNER JOIN warehouse ON catalog_returns.cr_warehouse_sk = warehouse.w_warehouse_sk INNER JOIN customer_demographics ON catalog_returns.cr_refunded_cdemo_sk = customer_demographics.cd_demo_sk INNER JOIN household_demographics ON catalog_returns.cr_refunded_hdemo_sk = household_demographics.hd_demo_sk WHERE cr_returned_date_sk IN (2451154, 2451037, 2450875, 2450957, 2450981) AND household_demographics.hd_income_band_sk IN ('12', '7', '9', '5', '16', '3') AND household_demographics.hd_vehicle_count = 3 AND customer_demographics.cd_dep_employed_count = 0 AND catalog_returns.cr_store_credit IN (950.05, 59.82, 39.71) GROUP BY w_warehouse_name, cd_credit_rating ORDER BY total_net_loss DESC, avg_return_amount DESC;
SELECT ca.ca_state AS state, dd.d_year AS year, COUNT(sr.sr_ticket_number) AS total_returns, AVG(sr.sr_return_amt) AS avg_return_amount, SUM(sr.sr_return_quantity) AS total_returned_quantity, SUM(sr.sr_net_loss) AS total_net_loss FROM store_returns sr JOIN customer_address ca ON sr.sr_addr_sk = ca.ca_address_sk JOIN date_dim dd ON sr.sr_returned_date_sk = dd.d_date_sk WHERE ca.ca_zip IN ('60534', '57995', '13951') GROUP BY ca.ca_state, dd.d_year ORDER BY state, year;
SELECT ib.ib_income_band_sk, ib.ib_lower_bound, ib.ib_upper_bound, sm.sm_type, sm.sm_carrier, COUNT(i.i_item_sk) AS total_items_sold, AVG(i.i_current_price) AS average_selling_price, AVG(i.i_wholesale_cost) AS average_wholesale_cost FROM item i JOIN ship_mode sm ON i.i_container = sm.sm_code JOIN income_band ib ON i.i_manager_id = ib.ib_income_band_sk WHERE i.i_product_name = 'antin steing' AND ib.ib_income_band_sk IN (13, 18, 17, 3, 11, 16) AND sm.sm_contract IN ('uukTktPYycct8', '6Hzzp4JkzjqD8MGXLCDa', 'Xjy3ZPuiDjzHlRx14Z3', 'A5BYO1qH8HGTTN') AND i.i_item_id = 'AAAAAAAAMFLAAAAA' AND sm.sm_code IN ('SEA', 'BIKE', 'AIR', 'SURFACE') GROUP BY ib.ib_income_band_sk, ib.ib_lower_bound, ib.ib_upper_bound, sm.sm_type, sm.sm_carrier ORDER BY average_selling_price DESC, total_items_sold DESC;
SELECT ca.ca_state, i.i_category, COUNT(cs.cs_order_number) AS total_orders, SUM(cs.cs_ext_sales_price) AS total_sales, AVG(cs.cs_sales_price) AS avg_sales_price, SUM(inv.inv_quantity_on_hand) AS total_inventory FROM catalog_sales cs JOIN customer_address ca ON cs.cs_ship_addr_sk = ca.ca_address_sk JOIN item i ON cs.cs_item_sk = i.i_item_sk JOIN inventory inv ON i.i_item_sk = inv.inv_item_sk AND cs.cs_sold_date_sk = inv.inv_date_sk WHERE cs.cs_wholesale_cost != 26.15 AND i.i_item_sk IN (2, 27, 23, 43, 36, 38) AND inv.inv_date_sk = 2450815 GROUP BY ca.ca_state, i.i_category ORDER BY total_sales DESC, ca.ca_state, i.i_category;
SELECT c.c_salutation, SUM(ss.ss_quantity) AS store_sales_quantity, AVG(ss.ss_sales_price) AS store_sales_avg_price, SUM(cs.cs_quantity) AS catalog_sales_quantity, AVG(cs.cs_sales_price) AS catalog_sales_avg_price, SUM(ws.ws_quantity) AS web_sales_quantity, AVG(ws.ws_sales_price) AS web_sales_avg_price, AVG(hd.hd_dep_count) AS avg_household_dep_count, AVG(ib.ib_upper_bound) AS avg_income_upper_bound FROM customer c LEFT JOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk LEFT JOIN catalog_sales cs ON c.c_customer_sk = cs.cs_bill_customer_sk LEFT JOIN web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk LEFT JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk LEFT JOIN income_band ib ON hd.hd_income_band_sk = ib.ib_income_band_sk WHERE c.c_salutation IN ('Mr.', 'Miss', 'Sir') AND hd.hd_buy_potential IN ('5001-10000', 'Unknown', '501-1000', '0-500', '>10000') AND hd.hd_income_band_sk IN (1, 6, 12, 18) AND (ss.ss_sold_time_sk IN (50436, 48475, 51865) OR ss.ss_sold_time_sk IS NULL) AND (ss.ss_ext_wholesale_cost IN (3684.31, 3037.11, 5884.90, 4962.49, 1522.56, 3630.06) OR ss.ss_ext_wholesale_cost IS NULL) GROUP BY c.c_salutation ORDER BY c.c_salutation;
SELECT sm.sm_type, sm.sm_carrier, COUNT(DISTINCT cs.cs_order_number) AS total_orders, SUM(cs.cs_quantity) AS total_quantity_sold, SUM(cs.cs_net_paid) AS total_net_paid, AVG(cs.cs_sales_price) AS average_sales_price, SUM(cs.cs_net_profit) AS total_net_profit FROM catalog_sales cs JOIN ship_mode sm ON cs.cs_ship_mode_sk = sm.sm_ship_mode_sk JOIN web_page wp ON cs.cs_catalog_page_sk = wp.wp_web_page_sk WHERE wp.wp_char_count IN (701, 1931) AND sm.sm_type = 'OVERNIGHT' AND cs.cs_call_center_sk IN (1, 2, 4) GROUP BY sm.sm_type, sm.sm_carrier ORDER BY total_net_paid DESC;
SELECT sm.sm_type, COUNT(DISTINCT cs.cs_order_number) AS total_orders, SUM(cs.cs_quantity) AS total_quantity, AVG(cs.cs_sales_price) AS avg_sales_price, SUM(cs.cs_net_paid) AS total_net_paid, SUM(cs.cs_net_paid_inc_ship) AS total_net_paid_inc_ship, SUM(cs.cs_net_paid_inc_tax) AS total_net_paid_inc_tax, SUM(cs.cs_net_paid_inc_ship_tax) AS total_net_paid_inc_ship_tax, SUM(cs.cs_net_profit) AS total_net_profit, SUM(inv.inv_quantity_on_hand) AS total_inventory_quantity, SUM(ss.ss_net_profit) AS total_store_sales_net_profit, SUM(wr.wr_net_loss) AS total_web_returns_net_loss FROM ship_mode sm LEFT JOIN catalog_sales cs ON sm.sm_ship_mode_sk = cs.cs_ship_mode_sk LEFT JOIN inventory inv ON cs.cs_item_sk = inv.inv_item_sk AND inv.inv_warehouse_sk IN (1, 2) LEFT JOIN store_sales ss ON cs.cs_item_sk = ss.ss_item_sk LEFT JOIN web_returns wr ON cs.cs_item_sk = wr.wr_item_sk WHERE inv.inv_item_sk = 10208 AND (cs.cs_coupon_amt = 849.23 OR cs.cs_coupon_amt = 20.08) AND cs.cs_order_number IN (99696, 116682, 86052, 116470, 78481) AND wr.wr_net_loss IN (31.29, 420.25, 714.73, 424.40, 381.09) GROUP BY sm.sm_type ORDER BY total_net_profit DESC;
