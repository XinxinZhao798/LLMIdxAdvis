SELECT d.d_year AS year, d.d_month_seq AS month_sequence, COUNT(DISTINCT ss.ss_store_sk) AS num_stores, SUM(ss.ss_quantity) AS total_items_sold, SUM(ss.ss_net_paid_inc_tax) AS total_sales_inc_tax, AVG(ss.ss_ext_discount_amt) AS average_discount, SUM(cr.cr_return_amount) AS total_returns, AVG(cr.cr_fee) AS average_return_fee, COUNT(DISTINCT cr.cr_call_center_sk) FILTER (WHERE cc.cc_class = 'small') AS num_small_class_call_centers, COUNT(DISTINCT cr.cr_call_center_sk) FILTER (WHERE cc.cc_class = 'medium') AS num_medium_class_call_centers, COUNT(DISTINCT cr.cr_call_center_sk) FILTER (WHERE cc.cc_class = 'large') AS num_large_class_call_centers FROM store_sales ss JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk LEFT JOIN catalog_returns cr ON ss.ss_ticket_number = cr.cr_order_number LEFT JOIN call_center cc ON cr.cr_call_center_sk = cc.cc_call_center_sk WHERE d.d_month_seq IS NOT NULL AND ss.ss_store_sk IS NOT NULL GROUP BY year, month_sequence ORDER BY year, month_sequence;
SELECT sm.sm_type AS shipping_type, COUNT(DISTINCT cs.cs_order_number) AS total_orders, SUM(cs.cs_quantity) AS total_quantity, AVG(cs.cs_sales_price) AS avg_sales_price, SUM(cs.cs_net_paid) AS total_net_paid, SUM(cs.cs_net_profit) AS total_net_profit, COUNT(DISTINCT p.p_promo_sk) AS distinct_promotions_used, SUM(CASE WHEN t.t_am_pm = 'AM' THEN cs.cs_quantity ELSE 0 END) AS total_quantity_am, SUM(CASE WHEN t.t_am_pm = 'PM' THEN cs.cs_quantity ELSE 0 END) AS total_quantity_pm FROM catalog_sales cs JOIN time_dim t ON cs.cs_sold_time_sk = t.t_time_sk JOIN ship_mode sm ON cs.cs_ship_mode_sk = sm.sm_ship_mode_sk JOIN promotion p ON cs.cs_promo_sk = p.p_promo_sk WHERE cs.cs_sold_date_sk IS NOT NULL AND cs.cs_ship_date_sk IS NOT NULL AND sm.sm_contract IN ('uukTktPYycct8', 'GNJr3g5i7oorKqtX', 'hGoF18SLDDPBj', 'Ek', 'YvxVaJI10') AND p.p_cost = 1000.00 AND p.p_channel_catalog = 'N' GROUP BY sm.sm_type ORDER BY total_net_paid DESC;
SELECT cp.cp_department, ib.ib_income_band_sk, COUNT(DISTINCT cr.cr_order_number) AS total_returns, SUM(cr.cr_return_quantity) AS total_returned_quantity, AVG(cr.cr_return_amount) AS avg_return_amount, SUM(cr.cr_net_loss) AS total_net_loss, COUNT(DISTINCT sr.sr_ticket_number) AS total_store_returns, SUM(sr.sr_return_amt_inc_tax) AS total_store_return_value, AVG(sr.sr_fee) AS avg_store_return_fee, SUM(wp.wp_image_count) AS total_web_images FROM catalog_page cp JOIN catalog_returns cr ON cp.cp_catalog_page_sk = cr.cr_catalog_page_sk JOIN store_returns sr ON cr.cr_item_sk = sr.sr_item_sk JOIN web_page wp ON cp.cp_catalog_page_sk = wp.wp_web_page_sk JOIN income_band ib ON ib.ib_lower_bound <= cr.cr_return_amount AND ib.ib_upper_bound >= cr.cr_return_amount WHERE cp.cp_start_date_sk BETWEEN 2450965 AND 2451180 AND cr.cr_returned_time_sk IN (68597, 54816, 8520, 49710) AND sr.sr_returned_date_sk BETWEEN 2451108 AND 2452339 AND sr.sr_return_ship_cost = 3.94 GROUP BY cp.cp_department, ib.ib_income_band_sk ORDER BY total_net_loss DESC, total_store_return_value DESC;
SELECT i.i_category, i.i_brand, w.w_state, w.w_country, AVG(i.i_current_price) AS avg_price, SUM(i.i_wholesale_cost) AS total_wholesale_cost, COUNT(DISTINCT i.i_item_sk) AS item_count, SUM(inv.inv_quantity_on_hand) AS total_quantity_on_hand FROM item i JOIN inventory inv ON i.i_item_sk = inv.inv_item_sk JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk WHERE w.w_zip = '35709' AND w.w_gmt_offset = -5.00 AND inv.inv_quantity_on_hand > 258 GROUP BY i.i_category, i.i_brand, w.w_state, w.w_country ORDER BY i.i_category, i.i_brand;
SELECT i.i_category, i.i_class, i.i_brand, SUM(ws.ws_net_paid) AS total_sales, AVG(ws.ws_quantity) AS average_quantity_sold, SUM(sr.sr_return_amt) AS total_returns, AVG(sr.sr_return_quantity) AS average_quantity_returned, (SUM(ws.ws_net_paid) - SUM(sr.sr_return_amt)) AS net_sales FROM web_sales ws JOIN item i ON ws.ws_item_sk = i.i_item_sk JOIN store_returns sr ON ws.ws_item_sk = sr.sr_item_sk LEFT JOIN ( SELECT wr_item_sk, wr_returned_date_sk, SUM(wr_return_amt) AS wr_total_return_amt, SUM(wr_return_ship_cost) AS wr_total_return_ship_cost FROM web_returns GROUP BY wr_item_sk, wr_returned_date_sk ) wr ON ws.ws_item_sk = wr.wr_item_sk WHERE ws.ws_warehouse_sk IN (5, 1, 2) AND ws.ws_wholesale_cost IN (16.07, 45.38, 66.57) AND ws.ws_order_number IN (42297, 10912, 13297) AND sr.sr_ticket_number IN (36370, 38622, 39874) AND sr.sr_return_quantity IN (41, 16, 8) AND i.i_manufact IN ('baresecally', 'ationableought', 'ableationeing') AND i.i_item_id IN ('AAAAAAAAJKDAAAAA', 'AAAAAAAAIACAAAAA', 'AAAAAAAAACIAAAAA') AND wr.wr_returned_date_sk IN (2451906, 2452157, 2451313) AND wr.wr_total_return_ship_cost IN (209.65, 2559.79, 887.24) AND wr.wr_total_return_amt IN (32.76, 437.16, 23.35) GROUP BY i.i_category, i.i_class, i.i_brand ORDER BY net_sales DESC, total_sales DESC, total_returns DESC, i.i_category, i.i_class, i.i_brand;
SELECT cc.cc_name, SUM(CASE WHEN p.p_channel_catalog = 'N' THEN p.p_cost ELSE 0 END) AS total_promotion_cost_catalog, AVG(i.i_current_price) AS average_item_price, COUNT(DISTINCT p.p_promo_sk) AS number_of_promotions, COUNT(DISTINCT i.i_item_sk) AS number_of_items_promoted, SUM(CASE WHEN cc.cc_hours = '8AM-4PM' THEN 1 ELSE 0 END) AS call_centers_8am_to_4pm, SUM(CASE WHEN cc.cc_hours = '8AM-8AM' THEN 1 ELSE 0 END) AS call_centers_24_hours FROM call_center cc JOIN promotion p ON cc.cc_call_center_sk = p.p_promo_sk JOIN item i ON p.p_item_sk = i.i_item_sk WHERE p.p_end_date_sk IN (2450406, 2450872, 2450915, 2450756, 2450513) AND cc.cc_hours IN ('8AM-4PM', '8AM-8AM') GROUP BY cc.cc_name ORDER BY total_promotion_cost_catalog DESC, average_item_price DESC;
SELECT w_state, COUNT(DISTINCT c_customer_sk) AS number_of_customers, AVG(inv_quantity_on_hand) AS average_inventory, SUM(case when c_preferred_cust_flag = 'Y' then 1 else 0 end) AS preferred_customer_count, MAX(wp_link_count) AS max_webpage_link_count, MIN(web_tax_percentage) AS min_tax_percentage FROM customer JOIN warehouse ON c_current_addr_sk = w_warehouse_sk JOIN inventory ON inv_warehouse_sk = w_warehouse_sk JOIN web_page ON wp_customer_sk = c_customer_sk JOIN web_site ON wp_web_page_sk = web_site_sk AND web_class <> 'Unknown' WHERE web_close_date_sk IN ('2446944', '2446978', '2447046') GROUP BY w_state ORDER BY number_of_customers DESC, average_inventory DESC;
SELECT web.web_name, web.web_class, web.web_manager, web.web_mkt_class, time_dim.t_hour, time_dim.t_shift, COUNT(cs.cs_order_number) as total_orders, SUM(cs.cs_quantity) as total_quantity, AVG(cs.cs_sales_price) as average_sales_price, SUM(cs.cs_ext_sales_price) as total_extended_sales_price, SUM(cs.cs_ext_discount_amt) as total_discount_amount, SUM(cs.cs_net_paid) as total_net_paid, SUM(cs.cs_net_profit) as total_net_profit FROM catalog_sales cs JOIN time_dim ON cs.cs_sold_time_sk = time_dim.t_time_sk JOIN web_site web ON cs.cs_call_center_sk = web.web_site_sk WHERE cs.cs_item_sk IN (46, 5) AND cs.cs_ext_sales_price IN (240.00, 708.63) AND web.web_site_id IN ('AAAAAAAAHAAAAAAA', 'AAAAAAAAOAAAAAAA', 'AAAAAAAAIAAAAAAA', 'AAAAAAAAEAAAAAAA', 'AAAAAAAADBAAAAAA') AND web.web_class <> 'Unknown' GROUP BY web.web_name, web.web_class, web.web_manager, web.web_mkt_class, time_dim.t_hour, time_dim.t_shift ORDER BY web.web_name, time_dim.t_hour, time_dim.t_shift;
SELECT ws.web_site_id, ws.web_name, AVG(sr.sr_return_amt_inc_tax) AS avg_return_amount_inc_tax, SUM(sr.sr_return_quantity) AS total_return_quantity, SUM(sr.sr_net_loss) AS total_net_loss, COUNT(DISTINCT inv.inv_item_sk) AS number_of_distinct_items_in_inventory, AVG(inv.inv_quantity_on_hand) AS avg_quantity_on_hand_per_warehouse, COUNT(DISTINCT inv.inv_warehouse_sk) AS number_of_warehouses FROM web_site ws LEFT JOIN store_returns sr ON ws.web_site_sk = sr.sr_store_sk LEFT JOIN inventory inv ON sr.sr_item_sk = inv.inv_item_sk WHERE ws.web_street_number IN ('805', '887', '247', '671', '835') AND inv.inv_date_sk = 2450815 AND sr.sr_hdemo_sk IN ('2871', '5640') AND inv.inv_warehouse_sk IN ('1', '2') GROUP BY ws.web_site_id, ws.web_name ORDER BY avg_return_amount_inc_tax DESC, total_return_quantity DESC, total_net_loss DESC;
SELECT cc.cc_call_center_id AS call_center, cc.cc_name AS call_center_name, cc.cc_manager AS manager, SUM(i.i_current_price) AS total_sales, AVG(i.i_wholesale_cost) AS average_wholesale_cost, COUNT(DISTINCT cd.cd_demo_sk) AS unique_customer_demographics, AVG(cd.cd_purchase_estimate) AS average_purchase_estimate, COUNT(DISTINCT t.t_time_sk) AS count_time_sk_events, ib.ib_lower_bound, ib.ib_upper_bound, COUNT(*) FILTER (WHERE t.t_am_pm = 'AM') AS am_shifts, COUNT(*) FILTER (WHERE t.t_sub_shift = 'night') AS night_sub_shifts FROM call_center cc JOIN catalog_page cp ON cc.cc_call_center_id = cp.cp_catalog_page_id JOIN item i ON cp.cp_catalog_page_sk = i.i_item_sk JOIN customer_demographics cd ON i.i_manager_id = cd.cd_demo_sk JOIN time_dim t ON t.t_time_sk = cd.cd_demo_sk JOIN income_band ib ON cd.cd_purchase_estimate BETWEEN ib.ib_lower_bound AND ib.ib_upper_bound JOIN date_dim dd_cc ON cc.cc_open_date_sk = dd_cc.d_date_sk JOIN date_dim dd_cp ON cp.cp_start_date_sk = dd_cp.d_date_sk WHERE dd_cc.d_date <= CURRENT_DATE AND (cc.cc_rec_end_date IS NULL OR cc.cc_rec_end_date > CURRENT_DATE) AND dd_cp.d_date <= CURRENT_DATE AND (cp.cp_end_date_sk IS NULL OR dd_cp.d_date > CURRENT_DATE) GROUP BY cc.cc_call_center_id, cc.cc_name, cc.cc_manager, ib.ib_lower_bound, ib.ib_upper_bound ORDER BY total_sales DESC;
SELECT ca.ca_state, ib.ib_lower_bound, ib.ib_upper_bound, AVG(sr.sr_return_amt) AS avg_return_amount, SUM(sr.sr_return_ship_cost) AS total_return_shipping_cost, COUNT(sr.sr_return_amt) AS num_of_returns FROM store_returns sr JOIN customer_address ca ON sr.sr_addr_sk = ca.ca_address_sk JOIN income_band ib ON sr.sr_hdemo_sk = ib.ib_income_band_sk JOIN web_site ws ON sr.sr_store_sk = ws.web_site_sk WHERE ws.web_market_manager IN ('Gerald Craft', 'Donald Mckinney', 'Jeffrey Campbell', 'Eldon Snow', 'Keith Frazier', 'Gilbert Chapman') GROUP BY ca.ca_state, ib.ib_lower_bound, ib.ib_upper_bound ORDER BY ca.ca_state, ib.ib_lower_bound;
SELECT s.s_store_name, s.s_street_name, s.s_street_type, s.s_city, s.s_state, s.s_zip, SUM(sr.sr_return_amt_inc_tax) AS total_store_refunds, AVG(sr.sr_return_amt_inc_tax) AS avg_store_refund, COUNT(sr.sr_return_amt_inc_tax) AS num_store_returns, SUM(wr.wr_return_amt_inc_tax) AS total_web_refunds, AVG(wr.wr_return_amt_inc_tax) AS avg_web_refund, COUNT(wr.wr_return_amt_inc_tax) AS num_web_returns FROM store s LEFT JOIN store_returns sr ON s.s_store_sk = sr.sr_store_sk LEFT JOIN date_dim d_store ON sr.sr_returned_date_sk = d_store.d_date_sk LEFT JOIN web_returns wr ON s.s_store_sk = wr.wr_returning_customer_sk LEFT JOIN date_dim d_web ON wr.wr_returned_date_sk = d_web.d_date_sk WHERE s.s_street_type IN ('Road', 'Circle', 'Court') AND (d_store.d_quarter_name = '1906Q2' OR d_web.d_quarter_name = '1906Q2') GROUP BY s.s_store_name, s.s_street_name, s.s_street_type, s.s_city, s.s_state, s.s_zip ORDER BY total_store_refunds DESC, total_web_refunds DESC;
SELECT cs.cs_order_number AS order_number, SUM(cs.cs_quantity) AS total_quantity, AVG(cs.cs_sales_price) AS average_sales_price, SUM(cs.cs_net_paid) AS total_net_paid, SUM(cs.cs_net_profit) AS total_net_profit, COUNT(DISTINCT cs.cs_bill_customer_sk) AS unique_customers, ib.ib_lower_bound AS income_lower_bound, ib.ib_upper_bound AS income_upper_bound, SUM(ws.ws_quantity) AS web_total_quantity, AVG(ws.ws_sales_price) AS web_average_sales_price, SUM(ws.ws_net_paid) AS web_total_net_paid, SUM(ws.ws_net_profit) AS web_total_net_profit, COUNT(DISTINCT ws.ws_bill_customer_sk) AS web_unique_customers FROM catalog_sales cs JOIN income_band ib ON cs.cs_bill_hdemo_sk = ib.ib_income_band_sk JOIN web_sales ws ON cs.cs_item_sk = ws.ws_item_sk AND cs.cs_order_number = ws.ws_order_number WHERE cs.cs_ext_tax IN (0.56, 96.57, 30.68, 46.59, 64.13) AND ib.ib_income_band_sk IN (19, 17, 16, 10, 1) GROUP BY cs.cs_order_number, ib.ib_lower_bound, ib.ib_upper_bound ORDER BY total_net_profit DESC, web_total_net_profit DESC LIMIT 100;
SELECT cc.cc_state, AVG(cd.hd_dep_count) AS avg_dependent_count, AVG(cd.hd_vehicle_count) AS avg_vehicle_count, SUM(cs.cs_quantity) AS total_quantity_sold, SUM(cs.cs_sales_price) AS total_sales, AVG(cs.cs_sales_price) AS average_sales_price, AVG(cs.cs_ext_discount_amt) AS average_discount_amount, COUNT(DISTINCT cs.cs_order_number) AS total_transactions FROM catalog_sales cs JOIN call_center cc ON cs.cs_call_center_sk = cc.cc_call_center_sk LEFT JOIN household_demographics cd ON cs.cs_ship_hdemo_sk = cd.hd_demo_sk WHERE cs.cs_sold_date_sk IS NOT NULL AND cc.cc_state IS NOT NULL GROUP BY cc.cc_state ORDER BY total_sales DESC LIMIT 5;
SELECT s_store_name, i_category, cd_gender, cd_education_status, r_reason_desc, COUNT(DISTINCT wr_item_sk) AS unique_items_returned, SUM(wr_return_quantity) AS total_return_quantity, AVG(wr_return_amt) AS avg_return_amount, AVG(i_wholesale_cost) AS avg_wholesale_cost, COUNT(wr_returned_date_sk) AS total_returns FROM web_returns JOIN item ON wr_item_sk = i_item_sk JOIN store ON s_store_sk = wr_returning_addr_sk JOIN customer_demographics ON cd_demo_sk = wr_returning_cdemo_sk JOIN reason ON r_reason_sk = wr_reason_sk JOIN date_dim ON wr_returned_date_sk = d_date_sk JOIN time_dim ON wr_returned_time_sk = t_time_sk WHERE d_year = 2022 AND s_state = 'CA' AND wr_return_amt > 0 AND i_current_price > i_wholesale_cost AND t_shift = 'third' GROUP BY s_store_name, i_category, cd_gender, cd_education_status, r_reason_desc ORDER BY total_return_quantity DESC, avg_return_amount DESC LIMIT 100;
SELECT c.cp_department, i.i_category, COUNT(DISTINCT cr.cr_order_number) AS total_returns, SUM(cr.cr_return_quantity) AS total_returned_quantity, AVG(cr.cr_return_amount) AS avg_return_amount, SUM(cr.cr_return_amount) AS total_return_amount, SUM(cr.cr_fee) AS total_fees_collected, SUM(cr.cr_net_loss) AS total_net_loss, w.w_state, hd.hd_buy_potential FROM catalog_returns cr JOIN catalog_page c ON cr.cr_catalog_page_sk = c.cp_catalog_page_sk JOIN item i ON cr.cr_item_sk = i.i_item_sk JOIN warehouse w ON cr.cr_warehouse_sk = w.w_warehouse_sk JOIN household_demographics hd ON cr.cr_returning_hdemo_sk = hd.hd_demo_sk WHERE cr.cr_returning_addr_sk IN ('31623', '47914', '49311', '38890', '49597') AND w.w_state = 'TN' AND hd.hd_buy_potential IN ('501-1000', '5001-10000') GROUP BY c.cp_department, i.i_category, w.w_state, hd.hd_buy_potential ORDER BY total_return_amount DESC, c.cp_department, i.i_category;
