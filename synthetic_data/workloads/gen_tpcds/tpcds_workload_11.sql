SELECT s_state, s_city, s_county, COUNT(DISTINCT s_store_sk) AS num_stores, SUM(ss_quantity) AS total_quantity_sold, AVG(ss_sales_price) AS average_sales_price, SUM(ss_net_paid) AS total_net_paid, SUM(ss_net_paid_inc_tax) AS total_net_paid_inc_tax, SUM(ss_net_profit) AS total_net_profit, COUNT(DISTINCT ss_customer_sk) AS unique_customers, AVG(inv_quantity_on_hand) AS average_inventory_on_hand FROM store JOIN store_sales ON s_store_sk = ss_store_sk JOIN inventory ON ss_item_sk = inv_item_sk AND ss_store_sk = inv_warehouse_sk JOIN time_dim ON ss_sold_time_sk = t_time_sk WHERE inv_quantity_on_hand IN (553, 372, 818, 629, 791, 623) AND inv_warehouse_sk IN (1, 2) AND t_hour BETWEEN 9 AND 17 GROUP BY s_state, s_city, s_county ORDER BY s_state, s_city, s_county;
SELECT s.s_store_name, count(distinct ss.ss_ticket_number) as total_sales_transactions, sum(ss.ss_quantity) as total_items_sold, sum(ss.ss_net_paid_inc_tax) as total_sales_revenue, sum(cr.cr_return_quantity) as total_items_returned, sum(cr.cr_return_amt_inc_tax) as total_returned_revenue, sum(inv.inv_quantity_on_hand) as total_inventory_quantity FROM store_sales ss JOIN store s ON ss.ss_store_sk = s.s_store_sk LEFT JOIN catalog_returns cr ON ss.ss_item_sk = cr.cr_item_sk AND ss.ss_ticket_number = cr.cr_order_number LEFT JOIN inventory inv ON ss.ss_item_sk = inv.inv_item_sk WHERE s.s_country = 'United States' AND (inv.inv_item_sk = 12400 OR inv.inv_item_sk = 10369 OR inv.inv_item_sk = 8875) AND (ss.ss_ext_list_price = 5535.38 OR ss.ss_ext_list_price = 6147.90 OR ss.ss_ext_list_price = 8470.00 OR ss.ss_ext_list_price = 4720.95 OR ss.ss_ext_list_price = 5696.87 OR ss.ss_ext_list_price = 37.40) AND (cr.cr_return_tax = 123.73 OR cr.cr_return_tax = 44.47 OR cr.cr_return_tax = 115.68 OR cr.cr_return_tax = 4.37) GROUP BY s.s_store_name;
SELECT cd.cd_gender, cd.cd_marital_status, cd.cd_education_status, cd.cd_credit_rating, SUM(ss.ss_quantity) AS total_quantity_sold, AVG(ss.ss_sales_price) AS average_sales_price, COUNT(DISTINCT ss.ss_ticket_number) AS total_tickets, SUM(ss.ss_net_profit) AS total_net_profit FROM store_sales ss JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk JOIN promotion p ON ss.ss_promo_sk = p.p_promo_sk JOIN time_dim t ON ss.ss_sold_time_sk = t.t_time_sk JOIN ship_mode sm ON sm.sm_ship_mode_sk = ss.ss_promo_sk JOIN income_band ib ON ib.ib_income_band_sk = cd.cd_demo_sk WHERE sm.sm_contract IN ('ldhM8IvpzHgdbBgDfI', 'qENFQ', '6Hzzp4JkzjqD8MGXLCDa', 'uukTktPYycct8') AND t.t_hour IN (1, 0) AND ib.ib_upper_bound <= 10000 AND ib.ib_income_band_sk IN (18, 2, 4, 16, 13, 9) AND cd.cd_credit_rating IN ('High Risk', 'Low Risk', 'Good', 'Unknown') AND cd.cd_marital_status IN ('D', 'M', 'W', 'U') GROUP BY cd.cd_gender, cd.cd_marital_status, cd.cd_education_status, cd.cd_credit_rating ORDER BY total_net_profit DESC, total_tickets DESC;
SELECT dd.d_year, dd.d_month_seq, SUM(ss.ss_quantity) AS total_quantity_sold, AVG(ss.ss_sales_price) AS avg_sales_price, COUNT(DISTINCT ss.ss_ticket_number) AS count_unique_sales_transactions, SUM(sr.sr_return_quantity) AS total_quantity_returned, AVG(sr.sr_return_amt) AS avg_return_amount, COUNT(DISTINCT sr.sr_ticket_number) AS count_unique_return_transactions, SUM(p.p_cost) AS total_promotion_cost, COUNT(DISTINCT p.p_promo_sk) AS count_unique_promotions FROM store_sales ss JOIN date_dim dd ON ss.ss_sold_date_sk = dd.d_date_sk LEFT JOIN store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number LEFT JOIN promotion p ON ss.ss_promo_sk = p.p_promo_sk WHERE p.p_channel_catalog = 'N' AND dd.d_year = 2002 GROUP BY dd.d_year, dd.d_month_seq ORDER BY dd.d_year, dd.d_month_seq;
SELECT i.i_category, i.i_brand, AVG(cs.cs_quantity) AS avg_catalog_quantity, AVG(ws.ws_quantity) AS avg_web_quantity, SUM(cs.cs_net_paid) AS total_catalog_sales, SUM(ws.ws_net_paid) AS total_web_sales, COUNT(DISTINCT cs.cs_order_number) AS num_catalog_orders, COUNT(DISTINCT ws.ws_order_number) AS num_web_orders, COUNT(DISTINCT cs.cs_promo_sk) AS num_catalog_promotions, COUNT(DISTINCT ws.ws_promo_sk) AS num_web_promotions FROM item i LEFT JOIN catalog_sales cs ON i.i_item_sk = cs.cs_item_sk LEFT JOIN web_sales ws ON i.i_item_sk = ws.ws_item_sk GROUP BY i.i_category, i.i_brand ORDER BY i.i_category, i.i_brand;
SELECT d_year, web_country, SUM(ws_net_paid_inc_ship_tax) AS total_revenue, AVG(ws_net_paid_inc_ship_tax) AS avg_order_value, COUNT(DISTINCT ws_order_number) AS total_orders, SUM(ws_quantity) AS total_units_sold, SUM(ws_ext_wholesale_cost) AS total_cost, (SUM(ws_net_paid_inc_ship_tax) - SUM(ws_ext_wholesale_cost)) AS total_profit FROM web_sales JOIN web_site ON ws_web_site_sk = web_site_sk JOIN date_dim ON ws_sold_date_sk = d_date_sk WHERE web_country = 'United States' AND d_year = 2001 GROUP BY d_year, web_country ORDER BY total_revenue DESC;
