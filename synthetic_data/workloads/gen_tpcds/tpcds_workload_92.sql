SELECT s.s_store_name, s.s_city, s.s_state, td.t_shift, COUNT(*) AS total_returns, AVG(sr.sr_return_amt_inc_tax) AS avg_return_amount_inc_tax, SUM(CASE WHEN sr.sr_return_amt_inc_tax > 100 THEN 1 ELSE 0 END) AS returns_over_100, SUM(sr.sr_fee) AS total_fees, SUM(sr.sr_net_loss) AS total_net_loss FROM store_returns sr JOIN store s ON sr.sr_store_sk = s.s_store_sk JOIN time_dim td ON sr.sr_return_time_sk = td.t_time_sk JOIN customer_address ca ON sr.sr_addr_sk = ca.ca_address_sk JOIN customer_demographics cd ON sr.sr_cdemo_sk = cd.cd_demo_sk JOIN web_page wp ON sr.sr_store_sk = wp.wp_customer_sk JOIN web_returns wr ON sr.sr_item_sk = wr.wr_item_sk AND sr.sr_ticket_number = wr.wr_order_number WHERE td.t_shift = 'third' AND s.s_gmt_offset = '-5.00' AND ca.ca_address_id IN ('AAAAAAAAGGKAAAAA', 'AAAAAAAANCEAAAAA', 'AAAAAAAAOKGAAAAA') AND (wr.wr_return_amt_inc_tax = '6344.70' OR wr.wr_return_amt_inc_tax = '72.90' OR wr.wr_return_amt_inc_tax = '705.96') GROUP BY s.s_store_name, s.s_city, s.s_state, td.t_shift ORDER BY total_returns DESC, avg_return_amount_inc_tax DESC LIMIT 100;
SELECT ca_state, w_state, AVG(c_hd.hd_dep_count) AS avg_household_dep_count, COUNT(DISTINCT cs_order_number) AS total_orders, SUM(cs_net_profit) AS total_net_profit, SUM(ss_net_profit) AS total_store_net_profit FROM customer_address ca JOIN catalog_sales cs ON ca.ca_address_sk = cs.cs_bill_addr_sk JOIN household_demographics c_hd ON cs.cs_bill_hdemo_sk = c_hd.hd_demo_sk JOIN warehouse w ON cs.cs_warehouse_sk = w.w_warehouse_sk JOIN store_sales ss ON cs.cs_item_sk = ss.ss_item_sk AND cs.cs_order_number = ss.ss_ticket_number WHERE ca.ca_country = 'United States' AND w.w_country = 'United States' AND ss.ss_quantity > 5 AND cs.cs_quantity > 5 AND ca.ca_state IN ('CA', 'TX', 'NY') GROUP BY ca_state, w_state ORDER BY total_net_profit DESC, total_store_net_profit DESC, ca_state, w_state;
SELECT s.s_city, COUNT(DISTINCT s.s_store_sk) AS number_of_stores, SUM(s.s_number_employees) AS total_employees, SUM(s.s_floor_space) AS total_floor_space, AVG(w.w_warehouse_sq_ft) AS avg_warehouse_sq_ft, COUNT(DISTINCT cp.cp_catalog_page_sk) AS number_of_catalog_pages FROM store s LEFT JOIN warehouse w ON s.s_city = w.w_city LEFT JOIN catalog_page cp ON cp.cp_catalog_page_number BETWEEN 80 AND 90 WHERE s.s_city IN ('Fairview', 'Midway') AND (s.s_closed_date_sk IS NULL OR s.s_closed_date_sk > CAST(to_char(CURRENT_DATE, 'J') AS INTEGER)) GROUP BY s.s_city ORDER BY s.s_city;
SELECT i_category, d_year, d_quarter_name, SUM(ss_quantity) AS total_quantity_sold, AVG(ss_sales_price) AS average_sales_price, COUNT(DISTINCT ss_customer_sk) AS unique_customers, SUM(sr_return_quantity) AS total_quantity_returned, SUM(sr_return_amt) AS total_return_amount, SUM(ws_net_paid_inc_ship_tax) AS total_web_sales_inc_ship_tax, AVG(ws_quantity) AS average_web_sales_quantity, COUNT(DISTINCT ws_bill_customer_sk) AS unique_web_customers FROM item JOIN store_sales ON ss_item_sk = i_item_sk JOIN date_dim ON ss_sold_date_sk = d_date_sk JOIN store_returns ON sr_item_sk = ss_item_sk AND sr_returned_date_sk = ss_sold_date_sk JOIN web_sales ON ws_item_sk = ss_item_sk AND ws_sold_date_sk = ss_sold_date_sk WHERE d_year = 2022 AND i_category IN ('Electronics', 'Clothing', 'Home Goods') AND ss_list_price BETWEEN 50 AND 150 AND ws_net_paid_inc_tax > 100 GROUP BY i_category, d_year, d_quarter_name ORDER BY total_quantity_sold DESC, total_web_sales_inc_ship_tax DESC LIMIT 100;
SELECT i_category, cd_gender, cd_marital_status, SUM(ss_quantity) AS total_quantity_sold, AVG(ss_sales_price) AS average_sales_price, COUNT(DISTINCT ss_customer_sk) AS unique_customers, SUM(ws_net_profit) AS total_web_net_profit, AVG(wr_fee) AS average_return_fee FROM store_sales JOIN item ON ss_item_sk = i_item_sk JOIN web_sales ON ws_item_sk = ss_item_sk JOIN web_returns ON wr_item_sk = ws_item_sk JOIN customer_demographics ON (ss_cdemo_sk = cd_demo_sk AND ws_bill_cdemo_sk = cd_demo_sk AND wr_refunded_cdemo_sk = cd_demo_sk) WHERE i_wholesale_cost > 14.32 AND (cd_gender = 'M' OR cd_gender = 'F') AND (cd_marital_status = 'M' OR cd_marital_status = 'U') AND ws_net_paid_inc_tax > 100 AND wr_return_amt > 0 GROUP BY i_category, cd_gender, cd_marital_status ORDER BY total_quantity_sold DESC, average_sales_price DESC;
SELECT ib.ib_income_band_sk, ib.ib_lower_bound, ib.ib_upper_bound, COUNT(DISTINCT ss.ss_customer_sk) AS num_customers, SUM(ss.ss_quantity) AS total_quantity_sold, AVG(ss.ss_sales_price) AS avg_sales_price, SUM(ss.ss_net_profit) AS total_net_profit, SUM(sr.sr_return_quantity) AS total_return_quantity, SUM(sr.sr_return_amt) AS total_return_amount, AVG(sr.sr_fee) AS avg_return_fee, COUNT(DISTINCT wp.wp_web_page_sk) AS num_visited_pages, SUM(wp.wp_link_count) AS total_link_count FROM income_band ib LEFT JOIN store_sales ss ON ib.ib_income_band_sk = ss.ss_cdemo_sk LEFT JOIN store_returns sr ON ss.ss_customer_sk = sr.sr_customer_sk AND sr.sr_reason_sk IN (21, 2, 14, 30) LEFT JOIN web_page wp ON ss.ss_customer_sk = wp.wp_customer_sk AND wp.wp_type IN ('protected', 'ad') WHERE ss.ss_sold_date_sk IN (2451298, 2450872, 2451390, 2451634) AND ib.ib_upper_bound IN (30000, 130000, 90000) AND ib.ib_income_band_sk IN (17, 6) GROUP BY ib.ib_income_band_sk, ib.ib_lower_bound, ib.ib_upper_bound ORDER BY ib.ib_income_band_sk;
SELECT ws.ws_web_site_sk, AVG(ws.ws_sales_price) AS avg_sales_price, COUNT(ws.ws_order_number) AS total_orders, AVG(ws.ws_quantity) AS avg_quantity, SUM(ws.ws_net_paid_inc_tax) AS total_revenue, SUM(ws.ws_net_paid) AS total_net_paid, SUM(ws.ws_coupon_amt) AS total_coupon_amt, AVG(hd.hd_dep_count) AS avg_dependency_count, AVG(hd.hd_vehicle_count) AS avg_vehicle_count, wp.wp_type, COUNT(DISTINCT hd.hd_demo_sk) AS unique_households FROM web_sales ws JOIN web_page wp ON ws.ws_web_page_sk = wp.wp_web_page_sk JOIN household_demographics hd ON ws.ws_ship_hdemo_sk = hd.hd_demo_sk JOIN time_dim td ON ws.ws_sold_time_sk = td.t_time_sk JOIN web_site wsit ON ws.ws_web_site_sk = wsit.web_site_sk WHERE wsit.web_gmt_offset = '-5.00' AND wsit.web_site_sk IN (6, 17, 14) AND td.t_time IN (3552, 4450, 1742) AND ws.ws_sales_price BETWEEN 17.54 AND 205.36 AND ws.ws_item_sk IN (51, 14, 107, 50, 104, 108) GROUP BY ws.ws_web_site_sk, wp.wp_type ORDER BY total_revenue DESC;
SELECT r.r_reason_desc AS return_reason, c.c_preferred_cust_flag AS preferred_customer, t.t_am_pm AS purchase_time_period, COUNT(wr.wr_order_number) AS total_returns, SUM(wr.wr_refunded_cash) AS total_refunded_amount, AVG(wr.wr_refunded_cash) AS avg_refunded_amount FROM web_returns wr JOIN reason r ON wr.wr_reason_sk = r.r_reason_sk JOIN customer c ON wr.wr_returning_customer_sk = c.c_customer_sk JOIN catalog_sales cs ON wr.wr_order_number = cs.cs_order_number JOIN time_dim t ON cs.cs_sold_time_sk = t.t_time_sk GROUP BY r.r_reason_desc, c.c_preferred_cust_flag, t.t_am_pm ORDER BY total_refunded_amount DESC, total_returns DESC;
SELECT i_category, ca_state, SUM(sr_return_amt) AS total_return_amount, AVG(sr_return_amt) AS avg_return_amount, COUNT(DISTINCT sr_customer_sk) AS unique_customers_returning, COUNT(*) AS total_returns FROM store_returns sr JOIN item i ON sr.sr_item_sk = i.i_item_sk JOIN store s ON sr.sr_store_sk = s.s_store_sk JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk WHERE ca.ca_gmt_offset IN ('-5.00', '-6.00', '-10.00', '-7.00', '-9.00') AND c.c_birth_month IN (6, 1, 3, 10, 9, 8) AND ca.ca_suite_number IN ('Suite 10', 'Suite I', 'Suite 60', 'Suite 360', 'Suite C', 'Suite 320') GROUP BY i_category, ca_state ORDER BY total_return_amount DESC, unique_customers_returning DESC;
SELECT dd.d_year, dd.d_quarter_name, ca.ca_state, COUNT(cp.cp_catalog_page_sk) AS num_catalog_pages, AVG(dd.d_dom) AS avg_day_of_month, SUM(CASE WHEN dd.d_holiday = 'Y' THEN 1 ELSE 0 END) AS num_holidays, SUM(CASE WHEN dd.d_weekend = 'Y' THEN 1 ELSE 0 END) AS num_weekend_days FROM date_dim dd JOIN catalog_page cp ON dd.d_date_sk BETWEEN cp.cp_start_date_sk AND cp.cp_end_date_sk JOIN customer_address ca ON ca.ca_zip = SUBSTRING(cp.cp_description FROM 1 FOR 10) WHERE dd.d_year IN (1910, 1912, 1908, 1905) AND dd.d_dow IN ('6', '0', '4', '1') AND ca.ca_country = 'United States' AND dd.d_dom BETWEEN 1 AND 15 GROUP BY dd.d_year, dd.d_quarter_name, ca.ca_state ORDER BY dd.d_year, dd.d_quarter_name, ca.ca_state;
SELECT cc_state, SUM(sr_return_amt) AS total_return_amt, AVG(sr_return_amt) AS avg_return_amt, COUNT(*) AS num_returns, SUM(ss_net_profit) AS total_net_profit, AVG(ss_net_profit) AS avg_net_profit, COUNT(DISTINCT ss_customer_sk) AS unique_customers, SUM(wr_return_ship_cost) AS total_return_ship_cost, AVG(wr_return_ship_cost) AS avg_return_ship_cost, COUNT(DISTINCT wr_refunded_customer_sk) AS unique_returned_customers FROM call_center JOIN store_returns ON sr_store_sk = cc_call_center_sk JOIN store_sales ON ss_store_sk = cc_call_center_sk AND store_returns.sr_ticket_number = store_sales.ss_ticket_number JOIN web_returns ON wr_returning_addr_sk = sr_addr_sk WHERE cc_rec_start_date <= CURRENT_DATE AND (cc_rec_end_date IS NULL OR cc_rec_end_date > CURRENT_DATE) AND sr_hdemo_sk IN ('1110', '6655', '2958', '2489', '5750', '5814') AND sr_return_quantity = 36 AND wr_return_ship_cost IN ('460.94', '104.34', '381.68', '830.90') AND wr_returned_time_sk IN ('77442', '66455', '78336', '60895', '70221') AND ss_coupon_amt IN ('1615.93', '743.42') AND ss_net_profit IN ('-1410.96', '-564.39', '-55.72') GROUP BY cc_state ORDER BY total_return_amt DESC;
SELECT cc.cc_call_center_id, cc.cc_name, cc.cc_city, cc.cc_state, SUM(cs.cs_net_paid_inc_tax) AS total_revenue, SUM(cs.cs_net_profit) AS total_profit, AVG(cs.cs_net_paid_inc_tax) AS average_revenue_per_sale, COUNT(DISTINCT cs.cs_order_number) AS total_orders, s.s_store_name, s.s_company_name AS store_company_name FROM call_center cc JOIN catalog_sales cs ON cc.cc_call_center_sk = cs.cs_call_center_sk JOIN store s ON s.s_store_sk = cc.cc_call_center_sk WHERE cc.cc_rec_start_date <= CURRENT_DATE AND (cc.cc_rec_end_date IS NULL OR cc.cc_rec_end_date > CURRENT_DATE) AND s.s_rec_start_date <= CURRENT_DATE AND (s.s_rec_end_date IS NULL OR s.s_rec_end_date > CURRENT_DATE) AND cs.cs_net_paid_inc_tax > 300 GROUP BY cc.cc_call_center_id, cc.cc_name, cc.cc_city, cc.cc_state, s.s_store_name, s.s_company_name ORDER BY total_revenue DESC, total_profit DESC LIMIT 100;
SELECT sm.sm_carrier, COUNT(DISTINCT cs.cs_order_number) AS total_orders, SUM(cs.cs_quantity) AS total_quantity_sold, AVG(cs.cs_sales_price) AS average_sales_price, SUM(cs.cs_net_profit) AS total_profit, COUNT(DISTINCT sr.sr_ticket_number) AS total_returns, SUM(sr.sr_return_quantity) AS total_quantity_returned, AVG(sr.sr_return_amt) AS average_return_amount, SUM(sr.sr_net_loss) AS total_loss, COUNT(DISTINCT ss.ss_ticket_number) AS total_store_sales, SUM(ss.ss_quantity) AS total_store_quantity_sold, AVG(ss.ss_sales_price) AS average_store_sales_price, SUM(ss.ss_net_profit) AS total_store_profit FROM ship_mode sm LEFT JOIN catalog_sales cs ON sm.sm_ship_mode_sk = cs.cs_ship_mode_sk LEFT JOIN store_returns sr ON sr.sr_store_sk = cs.cs_bill_customer_sk LEFT JOIN store_sales ss ON ss.ss_store_sk = sr.sr_store_sk WHERE sm.sm_carrier IN ('UPS', 'BARIAN') AND sm.sm_ship_mode_id IN ('AAAAAAAAOAAAAAAA', 'AAAAAAAADAAAAAAA', 'AAAAAAAAFAAAAAAA', 'AAAAAAAACAAAAAAA') AND cs.cs_bill_hdemo_sk = 3987 AND sr.sr_return_time_sk IN (60750, 41614, 39692, 44726) AND EXISTS (SELECT 1 FROM web_site WHERE web_zip IN ('35709', '31904') AND web_site_sk = cs.cs_warehouse_sk) GROUP BY sm.sm_carrier ORDER BY total_profit DESC, total_loss ASC;
SELECT s_store_name, i_category, cd_gender, cd_education_status, r_reason_desc, COUNT(DISTINCT wr_item_sk) AS unique_items_returned, SUM(wr_return_quantity) AS total_return_quantity, AVG(wr_return_amt) AS avg_return_amount, AVG(i_wholesale_cost) AS avg_wholesale_cost, COUNT(wr_returned_date_sk) AS total_returns FROM web_returns JOIN item ON wr_item_sk = i_item_sk JOIN store ON s_store_sk = wr_returning_addr_sk JOIN customer_demographics ON cd_demo_sk = wr_returning_cdemo_sk JOIN reason ON r_reason_sk = wr_reason_sk JOIN date_dim ON wr_returned_date_sk = d_date_sk JOIN time_dim ON wr_returned_time_sk = t_time_sk WHERE d_year = 2022 AND s_state = 'CA' AND wr_return_amt > 0 AND i_current_price > i_wholesale_cost AND t_shift = 'third' GROUP BY s_store_name, i_category, cd_gender, cd_education_status, r_reason_desc ORDER BY total_return_quantity DESC, avg_return_amount DESC LIMIT 100;
SELECT ca_state, i_category, sm_type, COUNT(DISTINCT c_customer_sk) AS num_customers, SUM(ss_quantity) AS total_quantity_sold, AVG(ss_sales_price) AS avg_sales_price, SUM(ss_net_profit) AS total_net_profit FROM store_sales JOIN customer ON ss_customer_sk = c_customer_sk JOIN item ON ss_item_sk = i_item_sk JOIN ship_mode ON ss_sold_date_sk = sm_ship_mode_sk JOIN customer_address ON c_current_addr_sk = ca_address_sk WHERE ca_gmt_offset IN (-10.00, -6.00, -5.00) AND i_units IN ('Each', 'Dozen', 'Tsp') AND sm_type IN ('REGULAR', 'OVERNIGHT', 'EXPRESS') AND c_first_sales_date_sk IN (2450027, 2449229, 2451727) GROUP BY ca_state, i_category, sm_type ORDER BY total_net_profit DESC, avg_sales_price DESC;
SELECT s_state, i_category, COUNT(DISTINCT i_item_sk) AS num_items, SUM(i_current_price) AS total_current_price, AVG(i_wholesale_cost) AS avg_wholesale_cost, COUNT(DISTINCT w_warehouse_sk) AS num_warehouses, SUM(w_warehouse_sq_ft) AS total_warehouse_sq_ft, COUNT(DISTINCT wp_web_page_sk) AS num_web_pages, AVG(wp_char_count) AS avg_char_count_on_web_pages FROM store JOIN item ON (s_store_sk = i_manufact_id) JOIN warehouse ON (s_zip = w_zip) JOIN web_page ON (wp_access_date_sk = '2452583' OR wp_access_date_sk = '2452565' OR wp_access_date_sk = '2452618') WHERE s_state IN ('CA', 'TX', 'NY') AND i_category IN ('Electronics', 'Clothing', 'Furniture') GROUP BY s_state, i_category ORDER BY s_state, i_category;
SELECT ca.ca_country, hd.hd_buy_potential, COUNT(DISTINCT cr.cr_order_number) AS total_returns, SUM(cr.cr_return_quantity) AS total_returned_quantity, AVG(cr.cr_return_amount) AS avg_return_amount, SUM(cr.cr_return_amount) AS sum_return_amount, SUM(cr.cr_return_ship_cost) AS sum_return_ship_cost, SUM(cr.cr_net_loss) AS sum_net_loss, w.w_warehouse_sq_ft FROM catalog_returns cr JOIN customer_address ca ON cr.cr_returning_addr_sk = ca.ca_address_sk JOIN household_demographics hd ON cr.cr_returning_hdemo_sk = hd.hd_demo_sk JOIN warehouse w ON cr.cr_warehouse_sk = w.w_warehouse_sk WHERE ca.ca_country = 'United States' AND hd.hd_buy_potential IN ('>10000', '5001-10000', '1001-5000', '501-1000', '0-500', 'Unknown') AND w.w_zip = '35709' GROUP BY ca.ca_country, hd.hd_buy_potential, w.w_warehouse_sq_ft ORDER BY sum_return_amount DESC;
SELECT site.web_name AS website_name, COUNT(DISTINCT ss.ss_ticket_number) AS store_sales_transactions, COUNT(DISTINCT ws.ws_order_number) AS web_sales_transactions, SUM(ss.ss_net_paid_inc_tax) AS total_store_sales, SUM(ws.ws_net_paid_inc_ship_tax) AS total_web_sales, AVG(ss.ss_quantity) AS avg_store_quantity_sold, AVG(ws.ws_quantity) AS avg_web_quantity_sold, cp.cp_department AS department, SUM(CASE WHEN ss.ss_hdemo_sk IN (1437, 496, 6460, 2527, 4508, 4026) THEN ss.ss_net_profit ELSE 0 END) AS store_profit_from_selected_hdemo, SUM(CASE WHEN ws.ws_web_site_sk IN (SELECT web_site_sk FROM web_site WHERE web_company_id IN (3, 5, 2)) THEN ws.ws_net_profit ELSE 0 END) AS web_profit_from_selected_companies FROM store_sales ss FULL OUTER JOIN web_sales ws ON ss.ss_item_sk = ws.ws_item_sk AND ss.ss_sold_date_sk = ws.ws_sold_date_sk LEFT JOIN catalog_page cp ON ws.ws_web_page_sk = cp.cp_catalog_page_sk LEFT JOIN web_site site ON ws.ws_web_site_sk = site.web_site_sk WHERE (cp.cp_catalog_page_sk IN (10, 2795, 1844, 4860) OR cp.cp_catalog_page_sk IS NULL) GROUP BY site.web_name, cp.cp_department ORDER BY total_store_sales DESC, total_web_sales DESC;
SELECT cc.cc_city AS call_center_city, cc.cc_state AS call_center_state, SUM(ws.ws_quantity) AS total_quantity_sold, AVG(ws.ws_sales_price) AS average_sales_price, COUNT(DISTINCT ws.ws_order_number) AS number_of_orders, SUM(inv.inv_quantity_on_hand) AS total_inventory_on_hand, SUM(ws.ws_net_profit) AS total_net_profit FROM call_center cc JOIN web_sales ws ON cc.cc_call_center_sk = ws.ws_warehouse_sk JOIN inventory inv ON ws.ws_item_sk = inv.inv_item_sk AND ws.ws_sold_date_sk = inv.inv_date_sk JOIN time_dim td ON ws.ws_sold_time_sk = td.t_time_sk WHERE cc.cc_mkt_id IN ('6', '2', '5') AND cc.cc_suite_number IN ('Suite 70', 'Suite 0', 'Suite U') AND inv.inv_quantity_on_hand IN (645, 327) AND td.t_time_sk IN (247, 1615, 1813, 4029, 3389) AND td.t_hour = 1 GROUP BY call_center_city, call_center_state ORDER BY total_net_profit DESC, call_center_city, call_center_state;
SELECT i.i_category, i.i_class, i.i_brand, COUNT(DISTINCT cs.cs_order_number) AS total_orders, SUM(cs.cs_quantity) AS total_quantity_sold, AVG(cs.cs_sales_price) AS avg_sales_price, SUM(cs.cs_net_paid) AS total_net_paid, SUM(wr.wr_return_quantity) AS total_quantity_returned, SUM(wr.wr_return_amt) AS total_return_amt, AVG(wr.wr_fee) AS avg_return_fee, COUNT(DISTINCT c.c_customer_sk) AS total_customers, SUM(CASE WHEN c.c_preferred_cust_flag = 'Y' THEN cs.cs_net_paid ELSE 0 END) AS preferred_customer_sales, COUNT(DISTINCT CASE WHEN c.c_preferred_cust_flag = 'Y' THEN c.c_customer_sk ELSE NULL END) AS preferred_customer_count FROM item i JOIN catalog_sales cs ON i.i_item_sk = cs.cs_item_sk LEFT JOIN web_returns wr ON cs.cs_item_sk = wr.wr_item_sk AND cs.cs_order_number = wr.wr_order_number JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk GROUP BY i.i_category, i.i_class, i.i_brand ORDER BY total_net_paid DESC, total_return_amt DESC, avg_sales_price DESC LIMIT 100;
SELECT d.d_year, d.d_month_seq, COUNT(DISTINCT cp.cp_catalog_page_sk) AS total_catalog_pages, AVG(w.w_warehouse_sq_ft) AS avg_warehouse_size, SUM(p.p_cost) AS total_promotion_cost, COUNT(DISTINCT ca.ca_state) AS num_states_with_customers, COUNT(DISTINCT w.w_state) AS num_states_with_warehouses, SUM(CASE WHEN p.p_channel_press = 'N' THEN p.p_cost ELSE 0 END) AS total_cost_non_press_channel FROM date_dim d JOIN catalog_page cp ON (d.d_date_sk = cp.cp_start_date_sk OR d.d_date_sk = cp.cp_end_date_sk) JOIN promotion p ON (p.p_start_date_sk = d.d_date_sk OR p.p_end_date_sk = d.d_date_sk) JOIN customer_address ca ON cp.cp_catalog_page_sk = ca.ca_address_sk JOIN warehouse w ON w.w_zip = ca.ca_zip WHERE d.d_fy_quarter_seq IN (41, 35, 15, 54, 14, 9) AND cp.cp_catalog_number IN (27, 41) AND d.d_year = 2023 GROUP BY d.d_year, d.d_month_seq ORDER BY d.d_year, d.d_month_seq;
SELECT ws_site.web_market_manager, SUM(ws.ws_sales_price) AS total_sales, AVG(ws.ws_sales_price) AS average_sales, COUNT(ws.ws_order_number) AS number_of_orders, COUNT(DISTINCT ws.ws_item_sk) AS number_of_items_sold, SUM(sr.sr_return_amt) AS total_returns, AVG(sr.sr_return_amt) AS average_return_amount, COUNT(DISTINCT sr.sr_ticket_number) AS number_of_returns FROM web_sales ws JOIN web_site ws_site ON ws.ws_web_site_sk = ws_site.web_site_sk LEFT JOIN store_returns sr ON ws.ws_bill_customer_sk = sr.sr_customer_sk AND ws.ws_item_sk = sr.sr_item_sk WHERE ws_site.web_open_date_sk IN (2450594, 2450798, 2450747, 2450577, 2450807, 2450645) GROUP BY ws_site.web_market_manager ORDER BY total_sales DESC;
SELECT hd.hd_income_band_sk, COUNT(DISTINCT ss.ss_customer_sk) AS num_customers, SUM(ss.ss_quantity) AS total_quantity_sold, AVG(ss.ss_sales_price) AS avg_sales_price, SUM(ss.ss_net_paid) AS total_net_paid, SUM(ss.ss_net_profit) AS total_net_profit FROM store_sales ss JOIN household_demographics hd ON ss.ss_hdemo_sk = hd.hd_demo_sk JOIN income_band ib ON hd.hd_income_band_sk = ib.ib_income_band_sk JOIN promotion p ON ss.ss_promo_sk = p.p_promo_sk JOIN time_dim t ON ss.ss_sold_time_sk = t.t_time_sk WHERE hd.hd_income_band_sk IN (18, 2) AND t.t_hour BETWEEN 8 AND 17 GROUP BY hd.hd_income_band_sk ORDER BY total_net_profit DESC;
SELECT d.d_year, d.d_quarter_name, COUNT(distinct wp.wp_web_page_sk) AS webpage_count, AVG(sr.sr_return_amt_inc_tax) AS avg_return_amount_inc_tax, SUM(sr.sr_fee) AS total_return_fees, MAX(cp.cp_catalog_page_number) AS max_catalog_page_number, sm.sm_type AS ship_mode_type, COUNT(distinct ib.ib_income_band_sk) AS income_band_count FROM date_dim d LEFT JOIN web_page wp ON d.d_date_sk = wp.wp_access_date_sk LEFT JOIN store_returns sr ON d.d_date_sk = sr.sr_returned_date_sk LEFT JOIN catalog_page cp ON (d.d_date_sk >= cp.cp_start_date_sk AND d.d_date_sk <= cp.cp_end_date_sk) LEFT JOIN ship_mode sm ON sr.sr_return_ship_cost BETWEEN 36.08 AND 716.95 LEFT JOIN income_band ib ON sr.sr_return_amt_inc_tax BETWEEN ib.ib_lower_bound AND ib.ib_upper_bound WHERE d.d_current_quarter = 'N' AND d.d_year = 2022 AND sm.sm_contract IN ('UaAJjKDnL4gTOqbpj', 'O9V6oF8RJnLMmZYd1', 'fop0bcSd91J26IVpR', 'A5BYO1qH8HGTTN', '5FKNB0j8aaqTB') AND cp.cp_catalog_page_id IN ('AAAAAAAAAEIAAAAA', 'AAAAAAAAMNNAAAAA') GROUP BY d.d_year, d.d_quarter_name, sm.sm_type ORDER BY d.d_year, d.d_quarter_name;
SELECT cc.cc_name, cc.cc_city, cc.cc_state, SUM(ss.ss_quantity) AS total_quantity_sold, AVG(ss.ss_sales_price) AS average_sales_price, COUNT(DISTINCT c.c_customer_sk) AS unique_customers, MAX(ss.ss_net_paid_inc_tax) AS max_payment_received, MIN(ss.ss_net_paid_inc_tax) AS min_payment_received FROM call_center cc JOIN store_sales ss ON cc.cc_call_center_sk = ss.ss_store_sk JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk WHERE cc.cc_rec_start_date BETWEEN '1998-01-01' AND '2001-01-01' AND cc.cc_mkt_desc LIKE '%Rich groups catch longer other fears; future,%' GROUP BY cc.cc_name, cc.cc_city, cc.cc_state ORDER BY total_quantity_sold DESC, average_sales_price DESC;
SELECT ws.ws_web_site_sk, COUNT(DISTINCT ws.ws_order_number) AS total_orders, SUM(ws.ws_quantity) AS total_quantity_sold, AVG(ws.ws_sales_price) AS average_sales_price, SUM(ws.ws_net_paid) AS total_net_paid, SUM(ws.ws_net_profit) AS total_net_profit, ws_site.web_tax_percentage, cd.cd_gender, cd.cd_marital_status, cd.cd_education_status, COUNT(cd.cd_dep_college_count) AS total_college_dependents FROM web_sales ws JOIN web_site ws_site ON ws.ws_web_site_sk = ws_site.web_site_sk JOIN customer_demographics cd ON ws.ws_bill_cdemo_sk = cd.cd_demo_sk WHERE ws.ws_sales_price BETWEEN 6.61 AND 60.51 AND ws_site.web_tax_percentage IN ('0.07', '0.02') AND ws_site.web_zip IN ('35709', '31904') AND ws.ws_sold_date_sk IS NOT NULL AND ws.ws_sold_time_sk IS NOT NULL GROUP BY ws.ws_web_site_sk, ws_site.web_tax_percentage, cd.cd_gender, cd.cd_marital_status, cd.cd_education_status ORDER BY ws.ws_web_site_sk, cd.cd_gender, cd.cd_marital_status, cd.cd_education_status;
SELECT ca.ca_city, COUNT(DISTINCT cs.cs_order_number) AS total_orders, SUM(cs.cs_quantity) AS total_quantity, AVG(cs.cs_sales_price) AS average_sales_price, SUM(cs.cs_net_paid) AS total_net_paid, SUM(cs.cs_net_profit) AS total_net_profit, COUNT(DISTINCT c.c_customer_sk) AS unique_customers, SUM(CASE WHEN p.p_channel_tv = 'N' THEN cs.cs_net_paid_inc_tax ELSE 0 END) AS net_paid_no_tv_promo, AVG(cs.cs_ext_ship_cost) AS average_shipping_cost FROM catalog_sales cs JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk LEFT JOIN promotion p ON cs.cs_promo_sk = p.p_promo_sk WHERE ca.ca_city IN ('Murphy', 'Hubbard', 'Mount Olive') AND c.c_email_address IN ( 'Joe.Singer@R26XcAkIUF5.org', 'Johanna.Ross@EiP23U7Cb5aeav.org', 'Laurie.Johnson@0P2bV5aT.org', 'Jeanne.Clark@v1rrdNtTL7dd0hh.org' ) GROUP BY ca.ca_city ORDER BY total_net_paid DESC;
