SELECT cc.cc_name, cc.cc_city, cc.cc_state, COUNT(*) AS number_of_promotions, SUM(inv.inv_quantity_on_hand) AS total_inventory, AVG(p.p_cost) AS average_promotion_cost, SUM(CASE WHEN p.p_discount_active = 'Y' THEN 1 ELSE 0 END) AS active_discounts FROM call_center cc JOIN promotion p ON cc.cc_call_center_sk = p.p_item_sk JOIN inventory inv ON p.p_item_sk = inv.inv_item_sk WHERE cc.cc_rec_end_date = '2000-12-31' AND inv.inv_date_sk = 2450815 AND inv.inv_quantity_on_hand IN (104, 11, 180) AND cc.cc_employees IN (1, 2, 3) GROUP BY cc.cc_name, cc.cc_city, cc.cc_state ORDER BY cc.cc_name, cc.cc_city, cc.cc_state;
SELECT hd.hd_buy_potential, AVG(ss.ss_sales_price) AS avg_sales_price, SUM(ss.ss_quantity) AS total_quantity_sold, COUNT(DISTINCT ss.ss_customer_sk) AS unique_customers, SUM(sr.sr_return_amt_inc_tax) AS total_return_amount_incl_tax, COUNT(DISTINCT sr.sr_customer_sk) AS unique_customers_returned FROM store_sales ss LEFT JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk LEFT JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk LEFT JOIN store_returns sr ON ss.ss_customer_sk = sr.sr_customer_sk AND ss.ss_item_sk = sr.sr_item_sk GROUP BY hd.hd_buy_potential ORDER BY total_return_amount_incl_tax DESC;
SELECT i.i_category, i.i_class, call_center.cc_name, SUM(cr.cr_return_amount) AS total_return_amount, AVG(cr.cr_return_quantity) AS avg_return_quantity, COUNT(DISTINCT cr.cr_order_number) AS total_returned_orders, MAX(i.i_current_price) AS max_item_price FROM catalog_returns cr JOIN call_center ON cr.cr_call_center_sk = call_center.cc_call_center_sk JOIN item i ON cr.cr_item_sk = i.i_item_sk WHERE i.i_manufact = 'barcallycally' GROUP BY i.i_category, i.i_class, call_center.cc_name ORDER BY total_return_amount DESC, i.i_category, i.i_class, call_center.cc_name;
SELECT cp.cp_department, SUM(ws.ws_net_profit) AS total_web_sales_profit, AVG(ws.ws_quantity) AS avg_web_sales_quantity, COUNT(DISTINCT ws.ws_order_number) AS total_web_orders, SUM(cr.cr_net_loss) AS total_catalog_returns_loss, AVG(cr.cr_return_quantity) AS avg_catalog_return_quantity, COUNT(DISTINCT cr.cr_order_number) AS total_catalog_returns, SUM(sr.sr_net_loss) AS total_store_returns_loss, AVG(sr.sr_return_quantity) AS avg_store_return_quantity, COUNT(DISTINCT sr.sr_ticket_number) AS total_store_returns, SUM(CASE WHEN p.p_channel_dmail = 'Y' THEN p.p_cost ELSE 0 END) AS total_promo_cost_via_dmail, COUNT(CASE WHEN p.p_channel_demo = 'N' AND p.p_channel_catalog = 'N' THEN p.p_promo_sk END) AS count_non_demo_catalog_promos FROM catalog_page cp LEFT JOIN web_sales ws ON cp.cp_catalog_page_sk = ws.ws_web_page_sk LEFT JOIN catalog_returns cr ON cp.cp_catalog_page_sk = cr.cr_catalog_page_sk LEFT JOIN store_returns sr ON sr.sr_item_sk = ws.ws_item_sk LEFT JOIN promotion p ON ws.ws_promo_sk = p.p_promo_sk WHERE cp.cp_start_date_sk IS NOT NULL AND cp.cp_end_date_sk IS NOT NULL AND ws.ws_sold_date_sk BETWEEN cp.cp_start_date_sk AND cp.cp_end_date_sk GROUP BY cp.cp_department ORDER BY total_web_sales_profit DESC, total_catalog_returns_loss ASC, total_store_returns_loss ASC;
SELECT c.c_customer_id, hd.hd_buy_potential, COUNT(*) AS number_of_customers, AVG(hd.hd_vehicle_count) AS average_vehicle_count, SUM(hd.hd_dep_count) AS total_dependents, sm.sm_type AS shipping_type, COUNT(DISTINCT sm.sm_carrier) AS number_of_unique_carriers FROM customer c JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk JOIN ship_mode sm ON sm.sm_code = c.c_login WHERE c.c_birth_year > 1980 AND c.c_preferred_cust_flag = 'Y' AND sm.sm_code IN ('BIKE', 'SURFACE', 'SEA') GROUP BY c.c_customer_id, hd.hd_buy_potential, sm.sm_type HAVING COUNT(*) > 1 ORDER BY number_of_customers DESC, average_vehicle_count DESC LIMIT 100;
SELECT dd.d_year, ca.ca_country, ca.ca_state, sm.sm_type, COUNT(DISTINCT hd.hd_demo_sk) AS number_of_households, AVG(hd.hd_vehicle_count) AS avg_vehicles_per_household, SUM(inv.inv_quantity_on_hand) AS total_inventory_on_hand FROM inventory inv JOIN date_dim dd ON inv.inv_date_sk = dd.d_date_sk JOIN customer_address ca ON inv.inv_warehouse_sk = ca.ca_address_sk JOIN household_demographics hd ON ca.ca_address_sk = hd.hd_demo_sk JOIN ship_mode sm ON sm.sm_ship_mode_sk = inv.inv_warehouse_sk WHERE dd.d_current_month = 'N' AND hd.hd_vehicle_count IN (0, 3) GROUP BY dd.d_year, ca.ca_country, ca.ca_state, sm.sm_type ORDER BY total_inventory_on_hand DESC, avg_vehicles_per_household DESC;
SELECT p.p_promo_name, COUNT(DISTINCT sr.sr_customer_sk) AS number_of_customers, COUNT(sr.sr_ticket_number) AS number_of_returns, SUM(sr.sr_return_quantity) AS total_returned_quantity, SUM(sr.sr_return_amt) AS total_return_amount, AVG(hd.hd_vehicle_count) AS avg_vehicles_per_household, ib.ib_lower_bound AS income_band_lower_bound, ib.ib_upper_bound AS income_band_upper_bound, COUNT(DISTINCT cd.cd_demo_sk) AS number_of_unique_customers_demographics, SUM(CASE WHEN cd.cd_gender = 'M' THEN 1 ELSE 0 END) AS male_customer_count, SUM(CASE WHEN cd.cd_gender = 'F' THEN 1 ELSE 0 END) AS female_customer_count, SUM(CASE WHEN cd.cd_credit_rating = 'Low Risk' THEN 1 ELSE 0 END) AS low_risk_credit_customers, SUM(CASE WHEN cd.cd_credit_rating = 'High Risk' THEN 1 ELSE 0 END) AS high_risk_credit_customers FROM store_returns sr JOIN promotion p ON sr.sr_reason_sk = p.p_promo_sk AND p.p_channel_catalog = 'N' LEFT JOIN customer_demographics cd ON sr.sr_cdemo_sk = cd.cd_demo_sk LEFT JOIN household_demographics hd ON sr.sr_hdemo_sk = hd.hd_demo_sk LEFT JOIN income_band ib ON hd.hd_income_band_sk = ib.ib_income_band_sk WHERE p.p_purpose = 'Unknown' AND ib.ib_income_band_sk IN (19, 7, 13, 8, 15, 10) AND sr.sr_customer_sk IN (77634, 47097) AND cd.cd_credit_rating IN ('Low Risk', 'High Risk', 'Unknown') GROUP BY p.p_promo_name, ib.ib_lower_bound, ib.ib_upper_bound ORDER BY total_return_amount DESC;
SELECT w_state, AVG(w_warehouse_sq_ft) AS avg_warehouse_sq_ft, SUM(inv_quantity_on_hand) AS total_inventory_on_hand, AVG(sr_return_amt) AS avg_return_amt, SUM(sr_net_loss) AS total_net_loss FROM warehouse w JOIN inventory i ON w.w_warehouse_sk = i.inv_warehouse_sk JOIN store_returns sr ON i.inv_item_sk = sr.sr_item_sk GROUP BY w_state ORDER BY w_state;
SELECT ca.ca_state, sm.sm_type, ws.ws_web_site_sk, COUNT(DISTINCT ws.ws_order_number) AS total_orders, SUM(ws.ws_quantity) AS total_quantity, AVG(ws.ws_sales_price) AS average_sales_price, SUM(ws.ws_net_paid) AS total_net_paid, SUM(ws.ws_net_profit) AS total_net_profit FROM web_sales ws JOIN customer_address ca ON ws.ws_ship_addr_sk = ca.ca_address_sk JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk JOIN date_dim dd ON ws.ws_sold_date_sk = dd.d_date_sk WHERE ca.ca_state IN ('CT', 'SD') AND sm.sm_type = 'OVERNIGHT' AND ws.ws_web_site_sk IN (SELECT web_site_sk FROM web_site WHERE web_market_manager = 'John Doe') AND dd.d_year = 2023 AND dd.d_moy BETWEEN 1 AND 6 GROUP BY ca.ca_state, sm.sm_type, ws.ws_web_site_sk ORDER BY total_net_profit DESC;
SELECT ca_state, SUM(cr_return_amount) AS total_return_amount, AVG(cr_return_amount) AS avg_return_amount, COUNT(*) AS return_count, SUM(ss_net_profit) AS total_store_sales_profit, AVG(ss_net_profit) AS avg_store_sales_profit, COUNT(DISTINCT ss_customer_sk) AS store_customer_count, SUM(ws_net_profit) AS total_web_sales_profit, AVG(ws_net_profit) AS avg_web_sales_profit, COUNT(DISTINCT ws_bill_customer_sk) AS web_customer_count FROM catalog_returns JOIN customer_address ON cr_returning_addr_sk = ca_address_sk JOIN store_sales ON catalog_returns.cr_item_sk = store_sales.ss_item_sk JOIN web_sales ON catalog_returns.cr_item_sk = web_sales.ws_item_sk JOIN promotion ON store_sales.ss_promo_sk = promotion.p_promo_sk AND web_sales.ws_promo_sk = promotion.p_promo_sk JOIN household_demographics ON (catalog_returns.cr_returning_hdemo_sk = household_demographics.hd_demo_sk OR store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk OR web_sales.ws_ship_hdemo_sk = household_demographics.hd_demo_sk) WHERE promotion.p_channel_demo = 'N' AND household_demographics.hd_income_band_sk IN (8, 10) AND household_demographics.hd_buy_potential IN ('>10000', 'Unknown', '0-500', '5001-10000', '1001-5000', '501-1000') AND catalog_returns.cr_reason_sk IN (9, 32, 23, 19) AND promotion.p_end_date_sk IN (2450545, 2450776) GROUP BY ca_state ORDER BY total_return_amount DESC;
SELECT i.i_item_id, i.i_item_desc, s.s_state, SUM(ss.ss_quantity) AS total_sales_quantity, AVG(ss.ss_quantity) AS average_sales_quantity, COUNT(DISTINCT ss.ss_ticket_number) AS sales_transactions_count, SUM(sr.sr_return_quantity) AS total_returns_quantity, AVG(sr.sr_return_quantity) AS average_returns_quantity, COUNT(DISTINCT sr.sr_ticket_number) AS returns_transactions_count, SUM(sr.sr_return_amt_inc_tax) AS total_returns_amount_inc_tax, AVG(sr.sr_return_ship_cost) AS average_return_ship_cost FROM store_sales ss JOIN item i ON ss.ss_item_sk = i.i_item_sk JOIN store s ON ss.ss_store_sk = s.s_store_sk JOIN store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_store_sk = sr.sr_store_sk JOIN time_dim t ON ss.ss_sold_time_sk = t.t_time_sk WHERE s.s_market_desc IN ('Events develop i', 'Little expectations include yet forward meetings.') AND i.i_current_price > 10 AND t.t_shift = 'third' AND sr.sr_return_tax > 3.00 GROUP BY i.i_item_id, i.i_item_desc, s.s_state ORDER BY total_sales_quantity DESC, total_returns_quantity DESC LIMIT 100;
