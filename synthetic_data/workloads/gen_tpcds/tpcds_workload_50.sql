SELECT s.s_store_name, s.s_city, s.s_state, ib.ib_income_band_sk, ib.ib_lower_bound, ib.ib_upper_bound, COUNT(DISTINCT ws.ws_order_number) AS total_orders, SUM(ws.ws_quantity) AS total_quantity_sold, SUM(ws.ws_net_paid) AS total_net_paid, AVG(ws.ws_net_profit) AS average_net_profit, COUNT(DISTINCT cr.cr_order_number) AS total_returns, SUM(cr.cr_return_amount) AS total_return_amount, AVG(cd.cd_purchase_estimate) AS average_purchase_estimate, COUNT(DISTINCT wp.wp_web_page_sk) AS total_web_page_visits FROM store s JOIN web_sales ws ON s.s_store_sk = ws.ws_ship_addr_sk JOIN income_band ib ON ws.ws_bill_customer_sk = ib.ib_income_band_sk JOIN catalog_returns cr ON ws.ws_item_sk = cr.cr_item_sk AND ws.ws_order_number = cr.cr_order_number JOIN customer_demographics cd ON ws.ws_bill_cdemo_sk = cd.cd_demo_sk JOIN web_page wp ON ws.ws_web_page_sk = wp.wp_web_page_sk JOIN date_dim dd ON ws.ws_sold_date_sk = dd.d_date_sk WHERE ws.ws_ext_ship_cost IN (176.54, 380.00, 2131.08) AND ws.ws_ext_wholesale_cost IN (1606.13, 264.04, 476.93) AND ib.ib_income_band_sk IN (6, 20, 17) AND ib.ib_upper_bound IN (30000, 50000, 70000) AND s.s_city IN ('Fairview', 'Midway') AND s.s_market_manager IN ('Thomas Benton', 'Dustin Kelly', 'Dean Morrison') AND s.s_suite_number IN ('Suite 410', 'Suite 190', 'Suite 100') AND cr.cr_ship_mode_sk IN (5, 14, 16) AND cr.cr_item_sk IN (13561, 12757, 9220) AND cr.cr_returning_addr_sk IN (8108, 14295, 7472) AND dd.d_following_holiday IN ('N', 'Y') AND dd.d_dow IN (6, 2, 4) AND dd.d_current_year = 'N' AND wp.wp_access_date_sk IN (2452580, 2452611, 2452576) AND wp.wp_image_count IN (3, 7, 4) AND cd.cd_purchase_estimate IN (500, 2000, 3000) AND cd.cd_education_status IN ('4 yr Degree', 'Secondary', '2 yr Degree') AND cd.cd_dep_count IN (2, 1) GROUP BY s.s_store_name, s.s_city, s.s_state, ib.ib_income_band_sk, ib.ib_lower_bound, ib.ib_upper_bound ORDER BY total_net_paid DESC, average_net_profit DESC, total_web_page_visits DESC LIMIT 100;
SELECT ca_state, SUM(cs_quantity) AS total_quantity, AVG(cs_sales_price) AS avg_sales_price, COUNT(DISTINCT cs_order_number) AS total_orders, SUM(wr_return_amt_inc_tax) AS total_return_amount_inc_tax, COUNT(DISTINCT wr_order_number) AS total_return_orders FROM catalog_sales JOIN customer_address ON cs_ship_addr_sk = ca_address_sk JOIN warehouse ON cs_warehouse_sk = w_warehouse_sk JOIN web_returns ON cs_item_sk = wr_item_sk AND cs_order_number = wr_order_number JOIN time_dim ON cs_sold_time_sk = t_time_sk JOIN reason ON wr_reason_sk = r_reason_sk WHERE t_am_pm = 'AM' AND r_reason_id IN ('AAAAAAAAMBAAAAAA', 'AAAAAAAAPAAAAAAA', 'AAAAAAAAFBAAAAAA', 'AAAAAAAALAAAAAAA') AND cs_bill_addr_sk IN ('23752', '34909', '20802', '37622', '45921') AND ca_state IN ('IL', 'KY', 'OR', 'VA', 'FL', 'AL', 'OK', 'IA', 'TX') GROUP BY ca_state ORDER BY total_quantity DESC, total_return_amount_inc_tax DESC;
SELECT dd.d_year, dd.d_quarter_name, ca.ca_state, COUNT(DISTINCT ws.ws_order_number) AS total_orders, SUM(ws.ws_quantity) AS total_quantity, SUM(ws.ws_net_paid) AS total_net_paid, AVG(ws.ws_sales_price) AS average_sales_price, SUM(ws.ws_net_profit) AS total_net_profit FROM web_sales ws JOIN date_dim dd ON ws.ws_sold_date_sk = dd.d_date_sk JOIN customer_address ca ON ws.ws_bill_addr_sk = ca.ca_address_sk WHERE dd.d_year = 2002 AND ca.ca_country = 'United States' AND ws.ws_net_paid_inc_ship_tax > 1000 GROUP BY dd.d_year, dd.d_quarter_name, ca.ca_state ORDER BY dd.d_year, dd.d_quarter_name, ca.ca_state;
SELECT sm.sm_type AS ship_mode_type, s.s_state AS store_state, COUNT(DISTINCT cr.cr_order_number) AS num_returns, SUM(cr.cr_return_amount) AS total_return_amount, AVG(cr.cr_return_quantity) AS avg_return_quantity, COUNT(DISTINCT ss.ss_ticket_number) AS num_sales, SUM(ss.ss_net_paid) AS total_sales_net_paid, SUM(ss.ss_quantity) AS total_quantity_sold, AVG(ss.ss_sales_price) AS avg_sales_price FROM catalog_returns cr JOIN catalog_page cp ON cr.cr_catalog_page_sk = cp.cp_catalog_page_sk JOIN ship_mode sm ON cr.cr_ship_mode_sk = sm.sm_ship_mode_sk JOIN store_sales ss ON ss.ss_store_sk = cr.cr_returning_customer_sk JOIN store s ON ss.ss_store_sk = s.s_store_sk WHERE cp.cp_type = 'monthly' GROUP BY sm.sm_type, s.s_state ORDER BY total_return_amount DESC, total_sales_net_paid DESC;
SELECT ws.ws_web_site_sk, AVG(ws.ws_sales_price) AS avg_sales_price, COUNT(ws.ws_order_number) AS total_orders, AVG(ws.ws_quantity) AS avg_quantity, SUM(ws.ws_net_paid_inc_tax) AS total_revenue, SUM(ws.ws_net_paid) AS total_net_paid, SUM(ws.ws_coupon_amt) AS total_coupon_amt, AVG(hd.hd_dep_count) AS avg_dependency_count, AVG(hd.hd_vehicle_count) AS avg_vehicle_count, wp.wp_type, COUNT(DISTINCT hd.hd_demo_sk) AS unique_households FROM web_sales ws JOIN web_page wp ON ws.ws_web_page_sk = wp.wp_web_page_sk JOIN household_demographics hd ON ws.ws_ship_hdemo_sk = hd.hd_demo_sk JOIN time_dim td ON ws.ws_sold_time_sk = td.t_time_sk JOIN web_site wsit ON ws.ws_web_site_sk = wsit.web_site_sk WHERE wsit.web_gmt_offset = '-5.00' AND wsit.web_site_sk IN (6, 17, 14) AND td.t_time IN (3552, 4450, 1742) AND ws.ws_sales_price BETWEEN 17.54 AND 205.36 AND ws.ws_item_sk IN (51, 14, 107, 50, 104, 108) GROUP BY ws.ws_web_site_sk, wp.wp_type ORDER BY total_revenue DESC;
SELECT s_store_name, COUNT(DISTINCT ws_order_number) AS total_web_sales_orders, SUM(ws_net_paid) AS total_web_sales_revenue, AVG(ws_quantity) AS avg_web_sales_quantity, SUM(sr_return_amt) AS total_store_returns_revenue, AVG(sr_return_quantity) AS avg_store_returns_quantity, COUNT(DISTINCT cr_order_number) AS total_catalog_returns_orders, SUM(cr_return_amount) AS total_catalog_returns_revenue, AVG(cr_return_quantity) AS avg_catalog_returns_quantity FROM web_sales JOIN store ON ws_ship_customer_sk = s_store_sk JOIN store_returns ON sr_store_sk = s_store_sk JOIN catalog_returns ON cr_catalog_page_sk IN (SELECT cp_catalog_page_sk FROM catalog_page WHERE cp_type = 'monthly') JOIN ship_mode ON web_sales.ws_ship_mode_sk = ship_mode.sm_ship_mode_sk WHERE ws_sold_date_sk BETWEEN 2452235 AND 2452629 AND sr_returned_date_sk = ws_sold_date_sk AND cr_returned_date_sk = ws_sold_date_sk AND ws_net_paid_inc_ship_tax > 7000 AND sm_type IN ('OVERNIGHT', 'REGULAR') GROUP BY s_store_name ORDER BY total_web_sales_revenue DESC;
SELECT c.c_first_name, c.c_last_name, SUM(ss.ss_net_paid) AS total_sales, AVG(ss.ss_quantity) AS average_quantity, COUNT(DISTINCT ss.ss_ticket_number) AS total_transactions, i.i_category, s.s_store_name, sm.sm_type FROM store_sales ss JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk JOIN item i ON ss.ss_item_sk = i.i_item_sk JOIN store s ON ss.ss_store_sk = s.s_store_sk JOIN ship_mode sm ON sm.sm_ship_mode_sk = ss.ss_sold_date_sk WHERE c.c_customer_sk IN (179, 972, 3529, 2285, 1595) AND i.i_units = 'Tsp' AND s.s_division_name = 'Unknown' AND ss.ss_sold_date_sk BETWEEN 20000101 AND 20001231 GROUP BY c.c_first_name, c.c_last_name, i.i_category, s.s_store_name, sm.sm_type ORDER BY total_sales DESC, c.c_last_name ASC, c.c_first_name ASC;
SELECT s.s_division_name, AVG(s.s_floor_space) AS avg_floor_space, AVG(s.s_number_employees) AS avg_number_employees, AVG(ib.ib_upper_bound) AS avg_income_upper_bound, COUNT(wp.wp_web_page_sk) AS web_page_count, SUM(wp.wp_image_count) AS total_image_count, SUM(wp.wp_link_count) AS total_link_count FROM store AS s INNER JOIN income_band AS ib ON s.s_store_sk = ib.ib_income_band_sk LEFT JOIN web_page AS wp ON wp.wp_customer_sk = s.s_store_sk WHERE s.s_rec_start_date >= '2020-01-01' AND (s.s_rec_end_date IS NULL OR s.s_rec_end_date <= '2023-01-01') AND ib.ib_upper_bound BETWEEN 60000 AND 190000 AND wp.wp_type = 'monthly' GROUP BY s.s_division_name ORDER BY avg_floor_space DESC, avg_number_employees DESC;
SELECT r.r_reason_desc, COUNT(DISTINCT sr.sr_ticket_number) AS num_store_returns, SUM(sr.sr_refunded_cash) AS total_store_refunded, AVG(sr.sr_return_amt_inc_tax) AS avg_store_return, COUNT(DISTINCT cr.cr_order_number) AS num_catalog_returns, SUM(cr.cr_refunded_cash) AS total_catalog_refunded, AVG(cr.cr_return_amt_inc_tax) AS avg_catalog_return FROM store_returns sr FULL OUTER JOIN catalog_returns cr ON sr.sr_reason_sk = cr.cr_reason_sk JOIN reason r ON r.r_reason_sk = sr.sr_reason_sk OR r.r_reason_sk = cr.cr_reason_sk LEFT JOIN warehouse w ON cr.cr_warehouse_sk = w.w_warehouse_sk WHERE (sr.sr_customer_sk IN (67809, 3762, 6067) OR cr.cr_returning_hdemo_sk IN (6684, 3972, 3528, 1943, 4100, 4193)) AND (r.r_reason_id IN ('AAAAAAAANBAAAAAA', 'AAAAAAAADCAAAAAA', 'AAAAAAAAACAAAAAA', 'AAAAAAAAIAAAAAAA', 'AAAAAAAAFBAAAAAA', 'AAAAAAAAOBAAAAAA')) AND w.w_street_number = '651' AND w.w_county = 'Williamson County' GROUP BY r.r_reason_desc ORDER BY total_store_refunded DESC, total_catalog_refunded DESC;
SELECT d_year, d_quarter_name, SUM(cs_net_profit) AS total_profit, AVG(cs_quantity) AS average_quantity, COUNT(DISTINCT cs_order_number) AS total_orders, COUNT(DISTINCT sr_ticket_number) AS total_returns, SUM(sr_net_loss) AS total_return_loss, AVG(sr_return_quantity) AS average_return_quantity, COUNT(DISTINCT c_customer_sk) AS total_customers FROM date_dim JOIN catalog_sales ON cs_sold_date_sk = d_date_sk JOIN store_returns ON sr_returned_date_sk = d_date_sk JOIN customer ON (cs_bill_customer_sk = c_customer_sk OR sr_customer_sk = c_customer_sk) JOIN web_site ON c_first_shipto_date_sk = web_open_date_sk WHERE d_moy IN (5, 1, 6) AND web_close_date_sk IN (2448854, 2446944, 2448752) AND sr_returned_date_sk IN (2451779, 2451809) AND c_first_shipto_date_sk IN (2450817, 2450990, 2450273, 2449359, 2449289, 2449658) AND c_first_name IN ('Alecia', 'Allen', 'Deanne') GROUP BY d_year, d_quarter_name ORDER BY d_year, d_quarter_name;
