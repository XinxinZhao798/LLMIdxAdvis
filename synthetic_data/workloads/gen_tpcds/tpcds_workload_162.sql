SELECT dd.d_year, dd.d_quarter_name, COUNT(DISTINCT ws.ws_order_number) AS total_web_orders, SUM(ws.ws_quantity) AS total_web_quantity_sold, SUM(ws.ws_net_paid) AS total_web_net_paid, COUNT(DISTINCT cs.cs_order_number) AS total_catalog_orders, SUM(cs.cs_quantity) AS total_catalog_quantity_sold, SUM(cs.cs_net_paid) AS total_catalog_net_paid, SUM(cr.cr_return_quantity) AS total_returned_quantity, SUM(cr.cr_return_amount) AS total_return_amount, SUM(cr.cr_fee) AS total_return_fees, SUM(cr.cr_net_loss) AS total_net_loss FROM date_dim dd LEFT JOIN web_sales ws ON ws.ws_sold_date_sk = dd.d_date_sk LEFT JOIN catalog_sales cs ON cs.cs_sold_date_sk = dd.d_date_sk LEFT JOIN catalog_returns cr ON cr.cr_returned_date_sk = dd.d_date_sk WHERE dd.d_year = 2003 GROUP BY dd.d_year, dd.d_quarter_name ORDER BY dd.d_year, dd.d_quarter_name;
SELECT s.s_store_id, s.s_store_name, d.d_year, COUNT(DISTINCT c.c_customer_sk) AS total_customers, SUM(CASE WHEN c.c_preferred_cust_flag = 'Y' THEN 1 ELSE 0 END) AS preferred_customers, AVG(s.s_number_employees) AS average_employees, AVG(s.s_floor_space) AS average_floor_space, SUM(s.s_tax_precentage) AS total_tax_percentage FROM store s JOIN customer c ON s.s_store_sk = c.c_current_addr_sk JOIN date_dim d ON c.c_first_sales_date_sk = d.d_date_sk WHERE s.s_division_name <> 'Unknown' AND c.c_last_review_date_sk IN ('2452522', '2452308', '2452629', '2452335', '2452592', '2452622') AND c.c_first_name IN ('Tyler', 'Rhona', 'Mohammad') AND d.d_last_dom IN ('2417208', '2418853') AND d.d_following_holiday = 'Y' GROUP BY s.s_store_id, s.s_store_name, d.d_year ORDER BY total_customers DESC, preferred_customers DESC, average_employees DESC, average_floor_space DESC, total_tax_percentage DESC;
SELECT ca.ca_state, COUNT(DISTINCT c.c_customer_sk) AS total_customers, AVG(s.s_floor_space) AS average_store_floor_space, SUM(s.s_number_employees) AS total_employees, COUNT(DISTINCT w.web_site_sk) AS total_websites, AVG(w.web_tax_percentage) AS average_web_tax_percentage FROM customer_address ca JOIN customer c ON ca.ca_address_sk = c.c_current_addr_sk JOIN store s ON ca.ca_state = s.s_state JOIN web_site w ON w.web_state = ca.ca_state WHERE c.c_preferred_cust_flag = 'Y' AND c.c_birth_year BETWEEN 1933 AND 1975 AND s.s_company_id = 1 AND w.web_open_date_sk IN ('2450730', '2450747') GROUP BY ca.ca_state ORDER BY total_customers DESC;
SELECT c_birth_country, cd_gender, cd_marital_status, cd_education_status, AVG(cd_purchase_estimate) AS avg_purchase_estimate, COUNT(DISTINCT c_customer_sk) AS total_customers, SUM(inv_quantity_on_hand) AS total_inventory, COUNT(DISTINCT wr_order_number) AS total_returns, AVG(wr_return_amt_inc_tax) AS avg_return_amount_inc_tax, SUM(wr_fee) AS total_return_fees FROM customer c JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk JOIN inventory inv ON inv.inv_date_sk = '2450815' JOIN web_returns wr ON wr.wr_refunded_customer_sk = c.c_customer_sk JOIN web_page wp ON wp.wp_web_page_sk = wr.wr_web_page_sk AND wp.wp_max_ad_count IN ('0', '1') JOIN time_dim t ON t.t_time_sk = wr.wr_returned_time_sk AND t.t_time_id IN ('AAAAAAAALDIAAAAA', 'AAAAAAAAPEJAAAAA', 'AAAAAAAAKMNAAAAA', 'AAAAAAAAIHFAAAAA', 'AAAAAAAAOEBBAAAA', 'AAAAAAAALNDAAAAA') JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk WHERE cd.cd_marital_status IN ('D', 'M', 'U', 'S', 'W') AND cd.cd_gender = 'M' GROUP BY c_birth_country, cd_gender, cd_marital_status, cd_education_status ORDER BY avg_purchase_estimate DESC, total_customers DESC LIMIT 100;
SELECT cc.cc_state, cc.cc_city, cc.cc_name, AVG(ss.ss_net_profit) AS avg_net_profit, SUM(ss.ss_quantity) AS total_quantity_sold, COUNT(DISTINCT ss.ss_store_sk) AS number_of_stores, COUNT(DISTINCT ss.ss_ticket_number) AS number_of_sales_transactions, SUM(cc.cc_employees) AS total_employees_in_call_centers, AVG(cc.cc_tax_percentage) AS avg_tax_percentage_by_state FROM store_sales ss JOIN call_center cc ON ss.ss_store_sk = cc.cc_call_center_sk JOIN time_dim td ON ss.ss_sold_time_sk = td.t_time_sk WHERE ss.ss_sold_date_sk IN (SELECT inv_date_sk FROM inventory WHERE inv_quantity_on_hand IN (816, 142, 984)) AND cc.cc_tax_percentage IN (0.01, 0.12, 0.05, 0.11) AND ss.ss_net_profit IN (5.76, 45.76, 66.12, -885.72, -4074.40) AND ss.ss_hdemo_sk IN (7132, 594, 6065, 5700) GROUP BY cc.cc_state, cc.cc_city, cc.cc_name ORDER BY avg_net_profit DESC;
SELECT i.i_category, cc.cc_mkt_class, SUM(cs.cs_net_paid) AS total_sales, AVG(cs.cs_sales_price) AS avg_sales_price, SUM(cs.cs_quantity) AS total_quantity_sold, AVG(cs.cs_wholesale_cost) AS avg_wholesale_cost FROM catalog_sales cs JOIN item i ON cs.cs_item_sk = i.i_item_sk JOIN call_center cc ON cs.cs_call_center_sk = cc.cc_call_center_sk WHERE cc.cc_name IN ('North Midwest', 'Mid Atlantic') AND i.i_class_id IN (3, 5, 12, 10) AND i.i_rec_start_date = '2001-10-27' GROUP BY i.i_category, cc.cc_mkt_class ORDER BY i.i_category, cc.cc_mkt_class;
SELECT r.r_reason_desc, cc.cc_name AS call_center_name, cc.cc_city AS call_center_city, cc.cc_state AS call_center_state, SUM(cr.cr_return_amount) AS total_return_amount, AVG(cr.cr_return_amount) AS avg_return_amount, COUNT(cr.cr_order_number) AS total_returns, SUM(cr.cr_return_quantity) AS total_returned_items, SUM(cr.cr_fee) AS total_fees_collected, SUM(cr.cr_store_credit) AS total_store_credit_issued, SUM(cr.cr_net_loss) AS total_net_loss FROM catalog_returns cr JOIN call_center cc ON cr.cr_call_center_sk = cc.cc_call_center_sk JOIN reason r ON cr.cr_reason_sk = r.r_reason_sk WHERE cr.cr_returned_date_sk BETWEEN 20000101 AND 20001231 AND cr.cr_returning_hdemo_sk IN (5491, 6517, 636, 7063, 3950, 2509) GROUP BY r.r_reason_desc, cc.cc_name, cc.cc_city, cc.cc_state ORDER BY total_return_amount DESC, total_returns DESC;
SELECT ib.ib_income_band_sk, ib.ib_lower_bound, ib.ib_upper_bound, sm.sm_type, sm.sm_carrier, COUNT(i.i_item_sk) AS total_items_sold, AVG(i.i_current_price) AS average_selling_price, AVG(i.i_wholesale_cost) AS average_wholesale_cost FROM item i JOIN ship_mode sm ON i.i_container = sm.sm_code JOIN income_band ib ON i.i_manager_id = ib.ib_income_band_sk WHERE i.i_product_name = 'antin steing' AND ib.ib_income_band_sk IN (13, 18, 17, 3, 11, 16) AND sm.sm_contract IN ('uukTktPYycct8', '6Hzzp4JkzjqD8MGXLCDa', 'Xjy3ZPuiDjzHlRx14Z3', 'A5BYO1qH8HGTTN') AND i.i_item_id = 'AAAAAAAAMFLAAAAA' AND sm.sm_code IN ('SEA', 'BIKE', 'AIR', 'SURFACE') GROUP BY ib.ib_income_band_sk, ib.ib_lower_bound, ib.ib_upper_bound, sm.sm_type, sm.sm_carrier ORDER BY average_selling_price DESC, total_items_sold DESC;
SELECT item.i_product_name, promotion.p_promo_name, call_center.cc_name, COUNT(DISTINCT catalog_sales.cs_item_sk) AS item_sold_count, SUM(catalog_sales.cs_net_paid) AS total_sales, AVG(catalog_sales.cs_ext_discount_amt / NULLIF(catalog_sales.cs_quantity, 0)) AS average_discount_per_item, SUM(catalog_sales.cs_quantity) AS total_units_sold, promotion.p_channel_dmail, promotion.p_channel_email, promotion.p_channel_catalog, promotion.p_channel_tv, promotion.p_channel_radio, promotion.p_channel_press, promotion.p_channel_event, promotion.p_channel_demo FROM catalog_sales INNER JOIN item ON catalog_sales.cs_item_sk = item.i_item_sk INNER JOIN promotion ON catalog_sales.cs_promo_sk = promotion.p_promo_sk INNER JOIN call_center ON catalog_sales.cs_call_center_sk = call_center.cc_call_center_sk WHERE item.i_product_name IN ('barationbarought', 'ableoughtoughtese', 'ablebarn stpri', 'prioughteingable', 'priationanti') AND promotion.p_promo_sk IN (169, 149, 296, 99) AND call_center.cc_call_center_id IN ('AAAAAAAAEAAAAAAA', 'AAAAAAAABAAAAAAA', 'AAAAAAAACAAAAAAA') AND catalog_sales.cs_sold_date_sk IS NOT NULL AND catalog_sales.cs_sold_date_sk BETWEEN 20000101 AND 20001231 GROUP BY item.i_product_name, promotion.p_promo_name, call_center.cc_name, promotion.p_channel_dmail, promotion.p_channel_email, promotion.p_channel_catalog, promotion.p_channel_tv, promotion.p_channel_radio, promotion.p_channel_press, promotion.p_channel_event, promotion.p_channel_demo ORDER BY total_sales DESC, item_sold_count DESC, average_discount_per_item DESC;
SELECT c.cc_name, c.cc_state, AVG(s.s_number_employees) as avg_store_employees, SUM(sr.sr_return_amt) as total_return_amount, SUM(sr.sr_return_quantity) as total_returned_quantity, COUNT(DISTINCT hd.hd_demo_sk) as unique_household_count, AVG(cd.cd_purchase_estimate) as avg_purchase_estimate FROM call_center c JOIN store s ON c.cc_state = s.s_state AND c.cc_mkt_id = s.s_market_id JOIN store_returns sr ON s.s_store_sk = sr.sr_store_sk JOIN customer_demographics cd ON sr.sr_cdemo_sk = cd.cd_demo_sk JOIN household_demographics hd ON sr.sr_hdemo_sk = hd.hd_demo_sk WHERE c.cc_class = 'small' AND cd.cd_purchase_estimate > 5000 AND hd.hd_income_band_sk IS NOT NULL AND sr.sr_return_ship_cost > 100 AND sr.sr_returned_date_sk IS NOT NULL GROUP BY c.cc_name, c.cc_state ORDER BY total_return_amount DESC, avg_store_employees DESC, unique_household_count DESC;
SELECT ws.web_name, COUNT(DISTINCT wp.wp_web_page_sk) AS total_pages, AVG(wp.wp_char_count) AS average_char_count, AVG(wp.wp_link_count) AS average_link_count, AVG(wp.wp_image_count) AS average_image_count, SUM(wr.wr_return_quantity) AS total_return_quantity, SUM(wr.wr_return_amt) AS total_return_amount, AVG(wr.wr_return_amt_inc_tax) AS average_return_with_tax, SUM(wr.wr_net_loss) AS total_net_loss FROM web_site ws JOIN web_page wp ON ws.web_site_sk = wp.wp_customer_sk LEFT JOIN web_returns wr ON wp.wp_web_page_sk = wr.wr_web_page_sk WHERE ws.web_name IN ('site_3', 'site_4', 'site_1', 'site_0', 'site_2') AND ws.web_open_date_sk = 2450645 AND wp.wp_web_page_id IN ('AAAAAAAABAAAAAAA', 'AAAAAAAAGBAAAAAA') AND wr.wr_refunded_addr_sk IN (47075, 5271, 7334) GROUP BY ws.web_name ORDER BY total_return_amount DESC;
SELECT c.c_first_name, c.c_last_name, sum(ss.ss_quantity) as total_items_sold, avg(ss.ss_sales_price) as average_sales_price, sum(ss.ss_net_paid) as total_revenue, sum(ss.ss_net_profit) as total_profit, p.p_promo_name, count(DISTINCT ss.ss_ticket_number) as number_of_sales_transactions FROM store_sales ss JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk JOIN promotion p ON ss.ss_promo_sk = p.p_promo_sk JOIN inventory i ON ss.ss_item_sk = i.inv_item_sk AND i.inv_date_sk = ss.ss_sold_date_sk WHERE c.c_last_name IN ('Waggoner', 'Hoyt', 'Moffitt', 'Buchanan', 'Orourke') AND i.inv_warehouse_sk IN ('1', '2') AND p.p_channel_catalog = 'N' AND ss.ss_promo_sk IN ('11', '103', '131', '133', '275') GROUP BY c.c_first_name, c.c_last_name, p.p_promo_name ORDER BY total_revenue DESC, c.c_last_name, c.c_first_name;
