SELECT ws.web_name, d.d_year, d.d_moy, COUNT(DISTINCT wp.wp_web_page_sk) AS total_pages, SUM(wp.wp_char_count) AS total_char_count, SUM(wp.wp_link_count) AS total_link_count, SUM(wp.wp_image_count) AS total_image_count, AVG(p.p_cost) AS average_promo_cost, SUM(CASE WHEN p.p_discount_active = 'Y' THEN p.p_cost ELSE 0 END) AS total_discounted_promo_cost, COUNT(DISTINCT c.c_customer_sk) AS total_customers, COUNT(DISTINCT CASE WHEN c.c_preferred_cust_flag = 'Y' THEN c.c_customer_sk ELSE NULL END) AS preferred_customers FROM web_site ws JOIN web_page wp ON wp.wp_customer_sk = ws.web_site_sk JOIN date_dim d ON wp.wp_access_date_sk = d.d_date_sk LEFT JOIN promotion p ON p.p_start_date_sk <= d.d_date_sk AND p.p_end_date_sk >= d.d_date_sk LEFT JOIN customer c ON c.c_customer_sk = wp.wp_customer_sk WHERE ws.web_manager IN ('John Isaacs', 'James Bernard') AND wp.wp_autogen_flag = 'N' AND c.c_birth_year = 1973 GROUP BY ws.web_name, d.d_year, d.d_moy ORDER BY ws.web_name, d.d_year, d.d_moy;
SELECT p.p_promo_name, p.p_channel_dmail, p.p_channel_email, p.p_channel_catalog, p.p_channel_tv, p.p_channel_radio, p.p_channel_press, p.p_channel_event, p.p_channel_demo, SUM(p.p_cost) AS total_promotion_cost, COUNT(p.p_promo_sk) AS number_of_promotions, AVG(cd.cd_dep_count) AS average_number_of_dependents FROM promotion p JOIN web_page wp ON p.p_item_sk = wp.wp_web_page_sk JOIN customer_demographics cd ON wp.wp_customer_sk = cd.cd_demo_sk WHERE wp.wp_creation_date_sk IN ('2450808', '2450809') AND p.p_response_target = 1 AND cd.cd_marital_status IN ('W', 'D', 'U', 'S') GROUP BY p.p_promo_name, p.p_channel_dmail, p.p_channel_email, p.p_channel_catalog, p.p_channel_tv, p.p_channel_radio, p.p_channel_press, p.p_channel_event, p.p_channel_demo ORDER BY total_promotion_cost DESC, number_of_promotions DESC;
SELECT dd.d_year, dd.d_month_seq, COUNT(DISTINCT ws.ws_order_number) AS total_orders, SUM(ws.ws_quantity) AS total_quantity, AVG(ws.ws_sales_price) AS average_sales_price, SUM(ws.ws_net_paid) AS total_net_paid, SUM(ws.ws_net_profit) AS total_net_profit, w.w_country AS warehouse_country, c.c_birth_country AS customer_birth_country FROM web_sales ws JOIN date_dim dd ON ws.ws_sold_date_sk = dd.d_date_sk JOIN warehouse w ON ws.ws_warehouse_sk = w.w_warehouse_sk JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk WHERE dd.d_year = 2023 AND w.w_country IN ('United States', 'Canada') AND c.c_birth_country IN ('MALTA', 'GRENADA') GROUP BY dd.d_year, dd.d_month_seq, w.w_country, c.c_birth_country ORDER BY total_net_profit DESC, dd.d_month_seq, warehouse_country, customer_birth_country;
SELECT s.s_store_id, s.s_store_name, i.i_category, SUM(ss.ss_quantity) AS total_quantity_sold, AVG(ss.ss_sales_price) AS average_sales_price, SUM(ss.ss_net_paid) AS total_net_paid, SUM(ss.ss_net_profit) AS total_net_profit, COUNT(DISTINCT ss.ss_customer_sk) AS unique_customers, COUNT(DISTINCT ca.ca_address_sk) AS unique_addresses, SUM(ca.ca_gmt_offset) AS total_gmt_offset FROM store_sales ss JOIN store s ON ss.ss_store_sk = s.s_store_sk JOIN item i ON ss.ss_item_sk = i.i_item_sk JOIN customer_address ca ON ss.ss_addr_sk = ca.ca_address_sk WHERE s.s_suite_number = 'Suite 190' AND s.s_division_name <> 'Unknown' AND ca.ca_street_number IN ('142', '497', '990', '467') AND ss.ss_sold_date_sk IS NOT NULL GROUP BY s.s_store_id, s.s_store_name, i.i_category ORDER BY total_net_profit DESC, s.s_store_name, i.i_category;
SELECT s.s_store_name, i.i_category, p.p_channel_details, SUM(cs.cs_net_paid_inc_ship) AS total_sales, SUM(cs.cs_net_profit) AS total_profit, COUNT(DISTINCT cs.cs_order_number) AS total_orders, AVG(cs.cs_quantity) AS average_quantity, SUM(wr.wr_net_loss) AS total_net_loss, COUNT(DISTINCT wr.wr_order_number) AS total_returns, r.r_reason_desc FROM store s JOIN catalog_sales cs ON s.s_store_sk = cs.cs_warehouse_sk JOIN item i ON cs.cs_item_sk = i.i_item_sk LEFT JOIN promotion p ON cs.cs_promo_sk = p.p_promo_sk LEFT JOIN web_returns wr ON cs.cs_item_sk = wr.wr_item_sk AND cs.cs_order_number = wr.wr_order_number LEFT JOIN reason r ON wr.wr_reason_sk = r.r_reason_sk WHERE s.s_country = 'United States' AND ( s.s_store_sk = '8' OR s.s_store_sk = '1' ) AND ( cs.cs_net_paid_inc_ship IN ('6377.67', '3521.76', '158.56', '2257.47', '739.93', '7973.92') ) AND ( r.r_reason_sk IN ('17', '4', '20', '18', '31') OR r.r_reason_sk IS NULL ) AND i.i_class = 'cooking' GROUP BY s.s_store_name, i.i_category, p.p_channel_details, r.r_reason_desc ORDER BY total_sales DESC, total_profit DESC;
SELECT c.c_first_name, c.c_last_name, c.c_email_address, SUM(inv.inv_quantity_on_hand) AS total_inventory, AVG(wr.wr_return_amt_inc_tax) AS avg_return_amount_inc_tax, COUNT(DISTINCT wr.wr_order_number) AS total_returns, td.t_shift, SUM(wr.wr_fee) AS total_return_fees, SUM(wr.wr_net_loss) AS total_net_loss FROM customer c JOIN web_returns wr ON c.c_customer_sk = wr.wr_returning_customer_sk JOIN inventory inv ON wr.wr_item_sk = inv.inv_item_sk JOIN time_dim td ON wr.wr_returned_time_sk = td.t_time_sk WHERE c.c_email_address IN ('Brandi.Miller@JH5mldviNI7xQKVQj.com', 'Steven.Williams@uxeKdX2slbhOxguR.edu', 'Maryalice.Rivers@4b9MXdByVXI.com') AND c.c_birth_day IN (26, 12, 21) AND inv.inv_quantity_on_hand IN (31, 517, 732) AND inv.inv_date_sk = 2450815 AND inv.inv_item_sk IN (12622, 7663, 9094) AND inv.inv_warehouse_sk IN (2, 1) AND wr.wr_returning_cdemo_sk IN (940737, 1276363, 1374880) AND wr.wr_returned_time_sk IN (69044, 3060, 44094) AND wr.wr_reversed_charge IN (22.11, 1530.12, 160.93) AND wr.wr_reason_sk IN (1, 8, 25) GROUP BY c.c_first_name, c.c_last_name, c.c_email_address, td.t_shift ORDER BY total_inventory DESC, avg_return_amount_inc_tax DESC, total_returns DESC;
SELECT dd.d_year, dd.d_moy, SUM(inv.inv_quantity_on_hand) AS total_quantity, AVG(inv.inv_quantity_on_hand) AS avg_quantity, COUNT(DISTINCT c.c_customer_sk) AS unique_customers, COUNT(DISTINCT w.w_warehouse_sk) AS warehouses_involved, SUM(CASE WHEN p.p_channel_email = 'Y' THEN p.p_cost ELSE 0 END) AS total_promo_cost_email, SUM(CASE WHEN p.p_channel_tv = 'Y' THEN p.p_cost ELSE 0 END) AS total_promo_cost_tv, COUNT(DISTINCT CASE WHEN p.p_discount_active = 'Y' THEN p.p_promo_sk ELSE NULL END) AS active_discount_promos FROM inventory inv JOIN date_dim dd ON inv.inv_date_sk = dd.d_date_sk JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk JOIN customer c ON dd.d_date_sk = c.c_first_sales_date_sk OR dd.d_date_sk = c.c_first_shipto_date_sk LEFT JOIN promotion p ON dd.d_date_sk BETWEEN p.p_start_date_sk AND p.p_end_date_sk WHERE dd.d_year = 1998 AND p.p_channel_event = 'N' AND dd.d_first_dom IN ('2416847', '2417850', '2417728', '2418946') AND inv.inv_warehouse_sk IN ('1', '2') AND c.c_birth_month IN ('3', '5', '6', '10', '4') GROUP BY dd.d_year, dd.d_moy ORDER BY dd.d_year, dd.d_moy;
SELECT p.p_promo_id, p.p_promo_name, COUNT(cs.cs_order_number) AS total_orders, SUM(cs.cs_net_paid) AS total_revenue, SUM(cs.cs_ext_wholesale_cost) AS total_cost, SUM(cs.cs_net_profit) AS total_profit, AVG(cs.cs_ext_discount_amt) AS average_discount_amount FROM catalog_sales cs JOIN promotion p ON cs.cs_promo_sk = p.p_promo_sk GROUP BY p.p_promo_id, p.p_promo_name ORDER BY total_revenue DESC;
SELECT cc.cc_name, cc.cc_city, cc.cc_state, COUNT(*) AS number_of_promotions, SUM(inv.inv_quantity_on_hand) AS total_inventory, AVG(p.p_cost) AS average_promotion_cost, SUM(CASE WHEN p.p_discount_active = 'Y' THEN 1 ELSE 0 END) AS active_discounts FROM call_center cc JOIN promotion p ON cc.cc_call_center_sk = p.p_item_sk JOIN inventory inv ON p.p_item_sk = inv.inv_item_sk WHERE cc.cc_rec_end_date = '2000-12-31' AND inv.inv_date_sk = 2450815 AND inv.inv_quantity_on_hand IN (104, 11, 180) AND cc.cc_employees IN (1, 2, 3) GROUP BY cc.cc_name, cc.cc_city, cc.cc_state ORDER BY cc.cc_name, cc.cc_city, cc.cc_state;
SELECT cc.cc_call_center_id AS call_center, cc.cc_name AS call_center_name, cc.cc_manager AS manager, SUM(i.i_current_price) AS total_sales, AVG(i.i_wholesale_cost) AS average_wholesale_cost, COUNT(DISTINCT cd.cd_demo_sk) AS unique_customer_demographics, AVG(cd.cd_purchase_estimate) AS average_purchase_estimate, COUNT(DISTINCT t.t_time_sk) AS count_time_sk_events, ib.ib_lower_bound, ib.ib_upper_bound, COUNT(*) FILTER (WHERE t.t_am_pm = 'AM') AS am_shifts, COUNT(*) FILTER (WHERE t.t_sub_shift = 'night') AS night_sub_shifts FROM call_center cc JOIN catalog_page cp ON cc.cc_call_center_id = cp.cp_catalog_page_id JOIN item i ON cp.cp_catalog_page_sk = i.i_item_sk JOIN customer_demographics cd ON i.i_manager_id = cd.cd_demo_sk JOIN time_dim t ON t.t_time_sk = cd.cd_demo_sk JOIN income_band ib ON cd.cd_purchase_estimate BETWEEN ib.ib_lower_bound AND ib.ib_upper_bound JOIN date_dim dd_cc ON cc.cc_open_date_sk = dd_cc.d_date_sk JOIN date_dim dd_cp ON cp.cp_start_date_sk = dd_cp.d_date_sk WHERE dd_cc.d_date <= CURRENT_DATE AND (cc.cc_rec_end_date IS NULL OR cc.cc_rec_end_date > CURRENT_DATE) AND dd_cp.d_date <= CURRENT_DATE AND (cp.cp_end_date_sk IS NULL OR dd_cp.d_date > CURRENT_DATE) GROUP BY cc.cc_call_center_id, cc.cc_name, cc.cc_manager, ib.ib_lower_bound, ib.ib_upper_bound ORDER BY total_sales DESC;
SELECT COUNT(DISTINCT c.c_customer_sk) AS total_customers, AVG(w.w_warehouse_sq_ft) AS average_warehouse_size, SUM(p.p_cost) AS total_promotion_cost, s.s_state, s.s_city, COUNT(DISTINCT s.s_store_sk) AS total_stores, AVG(s.s_number_employees) AS average_store_employees FROM customer c JOIN store s ON c.c_current_addr_sk = s.s_store_sk JOIN warehouse w ON s.s_zip = w.w_zip JOIN promotion p ON p.p_channel_event = 'N' AND p.p_purpose != 'Unknown' GROUP BY s.s_state, s.s_city ORDER BY total_customers DESC, average_warehouse_size DESC, total_promotion_cost DESC;
SELECT cc.cc_city AS call_center_city, cc.cc_state AS call_center_state, SUM(ws.ws_quantity) AS total_quantity_sold, AVG(ws.ws_sales_price) AS average_sales_price, COUNT(DISTINCT ws.ws_order_number) AS number_of_orders, SUM(inv.inv_quantity_on_hand) AS total_inventory_on_hand, SUM(ws.ws_net_profit) AS total_net_profit FROM call_center cc JOIN web_sales ws ON cc.cc_call_center_sk = ws.ws_warehouse_sk JOIN inventory inv ON ws.ws_item_sk = inv.inv_item_sk AND ws.ws_sold_date_sk = inv.inv_date_sk JOIN time_dim td ON ws.ws_sold_time_sk = td.t_time_sk WHERE cc.cc_mkt_id IN ('6', '2', '5') AND cc.cc_suite_number IN ('Suite 70', 'Suite 0', 'Suite U') AND inv.inv_quantity_on_hand IN (645, 327) AND td.t_time_sk IN (247, 1615, 1813, 4029, 3389) AND td.t_hour = 1 GROUP BY call_center_city, call_center_state ORDER BY total_net_profit DESC, call_center_city, call_center_state;
SELECT w.web_name, cp.cp_department, sm.sm_type, COUNT(distinct i.i_item_sk) as total_items, SUM(i.i_current_price) as total_sales, AVG(i.i_wholesale_cost) as avg_wholesale_cost, COUNT(distinct w.web_site_sk) as total_websites FROM web_site w JOIN catalog_page cp ON w.web_site_sk = cp.cp_catalog_number JOIN item i ON cp.cp_department = i.i_category JOIN ship_mode sm ON sm.sm_carrier = i.i_manufact WHERE i.i_category = 'Music' AND w.web_city IN ('Fairview', 'Midway') AND sm.sm_ship_mode_id IN ('AAAAAAAAIAAAAAAA', 'AAAAAAAALAAAAAAA') AND i.i_item_id IN ('AAAAAAAAJCCAAAAA', 'AAAAAAAANGMAAAAA', 'AAAAAAAAICDAAAAA', 'AAAAAAAAHLABAAAA', 'AAAAAAAAIIEAAAAA', 'AAAAAAAALAOAAAAA') AND w.web_name IN ('site_3', 'site_4', 'site_1', 'site_0', 'site_2') GROUP BY w.web_name, cp.cp_department, sm.sm_type ORDER BY total_sales DESC;
SELECT cc.cc_name, cc.cc_city, cc.cc_state, SUM(cr.cr_return_amount) AS total_return_amount, AVG(cr.cr_return_amount) AS avg_return_amount, COUNT(*) AS total_returns, SUM(cr.cr_net_loss) AS total_net_loss, r.r_reason_desc, COUNT(r.r_reason_desc) AS reason_count FROM call_center cc JOIN catalog_returns cr ON cc.cc_call_center_sk = cr.cr_call_center_sk JOIN reason r ON cr.cr_reason_sk = r.r_reason_sk GROUP BY cc.cc_name, cc.cc_city, cc.cc_state, r.r_reason_desc ORDER BY total_net_loss DESC, total_returns DESC;
SELECT inv.inv_item_sk, SUM(inv.inv_quantity_on_hand) AS total_quantity_on_hand, AVG(wr.wr_return_amt_inc_tax) AS avg_return_amount_inc_tax, COUNT(wr.wr_item_sk) AS count_returns, wp.wp_type FROM inventory inv LEFT JOIN web_returns wr ON inv.inv_item_sk = wr.wr_item_sk LEFT JOIN web_page wp ON wr.wr_web_page_sk = wp.wp_web_page_sk WHERE inv.inv_date_sk = 2450815 AND wp.wp_type IN ('protected', 'feedback', 'ad', 'dynamic', 'welcome', 'general') AND wp.wp_max_ad_count IN (0, 1, 2) GROUP BY inv.inv_item_sk, wp.wp_type ORDER BY inv.inv_item_sk, wp.wp_type;
SELECT w_state, ib_income_band_sk, COUNT(DISTINCT cs_order_number) AS total_orders, SUM(cs_quantity) AS total_quantity, AVG(cs_net_paid) AS average_net_paid, SUM(cs_net_profit) AS total_profit, COUNT(DISTINCT ws_order_number) AS total_web_orders, SUM(ws_quantity) AS total_web_quantity, AVG(ws_net_paid_inc_ship) AS average_web_net_paid_inc_ship, SUM(ws_net_profit) AS total_web_profit, COUNT(DISTINCT wr_order_number) AS total_returns, SUM(wr_return_quantity) AS total_returned_quantity, AVG(wr_return_amt_inc_tax) AS average_return_amount_inc_tax, SUM(wr_net_loss) AS total_net_loss FROM warehouse w JOIN catalog_sales cs ON w.w_warehouse_sk = cs.cs_warehouse_sk JOIN household_demographics hd ON cs.cs_bill_hdemo_sk = hd.hd_demo_sk JOIN income_band ib ON hd.hd_income_band_sk = ib.ib_income_band_sk JOIN web_sales ws ON w.w_warehouse_sk = ws.ws_warehouse_sk JOIN web_returns wr ON ws.ws_order_number = wr.wr_order_number WHERE w.w_county = 'Williamson County' AND w.w_warehouse_sk IN (2, 3) AND cs.cs_ship_addr_sk IN (27775, 21962, 3537, 27769) AND wr.wr_refunded_customer_sk IN (51283, 671, 63734, 16023, 8581, 84835) AND ib.ib_lower_bound IN (80001, 30001, 0, 140001, 110001) GROUP BY w_state, ib_income_band_sk ORDER BY w_state, ib_income_band_sk;
