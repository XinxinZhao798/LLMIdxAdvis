SELECT cd.cd_credit_rating, wp.wp_type, AVG(ws.ws_sales_price) AS avg_sales_amount, SUM(ws.ws_ext_ship_cost) AS total_shipping_cost, AVG(ws.ws_quantity) AS avg_items_per_order, SUM(wr.wr_return_amt) AS total_return_amount, SUM(wr.wr_return_amt_inc_tax) AS total_return_amount_inc_tax FROM web_sales ws JOIN customer_demographics cd ON ws.ws_bill_cdemo_sk = cd.cd_demo_sk JOIN web_page wp ON ws.ws_web_page_sk = wp.wp_web_page_sk LEFT JOIN web_returns wr ON ws.ws_order_number = wr.wr_order_number WHERE cd.cd_credit_rating IN ('Unknown', 'Good', 'High Risk') AND wp.wp_url = 'http://www.foo.com' AND ws.ws_ship_customer_sk IN ('68344', '31854', '75904', '57654') AND ws.ws_ext_ship_cost = 1302.64 AND wp.wp_creation_date_sk IN ('2450810', '2450815', '2450813') AND wr.wr_refunded_customer_sk IN ('21890', '47305', '48588', '57226', '74434') AND wr.wr_order_number IN ('3277', '3156') GROUP BY cd.cd_credit_rating, wp.wp_type ORDER BY total_shipping_cost DESC, avg_sales_amount DESC;
SELECT cc.cc_call_center_id, cc.cc_name, cc.cc_city, cc.cc_state, COUNT(cs.cs_order_number) AS total_orders, SUM(cs.cs_net_paid) AS total_sales_amount, AVG(cs.cs_sales_price) AS average_sales_amount_per_order, MAX(cs.cs_sales_price) AS max_sale_amount, AVG(cs.cs_ext_discount_amt) AS average_discount_amount, SUM(cs.cs_ext_tax) AS total_tax_collected, COUNT(DISTINCT cs.cs_bill_customer_sk) AS unique_customers FROM call_center cc JOIN catalog_sales cs ON cc.cc_call_center_sk = cs.cs_call_center_sk JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk WHERE d.d_date BETWEEN '2023-01-01'::DATE AND '2023-12-31'::DATE AND cs.cs_list_price > 100 GROUP BY cc.cc_call_center_id, cc.cc_name, cc.cc_city, cc.cc_state ORDER BY total_sales_amount DESC, average_sales_amount_per_order DESC;
SELECT i.i_category AS item_category, cc.cc_state AS call_center_state, COUNT(DISTINCT ss.ss_ticket_number) AS number_of_sales_transactions, SUM(ss.ss_net_paid) AS total_sales, AVG(ss.ss_sales_price) AS average_sales_price, AVG(ss.ss_ext_discount_amt) AS average_discount_amount FROM store_sales ss JOIN item i ON ss.ss_item_sk = i.i_item_sk JOIN call_center cc ON cc.cc_call_center_sk = ss.ss_store_sk WHERE i.i_current_price BETWEEN 4.63 AND 18.31 AND ss.ss_sold_date_sk IS NOT NULL GROUP BY i.i_category, cc.cc_state ORDER BY total_sales DESC, item_category, call_center_state;
SELECT cd.cd_gender, cd.cd_education_status, SUM(ss.ss_net_paid) AS total_sales, AVG(ss.ss_sales_price) AS avg_sales_price, SUM(ss.ss_net_profit) AS total_profit, p.p_channel_details, s.s_store_name FROM store_sales ss JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk JOIN promotion p ON ss.ss_promo_sk = p.p_promo_sk JOIN store s ON ss.ss_store_sk = s.s_store_sk WHERE p.p_channel_details IN ('Books expect international, big interests', 'Scenes might make high') AND c.c_last_name IN ('Carter', 'Babcock', 'Hoag') AND s.s_county IN ('Nolan County', 'Winchester city', 'Elliott County', 'Minidoka County') AND ss.ss_sold_date_sk >= 2450460 GROUP BY cd.cd_gender, cd.cd_education_status, p.p_channel_details, s.s_store_name ORDER BY total_sales DESC, total_profit DESC;
SELECT d.d_year, d.d_quarter_name, p.p_promo_name, sm.sm_type, SUM(cs.cs_quantity) AS total_quantity_sold, AVG(cs.cs_sales_price) AS average_sales_price, SUM(cs.cs_net_profit) AS total_net_profit, COUNT(DISTINCT cr.cr_order_number) AS total_returns, SUM(cr.cr_return_amount) AS total_return_amount, SUM(ws.ws_net_paid_inc_tax) AS total_web_sales_inc_tax FROM date_dim d JOIN catalog_sales cs ON cs.cs_sold_date_sk = d.d_date_sk JOIN ship_mode sm ON cs.cs_ship_mode_sk = sm.sm_ship_mode_sk JOIN promotion p ON cs.cs_promo_sk = p.p_promo_sk LEFT JOIN catalog_returns cr ON cs.cs_order_number = cr.cr_order_number LEFT JOIN web_sales ws ON cs.cs_order_number = ws.ws_order_number WHERE d.d_year = 2003 AND p.p_channel_details LIKE '%early%' GROUP BY d.d_year, d.d_quarter_name, p.p_promo_name, sm.sm_type ORDER BY total_net_profit DESC, total_quantity_sold DESC LIMIT 100;
SELECT i.i_category AS item_category, sm.sm_type AS shipping_type, COUNT(DISTINCT cr.cr_order_number) AS catalog_returns_count, SUM(cr.cr_return_quantity) AS total_catalog_return_quantity, AVG(cr.cr_return_amt_inc_tax) AS average_catalog_return_amount, COUNT(DISTINCT sr.sr_ticket_number) AS store_returns_count, SUM(sr.sr_return_quantity) AS total_store_return_quantity, AVG(sr.sr_return_amt_inc_tax) AS average_store_return_amount FROM catalog_returns cr INNER JOIN item i ON cr.cr_item_sk = i.i_item_sk INNER JOIN ship_mode sm ON cr.cr_ship_mode_sk = sm.sm_ship_mode_sk INNER JOIN time_dim t ON cr.cr_returned_date_sk = t.t_time_sk INNER JOIN income_band ib ON cr.cr_refunded_customer_sk = ib.ib_income_band_sk LEFT JOIN store_returns sr ON i.i_item_sk = sr.sr_item_sk AND cr.cr_returned_date_sk = sr.sr_returned_date_sk WHERE t.t_time_sk = 1000 AND ib.ib_lower_bound = 40001 GROUP BY i.i_category, sm.sm_type ORDER BY i.i_category, sm.sm_type;
SELECT p.p_promo_name, p.p_channel_dmail, p.p_channel_email, p.p_channel_catalog, p.p_channel_tv, p.p_channel_radio, p.p_channel_press, p.p_channel_event, p.p_channel_demo, SUM(p.p_cost) AS total_promotion_cost, COUNT(p.p_promo_sk) AS number_of_promotions, AVG(cd.cd_dep_count) AS average_number_of_dependents FROM promotion p JOIN web_page wp ON p.p_item_sk = wp.wp_web_page_sk JOIN customer_demographics cd ON wp.wp_customer_sk = cd.cd_demo_sk WHERE wp.wp_creation_date_sk IN ('2450808', '2450809') AND p.p_response_target = 1 AND cd.cd_marital_status IN ('W', 'D', 'U', 'S') GROUP BY p.p_promo_name, p.p_channel_dmail, p.p_channel_email, p.p_channel_catalog, p.p_channel_tv, p.p_channel_radio, p.p_channel_press, p.p_channel_event, p.p_channel_demo ORDER BY total_promotion_cost DESC, number_of_promotions DESC;
SELECT t.t_shift, ib.ib_income_band_sk, COUNT(DISTINCT ws.web_site_sk) AS total_websites, AVG(ws.web_tax_percentage) AS avg_tax_percentage, SUM(CASE WHEN ws.web_class = 'Unknown' THEN 1 ELSE 0 END) AS unknown_class_count, MIN(ib.ib_lower_bound) AS min_income_lower_bound, MAX(ib.ib_upper_bound) AS max_income_upper_bound FROM time_dim t JOIN web_site ws ON t.t_time_sk = ws.web_open_date_sk LEFT JOIN income_band ib ON ws.web_mkt_id = ib.ib_income_band_sk WHERE t.t_time_sk IN (1002, 2003, 4384, 955, 433, 1796) AND ws.web_company_id IN (5, 2, 1) AND ws.web_class != 'Unknown' GROUP BY t.t_shift, ib.ib_income_band_sk ORDER BY t.t_shift, ib.ib_income_band_sk;
SELECT s.s_store_name, SUM(ss.ss_quantity) AS total_quantity_sold, AVG(ss.ss_sales_price) AS average_sales_price, SUM(ss.ss_net_paid) AS total_net_paid, SUM(ss.ss_net_paid_inc_tax) AS total_net_paid_inc_tax, AVG(ss.ss_net_profit) AS average_net_profit, COUNT(DISTINCT p.p_promo_sk) AS number_of_promotions_run, SUM(CASE WHEN p.p_channel_tv = 'N' THEN ss.ss_quantity ELSE 0 END) AS quantity_sold_with_no_tv_promo FROM store_sales ss JOIN store s ON ss.ss_store_sk = s.s_store_sk JOIN promotion p ON ss.ss_promo_sk = p.p_promo_sk JOIN call_center cc ON s.s_market_id = cc.cc_mkt_id JOIN inventory i ON ss.ss_item_sk = i.inv_item_sk AND i.inv_date_sk = ss.ss_sold_date_sk WHERE ss.ss_sold_time_sk IN (63444, 44081, 71662, 70433) AND i.inv_item_sk IN (15889, 8930) AND i.inv_date_sk = 2450815 AND p.p_cost = 1000.00 AND cc.cc_sq_ft IN (795, 2268, 3514, 1138, 649) AND cc.cc_open_date_sk IN (2450806, 2450952) GROUP BY s.s_store_name ORDER BY total_net_paid DESC;
SELECT cc_state, ca_location_type, COUNT(DISTINCT ws_order_number) AS total_orders, SUM(ws_quantity) AS total_quantity_sold, AVG(ws_sales_price) AS avg_sales_price, SUM(ws_net_paid) AS total_net_paid, SUM(ws_net_profit) AS total_net_profit FROM web_sales ws JOIN store s ON ws.ws_bill_addr_sk = s.s_store_sk JOIN call_center cc ON cc.cc_call_center_sk = ws.ws_ship_mode_sk JOIN customer_address ca ON ws.ws_bill_addr_sk = ca.ca_address_sk JOIN household_demographics hd ON ws.ws_bill_hdemo_sk = hd.hd_demo_sk WHERE ws.ws_item_sk IN (70, 58, 77) AND hd.hd_dep_count BETWEEN 1 AND 9 AND ca.ca_location_type IN ('single family', 'apartment', 'condo') AND ca.ca_city IN ('Ferguson', 'Holiday Hills') GROUP BY cc_state, ca_location_type ORDER BY total_net_profit DESC, total_net_paid DESC;
SELECT dd.d_year, dd.d_quarter_name, i.i_category, i.i_brand, COUNT(DISTINCT ws.web_site_sk) AS number_of_websites, COUNT(DISTINCT wp.wp_web_page_sk) AS number_of_web_pages, COUNT(DISTINCT wr.wr_order_number) AS number_of_returns, SUM(wr.wr_return_amt) AS total_return_amount, AVG(wr.wr_return_quantity) AS avg_return_quantity, AVG(wr.wr_fee) AS avg_return_fee, hd.hd_dep_count, ib.ib_lower_bound AS income_band_lower_bound, ib.ib_upper_bound AS income_band_upper_bound, SUM(hd.hd_vehicle_count) AS total_vehicles FROM web_returns wr JOIN date_dim dd ON wr.wr_returned_date_sk = dd.d_date_sk JOIN web_page wp ON wr.wr_web_page_sk = wp.wp_web_page_sk JOIN item i ON wr.wr_item_sk = i.i_item_sk JOIN web_site ws ON wp.wp_web_page_sk = ws.web_site_sk JOIN household_demographics hd ON wr.wr_returning_hdemo_sk = hd.hd_demo_sk JOIN income_band ib ON hd.hd_income_band_sk = ib.ib_income_band_sk WHERE dd.d_year = 2001 AND i.i_category_id IN (1, 2, 3) AND wr.wr_return_tax > 100 AND hd.hd_income_band_sk = 10 AND wr.wr_refunded_cash BETWEEN 300 AND 4000 GROUP BY dd.d_year, dd.d_quarter_name, i.i_category, i.i_brand, hd.hd_dep_count, ib.ib_lower_bound, ib.ib_upper_bound ORDER BY total_return_amount DESC, avg_return_quantity DESC, avg_return_fee DESC, number_of_websites, number_of_web_pages;
SELECT ca.ca_city, ca.ca_state, hd.hd_income_band_sk, COUNT(DISTINCT ws.ws_order_number) AS total_orders, SUM(ws.ws_quantity) AS total_quantity_sold, AVG(ws.ws_net_paid) AS average_net_paid, SUM(ws.ws_net_paid_inc_tax) AS total_net_paid_including_tax, AVG(ws.ws_net_profit) AS average_net_profit FROM web_sales ws JOIN customer_address ca ON ws.ws_bill_addr_sk = ca.ca_address_sk JOIN household_demographics hd ON ws.ws_bill_hdemo_sk = hd.hd_demo_sk WHERE ca.ca_country = 'United States' AND (ca.ca_city IN ('Argyle', 'Collinsville', 'Ferguson') OR hd.hd_demo_sk IN (1967, 3880)) AND ws.ws_sold_time_sk IN (27944, 62910, 57271, 74886, 48677, 80582) AND ws.ws_net_paid_inc_tax >= 7202.65 GROUP BY ca.ca_city, ca.ca_state, hd.hd_income_band_sk ORDER BY total_net_paid_including_tax DESC, average_net_profit DESC;
SELECT ws.web_manager, ws.web_class, COUNT(DISTINCT sr.sr_ticket_number) AS total_return_transactions, SUM(sr.sr_return_amt_inc_tax) AS total_return_amount_inc_tax, COUNT(DISTINCT cr.cr_order_number) AS total_catalog_return_transactions, SUM(cr.cr_return_amt_inc_tax) AS total_catalog_return_amount_inc_tax, COUNT(DISTINCT p.p_promo_sk) AS total_promotions, SUM(p.p_cost) AS total_promotion_cost FROM web_site ws LEFT JOIN store_returns sr ON ws.web_site_sk = sr.sr_store_sk LEFT JOIN catalog_returns cr ON ws.web_site_sk = cr.cr_catalog_page_sk LEFT JOIN promotion p ON cr.cr_item_sk = p.p_item_sk AND cr.cr_returned_date_sk BETWEEN p.p_start_date_sk AND p.p_end_date_sk WHERE ws.web_manager = 'Jimmy Pope' AND (ws.web_zip = '35709' OR ws.web_zip = '31904') GROUP BY ws.web_manager, ws.web_class ORDER BY total_return_amount_inc_tax DESC, total_catalog_return_amount_inc_tax DESC;
SELECT d_year, d_quarter_name, ca_state, SUM(ws_net_profit) AS total_net_profit, AVG(sr_return_amt_inc_tax) AS avg_return_amount_inc_tax, COUNT(DISTINCT ws_order_number) AS total_orders, COUNT(DISTINCT sr_ticket_number) AS total_returns FROM web_sales JOIN date_dim ON ws_sold_date_sk = d_date_sk JOIN customer_address ON ws_ship_addr_sk = ca_address_sk JOIN store_returns ON ws_order_number = sr_ticket_number AND ws_item_sk = sr_item_sk AND ws_bill_customer_sk = sr_customer_sk WHERE d_year = 2001 AND ca_state IN ('CA', 'NY', 'TX') AND ws_ship_mode_sk IN (15, 9, 19) AND ws_net_profit > 0 AND ws_ship_customer_sk IN (91411, 13153, 53110, 78552, 62671) AND sr_return_amt_inc_tax IN (211.69, 1118.88) AND sr_customer_sk IN (30509, 42705, 90022, 87597) GROUP BY d_year, d_quarter_name, ca_state ORDER BY total_net_profit DESC, avg_return_amount_inc_tax DESC;
SELECT cd.cd_education_status, ib.ib_income_band_sk, COUNT(DISTINCT ws.ws_order_number) AS number_of_orders, SUM(ws.ws_net_profit) AS total_net_profit, AVG(ws.ws_sales_price) AS average_sales_price FROM web_sales ws JOIN customer_demographics cd ON ws.ws_bill_cdemo_sk = cd.cd_demo_sk JOIN household_demographics hd ON ws.ws_bill_hdemo_sk = hd.hd_demo_sk JOIN income_band ib ON hd.hd_income_band_sk = ib.ib_income_band_sk WHERE cd.cd_purchase_estimate IS NOT NULL AND ib.ib_upper_bound <= 110000 AND ib.ib_income_band_sk IN (4, 1, 14, 13, 8) GROUP BY ROLLUP (cd.cd_education_status, ib.ib_income_band_sk) ORDER BY total_net_profit DESC, cd.cd_education_status, ib.ib_income_band_sk;
