SELECT ca.ca_state AS customer_state, r.r_reason_desc AS return_reason, COUNT(DISTINCT sr.sr_ticket_number) AS total_returns, SUM(sr.sr_return_amt) AS total_return_amt, SUM(sr.sr_return_tax) AS total_return_tax, SUM(sr.sr_net_loss) AS total_net_loss FROM store_returns sr JOIN customer_address ca ON sr.sr_addr_sk = ca.ca_address_sk JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk GROUP BY ca.ca_state, r.r_reason_desc ORDER BY ca.ca_state, r.r_reason_desc;
SELECT d_year, i_category, s_state, SUM(i_current_price) AS total_price, AVG(i_current_price) AS avg_price, COUNT(DISTINCT i_item_sk) AS unique_items_sold, COUNT(DISTINCT s_store_sk) AS number_of_stores, SUM(p_cost) AS total_promotion_cost, AVG(p_cost) AS avg_promotion_cost, COUNT(DISTINCT p_promo_sk) AS number_of_promotions, MAX(wp_max_ad_count) AS max_ad_count_webpage FROM date_dim, item, store, promotion, web_page, ship_mode WHERE i_rec_start_date <= d_date AND (i_rec_end_date IS NULL OR i_rec_end_date > d_date) AND s_rec_start_date <= d_date AND (s_rec_end_date IS NULL OR s_rec_end_date > d_date) AND wp_rec_start_date <= d_date AND (wp_rec_end_date IS NULL OR wp_rec_end_date > d_date) AND p_start_date_sk = d_date_sk AND (p_end_date_sk IS NULL OR p_end_date_sk >= d_date_sk) AND sm_type IN ('REGULAR', 'LIBRARY') AND i_class IN ('sports-apparel', 'decor', 'dvd/vcr players', 'shirts', 'bedding', 'fishing') AND p_channel_event = 'N' AND p_purpose <> 'Unknown' GROUP BY d_year, i_category, s_state ORDER BY d_year, i_category, s_state;
SELECT p.p_promo_name AS promotion_name, ib.ib_lower_bound AS income_band_lower_bound, ib.ib_upper_bound AS income_band_upper_bound, SUM(ss.ss_quantity) AS total_quantity_sold, SUM(ss.ss_ext_sales_price) AS total_sales, SUM(ss.ss_ext_discount_amt) AS total_discount_amount, AVG(ss.ss_sales_price) AS average_sales_price, COUNT(DISTINCT ss.ss_customer_sk) AS distinct_customers, SUM(CASE WHEN ss.ss_sales_price < ss.ss_list_price THEN 1 ELSE 0 END) AS count_discounted_sales FROM store_sales ss JOIN promotion p ON ss.ss_promo_sk = p.p_promo_sk JOIN income_band ib ON ss.ss_cdemo_sk = ib.ib_income_band_sk JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk WHERE p.p_discount_active = 'N' AND d.d_year IN (1901, 1903, 1906, 1908) AND ss.ss_ext_sales_price IN (2209.06, 2248.08) AND ib.ib_lower_bound IN (0, 90001, 170001, 120001, 50001) AND ib.ib_upper_bound = 160000 GROUP BY p.p_promo_name, ib.ib_lower_bound, ib.ib_upper_bound ORDER BY total_sales DESC, promotion_name, income_band_lower_bound, income_band_upper_bound;
SELECT w.web_name, w.web_manager, SUM(i.i_current_price) AS total_current_price, AVG(i.i_wholesale_cost) AS average_wholesale_cost, COUNT(i.i_item_sk) AS item_count, SM.sm_type, MAX(i.i_current_price) AS max_price, MIN(i.i_current_price) AS min_price FROM web_site AS w JOIN item AS i ON w.web_site_sk = i.i_manufact_id JOIN ship_mode AS SM ON SM.sm_ship_mode_sk = i.i_item_sk WHERE i.i_rec_start_date <= CURRENT_DATE AND (i.i_rec_end_date IS NULL OR i.i_rec_end_date > CURRENT_DATE) AND SM.sm_type IN ('EXPRESS', 'OVERNIGHT', 'REGULAR') AND i.i_current_price IN (5.40, 8.89) GROUP BY w.web_name, w.web_manager, SM.sm_type ORDER BY total_current_price DESC, item_count DESC;
SELECT sm.sm_type AS shipping_type, i.i_category AS item_category, COUNT(cr.cr_order_number) AS total_returns, SUM(cr.cr_return_amount) AS total_return_amount, AVG(cr.cr_fee) AS average_fee, SUM(cs.cs_quantity) AS total_sold_quantity, AVG(cs.cs_sales_price) AS average_sales_price, SUM(inv.inv_quantity_on_hand) AS total_inventory_quantity FROM catalog_returns cr JOIN item i ON cr.cr_item_sk = i.i_item_sk JOIN ship_mode sm ON cr.cr_ship_mode_sk = sm.sm_ship_mode_sk JOIN catalog_sales cs ON cr.cr_item_sk = cs.cs_item_sk AND cr.cr_order_number = cs.cs_order_number JOIN inventory inv ON i.i_item_sk = inv.inv_item_sk JOIN customer_demographics cd ON cr.cr_returning_cdemo_sk = cd.cd_demo_sk WHERE i.i_units <> 'N/A' AND i.i_product_name IN ('ablecallybarpri', 'ationeingcallyable', 'callyeingpri', 'barantiableese', 'antioughtn stese') AND cd.cd_dep_count BETWEEN 1 AND 2 GROUP BY sm.sm_type, i.i_category ORDER BY total_return_amount DESC, total_sold_quantity DESC;
SELECT ca.ca_state, cd.cd_education_status, COUNT(DISTINCT c.c_customer_sk) AS total_customers, AVG(cd.cd_purchase_estimate) AS avg_purchase_estimate, SUM(cd.cd_dep_count) AS total_dependents, SUM(cd.cd_dep_employed_count) AS total_employed_dependents, SUM(cd.cd_dep_college_count) AS total_college_dependents, AVG(hd.hd_income_band_sk) AS avg_income_band, AVG(hd.hd_vehicle_count) AS avg_vehicle_count FROM customer c JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk WHERE ca.ca_state IS NOT NULL AND cd.cd_education_status IS NOT NULL GROUP BY ca.ca_state, cd.cd_education_status ORDER BY ca.ca_state, cd.cd_education_status;
SELECT ca.ca_state AS state, i.d_year AS fiscal_year, COUNT(DISTINCT ss.ss_store_sk) AS num_stores, COUNT(DISTINCT ss.ss_item_sk) AS num_products_sold, SUM(ss.ss_quantity) AS total_quantity_sold, SUM(ss.ss_net_paid) AS total_sales, COUNT(DISTINCT sr.sr_store_sk) AS num_stores_with_returns, COUNT(DISTINCT sr.sr_item_sk) AS num_returned_products, SUM(sr.sr_return_quantity) AS total_quantity_returned, SUM(sr.sr_return_amt) AS total_returns, COUNT(DISTINCT cr.cr_call_center_sk) AS num_call_centers_with_returns, COUNT(DISTINCT cr.cr_item_sk) AS num_catalog_returned_products, SUM(cr.cr_return_quantity) AS total_catalog_quantity_returned, SUM(cr.cr_return_amount) AS total_catalog_returns FROM store_sales ss JOIN date_dim i ON ss.ss_sold_date_sk = i.d_date_sk JOIN customer_address ca ON ss.ss_addr_sk = ca.ca_address_sk LEFT JOIN store_returns sr ON ss.ss_ticket_number = sr.sr_ticket_number LEFT JOIN catalog_returns cr ON cr.cr_order_number = ss.ss_ticket_number WHERE i.d_fy_year = 2001 GROUP BY ca.ca_state, i.d_year ORDER BY ca.ca_state, i.d_year;
SELECT hd.hd_income_band_sk, p.p_channel_details, COUNT(DISTINCT cs.cs_order_number) AS total_orders, SUM(cs.cs_quantity) AS total_quantity, AVG(cs.cs_sales_price) AS average_sales_price, SUM(cs.cs_net_paid) AS total_net_paid, SUM(cs.cs_net_paid_inc_tax) AS total_net_paid_inc_tax, SUM(cs.cs_net_paid_inc_ship) AS total_net_paid_inc_ship, SUM(cs.cs_net_paid_inc_ship_tax) AS total_net_paid_inc_ship_tax, SUM(cs.cs_net_profit) AS total_net_profit FROM catalog_sales cs JOIN household_demographics hd ON cs.cs_bill_hdemo_sk = hd.hd_demo_sk JOIN promotion p ON cs.cs_promo_sk = p.p_promo_sk WHERE hd.hd_income_band_sk IN (12, 6, 4) AND p.p_promo_sk IN (262, 88, 196, 231, 119, 83) AND cs.cs_net_paid IN (499.47, 9920.40) GROUP BY hd.hd_income_band_sk, p.p_channel_details ORDER BY hd.hd_income_band_sk, p.p_channel_details;
SELECT ca.ca_state AS customer_state, i.i_category AS item_category, SUM(cs.cs_sales_price) AS total_sales, AVG(cs.cs_quantity) AS average_quantity_sold, COUNT(cs.cs_order_number) AS total_orders, SUM(cs.cs_net_profit) AS total_net_profit FROM catalog_sales cs JOIN item i ON cs.cs_item_sk = i.i_item_sk JOIN customer_address ca ON cs.cs_ship_addr_sk = ca.ca_address_sk WHERE i.i_container <> 'Unknown' AND cs.cs_sold_date_sk IS NOT NULL AND ca.ca_country = 'United States' GROUP BY customer_state, item_category HAVING SUM(cs.cs_sales_price) > 10000 ORDER BY total_sales DESC, customer_state, item_category;
SELECT d_year, cp_department, COUNT(DISTINCT c_customer_sk) AS number_of_customers, SUM(cr_return_quantity) AS total_return_quantity, AVG(cr_return_amount) AS avg_return_amount, SUM(cr_fee) AS total_fee, SUM(cr_return_amt_inc_tax) AS total_return_amount_inc_tax, p_promo_name, COUNT(DISTINCT p_promo_sk) AS number_of_promotions_used FROM date_dim, customer, catalog_page, catalog_returns LEFT JOIN promotion ON cr_item_sk = p_item_sk WHERE cr_returned_date_sk = d_date_sk AND cr_refunded_customer_sk = c_customer_sk AND cr_catalog_page_sk = cp_catalog_page_sk AND d_year = 2022 AND p_channel_details = 'Good, foreign problems will n' AND cp_department IN ('Books', 'Electronics') AND c_preferred_cust_flag = 'Y' GROUP BY d_year, cp_department, p_promo_name ORDER BY d_year, avg_return_amount DESC, total_return_quantity DESC;
SELECT cc.cc_name, cc.cc_city, cc.cc_state, SUM(cs.cs_quantity) AS total_quantity_sold, AVG(cs.cs_sales_price) AS average_sales_price, COUNT(DISTINCT cs.cs_order_number) AS total_orders, SUM(cs.cs_net_profit) AS total_net_profit, cd.cd_gender, cd.cd_marital_status, cd.cd_education_status FROM call_center cc JOIN catalog_sales cs ON cc.cc_call_center_sk = cs.cs_call_center_sk JOIN customer_demographics cd ON cs.cs_bill_cdemo_sk = cd.cd_demo_sk WHERE cc.cc_market_manager IN ('Julius Durham', 'Matthew Clifton', 'Gary Colburn', 'Julius Tran') GROUP BY ROLLUP(cc.cc_name, cc.cc_city, cc.cc_state, cd.cd_gender, cd.cd_marital_status, cd.cd_education_status) ORDER BY cc.cc_name, cc.cc_city, cc.cc_state, cd.cd_gender, cd.cd_marital_status, cd.cd_education_status;
SELECT d.d_year AS year, d.d_month_seq AS month_sequence, COUNT(DISTINCT ss.ss_store_sk) AS num_stores, SUM(ss.ss_quantity) AS total_items_sold, SUM(ss.ss_net_paid_inc_tax) AS total_sales_inc_tax, AVG(ss.ss_ext_discount_amt) AS average_discount, SUM(cr.cr_return_amount) AS total_returns, AVG(cr.cr_fee) AS average_return_fee, COUNT(DISTINCT cr.cr_call_center_sk) FILTER (WHERE cc.cc_class = 'small') AS num_small_class_call_centers, COUNT(DISTINCT cr.cr_call_center_sk) FILTER (WHERE cc.cc_class = 'medium') AS num_medium_class_call_centers, COUNT(DISTINCT cr.cr_call_center_sk) FILTER (WHERE cc.cc_class = 'large') AS num_large_class_call_centers FROM store_sales ss JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk LEFT JOIN catalog_returns cr ON ss.ss_ticket_number = cr.cr_order_number LEFT JOIN call_center cc ON cr.cr_call_center_sk = cc.cc_call_center_sk WHERE d.d_month_seq IS NOT NULL AND ss.ss_store_sk IS NOT NULL GROUP BY year, month_sequence ORDER BY year, month_sequence;
SELECT cc.cc_name, cc.cc_city, cc.cc_state, SUM(cc.cc_employees) AS total_employees, AVG(cc.cc_sq_ft) AS average_square_footage, COUNT(DISTINCT c.c_customer_sk) AS number_of_customers, COUNT(DISTINCT p.p_promo_sk) AS number_of_promotions, SUM(CASE WHEN c.c_preferred_cust_flag = 'Y' THEN 1 ELSE 0 END) AS preferred_customers_count, AVG(CASE WHEN p.p_discount_active = 'Y' THEN p.p_cost ELSE NULL END) AS average_active_discount_cost, MAX(ib.ib_upper_bound) AS max_income_band_upper_bound FROM call_center cc JOIN customer c ON (cc.cc_call_center_sk = c.c_current_addr_sk) JOIN promotion p ON (cc.cc_mkt_id = p.p_item_sk) LEFT JOIN income_band ib ON (c.c_current_hdemo_sk = ib.ib_income_band_sk) WHERE cc.cc_mkt_class IN ('Silly particles could pro', 'Dealers make most historical, direct students') AND cc.cc_mkt_id IN ('6', '2', '5') AND p.p_channel_email = 'N' GROUP BY cc.cc_name, cc.cc_city, cc.cc_state ORDER BY number_of_customers DESC, total_employees DESC;
SELECT cp.cp_department, sm.sm_carrier, SUM(ss.ss_net_paid_inc_tax) AS total_net_sales, AVG(ss.ss_ext_discount_amt) AS average_discount_amount, COUNT(DISTINCT CASE WHEN c.c_preferred_cust_flag = 'Y' AND ss.ss_net_paid > avg_net_paid THEN ss.ss_customer_sk END) AS high_value_customer_count FROM store_sales ss JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk JOIN catalog_page cp ON cp.cp_catalog_number = 7 JOIN ship_mode sm ON sm.sm_carrier IN ('ZHOU', 'DHL', 'GREAT EASTERN', 'USPS', 'PRIVATECARRIER', 'LATVIAN') CROSS JOIN (SELECT AVG(ss_net_paid) as avg_net_paid FROM store_sales) AS avg_sales WHERE ss.ss_store_sk = 7 AND c.c_preferred_cust_flag = 'Y' AND c.c_birth_country IN ('LIECHTENSTEIN', 'ETHIOPIA', 'DENMARK', 'SLOVAKIA') GROUP BY cp.cp_department, sm.sm_carrier ORDER BY total_net_sales DESC, cp.cp_department, sm.sm_carrier;
SELECT d_year AS "Year", p_promo_name AS "Promotion Name", COUNT(cr_order_number) AS "Total Returns", SUM(cr_return_quantity) AS "Total Returned Quantity", SUM(cr_return_amount) AS "Total Returned Amount", AVG(cr_return_amount) AS "Average Return Amount", SUM(cr_net_loss) AS "Total Net Loss" FROM catalog_returns cr JOIN date_dim d ON cr.cr_returned_date_sk = d.d_date_sk JOIN promotion p ON d.d_date_sk BETWEEN p.p_start_date_sk AND p.p_end_date_sk WHERE p.p_end_date_sk IN ('2450731', '2450673', '2450658', '2450718') GROUP BY "Year", "Promotion Name" ORDER BY "Year", "Total Returned Amount" DESC;
SELECT cc.cc_call_center_id, cc.cc_name, cc.cc_city, cc.cc_state, SUM(cs.cs_net_paid_inc_tax) AS total_revenue, SUM(cs.cs_net_profit) AS total_profit, AVG(cs.cs_net_paid_inc_tax) AS average_revenue_per_sale, COUNT(DISTINCT cs.cs_order_number) AS total_orders, s.s_store_name, s.s_company_name AS store_company_name FROM call_center cc JOIN catalog_sales cs ON cc.cc_call_center_sk = cs.cs_call_center_sk JOIN store s ON s.s_store_sk = cc.cc_call_center_sk WHERE cc.cc_rec_start_date <= CURRENT_DATE AND (cc.cc_rec_end_date IS NULL OR cc.cc_rec_end_date > CURRENT_DATE) AND s.s_rec_start_date <= CURRENT_DATE AND (s.s_rec_end_date IS NULL OR s.s_rec_end_date > CURRENT_DATE) AND cs.cs_net_paid_inc_tax > 300 GROUP BY cc.cc_call_center_id, cc.cc_name, cc.cc_city, cc.cc_state, s.s_store_name, s.s_company_name ORDER BY total_revenue DESC, total_profit DESC LIMIT 100;
SELECT ws.web_site_id, st.s_store_name, hd.hd_buy_potential, ws_cat.avg_sales_price, ws_cat.total_quantity_sold, ws_cat.total_net_profit, ws_cat.avg_coupon_amt_used FROM web_site ws JOIN (SELECT ws_web_site_sk, AVG(ws_sales_price) AS avg_sales_price, SUM(ws_quantity) AS total_quantity_sold, SUM(ws_net_profit) AS total_net_profit, AVG(ws_coupon_amt) AS avg_coupon_amt_used FROM web_sales GROUP BY ws_web_site_sk ) ws_cat ON ws_cat.ws_web_site_sk = ws.web_site_sk JOIN store st ON ws.web_mkt_id = st.s_market_id JOIN household_demographics hd ON ws_cat.avg_sales_price BETWEEN hd.hd_income_band_sk AND hd.hd_income_band_sk * 10 WHERE ws.web_open_date_sk IN ('2450594', '2450645', '2450679', '2450798', '2450696') AND st.s_rec_start_date BETWEEN '1997-03-13' AND '2001-03-13' AND hd.hd_buy_potential IN ('0-500', 'Unknown', '1001-5000') GROUP BY ws.web_site_id, st.s_store_name, hd.hd_buy_potential, ws_cat.avg_sales_price, ws_cat.total_quantity_sold, ws_cat.total_net_profit, ws_cat.avg_coupon_amt_used ORDER BY ws.web_site_id, st.s_store_name, hd.hd_buy_potential;
SELECT cc.cc_name, cc.cc_city, cc.cc_state, SUM(ss.ss_quantity) AS total_quantity_sold, AVG(ss.ss_sales_price) AS average_sales_price, COUNT(DISTINCT c.c_customer_sk) AS unique_customers, MAX(ss.ss_net_paid_inc_tax) AS max_payment_received, MIN(ss.ss_net_paid_inc_tax) AS min_payment_received FROM call_center cc JOIN store_sales ss ON cc.cc_call_center_sk = ss.ss_store_sk JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk WHERE cc.cc_rec_start_date BETWEEN '1998-01-01' AND '2001-01-01' AND cc.cc_mkt_desc LIKE '%Rich groups catch longer other fears; future,%' GROUP BY cc.cc_name, cc.cc_city, cc.cc_state ORDER BY total_quantity_sold DESC, average_sales_price DESC;
SELECT cp.cp_department, COUNT(DISTINCT cr.cr_order_number) AS total_returns, SUM(cr.cr_return_amount) AS total_return_amount, AVG(cr.cr_return_amount) AS avg_return_amount, SUM(cr.cr_return_quantity) AS total_return_quantity, AVG(cr.cr_fee) AS avg_fee, i.i_category, i.i_class, COUNT(DISTINCT c.c_customer_sk) AS total_customers, AVG(hd.hd_vehicle_count) AS avg_vehicle_count, SUM(wr.wr_account_credit) AS total_account_credit FROM catalog_page cp JOIN catalog_returns cr ON cp.cp_catalog_page_sk = cr.cr_catalog_page_sk JOIN item i ON cr.cr_item_sk = i.i_item_sk JOIN customer c ON cr.cr_returning_customer_sk = c.c_customer_sk JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk JOIN web_returns wr ON i.i_item_sk = wr.wr_item_sk AND cr.cr_order_number = wr.wr_order_number WHERE i.i_formulation IN ('83313678042thistle61', '41681222olive4963389', '57585sienna024168653') AND i.i_product_name IN ('oughtbarn stpri', 'oughteingeingable', 'barcallycally', 'antieseantiable', 'antiprioughtable', 'priationpri') AND wr.wr_account_credit IN ('8.73', '59.44', '133.59') AND hd.hd_vehicle_count IN ('4', '2', '0', '1') AND c.c_email_address = 'Andrew.Lowery@T7T4.com' GROUP BY cp.cp_department, i.i_category, i.i_class ORDER BY total_return_amount DESC, avg_vehicle_count DESC, total_account_credit DESC;
SELECT s_state, EXTRACT(YEAR FROM s_rec_start_date) AS year_started, COUNT(DISTINCT s_store_sk) AS number_of_stores, SUM(s_number_employees) AS total_employees, SUM(s_floor_space) AS total_floor_space, AVG(s_tax_precentage) AS avg_tax_percentage, SUM(inv_quantity_on_hand) AS total_inventory, AVG(hd_dep_count) AS avg_dependents, AVG(hd_vehicle_count) AS avg_vehicles, COUNT(DISTINCT p_promo_sk) AS num_promotions, SUM(CASE WHEN p_channel_email = 'Y' THEN p_cost ELSE 0 END) AS email_promotion_cost, SUM(CASE WHEN p_channel_tv = 'Y' THEN p_cost ELSE 0 END) AS tv_promotion_cost, SUM(CASE WHEN p_discount_active = 'Y' THEN 1 ELSE 0 END) AS active_discounts, COUNT(DISTINCT wp_web_page_sk) AS webpage_count, SUM(wp_link_count) AS total_links FROM store LEFT JOIN inventory ON s_store_sk = inv_warehouse_sk AND inv_date_sk = 2450815 LEFT JOIN household_demographics ON s_market_id = hd_income_band_sk LEFT JOIN promotion ON s_store_sk = p_item_sk LEFT JOIN web_page ON wp_access_date_sk = inv_date_sk GROUP BY s_state, year_started ORDER BY s_state, year_started;
