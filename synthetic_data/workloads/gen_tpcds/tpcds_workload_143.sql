SELECT cp.cp_department, i.i_category, i.i_brand, sm.sm_type, SUM(ss.ss_quantity) AS total_quantity_sold, AVG(ss.ss_sales_price) AS average_sales_price, COUNT(DISTINCT ss.ss_customer_sk) AS unique_customers, SUM(ss.ss_net_profit) AS total_net_profit FROM store_sales ss JOIN item i ON ss.ss_item_sk = i.i_item_sk JOIN catalog_page cp ON i.i_item_sk = cp.cp_catalog_page_sk JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk JOIN ship_mode sm ON sm.sm_ship_mode_sk = ss.ss_item_sk WHERE cp.cp_type IN ('quarterly', 'bi-annual', 'monthly') AND cp.cp_description LIKE '%services%' AND i.i_product_name IN ('antin stpriought', 'eingcallyoughtable', 'antieseationese') AND ss.ss_coupon_amt IN (0.70, 58.75, 218.97) AND sm.sm_code IN ('SEA', 'BIKE', 'AIR', 'SURFACE') GROUP BY cp.cp_department, i.i_category, i.i_brand, sm.sm_type ORDER BY total_net_profit DESC, total_quantity_sold DESC;
SELECT ws_site.web_name, ws_site.web_manager, ws_site.web_mkt_class, ws_site.web_mkt_desc, SUM(ws.ws_quantity) AS total_quantity_sold, AVG(ws.ws_sales_price) AS average_sales_price, COUNT(DISTINCT ws.ws_order_number) AS total_orders, SUM(ws.ws_net_profit) AS total_net_profit FROM web_sales ws JOIN web_site ws_site ON ws.ws_web_site_sk = ws_site.web_site_sk WHERE ws.ws_ship_date_sk IN (2451986, 2451883) AND ws_site.web_company_name IN ('ought', 'cally', 'anti', 'able') AND ws_site.web_market_manager IN ('Joe George', 'Frank Cooper', 'Jeffrey Martin') GROUP BY ws_site.web_name, ws_site.web_manager, ws_site.web_mkt_class, ws_site.web_mkt_desc ORDER BY total_net_profit DESC;
SELECT cd.cd_education_status, cd.cd_gender, cd.cd_marital_status, cd.cd_credit_rating, SUM(wr.wr_return_amt_inc_tax) AS total_return_amount_incl_tax, AVG(wr.wr_return_amt_inc_tax) AS avg_return_amount_incl_tax, COUNT(wr.wr_returned_date_sk) AS total_returns, p.p_channel_email, p.p_channel_dmail, p.p_channel_catalog, p.p_channel_tv, p.p_channel_radio, p.p_channel_press, p.p_channel_event, p.p_channel_demo FROM web_returns wr JOIN customer_demographics cd ON wr.wr_returning_cdemo_sk = cd.cd_demo_sk JOIN promotion p ON wr.wr_item_sk = p.p_item_sk WHERE wr.wr_fee IN (16.46, 25.83, 12.23, 28.11, 82.98) AND wr.wr_reversed_charge = 33.99 AND cd.cd_dep_employed_count = 0 GROUP BY cd.cd_education_status, cd.cd_gender, cd.cd_marital_status, cd.cd_credit_rating, p.p_channel_email, p.p_channel_dmail, p.p_channel_catalog, p.p_channel_tv, p.p_channel_radio, p.p_channel_press, p.p_channel_event, p.p_channel_demo ORDER BY total_return_amount_incl_tax DESC;
SELECT ca.ca_state AS state, dd.d_year AS year, COUNT(sr.sr_ticket_number) AS total_returns, AVG(sr.sr_return_amt) AS avg_return_amount, SUM(sr.sr_return_quantity) AS total_returned_quantity, SUM(sr.sr_net_loss) AS total_net_loss FROM store_returns sr JOIN customer_address ca ON sr.sr_addr_sk = ca.ca_address_sk JOIN date_dim dd ON sr.sr_returned_date_sk = dd.d_date_sk WHERE ca.ca_zip IN ('60534', '57995', '13951') GROUP BY ca.ca_state, dd.d_year ORDER BY state, year;
SELECT COUNT(DISTINCT cc.cc_call_center_sk) AS num_call_centers, AVG(cc.cc_employees) AS avg_employees, SUM(sr.sr_return_amt_inc_tax) AS total_store_returns_inc_tax, AVG(wr.wr_return_amt_inc_tax) AS avg_web_returns_inc_tax, COUNT(DISTINCT wr.wr_web_page_sk) AS num_web_pages_with_returns, COUNT(DISTINCT sr.sr_reason_sk) AS num_unique_return_reasons_store, COUNT(DISTINCT wr.wr_reason_sk) AS num_unique_return_reasons_web, SUM(CASE WHEN sr.sr_return_quantity > 0 THEN 1 ELSE 0 END) AS num_store_returns_with_quantity, SUM(CASE WHEN wr.wr_return_quantity > 0 THEN 1 ELSE 0 END) AS num_web_returns_with_quantity, SUM(CASE WHEN ws.web_mkt_id = 3 THEN 1 ELSE 0 END) AS num_websites_market_id_3 FROM call_center cc LEFT JOIN store_returns sr ON cc.cc_call_center_sk = sr.sr_store_sk LEFT JOIN web_returns wr ON cc.cc_call_center_sk = wr.wr_refunded_addr_sk LEFT JOIN web_site ws ON cc.cc_call_center_sk = ws.web_site_sk GROUP BY cc.cc_division ORDER BY total_store_returns_inc_tax DESC;
SELECT i.i_category, s.s_state, s.s_market_id, COUNT(DISTINCT i.i_item_sk) AS total_items, AVG(i.i_current_price) AS avg_price, SUM(i.i_wholesale_cost) AS total_wholesale_cost, COUNT(DISTINCT wp.wp_web_page_sk) AS total_web_pages, wp.wp_type, COUNT(DISTINCT wp.wp_customer_sk) AS total_customers_accessed FROM item i JOIN store s ON i.i_manufact_id = s.s_company_id JOIN web_page wp ON wp.wp_type = 'order' WHERE i.i_category IN ('Books', 'Sports', 'Women', 'Men') AND s.s_state = 'TN' AND s.s_market_id = '7' AND i.i_current_price BETWEEN 2.21 AND 81.80 AND (wp.wp_creation_date_sk BETWEEN '2450811' AND '2450813' OR wp.wp_creation_date_sk = '2450808') GROUP BY i.i_category, s.s_state, s.s_market_id, wp.wp_type ORDER BY total_items DESC, avg_price DESC, total_wholesale_cost DESC;
SELECT cd.cd_education_status, d.d_year, SUM(ss_ext_sales_price) AS total_sales, AVG(ss_ext_sales_price) AS avg_sales_amount, COUNT(cr.cr_order_number) AS total_returns, AVG(cr.cr_return_amount) AS avg_return_amount FROM customer_demographics cd JOIN store_sales ss ON cd.cd_demo_sk = ss.ss_cdemo_sk JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk LEFT JOIN catalog_returns cr ON ss.ss_ticket_number = cr.cr_order_number WHERE d.d_year IN (1998, 1999, 2000) GROUP BY cd.cd_education_status, d.d_year ORDER BY cd.cd_education_status, d.d_year;
SELECT ca.ca_state AS customer_state, r.r_reason_desc AS return_reason, COUNT(DISTINCT sr.sr_ticket_number) AS total_returns, SUM(sr.sr_return_amt) AS total_return_amt, SUM(sr.sr_return_tax) AS total_return_tax, SUM(sr.sr_net_loss) AS total_net_loss FROM store_returns sr JOIN customer_address ca ON sr.sr_addr_sk = ca.ca_address_sk JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk GROUP BY ca.ca_state, r.r_reason_desc ORDER BY ca.ca_state, r.r_reason_desc;
SELECT ib.ib_income_band_sk, ib.ib_lower_bound, ib.ib_upper_bound, COUNT(DISTINCT cs.cs_order_number) AS total_orders, SUM(cs.cs_net_paid_inc_ship) AS total_revenue_inc_ship, AVG(cs.cs_net_paid_inc_tax) AS avg_revenue_inc_tax, wp.wp_type, COUNT(wp.wp_web_page_sk) AS page_count, SUM(wp.wp_image_count) AS total_image_count, r.r_reason_desc, COUNT(r.r_reason_sk) AS reason_count FROM catalog_sales cs JOIN income_band ib ON cs.cs_bill_hdemo_sk = ib.ib_income_band_sk JOIN web_page wp ON cs.cs_catalog_page_sk = wp.wp_web_page_sk LEFT JOIN reason r ON cs.cs_ship_mode_sk = r.r_reason_sk WHERE cs.cs_ship_cdemo_sk IN ('895212', '186278', '897167') AND cs.cs_net_paid_inc_ship IN (3933.80, 801.00, 5246.97) AND cs.cs_net_paid_inc_tax IN (103.42, 7068.42, 500.16) AND cs.cs_sold_date_sk IN (2450829, 2450822, 2450816) AND r.r_reason_desc IN ('Wrong size', 'No service location in my area', 'Lost my job') AND r.r_reason_id IN ('AAAAAAAANAAAAAAA', 'AAAAAAAAOAAAAAAA', 'AAAAAAAACCAAAAAA') AND r.r_reason_sk IN (11, 14, 19) AND wp.wp_autogen_flag IN ('N', 'Y') AND wp.wp_type IN ('ad', 'order', 'dynamic') AND wp.wp_image_count IN (1, 3, 6) AND wp.wp_web_page_sk IN (44, 58, 40) AND ib.ib_upper_bound IN (70000, 200000, 140000) AND ib.ib_income_band_sk IN (10, 15, 2) AND ib.ib_lower_bound IN (130001, 190001, 20001) GROUP BY ib.ib_income_band_sk, wp.wp_type, r.r_reason_desc ORDER BY total_revenue_inc_ship DESC, avg_revenue_inc_tax DESC, total_orders DESC, page_count DESC, total_image_count DESC, reason_count DESC;
SELECT s_state, i_category, COUNT(DISTINCT i_item_sk) AS num_items, SUM(i_current_price) AS total_current_price, AVG(i_wholesale_cost) AS avg_wholesale_cost, COUNT(DISTINCT w_warehouse_sk) AS num_warehouses, SUM(w_warehouse_sq_ft) AS total_warehouse_sq_ft, COUNT(DISTINCT wp_web_page_sk) AS num_web_pages, AVG(wp_char_count) AS avg_char_count_on_web_pages FROM store JOIN item ON (s_store_sk = i_manufact_id) JOIN warehouse ON (s_zip = w_zip) JOIN web_page ON (wp_access_date_sk = '2452583' OR wp_access_date_sk = '2452565' OR wp_access_date_sk = '2452618') WHERE s_state IN ('CA', 'TX', 'NY') AND i_category IN ('Electronics', 'Clothing', 'Furniture') GROUP BY s_state, i_category ORDER BY s_state, i_category;
SELECT d.d_year, i.i_category, SUM(sr.sr_return_amt) AS total_return_amount, AVG(sr.sr_return_quantity) AS avg_return_quantity, COUNT(DISTINCT sr.sr_customer_sk) AS unique_customers, w.w_state, w.w_city FROM store_returns sr JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk JOIN item i ON sr.sr_item_sk = i.i_item_sk JOIN warehouse w ON sr.sr_addr_sk = w.w_warehouse_sk WHERE d.d_year = 2023 AND i.i_category_id BETWEEN 1 AND 100 AND w.w_suite_number IN ('Suite 80', 'Suite 0', 'Suite P', 'Suite 470') GROUP BY d.d_year, i.i_category, w.w_state, w.w_city ORDER BY total_return_amount DESC, avg_return_quantity DESC;
SELECT i.i_category, i.i_brand, ca.ca_state, ca.ca_city, SUM(sr.sr_return_amt) AS total_return_amount, AVG(i.i_current_price) AS average_item_price, COUNT(DISTINCT sr.sr_ticket_number) AS total_returns, SUM(CASE WHEN p.p_promo_sk IS NOT NULL THEN sr.sr_return_quantity ELSE 0 END) AS promo_return_quantity, SUM(CASE WHEN p.p_promo_sk IS NULL THEN sr.sr_return_quantity ELSE 0 END) AS no_promo_return_quantity FROM store_returns sr JOIN item i ON sr.sr_item_sk = i.i_item_sk LEFT JOIN promotion p ON i.i_item_sk = p.p_item_sk JOIN customer_address ca ON sr.sr_addr_sk = ca.ca_address_sk WHERE i.i_category_id IN ('4', '2') AND i.i_container <> 'Unknown' GROUP BY i.i_category, i.i_brand, ca.ca_state, ca.ca_city ORDER BY total_return_amount DESC, average_item_price DESC, total_returns DESC;
SELECT i.i_category, i.i_brand, COUNT(DISTINCT i.i_item_sk) AS num_items, SUM(i.i_current_price) AS total_current_price, AVG(i.i_wholesale_cost) AS avg_wholesale_cost, COUNT(DISTINCT c.c_customer_sk) AS num_customers, AVG(c.c_birth_year) AS avg_customer_birth_year, r.r_reason_desc, COUNT(*) AS num_return_reasons FROM item i JOIN customer c ON i.i_manager_id = c.c_current_cdemo_sk LEFT JOIN reason r ON r.r_reason_desc IN ('Package was damaged', 'Did not like the make', 'Parts missing') WHERE i.i_rec_start_date >= '2020-01-01' AND (i.i_rec_end_date IS NULL OR i.i_rec_end_date > CURRENT_DATE) GROUP BY i.i_category, i.i_brand, r.r_reason_desc ORDER BY i.i_category, i.i_brand, r.r_reason_desc;
SELECT ca_state, ca_country, w_state, w_country, SUM(sr_return_quantity) AS total_returned_quantity, AVG(sr_return_amt) AS average_return_amount, SUM(sr_fee) AS total_fees, COUNT(DISTINCT sr_customer_sk) AS unique_customers_returning, COUNT(DISTINCT sr_ticket_number) AS total_return_transactions FROM store_returns JOIN customer_address ON store_returns.sr_addr_sk = customer_address.ca_address_sk JOIN warehouse ON store_returns.sr_store_sk = warehouse.w_warehouse_sk WHERE customer_address.ca_gmt_offset IN (-6.00, -10.00, -8.00, -9.00, -7.00) AND warehouse.w_zip = '35709' AND store_returns.sr_addr_sk = '47239' GROUP BY ca_state, ca_country, w_state, w_country ORDER BY ca_state, ca_country;
SELECT sm.sm_ship_mode_id, sm.sm_type, cd.cd_credit_rating, COUNT(DISTINCT ws.ws_order_number) AS total_sales_transactions, AVG(ws.ws_net_paid_inc_tax) AS avg_sales_amount, COUNT(DISTINCT cr.cr_order_number) AS total_return_transactions, AVG(cr.cr_return_amt_inc_tax) AS avg_return_amount, SUM(ws.ws_quantity) AS total_quantity_sold, SUM(cr.cr_return_quantity) AS total_quantity_returned FROM ship_mode sm LEFT JOIN web_sales ws ON sm.sm_ship_mode_sk = ws.ws_ship_mode_sk LEFT JOIN catalog_returns cr ON ws.ws_order_number = cr.cr_order_number LEFT JOIN customer_demographics cd ON ws.ws_ship_cdemo_sk = cd.cd_demo_sk WHERE sm.sm_ship_mode_id IN ('AAAAAAAANAAAAAAA', 'AAAAAAAADBAAAAAA', 'AAAAAAAADAAAAAAA', 'AAAAAAAACAAAAAAA') AND cd.cd_credit_rating IN ('Low Risk', 'High Risk', 'Unknown', 'Good') GROUP BY sm.sm_ship_mode_id, sm.sm_type, cd.cd_credit_rating ORDER BY sm.sm_ship_mode_id, cd.cd_credit_rating;
SELECT ca.ca_county, ca.ca_state, w.w_warehouse_name, hd.hd_income_band_sk, SUM(inv.inv_quantity_on_hand) AS total_quantity_on_hand, AVG(hd.hd_dep_count) AS average_dependency_count, AVG(hd.hd_vehicle_count) AS average_vehicle_count, COUNT(DISTINCT ca.ca_address_sk) AS total_addresses, COUNT(DISTINCT hd.hd_demo_sk) AS total_households FROM inventory inv JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk JOIN customer_address ca ON ca.ca_state = w.w_state JOIN household_demographics hd ON ca.ca_zip = w.w_zip WHERE ca.ca_county = 'Jeff Davis County' AND (ca.ca_zip = '78482' OR ca.ca_zip = '48054') AND (inv.inv_warehouse_sk = 1 OR inv.inv_warehouse_sk = 2) AND (inv.inv_item_sk IN (7786, 9218, 15079, 13832, 11164)) GROUP BY ca.ca_county, ca.ca_state, w.w_warehouse_name, hd.hd_income_band_sk ORDER BY ca.ca_county, ca.ca_state, w.w_warehouse_name, hd.hd_income_band_sk;
SELECT cp.cp_department, SUM(ws.ws_net_profit) AS total_web_sales_profit, AVG(ws.ws_quantity) AS avg_web_sales_quantity, COUNT(DISTINCT ws.ws_order_number) AS total_web_orders, SUM(cr.cr_net_loss) AS total_catalog_returns_loss, AVG(cr.cr_return_quantity) AS avg_catalog_return_quantity, COUNT(DISTINCT cr.cr_order_number) AS total_catalog_returns, SUM(sr.sr_net_loss) AS total_store_returns_loss, AVG(sr.sr_return_quantity) AS avg_store_return_quantity, COUNT(DISTINCT sr.sr_ticket_number) AS total_store_returns, SUM(CASE WHEN p.p_channel_dmail = 'Y' THEN p.p_cost ELSE 0 END) AS total_promo_cost_via_dmail, COUNT(CASE WHEN p.p_channel_demo = 'N' AND p.p_channel_catalog = 'N' THEN p.p_promo_sk END) AS count_non_demo_catalog_promos FROM catalog_page cp LEFT JOIN web_sales ws ON cp.cp_catalog_page_sk = ws.ws_web_page_sk LEFT JOIN catalog_returns cr ON cp.cp_catalog_page_sk = cr.cr_catalog_page_sk LEFT JOIN store_returns sr ON sr.sr_item_sk = ws.ws_item_sk LEFT JOIN promotion p ON ws.ws_promo_sk = p.p_promo_sk WHERE cp.cp_start_date_sk IS NOT NULL AND cp.cp_end_date_sk IS NOT NULL AND ws.ws_sold_date_sk BETWEEN cp.cp_start_date_sk AND cp.cp_end_date_sk GROUP BY cp.cp_department ORDER BY total_web_sales_profit DESC, total_catalog_returns_loss ASC, total_store_returns_loss ASC;
SELECT cp.cp_department, ca.ca_city, ca.ca_state, COUNT(wr.wr_item_sk) AS total_returns, SUM(wr.wr_return_quantity) AS total_returned_quantity, AVG(wr.wr_return_amt) AS average_return_amount, SUM(wr.wr_return_amt_inc_tax) AS total_return_amount_including_tax, SUM(wr.wr_fee) AS total_fees, SUM(wr.wr_return_ship_cost) AS total_shipping_cost, SUM(wr.wr_net_loss) AS total_net_loss FROM catalog_page cp JOIN web_returns wr ON cp.cp_catalog_page_sk = wr.wr_web_page_sk JOIN customer_address ca ON wr.wr_returning_addr_sk = ca.ca_address_sk WHERE cp.cp_catalog_page_id IN ('AAAAAAAAPOGAAAAA', 'AAAAAAAABBCAAAAA', 'AAAAAAAAGGCAAAAA') AND ca.ca_location_type IN ('single family', 'apartment', 'condo') GROUP BY cp.cp_department, ca.ca_city, ca.ca_state ORDER BY total_net_loss DESC, average_return_amount DESC LIMIT 100;
SELECT w_state, w_city, ib.ib_income_band_sk AS income_band_sk, p_promo_name, COUNT(DISTINCT w.w_warehouse_sk) AS num_warehouses, SUM(w.w_warehouse_sq_ft) AS total_warehouse_sq_ft, AVG(w.w_warehouse_sq_ft) AS avg_warehouse_sq_ft, SUM(wr_return_amt_inc_tax) AS total_return_amount_inc_tax, COUNT(DISTINCT wr.wr_returned_date_sk) AS num_return_days, AVG(wr_return_amt_inc_tax) AS avg_return_amount_inc_tax FROM warehouse w JOIN web_returns wr ON w.w_warehouse_sk = wr.wr_returning_addr_sk JOIN income_band ib ON ib.ib_income_band_sk = wr.wr_returning_hdemo_sk JOIN promotion p ON p.p_item_sk = wr.wr_item_sk WHERE w_state = 'TN' AND w_city = 'Fairview' AND wr_reason_sk IN (7, 17, 21, 6) AND ib_upper_bound IN (50000, 190000, 80000) AND wr_returning_hdemo_sk IN (4812, 3393, 981, 1249) GROUP BY w_state, w_city, ib.ib_income_band_sk, p_promo_name ORDER BY total_return_amount_inc_tax DESC LIMIT 100;
