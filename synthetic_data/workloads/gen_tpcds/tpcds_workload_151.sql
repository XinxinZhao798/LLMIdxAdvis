SELECT hd.hd_vehicle_count AS "Vehicle Count", COUNT(DISTINCT ws.ws_order_number) AS "Number of Orders", SUM(ws.ws_sales_price) AS "Total Sales Amount", AVG(ws.ws_sales_price) AS "Average Sales Price", COUNT(ws.ws_item_sk) AS "Items Sold", p.p_promo_name AS "Promotion Name", CASE WHEN p.p_discount_active = 'Y' THEN 'Discount Active' ELSE 'No Discount' END AS "Discount Status" FROM web_sales ws JOIN promotion p ON ws.ws_promo_sk = p.p_promo_sk JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk WHERE p.p_discount_active = 'Y' AND hd.hd_vehicle_count IN (0, 2, 3) GROUP BY hd.hd_vehicle_count, p.p_promo_name, p.p_discount_active ORDER BY "Total Sales Amount" DESC, "Vehicle Count";
SELECT cp_department, SUM(ws_quantity) AS total_quantity_sold, AVG(ws_sales_price) AS average_sales_price, COUNT(DISTINCT ws_bill_customer_sk) AS unique_customers, COUNT(DISTINCT ws_web_page_sk) AS page_views, SUM(ws_net_paid) AS total_net_paid, SUM(ws_net_profit) AS total_net_profit FROM web_sales JOIN catalog_page ON web_sales.ws_web_page_sk = catalog_page.cp_catalog_page_sk WHERE catalog_page.cp_catalog_number IN (20, 25, 19) AND catalog_page.cp_department = 'DEPARTMENT' GROUP BY cp_department ORDER BY total_net_profit DESC;
SELECT s.s_division_id AS store_division_id, s.s_division_name AS store_division_name, hd.hd_income_band_sk AS household_income_band, COUNT(DISTINCT ws.ws_order_number) AS total_web_sales, AVG(ws.ws_sales_price) AS average_sales_price, COUNT(DISTINCT sr.sr_ticket_number) AS total_store_returns, AVG(sr.sr_return_amt) AS average_return_amount FROM store s LEFT JOIN web_sales ws ON s.s_store_sk = ws.ws_ship_customer_sk LEFT JOIN store_returns sr ON s.s_store_sk = sr.sr_store_sk LEFT JOIN household_demographics hd ON (ws.ws_ship_hdemo_sk = hd.hd_demo_sk OR sr.sr_hdemo_sk = hd.hd_demo_sk) WHERE ws.ws_order_number IS NOT NULL OR sr.sr_ticket_number IS NOT NULL GROUP BY s.s_division_id, s.s_division_name, hd.hd_income_band_sk ORDER BY s.s_division_id, hd.hd_income_band_sk;
SELECT d_year, i_category, COUNT(DISTINCT cs_order_number) AS total_orders, SUM(cs_quantity) AS total_quantity_sold, SUM(cs_net_paid) AS total_sales, AVG(cs_net_profit) AS average_profit_per_sale, SUM(cr_return_quantity) AS total_quantity_returned, SUM(cr_return_amount) AS total_returns, AVG(cr_net_loss) AS average_loss_per_return FROM catalog_sales JOIN item ON cs_item_sk = i_item_sk JOIN date_dim ON cs_sold_date_sk = d_date_sk LEFT JOIN catalog_returns ON cs_order_number = cr_order_number AND cs_item_sk = cr_item_sk WHERE (i_class_id IN (7, 14, 9)) AND (cr_reason_sk IN (17, 4, 20, 34, 25) OR cr_reason_sk IS NULL) AND (cs_coupon_amt IN (1589.39, 1893.80, 3358.21) OR cs_coupon_amt IS NULL) AND (catalog_sales.cs_ext_wholesale_cost IN (936.76, 3257.86) OR catalog_sales.cs_ext_wholesale_cost IS NULL) GROUP BY d_year, i_category ORDER BY d_year DESC, i_category;
SELECT cd.cd_education_status, ib.ib_lower_bound, ib.ib_upper_bound, AVG(cs.cs_sales_price) AS avg_sales_price, SUM(cs.cs_ext_discount_amt) AS total_discount, COUNT(cs.cs_order_number) AS total_orders FROM customer_demographics cd JOIN catalog_sales cs ON cd.cd_demo_sk = cs.cs_bill_cdemo_sk JOIN income_band ib ON (cd.cd_purchase_estimate BETWEEN ib.ib_lower_bound AND ib.ib_upper_bound) GROUP BY cd.cd_education_status, ib.ib_lower_bound, ib.ib_upper_bound ORDER BY cd.cd_education_status, ib.ib_lower_bound;
SELECT cd.cd_gender, cd.cd_marital_status, cd.cd_credit_rating, AVG(cd.cd_purchase_estimate) AS avg_purchase_estimate, SUM(sr.sr_return_amt_inc_tax) AS total_return_amount_inc_tax, COUNT(sr.sr_ticket_number) AS total_returns FROM customer_demographics cd JOIN store_returns sr ON cd.cd_demo_sk = sr.sr_cdemo_sk JOIN household_demographics hd ON sr.sr_hdemo_sk = hd.hd_demo_sk WHERE hd.hd_buy_potential IN ('5001-10000', '>10000') AND sr.sr_reversed_charge > 50 GROUP BY cd.cd_gender, cd.cd_marital_status, cd.cd_credit_rating HAVING AVG(cd.cd_purchase_estimate) > 500 ORDER BY avg_purchase_estimate DESC, total_return_amount_inc_tax DESC;
SELECT cd.cd_gender, ib.ib_lower_bound AS income_lower_bound, ib.ib_upper_bound AS income_upper_bound, sm.sm_type AS shipping_type, COUNT(sr.sr_return_amt) AS total_returns, SUM(sr.sr_return_amt) AS total_value_of_returns, AVG(sr.sr_return_amt) AS average_return_value, SUM(sr.sr_return_quantity) AS total_quantity_returned FROM store_returns sr JOIN customer_demographics cd ON sr.sr_cdemo_sk = cd.cd_demo_sk JOIN income_band ib ON cd.cd_purchase_estimate BETWEEN ib.ib_lower_bound AND ib.ib_upper_bound JOIN ship_mode sm ON sm.sm_ship_mode_sk = sr.sr_item_sk WHERE sm.sm_type IN ('OVERNIGHT') AND cd.cd_gender IN ('M', 'F') GROUP BY cd.cd_gender, income_lower_bound, income_upper_bound, shipping_type ORDER BY total_value_of_returns DESC, total_returns DESC;
SELECT cc_state, ca_location_type, COUNT(DISTINCT ws_order_number) AS total_orders, SUM(ws_quantity) AS total_quantity_sold, AVG(ws_sales_price) AS avg_sales_price, SUM(ws_net_paid) AS total_net_paid, SUM(ws_net_profit) AS total_net_profit FROM web_sales ws JOIN store s ON ws.ws_bill_addr_sk = s.s_store_sk JOIN call_center cc ON cc.cc_call_center_sk = ws.ws_ship_mode_sk JOIN customer_address ca ON ws.ws_bill_addr_sk = ca.ca_address_sk JOIN household_demographics hd ON ws.ws_bill_hdemo_sk = hd.hd_demo_sk WHERE ws.ws_item_sk IN (70, 58, 77) AND hd.hd_dep_count BETWEEN 1 AND 9 AND ca.ca_location_type IN ('single family', 'apartment', 'condo') AND ca.ca_city IN ('Ferguson', 'Holiday Hills') GROUP BY cc_state, ca_location_type ORDER BY total_net_profit DESC, total_net_paid DESC;
SELECT cc.cc_name, cc.cc_city, cc.cc_state, SUM(cr.cr_return_amount) AS total_return_amount, AVG(cr.cr_return_amount) AS avg_return_amount, COUNT(cr.cr_order_number) AS total_returns, SUM(cr.cr_return_quantity) AS total_returned_items, COUNT(DISTINCT cr.cr_returning_customer_sk) AS unique_returning_customers, SUM(case when hd.hd_dep_count IS NOT NULL THEN 1 ELSE 0 END) AS returns_with_dep_count, SUM(case when hd.hd_vehicle_count IS NOT NULL THEN 1 ELSE 0 END) AS returns_with_vehicle_count, COUNT(DISTINCT p.p_promo_sk) AS total_promotions_involved, SUM(p.p_cost) AS total_promotion_cost FROM call_center cc LEFT JOIN catalog_returns cr ON cc.cc_call_center_sk = cr.cr_call_center_sk LEFT JOIN household_demographics hd ON cr.cr_returning_hdemo_sk = hd.hd_demo_sk LEFT JOIN promotion p ON p.p_item_sk = cr.cr_item_sk WHERE cc.cc_company_name IN ('able', 'ought', 'cally', 'pri') AND cc.cc_hours IN ('8AM-4PM', '8AM-8AM') AND p.p_channel_tv = 'N' AND p.p_purpose = 'Unknown' AND cr.cr_refunded_cash IN ('5415.08', '1.89', '288.51', '2.49', '307.01') GROUP BY cc.cc_name, cc.cc_city, cc.cc_state ORDER BY total_return_amount DESC;
SELECT ca.ca_state AS customer_state, SUM(CASE WHEN dd.d_year = 2022 THEN ss.ss_net_paid ELSE 0 END) AS total_sales_2022, SUM(CASE WHEN dd.d_year = 2022 THEN sr.sr_return_amt ELSE 0 END) AS total_returns_2022, COUNT(DISTINCT CASE WHEN dd.d_year = 2022 THEN ss.ss_ticket_number ELSE NULL END) AS sales_transactions_2022, COUNT(DISTINCT CASE WHEN dd.d_year = 2022 THEN sr.sr_ticket_number ELSE NULL END) AS return_transactions_2022, SUM(CASE WHEN dd.d_year = 2023 THEN ss.ss_net_paid ELSE 0 END) AS total_sales_2023, SUM(CASE WHEN dd.d_year = 2023 THEN sr.sr_return_amt ELSE 0 END) AS total_returns_2023, COUNT(DISTINCT CASE WHEN dd.d_year = 2023 THEN ss.ss_ticket_number ELSE NULL END) AS sales_transactions_2023, COUNT(DISTINCT CASE WHEN dd.d_year = 2023 THEN sr.sr_ticket_number ELSE NULL END) AS return_transactions_2023 FROM store_sales ss FULL OUTER JOIN store_returns sr ON ss.ss_ticket_number = sr.sr_ticket_number AND ss.ss_item_sk = sr.sr_item_sk JOIN date_dim dd ON (ss.ss_sold_date_sk = dd.d_date_sk OR sr.sr_returned_date_sk = dd.d_date_sk) LEFT JOIN customer_address ca ON (ss.ss_addr_sk = ca.ca_address_sk OR sr.sr_addr_sk = ca.ca_address_sk) WHERE dd.d_year IN (2022, 2023) GROUP BY ca.ca_state ORDER BY ca.ca_state;
SELECT p.p_promo_name, cd.cd_gender, cd.cd_marital_status, cd.cd_education_status, COUNT(DISTINCT cs.cs_order_number) AS total_orders, SUM(cs.cs_quantity) AS total_quantity_sold, AVG(cs.cs_net_paid) AS avg_net_paid, SUM(cs.cs_net_paid_inc_tax) AS sum_net_paid_inc_tax, SUM(ws.ws_net_profit) AS sum_web_net_profit, COUNT(DISTINCT wr.wr_order_number) AS total_returns, SUM(wr.wr_return_amt) AS total_return_amount, AVG(wr.wr_fee) AS avg_return_fee FROM catalog_sales cs JOIN promotion p ON cs.cs_promo_sk = p.p_promo_sk JOIN customer_demographics cd ON cs.cs_bill_cdemo_sk = cd.cd_demo_sk JOIN web_sales ws ON cs.cs_order_number = ws.ws_order_number AND cs.cs_item_sk = ws.ws_item_sk LEFT JOIN web_returns wr ON ws.ws_order_number = wr.wr_order_number AND ws.ws_item_sk = wr.wr_item_sk WHERE cd.cd_credit_rating IN ('Good', 'Unknown') AND p.p_discount_active = 'N' AND cs.cs_net_paid_inc_tax NOT IN ('5209.58', '3100.79') AND NOT EXISTS ( SELECT 1 FROM reason r WHERE r.r_reason_sk = wr.wr_reason_sk AND r.r_reason_desc LIKE 'Wrong size' ) GROUP BY p.p_promo_name, cd.cd_gender, cd.cd_marital_status, cd.cd_education_status ORDER BY sum_net_paid_inc_tax DESC, total_orders DESC;
SELECT cp.cp_department, EXTRACT(YEAR FROM TO_DATE(cp.cp_end_date_sk::varchar, 'YYYYMMDD')) AS year_ended, hd.hd_income_band_sk, COUNT(DISTINCT sr.sr_customer_sk) AS num_customers_returned, SUM(sr.sr_return_quantity) AS total_returned_quantity, AVG(sr.sr_net_loss) AS average_net_loss, SUM(ss.ss_quantity) AS total_sold_quantity, SUM(ss.ss_net_profit) AS total_net_profit, AVG(c.c_birth_year) AS average_customer_birth_year FROM catalog_page cp JOIN store_returns sr ON cp.cp_catalog_page_sk = sr.sr_reason_sk JOIN store_sales ss ON sr.sr_item_sk = ss.ss_item_sk AND sr.sr_ticket_number = ss.ss_ticket_number JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk WHERE cp.cp_end_date_sk IN ('2451114', '2451084', '2451479') AND hd.hd_dep_count IN (3, 6, 7) AND c.c_birth_month IN (2, 6, 12) GROUP BY cp.cp_department, year_ended, hd.hd_income_band_sk ORDER BY total_net_profit DESC, average_net_loss, num_customers_returned;
SELECT cp.cp_department, COUNT(cs.cs_order_number) AS total_orders, SUM(cs.cs_net_paid) AS total_sales, AVG(cs.cs_sales_price) AS avg_sales_price, AVG(cs.cs_net_profit) AS avg_profit FROM catalog_sales cs JOIN catalog_page cp ON cs.cs_catalog_page_sk = cp.cp_catalog_page_sk JOIN web_site ws ON cp.cp_department = ws.web_class JOIN income_band ib ON cs.cs_bill_cdemo_sk = ib.ib_income_band_sk WHERE cp.cp_end_date_sk < 2450934 AND ws.web_tax_percentage IN (0.07, 0.08) AND ws.web_state = 'TN' AND ib.ib_upper_bound = 170000 GROUP BY cp.cp_department ORDER BY total_sales DESC;
SELECT p.p_promo_name AS promotion_name, i.ib_lower_bound AS income_band_lower_bound, i.ib_upper_bound AS income_band_upper_bound, COUNT(DISTINCT c.cd_demo_sk) AS number_of_customers, SUM(ss.ss_quantity) AS total_quantity_sold, AVG(ss.ss_sales_price) AS average_sales_price, SUM(ss.ss_net_paid) AS total_net_paid, SUM(ws.ws_net_paid_inc_tax) AS web_total_net_paid_inc_tax, COUNT(DISTINCT cp.cp_catalog_page_sk) AS number_of_catalog_pages_used, COUNT(DISTINCT inv.inv_item_sk) AS number_of_items_sold FROM store_sales ss JOIN promotion p ON ss.ss_promo_sk = p.p_promo_sk JOIN customer_demographics c ON ss.ss_cdemo_sk = c.cd_demo_sk JOIN income_band i ON c.cd_purchase_estimate BETWEEN i.ib_lower_bound AND i.ib_upper_bound JOIN web_sales ws ON ss.ss_item_sk = ws.ws_item_sk AND ss.ss_customer_sk = ws.ws_bill_customer_sk JOIN catalog_page cp ON ws.ws_web_page_sk = cp.cp_catalog_page_sk JOIN inventory inv ON ws.ws_item_sk = inv.inv_item_sk WHERE p.p_discount_active = 'Y' AND ss.ss_sold_date_sk BETWEEN 2451271 AND 2451575 AND cp.cp_start_date_sk BETWEEN 2451088 AND 2451420 AND inv.inv_quantity_on_hand > 0 GROUP BY promotion_name, income_band_lower_bound, income_band_upper_bound ORDER BY total_net_paid DESC, number_of_customers DESC;
SELECT ca.ca_state AS customer_state, ib.ib_income_band_sk AS income_band, date_dim.d_year AS sale_year, SUM(ss.ss_sales_price) AS total_sales, AVG(ss.ss_sales_price) AS avg_sales_price, COUNT(DISTINCT ss.ss_ticket_number) AS sales_transactions, SUM(wr.wr_return_amt) AS total_returns, AVG(wr.wr_return_amt) AS avg_return_amt, COUNT(DISTINCT wr.wr_order_number) AS return_transactions, (SUM(ss.ss_sales_price) - SUM(wr.wr_return_amt)) AS net_sales FROM store_sales ss LEFT JOIN web_returns wr ON ss.ss_item_sk = wr.wr_item_sk AND ss.ss_customer_sk = wr.wr_refunded_customer_sk INNER JOIN date_dim ON ss.ss_sold_date_sk = date_dim.d_date_sk INNER JOIN customer_address ca ON ss.ss_addr_sk = ca.ca_address_sk INNER JOIN income_band ib ON ss.ss_cdemo_sk = ib.ib_income_band_sk WHERE ca.ca_state IS NOT NULL AND date_dim.d_year >= 2000 GROUP BY ca.ca_state, ib.ib_income_band_sk, date_dim.d_year ORDER BY ca.ca_state, ib.ib_income_band_sk, date_dim.d_year;
SELECT ws.ws_web_site_sk, ws_site.web_site_id, COUNT(DISTINCT ws.ws_order_number) AS total_orders, SUM(ws.ws_quantity) AS total_quantity, AVG(ws.ws_sales_price) AS avg_sales_price, SUM(ws.ws_net_profit) AS total_net_profit, cc.cc_call_center_id, cc.cc_name, AVG(cc.cc_employees) AS avg_cc_employees, cd.cd_marital_status, COUNT(DISTINCT cd.cd_demo_sk) AS total_customers, AVG(cd.cd_purchase_estimate) AS avg_purchase_estimate, hd.hd_buy_potential, AVG(hd.hd_income_band_sk) AS avg_income_band FROM web_sales ws JOIN web_site ws_site ON ws.ws_web_site_sk = ws_site.web_site_sk JOIN call_center cc ON ws_site.web_mkt_id = cc.cc_mkt_id JOIN customer_demographics cd ON ws.ws_bill_cdemo_sk = cd.cd_demo_sk JOIN household_demographics hd ON ws.ws_bill_hdemo_sk = hd.hd_demo_sk WHERE ws.ws_sales_price > 0 AND ws.ws_sold_date_sk BETWEEN 2451569 AND 2452306 AND ws.ws_web_site_sk IN (4, 18, 20, 29, 27) AND cc.cc_call_center_sk IN (1, 4, 2) AND cd.cd_purchase_estimate > 5000 AND cd.cd_marital_status IN ('D', 'U', 'S', 'M', 'W') AND hd.hd_buy_potential IS NOT NULL GROUP BY ws.ws_web_site_sk, ws_site.web_site_id, cc.cc_call_center_id, cc.cc_name, cd.cd_marital_status, hd.hd_buy_potential ORDER BY total_net_profit DESC, avg_sales_price DESC LIMIT 100;
SELECT d_year, s_state, COUNT(DISTINCT cr_order_number) AS total_returns, SUM(cr_return_amount) AS total_return_amount, AVG(cr_return_quantity) AS avg_return_quantity, SUM(cr_net_loss) AS total_net_loss, COUNT(DISTINCT hd_demo_sk) AS unique_customers_returning, AVG(w_warehouse_sq_ft) AS avg_warehouse_size, SUM(wp_image_count) AS total_images_on_web_pages FROM catalog_returns JOIN date_dim ON catalog_returns.cr_returned_date_sk = date_dim.d_date_sk JOIN store ON store.s_store_sk = catalog_returns.cr_warehouse_sk JOIN household_demographics ON household_demographics.hd_demo_sk = catalog_returns.cr_returning_hdemo_sk JOIN warehouse ON warehouse.w_warehouse_sk = catalog_returns.cr_warehouse_sk JOIN web_page ON web_page.wp_web_page_sk = catalog_returns.cr_catalog_page_sk WHERE web_page.wp_web_page_id IN ('AAAAAAAAJBAAAAAA', 'AAAAAAAANAAAAAAA', 'AAAAAAAAGBAAAAAA') AND web_page.wp_image_count IN (5, 6, 3) AND store.s_geography_class = 'Unknown' AND store.s_store_sk IN (2, 1, 3) AND store.s_gmt_offset = '-5.00' AND store.s_rec_end_date IN ('1999-03-13', '2000-03-12', '2001-03-12') AND date_dim.d_first_dom IN (2419007, 2415690, 2416481) AND date_dim.d_dom IN (16, 4, 9) AND warehouse.w_warehouse_sq_ft IN (294242, 621234, 138504) AND warehouse.w_street_name IN ('Wilson Elm', 'Ash Laurel', 'View First') AND warehouse.w_zip = '35709' AND warehouse.w_warehouse_sk IN (1, 2, 5) AND household_demographics.hd_buy_potential IN ('501-1000', '0-500', '5001-10000') AND household_demographics.hd_vehicle_count IN (4, 3, 0) AND catalog_returns.cr_item_sk IN (16927, 16472, 1372) AND catalog_returns.cr_catalog_page_sk IN (402, 110, 207) AND catalog_returns.cr_refunded_customer_sk IN (57217, 356, 4491) AND catalog_returns.cr_returning_customer_sk IN (45137, 1961, 8472) GROUP BY d_year, s_state ORDER BY d_year, s_state;
SELECT c.c_first_name, c.c_last_name, COUNT(DISTINCT cr.cr_order_number) AS total_catalog_returns, SUM(cr.cr_return_amount) AS sum_catalog_returns, AVG(cr.cr_return_amount) AS avg_catalog_returns, COUNT(DISTINCT sr.sr_ticket_number) AS total_store_returns, SUM(sr.sr_return_amt) AS sum_store_returns, AVG(sr.sr_return_amt) AS avg_store_returns, COUNT(DISTINCT wr.wr_order_number) AS total_web_returns, SUM(wr.wr_return_amt) AS sum_web_returns, AVG(wr.wr_return_amt) AS avg_web_returns, SUM(cr.cr_return_amount + sr.sr_return_amt + wr.wr_return_amt) AS total_returned_amount, SUM(cr.cr_net_loss + sr.sr_net_loss + wr.wr_net_loss) AS total_net_loss FROM customer c LEFT JOIN catalog_returns cr ON c.c_customer_sk = cr.cr_refunded_customer_sk LEFT JOIN store_returns sr ON c.c_customer_sk = sr.sr_customer_sk LEFT JOIN web_returns wr ON c.c_customer_sk = wr.wr_refunded_customer_sk WHERE (cr.cr_refunded_addr_sk = 22501 OR sr.sr_customer_sk = 76655 OR wr.wr_returning_addr_sk IN (28032, 35974, 28752, 35185)) AND wr.wr_net_loss IN ('349.19', '1875.35', '119.73', '151.90', '2317.12', '1172.86') AND cr.cr_store_credit IN ('43.17', '27.97', '302.61', '30.81', '19.81', '561.19') AND EXISTS (SELECT 1 FROM web_page wp WHERE wp.wp_type = 'order' AND wp.wp_web_page_sk = wr.wr_web_page_sk) GROUP BY c.c_first_name, c.c_last_name ORDER BY total_returned_amount DESC, total_net_loss DESC;
SELECT cc.cc_name AS call_center_name, st.s_store_name AS store_name, st.s_state AS store_state, ws.web_name AS website_name, p.p_promo_name AS promotion_name, p.p_channel_details AS promotion_channel_details, SUM(ss.ss_quantity) AS total_quantity_sold, AVG(ss.ss_sales_price) AS average_sales_price, SUM(ss.ss_net_paid) AS total_net_sales, SUM(ss.ss_net_profit) AS total_net_profit FROM call_center cc JOIN store_sales ss ON cc.cc_call_center_sk = ss.ss_store_sk JOIN store st ON ss.ss_store_sk = st.s_store_sk JOIN web_site ws ON st.s_market_id = ws.web_mkt_id JOIN promotion p ON ss.ss_promo_sk = p.p_promo_sk WHERE cc.cc_manager IN ('Mark Hightower', 'Felipe Perkins', 'Bob Belcher') AND cc.cc_call_center_id = 'AAAAAAAAEAAAAAAA' AND st.s_market_id IN (4, 6, 7, 2, 8, 10) AND st.s_country = 'United States' AND p.p_start_date_sk IN (2450694, 2450318, 2450696, 2450508, 2450764, 2450750) AND ss.ss_customer_sk IN (169, 28519, 57009, 32392) GROUP BY call_center_name, store_name, store_state, website_name, promotion_name, promotion_channel_details ORDER BY total_net_sales DESC;
SELECT d_year, cp_department, sm_type, p_promo_name, COUNT(cs_order_number) AS total_orders, SUM(cs_quantity) AS total_quantity, AVG(cs_sales_price) AS average_sales_price, SUM(cs_net_paid_inc_ship_tax) AS total_revenue, SUM(cs_ext_tax) AS total_tax_collected, AVG(cs_net_profit) AS average_profit FROM catalog_sales JOIN date_dim ON cs_sold_date_sk = d_date_sk JOIN catalog_page ON cs_catalog_page_sk = cp_catalog_page_sk JOIN ship_mode ON cs_ship_mode_sk = sm_ship_mode_sk JOIN promotion ON cs_promo_sk = p_promo_sk WHERE d_year = 2001 AND cp_department LIKE 'Electronics%' AND sm_type = 'AIR' AND p_channel_event = 'N' AND cs_net_paid_inc_ship_tax BETWEEN 500 AND 8000 GROUP BY d_year, cp_department, sm_type, p_promo_name ORDER BY total_revenue DESC, average_profit DESC;
SELECT hd.hd_buy_potential, AVG(ss.ss_sales_price) AS avg_sales_price, SUM(ss.ss_quantity) AS total_quantity_sold, COUNT(DISTINCT ss.ss_customer_sk) AS unique_customers, SUM(sr.sr_return_amt_inc_tax) AS total_return_amount_incl_tax, COUNT(DISTINCT sr.sr_customer_sk) AS unique_customers_returned FROM store_sales ss LEFT JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk LEFT JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk LEFT JOIN store_returns sr ON ss.ss_customer_sk = sr.sr_customer_sk AND ss.ss_item_sk = sr.sr_item_sk GROUP BY hd.hd_buy_potential ORDER BY total_return_amount_incl_tax DESC;
SELECT cc.cc_city, i.i_category, COUNT(DISTINCT cc.cc_call_center_sk) AS total_call_centers, SUM(cc.cc_employees) AS total_employees, AVG(cc.cc_sq_ft) AS avg_square_footage, COUNT(DISTINCT i.i_item_sk) AS total_items, AVG(i.i_current_price) AS avg_item_price, MIN(ib.ib_lower_bound) AS min_income_band_lower_bound, MAX(ib.ib_upper_bound) AS max_income_band_upper_bound, AVG(cc.cc_tax_percentage) AS avg_tax_percentage FROM call_center cc JOIN item i ON cc.cc_division = i.i_manufact_id JOIN income_band ib ON ib.ib_income_band_sk = cc.cc_mkt_id WHERE cc.cc_street_type IN ('Boulevard', 'RD', 'Way') AND i.i_units IN ('Dram', 'Ounce', 'Gram') AND ib.ib_income_band_sk IN (3, 5, 7, 8) AND cc.cc_tax_percentage BETWEEN 0.01 AND 0.12 GROUP BY cc.cc_city, i.i_category ORDER BY total_call_centers DESC, avg_item_price ASC LIMIT 10;
SELECT cd.cd_education_status, d.d_year, SUM(ss_ext_sales_price) AS total_sales, AVG(ss_ext_sales_price) AS avg_sales_amount, COUNT(cr.cr_order_number) AS total_returns, AVG(cr.cr_return_amount) AS avg_return_amount FROM customer_demographics cd JOIN store_sales ss ON cd.cd_demo_sk = ss.ss_cdemo_sk JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk LEFT JOIN catalog_returns cr ON ss.ss_ticket_number = cr.cr_order_number WHERE d.d_year IN (1998, 1999, 2000) GROUP BY cd.cd_education_status, d.d_year ORDER BY cd.cd_education_status, d.d_year;
SELECT d_year, d_quarter_name, ca_state, SUM(ws_net_profit) AS total_net_profit, AVG(sr_return_amt_inc_tax) AS avg_return_amount_inc_tax, COUNT(DISTINCT ws_order_number) AS total_orders, COUNT(DISTINCT sr_ticket_number) AS total_returns FROM web_sales JOIN date_dim ON ws_sold_date_sk = d_date_sk JOIN customer_address ON ws_ship_addr_sk = ca_address_sk JOIN store_returns ON ws_order_number = sr_ticket_number AND ws_item_sk = sr_item_sk AND ws_bill_customer_sk = sr_customer_sk WHERE d_year = 2001 AND ca_state IN ('CA', 'NY', 'TX') AND ws_ship_mode_sk IN (15, 9, 19) AND ws_net_profit > 0 AND ws_ship_customer_sk IN (91411, 13153, 53110, 78552, 62671) AND sr_return_amt_inc_tax IN (211.69, 1118.88) AND sr_customer_sk IN (30509, 42705, 90022, 87597) GROUP BY d_year, d_quarter_name, ca_state ORDER BY total_net_profit DESC, avg_return_amount_inc_tax DESC;
SELECT wsit.web_site_id, wsit.web_name, cp.cp_department, AVG(ws.ws_sales_price) AS avg_sales_price, SUM(ws.ws_quantity) AS total_quantity_sold, COUNT(DISTINCT ws.ws_bill_customer_sk) AS unique_customers, AVG(cd.cd_purchase_estimate) AS avg_customer_purchase_estimate, SUM(CASE WHEN cd.cd_gender = 'M' THEN 1 ELSE 0 END) AS male_customers, SUM(CASE WHEN cd.cd_gender = 'F' THEN 1 ELSE 0 END) AS female_customers, AVG(cd.cd_dep_college_count) AS avg_college_dependents FROM web_sales ws JOIN web_site wsit ON ws.ws_web_site_sk = wsit.web_site_sk JOIN catalog_page cp ON ws.ws_web_page_sk = cp.cp_catalog_page_sk JOIN customer_demographics cd ON ws.ws_bill_cdemo_sk = cd.cd_demo_sk WHERE cp.cp_catalog_number IN (22, 31, 24, 15, 3) AND wsit.web_county = 'Williamson County' AND wsit.web_street_type IN ('Ct.', 'Avenue', 'Parkway', 'Pkwy', 'Dr.', 'Cir.') AND cd.cd_purchase_estimate IN (8000, 5000, 1000, 9500, 2000) AND cd.cd_dep_college_count = 0 GROUP BY wsit.web_site_id, wsit.web_name, cp.cp_department ORDER BY avg_sales_price DESC, total_quantity_sold DESC;
SELECT cd.cd_education_status, cd.cd_gender, cd.cd_marital_status, COUNT(DISTINCT c.c_customer_sk) AS total_customers, AVG(cd.cd_purchase_estimate) AS avg_purchase_estimate, AVG(wp.wp_char_count) AS avg_webpage_char_count, COUNT(DISTINCT wp.wp_web_page_sk) AS total_web_pages_accessed, SUM(CASE WHEN cd.cd_credit_rating = 'High' THEN 1 ELSE 0 END) AS high_credit_rating_count, SUM(CASE WHEN cd.cd_credit_rating = 'Medium' THEN 1 ELSE 0 END) AS medium_credit_rating_count, SUM(CASE WHEN cd.cd_credit_rating = 'Low' THEN 1 ELSE 0 END) AS low_credit_rating_count FROM customer_demographics cd JOIN customer c ON cd.cd_demo_sk = c.c_current_cdemo_sk LEFT JOIN web_page wp ON c.c_customer_sk = wp.wp_customer_sk WHERE c.c_birth_country = 'BOTSWANA' AND c.c_email_address LIKE '%@Bk.com' GROUP BY cd.cd_education_status, cd.cd_gender, cd.cd_marital_status ORDER BY cd.cd_education_status, cd.cd_gender, cd.cd_marital_status;
SELECT ca.ca_state AS state, dd.d_year AS year, COUNT(sr.sr_ticket_number) AS total_returns, AVG(sr.sr_return_amt) AS avg_return_amount, SUM(sr.sr_return_quantity) AS total_returned_quantity, SUM(sr.sr_net_loss) AS total_net_loss FROM store_returns sr JOIN customer_address ca ON sr.sr_addr_sk = ca.ca_address_sk JOIN date_dim dd ON sr.sr_returned_date_sk = dd.d_date_sk WHERE ca.ca_zip IN ('60534', '57995', '13951') GROUP BY ca.ca_state, dd.d_year ORDER BY state, year;
SELECT cp.cp_department, sm.sm_type AS shipping_mode, COUNT(DISTINCT cs.cs_order_number) AS total_orders, SUM(cs.cs_quantity) AS total_items_sold, AVG(cs.cs_sales_price) AS average_sales_price, SUM(cs.cs_net_paid) AS total_net_paid, SUM(sr.sr_return_quantity) AS total_items_returned, AVG(sr.sr_return_amt) AS average_return_amount, SUM(sr.sr_net_loss) AS total_net_loss, COUNT(DISTINCT wp.wp_web_page_sk) AS total_web_pages, AVG(wp.wp_link_count) AS average_link_count FROM catalog_sales cs LEFT JOIN store_returns sr ON cs.cs_item_sk = sr.sr_item_sk AND cs.cs_order_number = sr.sr_ticket_number LEFT JOIN catalog_page cp ON cs.cs_catalog_page_sk = cp.cp_catalog_page_sk LEFT JOIN ship_mode sm ON cs.cs_ship_mode_sk = sm.sm_ship_mode_sk LEFT JOIN web_returns wr ON cs.cs_item_sk = wr.wr_item_sk AND cs.cs_order_number = wr.wr_order_number LEFT JOIN web_page wp ON wr.wr_web_page_sk = wp.wp_web_page_sk WHERE (wp.wp_access_date_sk = '2452566' OR wp.wp_access_date_sk = '2452583') AND (wp.wp_link_count = 15 OR wp.wp_link_count = 7 OR wp.wp_link_count = 19 OR wp.wp_link_count = 3) GROUP BY cp.cp_department, sm.sm_type ORDER BY total_net_paid DESC, total_net_loss;
SELECT s.s_store_id, s.s_store_name, AVG(sr.sr_refunded_cash) AS avg_refunded_cash, SUM(sr.sr_refunded_cash) AS total_refunded_cash, COUNT(sr.sr_ticket_number) AS total_returns, AVG(sr.sr_net_loss) AS avg_net_loss, cd.cd_education_status, cd.cd_marital_status, COUNT(cd.cd_demo_sk) AS demographic_count FROM store_returns sr JOIN store s ON sr.sr_store_sk = s.s_store_sk JOIN customer_demographics cd ON sr.sr_cdemo_sk = cd.cd_demo_sk WHERE s.s_store_sk = 2 AND sr.sr_refunded_cash = 63.85 GROUP BY s.s_store_id, s.s_store_name, cd.cd_education_status, cd.cd_marital_status ORDER BY total_refunded_cash DESC, avg_net_loss DESC;
