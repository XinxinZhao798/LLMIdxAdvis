SELECT i.i_category AS item_category, i.i_brand AS item_brand, COUNT(DISTINCT ws.ws_order_number) AS total_orders, SUM(ws.ws_quantity) AS total_quantity_sold, SUM(ws.ws_net_paid_inc_ship_tax) AS total_sales, AVG(ws.ws_sales_price) AS average_sales_price, COUNT(DISTINCT i.i_item_sk) AS item_count FROM web_sales ws JOIN item i ON ws.ws_item_sk = i.i_item_sk JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk WHERE w.web_mkt_class = 'Right efforts must no' AND sm.sm_code = 'SEA' AND w.web_company_id = 1 GROUP BY i.i_category, i.i_brand ORDER BY total_sales DESC, item_category, item_brand;
SELECT w.w_warehouse_name, w.w_warehouse_sq_ft, w.w_city, w.w_state, ib.ib_lower_bound, ib.ib_upper_bound, AVG(cs.cs_sales_price) AS avg_sales_price, AVG(cs.cs_ext_discount_amt) AS avg_discount_amount, SUM(cs.cs_quantity) AS total_quantity_sold, COUNT(DISTINCT cs.cs_order_number) AS total_orders, COUNT(DISTINCT p.p_promo_sk) AS total_promotions_applied FROM catalog_sales cs JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk JOIN warehouse w ON cs.cs_warehouse_sk = w.w_warehouse_sk JOIN promotion p ON cs.cs_promo_sk = p.p_promo_sk JOIN income_band ib ON cs.cs_bill_customer_sk = ib.ib_income_band_sk WHERE d.d_year = 2021 AND w.w_county = 'Williamson County' AND p.p_discount_active = 'Y' AND p.p_response_target > 50 AND cs.cs_sales_price IS NOT NULL AND cs.cs_ext_discount_amt IS NOT NULL GROUP BY w.w_warehouse_name, w.w_warehouse_sq_ft, w.w_city, w.w_state, ib.ib_lower_bound, ib.ib_upper_bound ORDER BY avg_sales_price DESC, avg_discount_amount DESC;
SELECT ib.ib_income_band_sk, COUNT(DISTINCT wp.wp_web_page_sk) AS total_web_pages, AVG(wp.wp_char_count) AS avg_char_count, SUM(wp.wp_link_count) AS total_link_count, AVG(wp.wp_image_count) AS avg_image_count, SUM(wr.wr_return_quantity) AS total_return_quantity, SUM(wr.wr_return_amt) AS total_return_amount, AVG(wr.wr_fee) AS avg_return_fee, SUM(wr.wr_net_loss) AS total_net_loss FROM income_band ib LEFT JOIN web_page wp ON wp.wp_customer_sk = ib.ib_income_band_sk LEFT JOIN web_returns wr ON wr.wr_web_page_sk = wp.wp_web_page_sk WHERE wp.wp_rec_start_date BETWEEN '1997-09-03' AND '2001-09-03' AND wp.wp_char_count > 4000 AND wr.wr_return_ship_cost BETWEEN 45.88 AND 361.10 GROUP BY ib.ib_income_band_sk ORDER BY ib.ib_income_band_sk;
SELECT p.p_promo_name, COUNT(DISTINCT cs_order_number) AS total_orders, SUM(cs_quantity) AS total_quantity_sold, SUM(cs_net_paid) AS total_net_paid, AVG(cs_net_profit) AS average_net_profit, COUNT(DISTINCT cr_order_number) AS total_returns, SUM(cr_return_quantity) AS total_quantity_returned, SUM(cr_net_loss) AS total_net_loss, AVG(hd.hd_vehicle_count) AS average_vehicle_count FROM catalog_sales cs JOIN promotion p ON cs.cs_promo_sk = p.p_promo_sk LEFT JOIN catalog_returns cr ON cs.cs_item_sk = cr.cr_item_sk AND cs.cs_order_number = cr.cr_order_number JOIN household_demographics hd ON cs.cs_bill_hdemo_sk = hd.hd_demo_sk WHERE cs.cs_ext_wholesale_cost > 100 AND hd.hd_vehicle_count IN (0, 2, 3, 4) AND (cr.cr_returned_time_sk IS NULL OR cr.cr_returned_time_sk IN (80039, 82096, 81103)) GROUP BY p.p_promo_name ORDER BY total_net_paid DESC, total_net_loss ASC LIMIT 100;
SELECT dd.d_quarter_name, cd.cd_education_status, cd.cd_purchase_estimate, AVG(ss.ss_sales_price) AS avg_sales_price, AVG(sr.sr_return_amt) AS avg_return_amount, COUNT(DISTINCT ss.ss_ticket_number) AS total_sales_transactions, COUNT(DISTINCT sr.sr_ticket_number) AS total_return_transactions FROM store_sales ss JOIN date_dim dd ON ss.ss_sold_date_sk = dd.d_date_sk JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk LEFT JOIN store_returns sr ON ss.ss_ticket_number = sr.sr_ticket_number WHERE dd.d_qoy IN ('1', '2', '3', '4') AND cd.cd_purchase_estimate IN ('1500', '500', '4000') GROUP BY dd.d_quarter_name, cd.cd_education_status, cd.cd_purchase_estimate ORDER BY dd.d_quarter_name, cd.cd_education_status, cd.cd_purchase_estimate;
SELECT r.r_reason_desc, COUNT(*) AS total_returns, SUM(sr_return_amt) AS total_return_amount, AVG(sr_return_amt) AS average_return_amount, SUM(sr_return_quantity) AS total_returned_quantity, SUM(sr_fee) AS total_return_fees, SUM(sr_net_loss) AS total_net_loss FROM store_returns sr JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk WHERE sr.sr_return_amt > 0 AND r.r_reason_desc IN ('reason 26', 'reason 34', 'Did not fit', 'Not the product that was ordred') GROUP BY r.r_reason_desc ORDER BY total_return_amount DESC;
SELECT i.i_category AS category, ca.ca_state AS customer_state, EXTRACT(MONTH FROM (DATE '1970-01-01' + c.c_first_sales_date_sk * INTERVAL '1 day')) AS sale_month, COUNT(DISTINCT s.s_store_sk) AS num_stores, SUM(i.i_current_price) AS total_sales_amount, AVG(i.i_wholesale_cost) AS avg_wholesale_cost, COUNT(i.i_item_sk) AS items_sold, SUM(sr.sr_return_amt) AS total_return_amount, AVG(sr.sr_return_amt) AS avg_return_amount, COUNT(sr.sr_item_sk) AS items_returned FROM store s JOIN customer c ON s.s_store_sk = c.c_current_addr_sk JOIN item i ON s.s_store_sk = i.i_manufact_id JOIN store_returns sr ON i.i_item_sk = sr.sr_item_sk JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk WHERE ca.ca_state IN ('TN', 'DE', 'VA', 'CO') AND i.i_category_id IS NOT NULL AND c.c_first_sales_date_sk IS NOT NULL AND (c.c_birth_month = 1 OR c.c_birth_month IS NULL) AND sr.sr_returned_date_sk IS NOT NULL GROUP BY category, customer_state, sale_month ORDER BY total_sales_amount DESC, avg_wholesale_cost DESC, total_return_amount DESC LIMIT 100;
SELECT dd.d_dow AS day_of_week, cd.cd_gender AS gender, cd.cd_marital_status AS marital_status, AVG(cd.cd_purchase_estimate) AS avg_purchase_estimate, AVG(CASE WHEN cd.cd_credit_rating = 'Good' THEN 1 WHEN cd.cd_credit_rating = 'Bad' THEN 0 ELSE NULL END) AS avg_credit_good, COUNT(*) AS customer_count FROM customer c JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk JOIN date_dim dd ON c.c_first_sales_date_sk = dd.d_date_sk WHERE dd.d_dow = '6' AND cd.cd_dep_count = '2' AND cd.cd_marital_status IN ('M', 'U') AND c.c_first_shipto_date_sk = 2451880 GROUP BY dd.d_dow, cd.cd_gender, cd.cd_marital_status ORDER BY cd.cd_gender, cd.cd_marital_status, avg_purchase_estimate DESC;
SELECT c.c_first_name, c.c_last_name, ca.ca_state, w.w_warehouse_name, SUM(i.inv_quantity_on_hand) AS total_inventory, AVG(cc.cc_tax_percentage) AS average_tax_percentage, COUNT(DISTINCT cc.cc_call_center_sk) AS number_of_call_centers FROM customer c JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk JOIN inventory i ON ca.ca_address_sk = i.inv_warehouse_sk JOIN warehouse w ON i.inv_warehouse_sk = w.w_warehouse_sk JOIN call_center cc ON w.w_state = cc.cc_state WHERE ca.ca_state IN ('MA', 'FL') AND w.w_warehouse_id IN ('AAAAAAAADAAAAAAA', 'AAAAAAAAFAAAAAAA', 'AAAAAAAABAAAAAAA') AND cc.cc_tax_percentage IN (0.01, 0.05, 0.11, 0.12) GROUP BY c.c_first_name, c.c_last_name, ca.ca_state, w.w_warehouse_name ORDER BY total_inventory DESC, average_tax_percentage, number_of_call_centers DESC;
SELECT w_state, p_purpose, COUNT(DISTINCT wp_web_page_sk) AS total_web_pages, SUM(wp_image_count) AS total_images, AVG(wp_char_count) AS avg_char_count, SUM(CASE WHEN wp_web_page_id IN ('AAAAAAAAOAAAAAAA', 'AAAAAAAAJBAAAAAA', 'AAAAAAAAEBAAAAAA', 'AAAAAAAALCAAAAAA', 'AAAAAAAACAAAAAAA', 'AAAAAAAAGBAAAAAA') THEN 1 ELSE 0 END) AS targeted_web_pages_count, SUM(CASE WHEN t_shift = 'third' THEN 1 ELSE 0 END) AS third_shift_count, AVG(w_warehouse_sq_ft) AS avg_warehouse_size FROM warehouse JOIN promotion ON w_warehouse_sk = p_item_sk JOIN web_page ON wp_customer_sk = w_warehouse_sk JOIN time_dim ON t_time_sk = wp_creation_date_sk WHERE w_state = 'TN' AND (wp_image_count = 4 OR wp_image_count = 1) AND w_warehouse_sk = 2 GROUP BY w_state, p_purpose ORDER BY total_web_pages DESC;
SELECT cc_state, r_reason_desc, SUM(inv_quantity_on_hand) AS total_inventory, AVG(c_birth_year) AS average_customer_birth_year, COUNT(DISTINCT c_customer_sk) AS unique_customers, COUNT(DISTINCT web_site_sk) AS web_sites_operating FROM inventory JOIN reason ON (r_reason_sk = inv_quantity_on_hand) JOIN call_center ON (cc_division = inv_warehouse_sk) JOIN customer ON (c_current_addr_sk = cc_open_date_sk) JOIN web_site ON (web_state = cc_state) WHERE inv_date_sk = 2450815 AND c_customer_id IN ('AAAAAAAACHMAAAAA', 'AAAAAAAANPEAAAAA') AND (cc_rec_end_date IS NULL OR cc_rec_end_date > CURRENT_DATE) AND (web_rec_end_date IS NULL OR web_rec_end_date > CURRENT_DATE) GROUP BY cc_state, r_reason_desc ORDER BY total_inventory DESC, average_customer_birth_year;
SELECT ws.web_site_id, ws.web_class, ws.web_name, COUNT(DISTINCT wr.wr_order_number) AS total_returns, SUM(wr.wr_return_quantity) AS total_returned_quantity, AVG(wr.wr_return_amt_inc_tax) AS avg_return_amount_inc_tax, SUM(wr.wr_refunded_cash) AS total_refunded_cash, SUM(sr.sr_return_quantity) AS store_total_returned_quantity, AVG(sr.sr_return_amt_inc_tax) AS store_avg_return_amount_inc_tax, SUM(sr.sr_refunded_cash) AS store_total_refunded_cash FROM web_site ws JOIN web_page wp ON ws.web_site_sk = wp.wp_web_page_sk JOIN web_returns wr ON wp.wp_web_page_sk = wr.wr_web_page_sk LEFT JOIN store_returns sr ON wr.wr_item_sk = sr.sr_item_sk AND wr.wr_refunded_customer_sk = sr.sr_customer_sk WHERE ws.web_class = 'Unknown' AND ws.web_rec_end_date IN ('2001-08-15', '2000-08-15', '1999-08-16') AND wp.wp_rec_start_date IN ('2000-09-03', '2001-09-03', '1997-09-03') AND wp.wp_link_count IN (7, 11, 19) AND wr.wr_return_amt_inc_tax IN (43.31, 378.40, 532.83) AND wr.wr_refunded_cash IN (2425.04, 1694.98, 8.69) AND sr.sr_customer_sk IN (38344, 71012, 20816) AND sr.sr_cdemo_sk IN (1443482, 746161, 1430182) GROUP BY ws.web_site_id, ws.web_class, ws.web_name ORDER BY total_returns DESC, total_refunded_cash DESC;
SELECT ws2.web_name AS website, ws2.web_market_manager AS market_manager, cd.cd_gender AS customer_gender, SUM(ws.ws_sales_price) AS total_sales, AVG(ws.ws_sales_price) AS average_sales, COUNT(DISTINCT ws.ws_order_number) AS number_of_orders, SUM(ws.ws_quantity) AS total_quantity_sold, COUNT(DISTINCT c.c_customer_sk) AS number_of_customers, ca.ca_state AS customer_state, ca.ca_city AS customer_city FROM web_sales ws JOIN web_site ws2 ON ws.ws_web_site_sk = ws2.web_site_sk JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk WHERE ws.ws_sold_date_sk BETWEEN 2450815 AND 2450815 + 30 AND ws.ws_promo_sk = 212 AND ws2.web_market_manager IN ('Jeffrey Martin', 'William Reyes', 'Kelvin Lynch', 'Frank Cooper', 'Keith Williams', 'John Isaacs') AND ca.ca_gmt_offset BETWEEN -5 AND -3 GROUP BY ws2.web_name, ws2.web_market_manager, cd.cd_gender, ca.ca_state, ca.ca_city ORDER BY total_sales DESC, number_of_orders DESC;
SELECT i.i_category, s.s_state, s.s_market_id, COUNT(DISTINCT i.i_item_sk) AS total_items, AVG(i.i_current_price) AS avg_price, SUM(i.i_wholesale_cost) AS total_wholesale_cost, COUNT(DISTINCT wp.wp_web_page_sk) AS total_web_pages, wp.wp_type, COUNT(DISTINCT wp.wp_customer_sk) AS total_customers_accessed FROM item i JOIN store s ON i.i_manufact_id = s.s_company_id JOIN web_page wp ON wp.wp_type = 'order' WHERE i.i_category IN ('Books', 'Sports', 'Women', 'Men') AND s.s_state = 'TN' AND s.s_market_id = '7' AND i.i_current_price BETWEEN 2.21 AND 81.80 AND (wp.wp_creation_date_sk BETWEEN '2450811' AND '2450813' OR wp.wp_creation_date_sk = '2450808') GROUP BY i.i_category, s.s_state, s.s_market_id, wp.wp_type ORDER BY total_items DESC, avg_price DESC, total_wholesale_cost DESC;
SELECT d_year, SUM(cs_net_paid) AS total_sales, AVG(cs_net_profit) AS average_profit, COUNT(DISTINCT cs_bill_customer_sk) AS unique_customers, SUM(cr_return_amount) AS total_returns, AVG(cr_return_quantity) AS average_return_quantity, COUNT(DISTINCT cr_returning_customer_sk) AS unique_returning_customers FROM date_dim JOIN catalog_sales ON cs_sold_date_sk = d_date_sk JOIN catalog_returns ON cr_returned_date_sk = d_date_sk AND cs_order_number = cr_order_number WHERE d_year IN (2000, 2001, 2002) AND cs_ship_date_sk IS NOT NULL AND cr_returned_date_sk IS NOT NULL AND (cr_refunded_cdemo_sk IN ('719026', '1111847', '660009', '451051') OR cs_bill_cdemo_sk IN ('719026', '1111847', '660009', '451051')) AND cs_item_sk IN (SELECT inv_item_sk FROM inventory WHERE inv_quantity_on_hand > 100) GROUP BY d_year ORDER BY d_year;
SELECT c.c_customer_id, i.i_product_name, i.i_category, COUNT(cs.cs_order_number) AS total_orders, SUM(cs.cs_quantity) AS total_quantity, AVG(cs.cs_sales_price) AS avg_sales_price, SUM(cs.cs_net_paid) AS total_net_paid, SUM(cs.cs_net_paid_inc_tax) AS total_net_paid_inc_tax, SUM(cs.cs_net_paid_inc_ship) AS total_net_paid_inc_ship, SUM(cs.cs_net_paid_inc_ship_tax) AS total_net_paid_inc_ship_tax, SUM(sr.sr_return_amt) AS total_return_amount, SUM(sr.sr_fee) AS total_return_fee, SUM(sr.sr_net_loss) AS total_net_loss, SUM(wr.wr_return_amt) AS total_web_return_amount, SUM(wr.wr_fee) AS total_web_return_fee, SUM(wr.wr_net_loss) AS total_web_net_loss FROM customer c JOIN catalog_sales cs ON c.c_customer_sk = cs.cs_bill_customer_sk JOIN item i ON cs.cs_item_sk = i.i_item_sk LEFT JOIN store_returns sr ON cs.cs_item_sk = sr.sr_item_sk AND cs.cs_order_number = sr.sr_ticket_number LEFT JOIN web_returns wr ON cs.cs_item_sk = wr.wr_item_sk AND cs.cs_order_number = wr.wr_order_number JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk WHERE c.c_preferred_cust_flag = 'Y' AND d.d_year = 2023 GROUP BY c.c_customer_id, i.i_product_name, i.i_category ORDER BY total_net_paid DESC LIMIT 100;
SELECT hd.hd_income_band_sk, count(distinct c.c_customer_sk) AS num_customers, sum(cs.cs_quantity) AS total_sales_quantity, sum(cs.cs_net_paid) AS total_sales_amount, sum(sr.sr_return_quantity) AS total_returned_quantity, sum(sr.sr_return_amt) AS total_returned_amount, sum(cs.cs_net_profit) - sum(coalesce(sr.sr_net_loss, 0)) AS net_profit FROM customer c JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk JOIN income_band ib ON hd.hd_income_band_sk = ib.ib_income_band_sk LEFT JOIN catalog_sales cs ON c.c_customer_sk = cs.cs_bill_customer_sk LEFT JOIN store_returns sr ON c.c_customer_sk = sr.sr_customer_sk WHERE hd.hd_income_band_sk IN ('17', '12', '15', '6', '4', '19') AND (cs.cs_sold_date_sk IS NOT NULL OR sr.sr_returned_date_sk IS NOT NULL) GROUP BY hd.hd_income_band_sk ORDER BY net_profit DESC;
SELECT cd.cd_gender, cd.cd_marital_status, td.t_shift, COUNT(DISTINCT ss.ss_ticket_number) AS total_sales_transactions, SUM(ss.ss_quantity) AS total_units_sold, SUM(ss.ss_net_paid) AS total_revenue, AVG(ss.ss_net_paid) AS average_revenue_per_transaction, SUM(CASE WHEN p.p_channel_dmail = 'Y' THEN 1 ELSE 0 END) AS total_dmail_promotions, SUM(CASE WHEN p.p_channel_email = 'Y' THEN 1 ELSE 0 END) AS total_email_promotions, SUM(CASE WHEN p.p_channel_tv = 'Y' THEN 1 ELSE 0 END) AS total_tv_promotions FROM store_sales ss JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk JOIN time_dim td ON ss.ss_sold_time_sk = td.t_time_sk LEFT JOIN promotion p ON ss.ss_promo_sk = p.p_promo_sk WHERE ss.ss_hdemo_sk IN ('4855', '5486') GROUP BY cd.cd_gender, cd.cd_marital_status, td.t_shift ORDER BY total_revenue DESC, total_units_sold DESC;
SELECT cp.cp_department, t.t_shift, SUM(ss.ss_quantity) AS total_quantity_sold, AVG(ss.ss_sales_price) AS avg_sales_price, COUNT(DISTINCT ws.ws_order_number) AS total_web_orders, SUM(ws.ws_net_paid_inc_tax) AS total_web_sales_inc_tax FROM catalog_page cp JOIN store_sales ss ON cp.cp_catalog_page_sk = ss.ss_sold_date_sk JOIN web_sales ws ON cp.cp_catalog_page_sk = ws.ws_sold_date_sk JOIN time_dim t ON ss.ss_sold_time_sk = t.t_time_sk WHERE cp.cp_end_date_sk IN (2451270, 2451144, 2451361, 2450905, 2450996, 2450994) AND ws.ws_ship_addr_sk IN ('41135', '47817', '1020', '16481') AND ws.ws_net_paid_inc_tax IN (121.18, 8694.75, 8.96, 5623.02, 5896.24) AND ss.ss_quantity IN (3, 63, 59, 95, 61) AND cp.cp_catalog_page_number IN (82, 73) AND t.t_minute IN (29, 57, 42, 24) GROUP BY cp.cp_department, t.t_shift ORDER BY total_quantity_sold DESC, avg_sales_price DESC, total_web_orders DESC, total_web_sales_inc_tax DESC;
SELECT p.p_channel_dmail AS promo_channel_direct_mail, p.p_channel_email AS promo_channel_email, p.p_channel_catalog AS promo_channel_catalog, p.p_channel_tv AS promo_channel_tv, p.p_channel_radio AS promo_channel_radio, p.p_channel_press AS promo_channel_press, p.p_channel_event AS promo_channel_event, p.p_channel_demo AS promo_channel_demo, COUNT(p.p_promo_sk) AS num_promotions, SUM(p.p_cost) AS total_promo_cost, AVG(p.p_cost) AS avg_promo_cost, SUM(i.inv_quantity_on_hand) AS total_inventory_qty FROM promotion p LEFT JOIN inventory i ON p.p_item_sk = i.inv_item_sk WHERE p.p_discount_active = '1' GROUP BY promo_channel_direct_mail, promo_channel_email, promo_channel_catalog, promo_channel_tv, promo_channel_radio, promo_channel_press, promo_channel_event, promo_channel_demo ORDER BY num_promotions DESC, total_promo_cost DESC;
SELECT c.c_first_name, c.c_last_name, cd.cd_gender, cd.cd_education_status, hd.hd_buy_potential, hd.hd_vehicle_count, COUNT(sr.sr_item_sk) AS total_returns, SUM(sr.sr_return_amt_inc_tax) AS total_return_value, AVG(sr.sr_return_amt_inc_tax) AS avg_return_value, ib.ib_lower_bound, ib.ib_upper_bound, w.w_warehouse_name, w.w_city, w.w_state, ws.web_name, ws.web_manager, COUNT(wr.wr_item_sk) AS total_web_returns, SUM(wr.wr_return_amt_inc_tax) AS total_web_return_value, AVG(wr.wr_return_amt_inc_tax) AS avg_web_return_value FROM customer c JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk JOIN income_band ib ON hd.hd_income_band_sk = ib.ib_income_band_sk JOIN store_returns sr ON c.c_customer_sk = sr.sr_customer_sk JOIN warehouse w ON sr.sr_store_sk = w.w_warehouse_sk JOIN web_returns wr ON c.c_customer_sk = wr.wr_returning_customer_sk JOIN web_site ws ON wr.wr_web_page_sk = ws.web_site_sk WHERE cd.cd_credit_rating = 'Good' AND hd.hd_dep_count BETWEEN 1 AND 3 AND ib.ib_lower_bound >= 50000 AND sr.sr_return_amt > 0 AND wr.wr_return_amt > 0 AND ws.web_county = 'Williamson County' GROUP BY c.c_first_name, c.c_last_name, cd.cd_gender, cd.cd_education_status, hd.hd_buy_potential, hd.hd_vehicle_count, ib.ib_lower_bound, ib.ib_upper_bound, w.w_warehouse_name, w.w_city, w.w_state, ws.web_name, ws.web_manager ORDER BY total_return_value DESC, total_web_return_value DESC LIMIT 100;
SELECT i.i_category, SUM(ss.ss_quantity) AS total_quantity_sold, AVG(ss.ss_sales_price) AS average_sales_price, COUNT(DISTINCT ss.ss_ticket_number) AS number_of_sales_transactions, SUM(inv.inv_quantity_on_hand) AS total_inventory_on_hand, SUM(ss.ss_net_profit) AS total_net_profit FROM item i JOIN store_sales ss ON i.i_item_sk = ss.ss_item_sk JOIN inventory inv ON i.i_item_sk = inv.inv_item_sk JOIN time_dim t ON ss.ss_sold_time_sk = t.t_time_sk WHERE i.i_wholesale_cost BETWEEN 4 AND 7 AND inv.inv_date_sk = '2450815' AND ss.ss_ext_sales_price < 5000 AND t.t_hour BETWEEN 0 AND 1 GROUP BY i.i_category ORDER BY total_net_profit DESC;
SELECT cp.cp_department, i.i_category, SUM(wr.wr_return_quantity) AS total_returned_quantity, AVG(wr.wr_return_amt) AS avg_return_amount, COUNT(DISTINCT wr.wr_order_number) AS count_distinct_orders, AVG(w.w_warehouse_sq_ft) AS avg_warehouse_sq_ft, SUM(wr.wr_fee) AS total_fees, AVG(i.i_wholesale_cost) AS avg_wholesale_cost, SUM(wr.wr_net_loss) AS total_net_loss FROM web_returns wr JOIN item i ON wr.wr_item_sk = i.i_item_sk JOIN catalog_page cp ON wr.wr_web_page_sk = cp.cp_catalog_page_sk JOIN warehouse w ON i.i_manufact_id = w.w_warehouse_sk WHERE wr.wr_returned_date_sk IS NOT NULL AND cp.cp_description = 'Effects change easy, real types; young, corporate' AND wr.wr_refunded_addr_sk IN ('47678', '14023', '11197', '22228', '47074') GROUP BY cp.cp_department, i.i_category ORDER BY total_returned_quantity DESC, avg_return_amount DESC;
SELECT ca.ca_state AS customer_state, cp.cp_department AS department, AVG(cr.cr_return_amount) AS avg_return_amount, COUNT(cr.cr_item_sk) AS total_return_count, SUM(cr.cr_net_loss) AS total_net_loss, SUM(p.p_cost) AS total_promotion_cost FROM catalog_returns cr JOIN customer_address ca ON cr.cr_returning_addr_sk = ca.ca_address_sk JOIN catalog_page cp ON cr.cr_catalog_page_sk = cp.cp_catalog_page_sk JOIN promotion p ON cp.cp_catalog_page_sk = p.p_item_sk WHERE cp.cp_department IN ('Electronics', 'Home & Garden', 'Books') AND p.p_cost > 1000 AND cp.cp_end_date_sk IN (2450934, 2451664) AND ca.ca_state = 'CA' AND ca.ca_gmt_offset = -8.00 GROUP BY customer_state, department ORDER BY total_net_loss DESC, total_return_count DESC;
SELECT s.s_store_name, s.s_city, s.s_state, i.i_category, i.i_brand, SUM(inv.inv_quantity_on_hand) AS total_inventory, AVG(i.i_current_price) AS average_price, COUNT(DISTINCT c.c_customer_sk) AS unique_customers, SUM(CASE WHEN c.c_preferred_cust_flag = 'Y' THEN 1 ELSE 0 END) AS preferred_customers_count FROM store s JOIN inventory inv ON s.s_store_sk = inv.inv_warehouse_sk JOIN item i ON inv.inv_item_sk = i.i_item_sk JOIN customer c ON s.s_store_sk = c.c_current_addr_sk WHERE s.s_state IN ('CA', 'TX', 'NY') AND c.c_last_review_date_sk BETWEEN 2452306 AND 2452404 AND i.i_rec_start_date <= CURRENT_DATE AND (i.i_rec_end_date IS NULL OR i.i_rec_end_date > CURRENT_DATE) GROUP BY s.s_store_name, s.s_city, s.s_state, i.i_category, i.i_brand ORDER BY total_inventory DESC, s.s_store_name, i.i_category, i.i_brand;
SELECT cc.cc_name AS CallCenter, SUM(cr.cr_return_amount) AS TotalReturnAmount, AVG(cr.cr_return_amount) AS AverageReturnAmount, COUNT(cr.cr_order_number) AS NumberOfReturns, r.r_reason_desc AS ReturnReason, ib.ib_lower_bound AS IncomeBandLowerBound, ib.ib_upper_bound AS IncomeBandUpperBound, COUNT(DISTINCT ws.ws_order_number) AS NumberOfWebSales, SUM(ws.ws_net_profit) AS TotalWebSalesProfit FROM catalog_returns cr INNER JOIN call_center cc ON cr.cr_call_center_sk = cc.cc_call_center_sk INNER JOIN reason r ON cr.cr_reason_sk = r.r_reason_sk INNER JOIN income_band ib ON cr.cr_refunded_cdemo_sk = ib.ib_income_band_sk LEFT JOIN web_sales ws ON cr.cr_order_number = ws.ws_order_number WHERE cc.cc_market_manager IN ('Julius Durham', 'Matthew Clifton', 'Gary Colburn', 'Julius Tran') AND ib.ib_upper_bound IN (50000, 130000, 180000, 60000, 160000) AND ib.ib_lower_bound IN (0, 50001, 170001, 60001, 110001, 90001) AND ws.ws_warehouse_sk IN (3, 1, 2, 5) AND cc.cc_call_center_id IN ('AAAAAAAACAAAAAAA', 'AAAAAAAABAAAAAAA', 'AAAAAAAAEAAAAAAA') GROUP BY CallCenter, ReturnReason, IncomeBandLowerBound, IncomeBandUpperBound ORDER BY TotalReturnAmount DESC, NumberOfReturns DESC, TotalWebSalesProfit DESC;
SELECT cp_department, i_category, AVG(i_current_price) AS average_price, SUM(i_wholesale_cost) AS total_wholesale_cost, COUNT(DISTINCT i_item_sk) AS item_count, COUNT(DISTINCT cp_catalog_page_sk) AS page_count, AVG(ib_upper_bound - ib_lower_bound) AS average_income_band_range FROM catalog_page JOIN item ON cp_catalog_page_id = i_item_id JOIN income_band ON i_size::integer = ib_income_band_sk WHERE cp_start_date_sk IS NOT NULL AND cp_end_date_sk IS NOT NULL AND i_rec_start_date <= CURRENT_DATE AND (i_rec_end_date IS NULL OR i_rec_end_date >= CURRENT_DATE) AND ib_lower_bound >= 20000 AND cp_department IN ('Electronics', 'Clothing', 'Home Goods') GROUP BY cp_department, i_category ORDER BY average_price DESC, total_wholesale_cost DESC;
SELECT w_state, w.w_warehouse_name, AVG(ws.web_tax_percentage) AS average_tax_percentage, COUNT(DISTINCT r.r_reason_sk) AS total_reason_count, SUM(w.w_warehouse_sq_ft) AS total_warehouse_sq_ft FROM warehouse w JOIN web_site ws ON w.w_zip = ws.web_zip LEFT JOIN reason r ON r.r_reason_desc LIKE '%return%' WHERE w.w_gmt_offset = '-5.00' AND ws.web_rec_start_date <= CURRENT_DATE AND (ws.web_rec_end_date IS NULL OR ws.web_rec_end_date >= CURRENT_DATE) GROUP BY w_state, w.w_warehouse_name ORDER BY w_state, w.w_warehouse_name;
SELECT cc.cc_name, w.w_warehouse_name, cd.cd_education_status, SUM(cs.cs_net_profit) AS total_profit, AVG(cs.cs_sales_price) AS average_sale_price, COUNT(cr.cr_order_number) AS total_returns, SUM(cr.cr_return_amount) AS total_return_amount, AVG(cr.cr_fee) AS average_return_fee FROM call_center cc JOIN catalog_sales cs ON cc.cc_call_center_sk = cs.cs_call_center_sk JOIN catalog_returns cr ON cs.cs_order_number = cr.cr_order_number AND cs.cs_item_sk = cr.cr_item_sk JOIN customer_demographics cd ON cs.cs_bill_cdemo_sk = cd.cd_demo_sk JOIN warehouse w ON cs.cs_warehouse_sk = w.w_warehouse_sk WHERE cc.cc_hours = '8AM-8AM' AND w.w_gmt_offset = '-5.00' AND cc.cc_street_name IN ('Center Hill', 'Pine Ridge', 'Ash Hill') AND cr.cr_returning_addr_sk IN ('38685', '5389', '1090') GROUP BY cc.cc_name, w.w_warehouse_name, cd.cd_education_status ORDER BY total_profit DESC, total_returns DESC;
