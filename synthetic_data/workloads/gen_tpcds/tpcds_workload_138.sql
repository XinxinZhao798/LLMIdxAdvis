SELECT i.i_category, i.i_brand, COUNT(DISTINCT cr.cr_order_number) AS total_returns, SUM(cr.cr_return_quantity) AS total_returned_quantity, AVG(cr.cr_return_amount) AS avg_return_amount, SUM(cr.cr_return_amount) AS total_return_amount, SUM(cr.cr_return_amt_inc_tax) AS total_return_amount_inc_tax, SUM(cr.cr_fee) AS total_fees, SUM(cr.cr_net_loss) AS total_net_loss FROM catalog_returns cr JOIN item i ON cr.cr_item_sk = i.i_item_sk JOIN web_page wp ON cr.cr_catalog_page_sk = wp.wp_web_page_sk WHERE i.i_brand_id IN ('10003002', '8008007', '7015003', '9001006', '10011007', '10010015') AND wp.wp_url = 'http://www.foo.com' AND wp.wp_customer_sk IN ('98633', '80555') AND cr.cr_ship_mode_sk IN ('10', '18', '12', '2', '6', '8') GROUP BY i.i_category, i.i_brand ORDER BY total_returns DESC, total_returned_quantity DESC;
SELECT d_year, d_moy, sm_type, COUNT(DISTINCT cs_order_number) AS total_orders, SUM(cs_net_paid) AS total_revenue, SUM(cs_net_profit) AS total_profit, AVG(cs_quantity) AS average_quantity, AVG(cs_net_paid_inc_tax) AS average_revenue_inc_tax, SUM(cr_return_amount) AS total_return_amount, AVG(cr_return_quantity) AS average_return_quantity, COUNT(DISTINCT wp_web_page_sk) AS total_web_page_visits, COUNT(DISTINCT s_store_sk) AS total_stores, COUNT(DISTINCT cc_call_center_sk) AS total_call_centers FROM date_dim LEFT JOIN catalog_sales ON cs_sold_date_sk = d_date_sk LEFT JOIN ship_mode ON cs_ship_mode_sk = sm_ship_mode_sk LEFT JOIN catalog_returns ON cr_returned_date_sk = d_date_sk LEFT JOIN web_page ON wp_access_date_sk = d_date_sk LEFT JOIN store ON s_store_sk = cs_ship_customer_sk LEFT JOIN call_center ON cc_call_center_sk = cs_call_center_sk LEFT JOIN customer_demographics ON cs_ship_cdemo_sk = cd_demo_sk WHERE d_year = 2001 AND d_moy BETWEEN 1 AND 6 AND cs_net_paid IS NOT NULL AND sm_type IS NOT NULL AND (cc_sq_ft = '3514' OR cc_sq_ft = '4134' OR cc_sq_ft = '1138') AND (cc_rec_end_date = '2000-12-31' OR cc_rec_end_date = '2001-12-31' OR cc_rec_end_date = '2000-01-01') AND (cc_company = '6' OR cc_company = '3' OR cc_company = '1') AND (cr_return_ship_cost = '2.66' OR cr_return_ship_cost = '13.49' OR cr_return_ship_cost = '26.44') AND (cr_catalog_page_sk = '380' OR cr_catalog_page_sk = '219' OR cr_catalog_page_sk = '388') AND (cr_returned_time_sk = '45077' OR cr_returned_time_sk = '77627' OR cr_returned_time_sk = '32496') AND (sm_contract = '2mM8l' OR sm_contract = 'uukTktPYycct8' OR sm_contract = 'fop0bcSd91J26IVpR') AND (sm_ship_mode_sk = '10' OR sm_ship_mode_sk = '6' OR sm_ship_mode_sk = '4') AND (sm_code = 'SEA' OR sm_code = 'BIKE' OR sm_code = 'SURFACE') AND (sm_carrier = 'FEDEX' OR sm_carrier = 'ZHOU' OR sm_carrier = 'PRIVATECARRIER') AND (cs_ext_tax = '89.97' OR cs_ext_tax = '687.10' OR cs_ext_tax = '221.70') AND (cs_ship_hdemo_sk = '2057' OR cs_ship_hdemo_sk = '6324' OR cs_ship_hdemo_sk = '6945') AND (cs_net_paid_inc_ship_tax = '1307.73' OR cs_net_paid_inc_ship_tax = '1740.39' OR cs_net_paid_inc_ship_tax = '1487.69') AND (d_weekend = 'N' OR d_weekend = 'Y') AND (s_gmt_offset = '-5.00') AND (s_store_sk = '1' OR s_store_sk = '12' OR s_store_sk = '9') AND (s_store_name = 'anti' OR s_store_name = 'ese' OR s_store_name = 'eing') AND (wp_access_date_sk = '2452555' OR wp_access_date_sk = '2452645' OR wp_access_date_sk = '2452576') AND (wp_customer_sk = '20213' OR wp_customer_sk = '98376' OR wp_customer_sk = '60150') AND (wp_web_page_id = 'AAAAAAAAEDAAAAAA' OR wp_web_page_id = 'AAAAAAAAHDAAAAAA' OR wp_web_page_id = 'AAAAAAAAOAAAAAAA') AND (wp_web_page_sk = '3' OR wp_web_page_sk = '17' OR wp_web_page_sk = '36') AND (cd_demo_sk = '18975' OR cd_demo_sk = '21210' OR cd_demo_sk = '20876') AND (cd_dep_count = '2' OR cd_dep_count = '1') GROUP BY d_year, d_moy, sm_type ORDER BY d_year, d_moy, sm_type;
SELECT cs_state, SUM(cs_total_sales) AS total_sales, SUM(cr_total_returns) AS total_returns, (SUM(cs_net_profit) - SUM(cr_net_loss)) AS net_profit FROM (SELECT ca_state AS cs_state, SUM(ss_ext_sales_price) AS cs_total_sales, SUM(ss_net_profit) AS cs_net_profit FROM store_sales JOIN customer ON ss_customer_sk = c_customer_sk JOIN customer_address ON c_current_addr_sk = ca_address_sk GROUP BY ca_state) sales LEFT JOIN (SELECT ca_state AS cr_state, SUM(cr_return_amount) AS cr_total_returns, SUM(cr_net_loss) AS cr_net_loss FROM catalog_returns JOIN customer ON cr_returning_customer_sk = c_customer_sk JOIN customer_address ON c_current_addr_sk = ca_address_sk GROUP BY ca_state) returns ON sales.cs_state = returns.cr_state GROUP BY cs_state ORDER BY net_profit DESC;
SELECT hd.hd_income_band_sk, SUM(sr.sr_return_quantity) AS total_returned_quantity, AVG(sr.sr_return_amt) AS average_return_amount, COUNT(DISTINCT sr.sr_customer_sk) AS unique_customers_returned, SUM(CASE WHEN p.p_channel_email = 'Y' THEN sr.sr_return_quantity ELSE 0 END) AS email_promo_returned_quantity, SUM(sr.sr_net_loss) AS total_net_loss FROM store_returns sr JOIN household_demographics hd ON sr.sr_hdemo_sk = hd.hd_demo_sk JOIN promotion p ON sr.sr_item_sk = p.p_item_sk JOIN inventory i ON sr.sr_item_sk = i.inv_item_sk AND i.inv_warehouse_sk = 1 WHERE hd.hd_demo_sk IN (1588, 4700) AND sr.sr_refunded_cash IN (10.38, 1818.70) GROUP BY hd.hd_income_band_sk ORDER BY total_net_loss DESC;
SELECT p.p_promo_id, p.p_promo_name, SUM(ws.ws_net_profit) AS total_net_profit, AVG(ws.ws_sales_price) AS avg_sales_price, COUNT(DISTINCT ws.ws_item_sk) AS number_of_items_sold, SUM(cr.cr_return_amount) AS total_returns, COUNT(DISTINCT cr.cr_item_sk) AS number_of_items_returned FROM web_sales ws JOIN promotion p ON ws.ws_promo_sk = p.p_promo_sk JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk LEFT JOIN catalog_returns cr ON ws.ws_item_sk = cr.cr_item_sk AND ws.ws_order_number = cr.cr_order_number JOIN item i ON ws.ws_item_sk = i.i_item_sk WHERE i.i_class_id = 4 AND c.c_birth_country IN ('GABON', 'ALBANIA', 'RUSSIAN FEDERATION', 'CHINA', 'BELGIUM', 'PORTUGAL') GROUP BY p.p_promo_id, p.p_promo_name ORDER BY total_net_profit DESC;
SELECT d.d_year, d.d_quarter_name, cc.cc_city, cc.cc_state, SUM(wr.wr_return_quantity) AS total_returned_quantity, AVG(wr.wr_return_amt) AS avg_return_amount, COUNT(DISTINCT wr.wr_refunded_customer_sk) AS unique_customers, COUNT(DISTINCT wr.wr_order_number) AS total_orders_returned FROM web_returns wr JOIN date_dim d ON wr.wr_returned_date_sk = d.d_date_sk JOIN time_dim t ON wr.wr_returned_time_sk = t.t_time_sk JOIN call_center cc ON cc.cc_call_center_sk = wr.wr_returning_customer_sk WHERE d.d_year = 2023 AND t.t_sub_shift = 'night' AND cc.cc_city = 'Midway' AND wr.wr_returned_time_sk IN ('76162', '72121', '59518') GROUP BY d.d_year, d.d_quarter_name, cc.cc_city, cc.cc_state ORDER BY d.d_year, d.d_quarter_name, cc.cc_city, cc.cc_state;
SELECT w_state, COUNT(DISTINCT w_warehouse_sk) AS total_warehouses, SUM(w_warehouse_sq_ft) AS total_warehouse_sq_ft, AVG(w_warehouse_sq_ft) AS avg_warehouse_sq_ft, SUM(sr_return_amt) AS total_return_amt, AVG(sr_return_amt) AS avg_return_amt, COUNT(DISTINCT sr_ticket_number) AS total_return_transactions, SUM(wp_char_count) AS total_webpage_char_count, AVG(wp_link_count) AS avg_webpage_link_count, COUNT(DISTINCT web_site_sk) AS total_websites, SUM(web_tax_percentage) AS total_web_tax_percentage, AVG(web_tax_percentage) AS avg_web_tax_percentage FROM warehouse w LEFT JOIN store_returns sr ON w.w_warehouse_sk = sr.sr_store_sk LEFT JOIN web_page wp ON w.w_warehouse_sk = wp.wp_customer_sk LEFT JOIN web_site ws ON wp.wp_web_page_sk = ws.web_site_sk GROUP BY w_state ORDER BY total_return_amt DESC;
SELECT c.c_customer_id, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_sales, SUM(cr.cr_return_amount) AS total_returns, (SUM(cs.cs_net_paid) - SUM(cr.cr_return_amount)) AS net_profit, AVG(cs.cs_sales_price) AS average_sales_price, COUNT(DISTINCT cs.cs_order_number) AS number_of_orders, COUNT(DISTINCT cr.cr_order_number) AS number_of_returns FROM customer c LEFT JOIN catalog_sales cs ON c.c_customer_sk = cs.cs_bill_customer_sk LEFT JOIN catalog_returns cr ON cs.cs_order_number = cr.cr_order_number GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name HAVING COUNT(DISTINCT cs.cs_order_number) > 0 AND COUNT(DISTINCT cr.cr_order_number) > 0 ORDER BY net_profit DESC, total_sales DESC LIMIT 100;
SELECT ws.ws_web_site_sk, web.web_name, COUNT(ws.ws_order_number) AS total_orders, SUM(ws.ws_quantity) AS total_quantity_sold, AVG(ws.ws_sales_price) AS average_sales_price, SUM(ws.ws_net_profit) AS total_net_profit, SUM(cr.cr_net_loss) AS total_net_loss, (SUM(ws.ws_net_profit) - SUM(cr.cr_net_loss)) AS net_gain_loss, COUNT(DISTINCT ws.ws_bill_customer_sk) AS unique_customers, COUNT(DISTINCT cr.cr_returning_customer_sk) AS unique_returning_customers, COUNT(DISTINCT cr.cr_item_sk) AS unique_returned_items, SUM(cr.cr_return_quantity) AS total_returned_quantity, AVG(cr.cr_return_amount) AS average_return_amount FROM web_sales ws JOIN web_site web ON ws.ws_web_site_sk = web.web_site_sk LEFT JOIN catalog_returns cr ON ws.ws_order_number = cr.cr_order_number AND ws.ws_item_sk = cr.cr_item_sk WHERE web.web_county = 'Williamson County' AND (web.web_rec_end_date = '2000-08-15' OR web.web_rec_end_date = '1999-08-16') AND (ws.ws_ext_sales_price = 1271.34 OR ws.ws_ext_sales_price = 2832.48 OR ws.ws_ext_sales_price = 205.59 OR ws.ws_ext_sales_price = 4175.82 OR ws.ws_ext_sales_price = 885.30) GROUP BY ws.ws_web_site_sk, web.web_name ORDER BY net_gain_loss DESC;
SELECT dd.d_year, dd.d_quarter_name, SUM(inv.inv_quantity_on_hand) AS total_inventory, AVG(hd.hd_dep_count) AS avg_dependent_count, COUNT(DISTINCT s.s_store_sk) AS num_stores, AVG(s.s_number_employees) AS avg_store_employees, AVG(s.s_floor_space) AS avg_store_floor_space, SUM(CASE WHEN ca.ca_state = 'CA' THEN 1 ELSE 0 END) AS num_addresses_in_california FROM inventory inv JOIN date_dim dd ON inv.inv_date_sk = dd.d_date_sk JOIN store s ON inv.inv_warehouse_sk = s.s_store_sk JOIN customer_address ca ON s.s_zip = ca.ca_zip JOIN household_demographics hd ON s.s_market_id = hd.hd_income_band_sk WHERE dd.d_year IN (1905, 1913, 1900, 1906, 1910) AND dd.d_current_month = 'N' AND inv.inv_warehouse_sk IN (1, 2) AND hd.hd_income_band_sk IN (20, 11, 4, 17, 7) GROUP BY dd.d_year, dd.d_quarter_name ORDER BY dd.d_year, dd.d_quarter_name;
SELECT cs.cs_call_center_sk, cc.cc_name AS call_center_name, cp.cp_catalog_page_id, cp.cp_department, COUNT(cs.cs_order_number) AS total_orders, SUM(cs.cs_quantity) AS total_quantity_sold, AVG(cs.cs_sales_price) AS avg_sales_price, SUM(cs.cs_net_paid) AS total_revenue, SUM(cs.cs_net_profit) AS total_profit, AVG(cs.cs_net_profit) AS avg_profit_per_sale, cd.cd_marital_status, COUNT(DISTINCT cs.cs_bill_customer_sk) AS unique_customers, SUM(inv.inv_quantity_on_hand) AS total_inventory_on_hand FROM catalog_sales cs LEFT JOIN call_center cc ON cs.cs_call_center_sk = cc.cc_call_center_sk LEFT JOIN catalog_page cp ON cs.cs_catalog_page_sk = cp.cp_catalog_page_sk LEFT JOIN customer_demographics cd ON cs.cs_bill_cdemo_sk = cd.cd_demo_sk LEFT JOIN inventory inv ON cs.cs_item_sk = inv.inv_item_sk AND cs_sold_date_sk = inv.inv_date_sk WHERE cc.cc_country = 'United States' AND cs.cs_net_profit > 0 AND inv.inv_date_sk = 2450815 GROUP BY cs.cs_call_center_sk, call_center_name, cp.cp_catalog_page_id, cp.cp_department, cd.cd_marital_status ORDER BY total_revenue DESC, total_profit DESC LIMIT 100;
SELECT cd.cd_education_status, cd.cd_gender, cd.cd_marital_status, AVG(cd.cd_purchase_estimate) AS avg_purchase_estimate, SUM(sr.sr_return_amt_inc_tax) AS total_returns_inc_tax, COUNT(DISTINCT c.c_customer_sk) AS unique_customers, COUNT(sr.sr_item_sk) AS total_returned_items, SUM(sr.sr_net_loss) AS total_net_loss FROM customer_demographics cd JOIN customer c ON cd.cd_demo_sk = c.c_current_cdemo_sk JOIN store_returns sr ON c.c_customer_sk = sr.sr_customer_sk JOIN web_page wp ON c.c_customer_sk = wp.wp_customer_sk WHERE c.c_first_shipto_date_sk IN ('2452105', '2451393') AND c.c_first_sales_date_sk IN ('2450519', '2451079') AND cd.cd_gender IN ('M', 'F') AND wp.wp_type IN ('feedback', 'general', 'protected') GROUP BY cd.cd_education_status, cd.cd_gender, cd.cd_marital_status ORDER BY total_returns_inc_tax DESC, avg_purchase_estimate DESC;
SELECT i.i_category, i.i_brand, COUNT(DISTINCT ws.ws_order_number) AS total_web_orders, SUM(ws.ws_quantity) AS total_web_quantity_sold, SUM(ws.ws_net_paid) AS total_web_net_paid, AVG(ws.ws_net_profit) AS avg_web_net_profit, COUNT(DISTINCT ss.ss_ticket_number) AS total_store_sales_transactions, SUM(ss.ss_quantity) AS total_store_quantity_sold, SUM(ss.ss_net_paid_inc_tax) AS total_store_net_paid_inc_tax, AVG(ss.ss_net_profit) AS avg_store_net_profit, COUNT(DISTINCT hd.hd_demo_sk) AS unique_customers, AVG(hd.hd_dep_count) AS avg_dependent_count FROM item i LEFT JOIN web_sales ws ON i.i_item_sk = ws.ws_item_sk LEFT JOIN store_sales ss ON i.i_item_sk = ss.ss_item_sk LEFT JOIN household_demographics hd ON ss.ss_hdemo_sk = hd.hd_demo_sk OR ws.ws_ship_hdemo_sk = hd.hd_demo_sk WHERE i.i_brand IN ('edu packunivamalg #16', 'univmaxi #4', 'univnameless #5', 'amalgamalgamalg #17', 'edu packexporti #1') AND (ws.ws_order_number IN ('32000', '17527', '16129', '59722', '23980') OR ss.ss_ticket_number IS NOT NULL) GROUP BY i.i_category, i.i_brand ORDER BY i.i_category, i.i_brand;
SELECT web.web_name AS website_name, COUNT(DISTINCT ws.ws_order_number) AS total_orders, SUM(ws.ws_quantity) AS total_quantity_sold, AVG(ws.ws_sales_price) AS average_sales_price, SUM(ws.ws_net_paid) AS total_net_paid, SUM(ws.ws_net_profit) AS total_net_profit, t.t_shift AS sales_shift, s.s_store_name AS store_name, s.s_number_employees AS number_of_employees, s.s_city AS store_city, SUM(s.s_tax_precentage) AS total_tax_percentage_collected FROM web_sales ws JOIN web_site web ON ws.ws_web_site_sk = web.web_site_sk JOIN time_dim t ON ws.ws_sold_time_sk = t.t_time_sk JOIN store s ON web.web_mkt_id = s.s_market_id WHERE web.web_mkt_id IN ('1', '4', '3') AND t.t_shift = 'third' AND s.s_gmt_offset = '-5.00' AND s.s_number_employees IN ('297', '278', '229', '245') GROUP BY web.web_name, t.t_shift, s.s_store_name, s.s_number_employees, s.s_city ORDER BY total_net_profit DESC;
SELECT c.cd_gender, c.cd_marital_status, c.cd_education_status, c.cd_credit_rating, AVG(c.cd_purchase_estimate) AS avg_purchase_estimate, SUM(c.cd_dep_count) AS total_dep_count, SUM(c.cd_dep_employed_count) AS total_dep_employed_count, SUM(c.cd_dep_college_count) AS total_dep_college_count, w.w_state, w.w_country, COUNT(DISTINCT w.w_warehouse_sk) AS num_warehouses, AVG(w.w_warehouse_sq_ft) AS avg_warehouse_size, web.web_class, web.web_market_manager, COUNT(DISTINCT web.web_site_sk) AS num_websites, AVG(web.web_tax_percentage) AS avg_web_tax_percentage FROM customer_demographics c JOIN warehouse w ON c.cd_demo_sk = w.w_warehouse_sk JOIN web_site web ON w.w_state = web.web_state GROUP BY c.cd_gender, c.cd_marital_status, c.cd_education_status, c.cd_credit_rating, w.w_state, w.w_country, web.web_class, web.web_market_manager ORDER BY w.w_country, w.w_state, c.cd_education_status, c.cd_credit_rating;
SELECT i.i_category, COUNT(DISTINCT ss.ss_item_sk) AS item_count, SUM(ss.ss_net_paid) AS total_revenue, AVG(ss.ss_sales_price) AS average_sales_price, COUNT(DISTINCT s.s_store_sk) AS store_count, COUNT(DISTINCT ws.web_site_sk) AS website_count FROM store_sales ss JOIN item i ON ss.ss_item_sk = i.i_item_sk JOIN store s ON ss.ss_store_sk = s.s_store_sk JOIN web_site ws ON s.s_market_id = ws.web_mkt_id LEFT JOIN time_dim t ON ss.ss_sold_time_sk = t.t_time_sk WHERE s.s_market_id = 8 AND (ws.web_rec_end_date IS NULL OR ws.web_rec_end_date > CURRENT_DATE) AND ss.ss_sold_date_sk BETWEEN 2450654 AND 2450705 AND s.s_state IN ('Leon', 'Holiday Hills', 'Waterloo', 'Pinecrest') GROUP BY i.i_category ORDER BY total_revenue DESC;
SELECT s.s_store_name, i.i_brand, i.i_category, AVG(ws_sales_price) AS avg_sales_price, SUM(ws_net_paid_inc_ship_tax) AS total_sales_with_tax, AVG(ws_ext_discount_amt) AS avg_discount_amount, COUNT(DISTINCT ws_item_sk) AS total_items_sold, COUNT(DISTINCT ws_order_number) AS total_orders FROM web_sales ws JOIN item i ON ws.ws_item_sk = i.i_item_sk JOIN store s ON s.s_store_sk = ws.ws_warehouse_sk WHERE ws.ws_net_profit >= 100 AND i.i_rec_start_date <= CURRENT_DATE AND (i.i_rec_end_date IS NULL OR i.i_rec_end_date > CURRENT_DATE) AND s.s_rec_start_date <= CURRENT_DATE AND (s.s_rec_end_date IS NULL OR s.s_rec_end_date > CURRENT_DATE) GROUP BY s.s_store_name, i.i_brand, i.i_category ORDER BY total_sales_with_tax DESC, avg_sales_price DESC, total_items_sold DESC LIMIT 100;
SELECT cc.cc_name AS call_center_name, w.w_warehouse_name AS warehouse_name, s.s_state AS state, SUM(cs.cs_quantity) AS total_items_sold, AVG(cs.cs_sales_price) AS average_sales_price, COUNT(DISTINCT cs.cs_item_sk) AS number_of_unique_items_sold FROM catalog_sales cs INNER JOIN call_center cc ON cs.cs_call_center_sk = cc.cc_call_center_sk INNER JOIN warehouse w ON cs.cs_warehouse_sk = w.w_warehouse_sk INNER JOIN store s ON cc.cc_division = s.s_division_id WHERE cc.cc_market_manager IN ('Matthew Clifton', 'Gary Colburn') AND s.s_country = 'United States' GROUP BY call_center_name, warehouse_name, state ORDER BY total_items_sold DESC, average_sales_price DESC;
SELECT dd.d_year, dd.d_quarter_name, sm.sm_type, COUNT(DISTINCT inv.inv_item_sk) AS distinct_items_count, SUM(inv.inv_quantity_on_hand) AS total_quantity, AVG(i.i_wholesale_cost) AS avg_wholesale_cost, AVG(i.i_current_price) AS avg_current_price, (SUM(i.i_current_price * inv.inv_quantity_on_hand) - SUM(i.i_wholesale_cost * inv.inv_quantity_on_hand)) AS total_profit, COUNT(DISTINCT cc.cc_call_center_sk) AS call_centers_count, COUNT(DISTINCT w.w_warehouse_sk) AS warehouses_count, COUNT(DISTINCT ws.web_site_sk) AS web_sites_count FROM inventory inv JOIN item i ON inv.inv_item_sk = i.i_item_sk JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk JOIN date_dim dd ON inv.inv_date_sk = dd.d_date_sk JOIN call_center cc ON cc.cc_open_date_sk <= dd.d_date_sk AND (cc.cc_rec_end_date IS NULL OR cc.cc_rec_end_date >= dd.d_date) JOIN web_site ws ON ws.web_open_date_sk <= dd.d_date_sk AND (ws.web_rec_end_date IS NULL OR ws.web_rec_end_date >= dd.d_date) JOIN ship_mode sm ON sm.sm_code = 'AIR' WHERE dd.d_current_month = 'N' AND w.w_state = 'TN' AND w.w_city = 'Fairview' AND w.w_county = 'Williamson County' AND (cc.cc_class = 'large' OR cc.cc_class = 'medium') AND (i.i_color = 'forest' OR i.i_color = 'navy') AND ws.web_class <> 'Unknown' AND ws.web_gmt_offset = '-5.00' AND ws.web_company_id IN (3, 4, 5) GROUP BY dd.d_year, dd.d_quarter_name, sm.sm_type ORDER BY dd.d_year, dd.d_quarter_name, sm.sm_type;
SELECT i.i_category, cc.cc_mkt_class, SUM(cs.cs_net_paid) AS total_sales, AVG(cs.cs_sales_price) AS avg_sales_price, SUM(cs.cs_quantity) AS total_quantity_sold, AVG(cs.cs_wholesale_cost) AS avg_wholesale_cost FROM catalog_sales cs JOIN item i ON cs.cs_item_sk = i.i_item_sk JOIN call_center cc ON cs.cs_call_center_sk = cc.cc_call_center_sk WHERE cc.cc_name IN ('North Midwest', 'Mid Atlantic') AND i.i_class_id IN (3, 5, 12, 10) AND i.i_rec_start_date = '2001-10-27' GROUP BY i.i_category, cc.cc_mkt_class ORDER BY i.i_category, cc.cc_mkt_class;
SELECT dd.d_month_seq, dd.d_quarter_seq, dd.d_year, cp.cp_type, COUNT(DISTINCT inv.inv_item_sk) AS low_stock_items, AVG(inv.inv_quantity_on_hand) AS avg_quantity_on_hand, MIN(inv.inv_quantity_on_hand) AS min_quantity_on_hand, MAX(inv.inv_quantity_on_hand) AS max_quantity_on_hand, COUNT(DISTINCT inv.inv_warehouse_sk) AS affected_warehouses FROM inventory inv JOIN date_dim dd ON inv.inv_date_sk = dd.d_date_sk JOIN catalog_page cp ON inv.inv_item_sk = cp.cp_catalog_page_sk WHERE inv.inv_quantity_on_hand < 750 AND dd.d_year = 2022 GROUP BY dd.d_month_seq, dd.d_quarter_seq, dd.d_year, cp.cp_type ORDER BY dd.d_year, dd.d_quarter_seq, dd.d_month_seq, cp.cp_type;
SELECT i.i_category, i.i_class, i.i_brand, sum(ss.ss_quantity) AS total_quantity_sold, avg(ss.ss_sales_price) AS average_sales_price, sum(ss.ss_net_profit) AS total_net_profit, count(DISTINCT ss.ss_ticket_number) AS number_of_transactions, sum(ss.ss_coupon_amt) AS total_coupon_amount, ib.ib_lower_bound, ib.ib_upper_bound, date_dim.d_year, date_dim.d_quarter_name, COUNT(DISTINCT case when ss.ss_coupon_amt > 0 THEN ss.ss_ticket_number END) AS transactions_with_coupons FROM store_sales ss JOIN item i ON ss.ss_item_sk = i.i_item_sk JOIN household_demographics hd ON ss.ss_hdemo_sk = hd.hd_demo_sk JOIN income_band ib ON hd.hd_income_band_sk = ib.ib_income_band_sk JOIN date_dim ON ss.ss_sold_date_sk = date_dim.d_date_sk WHERE date_dim.d_year IN (2019, 2020) AND ib.ib_lower_bound >= 0 AND ib.ib_upper_bound <= 130000 GROUP BY i.i_category, i.i_class, i.i_brand, ib.ib_lower_bound, ib.ib_upper_bound, date_dim.d_year, date_dim.d_quarter_name ORDER BY total_net_profit DESC, total_quantity_sold DESC LIMIT 100;
SELECT s.s_store_name, s.s_city, s.s_manager, COUNT(DISTINCT sm.sm_ship_mode_sk) AS distinct_shipping_modes, SUM(s.s_floor_space) AS total_floor_space, AVG(s.s_number_employees) AS average_number_of_employees, SUM(s.s_tax_precentage) AS total_tax_percentage, COUNT(*) AS count_of_stores FROM store s LEFT JOIN ship_mode sm ON s.s_store_sk = sm.sm_ship_mode_sk LEFT JOIN reason r ON r.r_reason_sk = s.s_closed_date_sk WHERE s.s_manager IN ('Scott Smith', 'William Ward') AND s.s_city IN ('Fairview', 'Midway') AND r.r_reason_id IN ('AAAAAAAAOBAAAAAA', 'AAAAAAAAMBAAAAAA', 'AAAAAAAAGAAAAAAA', 'AAAAAAAAJBAAAAAA') AND sm.sm_type IN ('NEXT DAY', 'TWO DAY', 'LIBRARY', 'EXPRESS', 'REGULAR', 'OVERNIGHT') GROUP BY s.s_store_name, s.s_city, s.s_manager ORDER BY s.s_city, s.s_store_name;
SELECT c.c_first_name, c.c_last_name, c.c_email_address, SUM(sr.sr_return_quantity) AS total_returned_quantity, AVG(sr.sr_return_amt) AS average_return_amount, COUNT(DISTINCT sr.sr_ticket_number) AS number_of_returns, w.web_name, w.web_country FROM customer c JOIN store_returns sr ON c.c_customer_sk = sr.sr_customer_sk JOIN web_site w ON w.web_country = 'United States' WHERE sr.sr_return_quantity > 0 AND sr.sr_returned_date_sk BETWEEN w.web_open_date_sk AND w.web_close_date_sk AND w.web_rec_start_date BETWEEN '1997-08-16' AND '2001-08-16' GROUP BY c.c_customer_sk, w.web_site_sk ORDER BY total_returned_quantity DESC, average_return_amount DESC;
SELECT sm.sm_type AS shipping_type, web.web_site_sk, web.web_name AS website_name, COUNT(DISTINCT ws.ws_order_number) AS total_orders, SUM(ws.ws_net_paid) AS total_revenue, AVG(ws.ws_quantity) AS average_quantity, AVG(ws.ws_ext_discount_amt) AS average_discount, SUM(ws.ws_coupon_amt) AS total_coupon_amount, SUM(ws.ws_net_profit) AS total_profit FROM web_sales ws JOIN web_site web ON ws.ws_web_site_sk = web.web_site_sk JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk WHERE web.web_name IN ('site_3', 'site_4', 'site_1', 'site_0', 'site_2') AND sm.sm_contract IN ('GNJr3g5i7oorKqtX', 'uukTktPYycct8', 'ldhM8IvpzHgdbBgDfI', '2mM8l') AND ws.ws_sold_date_sk BETWEEN 20230101 AND 20231231 GROUP BY sm.sm_type, web.web_site_sk, web.web_name ORDER BY total_revenue DESC;
SELECT w.w_state, SUM(w.w_warehouse_sq_ft) AS total_warehouse_sq_ft, AVG(w.w_gmt_offset) AS average_gmt_offset, COUNT(r.r_reason_sk) AS gift_exchange_occurrences FROM warehouse w LEFT JOIN reason r ON r.r_reason_desc = 'Gift exchange' JOIN time_dim t ON t.t_minute BETWEEN 25 AND 35 GROUP BY w.w_state ORDER BY total_warehouse_sq_ft DESC, average_gmt_offset DESC;
SELECT d_year, web_name, COUNT(DISTINCT ws_order_number) AS total_orders, SUM(ws_quantity) AS total_quantity_sold, AVG(ws_net_paid_inc_tax) AS average_net_paid_inc_tax, SUM(ws_net_profit) AS total_net_profit FROM web_sales JOIN web_site ON web_sales.ws_web_site_sk = web_site.web_site_sk JOIN date_dim ON web_sales.ws_sold_date_sk = date_dim.d_date_sk WHERE d_year IN (1911, 1912) AND ws_net_paid_inc_tax > 100 AND ws_wholesale_cost < 100 AND web_sales.ws_web_site_sk IN ( SELECT web_site_sk FROM web_site WHERE web_class = 'Platinum' ) GROUP BY d_year, web_name ORDER BY total_net_profit DESC, d_year, web_name;
