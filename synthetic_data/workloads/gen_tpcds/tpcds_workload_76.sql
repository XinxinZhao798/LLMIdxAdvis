SELECT cc.cc_name, cc.cc_city, cc.cc_state, ib.ib_income_band_sk, COUNT(DISTINCT ws.ws_order_number) AS total_orders, SUM(ws.ws_quantity) AS total_quantity_sold, SUM(ws.ws_net_paid) AS total_net_paid, AVG(ws.ws_net_profit) AS average_net_profit, SUM(ws.ws_net_paid_inc_tax) AS total_net_paid_inc_tax, SUM(ws.ws_net_paid_inc_ship) AS total_net_paid_inc_ship, SUM(ws.ws_net_paid_inc_ship_tax) AS total_net_paid_inc_ship_tax FROM call_center cc JOIN web_sales ws ON cc.cc_call_center_sk = ws.ws_web_site_sk JOIN income_band ib ON ws.ws_bill_cdemo_sk = ib.ib_income_band_sk WHERE cc.cc_rec_end_date > CURRENT_DATE AND ib.ib_lower_bound > 50000 AND ib.ib_upper_bound < 180000 AND ws.ws_list_price BETWEEN 100 AND 200 GROUP BY cc.cc_name, cc.cc_city, cc.cc_state, ib.ib_income_band_sk ORDER BY total_net_paid DESC, cc.cc_state, cc.cc_city;
SELECT d_year, ca_state, COUNT(DISTINCT c_customer_sk) AS num_customers, SUM(ss_quantity) AS total_quantity, AVG(ss_sales_price) AS avg_sales_price, SUM(ss_net_paid) AS total_net_paid, SUM(ss_net_paid_inc_tax) AS total_net_paid_inc_tax, SUM(ss_net_profit) AS total_net_profit FROM store_sales JOIN date_dim ON store_sales.ss_sold_date_sk = date_dim.d_date_sk JOIN customer ON store_sales.ss_customer_sk = customer.c_customer_sk JOIN customer_address ON customer.c_current_addr_sk = customer_address.ca_address_sk WHERE d_weekend = 'N' AND ss_list_price IN (79.50, 143.98, 117.62) AND ca_state IS NOT NULL GROUP BY d_year, ca_state ORDER BY d_year, ca_state;
SELECT cp.cp_department, AVG(cr.cr_return_amount) AS avg_return_amount, SUM(cr.cr_return_quantity) AS total_return_quantity, COUNT(DISTINCT cr.cr_returned_date_sk) AS num_return_dates, SUM(ss.ss_net_paid) AS total_store_sales, SUM(ss.ss_quantity) AS total_store_quantity_sold, AVG(ws.ws_net_profit) AS avg_web_net_profit, SUM(ws.ws_quantity) AS total_web_quantity_sold FROM catalog_page cp JOIN catalog_returns cr ON cp.cp_catalog_page_sk = cr.cr_catalog_page_sk JOIN store_sales ss ON ss.ss_customer_sk = cr.cr_refunded_customer_sk JOIN web_sales ws ON ws.ws_bill_customer_sk = cr.cr_refunded_customer_sk WHERE cp.cp_end_date_sk BETWEEN 2450964 AND 2451694 AND cr.cr_return_amt_inc_tax BETWEEN 500 AND 1500 AND ss.ss_net_paid BETWEEN 500 AND 2100 AND ws.ws_ext_ship_cost BETWEEN 50 AND 1000 GROUP BY cp.cp_department ORDER BY total_return_quantity DESC, avg_return_amount DESC;
SELECT ib.ib_income_band_sk, cc.cc_division_name, AVG(wr.wr_return_amt_inc_tax) AS avg_return_amt_inc_tax, SUM(wr.wr_net_loss) AS total_net_loss, COUNT(wr.wr_returned_date_sk) AS total_returns, AVG(hd.hd_dep_count) AS avg_dependents, AVG(hd.hd_vehicle_count) AS avg_vehicles FROM web_returns wr JOIN household_demographics hd ON wr.wr_returning_hdemo_sk = hd.hd_demo_sk JOIN income_band ib ON hd.hd_income_band_sk = ib.ib_income_band_sk JOIN call_center cc ON cc.cc_country = 'United States' AND cc.cc_call_center_sk = wr.wr_refunded_addr_sk WHERE hd.hd_income_band_sk IN (20, 8, 18, 11, 19, 2) GROUP BY ib.ib_income_band_sk, cc.cc_division_name ORDER BY total_net_loss DESC, avg_return_amt_inc_tax DESC;
SELECT d_year, d_quarter_name, ca_state, COUNT(DISTINCT ws_order_number) AS total_orders, SUM(ws_quantity) AS total_quantity, AVG(ws_sales_price) AS average_sales_price, SUM(ws_net_paid) AS total_net_paid, SUM(ws_net_profit) AS total_net_profit, SUM(ws_ext_tax) AS total_tax_collected FROM web_sales JOIN date_dim ON ws_sold_date_sk = d_date_sk JOIN customer_address ON ws_bill_addr_sk = ca_address_sk JOIN customer_demographics ON ws_bill_cdemo_sk = cd_demo_sk JOIN catalog_page ON ws_web_page_sk = cp_catalog_page_sk JOIN store ON ws_warehouse_sk = s_store_sk WHERE d_current_quarter = 'N' AND cd_dep_employed_count = 0 AND cp_department = 'DEPARTMENT' AND ws_order_number IN ('25231', '23240', '18952', '15512', '28993', '33703') GROUP BY d_year, d_quarter_name, ca_state ORDER BY d_year, d_quarter_name, ca_state;
SELECT c.c_salutation, SUM(ss.ss_quantity) AS store_sales_quantity, AVG(ss.ss_sales_price) AS store_sales_avg_price, SUM(cs.cs_quantity) AS catalog_sales_quantity, AVG(cs.cs_sales_price) AS catalog_sales_avg_price, SUM(ws.ws_quantity) AS web_sales_quantity, AVG(ws.ws_sales_price) AS web_sales_avg_price, AVG(hd.hd_dep_count) AS avg_household_dep_count, AVG(ib.ib_upper_bound) AS avg_income_upper_bound FROM customer c LEFT JOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk LEFT JOIN catalog_sales cs ON c.c_customer_sk = cs.cs_bill_customer_sk LEFT JOIN web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk LEFT JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk LEFT JOIN income_band ib ON hd.hd_income_band_sk = ib.ib_income_band_sk WHERE c.c_salutation IN ('Mr.', 'Miss', 'Sir') AND hd.hd_buy_potential IN ('5001-10000', 'Unknown', '501-1000', '0-500', '>10000') AND hd.hd_income_band_sk IN (1, 6, 12, 18) AND (ss.ss_sold_time_sk IN (50436, 48475, 51865) OR ss.ss_sold_time_sk IS NULL) AND (ss.ss_ext_wholesale_cost IN (3684.31, 3037.11, 5884.90, 4962.49, 1522.56, 3630.06) OR ss.ss_ext_wholesale_cost IS NULL) GROUP BY c.c_salutation ORDER BY c.c_salutation;
SELECT w_state, i_category, i_brand, SUM(ss_quantity) AS total_quantity_sold, AVG(ss_sales_price) AS average_sales_price, COUNT(DISTINCT ss_customer_sk) AS unique_customer_count, SUM(ss_net_profit) AS total_net_profit FROM store_sales JOIN item ON ss_item_sk = i_item_sk JOIN inventory ON inv_item_sk = i_item_sk JOIN warehouse ON w_warehouse_sk = inventory.inv_warehouse_sk JOIN household_demographics ON ss_hdemo_sk = hd_demo_sk WHERE (i_rec_start_date BETWEEN '2000-01-01' AND '2002-12-31') AND (inv_date_sk BETWEEN 20010101 AND 20021231) AND (w_street_name IN ('Ash Laurel', '6th', 'Wilson Elm', 'View First')) AND (hd_demo_sk IN (156, 867, 379)) AND (ss_sold_time_sk IN (48439, 35208, 48824, 49199, 58065, 67684)) AND (ss_ext_wholesale_cost IN (2791.40, 1191.68, 2550.20, 1499.76, 3663.96, 2041.47)) GROUP BY w_state, i_category, i_brand ORDER BY total_net_profit DESC, total_quantity_sold DESC LIMIT 100;
SELECT ws.ws_web_site_sk, AVG(ws.ws_sales_price) AS avg_sales_price, COUNT(ws.ws_order_number) AS total_orders, AVG(ws.ws_quantity) AS avg_quantity, SUM(ws.ws_net_paid_inc_tax) AS total_revenue, SUM(ws.ws_net_paid) AS total_net_paid, SUM(ws.ws_coupon_amt) AS total_coupon_amt, AVG(hd.hd_dep_count) AS avg_dependency_count, AVG(hd.hd_vehicle_count) AS avg_vehicle_count, wp.wp_type, COUNT(DISTINCT hd.hd_demo_sk) AS unique_households FROM web_sales ws JOIN web_page wp ON ws.ws_web_page_sk = wp.wp_web_page_sk JOIN household_demographics hd ON ws.ws_ship_hdemo_sk = hd.hd_demo_sk JOIN time_dim td ON ws.ws_sold_time_sk = td.t_time_sk JOIN web_site wsit ON ws.ws_web_site_sk = wsit.web_site_sk WHERE wsit.web_gmt_offset = '-5.00' AND wsit.web_site_sk IN (6, 17, 14) AND td.t_time IN (3552, 4450, 1742) AND ws.ws_sales_price BETWEEN 17.54 AND 205.36 AND ws.ws_item_sk IN (51, 14, 107, 50, 104, 108) GROUP BY ws.ws_web_site_sk, wp.wp_type ORDER BY total_revenue DESC;
SELECT cd.cd_gender, cd.cd_marital_status, td.t_shift, COUNT(DISTINCT ss.ss_ticket_number) AS total_sales_transactions, SUM(ss.ss_quantity) AS total_units_sold, SUM(ss.ss_net_paid) AS total_revenue, AVG(ss.ss_net_paid) AS average_revenue_per_transaction, SUM(CASE WHEN p.p_channel_dmail = 'Y' THEN 1 ELSE 0 END) AS total_dmail_promotions, SUM(CASE WHEN p.p_channel_email = 'Y' THEN 1 ELSE 0 END) AS total_email_promotions, SUM(CASE WHEN p.p_channel_tv = 'Y' THEN 1 ELSE 0 END) AS total_tv_promotions FROM store_sales ss JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk JOIN time_dim td ON ss.ss_sold_time_sk = td.t_time_sk LEFT JOIN promotion p ON ss.ss_promo_sk = p.p_promo_sk WHERE ss.ss_hdemo_sk IN ('4855', '5486') GROUP BY cd.cd_gender, cd.cd_marital_status, td.t_shift ORDER BY total_revenue DESC, total_units_sold DESC;
SELECT cc.cc_name, cc.cc_class, cc.cc_employees, cc.cc_city, COUNT(*) AS num_promotions, AVG(cd.cd_purchase_estimate) AS avg_purchase_estimate, SUM(CASE WHEN cd.cd_marital_status = 'D' THEN 1 ELSE 0 END) AS divorced_customer_count, SUM(CASE WHEN p.p_channel_email = 'N' THEN p.p_cost ELSE 0 END) AS total_promotion_cost_non_email FROM call_center cc JOIN promotion p ON cc.cc_call_center_sk = p.p_item_sk JOIN customer c ON cc.cc_call_center_sk = c.c_current_addr_sk JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk WHERE cc.cc_company = '2' AND cd.cd_dep_college_count = 0 AND p.p_promo_name LIKE '%pri%' OR p.p_promo_name LIKE '%eing%' GROUP BY cc.cc_name, cc.cc_class, cc.cc_employees, cc.cc_city HAVING COUNT(*) > 5 ORDER BY avg_purchase_estimate DESC;
SELECT d_year, sm_type, r_reason_desc, COUNT(*) AS total_returns, SUM(cr_return_amount) AS total_return_amount, AVG(cr_return_amount) AS average_return_amount, SUM(cr_return_quantity) AS total_return_quantity, AVG(cr_return_quantity) AS average_return_quantity FROM catalog_returns JOIN date_dim ON cr_returned_date_sk = d_date_sk JOIN reason ON cr_reason_sk = r_reason_sk JOIN ship_mode ON cr_ship_mode_sk = sm_ship_mode_sk WHERE d_year IN (2020, 2021) AND cr_refunded_hdemo_sk IN ('6319', '1691', '6783', '2583', '2054', '1550') AND cr_refunded_customer_sk IN ('44015', '70912', '7271') GROUP BY d_year, sm_type, r_reason_desc ORDER BY d_year, total_return_amount DESC, total_returns DESC;
SELECT cd.cd_gender, cd.cd_marital_status, AVG(cd.cd_purchase_estimate) AS avg_purchase_estimate, SUM(ws.ws_net_paid) AS total_web_sales, COUNT(DISTINCT ws.ws_order_number) AS total_orders FROM web_sales ws JOIN customer_demographics cd ON ws.ws_bill_cdemo_sk = cd.cd_demo_sk JOIN web_site wsit ON ws.ws_web_site_sk = wsit.web_site_sk WHERE wsit.web_city IN ('Midway', 'Fairview') AND wsit.web_manager IN ('Lewis Wolf', 'William Carter') GROUP BY cd.cd_gender, cd.cd_marital_status ORDER BY total_web_sales DESC, avg_purchase_estimate DESC;
SELECT ib.ib_lower_bound, ib.ib_upper_bound, SUM(ss.ss_quantity) AS total_quantity_sold, AVG(ss.ss_sales_price) AS average_sales_price, COUNT(DISTINCT hd.hd_demo_sk) AS unique_households, COUNT(DISTINCT cc.cc_call_center_sk) AS total_call_centers, SUM(wh.w_warehouse_sq_ft) AS total_warehouse_sq_ft FROM store_sales ss JOIN household_demographics hd ON ss.ss_hdemo_sk = hd.hd_demo_sk JOIN income_band ib ON hd.hd_income_band_sk = ib.ib_income_band_sk JOIN call_center cc ON cc.cc_mkt_id = ss.ss_sold_date_sk JOIN warehouse wh ON wh.w_warehouse_sk = ss.ss_addr_sk WHERE hd.hd_buy_potential = '>10000' AND ib.ib_upper_bound < 150000 AND ss.ss_ext_list_price > 2100 AND cc.cc_gmt_offset = -5.00 AND cc.cc_mkt_desc LIKE 'Rich groups catch longer other fears; future,%' GROUP BY ib.ib_lower_bound, ib.ib_upper_bound;
SELECT i.i_category, COUNT(DISTINCT ws.ws_order_number) AS total_sales_orders, SUM(ws.ws_quantity) AS total_quantity_sold, SUM(ws.ws_net_paid) - SUM(cr.cr_return_amount) AS net_sales, AVG(ws.ws_sales_price) AS average_sale_amount, COUNT(DISTINCT cr.cr_order_number) AS total_return_orders, SUM(cr.cr_return_quantity) AS total_quantity_returned, AVG(cr.cr_return_amount) AS average_return_amount FROM item i LEFT JOIN web_sales ws ON i.i_item_sk = ws.ws_item_sk LEFT JOIN catalog_returns cr ON i.i_item_sk = cr.cr_item_sk WHERE (ws.ws_sold_date_sk BETWEEN 20010101 AND 20011231 OR cr.cr_returned_date_sk BETWEEN 20010101 AND 20011231) AND i.i_category IN ('Electronics', 'Clothing', 'Home Goods') GROUP BY i.i_category ORDER BY net_sales DESC;
SELECT cc.cc_name, cc.cc_city, cc.cc_state, SUM(cc.cc_employees) AS total_employees, AVG(cc.cc_sq_ft) AS average_square_footage, COUNT(DISTINCT c.c_customer_sk) AS number_of_customers, COUNT(DISTINCT p.p_promo_sk) AS number_of_promotions, SUM(CASE WHEN c.c_preferred_cust_flag = 'Y' THEN 1 ELSE 0 END) AS preferred_customers_count, AVG(CASE WHEN p.p_discount_active = 'Y' THEN p.p_cost ELSE NULL END) AS average_active_discount_cost, MAX(ib.ib_upper_bound) AS max_income_band_upper_bound FROM call_center cc JOIN customer c ON (cc.cc_call_center_sk = c.c_current_addr_sk) JOIN promotion p ON (cc.cc_mkt_id = p.p_item_sk) LEFT JOIN income_band ib ON (c.c_current_hdemo_sk = ib.ib_income_band_sk) WHERE cc.cc_mkt_class IN ('Silly particles could pro', 'Dealers make most historical, direct students') AND cc.cc_mkt_id IN ('6', '2', '5') AND p.p_channel_email = 'N' GROUP BY cc.cc_name, cc.cc_city, cc.cc_state ORDER BY number_of_customers DESC, total_employees DESC;
SELECT dd.d_year, dd.d_quarter_name, COUNT(DISTINCT sr.sr_ticket_number) AS total_store_returns, SUM(sr.sr_return_amt_inc_tax) AS total_store_return_value, AVG(sr.sr_return_amt_inc_tax) AS avg_store_return_value, COUNT(DISTINCT cr.cr_order_number) AS total_catalog_returns, SUM(cr.cr_return_amt_inc_tax) AS total_catalog_return_value, AVG(cr.cr_return_amt_inc_tax) AS avg_catalog_return_value, SUM(inv.inv_quantity_on_hand) AS total_inventory, AVG(inv.inv_quantity_on_hand) AS avg_inventory, COUNT(DISTINCT p.p_promo_sk) AS total_promotions, SUM(p.p_cost) AS total_promotion_cost, AVG(p.p_cost) AS avg_promotion_cost FROM date_dim dd LEFT JOIN store_returns sr ON dd.d_date_sk = sr.sr_returned_date_sk LEFT JOIN catalog_returns cr ON dd.d_date_sk = cr.cr_returned_date_sk LEFT JOIN inventory inv ON dd.d_date_sk = inv.inv_date_sk LEFT JOIN promotion p ON dd.d_date_sk BETWEEN p.p_start_date_sk AND p.p_end_date_sk WHERE dd.d_current_quarter = 'N' AND dd.d_dow IN ('2', '1', '3') AND dd.d_week_seq IN ('357', '270', '599') AND dd.d_day_name IN ('Friday', 'Wednesday', 'Thursday') AND cr.cr_refunded_cash IN ('41.98', '2827.18', '326.60') AND cr.cr_return_tax IN ('78.35', '1.90', '17.50') AND cr.cr_reason_sk IN ('10', '6', '34') AND inv.inv_date_sk = '2450815' AND inv.inv_quantity_on_hand IN ('527', '833', '192') AND sr.sr_store_credit IN ('65.83', '69.57', '46.64') AND sr.sr_return_amt_inc_tax IN ('1345.99', '37.28', '546.00') AND sr.sr_hdemo_sk IN ('5161', '6269', '797') AND p.p_channel_radio = 'N' AND p.p_channel_press = 'N' GROUP BY dd.d_year, dd.d_quarter_name ORDER BY dd.d_year, dd.d_quarter_name;
SELECT cp.cp_department, COUNT(DISTINCT ss.ss_ticket_number) AS total_sales_transactions, SUM(ss.ss_quantity) AS total_sales_quantity, SUM(ss.ss_net_paid) AS total_sales_amount, COUNT(DISTINCT sr.sr_ticket_number) AS total_return_transactions, SUM(sr.sr_return_quantity) AS total_return_quantity, SUM(sr.sr_net_loss) AS total_return_amount, AVG(hd.hd_dep_count) AS avg_dependents, AVG(hd.hd_vehicle_count) AS avg_vehicles FROM catalog_page cp LEFT JOIN store_sales ss ON cp.cp_catalog_page_sk = ss.ss_sold_date_sk LEFT JOIN store_returns sr ON cp.cp_catalog_page_sk = sr.sr_returned_date_sk LEFT JOIN time_dim td ON ss.ss_sold_time_sk = td.t_time_sk LEFT JOIN household_demographics hd ON ss.ss_hdemo_sk = hd.hd_demo_sk WHERE cp.cp_start_date_sk IN ('2451450', '2451545', '2451115', '2450997', '2450935', '2451330') GROUP BY cp.cp_department ORDER BY cp.cp_department;
SELECT cc.cc_name, cc.cc_city, cc.cc_state, SUM(cs.cs_quantity) AS total_quantity_sold, AVG(cs.cs_sales_price) AS average_sales_price, COUNT(DISTINCT c.c_customer_sk) AS unique_customers, SUM(wr.wr_return_quantity) AS total_quantity_returned, SUM(wr.wr_net_loss) AS total_net_loss, COUNT(DISTINCT sm.sm_ship_mode_sk) AS shipping_modes_used FROM call_center cc JOIN catalog_sales cs ON cc.cc_call_center_sk = cs.cs_call_center_sk JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk LEFT JOIN web_returns wr ON cs.cs_item_sk = wr.wr_item_sk AND cs.cs_order_number = wr.wr_order_number LEFT JOIN ship_mode sm ON cs.cs_ship_mode_sk = sm.sm_ship_mode_sk WHERE cc.cc_open_date_sk IS NOT NULL AND (wr.wr_item_sk = '10174' OR wr.wr_item_sk = '3888') AND wr.wr_web_page_sk = '37' GROUP BY cc.cc_name, cc.cc_city, cc.cc_state ORDER BY total_net_loss DESC, total_quantity_sold DESC, unique_customers DESC;
SELECT i.i_category AS item_category, p.p_promo_name AS promotion_name, COUNT(DISTINCT ss.ss_ticket_number) AS total_sales_transactions, SUM(ss.ss_quantity) AS total_quantity_sold, AVG(ss.ss_sales_price) AS average_sales_price, COUNT(DISTINCT cr.cr_order_number) AS total_return_transactions, SUM(cr.cr_return_quantity) AS total_quantity_returned, SUM(ss.ss_net_profit) AS total_net_profit, CASE WHEN SUM(ss.ss_net_profit) >= 0 THEN 'Profitable' ELSE 'Not Profitable' END AS profitability_status FROM store_sales ss JOIN item i ON ss.ss_item_sk = i.i_item_sk LEFT JOIN promotion p ON ss.ss_promo_sk = p.p_promo_sk LEFT JOIN catalog_returns cr ON ss.ss_item_sk = cr.cr_item_sk AND ss.ss_ticket_number = cr.cr_order_number JOIN date_dim dd ON ss.ss_sold_date_sk = dd.d_date_sk WHERE dd.d_year = 2022 AND dd.d_current_year = 'Y' AND p.p_channel_catalog = 'N' AND p.p_channel_event = 'N' GROUP BY i.i_category, p.p_promo_name ORDER BY total_net_profit DESC, total_sales_transactions DESC;
SELECT sm.sm_type, sm.sm_carrier, w.web_site_sk, w.web_mkt_class, COUNT(DISTINCT ws.ws_order_number) AS total_orders, SUM(ws.ws_quantity) AS total_quantity, SUM(ws.ws_net_paid) AS total_net_paid, AVG(ws.ws_net_paid_inc_ship_tax) AS avg_net_paid_inc_ship_tax, SUM(ws.ws_net_profit) AS total_net_profit FROM web_sales ws JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk WHERE ws.ws_net_paid BETWEEN 100 AND 3000 AND sm.sm_code IN ('SEA', 'SURFACE') AND w.web_street_type = 'Road' AND w.web_mkt_class LIKE 'Broad, new groups show car%' GROUP BY ROLLUP(sm.sm_type, sm.sm_carrier, w.web_site_sk, w.web_mkt_class) ORDER BY total_net_profit DESC, total_quantity DESC, avg_net_paid_inc_ship_tax DESC;
SELECT cp.cp_department, i.i_category, COUNT(DISTINCT cp.cp_catalog_page_sk) AS total_catalog_pages, COUNT(DISTINCT i.i_item_sk) AS total_items, AVG(i.i_current_price) AS average_item_price, SUM(i.i_wholesale_cost) AS total_wholesale_cost, MAX(hd.hd_dep_count) AS max_dep_count, AVG(hd.hd_vehicle_count) AS average_vehicle_count, COUNT(DISTINCT web.web_site_sk) AS total_websites, web.web_country, SUM(web.web_tax_percentage) AS total_tax_percentage FROM catalog_page cp JOIN item i ON cp.cp_catalog_number = i.i_brand_id JOIN household_demographics hd ON hd.hd_income_band_sk = i.i_class_id JOIN web_site web ON web.web_company_id = i.i_manufact_id WHERE web.web_rec_end_date BETWEEN '1999-08-16' AND '2001-08-15' GROUP BY cp.cp_department, i.i_category, web.web_country ORDER BY total_catalog_pages DESC, total_items DESC, average_item_price ASC, total_websites DESC;
SELECT c.c_first_name, c.c_last_name, c.c_email_address, SUM(inv.inv_quantity_on_hand) AS total_inventory, AVG(wr.wr_return_amt_inc_tax) AS avg_return_amount_inc_tax, COUNT(DISTINCT wr.wr_order_number) AS total_returns, td.t_shift, SUM(wr.wr_fee) AS total_return_fees, SUM(wr.wr_net_loss) AS total_net_loss FROM customer c JOIN web_returns wr ON c.c_customer_sk = wr.wr_returning_customer_sk JOIN inventory inv ON wr.wr_item_sk = inv.inv_item_sk JOIN time_dim td ON wr.wr_returned_time_sk = td.t_time_sk WHERE c.c_email_address IN ('Brandi.Miller@JH5mldviNI7xQKVQj.com', 'Steven.Williams@uxeKdX2slbhOxguR.edu', 'Maryalice.Rivers@4b9MXdByVXI.com') AND c.c_birth_day IN (26, 12, 21) AND inv.inv_quantity_on_hand IN (31, 517, 732) AND inv.inv_date_sk = 2450815 AND inv.inv_item_sk IN (12622, 7663, 9094) AND inv.inv_warehouse_sk IN (2, 1) AND wr.wr_returning_cdemo_sk IN (940737, 1276363, 1374880) AND wr.wr_returned_time_sk IN (69044, 3060, 44094) AND wr.wr_reversed_charge IN (22.11, 1530.12, 160.93) AND wr.wr_reason_sk IN (1, 8, 25) GROUP BY c.c_first_name, c.c_last_name, c.c_email_address, td.t_shift ORDER BY total_inventory DESC, avg_return_amount_inc_tax DESC, total_returns DESC;
