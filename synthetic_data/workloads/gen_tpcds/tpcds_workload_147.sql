SELECT ca.ca_location_type, COUNT(DISTINCT p.p_promo_sk) AS num_promotions, SUM(p.p_cost) AS total_promotion_cost, SUM(CASE WHEN p.p_channel_dmail = '1' THEN 1 ELSE 0 END) AS dmail_promotions, SUM(CASE WHEN p.p_channel_email = '1' THEN 1 ELSE 0 END) AS email_promotions, SUM(CASE WHEN p.p_channel_catalog = '1' THEN 1 ELSE 0 END) AS catalog_promotions, SUM(CASE WHEN p.p_channel_tv = '1' THEN 1 ELSE 0 END) AS tv_promotions, SUM(CASE WHEN p.p_channel_radio = '1' THEN 1 ELSE 0 END) AS radio_promotions, SUM(CASE WHEN p.p_channel_press = '1' THEN 1 ELSE 0 END) AS press_promotions, SUM(CASE WHEN p.p_channel_event = '1' THEN 1 ELSE 0 END) AS event_promotions, SUM(CASE WHEN p.p_channel_demo = '1' THEN 1 ELSE 0 END) AS demo_promotions, AVG(p.p_cost) AS avg_promotion_cost_per_channel FROM promotion p JOIN customer_address ca ON p.p_item_sk = ca.ca_address_sk WHERE ca.ca_location_type IN ('single family', 'apartment', 'condo') AND ca.ca_street_type LIKE '%Way%' AND p.p_cost >= 1000.00 AND p.p_promo_id IN ('AAAAAAAAEGAAAAAA', 'AAAAAAAAGJAAAAAA', 'AAAAAAAAHFAAAAAA', 'AAAAAAAAPBBAAAAA') GROUP BY ca.ca_location_type ORDER BY total_promotion_cost DESC;
SELECT dd.d_year, dd.d_quarter_name, ca.ca_state, COUNT(DISTINCT cs.cs_order_number) AS total_orders, SUM(cs.cs_quantity) AS total_quantity, SUM(cs.cs_net_paid) AS total_net_paid, AVG(cs.cs_net_profit) AS avg_net_profit FROM catalog_sales cs JOIN date_dim dd ON cs.cs_sold_date_sk = dd.d_date_sk JOIN customer_address ca ON cs.cs_ship_addr_sk = ca.ca_address_sk JOIN customer_demographics cd ON cs.cs_bill_cdemo_sk = cd.cd_demo_sk JOIN store s ON ca.ca_state = s.s_state WHERE dd.d_current_quarter = 'N' AND dd.d_following_holiday = 'N' AND cd.cd_credit_rating = 'Good' AND s.s_market_id IS NOT NULL GROUP BY dd.d_year, dd.d_quarter_name, ca.ca_state ORDER BY dd.d_year, dd.d_quarter_name, ca.ca_state;
SELECT dd.d_year, dd.d_quarter_name, SUM(cs.cs_quantity) AS total_quantity_sold, AVG(cs.cs_sales_price) AS average_sales_price, COUNT(DISTINCT cs.cs_order_number) AS total_orders, SUM(cs.cs_net_profit) AS total_net_profit, cc.cc_name AS call_center_name, cc.cc_division_name AS call_center_division, cc.cc_city AS call_center_city FROM catalog_sales cs JOIN date_dim dd ON cs.cs_sold_date_sk = dd.d_date_sk JOIN call_center cc ON cs.cs_call_center_sk = cc.cc_call_center_sk WHERE dd.d_qoy IN (1, 2, 3, 4) AND dd.d_dom IN (20, 24) AND cc.cc_sq_ft IN ('4134', '1138', '2268') AND cc.cc_division IN ('1', '4') GROUP BY dd.d_year, dd.d_quarter_name, cc.cc_name, cc.cc_division_name, cc.cc_city ORDER BY dd.d_year, dd.d_quarter_name, total_net_profit DESC;
SELECT ca_state, ca_county, COUNT(DISTINCT c_customer_sk) AS total_customers, COUNT(DISTINCT ws_order_number) AS total_web_orders, SUM(ws_net_paid) AS total_web_sales, SUM(ws_net_profit) AS total_web_profit, COUNT(DISTINCT sr_ticket_number) AS total_returns, SUM(sr_return_amt) AS total_return_amount, AVG(sr_return_quantity) AS average_return_quantity, r_reason_desc FROM customer JOIN customer_address ON c_current_addr_sk = ca_address_sk JOIN web_sales ON ws_bill_customer_sk = c_customer_sk LEFT JOIN store_returns ON sr_customer_sk = c_customer_sk AND sr_reason_sk IS NOT NULL LEFT JOIN reason ON sr_reason_sk = r_reason_sk JOIN time_dim ON ws_sold_time_sk = t_time_sk JOIN warehouse ON ws_warehouse_sk = w_warehouse_sk WHERE ca_state IN ('CA', 'TX') AND ((t_hour = '1' AND t_am_pm = 'AM') OR (t_hour = '0')) AND (w_street_number IN ('534', '368', '651', '600')) AND (r_reason_id = 'AAAAAAAANAAAAAAA' OR r_reason_id IS NULL) GROUP BY ca_state, ca_county, r_reason_desc ORDER BY total_web_sales DESC, ca_state, ca_county;
SELECT cc.cc_name, cc.cc_city, cc.cc_state, SUM(cs.cs_net_paid) AS total_sales, AVG(cs.cs_net_paid_inc_tax) AS avg_sales_inc_tax, COUNT(*) AS number_of_sales, SUM(ws.ws_quantity) AS total_web_quantity_sold, AVG(ws.ws_net_profit) AS avg_web_net_profit FROM call_center cc JOIN catalog_sales cs ON cc.cc_call_center_sk = cs.cs_call_center_sk JOIN web_sales ws ON cs.cs_item_sk = ws.ws_item_sk AND cs.cs_order_number = ws.ws_order_number JOIN promotion p ON cs.cs_promo_sk = p.p_promo_sk AND ws.ws_promo_sk = p.p_promo_sk WHERE cs.cs_ship_customer_sk IN (17646, 63607, 15126, 61460) AND p.p_discount_active = '1' AND cc.cc_rec_start_date <= CURRENT_DATE AND (cc.cc_rec_end_date IS NULL OR cc.cc_rec_end_date > CURRENT_DATE) GROUP BY cc.cc_name, cc.cc_city, cc.cc_state ORDER BY total_sales DESC LIMIT 10;
SELECT i.i_category, SUM(ss.ss_quantity) AS total_quantity_sold, AVG(ss.ss_sales_price) AS average_sales_price, COUNT(DISTINCT ss.ss_ticket_number) AS number_of_sales_transactions, SUM(inv.inv_quantity_on_hand) AS total_inventory_on_hand, SUM(ss.ss_net_profit) AS total_net_profit FROM item i JOIN store_sales ss ON i.i_item_sk = ss.ss_item_sk JOIN inventory inv ON i.i_item_sk = inv.inv_item_sk JOIN time_dim t ON ss.ss_sold_time_sk = t.t_time_sk WHERE i.i_wholesale_cost BETWEEN 4 AND 7 AND inv.inv_date_sk = '2450815' AND ss.ss_ext_sales_price < 5000 AND t.t_hour BETWEEN 0 AND 1 GROUP BY i.i_category ORDER BY total_net_profit DESC;
SELECT p.p_promo_id, p.p_promo_name, COUNT(DISTINCT cs.cs_item_sk) AS number_of_items_sold, SUM(cs.cs_quantity) AS total_quantity_sold, AVG(cs.cs_sales_price) AS average_selling_price, SUM(cs.cs_ext_sales_price) AS total_sales_amount, SUM(cs.cs_ext_discount_amt) AS total_discount_amount, AVG((cs.cs_ext_discount_amt / cs.cs_ext_list_price) * 100) AS average_discount_percentage, SUM(cs.cs_net_profit) AS total_net_profit, AVG(inv.inv_quantity_on_hand) AS average_inventory_quantity_on_hand FROM catalog_sales cs JOIN promotion p ON cs.cs_promo_sk = p.p_promo_sk LEFT JOIN inventory inv ON cs.cs_item_sk = inv.inv_item_sk AND cs.cs_sold_date_sk = inv.inv_date_sk WHERE cs.cs_ext_list_price IN (8856.28, 4863.95, 651.00, 4727.68) GROUP BY p.p_promo_id, p.p_promo_name ORDER BY total_sales_amount DESC;
SELECT dd.d_year, dd.d_quarter_name, SUM(cs.cs_quantity) AS total_catalog_quantity, AVG(cs.cs_sales_price) AS average_catalog_sales_price, SUM(cs.cs_net_profit) AS total_catalog_net_profit, SUM(ws.ws_quantity) AS total_web_quantity, AVG(ws.ws_sales_price) AS average_web_sales_price, SUM(ws.ws_net_profit) AS total_web_net_profit, SUM(cs.cs_quantity) + SUM(ws.ws_quantity) AS total_combined_quantity, AVG(cs.cs_sales_price * cs.cs_quantity + ws.ws_sales_price * ws.ws_quantity) / AVG(cs.cs_quantity + ws.ws_quantity) AS average_combined_sales_price, SUM(cs.cs_net_profit) + SUM(ws.ws_net_profit) AS total_combined_net_profit FROM date_dim dd LEFT JOIN catalog_sales cs ON dd.d_date_sk = cs.cs_sold_date_sk LEFT JOIN web_sales ws ON dd.d_date_sk = ws.ws_sold_date_sk WHERE dd.d_year = 2001 AND dd.d_current_quarter = 'N' GROUP BY dd.d_year, dd.d_quarter_name ORDER BY dd.d_year, dd.d_quarter_name;
SELECT hd.hd_dep_count AS number_of_dependents, hd.hd_vehicle_count AS number_of_vehicles, ca.ca_location_type AS customer_location_type, ca.ca_street_type AS street_type, t.t_am_pm AS return_time_period, COUNT(DISTINCT cr.cr_order_number) AS total_returned_orders, SUM(cr.cr_return_quantity) AS total_returned_quantity, AVG(cr.cr_return_amount) AS average_return_amount, SUM(cr.cr_net_loss) AS total_net_loss FROM catalog_returns cr JOIN household_demographics hd ON cr.cr_returning_hdemo_sk = hd.hd_demo_sk JOIN customer_address ca ON cr.cr_returning_addr_sk = ca.ca_address_sk JOIN time_dim t ON cr.cr_returned_time_sk = t.t_time_sk WHERE ca.ca_location_type IN ('single family', 'apartment', 'condo') AND ca.ca_street_type IN ('Boulevard', 'Ct.', 'Avenue', 'Way', 'Parkway', 'ST') AND t.t_am_pm = 'AM' GROUP BY hd.hd_dep_count, hd.hd_vehicle_count, ca.ca_location_type, ca.ca_street_type, t.t_am_pm ORDER BY total_net_loss DESC, average_return_amount DESC;
SELECT s_store_name, s_state, s_city, d_fy_year, ca_location_type, SUM(ss_quantity) AS total_items_sold, SUM(ss_net_paid) AS total_sales, AVG(ss_sales_price) AS average_sales_price, COUNT(DISTINCT ss_customer_sk) AS unique_customers, SUM(CASE WHEN d_holiday = 'Y' THEN ss_quantity ELSE 0 END) AS holiday_items_sold, SUM(CASE WHEN d_holiday = 'Y' THEN ss_net_paid ELSE 0 END) AS holiday_sales FROM store_sales JOIN store ON store.s_store_sk = store_sales.ss_store_sk JOIN date_dim ON date_dim.d_date_sk = store_sales.ss_sold_date_sk JOIN customer_address ON customer_address.ca_address_sk = store_sales.ss_addr_sk WHERE d_fy_year = (SELECT MAX(d_fy_year) FROM date_dim WHERE d_current_year = 'Y') AND store_sales.ss_list_price BETWEEN 51.03 AND 142.73 AND store_sales.ss_hdemo_sk IN ('3633', '6235', '1050') AND customer_address.ca_location_type IN ('single family', 'apartment') GROUP BY s_store_name, s_state, s_city, d_fy_year, ca_location_type ORDER BY total_sales DESC, s_store_name, s_state, s_city;
SELECT cp.cp_department, AVG(cr.cr_return_amount) AS avg_return_amount, SUM(cr.cr_return_amount) AS total_return_amount, COUNT(cr.cr_return_amount) AS num_returns, AVG(cs.cs_sales_price) AS avg_sales_price, SUM(cs.cs_sales_price) AS total_sales, COUNT(cs.cs_sales_price) AS num_sales, ca.ca_state, COUNT(DISTINCT ca.ca_city) AS num_cities FROM catalog_page cp JOIN catalog_sales cs ON cp.cp_catalog_page_sk = cs.cs_catalog_page_sk JOIN catalog_returns cr ON cp.cp_catalog_page_sk = cr.cr_catalog_page_sk JOIN customer_address ca ON cs.cs_ship_addr_sk = ca.ca_address_sk WHERE cp.cp_catalog_number IN (29, 40) AND cr.cr_refunded_cdemo_sk = 1173022 GROUP BY cp.cp_department, ca.ca_state ORDER BY total_return_amount DESC, total_sales DESC;
SELECT ca.ca_state AS customer_state, EXTRACT(YEAR FROM d_date) AS year_of_return, COUNT(DISTINCT wr.wr_order_number) AS total_returns, SUM(wr.wr_return_quantity) AS total_returned_quantity, SUM(wr.wr_return_amt) AS total_return_amount, SUM(wr.wr_return_tax) AS total_tax, SUM(wr.wr_return_amt_inc_tax) AS total_amount_including_tax, SUM(wr.wr_return_ship_cost) AS total_shipping_cost, SUM(wr.wr_refunded_cash) AS total_refunded_cash, SUM(wr.wr_reversed_charge) AS total_reversed_charge, SUM(wr.wr_account_credit) AS total_account_credit, SUM(wr.wr_net_loss) AS total_net_loss FROM web_returns wr JOIN customer c ON wr.wr_returning_customer_sk = c.c_customer_sk JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk JOIN date_dim d ON wr.wr_returned_date_sk = d.d_date_sk WHERE d.d_year >= 2003 GROUP BY ca.ca_state, year_of_return ORDER BY ca.ca_state, year_of_return;
SELECT cc_state, ca_location_type, COUNT(DISTINCT ws_order_number) AS total_orders, SUM(ws_quantity) AS total_quantity_sold, AVG(ws_sales_price) AS avg_sales_price, SUM(ws_net_paid) AS total_net_paid, SUM(ws_net_profit) AS total_net_profit FROM web_sales ws JOIN store s ON ws.ws_bill_addr_sk = s.s_store_sk JOIN call_center cc ON cc.cc_call_center_sk = ws.ws_ship_mode_sk JOIN customer_address ca ON ws.ws_bill_addr_sk = ca.ca_address_sk JOIN household_demographics hd ON ws.ws_bill_hdemo_sk = hd.hd_demo_sk WHERE ws.ws_item_sk IN (70, 58, 77) AND hd.hd_dep_count BETWEEN 1 AND 9 AND ca.ca_location_type IN ('single family', 'apartment', 'condo') AND ca.ca_city IN ('Ferguson', 'Holiday Hills') GROUP BY cc_state, ca_location_type ORDER BY total_net_profit DESC, total_net_paid DESC;
SELECT i.i_category, sm.sm_type, COUNT(DISTINCT cs.cs_order_number) AS total_orders, SUM(cs.cs_quantity) AS total_quantity_sold, AVG(cs.cs_sales_price) AS average_sales_price, SUM(cs.cs_net_paid) AS total_net_paid, SUM(cs.cs_net_profit) AS total_net_profit, AVG(cs.cs_net_profit) AS average_net_profit, SUM(inv.inv_quantity_on_hand) AS total_inventory_on_hand FROM catalog_sales cs JOIN item i ON cs.cs_item_sk = i.i_item_sk JOIN ship_mode sm ON cs.cs_ship_mode_sk = sm.sm_ship_mode_sk JOIN inventory inv ON i.i_item_sk = inv.inv_item_sk WHERE sm.sm_type = 'EXPRESS' AND inv.inv_date_sk = 2450815 AND (inv.inv_quantity_on_hand IN (339, 505, 759, 226, 679) OR cs.cs_bill_hdemo_sk IN (523, 2390, 5794)) GROUP BY i.i_category, sm.sm_type ORDER BY total_net_profit DESC;
SELECT re.r_reason_desc AS return_reason, sm.sm_type AS ship_mode_type, COUNT(DISTINCT cr.cr_order_number) AS total_returns, SUM(cr.cr_return_quantity) AS total_returned_quantity, AVG(cr.cr_return_amount) AS avg_return_amount, SUM(cr.cr_return_amount) AS sum_return_amount, SUM(cr.cr_return_tax) AS sum_return_tax, SUM(cr.cr_return_amt_inc_tax) AS sum_return_amt_inc_tax, SUM(cr.cr_fee) AS sum_fees, SUM(cr.cr_return_ship_cost) AS sum_return_ship_cost, SUM(cr.cr_refunded_cash) AS sum_refunded_cash, SUM(cr.cr_reversed_charge) AS sum_reversed_charge, SUM(cr.cr_store_credit) AS sum_store_credit, SUM(cr.cr_net_loss) AS sum_net_loss, wh.w_warehouse_name AS warehouse_name, st.s_store_name AS store_name FROM catalog_returns cr JOIN reason re ON cr.cr_reason_sk = re.r_reason_sk JOIN ship_mode sm ON cr.cr_ship_mode_sk = sm.sm_ship_mode_sk JOIN warehouse wh ON cr.cr_warehouse_sk = wh.w_warehouse_sk JOIN store st ON cr.cr_returning_customer_sk = st.s_store_sk GROUP BY return_reason, ship_mode_type, warehouse_name, store_name ORDER BY sum_net_loss DESC, total_returned_quantity DESC;
SELECT w_state, web_name, ca_city, COUNT(DISTINCT cr_order_number) AS total_returns, AVG(cr_return_amount) AS avg_return_amount, SUM(cr_return_quantity) AS total_returned_quantity, SUM(cr_return_amount) AS total_returned_amount, SUM(cr_fee) AS total_fees, SUM(cr_net_loss) AS total_net_loss, COUNT(DISTINCT ss_ticket_number) AS total_sales_transactions, AVG(ss_sales_price) AS avg_sales_price, SUM(ss_quantity) AS total_sold_quantity, SUM(ss_net_profit) AS total_net_profit FROM warehouse JOIN catalog_returns ON w_warehouse_sk = cr_warehouse_sk JOIN reason ON cr_reason_sk = r_reason_sk JOIN customer_address ON cr_returning_addr_sk = ca_address_sk JOIN store_sales ON cr_item_sk = ss_item_sk AND cr_order_number = ss_ticket_number JOIN store ON ss_store_sk = s_store_sk JOIN web_site ON s_store_sk = web_site_sk WHERE w_country = 'United States' AND ca_street_number IN ('125', '871', '690') AND ca_city = 'Glenville' AND web_rec_end_date IN ('1999-08-16', '2000-08-15', '2001-08-15') AND web_site_sk IN ('25', '29', '21', '17') GROUP BY w_state, web_name, ca_city ORDER BY total_returns DESC, total_net_profit DESC;
SELECT w.w_warehouse_name AS warehouse_name, w.w_city AS warehouse_city, w.w_state AS warehouse_state, ib.ib_lower_bound AS income_lower_bound, ib.ib_upper_bound AS income_upper_bound, SUM(sr.sr_return_amt) AS total_return_amount, AVG(sr.sr_return_amt) AS avg_return_amount, COUNT(sr.sr_return_amt) AS num_returns, SUM(cr.cr_return_amount) AS total_catalog_return_amount, AVG(cr.cr_return_amount) AS avg_catalog_return_amount, COUNT(cr.cr_return_amount) AS num_catalog_returns FROM store_returns sr JOIN warehouse w ON sr.sr_addr_sk = w.w_warehouse_sk JOIN household_demographics hd ON sr.sr_hdemo_sk = hd.hd_demo_sk JOIN income_band ib ON hd.hd_income_band_sk = ib.ib_income_band_sk JOIN catalog_returns cr ON sr.sr_item_sk = cr.cr_item_sk WHERE w.w_country = 'United States' AND (ib.ib_income_band_sk IN (19, 8, 15) OR sr.sr_customer_sk IN (48071, 49096)) AND sr.sr_refunded_cash IN (53.31, 1261.77, 176.73) AND w.w_warehouse_name IN ('Important issues liv', 'Bad cards must make.', 'Conventional childr', 'Doors canno') GROUP BY w.w_warehouse_name, w.w_city, w.w_state, ib.ib_lower_bound, ib.ib_upper_bound ORDER BY total_return_amount DESC;
SELECT ca.ca_city, ib.ib_income_band_sk, AVG(cs.cs_sales_price) AS avg_sales_price, AVG(cr.cr_return_amount) AS avg_return_amount, COUNT(DISTINCT cs.cs_order_number) AS total_sales_orders, COUNT(DISTINCT cr.cr_order_number) AS total_return_orders, SUM(cs.cs_quantity) AS total_quantity_sold, SUM(cr.cr_return_quantity) AS total_quantity_returned FROM catalog_sales cs JOIN customer_address ca ON cs.cs_ship_addr_sk = ca.ca_address_sk JOIN catalog_returns cr ON cr.cr_returning_addr_sk = ca.ca_address_sk JOIN income_band ib ON ca.ca_gmt_offset = ib.ib_income_band_sk WHERE ca.ca_city IN ('Shannon', 'Gilbert', 'Sheridan', 'Winslow') AND ib.ib_upper_bound IN (40000, 90000, 80000, 140000, 160000, 30000) GROUP BY ca.ca_city, ib.ib_income_band_sk ORDER BY ca.ca_city, ib.ib_income_band_sk;
SELECT cc.cc_division_name, COUNT(DISTINCT cc.cc_call_center_sk) AS num_call_centers, AVG(cc.cc_employees) AS avg_employees, SUM(inv.inv_quantity_on_hand) AS total_inventory, SUM(wr.wr_return_amt_inc_tax) AS total_returns_inc_tax, AVG(wp.wp_link_count) AS avg_link_count_per_page FROM call_center cc JOIN inventory inv ON cc.cc_call_center_sk = inv.inv_warehouse_sk JOIN web_returns wr ON inv.inv_item_sk = wr.wr_item_sk JOIN web_page wp ON wr.wr_web_page_sk = wp.wp_web_page_sk WHERE cc.cc_division IN (1, 3, 5) AND cc.cc_open_date_sk IN (2450952, 2450806, 2451063) AND wr.wr_web_page_sk IN (2, 32, 58, 26, 39) GROUP BY cc.cc_division_name ORDER BY total_returns_inc_tax DESC, avg_link_count_per_page DESC;
