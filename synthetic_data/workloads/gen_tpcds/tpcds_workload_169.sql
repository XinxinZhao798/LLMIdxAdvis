SELECT st.s_store_name AS store_name, SUM(sales.ss_net_paid) AS total_sales, AVG(sales.ss_quantity) AS average_quantity_sold, COUNT(DISTINCT customer.c_customer_sk) AS unique_customers, cd.cd_education_status AS education_status, cd.cd_gender AS gender, COUNT(promo.p_promo_sk) AS promotion_count, AVG(promo.p_cost) AS average_promotion_cost FROM store_sales sales JOIN store st ON sales.ss_store_sk = st.s_store_sk JOIN customer ON sales.ss_customer_sk = customer.c_customer_sk JOIN customer_demographics cd ON customer.c_current_cdemo_sk = cd.cd_demo_sk JOIN promotion promo ON sales.ss_promo_sk = promo.p_promo_sk WHERE st.s_hours IN ('8AM-12AM', '8AM-4PM') AND cd.cd_education_status IN ('Unknown', 'Advanced Degree', '2 yr Degree', 'College') AND cd.cd_gender IN ('M', 'F') AND sales.ss_sold_date_sk BETWEEN promo.p_start_date_sk AND promo.p_end_date_sk GROUP BY st.s_store_name, cd.cd_education_status, cd.cd_gender ORDER BY total_sales DESC, average_quantity_sold DESC;
SELECT c.c_salutation, cd.cd_gender, cd.cd_education_status, cd.cd_credit_rating, COUNT(*) AS total_customers, SUM(ws.ws_quantity) AS total_quantity_sold, AVG(ws.ws_sales_price) AS average_sales_price, SUM(ws.ws_net_paid) AS total_net_paid, SUM(ws.ws_net_profit) AS total_net_profit, COUNT(DISTINCT ws.ws_promo_sk) AS number_of_promotions_used FROM customer c JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk JOIN web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk JOIN promotion p ON ws.ws_promo_sk = p.p_promo_sk WHERE c.c_salutation IN ('Sir', 'Miss', 'Mrs.', 'Ms.') AND cd.cd_demo_sk IN ('17361', '17821', '17056', '18235') AND ws.ws_list_price = '160.03' AND ws.ws_ship_cdemo_sk IN ('887064', '1910407', '1755166', '369305', '1188209') GROUP BY c.c_salutation, cd.cd_gender, cd.cd_education_status, cd.cd_credit_rating ORDER BY total_net_profit DESC, total_customers DESC, average_sales_price DESC;
SELECT s.s_store_name, s.s_city, s.s_state, SUM(i.inv_quantity_on_hand) AS total_quantity_on_hand, AVG(i.inv_quantity_on_hand) AS avg_quantity_on_hand, COUNT(DISTINCT i.inv_item_sk) AS unique_items_count, COUNT(DISTINCT i.inv_warehouse_sk) AS warehouse_count, SUM(wp.wp_link_count) AS total_webpage_links, AVG(wp.wp_image_count) AS avg_webpage_images FROM inventory i JOIN store s ON i.inv_warehouse_sk = s.s_store_sk JOIN web_page wp ON s.s_market_id = wp.wp_customer_sk WHERE i.inv_date_sk = 2450815 AND i.inv_quantity_on_hand IN (499, 291, 296, 643, 586) AND s.s_state IN ('IL', 'KY', 'OR', 'VA', 'FL', 'AL', 'OK', 'IA', 'TX') AND wp.wp_type = 'product' GROUP BY s.s_store_name, s.s_city, s.s_state ORDER BY total_quantity_on_hand DESC, avg_quantity_on_hand DESC;
SELECT cp.cp_department, i.i_category, COUNT(cr.cr_order_number) AS total_returns, SUM(cr.cr_return_amount) AS total_return_amount, AVG(cr.cr_return_amount) AS avg_return_amount, SUM(cr.cr_return_quantity) AS total_return_quantity, r.r_reason_desc, COUNT(DISTINCT cr.cr_refunded_customer_sk) AS unique_customers_refunded, COUNT(DISTINCT cr.cr_returning_customer_sk) AS unique_customers_returning, SUM(cr.cr_net_loss) AS total_net_loss FROM catalog_returns cr JOIN catalog_page cp ON cr.cr_catalog_page_sk = cp.cp_catalog_page_sk JOIN item i ON cr.cr_item_sk = i.i_item_sk JOIN reason r ON cr.cr_reason_sk = r.r_reason_sk WHERE cp.cp_end_date_sk IN ('2451087', '2451239', '2450904', '2450844') GROUP BY cp.cp_department, i.i_category, r.r_reason_desc ORDER BY total_return_amount DESC, total_returns DESC LIMIT 100;
SELECT cp.cp_department, i.i_category, COUNT(DISTINCT cp.cp_catalog_page_sk) AS total_catalog_pages, COUNT(DISTINCT i.i_item_sk) AS total_items, AVG(i.i_current_price) AS average_item_price, SUM(i.i_wholesale_cost) AS total_wholesale_cost, MAX(hd.hd_dep_count) AS max_dep_count, AVG(hd.hd_vehicle_count) AS average_vehicle_count, COUNT(DISTINCT web.web_site_sk) AS total_websites, web.web_country, SUM(web.web_tax_percentage) AS total_tax_percentage FROM catalog_page cp JOIN item i ON cp.cp_catalog_number = i.i_brand_id JOIN household_demographics hd ON hd.hd_income_band_sk = i.i_class_id JOIN web_site web ON web.web_company_id = i.i_manufact_id WHERE web.web_rec_end_date BETWEEN '1999-08-16' AND '2001-08-15' GROUP BY cp.cp_department, i.i_category, web.web_country ORDER BY total_catalog_pages DESC, total_items DESC, average_item_price ASC, total_websites DESC;
SELECT cd.cd_education_status, ib.ib_income_band_sk, COUNT(DISTINCT ws.ws_order_number) AS number_of_orders, SUM(ws.ws_net_profit) AS total_net_profit, AVG(ws.ws_sales_price) AS average_sales_price FROM web_sales ws JOIN customer_demographics cd ON ws.ws_bill_cdemo_sk = cd.cd_demo_sk JOIN household_demographics hd ON ws.ws_bill_hdemo_sk = hd.hd_demo_sk JOIN income_band ib ON hd.hd_income_band_sk = ib.ib_income_band_sk WHERE cd.cd_purchase_estimate IS NOT NULL AND ib.ib_upper_bound <= 110000 AND ib.ib_income_band_sk IN (4, 1, 14, 13, 8) GROUP BY ROLLUP (cd.cd_education_status, ib.ib_income_band_sk) ORDER BY total_net_profit DESC, cd.cd_education_status, ib.ib_income_band_sk;
SELECT sm.sm_type AS shipping_type, COUNT(DISTINCT cs.cs_order_number) AS total_orders, SUM(cs.cs_quantity) AS total_items_sold, AVG(cs.cs_sales_price) AS average_sales_price, SUM(cs.cs_net_paid) AS total_revenue, SUM(cs.cs_net_profit) AS total_profit, COUNT(DISTINCT wr.wr_order_number) AS total_returns, SUM(wr.wr_return_quantity) AS total_items_returned, AVG(wr.wr_return_amt) AS average_return_amount, SUM(wr.wr_net_loss) AS total_loss FROM catalog_sales cs JOIN ship_mode sm ON cs.cs_ship_mode_sk = sm.sm_ship_mode_sk LEFT JOIN web_returns wr ON cs.cs_order_number = wr.wr_order_number AND cs.cs_item_sk = wr.wr_item_sk JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk WHERE sm.sm_type IN ('REGULAR', 'OVERNIGHT') AND cd.cd_gender IN ('M', 'F') AND cs.cs_quantity IN (91, 62, 46, 68, 45) AND (wr.wr_returned_time_sk = 74117 OR wr.wr_returned_time_sk IS NULL) GROUP BY sm.sm_type ORDER BY total_revenue DESC, total_loss ASC;
SELECT s.s_store_name, s.s_state, cp.cp_department, COUNT(*) AS total_returns, AVG(wr.wr_return_amt) AS avg_refund_amount, AVG(wr.wr_return_tax) AS avg_tax, AVG(wr.wr_return_ship_cost) AS avg_shipping_cost, SUM(wr.wr_net_loss) AS total_net_loss, AVG(cd.cd_purchase_estimate) AS avg_purchase_estimate, COUNT(DISTINCT wr.wr_refunded_customer_sk) AS unique_customers FROM web_returns wr JOIN store s ON wr.wr_returning_addr_sk = s.s_store_sk JOIN customer_demographics cd ON wr.wr_refunded_cdemo_sk = cd.cd_demo_sk JOIN catalog_page cp ON wr.wr_web_page_sk = cp.cp_catalog_page_sk WHERE s.s_division_id = 1 AND s.s_tax_precentage IN (0.08, 0.01, 0.06, 0.03) AND cp.cp_description LIKE 'Traditional, clear years used to cover regardless%' AND cp.cp_start_date_sk >= 2450997 AND cd.cd_credit_rating = 'Good' GROUP BY s.s_store_name, s.s_state, cp.cp_department ORDER BY total_net_loss DESC, avg_refund_amount DESC;
SELECT web_name, SUM(p_cost) AS total_promotion_cost, AVG(inv_quantity_on_hand) AS avg_inventory_quantity, COUNT(DISTINCT c_customer_sk) AS unique_customer_count, COUNT(DISTINCT r_reason_sk) AS unique_reason_count FROM web_site JOIN promotion ON (web_close_date_sk BETWEEN p_start_date_sk AND p_end_date_sk) JOIN inventory ON (inv_date_sk BETWEEN p_start_date_sk AND p_end_date_sk) JOIN customer ON (c_first_sales_date_sk BETWEEN p_start_date_sk AND p_end_date_sk) LEFT JOIN reason ON (c_last_review_date_sk = r_reason_sk) WHERE p_channel_press = 'N' AND inv_warehouse_sk IN (1, 2) AND p_end_date_sk IN (2450816, 2450598, 2450185, 2450481) GROUP BY web_name ORDER BY total_promotion_cost DESC, avg_inventory_quantity DESC, unique_customer_count DESC, unique_reason_count DESC;
SELECT d_year, d_quarter_name, sm_type AS shipping_type, COUNT(DISTINCT sr_customer_sk) AS num_customers_returned, SUM(sr_return_quantity) AS total_returned_qty, AVG(sr_return_amt) AS avg_return_amt, SUM(sr_return_amt) AS sum_return_amt, SUM(sr_fee) AS total_fees, SUM(sr_net_loss) AS total_net_loss, COUNT(DISTINCT wr_refunded_customer_sk) AS num_customers_refunded, SUM(wr_return_quantity) AS total_refunded_qty, AVG(wr_return_amt) AS avg_refunded_amt, SUM(wr_return_amt) AS sum_refunded_amt, SUM(wr_fee) AS total_wr_fees, SUM(wr_net_loss) AS total_wr_net_loss FROM date_dim JOIN store_returns ON (date_dim.d_date_sk = store_returns.sr_returned_date_sk) JOIN ship_mode ON (store_returns.sr_item_sk = ship_mode.sm_ship_mode_sk) JOIN web_returns ON (store_returns.sr_returned_date_sk = web_returns.wr_returned_date_sk) WHERE sm_carrier = 'MSC' AND d_year = 2022 GROUP BY d_year, d_quarter_name, sm_type ORDER BY d_year, d_quarter_name, sm_type;
SELECT p_channel_dmail, p_channel_email, p_channel_catalog, p_channel_tv, p_channel_radio, p_channel_press, p_channel_event, p_channel_demo, AVG(p_cost) AS average_promo_cost, SUM(p_cost) AS total_promo_cost, COUNT(p_promo_sk) AS number_of_promotions, SUM(inv_quantity_on_hand) AS total_inventory, AVG(inv_quantity_on_hand) AS average_inventory, COUNT(DISTINCT inv_item_sk) AS distinct_items_in_inventory, MIN(ib_lower_bound) AS min_income_band_lower_bound, MAX(ib_upper_bound) AS max_income_band_upper_bound FROM promotion JOIN inventory ON promotion.p_item_sk = inventory.inv_item_sk LEFT JOIN income_band ON inventory.inv_quantity_on_hand BETWEEN income_band.ib_lower_bound AND income_band.ib_upper_bound WHERE p_response_target = 1 AND ib_income_band_sk IN (10, 19, 13) AND inv_item_sk = 15788 AND inv_quantity_on_hand IN (329, 356, 513, 875, 262) AND p_discount_active = 'Y' GROUP BY p_channel_dmail, p_channel_email, p_channel_catalog, p_channel_tv, p_channel_radio, p_channel_press, p_channel_event, p_channel_demo ORDER BY number_of_promotions DESC, total_promo_cost DESC;
SELECT s.s_store_name, s.s_store_id, COUNT(DISTINCT ss.ss_ticket_number) AS total_sales_transactions, SUM(ss.ss_quantity) AS total_quantity_sold, SUM(ss.ss_net_paid) AS total_net_sales, SUM(ss.ss_net_paid_inc_tax) AS total_net_sales_including_tax, SUM(cr.cr_return_quantity) AS total_returned_quantity, SUM(cr.cr_return_amount) AS total_return_amount, r.r_reason_desc AS return_reason, AVG(ss.ss_net_profit) AS average_net_profit_per_sale, COUNT(DISTINCT cr.cr_order_number) AS total_return_transactions, SUM(cr.cr_net_loss) AS total_net_loss_from_returns FROM store s LEFT JOIN store_sales ss ON s.s_store_sk = ss.ss_store_sk LEFT JOIN catalog_returns cr ON ss.ss_item_sk = cr.cr_item_sk AND ss.ss_ticket_number = cr.cr_order_number LEFT JOIN reason r ON cr.cr_reason_sk = r.r_reason_sk WHERE s.s_gmt_offset = '-5.00' AND s.s_division_id = 1 AND ( r.r_reason_desc = 'its is a boy' OR r.r_reason_desc = 'reason 25' OR r.r_reason_desc = 'Found a better extended warranty in a store' OR r.r_reason_desc = 'reason 27' ) GROUP BY s.s_store_name, s.s_store_id, r.r_reason_desc ORDER BY s.s_store_name, s.s_store_id, r.r_reason_desc;
SELECT ca.ca_state AS State, AVG(hd.hd_income_band_sk) AS Avg_Income_Band, AVG(hd.hd_dep_count) AS Avg_Dependent_Count, AVG(hd.hd_vehicle_count) AS Avg_Vehicle_Count, COUNT(*) FILTER (WHERE hd.hd_buy_potential = 'High') AS High_Buying_Potential_Count, COUNT(*) FILTER (WHERE hd.hd_buy_potential = 'Medium') AS Medium_Buying_Potential_Count, COUNT(*) FILTER (WHERE hd.hd_buy_potential = 'Low') AS Low_Buying_Potential_Count, COUNT(DISTINCT ca.ca_address_sk) AS Address_Count, AVG(ws.web_tax_percentage) AS Avg_Web_Tax_Percentage FROM customer_address ca JOIN household_demographics hd ON ca.ca_address_sk = hd.hd_demo_sk JOIN web_site ws ON ca.ca_state = ws.web_state WHERE ca.ca_country = 'United States' AND ws.web_country = 'United States' AND ca.ca_state IS NOT NULL AND ws.web_tax_percentage IS NOT NULL GROUP BY ca.ca_state ORDER BY Avg_Income_Band DESC, High_Buying_Potential_Count DESC, Medium_Buying_Potential_Count DESC, Low_Buying_Potential_Count DESC;
