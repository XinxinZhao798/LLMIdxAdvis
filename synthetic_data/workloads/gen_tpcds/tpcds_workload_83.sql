SELECT cd.cd_education_status, cd.cd_marital_status, ca.ca_state, cd.cd_credit_rating, AVG(cd.cd_purchase_estimate) AS average_purchase_estimate, COUNT(DISTINCT ca.ca_address_sk) AS number_of_addresses, SUM(hd.hd_vehicle_count) AS total_vehicles, AVG(t.t_hour + (t.t_minute / 60.0) + (t.t_second / 3600.0)) AS average_time_of_day FROM customer_demographics cd JOIN customer_address ca ON cd.cd_demo_sk = ca.ca_address_sk JOIN household_demographics hd ON cd.cd_demo_sk = hd.hd_demo_sk JOIN time_dim t ON t.t_time_sk = ca.ca_address_sk WHERE cd.cd_credit_rating IN ('Low Risk', 'High Risk', 'Good') AND t.t_time IN (775, 962) AND t.t_second IN (52, 26, 34) AND ca.ca_address_id IN ('AAAAAAAANJCAAAAA', 'AAAAAAAAFMCAAAAA', 'AAAAAAAAHGOAAAAA', 'AAAAAAAAHEEAAAAA') AND cd.cd_dep_count IN (1, 2) AND hd.hd_dep_count IN (0, 6, 4, 1) AND hd.hd_vehicle_count IN (3, 4) GROUP BY cd.cd_education_status, cd.cd_marital_status, ca.ca_state, cd.cd_credit_rating ORDER BY average_purchase_estimate DESC;
SELECT w.web_name, cp.cp_department, sm.sm_type, COUNT(distinct i.i_item_sk) as total_items, SUM(i.i_current_price) as total_sales, AVG(i.i_wholesale_cost) as avg_wholesale_cost, COUNT(distinct w.web_site_sk) as total_websites FROM web_site w JOIN catalog_page cp ON w.web_site_sk = cp.cp_catalog_number JOIN item i ON cp.cp_department = i.i_category JOIN ship_mode sm ON sm.sm_carrier = i.i_manufact WHERE i.i_category = 'Music' AND w.web_city IN ('Fairview', 'Midway') AND sm.sm_ship_mode_id IN ('AAAAAAAAIAAAAAAA', 'AAAAAAAALAAAAAAA') AND i.i_item_id IN ('AAAAAAAAJCCAAAAA', 'AAAAAAAANGMAAAAA', 'AAAAAAAAICDAAAAA', 'AAAAAAAAHLABAAAA', 'AAAAAAAAIIEAAAAA', 'AAAAAAAALAOAAAAA') AND w.web_name IN ('site_3', 'site_4', 'site_1', 'site_0', 'site_2') GROUP BY w.web_name, cp.cp_department, sm.sm_type ORDER BY total_sales DESC;
SELECT hd.hd_vehicle_count AS "Vehicle Count", COUNT(DISTINCT ws.ws_order_number) AS "Number of Orders", SUM(ws.ws_sales_price) AS "Total Sales Amount", AVG(ws.ws_sales_price) AS "Average Sales Price", COUNT(ws.ws_item_sk) AS "Items Sold", p.p_promo_name AS "Promotion Name", CASE WHEN p.p_discount_active = 'Y' THEN 'Discount Active' ELSE 'No Discount' END AS "Discount Status" FROM web_sales ws JOIN promotion p ON ws.ws_promo_sk = p.p_promo_sk JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk WHERE p.p_discount_active = 'Y' AND hd.hd_vehicle_count IN (0, 2, 3) GROUP BY hd.hd_vehicle_count, p.p_promo_name, p.p_discount_active ORDER BY "Total Sales Amount" DESC, "Vehicle Count";
SELECT dd.d_year, dd.d_quarter_name, SUM(ws.ws_net_paid) AS total_net_paid, AVG(ws.ws_quantity) AS average_quantity, COUNT(*) AS sales_transactions, SUM(inv.inv_quantity_on_hand) AS total_inventory, COUNT(DISTINCT ws.ws_item_sk) AS distinct_items_sold, COUNT(DISTINCT s.s_store_sk) AS number_of_stores, SUM(cr.cr_return_amount) AS total_return_amount, AVG(cr.cr_return_quantity) AS average_return_quantity, COUNT(DISTINCT cr.cr_item_sk) AS distinct_items_returned FROM date_dim AS dd JOIN web_sales AS ws ON dd.d_date_sk = ws.ws_sold_date_sk JOIN inventory AS inv ON ws.ws_item_sk = inv.inv_item_sk AND ws.ws_sold_date_sk = inv.inv_date_sk JOIN store AS s ON ws.ws_bill_customer_sk = s.s_store_sk LEFT JOIN catalog_returns AS cr ON ws.ws_item_sk = cr.cr_item_sk AND ws.ws_order_number = cr.cr_order_number WHERE dd.d_current_year = 'N' AND ws.ws_promo_sk IS NOT NULL AND s.s_market_id IN (8, 2, 4, 7) AND inv.inv_warehouse_sk IN (1, 2) GROUP BY dd.d_year, dd.d_quarter_name ORDER BY dd.d_year, dd.d_quarter_name;
SELECT d.d_year, d.d_quarter_name, p.p_promo_name, sm.sm_type, SUM(cs.cs_quantity) AS total_quantity_sold, AVG(cs.cs_sales_price) AS average_sales_price, SUM(cs.cs_net_profit) AS total_net_profit, COUNT(DISTINCT cr.cr_order_number) AS total_returns, SUM(cr.cr_return_amount) AS total_return_amount, SUM(ws.ws_net_paid_inc_tax) AS total_web_sales_inc_tax FROM date_dim d JOIN catalog_sales cs ON cs.cs_sold_date_sk = d.d_date_sk JOIN ship_mode sm ON cs.cs_ship_mode_sk = sm.sm_ship_mode_sk JOIN promotion p ON cs.cs_promo_sk = p.p_promo_sk LEFT JOIN catalog_returns cr ON cs.cs_order_number = cr.cr_order_number LEFT JOIN web_sales ws ON cs.cs_order_number = ws.ws_order_number WHERE d.d_year = 2003 AND p.p_channel_details LIKE '%early%' GROUP BY d.d_year, d.d_quarter_name, p.p_promo_name, sm.sm_type ORDER BY total_net_profit DESC, total_quantity_sold DESC LIMIT 100;
SELECT cc.cc_name, cc.cc_city, cc.cc_state, SUM(cr.cr_return_amount) AS total_return_amount, AVG(cr.cr_return_amount) AS avg_return_amount, COUNT(cr.cr_order_number) AS total_returns, SUM(cr.cr_return_quantity) AS total_returned_items, COUNT(DISTINCT cr.cr_returning_customer_sk) AS unique_returning_customers, SUM(case when hd.hd_dep_count IS NOT NULL THEN 1 ELSE 0 END) AS returns_with_dep_count, SUM(case when hd.hd_vehicle_count IS NOT NULL THEN 1 ELSE 0 END) AS returns_with_vehicle_count, COUNT(DISTINCT p.p_promo_sk) AS total_promotions_involved, SUM(p.p_cost) AS total_promotion_cost FROM call_center cc LEFT JOIN catalog_returns cr ON cc.cc_call_center_sk = cr.cr_call_center_sk LEFT JOIN household_demographics hd ON cr.cr_returning_hdemo_sk = hd.hd_demo_sk LEFT JOIN promotion p ON p.p_item_sk = cr.cr_item_sk WHERE cc.cc_company_name IN ('able', 'ought', 'cally', 'pri') AND cc.cc_hours IN ('8AM-4PM', '8AM-8AM') AND p.p_channel_tv = 'N' AND p.p_purpose = 'Unknown' AND cr.cr_refunded_cash IN ('5415.08', '1.89', '288.51', '2.49', '307.01') GROUP BY cc.cc_name, cc.cc_city, cc.cc_state ORDER BY total_return_amount DESC;
SELECT s_state, cp_department, COUNT(DISTINCT s_store_sk) AS store_count, AVG(s_number_employees) AS avg_number_employees, SUM(wr_return_amt_inc_tax) AS total_return_amount_inc_tax, AVG(wr_return_quantity) AS avg_return_quantity, SUM(wr_net_loss) AS total_net_loss FROM store JOIN catalog_page ON (s_store_sk = cp_catalog_page_sk) JOIN web_returns ON (s_store_sk = wr_returning_addr_sk) WHERE s_suite_number IN ('Suite T', 'Suite 140') AND cp_start_date_sk IS NOT NULL AND wr_returned_date_sk IS NOT NULL GROUP BY ROLLUP(s_state, cp_department) ORDER BY s_state, cp_department;
SELECT s.s_state, s.s_county, cd.cd_marital_status, COUNT(DISTINCT i.i_item_sk) AS total_items, SUM(i.i_current_price) AS total_revenue, AVG(i.i_wholesale_cost) AS average_wholesale_cost, COUNT(DISTINCT hd.hd_demo_sk) AS total_households, AVG(hd.hd_vehicle_count) AS average_vehicle_count, SUM(CASE WHEN i.i_units = 'Bundle' THEN 1 ELSE 0 END) AS bundle_units, SUM(CASE WHEN i.i_units = 'Pound' THEN 1 ELSE 0 END) AS pound_units, SUM(CASE WHEN i.i_units = 'Oz' THEN 1 ELSE 0 END) AS oz_units, COUNT(DISTINCT s.s_store_sk) AS total_stores, AVG(s.s_floor_space) AS average_floor_space FROM item i JOIN store s ON (i.i_manufact_id = s.s_store_sk) JOIN household_demographics hd ON (s.s_store_sk = hd.hd_income_band_sk) JOIN customer_demographics cd ON (hd.hd_demo_sk = cd.cd_demo_sk) WHERE hd.hd_dep_count IN ('6', '9', '5') AND hd.hd_demo_sk IN ('28', '1536', '3779') AND hd.hd_vehicle_count IN ('2', '1', '3') AND i.i_units IN ('Bundle', 'Pound', 'Oz') AND i.i_rec_end_date IN ('1999-10-27', '2000-10-26', '2001-10-26') AND s.s_market_desc IN ('Events develop i', 'Architects coul', 'Little expectations include yet forward meetings.') AND s.s_state = 'TN' AND s.s_county = 'Williamson County' AND s.s_floor_space IN ('8954883', '9341467', '5285950') AND cd.cd_dep_college_count = '0' AND cd.cd_demo_sk IN ('20554', '21012', '21822') AND cd.cd_marital_status IN ('S', 'M', 'D') GROUP BY s.s_state, s.s_county, cd.cd_marital_status ORDER BY total_revenue DESC, average_wholesale_cost DESC;
SELECT i_category, i_class, COUNT(DISTINCT ss_ticket_number) AS total_sales_transactions, SUM(ss_sales_price) AS total_sales_revenue, AVG(ss_sales_price) AS avg_sales_price, SUM(cr_return_amount) AS total_return_revenue, AVG(cr_return_amount) AS avg_return_amount, SUM(sr_return_amt) AS total_store_return_revenue, AVG(sr_return_amt) AS avg_store_return_amount, (SUM(ss_sales_price) - SUM(cr_return_amount) - SUM(sr_return_amt)) AS net_revenue, SUM(inv_quantity_on_hand) AS total_inventory_quantity, COUNT(DISTINCT inv_warehouse_sk) AS num_warehouses_stocking FROM item LEFT JOIN store_sales ON store_sales.ss_item_sk = item.i_item_sk LEFT JOIN catalog_returns ON catalog_returns.cr_item_sk = item.i_item_sk LEFT JOIN store_returns ON store_returns.sr_item_sk = item.i_item_sk LEFT JOIN inventory ON inventory.inv_item_sk = item.i_item_sk WHERE i_manufact = 'oughtought' AND (inventory.inv_item_sk = 14212 OR inventory.inv_item_sk = 6826) AND inventory.inv_date_sk = 2450815 AND store_sales.ss_list_price = 145.48 GROUP BY i_category, i_class ORDER BY net_revenue DESC;
SELECT ca.ca_state, ca.ca_city, sum(cs.cs_quantity) AS total_quantity_sold, avg(cs.cs_sales_price) AS average_sales_price, count(distinct cs.cs_order_number) AS total_orders, cd.cd_education_status, sum(cs.cs_net_profit) AS total_net_profit, count(distinct cs.cs_item_sk) AS unique_items_sold, ib.ib_lower_bound, ib.ib_upper_bound FROM catalog_sales cs JOIN customer_address ca ON cs.cs_ship_addr_sk = ca.ca_address_sk JOIN customer_demographics cd ON cs.cs_ship_cdemo_sk = cd.cd_demo_sk JOIN income_band ib ON cd.cd_purchase_estimate BETWEEN ib.ib_lower_bound AND ib.ib_upper_bound WHERE ca.ca_county = 'Lonoke County' AND (cd.cd_gender = 'M' OR cd.cd_gender = 'F') GROUP BY ca.ca_state, ca.ca_city, cd.cd_education_status, ib.ib_lower_bound, ib.ib_upper_bound ORDER BY ca.ca_state, ca.ca_city, cd.cd_education_status, total_net_profit DESC;
SELECT dd.d_year AS year, dd.d_moy AS month, dd.d_month_seq AS month_sequence, cp.cp_department AS department, COUNT(cp.cp_catalog_page_sk) AS catalog_page_count, AVG(dd.d_dom) AS average_day_of_month, SUM(CASE WHEN dd.d_weekend = 'Y' THEN 1 ELSE 0 END) AS weekend_days, SUM(CASE WHEN dd.d_holiday = 'Y' THEN 1 ELSE 0 END) AS holiday_days, COUNT(DISTINCT ws.web_site_sk) AS unique_web_sites FROM date_dim dd JOIN catalog_page cp ON dd.d_date_sk BETWEEN cp.cp_start_date_sk AND cp.cp_end_date_sk JOIN web_site ws ON ws.web_open_date_sk <= dd.d_date_sk AND (ws.web_close_date_sk IS NULL OR ws.web_close_date_sk >= dd.d_date_sk) WHERE dd.d_current_month = 'N' AND cp.cp_department = 'DEPARTMENT' AND ws.web_manager IN ('Dwight Aaron', 'Jimmy Pope', 'James Austin', 'Harold Wilson', 'Marshall Conner', 'Charles Castillo') GROUP BY year, month, month_sequence, department ORDER BY year, month_sequence, department;
SELECT i_category, i_brand, COUNT(DISTINCT i_item_sk) AS total_items, SUM(i_current_price) AS total_sales_value, AVG(i_wholesale_cost) AS average_wholesale_cost FROM item WHERE i_units IN ('Dozen', 'Bundle', 'Lb') AND i_manufact IN ('eseantieing', 'ableablepri') GROUP BY i_category, i_brand ORDER BY total_sales_value DESC LIMIT 100;
SELECT t_shift, EXTRACT(YEAR FROM TO_TIMESTAMP(t_time_id, 'YYYYMMDDHH24MISS')) AS sale_year, SUM(cs_quantity) AS total_quantity_sold, AVG(cs_sales_price) AS average_sales_price, COUNT(DISTINCT cs_order_number) AS number_of_orders, SUM(ws_quantity) AS total_quantity_web_sold, AVG(ws_sales_price) AS average_web_sales_price, COUNT(DISTINCT ws_order_number) AS number_of_web_orders, SUM(wr_return_quantity) AS total_quantity_returned, AVG(wr_return_amt) AS average_return_amount, COUNT(DISTINCT wr_order_number) AS number_of_returns, (SUM(cs_net_profit) + SUM(ws_net_profit) - SUM(wr_net_loss)) AS total_net_profit FROM catalog_sales JOIN time_dim ON cs_sold_time_sk = t_time_sk JOIN web_sales ON cs_order_number = ws_order_number AND cs_item_sk = ws_item_sk JOIN web_returns ON cs_order_number = wr_order_number AND cs_item_sk = wr_item_sk WHERE t_time IN ('2095', '1273', '731', '4867', '571', '4658') AND t_time_id IN ('AAAAAAAACEEAAAAA', 'AAAAAAAAJGMAAAAA', 'AAAAAAAABJLAAAAA', 'AAAAAAAAFHIAAAAA', 'AAAAAAAAFOLAAAAA') GROUP BY t_shift, sale_year ORDER BY sale_year, t_shift;
SELECT c.c_customer_id, c.c_first_name, c.c_last_name, SUM(ss.ss_net_paid) AS total_sales, AVG(ss.ss_net_profit) AS avg_profit, COUNT(DISTINCT ss.ss_ticket_number) AS num_of_sales, SUM(sr.sr_net_loss) AS total_returns_loss, COUNT(DISTINCT sr.sr_ticket_number) AS num_of_returns, SUM(CASE WHEN sr.sr_refunded_cash > 0 THEN 1 ELSE 0 END) AS num_of_cash_refunds FROM customer c LEFT JOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk LEFT JOIN store_returns sr ON c.c_customer_sk = sr.sr_customer_sk GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name HAVING SUM(ss.ss_net_paid) > 0 OR SUM(sr.sr_net_loss) > 0 ORDER BY total_sales DESC, total_returns_loss DESC;
SELECT dd.d_year AS year, h.hd_income_band_sk AS income_band, r.r_reason_desc AS return_reason, SUM(ss.ss_net_paid) AS total_sales, COUNT(DISTINCT ss.ss_ticket_number) AS total_sales_transactions, AVG(ss.ss_quantity) AS average_quantity_sold, SUM(cr.cr_return_amount) AS total_returns, COUNT(DISTINCT cr.cr_order_number) AS total_return_transactions, AVG(cr.cr_return_quantity) AS average_quantity_returned FROM date_dim dd LEFT JOIN store_sales ss ON dd.d_date_sk = ss.ss_sold_date_sk LEFT JOIN catalog_returns cr ON dd.d_date_sk = cr.cr_returned_date_sk LEFT JOIN reason r ON cr.cr_reason_sk = r.r_reason_sk LEFT JOIN household_demographics h ON ss.ss_hdemo_sk = h.hd_demo_sk WHERE dd.d_year IS NOT NULL AND (r.r_reason_id IN ('AAAAAAAANAAAAAAA', 'AAAAAAAALBAAAAAA', 'AAAAAAAALAAAAAAA', 'AAAAAAAADAAAAAAA', 'AAAAAAAAJBAAAAAA') OR r.r_reason_id IS NULL) GROUP BY year, income_band, return_reason ORDER BY year, income_band, total_sales DESC;
SELECT d_year, d_quarter_name, sum(cs_net_profit) AS total_net_profit, avg(cs_sales_price) AS avg_sales_price, count(DISTINCT cs_order_number) AS order_count FROM catalog_sales JOIN date_dim ON (cs_sold_date_sk = d_date_sk) JOIN customer ON (cs_bill_customer_sk = c_customer_sk) JOIN web_site ON (web_open_date_sk = d_date_sk) JOIN income_band ON (c_current_hdemo_sk = ib_income_band_sk) WHERE d_year = 2002 AND ib_upper_bound <= 60000 AND ib_lower_bound >= 80001 AND c_birth_month IN (6, 9) AND cs_wholesale_cost BETWEEN 65.53 AND 87.24 AND web_rec_start_date BETWEEN '1999-08-17' AND '2000-08-16' GROUP BY d_year, d_quarter_name ORDER BY d_year, d_quarter_name;
SELECT s.s_division_name, cc.cc_class, dd.d_year, COUNT(DISTINCT s.s_store_sk) AS num_stores, SUM(ss.ss_net_paid) AS total_sales, AVG(ss.ss_net_paid) AS average_sales_per_store, MAX(ss.ss_net_paid) AS max_sales_per_store, MIN(ss.ss_net_paid) AS min_sales_per_store FROM store_sales ss INNER JOIN store s ON ss.ss_store_sk = s.s_store_sk INNER JOIN date_dim dd ON ss.ss_sold_date_sk = dd.d_date_sk INNER JOIN call_center cc ON s.s_market_id = cc.cc_mkt_id WHERE cc.cc_class IN ('small', 'medium', 'large') AND dd.d_year = 2022 GROUP BY s.s_division_name, cc.cc_class, dd.d_year ORDER BY s.s_division_name, cc.cc_class, total_sales DESC;
SELECT cp.cp_department, i.i_category, w.w_state, SUM(cr.cr_return_quantity) AS total_returned_quantity, AVG(cr.cr_return_amount) AS avg_return_amount, SUM(cr.cr_return_amount) AS total_return_amount, COUNT(DISTINCT cr.cr_returned_date_sk) AS count_return_days, SUM(inv.inv_quantity_on_hand) AS total_inventory, AVG(i.i_wholesale_cost) AS avg_wholesale_cost, AVG(i.i_current_price) AS avg_current_price, SUM(sr.sr_return_amt) AS total_store_return_amount, AVG(sr.sr_return_amt) AS avg_store_return_amount, COUNT(DISTINCT sr.sr_customer_sk) AS count_distinct_customers_returning FROM catalog_page cp JOIN catalog_returns cr ON cp.cp_catalog_page_sk = cr.cr_catalog_page_sk JOIN item i ON cr.cr_item_sk = i.i_item_sk JOIN warehouse w ON cr.cr_warehouse_sk = w.w_warehouse_sk JOIN inventory inv ON i.i_item_sk = inv.inv_item_sk AND w.w_warehouse_sk = inv.inv_warehouse_sk LEFT JOIN store_returns sr ON i.i_item_sk = sr.sr_item_sk WHERE cp.cp_department = 'DEPARTMENT' AND w.w_state = 'TN' AND (i.i_product_name = 'prin st' OR i.i_product_name = 'eingprin stable') GROUP BY cp.cp_department, i.i_category, w.w_state ORDER BY total_returned_quantity DESC, avg_return_amount DESC;
SELECT s.s_state, w.w_country, p.p_promo_name, SUM(ss.ss_quantity) AS total_quantity_sold, AVG(ss.ss_sales_price) AS average_sales_price, COUNT(DISTINCT ss.ss_ticket_number) AS number_of_sales_transactions, SUM(ss.ss_net_paid) AS total_net_paid, SUM(ss.ss_net_profit) AS total_net_profit FROM store_sales ss JOIN store s ON ss.ss_store_sk = s.s_store_sk JOIN warehouse w ON s.s_state = w.w_state LEFT JOIN promotion p ON ss.ss_promo_sk = p.p_promo_sk AND p.p_channel_catalog = 'N' GROUP BY s.s_state, w.w_country, p.p_promo_name ORDER BY s.s_state, w.w_country, p.p_promo_name;
SELECT cc.cc_city AS call_center_city, cc.cc_state AS call_center_state, SUM(ws.ws_quantity) AS total_quantity_sold, AVG(ws.ws_sales_price) AS average_sales_price, COUNT(DISTINCT ws.ws_order_number) AS number_of_orders, SUM(inv.inv_quantity_on_hand) AS total_inventory_on_hand, SUM(ws.ws_net_profit) AS total_net_profit FROM call_center cc JOIN web_sales ws ON cc.cc_call_center_sk = ws.ws_warehouse_sk JOIN inventory inv ON ws.ws_item_sk = inv.inv_item_sk AND ws.ws_sold_date_sk = inv.inv_date_sk JOIN time_dim td ON ws.ws_sold_time_sk = td.t_time_sk WHERE cc.cc_mkt_id IN ('6', '2', '5') AND cc.cc_suite_number IN ('Suite 70', 'Suite 0', 'Suite U') AND inv.inv_quantity_on_hand IN (645, 327) AND td.t_time_sk IN (247, 1615, 1813, 4029, 3389) AND td.t_hour = 1 GROUP BY call_center_city, call_center_state ORDER BY total_net_profit DESC, call_center_city, call_center_state;
SELECT c.cc_name, c.cc_state, AVG(s.s_number_employees) as avg_store_employees, SUM(sr.sr_return_amt) as total_return_amount, SUM(sr.sr_return_quantity) as total_returned_quantity, COUNT(DISTINCT hd.hd_demo_sk) as unique_household_count, AVG(cd.cd_purchase_estimate) as avg_purchase_estimate FROM call_center c JOIN store s ON c.cc_state = s.s_state AND c.cc_mkt_id = s.s_market_id JOIN store_returns sr ON s.s_store_sk = sr.sr_store_sk JOIN customer_demographics cd ON sr.sr_cdemo_sk = cd.cd_demo_sk JOIN household_demographics hd ON sr.sr_hdemo_sk = hd.hd_demo_sk WHERE c.cc_class = 'small' AND cd.cd_purchase_estimate > 5000 AND hd.hd_income_band_sk IS NOT NULL AND sr.sr_return_ship_cost > 100 AND sr.sr_returned_date_sk IS NOT NULL GROUP BY c.cc_name, c.cc_state ORDER BY total_return_amount DESC, avg_store_employees DESC, unique_household_count DESC;
SELECT cc_state, i_category, SUM(cs_quantity) AS total_quantity, AVG(cs_sales_price) AS avg_sales_price, COUNT(DISTINCT cs_order_number) AS unique_orders, SUM(ss_net_profit) AS total_store_profit, AVG(ss_wholesale_cost) AS avg_store_wholesale_cost, COUNT(DISTINCT ss_ticket_number) AS unique_store_tickets, SUM(inv_quantity_on_hand) AS total_inventory, COUNT(DISTINCT p_promo_sk) AS distinct_promotions FROM call_center JOIN catalog_sales ON cc_call_center_sk = cs_call_center_sk JOIN item ON cs_item_sk = i_item_sk JOIN store_sales ON ss_item_sk = i_item_sk JOIN inventory ON inv_item_sk = i_item_sk JOIN promotion ON (cs_promo_sk = p_promo_sk OR ss_promo_sk = p_promo_sk) JOIN store ON ss_store_sk = s_store_sk WHERE cc_mkt_id IN ('6', '2', '5') AND cc_state = 'TN' AND inv_item_sk IN ('15746', '11656', '6211', '11858') AND i_item_sk IN ('2579', '2638', '2347', '3924', '3976', '4905') AND s_store_sk IN ('8', '11', '6') GROUP BY cc_state, i_category;
SELECT d_year, cd_gender, cd_marital_status, cd_education_status, sm_type, COUNT(DISTINCT cs_order_number) AS total_orders, SUM(cs_quantity) AS total_items_sold, AVG(cs_sales_price) AS avg_sales_price, SUM(cs_net_paid) AS total_net_paid, SUM(cs_net_paid_inc_tax) AS total_net_paid_inc_tax, SUM(cs_net_paid_inc_ship) AS total_net_paid_inc_ship, SUM(cs_net_paid_inc_ship_tax) AS total_net_paid_inc_ship_tax, SUM(cs_net_profit) AS total_net_profit FROM catalog_sales JOIN customer_demographics ON cs_bill_cdemo_sk = cd_demo_sk JOIN date_dim ON cs_sold_date_sk = d_date_sk JOIN ship_mode ON cs_ship_mode_sk = sm_ship_mode_sk WHERE d_year = 2003 AND cd_dep_count BETWEEN 1 AND 2 AND cd_purchase_estimate IN (3000, 6000, 8000, 7000) AND sm_ship_mode_id IN ('AAAAAAAABBAAAAAA', 'AAAAAAAAOAAAAAAA', 'AAAAAAAAFAAAAAAA', 'AAAAAAAAJAAAAAAA') AND sm_contract IN ('GNJr3g5i7oorKqtX', 'O9V6oF8RJnLMmZYd1', 'UaAJjKDnL4gTOqbpj') AND cs_net_paid_inc_tax IN ('3193.96', '1181.18', '1413.67') GROUP BY ROLLUP(d_year, cd_gender, cd_marital_status, cd_education_status, sm_type) ORDER BY d_year, cd_gender, cd_marital_status, cd_education_status, sm_type;
SELECT s.s_division_id AS store_division_id, s.s_division_name AS store_division_name, hd.hd_income_band_sk AS household_income_band, COUNT(DISTINCT ws.ws_order_number) AS total_web_sales, AVG(ws.ws_sales_price) AS average_sales_price, COUNT(DISTINCT sr.sr_ticket_number) AS total_store_returns, AVG(sr.sr_return_amt) AS average_return_amount FROM store s LEFT JOIN web_sales ws ON s.s_store_sk = ws.ws_ship_customer_sk LEFT JOIN store_returns sr ON s.s_store_sk = sr.sr_store_sk LEFT JOIN household_demographics hd ON (ws.ws_ship_hdemo_sk = hd.hd_demo_sk OR sr.sr_hdemo_sk = hd.hd_demo_sk) WHERE ws.ws_order_number IS NOT NULL OR sr.sr_ticket_number IS NOT NULL GROUP BY s.s_division_id, s.s_division_name, hd.hd_income_band_sk ORDER BY s.s_division_id, hd.hd_income_band_sk;
SELECT c.cp_department AS department, i.i_category AS category, COUNT(DISTINCT c.cp_catalog_page_sk) AS num_catalog_pages, COUNT(DISTINCT i.i_item_sk) AS num_items, AVG(i.i_current_price) AS avg_current_price, SUM(i.i_wholesale_cost * i.i_units::int) AS total_wholesale_cost, w.web_name AS website_name, COUNT(DISTINCT w.web_site_sk) AS num_websites, AVG(w.web_tax_percentage) AS avg_tax_percentage FROM catalog_page c JOIN item i ON c.cp_catalog_page_sk = i.i_item_sk JOIN web_site w ON c.cp_department = w.web_class WHERE i.i_category IN ('Shoes', 'Home') AND i.i_rec_start_date <= CURRENT_DATE AND (i.i_rec_end_date IS NULL OR i.i_rec_end_date > CURRENT_DATE) AND w.web_rec_start_date <= CURRENT_DATE AND (w.web_rec_end_date IS NULL OR w.web_rec_end_date > CURRENT_DATE) GROUP BY c.cp_department, i.i_category, w.web_name ORDER BY department, category, website_name;
SELECT hd.hd_income_band_sk, COUNT(DISTINCT ss.ss_customer_sk) AS num_customers, SUM(ss.ss_quantity) AS total_quantity_sold, AVG(ss.ss_sales_price) AS avg_sales_price, SUM(ss.ss_net_paid) AS total_net_paid, SUM(ss.ss_net_profit) AS total_net_profit FROM store_sales ss JOIN household_demographics hd ON ss.ss_hdemo_sk = hd.hd_demo_sk JOIN income_band ib ON hd.hd_income_band_sk = ib.ib_income_band_sk JOIN promotion p ON ss.ss_promo_sk = p.p_promo_sk JOIN time_dim t ON ss.ss_sold_time_sk = t.t_time_sk WHERE hd.hd_income_band_sk IN (18, 2) AND t.t_hour BETWEEN 8 AND 17 GROUP BY hd.hd_income_band_sk ORDER BY total_net_profit DESC;
SELECT r.r_reason_desc, COUNT(DISTINCT sr.sr_ticket_number) AS num_store_returns, SUM(sr.sr_refunded_cash) AS total_store_refunded, AVG(sr.sr_return_amt_inc_tax) AS avg_store_return, COUNT(DISTINCT cr.cr_order_number) AS num_catalog_returns, SUM(cr.cr_refunded_cash) AS total_catalog_refunded, AVG(cr.cr_return_amt_inc_tax) AS avg_catalog_return FROM store_returns sr FULL OUTER JOIN catalog_returns cr ON sr.sr_reason_sk = cr.cr_reason_sk JOIN reason r ON r.r_reason_sk = sr.sr_reason_sk OR r.r_reason_sk = cr.cr_reason_sk LEFT JOIN warehouse w ON cr.cr_warehouse_sk = w.w_warehouse_sk WHERE (sr.sr_customer_sk IN (67809, 3762, 6067) OR cr.cr_returning_hdemo_sk IN (6684, 3972, 3528, 1943, 4100, 4193)) AND (r.r_reason_id IN ('AAAAAAAANBAAAAAA', 'AAAAAAAADCAAAAAA', 'AAAAAAAAACAAAAAA', 'AAAAAAAAIAAAAAAA', 'AAAAAAAAFBAAAAAA', 'AAAAAAAAOBAAAAAA')) AND w.w_street_number = '651' AND w.w_county = 'Williamson County' GROUP BY r.r_reason_desc ORDER BY total_store_refunded DESC, total_catalog_refunded DESC;
SELECT cc.cc_name, cc.cc_manager, c.cd_education_status, SUM(ss.ss_quantity) AS total_quantity_sold, AVG(ss.ss_sales_price) AS average_sales_price, COUNT(DISTINCT ss.ss_ticket_number) AS number_of_sales_transactions, COUNT(DISTINCT c.cd_demo_sk) AS number_of_unique_customers FROM store_sales ss JOIN call_center cc ON ss.ss_store_sk = cc.cc_call_center_sk JOIN customer_demographics c ON ss.ss_cdemo_sk = c.cd_demo_sk JOIN time_dim t ON ss.ss_sold_time_sk = t.t_time_sk JOIN catalog_page cp ON ss.ss_promo_sk = cp.cp_catalog_page_sk WHERE cc.cc_manager IN ('Larry Mccray', 'Felipe Perkins') AND cp.cp_type IN ('bi-annual', 'monthly', 'quarterly') AND t.t_hour BETWEEN 0 AND 1 AND c.cd_dep_college_count = 0 AND ss.ss_sold_date_sk IS NOT NULL GROUP BY cc.cc_name, cc.cc_manager, c.cd_education_status ORDER BY total_quantity_sold DESC, average_sales_price DESC;
SELECT w.web_name, w.web_manager, SUM(i.i_current_price) AS total_current_price, AVG(i.i_wholesale_cost) AS average_wholesale_cost, COUNT(i.i_item_sk) AS item_count, SM.sm_type, MAX(i.i_current_price) AS max_price, MIN(i.i_current_price) AS min_price FROM web_site AS w JOIN item AS i ON w.web_site_sk = i.i_manufact_id JOIN ship_mode AS SM ON SM.sm_ship_mode_sk = i.i_item_sk WHERE i.i_rec_start_date <= CURRENT_DATE AND (i.i_rec_end_date IS NULL OR i.i_rec_end_date > CURRENT_DATE) AND SM.sm_type IN ('EXPRESS', 'OVERNIGHT', 'REGULAR') AND i.i_current_price IN (5.40, 8.89) GROUP BY w.web_name, w.web_manager, SM.sm_type ORDER BY total_current_price DESC, item_count DESC;
SELECT c.c_customer_id AS customer_id, cd.cd_gender AS customer_gender, cd.cd_education_status AS customer_education_status, cd.cd_credit_rating AS customer_credit_rating, cd.cd_purchase_estimate AS estimated_purchase, SUM(cd.cd_dep_college_count) AS total_college_dependents, hd.hd_income_band_sk AS household_income_band, hd.hd_buy_potential AS household_buying_potential, COUNT(DISTINCT ws.web_site_id) AS number_of_websites_visited, AVG(ws.web_tax_percentage) AS average_tax_percentage FROM customer c JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk JOIN time_dim t ON c.c_first_shipto_date_sk = t.t_time_sk JOIN web_site ws ON c.c_current_addr_sk = ws.web_site_sk WHERE cd.cd_credit_rating = 'High' AND cd.cd_dep_college_count = 0 AND hd.hd_income_band_sk IN (10, 6, 17, 13, 15) AND hd.hd_buy_potential = '501-1000' AND t.t_sub_shift = 'night' AND t.t_minute IN (0, 30, 40) AND ws.web_gmt_offset = -5.00 AND ws.web_zip = '35709' GROUP BY c.c_customer_id, cd.cd_gender, cd.cd_education_status, cd.cd_credit_rating, cd.cd_purchase_estimate, hd.hd_income_band_sk, hd.hd_buy_potential ORDER BY estimated_purchase DESC, total_college_dependents DESC, household_income_band;
