SELECT cc.cc_name, cc.cc_city, cc.cc_state, SUM(cr.cr_return_amount) AS total_return_amount, AVG(cr.cr_return_amount) AS avg_return_amount, COUNT(cr.cr_order_number) AS total_returns, SUM(cr.cr_return_quantity) AS total_returned_items, COUNT(DISTINCT cr.cr_returning_customer_sk) AS unique_returning_customers, SUM(case when hd.hd_dep_count IS NOT NULL THEN 1 ELSE 0 END) AS returns_with_dep_count, SUM(case when hd.hd_vehicle_count IS NOT NULL THEN 1 ELSE 0 END) AS returns_with_vehicle_count, COUNT(DISTINCT p.p_promo_sk) AS total_promotions_involved, SUM(p.p_cost) AS total_promotion_cost FROM call_center cc LEFT JOIN catalog_returns cr ON cc.cc_call_center_sk = cr.cr_call_center_sk LEFT JOIN household_demographics hd ON cr.cr_returning_hdemo_sk = hd.hd_demo_sk LEFT JOIN promotion p ON p.p_item_sk = cr.cr_item_sk WHERE cc.cc_company_name IN ('able', 'ought', 'cally', 'pri') AND cc.cc_hours IN ('8AM-4PM', '8AM-8AM') AND p.p_channel_tv = 'N' AND p.p_purpose = 'Unknown' AND cr.cr_refunded_cash IN ('5415.08', '1.89', '288.51', '2.49', '307.01') GROUP BY cc.cc_name, cc.cc_city, cc.cc_state ORDER BY total_return_amount DESC;
SELECT sm.sm_type AS shipping_type, i.i_category AS item_category, COUNT(cr.cr_order_number) AS total_returns, SUM(cr.cr_return_amount) AS total_refunded_amount, AVG(cr.cr_return_amount) AS average_refund_amount FROM catalog_returns cr JOIN ship_mode sm ON cr.cr_ship_mode_sk = sm.sm_ship_mode_sk JOIN item i ON cr.cr_item_sk = i.i_item_sk WHERE cr.cr_returned_date_sk IS NOT NULL AND sm.sm_type IN ('NEXT DAY', 'TWO DAY', 'EXPRESS') AND i.i_category IN ('Electronics', 'Clothing', 'Furniture') GROUP BY sm.sm_type, i.i_category ORDER BY total_refunded_amount DESC, total_returns DESC, average_refund_amount DESC;
SELECT d.d_year, SUM(ss_net_profit) AS total_profit, COUNT(DISTINCT ss_item_sk) AS items_sold, COUNT(DISTINCT ss_ticket_number) AS total_sales_transactions, AVG(ss_net_paid_inc_tax) AS avg_sales_with_tax, w.w_state, w.w_city, COUNT(DISTINCT sr_ticket_number) AS total_return_transactions, SUM(sr_return_amt_inc_tax) AS total_returns_with_tax, AVG(sr_fee) AS avg_return_fee FROM store_sales ss LEFT JOIN store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk JOIN warehouse w ON ss.ss_store_sk = w.w_warehouse_sk WHERE d.d_year = 2002 AND ss.ss_store_sk IN (10, 7, 4, 1) AND sr.sr_returned_date_sk IN ('2451033', '2451972') AND w.w_city = 'Midway' GROUP BY d.d_year, w.w_state, w.w_city ORDER BY total_profit DESC;
SELECT cp.cp_department, dd.d_year, SUM(cr.cr_return_amt_inc_tax) AS total_return_amount, AVG(cr.cr_return_quantity) AS avg_return_quantity, COUNT(cr.cr_order_number) AS total_returned_orders FROM catalog_returns cr JOIN catalog_page cp ON cr.cr_catalog_page_sk = cp.cp_catalog_page_sk JOIN date_dim dd ON cr.cr_returned_date_sk = dd.d_date_sk JOIN household_demographics hd ON cr.cr_returning_cdemo_sk = hd.hd_demo_sk WHERE cp.cp_type = 'monthly' AND hd.hd_buy_potential = 'Unknown' GROUP BY cp.cp_department, dd.d_year ORDER BY total_return_amount DESC, cp.cp_department, dd.d_year;
SELECT i.i_category, COUNT(DISTINCT cs.cs_order_number) AS total_catalog_orders, COUNT(DISTINCT ws.ws_order_number) AS total_web_orders, AVG(cs.cs_sales_price) AS avg_catalog_sales_price, AVG(ws.ws_sales_price) AS avg_web_sales_price, SUM(cs.cs_net_profit) AS total_catalog_net_profit, SUM(ws.ws_net_profit) AS total_web_net_profit, SUM(CASE WHEN cs.cs_promo_sk IS NOT NULL THEN 1 ELSE 0 END) AS promo_catalog_sales, SUM(CASE WHEN ws.ws_promo_sk IS NOT NULL THEN 1 ELSE 0 END) AS promo_web_sales, COUNT(DISTINCT d.d_date_sk) AS days_in_Q4 FROM item i LEFT JOIN catalog_sales cs ON i.i_item_sk = cs.cs_item_sk LEFT JOIN web_sales ws ON i.i_item_sk = ws.ws_item_sk LEFT JOIN date_dim d ON (cs.cs_sold_date_sk = d.d_date_sk OR ws.ws_sold_date_sk = d.d_date_sk) WHERE d.d_quarter_name = 'Q4' GROUP BY i.i_category ORDER BY total_catalog_net_profit DESC, total_web_net_profit DESC;
SELECT cc.cc_name AS call_center_name, st.s_store_name AS store_name, st.s_state AS store_state, ws.web_name AS website_name, p.p_promo_name AS promotion_name, p.p_channel_details AS promotion_channel_details, SUM(ss.ss_quantity) AS total_quantity_sold, AVG(ss.ss_sales_price) AS average_sales_price, SUM(ss.ss_net_paid) AS total_net_sales, SUM(ss.ss_net_profit) AS total_net_profit FROM call_center cc JOIN store_sales ss ON cc.cc_call_center_sk = ss.ss_store_sk JOIN store st ON ss.ss_store_sk = st.s_store_sk JOIN web_site ws ON st.s_market_id = ws.web_mkt_id JOIN promotion p ON ss.ss_promo_sk = p.p_promo_sk WHERE cc.cc_manager IN ('Mark Hightower', 'Felipe Perkins', 'Bob Belcher') AND cc.cc_call_center_id = 'AAAAAAAAEAAAAAAA' AND st.s_market_id IN (4, 6, 7, 2, 8, 10) AND st.s_country = 'United States' AND p.p_start_date_sk IN (2450694, 2450318, 2450696, 2450508, 2450764, 2450750) AND ss.ss_customer_sk IN (169, 28519, 57009, 32392) GROUP BY call_center_name, store_name, store_state, website_name, promotion_name, promotion_channel_details ORDER BY total_net_sales DESC;
SELECT wp_type, COUNT(DISTINCT wp_web_page_sk) AS num_web_pages, COUNT(DISTINCT wr_order_number) AS num_returns, SUM(wr_return_amt) AS total_return_amt, AVG(wr_fee) AS avg_return_fee, COUNT(DISTINCT ss_ticket_number) AS num_sales, SUM(ss_net_paid) AS total_sales_net_paid, AVG(ss_quantity) AS avg_quantity_sold, AVG(ss_net_profit) AS avg_net_profit_per_sale FROM web_page JOIN web_returns ON wp_web_page_sk = wr_web_page_sk JOIN store_sales ON wp_web_page_sk = ss_item_sk AND wr_item_sk = ss_item_sk WHERE wp_autogen_flag = 'Y' AND wr_refunded_hdemo_sk IN ('6339', '6945', '3736', '1127', '5965') AND wr_returning_addr_sk IN ('5470', '35039', '13547', '10964') AND ss_sold_time_sk IN ('51540', '75570', '63103', '51775', '61813', '66204') AND wr_reason_sk = '21' GROUP BY wp_type ORDER BY total_return_amt DESC, num_sales DESC;
SELECT i.i_category, SUM(ss.ss_quantity) AS total_quantity_sold, AVG(ss.ss_sales_price) AS average_sales_price, COUNT(DISTINCT ss.ss_customer_sk) AS unique_customers, SUM(wr.wr_return_quantity) AS total_quantity_returned, SUM(wr.wr_return_amt) AS total_return_amount, AVG(inv.inv_quantity_on_hand) AS average_inventory_on_hand FROM item i LEFT JOIN store_sales ss ON ss.ss_item_sk = i.i_item_sk LEFT JOIN web_returns wr ON wr.wr_item_sk = i.i_item_sk LEFT JOIN inventory inv ON inv.inv_item_sk = i.i_item_sk WHERE i.i_category IN ('Electronics', 'Clothing', 'Furniture') AND ss.ss_sold_date_sk BETWEEN 2451453 AND 2451553 AND wr.wr_returned_date_sk BETWEEN 2451453 AND 2451553 AND inv.inv_date_sk BETWEEN 2451453 AND 2451553 GROUP BY i.i_category ORDER BY total_quantity_sold DESC;
SELECT c.c_birth_year, c.c_birth_country, c.c_preferred_cust_flag, s.s_store_id, s.s_store_name, s.s_city, s.s_state, s.s_market_desc, COUNT(ws.ws_order_number) AS total_orders, SUM(ws.ws_quantity) AS total_quantity_sold, AVG(ws.ws_sales_price) AS average_sales_price, SUM(ws.ws_net_paid) AS total_net_paid, SUM(ws.ws_net_paid_inc_tax) AS total_net_paid_inc_tax, SUM(ws.ws_net_profit) AS total_net_profit FROM web_sales ws INNER JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk INNER JOIN store s ON ws.ws_ship_addr_sk = s.s_store_sk GROUP BY c.c_birth_year, c.c_birth_country, c.c_preferred_cust_flag, s.s_store_id, s.s_store_name, s.s_city, s.s_state, s.s_market_desc ORDER BY total_net_paid DESC, s.s_state, c.c_birth_year;
SELECT r_reason_desc, SUM(cr_return_amount) AS total_return_amount, AVG(cr_return_amount) AS avg_return_amount, COUNT(*) AS return_count, SUM(cs_net_profit) AS total_sales_net_profit, AVG(cs_net_profit) AS avg_sales_net_profit, COUNT(DISTINCT cs_order_number) AS sales_order_count, SUM(ws_net_profit) AS total_web_net_profit, AVG(ws_net_profit) AS avg_web_net_profit, COUNT(DISTINCT ws_order_number) AS web_order_count FROM catalog_returns JOIN reason ON catalog_returns.cr_reason_sk = reason.r_reason_sk LEFT JOIN catalog_sales ON catalog_returns.cr_item_sk = catalog_sales.cs_item_sk AND catalog_returns.cr_order_number = catalog_sales.cs_order_number LEFT JOIN web_sales ON catalog_returns.cr_item_sk = web_sales.ws_item_sk AND catalog_returns.cr_order_number = web_sales.ws_order_number WHERE catalog_returns.cr_returned_date_sk BETWEEN 2451276 AND 2451276 + 30 AND catalog_returns.cr_return_tax BETWEEN 0 AND 200 AND (catalog_sales.cs_ship_cdemo_sk = 568017 OR web_sales.ws_sold_date_sk = 2451276) AND (catalog_sales.cs_promo_sk IN (253, 289, 228) OR web_sales.ws_promo_sk IN (253, 289, 228)) AND reason.r_reason_id IN ('AAAAAAAAIBAAAAAA', 'AAAAAAAABCAAAAAA', 'AAAAAAAAOBAAAAAA', 'AAAAAAAAMAAAAAAA') GROUP BY r_reason_desc ORDER BY total_return_amount DESC, total_sales_net_profit DESC, total_web_net_profit DESC;
SELECT ca_country, sm_type, COUNT(*) AS shipment_count, AVG(ca_gmt_offset) AS avg_gmt_offset, SUM(CASE WHEN r_reason_sk IN (28, 20, 15, 23, 17) THEN 1 ELSE 0 END) AS high_priority_reason_count FROM customer_address JOIN ship_mode ON ca_address_sk = sm_ship_mode_sk LEFT JOIN reason ON r_reason_sk = ca_address_sk WHERE ca_country = 'United States' AND r_reason_id IN ('AAAAAAAALBAAAAAA', 'AAAAAAAAPAAAAAAA', 'AAAAAAAAKAAAAAAA') AND ca_address_id IN ('AAAAAAAALPBAAAAA', 'AAAAAAAAJIMAAAAA') GROUP BY ca_country, sm_type ORDER BY shipment_count DESC, avg_gmt_offset;
SELECT cc_division_name, cc_market_manager, SUM(ws_net_profit) AS total_profit, AVG(ws_quantity) AS average_quantity_sold, COUNT(DISTINCT ws_order_number) AS total_orders, SUM(wr_net_loss) AS total_net_loss, COUNT(DISTINCT wr_order_number) AS total_returns FROM call_center JOIN web_sales ON cc_call_center_sk = ws_warehouse_sk JOIN web_returns ON ws_order_number = wr_order_number WHERE ws_sold_date_sk BETWEEN 2000 AND 3000 AND ws_ship_mode_sk IN (1, 2) AND wr_reason_sk IN (12, 35, 30, 1, 29) AND cc_market_manager IN ('Julius Durham', 'Matthew Clifton', 'Gary Colburn', 'Julius Tran') GROUP BY cc_division_name, cc_market_manager ORDER BY total_profit DESC, total_net_loss ASC;
SELECT d_year, d_moy, c.c_last_name, cd.cd_education_status, cd.cd_marital_status, COUNT(*) AS customer_count, SUM(cd.cd_purchase_estimate) AS total_purchase_estimate, AVG(cd.cd_dep_count) AS average_dependents, AVG(cd.cd_dep_employed_count) AS average_employed_dependents, AVG(cd.cd_dep_college_count) AS average_college_dependents FROM customer c JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk JOIN date_dim d ON c.c_first_sales_date_sk = d.d_date_sk WHERE c.c_first_sales_date_sk IN (2449879, 2452004, 2451328, 2452389, 2450342, 2449052) AND c.c_last_name IN ('Searcy', 'Joyner', 'Livingston', 'Wise', 'Webb', 'Branch') AND cd.cd_marital_status IN ('S', 'U', 'W', 'M') AND cd.cd_education_status = 'Advanced Degree' AND d.d_last_dom IN ('2417090', '2415990') GROUP BY d_year, d_moy, c.c_last_name, cd.cd_education_status, cd.cd_marital_status ORDER BY d_year DESC, d_moy DESC, c.c_last_name;
SELECT d_year, cd_gender, cd_marital_status, cd_education_status, sm_type, COUNT(DISTINCT cs_order_number) AS total_orders, SUM(cs_quantity) AS total_items_sold, AVG(cs_sales_price) AS avg_sales_price, SUM(cs_net_paid) AS total_net_paid, SUM(cs_net_paid_inc_tax) AS total_net_paid_inc_tax, SUM(cs_net_paid_inc_ship) AS total_net_paid_inc_ship, SUM(cs_net_paid_inc_ship_tax) AS total_net_paid_inc_ship_tax, SUM(cs_net_profit) AS total_net_profit FROM catalog_sales JOIN customer_demographics ON cs_bill_cdemo_sk = cd_demo_sk JOIN date_dim ON cs_sold_date_sk = d_date_sk JOIN ship_mode ON cs_ship_mode_sk = sm_ship_mode_sk WHERE d_year = 2003 AND cd_dep_count BETWEEN 1 AND 2 AND cd_purchase_estimate IN (3000, 6000, 8000, 7000) AND sm_ship_mode_id IN ('AAAAAAAABBAAAAAA', 'AAAAAAAAOAAAAAAA', 'AAAAAAAAFAAAAAAA', 'AAAAAAAAJAAAAAAA') AND sm_contract IN ('GNJr3g5i7oorKqtX', 'O9V6oF8RJnLMmZYd1', 'UaAJjKDnL4gTOqbpj') AND cs_net_paid_inc_tax IN ('3193.96', '1181.18', '1413.67') GROUP BY ROLLUP(d_year, cd_gender, cd_marital_status, cd_education_status, sm_type) ORDER BY d_year, cd_gender, cd_marital_status, cd_education_status, sm_type;
SELECT dd.d_dow AS day_of_week, cd.cd_gender AS gender, cd.cd_marital_status AS marital_status, AVG(cd.cd_purchase_estimate) AS avg_purchase_estimate, AVG(CASE WHEN cd.cd_credit_rating = 'Good' THEN 1 WHEN cd.cd_credit_rating = 'Bad' THEN 0 ELSE NULL END) AS avg_credit_good, COUNT(*) AS customer_count FROM customer c JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk JOIN date_dim dd ON c.c_first_sales_date_sk = dd.d_date_sk WHERE dd.d_dow = '6' AND cd.cd_dep_count = '2' AND cd.cd_marital_status IN ('M', 'U') AND c.c_first_shipto_date_sk = 2451880 GROUP BY dd.d_dow, cd.cd_gender, cd.cd_marital_status ORDER BY cd.cd_gender, cd.cd_marital_status, avg_purchase_estimate DESC;
