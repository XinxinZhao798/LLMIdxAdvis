SELECT s.s_store_name, COUNT(DISTINCT ws.ws_order_number) AS total_orders, SUM(ws.ws_quantity) AS total_quantity_sold, AVG(ws.ws_sales_price) AS average_sales_price, SUM(ws.ws_net_paid) AS total_net_paid, SUM(ws.ws_net_profit) AS total_net_profit, AVG(cd.cd_purchase_estimate) AS average_customer_purchase_estimate, COUNT(DISTINCT c.c_customer_sk) AS unique_customers, cd.cd_gender, cd.cd_marital_status, cd.cd_education_status FROM store s JOIN web_sales ws ON s.s_store_sk = ws.ws_ship_addr_sk JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk WHERE s.s_company_id = '1' AND cd.cd_marital_status IN ('D', 'M', 'U', 'S', 'W') AND cd.cd_dep_employed_count = 0 AND c.c_current_addr_sk IN (13869, 35082) GROUP BY s.s_store_name, cd.cd_gender, cd.cd_marital_status, cd.cd_education_status ORDER BY s.s_store_name, cd.cd_gender, cd.cd_marital_status, cd.cd_education_status;
SELECT cp.cp_department, COUNT(DISTINCT cs.cs_item_sk) AS distinct_items_sold, SUM(cs.cs_quantity) AS total_quantity_sold, SUM(cs.cs_ext_sales_price) AS total_sales, AVG(cs.cs_sales_price) AS average_sales_price, SUM(cs.cs_ext_discount_amt) AS total_discount_amount FROM catalog_sales cs JOIN catalog_page cp ON cs.cs_catalog_page_sk = cp.cp_catalog_page_sk WHERE cs.cs_sold_date_sk BETWEEN cp.cp_start_date_sk AND cp.cp_end_date_sk GROUP BY cp.cp_department ORDER BY total_sales DESC;
SELECT ws.web_class, AVG(ws.web_tax_percentage) AS average_tax_percentage, CA.ca_state, SUM(CA.ca_gmt_offset) AS total_gmt_offset, COUNT(DISTINCT SM.sm_ship_mode_sk) AS shipping_mode_count FROM web_site AS ws JOIN customer_address AS CA ON ws.web_state = CA.ca_state JOIN ship_mode AS SM ON ws.web_zip = SM.sm_code WHERE CA.ca_state IN ('NH', 'MI', 'MD', 'UT') GROUP BY ws.web_class, CA.ca_state ORDER BY ws.web_class, CA.ca_state;
SELECT d_year, d_quarter_name, sm_type AS shipping_type, COUNT(DISTINCT sr_customer_sk) AS num_customers_returned, SUM(sr_return_quantity) AS total_returned_qty, AVG(sr_return_amt) AS avg_return_amt, SUM(sr_return_amt) AS sum_return_amt, SUM(sr_fee) AS total_fees, SUM(sr_net_loss) AS total_net_loss, COUNT(DISTINCT wr_refunded_customer_sk) AS num_customers_refunded, SUM(wr_return_quantity) AS total_refunded_qty, AVG(wr_return_amt) AS avg_refunded_amt, SUM(wr_return_amt) AS sum_refunded_amt, SUM(wr_fee) AS total_wr_fees, SUM(wr_net_loss) AS total_wr_net_loss FROM date_dim JOIN store_returns ON (date_dim.d_date_sk = store_returns.sr_returned_date_sk) JOIN ship_mode ON (store_returns.sr_item_sk = ship_mode.sm_ship_mode_sk) JOIN web_returns ON (store_returns.sr_returned_date_sk = web_returns.wr_returned_date_sk) WHERE sm_carrier = 'MSC' AND d_year = 2022 GROUP BY d_year, d_quarter_name, sm_type ORDER BY d_year, d_quarter_name, sm_type;
SELECT w.w_state, SUM(w.w_warehouse_sq_ft) AS total_warehouse_sq_ft, AVG(w.w_gmt_offset) AS average_gmt_offset, COUNT(r.r_reason_sk) AS gift_exchange_occurrences FROM warehouse w LEFT JOIN reason r ON r.r_reason_desc = 'Gift exchange' JOIN time_dim t ON t.t_minute BETWEEN 25 AND 35 GROUP BY w.w_state ORDER BY total_warehouse_sq_ft DESC, average_gmt_offset DESC;
SELECT ib.ib_income_band_sk, ib.ib_lower_bound, ib.ib_upper_bound, COUNT(DISTINCT hd.hd_demo_sk) AS household_count, SUM(cs.cs_ext_sales_price) AS total_sales_amount, AVG(cs.cs_sales_price) AS average_sales_price, COUNT(DISTINCT cs.cs_order_number) AS total_orders FROM catalog_sales cs JOIN household_demographics hd ON cs.cs_bill_hdemo_sk = hd.hd_demo_sk JOIN income_band ib ON hd.hd_income_band_sk = ib.ib_income_band_sk JOIN time_dim t ON cs.cs_sold_time_sk = t.t_time_sk JOIN warehouse w ON cs.cs_warehouse_sk = w.w_warehouse_sk WHERE t.t_shift = 'Morning' AND ib.ib_upper_bound <= 190000 AND w.w_gmt_offset = -5.00 AND w.w_street_name IN ('Ash Laurel', '6th', 'Wilson Elm', 'View First') GROUP BY ib.ib_income_band_sk, ib.ib_lower_bound, ib.ib_upper_bound ORDER BY ib.ib_income_band_sk;
