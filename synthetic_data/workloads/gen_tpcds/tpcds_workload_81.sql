SELECT ws.web_site_id, ws.web_name, ws.web_manager, ws.web_gmt_offset, COUNT(DISTINCT cs_order_number) AS total_orders, SUM(cs_net_paid) AS total_revenue, AVG(cs_net_profit) AS average_profit, SUM(cr_return_amount) AS total_returns, AVG(cr_return_quantity) AS average_return_quantity, COUNT(DISTINCT cr_returned_date_sk) AS return_days_count, SUM(cd_purchase_estimate) AS total_purchase_estimate, AVG(cd_dep_count) AS average_dependents, COUNT(DISTINCT wp_web_page_sk) AS total_web_pages_accessed, SUM(wp_image_count) AS total_images_counted FROM web_site ws LEFT JOIN catalog_sales cs ON ws.web_site_sk = cs.cs_warehouse_sk LEFT JOIN catalog_returns cr ON cs.cs_order_number = cr.cr_order_number AND cs.cs_item_sk = cr.cr_item_sk LEFT JOIN customer_demographics cd ON cs.cs_bill_cdemo_sk = cd.cd_demo_sk LEFT JOIN web_page wp ON ws.web_site_sk = wp.wp_customer_sk WHERE ws.web_site_id IN ('AAAAAAAAKAAAAAAA', 'AAAAAAAAKBAAAAAA', 'AAAAAAAANAAAAAAA') AND ws.web_manager IN ('John Thomas', 'Charles Castillo', 'Jimmy Pope') AND ws.web_gmt_offset = '-5.00' AND cr.cr_ship_mode_sk IN ('2', '3', '12') AND cr.cr_refunded_hdemo_sk IN ('5787', '111', '6091') AND cr.cr_returning_customer_sk IN ('39980', '67407', '42477') AND cr.cr_returning_addr_sk IN ('22557', '8862', '28393') AND cd.cd_credit_rating IN ('Good', 'Unknown', 'Low Risk') AND cd.cd_purchase_estimate IN ('3500', '2500', '5500') AND cd.cd_dep_employed_count = '0' AND cd.cd_marital_status IN ('U', 'S', 'W') AND wp.wp_access_date_sk IN ('2452555', '2452619', '2452568') AND wp.wp_url = 'http://www.foo.com' AND wp.wp_image_count IN ('2', '3', '5') GROUP BY ws.web_site_id, ws.web_name, ws.web_manager, ws.web_gmt_offset ORDER BY total_revenue DESC, average_profit DESC;
SELECT i_category, r_reason_desc, EXTRACT(YEAR FROM d_date) AS return_year, EXTRACT(MONTH FROM d_date) AS return_month, COUNT(DISTINCT cr_order_number) AS total_returns, SUM(cr_return_quantity) AS total_returned_quantity, AVG(cr_return_amount) AS average_return_amount, SUM(cr_net_loss) AS total_net_loss FROM catalog_returns cr JOIN item i ON cr.cr_item_sk = i.i_item_sk JOIN date_dim dd ON cr.cr_returned_date_sk = dd.d_date_sk JOIN reason r ON cr.cr_reason_sk = r.r_reason_sk WHERE dd.d_current_week = 'N' AND r.r_reason_desc IN ('reason 26', 'Did not get it on time', 'Did not like the make', 'reason 23', 'reason 24') GROUP BY i_category, r_reason_desc, return_year, return_month ORDER BY i_category, return_year, return_month, r_reason_desc;
SELECT s.s_store_name, s.s_company_name, COUNT(DISTINCT inv.inv_item_sk) AS unique_items_stocked, SUM(inv.inv_quantity_on_hand) AS total_inventory, AVG(p.p_cost) AS average_promotion_cost, SUM(CASE WHEN p.p_channel_dmail = 'Y' THEN 1 ELSE 0 END) AS total_direct_mail_promotions, COUNT(DISTINCT ca.ca_address_sk) AS distinct_customer_addresses, d.d_year, d.d_quarter_name FROM store s JOIN inventory inv ON s.s_store_sk = inv.inv_warehouse_sk JOIN promotion p ON p.p_item_sk = inv.inv_item_sk JOIN customer_address ca ON s.s_zip = ca.ca_zip JOIN date_dim d ON inv.inv_date_sk = d.d_date_sk WHERE d.d_year = 2023 AND s.s_market_id IN (1, 2, 3) AND p.p_channel_dmail = 'Y' AND ca.ca_gmt_offset BETWEEN -7.00 AND -5.00 GROUP BY s.s_store_name, s.s_company_name, d.d_year, d.d_quarter_name ORDER BY s.s_store_name, d.d_year, d.d_quarter_name;
SELECT dd.d_year, ca.ca_state, SUM(cs.cs_quantity) AS total_quantity, AVG(cs.cs_sales_price) AS average_sales_price, COUNT(DISTINCT cs.cs_order_number) AS order_count, SUM(cs.cs_net_paid_inc_tax) AS total_revenue_inc_tax, SUM(cs.cs_net_profit) AS total_profit FROM catalog_sales cs JOIN date_dim dd ON cs.cs_sold_date_sk = dd.d_date_sk JOIN customer_address ca ON cs.cs_bill_addr_sk = ca.ca_address_sk JOIN store s ON ca.ca_state = s.s_state JOIN warehouse w ON cs.cs_warehouse_sk = w.w_warehouse_sk WHERE dd.d_fy_year = 1912 GROUP BY dd.d_year, ca.ca_state ORDER BY total_revenue_inc_tax DESC, ca.ca_state;
SELECT sm.sm_type AS shipping_type, web.web_site_sk AS website_id, web.web_name AS website_name, i.i_category AS product_category, COUNT(DISTINCT ws.ws_order_number) AS total_orders, SUM(ws.ws_quantity) AS total_quantity_sold, SUM(ws.ws_net_paid) AS total_net_paid, SUM(ws.ws_net_paid_inc_tax) AS total_net_paid_incl_tax, SUM(ws.ws_net_paid_inc_ship) AS total_net_paid_incl_shipping, SUM(ws.ws_net_paid_inc_ship_tax) AS total_net_paid_incl_shipping_tax, AVG(ws.ws_sales_price) AS average_sales_price, SUM(ws.ws_net_profit) AS total_net_profit FROM web_sales ws JOIN web_site web ON ws.ws_web_site_sk = web.web_site_sk JOIN item i ON ws.ws_item_sk = i.i_item_sk JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk JOIN date_dim dd ON ws.ws_sold_date_sk = dd.d_date_sk WHERE sm.sm_type IN ('REGULAR', 'EXPRESS', 'OVERNIGHT') AND web.web_country = 'United States' AND ws.ws_warehouse_sk IN (2, 4) AND i.i_category IN ('Electronics', 'Women', 'Children', 'Home', 'Sports', 'Books') AND dd.d_year = 1999 GROUP BY shipping_type, website_id, website_name, product_category ORDER BY total_net_profit DESC, total_net_paid DESC, website_name, product_category;
SELECT cc.cc_division_name, COUNT(DISTINCT cc.cc_call_center_sk) AS num_call_centers, AVG(cc.cc_employees) AS avg_employees, SUM(inv.inv_quantity_on_hand) AS total_inventory, SUM(wr.wr_return_amt_inc_tax) AS total_returns_inc_tax, AVG(wp.wp_link_count) AS avg_link_count_per_page FROM call_center cc JOIN inventory inv ON cc.cc_call_center_sk = inv.inv_warehouse_sk JOIN web_returns wr ON inv.inv_item_sk = wr.wr_item_sk JOIN web_page wp ON wr.wr_web_page_sk = wp.wp_web_page_sk WHERE cc.cc_division IN (1, 3, 5) AND cc.cc_open_date_sk IN (2450952, 2450806, 2451063) AND wr.wr_web_page_sk IN (2, 32, 58, 26, 39) GROUP BY cc.cc_division_name ORDER BY total_returns_inc_tax DESC, avg_link_count_per_page DESC;
SELECT cc.cc_name, cc.cc_city, cc.cc_state, SUM(cs.cs_net_paid) AS total_sales, AVG(cs.cs_net_paid_inc_tax) AS avg_sales_inc_tax, COUNT(*) AS number_of_sales, SUM(ws.ws_quantity) AS total_web_quantity_sold, AVG(ws.ws_net_profit) AS avg_web_net_profit FROM call_center cc JOIN catalog_sales cs ON cc.cc_call_center_sk = cs.cs_call_center_sk JOIN web_sales ws ON cs.cs_item_sk = ws.ws_item_sk AND cs.cs_order_number = ws.ws_order_number JOIN promotion p ON cs.cs_promo_sk = p.p_promo_sk AND ws.ws_promo_sk = p.p_promo_sk WHERE cs.cs_ship_customer_sk IN (17646, 63607, 15126, 61460) AND p.p_discount_active = '1' AND cc.cc_rec_start_date <= CURRENT_DATE AND (cc.cc_rec_end_date IS NULL OR cc.cc_rec_end_date > CURRENT_DATE) GROUP BY cc.cc_name, cc.cc_city, cc.cc_state ORDER BY total_sales DESC LIMIT 10;
SELECT ca_state, w_state, AVG(c_hd.hd_dep_count) AS avg_household_dep_count, COUNT(DISTINCT cs_order_number) AS total_orders, SUM(cs_net_profit) AS total_net_profit, SUM(ss_net_profit) AS total_store_net_profit FROM customer_address ca JOIN catalog_sales cs ON ca.ca_address_sk = cs.cs_bill_addr_sk JOIN household_demographics c_hd ON cs.cs_bill_hdemo_sk = c_hd.hd_demo_sk JOIN warehouse w ON cs.cs_warehouse_sk = w.w_warehouse_sk JOIN store_sales ss ON cs.cs_item_sk = ss.ss_item_sk AND cs.cs_order_number = ss.ss_ticket_number WHERE ca.ca_country = 'United States' AND w.w_country = 'United States' AND ss.ss_quantity > 5 AND cs.cs_quantity > 5 AND ca.ca_state IN ('CA', 'TX', 'NY') GROUP BY ca_state, w_state ORDER BY total_net_profit DESC, total_store_net_profit DESC, ca_state, w_state;
SELECT ws.ws_web_site_sk, ws_site.web_site_id, COUNT(DISTINCT ws.ws_order_number) AS total_orders, SUM(ws.ws_quantity) AS total_quantity, AVG(ws.ws_sales_price) AS avg_sales_price, SUM(ws.ws_net_profit) AS total_net_profit, cc.cc_call_center_id, cc.cc_name, AVG(cc.cc_employees) AS avg_cc_employees, cd.cd_marital_status, COUNT(DISTINCT cd.cd_demo_sk) AS total_customers, AVG(cd.cd_purchase_estimate) AS avg_purchase_estimate, hd.hd_buy_potential, AVG(hd.hd_income_band_sk) AS avg_income_band FROM web_sales ws JOIN web_site ws_site ON ws.ws_web_site_sk = ws_site.web_site_sk JOIN call_center cc ON ws_site.web_mkt_id = cc.cc_mkt_id JOIN customer_demographics cd ON ws.ws_bill_cdemo_sk = cd.cd_demo_sk JOIN household_demographics hd ON ws.ws_bill_hdemo_sk = hd.hd_demo_sk WHERE ws.ws_sales_price > 0 AND ws.ws_sold_date_sk BETWEEN 2451569 AND 2452306 AND ws.ws_web_site_sk IN (4, 18, 20, 29, 27) AND cc.cc_call_center_sk IN (1, 4, 2) AND cd.cd_purchase_estimate > 5000 AND cd.cd_marital_status IN ('D', 'U', 'S', 'M', 'W') AND hd.hd_buy_potential IS NOT NULL GROUP BY ws.ws_web_site_sk, ws_site.web_site_id, cc.cc_call_center_id, cc.cc_name, cd.cd_marital_status, hd.hd_buy_potential ORDER BY total_net_profit DESC, avg_sales_price DESC LIMIT 100;
SELECT d_year, i_category, SUM(ss_quantity) AS total_store_sales_quantity, AVG(ss_sales_price) AS avg_store_sales_price, AVG(cs_sales_price) AS avg_catalog_sales_price, AVG(ws_sales_price) AS avg_web_sales_price, SUM(ss_net_paid) AS total_store_net_paid, SUM(cs_net_paid) AS total_catalog_net_paid, SUM(ws_net_paid) AS total_web_net_paid, COUNT(DISTINCT ss_store_sk) AS number_of_stores, COUNT(DISTINCT cs_catalog_page_sk) AS number_of_catalog_pages, COUNT(DISTINCT ws_web_site_sk) AS number_of_websites FROM store_sales JOIN date_dim ON (ss_sold_date_sk = d_date_sk) JOIN item ON (ss_item_sk = i_item_sk) LEFT JOIN catalog_sales ON (ss_item_sk = cs_item_sk AND ss_sold_date_sk = cs_sold_date_sk) LEFT JOIN web_sales ON (ss_item_sk = ws_item_sk AND ss_sold_date_sk = ws_sold_date_sk) WHERE d_year = 1999 AND (ss_net_paid > 900 OR cs_net_paid > 900 OR ws_net_paid > 900) AND i_manager_id IN (65, 2, 85) GROUP BY d_year, i_category ORDER BY total_store_sales_quantity DESC, total_store_net_paid DESC, i_category;
SELECT s.s_store_name, SUM(ss.ss_quantity) AS total_quantity_sold, AVG(ss.ss_sales_price) AS average_sales_price, SUM(ss.ss_net_paid) AS total_net_paid, SUM(ss.ss_net_paid_inc_tax) AS total_net_paid_inc_tax, AVG(ss.ss_net_profit) AS average_net_profit, COUNT(DISTINCT p.p_promo_sk) AS number_of_promotions_run, SUM(CASE WHEN p.p_channel_tv = 'N' THEN ss.ss_quantity ELSE 0 END) AS quantity_sold_with_no_tv_promo FROM store_sales ss JOIN store s ON ss.ss_store_sk = s.s_store_sk JOIN promotion p ON ss.ss_promo_sk = p.p_promo_sk JOIN call_center cc ON s.s_market_id = cc.cc_mkt_id JOIN inventory i ON ss.ss_item_sk = i.inv_item_sk AND i.inv_date_sk = ss.ss_sold_date_sk WHERE ss.ss_sold_time_sk IN (63444, 44081, 71662, 70433) AND i.inv_item_sk IN (15889, 8930) AND i.inv_date_sk = 2450815 AND p.p_cost = 1000.00 AND cc.cc_sq_ft IN (795, 2268, 3514, 1138, 649) AND cc.cc_open_date_sk IN (2450806, 2450952) GROUP BY s.s_store_name ORDER BY total_net_paid DESC;
SELECT w.w_warehouse_name, cc.cc_name AS call_center_name, cd.cp_department, sm.sm_type AS ship_mode_type, AVG(ss.ss_sales_price) AS avg_sales_price, SUM(ss.ss_quantity) AS total_quantity_sold, COUNT(DISTINCT ss.ss_customer_sk) AS unique_customers, SUM(CASE WHEN hd.hd_vehicle_count > 2 THEN ss.ss_net_paid ELSE 0 END) AS net_paid_more_than_2_vehicles, SUM(CASE WHEN cd.cp_type = 'quarterly' THEN ss.ss_net_paid_inc_tax ELSE 0 END) AS net_paid_inc_tax_for_quarterly_pages FROM store_sales ss JOIN warehouse w ON ss.ss_store_sk = w.w_warehouse_sk JOIN call_center cc ON w.w_zip = cc.cc_zip JOIN catalog_page cd ON ss.ss_promo_sk = cd.cp_catalog_page_sk JOIN ship_mode sm ON sm.sm_code = 'AIR' JOIN household_demographics hd ON ss.ss_hdemo_sk = hd.hd_demo_sk WHERE cc.cc_street_type = 'Boulevard' AND cd.cp_type IN ('quarterly', 'bi-annual') AND w.w_suite_number IN ('Suite 80', 'Suite P') GROUP BY w.w_warehouse_name, cc.cc_name, cd.cp_department, sm.sm_type ORDER BY avg_sales_price DESC, total_quantity_sold DESC, unique_customers DESC, net_paid_more_than_2_vehicles DESC, net_paid_inc_tax_for_quarterly_pages DESC;
SELECT cd.cd_education_status, ca.ca_state, AVG(ss.ss_sales_price) AS average_sales_price, SUM(ss.ss_net_profit) AS total_net_profit, COUNT(ss.ss_ticket_number) AS total_sales_transactions FROM store_sales ss JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk WHERE d.d_weekend = 'Y' AND d.d_year = 2022 GROUP BY cd.cd_education_status, ca.ca_state ORDER BY cd.cd_education_status, ca.ca_state;
SELECT ca.ca_city, ca.ca_state, COUNT(DISTINCT ca.ca_address_sk) AS num_addresses, AVG(hd.hd_dep_count) AS avg_dependency_count, SUM(hd.hd_vehicle_count) AS total_vehicles, ib.ib_lower_bound, ib.ib_upper_bound, COUNT(DISTINCT sm.sm_ship_mode_sk) AS num_ship_modes, COUNT(DISTINCT r.r_reason_sk) AS num_reasons, SUM(CASE WHEN cp.cp_department = 'Electronics' THEN 1 ELSE 0 END) AS num_electronics_pages, SUM(CASE WHEN sm.sm_type = 'OVERNIGHT' THEN 1 ELSE 0 END) AS overnight_shipments, AVG(CASE WHEN t.t_am_pm = 'PM' THEN t.t_hour END) AS avg_hour_pm FROM customer_address ca JOIN household_demographics hd ON ca.ca_address_sk = hd.hd_demo_sk JOIN income_band ib ON hd.hd_income_band_sk = ib.ib_income_band_sk JOIN ship_mode sm ON sm.sm_carrier = 'UPS' JOIN reason r ON r.r_reason_desc LIKE 'reason %' LEFT JOIN catalog_page cp ON cp.cp_department = ca.ca_city LEFT JOIN time_dim t ON t.t_shift = 'Evening' WHERE r.r_reason_sk IN ('9', '6', '11', '2') AND ib.ib_income_band_sk IN ('20', '6') AND hd.hd_buy_potential = 'Unknown' AND sm.sm_type IN ('LIBRARY', 'OVERNIGHT', 'NEXT DAY') GROUP BY ca.ca_city, ca.ca_state, ib.ib_lower_bound, ib.ib_upper_bound ORDER BY ca.ca_city, ca.ca_state;
SELECT s.s_store_name, COUNT(sr.sr_ticket_number) AS total_returns, SUM(sr.sr_return_quantity) AS total_returned_quantity, AVG(sr.sr_return_amt) AS average_return_amount, SUM(sr.sr_fee) AS total_fees_collected, SUM(sr.sr_net_loss) AS total_net_loss, cd.cd_credit_rating, COUNT(DISTINCT cd.cd_demo_sk) AS unique_customers_returning, w.w_warehouse_name, SUM(w.w_warehouse_sq_ft) AS total_warehouse_sq_ft_used, p.p_promo_name, SUM(p.p_cost) AS total_promotion_cost, AVG(wp.wp_link_count) AS average_webpage_link_count FROM store_returns sr INNER JOIN store s ON sr.sr_store_sk = s.s_store_sk INNER JOIN customer_demographics cd ON sr.sr_cdemo_sk = cd.cd_demo_sk INNER JOIN warehouse w ON s.s_zip = w.w_zip INNER JOIN promotion p ON sr.sr_reason_sk = p.p_promo_sk INNER JOIN web_page wp ON wp.wp_customer_sk = sr.sr_customer_sk WHERE s.s_rec_start_date BETWEEN '1997-03-13' AND '2001-03-13' AND s.s_store_name IN ('ese', 'ought', 'cally') AND wp.wp_creation_date_sk::text IN ('2450814', '2450813', '2450815') AND wp.wp_rec_start_date BETWEEN '1997-09-03' AND '2001-09-03' AND sr.sr_reversed_charge = 13.92 AND cd.cd_credit_rating IN ('Low Risk', 'High Risk', 'Unknown', 'Good') GROUP BY s.s_store_name, cd.cd_credit_rating, w.w_warehouse_name, p.p_promo_name ORDER BY total_returns DESC, total_net_loss DESC;
SELECT ca.ca_city, ca.ca_county, AVG(hd.hd_income_band_sk) AS avg_income_band, AVG(hd.hd_vehicle_count) AS avg_vehicle_count, COUNT(DISTINCT wp.wp_web_page_sk) AS num_web_pages_created, COUNT(DISTINCT wp.wp_access_date_sk) AS num_web_pages_accessed, AVG(wp.wp_char_count) AS avg_web_page_char_count FROM customer_address ca JOIN household_demographics hd ON ca.ca_address_sk = hd.hd_demo_sk LEFT JOIN web_page wp ON ca.ca_address_sk = wp.wp_customer_sk WHERE ca.ca_city IN ('Morgantown', 'Forestville', 'Sutton', 'Mount Olive', 'Texas', 'Bridgeport') AND ca.ca_county IN ('Carlton County', 'Bonneville County') AND wp.wp_type IN ('blog', 'article', 'product_review') AND wp.wp_autogen_flag = 'N' GROUP BY ca.ca_city, ca.ca_county ORDER BY ca.ca_city, ca.ca_county;
SELECT cd.cd_gender, cd.cd_marital_status, cd.cd_education_status, cd.cd_purchase_estimate, cd.cd_credit_rating, hd.hd_buy_potential, hd.hd_dep_count, hd.hd_vehicle_count, r.r_reason_desc, COUNT(cr.cr_order_number) AS total_returns, SUM(cr.cr_return_quantity) AS total_returned_quantity, AVG(cr.cr_return_amount) AS average_return_amount, SUM(cr.cr_return_amount) AS total_return_amount FROM catalog_returns cr JOIN customer_demographics cd ON cr.cr_returning_cdemo_sk = cd.cd_demo_sk JOIN household_demographics hd ON cr.cr_returning_hdemo_sk = hd.hd_demo_sk JOIN reason r ON cr.cr_reason_sk = r.r_reason_sk JOIN store s ON cr.cr_warehouse_sk = s.s_store_sk WHERE hd.hd_buy_potential IN ('5001-10000', '1001-5000', '>10000', '0-500', '501-1000') AND s.s_number_employees IN ('297', '294', '236', '245', '278') GROUP BY cd.cd_gender, cd.cd_marital_status, cd.cd_education_status, cd.cd_purchase_estimate, cd.cd_credit_rating, hd.hd_buy_potential, hd.hd_dep_count, hd.hd_vehicle_count, r.r_reason_desc ORDER BY total_return_amount DESC, total_returned_quantity DESC, cd.cd_credit_rating, hd.hd_buy_potential;
SELECT sm.sm_type, COUNT(DISTINCT ws.ws_order_number) AS total_orders, SUM(ws.ws_quantity) AS total_quantity_sold, AVG(ws.ws_wholesale_cost) AS avg_wholesale_cost, AVG(ws.ws_sales_price) AS avg_sales_price, SUM(ws.ws_net_profit) AS total_net_profit FROM web_sales ws JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk JOIN warehouse w ON ws.ws_warehouse_sk = w.w_warehouse_sk WHERE w.w_zip = '35709' AND ws.ws_web_site_sk IN (30, 17, 4, 15, 14, 2) AND sm.sm_ship_mode_sk IN (4, 9, 13, 10, 8, 20) GROUP BY sm.sm_type ORDER BY total_net_profit DESC;
SELECT cc.cc_call_center_id, cc.cc_name, cc.cc_city, cc.cc_state, AVG(cr.cr_return_amount) AS avg_return_amount, SUM(cr.cr_return_quantity) AS total_return_quantity, COUNT(*) AS total_returns, AVG(hd.hd_vehicle_count) AS avg_vehicle_count, AVG(hd.hd_dep_count) AS avg_dependent_count FROM call_center cc JOIN catalog_returns cr ON cc.cc_call_center_sk = cr.cr_call_center_sk JOIN household_demographics hd ON cr.cr_returning_hdemo_sk = hd.hd_demo_sk WHERE cc.cc_country = 'United States' AND cc.cc_rec_start_date > '1998-01-01' AND hd.hd_vehicle_count IN (1, 2, 3) GROUP BY cc.cc_call_center_id, cc.cc_name, cc.cc_city, cc.cc_state ORDER BY total_return_quantity DESC, avg_return_amount DESC;
SELECT p.p_promo_id, p.p_promo_name, COUNT(DISTINCT cs.cs_item_sk) AS number_of_items_sold, SUM(cs.cs_quantity) AS total_quantity_sold, AVG(cs.cs_sales_price) AS average_selling_price, SUM(cs.cs_ext_sales_price) AS total_sales_amount, SUM(cs.cs_ext_discount_amt) AS total_discount_amount, AVG((cs.cs_ext_discount_amt / cs.cs_ext_list_price) * 100) AS average_discount_percentage, SUM(cs.cs_net_profit) AS total_net_profit, AVG(inv.inv_quantity_on_hand) AS average_inventory_quantity_on_hand FROM catalog_sales cs JOIN promotion p ON cs.cs_promo_sk = p.p_promo_sk LEFT JOIN inventory inv ON cs.cs_item_sk = inv.inv_item_sk AND cs.cs_sold_date_sk = inv.inv_date_sk WHERE cs.cs_ext_list_price IN (8856.28, 4863.95, 651.00, 4727.68) GROUP BY p.p_promo_id, p.p_promo_name ORDER BY total_sales_amount DESC;
SELECT hd.hd_income_band_sk, hd.hd_buy_potential, COUNT(DISTINCT hd.hd_demo_sk) AS total_households, AVG(hd.hd_dep_count) AS avg_dependency_count, AVG(hd.hd_vehicle_count) AS avg_vehicle_count, SUM(cs.cs_quantity) AS total_quantity_sold, SUM(cs.cs_net_paid) AS total_net_paid, SUM(cs.cs_net_paid_inc_ship) AS total_net_paid_including_shipping, SUM(cs.cs_net_paid_inc_tax) AS total_net_paid_including_tax, AVG(cs.cs_sales_price) AS avg_sales_price, COUNT(DISTINCT p.p_promo_sk) AS total_promotions_used, SUM(p.p_cost) AS total_promotion_cost FROM household_demographics hd JOIN catalog_sales cs ON hd.hd_demo_sk = cs.cs_bill_hdemo_sk LEFT JOIN promotion p ON cs.cs_promo_sk = p.p_promo_sk AND p.p_channel_event = 'N' GROUP BY hd.hd_income_band_sk, hd.hd_buy_potential ORDER BY total_net_paid DESC;
