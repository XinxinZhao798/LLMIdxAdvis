SELECT sm.sm_type, p.p_promo_name, hd.hd_income_band_sk, COUNT(DISTINCT cs.cs_order_number) AS total_orders, SUM(cs.cs_quantity) AS total_quantity, AVG(cs.cs_sales_price) AS avg_sales_price, SUM(cs.cs_net_paid) AS total_net_paid, SUM(cs.cs_net_paid_inc_tax) AS total_net_paid_inc_tax, SUM(cs.cs_net_paid_inc_ship) AS total_net_paid_inc_ship, SUM(cs.cs_net_paid_inc_ship_tax) AS total_net_paid_inc_ship_tax, SUM(cs.cs_net_profit) AS total_net_profit FROM catalog_sales cs JOIN ship_mode sm ON cs.cs_ship_mode_sk = sm.sm_ship_mode_sk JOIN promotion p ON cs.cs_promo_sk = p.p_promo_sk JOIN household_demographics hd ON cs.cs_ship_hdemo_sk = hd.hd_demo_sk WHERE sm.sm_ship_mode_sk IN (15, 11, 1) AND sm.sm_type IN ('TWO DAY', 'EXPRESS', 'NEXT DAY') AND p.p_channel_details IN ('Only red systems ring right b', 'Strong cells could dis', 'Finally glad reasons mobili') AND p.p_channel_dmail IN ('N', 'Y') AND p.p_promo_name LIKE '%ese%' OR p.p_promo_name LIKE '%eing%' OR p.p_promo_name LIKE '%able%' AND p.p_purpose = 'Unknown' AND hd.hd_income_band_sk IN (11, 1, 6) AND hd.hd_dep_count IN (5, 0, 2) AND cs.cs_ship_customer_sk IN (6024, 65323, 92049) AND cs.cs_ext_ship_cost IN (36.27, 943.02, 662.47) GROUP BY sm.sm_type, p.p_promo_name, hd.hd_income_band_sk ORDER BY total_net_profit DESC, avg_sales_price DESC, total_orders DESC;
SELECT dd.d_year, dd.d_quarter_name, ca.ca_state, COUNT(DISTINCT ws.ws_order_number) AS total_orders, SUM(ws.ws_quantity) AS total_quantity, SUM(ws.ws_net_paid) AS total_net_paid, AVG(ws.ws_sales_price) AS average_sales_price, SUM(ws.ws_net_profit) AS total_net_profit FROM web_sales ws JOIN date_dim dd ON ws.ws_sold_date_sk = dd.d_date_sk JOIN customer_address ca ON ws.ws_bill_addr_sk = ca.ca_address_sk WHERE dd.d_year = 2002 AND ca.ca_country = 'United States' AND ws.ws_net_paid_inc_ship_tax > 1000 GROUP BY dd.d_year, dd.d_quarter_name, ca.ca_state ORDER BY dd.d_year, dd.d_quarter_name, ca.ca_state;
SELECT cpg.cp_department, it.i_category, SUM(cs.cs_quantity) AS total_quantity, AVG(cs.cs_sales_price) AS average_sales_price, COUNT(DISTINCT cs.cs_order_number) AS total_orders, SUM(cs.cs_net_profit) AS total_net_profit FROM catalog_sales cs JOIN item it ON cs.cs_item_sk = it.i_item_sk JOIN catalog_page cpg ON cs.cs_catalog_page_sk = cpg.cp_catalog_page_sk JOIN web_site ws ON cpg.cp_catalog_number = ws.web_mkt_id WHERE it.i_category_id IS NOT NULL AND cpg.cp_department IS NOT NULL AND ws.web_class <> 'Unknown' GROUP BY cpg.cp_department, it.i_category ORDER BY total_net_profit DESC, cpg.cp_department, it.i_category;
SELECT dd.d_year, dd.d_quarter_name, COUNT(sr.sr_ticket_number) AS store_return_count, SUM(sr.sr_return_amt_inc_tax) AS store_total_return_amount_inc_tax, AVG(sr.sr_return_quantity) AS store_avg_return_quantity, SUM(sr.sr_net_loss) AS store_total_net_loss, COUNT(wr.wr_order_number) AS web_return_count, SUM(wr.wr_return_amt_inc_tax) AS web_total_return_amount_inc_tax, AVG(wr.wr_return_quantity) AS web_avg_return_quantity, SUM(wr.wr_net_loss) AS web_total_net_loss FROM date_dim dd LEFT JOIN store_returns sr ON dd.d_date_sk = sr.sr_returned_date_sk LEFT JOIN web_returns wr ON dd.d_date_sk = wr.wr_returned_date_sk AND wr.wr_returning_addr_sk = '49674' WHERE dd.d_year = 2023 AND dd.d_quarter_seq BETWEEN 202301 AND 202304 GROUP BY dd.d_year, dd.d_quarter_name ORDER BY dd.d_year, dd.d_quarter_name;
SELECT d_year, SUM(ws_net_profit) AS total_net_profit, AVG(ws_quantity) AS average_quantity_sold, COUNT(DISTINCT ws.ws_web_page_sk) AS count_distinct_pages, SUM(wr_return_amt) AS total_return_amount, AVG(wr_return_quantity) AS average_return_quantity, COUNT(DISTINCT wr.wr_item_sk) AS count_distinct_returned_items FROM web_sales ws JOIN date_dim dd ON ws.ws_sold_date_sk = dd.d_date_sk LEFT JOIN web_returns wr ON ws.ws_item_sk = wr.wr_item_sk AND ws.ws_order_number = wr.wr_order_number LEFT JOIN web_page wp ON ws.ws_web_page_sk = wp.wp_web_page_sk WHERE dd.d_moy IN ('8', '11') AND dd.d_current_week = 'N' AND ws.ws_web_page_sk IN ('58', '41', '42', '15', '20') AND ws.ws_ext_list_price = 4407.89 AND (wp.wp_rec_end_date IN ('1999-09-03', '2001-09-02', '2000-09-02') OR wp.wp_creation_date_sk IN (2450815, 2450812, 2450813)) AND wr.wr_return_amt IN (78.84, 5987.96, 1527.93, 522.48, 1155.36, 2771.56) AND wr.wr_return_amt_inc_tax = 191.45 GROUP BY dd.d_year;
SELECT dd.d_year, dd.d_quarter_name, cc.cc_division_name, SUM(wp.wp_char_count) AS total_char_count, AVG(wp.wp_link_count) AS average_link_count, COUNT(*) AS num_web_pages_accessed, COUNT(DISTINCT cc.cc_call_center_sk) AS num_call_centers_involved, COUNT(DISTINCT r.r_reason_sk) AS num_distinct_reasons FROM date_dim AS dd JOIN web_page AS wp ON dd.d_date_sk = wp.wp_access_date_sk JOIN call_center AS cc ON wp.wp_customer_sk = cc.cc_call_center_sk LEFT JOIN reason AS r ON r.r_reason_sk = wp.wp_customer_sk WHERE dd.d_year = 2022 AND dd.d_quarter_name IN ('Q1', 'Q2', 'Q3', 'Q4') AND r.r_reason_sk IN ('15', '31', '3', '32', '5') GROUP BY dd.d_year, dd.d_quarter_name, cc.cc_division_name ORDER BY dd.d_year, dd.d_quarter_name, cc.cc_division_name;
SELECT r.r_reason_desc, ca.ca_state, d.d_moy AS month_of_year, COUNT(sr.sr_ticket_number) AS return_count, SUM(sr.sr_return_amt) AS total_return_amount, AVG(sr.sr_return_amt) AS avg_return_amount FROM store_returns sr JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk JOIN customer_address ca ON sr.sr_addr_sk = ca.ca_address_sk WHERE d.d_current_year = 'Y' GROUP BY r.r_reason_desc, ca.ca_state, month_of_year ORDER BY r.r_reason_desc, ca.ca_state, month_of_year;
SELECT ca_country, sm_type, COUNT(*) AS shipment_count, AVG(ca_gmt_offset) AS avg_gmt_offset, SUM(CASE WHEN r_reason_sk IN (28, 20, 15, 23, 17) THEN 1 ELSE 0 END) AS high_priority_reason_count FROM customer_address JOIN ship_mode ON ca_address_sk = sm_ship_mode_sk LEFT JOIN reason ON r_reason_sk = ca_address_sk WHERE ca_country = 'United States' AND r_reason_id IN ('AAAAAAAALBAAAAAA', 'AAAAAAAAPAAAAAAA', 'AAAAAAAAKAAAAAAA') AND ca_address_id IN ('AAAAAAAALPBAAAAA', 'AAAAAAAAJIMAAAAA') GROUP BY ca_country, sm_type ORDER BY shipment_count DESC, avg_gmt_offset;
