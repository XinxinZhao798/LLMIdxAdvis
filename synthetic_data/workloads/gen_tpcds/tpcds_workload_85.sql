SELECT dd.d_year, dd.d_quarter_name, SUM(cs.cs_net_paid_inc_ship_tax) AS total_sales, AVG(cs.cs_net_paid_inc_ship_tax) AS avg_sales, COUNT(*) AS number_of_sales, SUM(cr.cr_return_amt_inc_tax) AS total_returns, AVG(cr.cr_return_amt_inc_tax) AS avg_returns, COUNT(cr.cr_order_number) AS number_of_returns, SUM(hd.hd_dep_count) AS total_dependants, AVG(w.w_warehouse_sq_ft) AS avg_warehouse_size FROM date_dim dd LEFT JOIN catalog_sales cs ON dd.d_date_sk = cs.cs_sold_date_sk LEFT JOIN catalog_returns cr ON dd.d_date_sk = cr.cr_returned_date_sk LEFT JOIN household_demographics hd ON cs.cs_bill_hdemo_sk = hd.hd_demo_sk LEFT JOIN warehouse w ON cs.cs_warehouse_sk = w.w_warehouse_sk WHERE dd.d_year = 1999 AND (cs.cs_net_paid_inc_ship_tax > 1000 OR cr.cr_return_amt_inc_tax > 100) AND hd.hd_buy_potential = '1001-5000' AND hd.hd_dep_count BETWEEN 4 AND 9 AND cr.cr_ship_mode_sk IN (4, 7) GROUP BY dd.d_year, dd.d_quarter_name ORDER BY dd.d_year, dd.d_quarter_name;
SELECT dd.d_year, id.i_category, SUM(cs.cs_quantity) AS total_quantity_sold, AVG(cs.cs_sales_price) AS avg_sales_price, COUNT(DISTINCT cs.cs_order_number) AS total_orders, SUM(sr.sr_return_amt) AS total_return_amount, COUNT(DISTINCT sr.sr_ticket_number) AS total_returns FROM catalog_sales AS cs JOIN item AS id ON cs.cs_item_sk = id.i_item_sk JOIN date_dim AS dd ON cs.cs_sold_date_sk = dd.d_date_sk LEFT JOIN store_returns AS sr ON cs.cs_item_sk = sr.sr_item_sk AND cs.cs_order_number = sr.sr_ticket_number WHERE dd.d_year = 2003 AND id.i_category IN ('Electronics', 'Clothing', 'Furniture') GROUP BY dd.d_year, id.i_category ORDER BY total_quantity_sold DESC, total_return_amount DESC;
SELECT cd_gender, cd_marital_status, cd_education_status, sm_type, COUNT(*) AS total_returns, SUM(cr_return_amount) AS total_refund_amount, AVG(cr_return_quantity) AS avg_return_quantity, SUM(cr_fee) AS total_fees, SUM(cr_return_ship_cost) AS total_shipping_costs, SUM(cr_net_loss) AS total_net_loss FROM catalog_returns cr JOIN customer_demographics cd ON cr.cr_returning_cdemo_sk = cd.cd_demo_sk JOIN ship_mode sm ON cr.cr_ship_mode_sk = sm.sm_ship_mode_sk JOIN time_dim td ON cr.cr_returned_time_sk = td.t_time_sk JOIN promotion p ON cr.cr_order_number = p.p_promo_sk WHERE td.t_sub_shift = 'night' AND p.p_channel_dmail = 'Y' AND p.p_discount_active = 'N' GROUP BY cd_gender, cd_marital_status, cd_education_status, sm_type ORDER BY total_returns DESC, total_refund_amount DESC;
SELECT p_promo_name, SUM(cs_quantity) AS total_quantity_sold, SUM(cs_net_paid) AS total_revenue, AVG(cs_sales_price) AS average_sales_price, COUNT(DISTINCT cs_order_number) AS total_orders, SUM(cr_return_quantity) AS total_quantity_returned, SUM(cr_return_amount) AS total_returns, AVG(sr_return_amt) AS average_return_amount, COUNT(DISTINCT sr_ticket_number) AS total_return_tickets FROM catalog_sales JOIN promotion ON cs_promo_sk = p_promo_sk AND p_channel_tv = 'N' LEFT JOIN catalog_returns ON cs_item_sk = cr_item_sk AND cs_order_number = cr_order_number LEFT JOIN store_returns ON cs_item_sk = sr_item_sk AND sr_store_sk IN ('8', '2', '10', '4') WHERE cs_ship_date_sk = 2450936 GROUP BY p_promo_name ORDER BY total_revenue DESC;
SELECT sm.sm_type, sm.sm_carrier, COUNT(DISTINCT wr.wr_item_sk) AS total_items_returned, SUM(wr.wr_return_quantity) AS total_quantity_returned, AVG(wr.wr_return_amt) AS average_return_amount, AVG(wr.wr_fee) AS average_fee, SUM(wr.wr_net_loss) AS total_net_loss, ws.web_name, ws.web_manager, ws.web_mkt_class, COUNT(DISTINCT ws.web_site_sk) AS total_sites FROM web_returns wr JOIN ship_mode sm ON wr.wr_returned_date_sk = sm.sm_ship_mode_sk JOIN web_site ws ON wr.wr_web_page_sk = ws.web_site_sk WHERE ws.web_mkt_id IN (3, 4, 6, 2) AND ws.web_street_name = 'Hickory 3rd' AND wr.wr_returned_date_sk BETWEEN 100 AND 200 GROUP BY sm.sm_type, sm.sm_carrier, ws.web_name, ws.web_manager, ws.web_mkt_class ORDER BY total_net_loss DESC, total_quantity_returned DESC LIMIT 10;
SELECT ib.ib_lower_bound, ib.ib_upper_bound, sm.sm_type, COUNT(DISTINCT cp.cp_catalog_page_sk) AS total_catalog_pages, MIN(cp.cp_catalog_number) AS min_catalog_number, MAX(cp.cp_catalog_number) AS max_catalog_number, COUNT(DISTINCT sm.sm_ship_mode_sk) AS total_ship_modes FROM income_band ib CROSS JOIN ship_mode sm LEFT JOIN catalog_page cp ON cp.cp_department = 'Books' WHERE sm.sm_type IN ('LIBRARY', 'REGULAR') GROUP BY ib.ib_lower_bound, ib.ib_upper_bound, sm.sm_type ORDER BY ib.ib_lower_bound, sm.sm_type;
SELECT sm.sm_type AS shipping_type, w.w_city AS warehouse_city, r.r_reason_desc AS return_reason, COUNT(*) AS total_returns, SUM(cr.cr_return_quantity) AS total_returned_quantity, AVG(cr.cr_return_amount) AS average_return_amount, SUM(cr.cr_return_amt_inc_tax) AS total_return_amount_inc_tax, AVG(cr.cr_fee) AS average_fee, SUM(cr.cr_net_loss) AS total_net_loss FROM catalog_returns cr JOIN reason r ON cr.cr_reason_sk = r.r_reason_sk JOIN ship_mode sm ON cr.cr_ship_mode_sk = sm.sm_ship_mode_sk JOIN warehouse w ON cr.cr_warehouse_sk = w.w_warehouse_sk GROUP BY shipping_type, warehouse_city, return_reason ORDER BY total_returns DESC, total_returned_quantity DESC;
SELECT s_state AS state, AVG(ws_sales_price) AS avg_web_sales_price, SUM(ws_quantity) AS total_web_sales_quantity, COUNT(DISTINCT s_store_sk) AS num_stores, COUNT(DISTINCT w_warehouse_sk) AS num_warehouses FROM web_sales JOIN store ON web_sales.ws_ship_addr_sk = store.s_store_sk JOIN warehouse ON web_sales.ws_warehouse_sk = warehouse.w_warehouse_sk GROUP BY state ORDER BY state;
SELECT w.w_warehouse_name, w.w_warehouse_sq_ft, w.w_city, w.w_state, ib.ib_lower_bound, ib.ib_upper_bound, AVG(cs.cs_sales_price) AS avg_sales_price, AVG(cs.cs_ext_discount_amt) AS avg_discount_amount, SUM(cs.cs_quantity) AS total_quantity_sold, COUNT(DISTINCT cs.cs_order_number) AS total_orders, COUNT(DISTINCT p.p_promo_sk) AS total_promotions_applied FROM catalog_sales cs JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk JOIN warehouse w ON cs.cs_warehouse_sk = w.w_warehouse_sk JOIN promotion p ON cs.cs_promo_sk = p.p_promo_sk JOIN income_band ib ON cs.cs_bill_customer_sk = ib.ib_income_band_sk WHERE d.d_year = 2021 AND w.w_county = 'Williamson County' AND p.p_discount_active = 'Y' AND p.p_response_target > 50 AND cs.cs_sales_price IS NOT NULL AND cs.cs_ext_discount_amt IS NOT NULL GROUP BY w.w_warehouse_name, w.w_warehouse_sq_ft, w.w_city, w.w_state, ib.ib_lower_bound, ib.ib_upper_bound ORDER BY avg_sales_price DESC, avg_discount_amount DESC;
SELECT d_year, d_quarter_name, sm_type AS shipping_type, COUNT(DISTINCT ss_ticket_number) AS num_sales_transactions, SUM(ss_quantity) AS total_sold_quantity, AVG(ss_sales_price) AS average_sales_price, SUM(ss_net_profit) AS total_sales_net_profit, COUNT(DISTINCT sr_ticket_number) AS num_returns_transactions, SUM(sr_return_quantity) AS total_returned_quantity, AVG(sr_return_amt) AS average_return_amount, SUM(sr_net_loss) AS total_returns_net_loss, AVG(hd_dep_count) AS average_dependency_count, AVG(hd_vehicle_count) AS average_vehicle_count, AVG(ib_lower_bound) AS average_income_lower_bound, AVG(ib_upper_bound) AS average_income_upper_bound FROM store_sales JOIN date_dim ON ss_sold_date_sk = d_date_sk JOIN store_returns ON sr_item_sk = ss_item_sk AND sr_returned_date_sk = ss_sold_date_sk JOIN ship_mode ON sm_ship_mode_sk = ss_sold_date_sk JOIN household_demographics ON ss_hdemo_sk = hd_demo_sk JOIN income_band ON hd_income_band_sk = ib_income_band_sk WHERE d_moy IN (2, 4, 6, 8, 12) AND sm_code IN ('SEA', 'BIKE', 'AIR', 'SURFACE') AND sm_carrier IN ('PRIVATECARRIER', 'DIAMOND') GROUP BY d_year, d_quarter_name, shipping_type ORDER BY d_year, d_quarter_name, shipping_type;
SELECT c.ca_county, COUNT(distinct ws.ws_order_number) AS total_orders, SUM(ws.ws_quantity) AS total_quantity_sold, AVG(ws.ws_sales_price) AS average_sales_price, SUM(ws.ws_net_paid_inc_tax) AS total_revenue_inc_tax, SUM(ws.ws_net_profit) AS total_net_profit FROM web_sales ws JOIN customer_address c ON ws.ws_bill_addr_sk = c.ca_address_sk JOIN web_page wp ON ws.ws_web_page_sk = wp.wp_web_page_sk JOIN store s ON c.ca_state = s.s_state WHERE wp.wp_char_count IN ('5918', '3732', '4894', '2129', '1526') AND c.ca_county IN ('Calloway County', 'Mifflin County', 'Dutchess County', 'Rowan County') AND s.s_number_employees = 297 AND ws.ws_bill_customer_sk IN ('50106', '534', '23933', '77910', '39966') GROUP BY c.ca_county ORDER BY total_revenue_inc_tax DESC, total_net_profit DESC;
SELECT cd.cd_gender, cd.cd_education_status, cd.cd_credit_rating, ib.ib_income_band_sk, sm.sm_type, COUNT(*) AS number_of_sales, SUM(ws.ws_quantity) AS total_quantity_sold, AVG(ws.ws_sales_price) AS average_sales_price, SUM(ws.ws_net_paid) AS total_net_paid, SUM(ws.ws_net_profit) AS total_net_profit, SUM(CASE WHEN ws.ws_sales_price > ws.ws_wholesale_cost THEN 1 ELSE 0 END) AS profitable_sales_count FROM web_sales ws JOIN customer_demographics cd ON ws.ws_bill_cdemo_sk = cd.cd_demo_sk JOIN income_band ib ON cd.cd_purchase_estimate BETWEEN ib.ib_lower_bound AND ib.ib_upper_bound JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk WHERE cd.cd_credit_rating = 'High Risk' AND ib.ib_upper_bound IN (60000, 160000, 180000, 200000) AND sm.sm_ship_mode_id IN ('AAAAAAAAGAAAAAAA', 'AAAAAAAAABAAAAAA', 'AAAAAAAAKAAAAAAA', 'AAAAAAAALAAAAAAA', 'AAAAAAAAJAAAAAAA') GROUP BY cd.cd_gender, cd.cd_education_status, cd.cd_credit_rating, ib.ib_income_band_sk, sm.sm_type ORDER BY total_net_profit DESC, total_net_paid DESC;
SELECT cd.cd_gender, cd.cd_marital_status, cd.cd_credit_rating, AVG(cd.cd_purchase_estimate) AS avg_purchase_estimate, SUM(sr.sr_return_amt_inc_tax) AS total_return_amount_inc_tax, COUNT(sr.sr_ticket_number) AS total_returns FROM customer_demographics cd JOIN store_returns sr ON cd.cd_demo_sk = sr.sr_cdemo_sk JOIN household_demographics hd ON sr.sr_hdemo_sk = hd.hd_demo_sk WHERE hd.hd_buy_potential IN ('5001-10000', '>10000') AND sr.sr_reversed_charge > 50 GROUP BY cd.cd_gender, cd.cd_marital_status, cd.cd_credit_rating HAVING AVG(cd.cd_purchase_estimate) > 500 ORDER BY avg_purchase_estimate DESC, total_return_amount_inc_tax DESC;
SELECT hd.hd_income_band_sk, cd.cd_education_status, AVG(ss.ss_sales_price) AS avg_sales_price, SUM(ss.ss_ext_discount_amt) AS total_discount_amt, COUNT(ss.ss_ticket_number) AS sales_count FROM store_sales ss JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk JOIN household_demographics hd ON ss.ss_hdemo_sk = hd.hd_demo_sk WHERE d.d_year = 2022 AND d.d_weekend = 'Y' AND d.d_holiday = 'N' GROUP BY hd.hd_income_band_sk, cd.cd_education_status ORDER BY hd.hd_income_band_sk, cd.cd_education_status;
SELECT s.s_store_name, i.i_brand, i.i_category, dd.d_year, SUM(s.s_number_employees) AS total_number_employees, AVG(i.i_current_price) AS average_price, COUNT(DISTINCT h.hd_demo_sk) AS unique_household_count, SUM(CASE WHEN dd.d_holiday = 'Y' THEN 1 ELSE 0 END) AS holiday_count, SUM(CASE WHEN dd.d_weekend = 'Y' THEN 1 ELSE 0 END) AS weekend_count FROM store s JOIN item i ON s.s_store_sk = i.i_manufact_id JOIN date_dim dd ON s.s_closed_date_sk = dd.d_date_sk JOIN household_demographics h ON h.hd_income_band_sk = s.s_market_id JOIN time_dim t ON t.t_time_sk = dd.d_date_sk WHERE s.s_store_sk IN (11, 9, 5, 3) AND i.i_item_id IN ('AAAAAAAAGPIAAAAA', 'AAAAAAAAOFKAAAAA', 'AAAAAAAAKJEAAAAA', 'AAAAAAAAMLJAAAAA', 'AAAAAAAANPCBAAAA', 'AAAAAAAAEBGAAAAA') AND i.i_brand_id IN (6004005, 7004007) AND dd.d_current_year = 'N' AND dd.d_last_dom IN (2418367, 2415812, 2418122) AND t.t_hour IN (1, 0) GROUP BY s.s_store_name, i.i_brand, i.i_category, dd.d_year;
SELECT cp.cp_department, i.i_category, i.i_brand, sm.sm_type, COUNT(DISTINCT cp.cp_catalog_page_sk) AS num_catalog_pages, COUNT(DISTINCT i.i_item_sk) AS num_items, AVG(i.i_current_price) AS avg_current_price, SUM(i.i_wholesale_cost) AS total_wholesale_cost, COUNT(DISTINCT t.t_time_sk) AS num_time_records, COUNT(DISTINCT sm.sm_ship_mode_sk) AS num_ship_modes FROM catalog_page cp JOIN item i ON cp.cp_catalog_page_sk = i.i_item_sk JOIN time_dim t ON cp.cp_start_date_sk = t.t_time_sk OR cp.cp_end_date_sk = t.t_time_sk JOIN ship_mode sm ON sm.sm_carrier = i.i_manufact WHERE i.i_category IN ('Shoes', 'Jewelry', 'Sports', 'Home', 'Electronics') GROUP BY cp.cp_department, i.i_category, i.i_brand, sm.sm_type ORDER BY num_catalog_pages DESC, num_items DESC;
SELECT cc.cc_call_center_id, cc.cc_name, cc.cc_city, cc.cc_state, SUM(ss.ss_net_paid) AS total_sales, AVG(ss.ss_ext_discount_amt) AS avg_discount_amount, COUNT(DISTINCT ss.ss_ticket_number) AS total_tickets, COUNT(DISTINCT p.p_promo_sk) AS total_promotions FROM call_center cc JOIN store_sales ss ON cc.cc_call_center_sk = ss.ss_store_sk JOIN promotion p ON ss.ss_promo_sk = p.p_promo_sk WHERE p.p_channel_dmail = 'Y' AND ss.ss_sold_date_sk BETWEEN p.p_start_date_sk AND p.p_end_date_sk GROUP BY cc.cc_call_center_id, cc.cc_name, cc.cc_city, cc.cc_state ORDER BY total_sales DESC, avg_discount_amount DESC;
SELECT hd.hd_income_band_sk, COUNT(DISTINCT ss.ss_customer_sk) AS num_customers, SUM(ss.ss_quantity) AS total_quantity_sold, AVG(ss.ss_sales_price) AS avg_sales_price, SUM(ss.ss_net_paid) AS total_net_paid, SUM(ss.ss_net_profit) AS total_net_profit FROM store_sales ss JOIN household_demographics hd ON ss.ss_hdemo_sk = hd.hd_demo_sk JOIN income_band ib ON hd.hd_income_band_sk = ib.ib_income_band_sk JOIN promotion p ON ss.ss_promo_sk = p.p_promo_sk JOIN time_dim t ON ss.ss_sold_time_sk = t.t_time_sk WHERE hd.hd_income_band_sk IN (18, 2) AND t.t_hour BETWEEN 8 AND 17 GROUP BY hd.hd_income_band_sk ORDER BY total_net_profit DESC;
SELECT cc_state, SUM(sr_return_amt) AS total_return_amt, AVG(sr_return_amt) AS avg_return_amt, COUNT(*) AS num_returns, SUM(ss_net_profit) AS total_net_profit, AVG(ss_net_profit) AS avg_net_profit, COUNT(DISTINCT ss_customer_sk) AS unique_customers, SUM(wr_return_ship_cost) AS total_return_ship_cost, AVG(wr_return_ship_cost) AS avg_return_ship_cost, COUNT(DISTINCT wr_refunded_customer_sk) AS unique_returned_customers FROM call_center JOIN store_returns ON sr_store_sk = cc_call_center_sk JOIN store_sales ON ss_store_sk = cc_call_center_sk AND store_returns.sr_ticket_number = store_sales.ss_ticket_number JOIN web_returns ON wr_returning_addr_sk = sr_addr_sk WHERE cc_rec_start_date <= CURRENT_DATE AND (cc_rec_end_date IS NULL OR cc_rec_end_date > CURRENT_DATE) AND sr_hdemo_sk IN ('1110', '6655', '2958', '2489', '5750', '5814') AND sr_return_quantity = 36 AND wr_return_ship_cost IN ('460.94', '104.34', '381.68', '830.90') AND wr_returned_time_sk IN ('77442', '66455', '78336', '60895', '70221') AND ss_coupon_amt IN ('1615.93', '743.42') AND ss_net_profit IN ('-1410.96', '-564.39', '-55.72') GROUP BY cc_state ORDER BY total_return_amt DESC;
SELECT ca_state, ca_country, AVG(wp_char_count) AS average_character_count, SUM(wp_link_count) AS total_link_count, COUNT(wp_web_page_sk) AS total_pages, AVG(ib_lower_bound) AS average_income_lower_bound, AVG(ib_upper_bound) AS average_income_upper_bound, COUNT(DISTINCT ib_income_band_sk) AS distinct_income_band_count FROM web_page JOIN customer_address ON wp_customer_sk = ca_address_sk JOIN income_band ON ca_address_id::integer = ib_income_band_sk WHERE wp_type = 'product' AND ca_country = 'United States' AND ib_lower_bound >= 70001 AND (ib_income_band_sk IN (3, 8, 1, 10, 13, 9) OR wp_autogen_flag = 'Y') GROUP BY ca_state, ca_country ORDER BY ca_state, ca_country;
SELECT ib.ib_income_band_sk, ib.ib_lower_bound, ib.ib_upper_bound, td.t_am_pm, AVG(ws.ws_sales_price) AS avg_sales_price, SUM(ws.ws_quantity) AS total_sales_quantity, SUM(wr.wr_return_quantity) AS total_return_quantity, SUM(wr.wr_net_loss) AS total_net_loss FROM web_sales ws JOIN household_demographics hd ON ws.ws_bill_hdemo_sk = hd.hd_demo_sk JOIN income_band ib ON hd.hd_income_band_sk = ib.ib_income_band_sk JOIN time_dim td ON ws.ws_sold_time_sk = td.t_time_sk LEFT JOIN web_returns wr ON ws.ws_order_number = wr.wr_order_number AND td.t_time_sk = wr.wr_returned_time_sk WHERE td.t_am_pm = 'AM' GROUP BY ib.ib_income_band_sk, ib.ib_lower_bound, ib.ib_upper_bound, td.t_am_pm ORDER BY ib.ib_income_band_sk, td.t_am_pm;
SELECT i.i_category AS item_category, COUNT(DISTINCT i.i_item_sk) AS unique_items_sold, SUM(ws.ws_quantity) AS total_quantity_sold, SUM(ws.ws_net_paid) AS total_sales, AVG(ws.ws_sales_price) AS average_sales_price, AVG(ws.ws_net_profit) AS average_net_profit FROM item i JOIN web_sales ws ON i.i_item_sk = ws.ws_item_sk JOIN inventory inv ON ws.ws_item_sk = inv.inv_item_sk WHERE i.i_current_price > 50 AND inv.inv_warehouse_sk IN (1, 2) AND ws.ws_ship_date_sk IN (2452335, 2452146, 2450987, 2452543) GROUP BY i.i_category ORDER BY total_sales DESC;
SELECT ca.ca_city, ca.ca_county, AVG(hd.hd_income_band_sk) AS avg_income_band, AVG(hd.hd_vehicle_count) AS avg_vehicle_count, COUNT(DISTINCT wp.wp_web_page_sk) AS num_web_pages_created, COUNT(DISTINCT wp.wp_access_date_sk) AS num_web_pages_accessed, AVG(wp.wp_char_count) AS avg_web_page_char_count FROM customer_address ca JOIN household_demographics hd ON ca.ca_address_sk = hd.hd_demo_sk LEFT JOIN web_page wp ON ca.ca_address_sk = wp.wp_customer_sk WHERE ca.ca_city IN ('Morgantown', 'Forestville', 'Sutton', 'Mount Olive', 'Texas', 'Bridgeport') AND ca.ca_county IN ('Carlton County', 'Bonneville County') AND wp.wp_type IN ('blog', 'article', 'product_review') AND wp.wp_autogen_flag = 'N' GROUP BY ca.ca_city, ca.ca_county ORDER BY ca.ca_city, ca.ca_county;
SELECT ws.web_class, ws.web_market_manager, SUM(cs.cs_quantity) AS total_quantity_sold, AVG(cs.cs_sales_price) AS average_sales_price, COUNT(DISTINCT cs.cs_order_number) AS number_of_orders, SUM(wr.wr_return_quantity) AS total_quantity_returned, SUM(wr.wr_net_loss) AS total_net_loss FROM catalog_sales cs JOIN web_returns wr ON cs.cs_item_sk = wr.wr_item_sk AND cs.cs_order_number = wr.wr_order_number JOIN web_site ws ON cs.cs_warehouse_sk = ws.web_site_sk WHERE cs.cs_sold_date_sk IS NOT NULL AND wr.wr_returned_date_sk IS NOT NULL AND ws.web_close_date_sk IN ('2447080', '2447148', '2448752', '2448854', '2448956', '2448820') AND ws.web_mkt_desc IN ('Concerned, royal weeks should announce.', 'Companies grow cells. Apart true eyes u', 'Formerly long minds deal aside parties. Lef', 'Political affairs ought to') GROUP BY ws.web_class, ws.web_market_manager ORDER BY total_quantity_sold DESC, total_net_loss ASC;
