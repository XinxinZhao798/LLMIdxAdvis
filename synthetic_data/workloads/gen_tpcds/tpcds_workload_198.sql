SELECT cc_state, cc_city, ca_country, COUNT(DISTINCT cc_call_center_sk) AS number_of_call_centers, SUM(cc_employees) AS total_employees, AVG(cc_tax_percentage) AS avg_tax_percentage, SUM(s_number_employees) AS total_store_employees, AVG(s_tax_precentage) AS avg_store_tax, SUM(ws_quantity) AS total_items_sold, SUM(ws_net_paid) AS total_revenue, SUM(ws_net_profit) AS total_profit, AVG(ws_net_profit) AS avg_profit_per_sale, SUM(ws_ext_ship_cost) AS total_shipping_cost FROM call_center JOIN store ON cc_zip = s_zip JOIN web_sales ON ws_ship_addr_sk IN (SELECT ca_address_sk FROM customer_address WHERE ca_zip = cc_zip) JOIN customer_address ON cc_zip = ca_zip WHERE cc_hours IN ('8AM-4PM', '8AM-8AM') AND ws_net_profit NOT IN (-1167.89, -63.88, -192.70, -49.59) AND ca_country = 'United States' AND ca_gmt_offset IN (-8.00, -9.00) GROUP BY cc_state, cc_city, ca_country ORDER BY total_profit DESC;
SELECT i.i_category AS item_category, i.i_brand AS item_brand, r.r_reason_desc AS return_reason, SUM(cr.cr_return_amount) AS total_return_amount, AVG(cr.cr_return_amount) AS avg_return_amount, COUNT(*) AS return_count FROM catalog_returns cr JOIN item i ON cr.cr_item_sk = i.i_item_sk JOIN reason r ON cr.cr_reason_sk = r.r_reason_sk GROUP BY i.i_category, i.i_brand, r.r_reason_desc ORDER BY total_return_amount DESC, avg_return_amount DESC, return_count DESC;
SELECT s.s_store_name, i.i_category, r.r_reason_desc, COUNT(DISTINCT wr_order_number) AS total_returns, SUM(wr_return_quantity) AS total_returned_quantity, AVG(wr_return_amt) AS avg_return_amount, AVG(wr_return_ship_cost) AS avg_shipping_cost, SUM(wr_net_loss) AS total_net_loss FROM web_returns wr JOIN store s ON s.s_store_sk = wr.wr_refunded_addr_sk JOIN item i ON i.i_item_sk = wr.wr_item_sk JOIN reason r ON r.r_reason_sk = wr.wr_reason_sk WHERE s.s_market_id = 7 AND s.s_rec_start_date IN ('2001-03-13', '1997-03-13') AND i.i_manager_id = 52 AND wr.wr_reason_sk = 13 GROUP BY ROLLUP(s.s_store_name, i.i_category, r.r_reason_desc) ORDER BY s.s_store_name, i.i_category, r.r_reason_desc;
SELECT ca_state, r_reason_desc, COUNT(*) AS return_count, SUM(sr_return_amt) AS total_return_amount, AVG(sr_return_quantity) AS average_quantity_returned, SUM(sr_return_amt_inc_tax) AS total_amount_including_tax, SUM(sr_fee) AS total_fees, SUM(sr_return_ship_cost) AS total_shipping_costs, SUM(sr_refunded_cash) AS total_cash_refunded, SUM(sr_reversed_charge) AS total_reversed_charges, SUM(sr_store_credit) AS total_store_credit_issued, SUM(sr_net_loss) AS total_net_loss FROM store_returns JOIN reason ON store_returns.sr_reason_sk = reason.r_reason_sk JOIN customer_address ON store_returns.sr_addr_sk = customer_address.ca_address_sk WHERE (sr_reason_sk IN (13, 15, 26, 31, 21, 27)) AND (sr_reversed_charge IN (269.66, 29.95, 131.41, 123.32, 10.07, 1.54)) AND (sr_item_sk IN (6759, 10097, 13141, 10841, 4022)) GROUP BY ca_state, r_reason_desc ORDER BY ca_state, total_return_amount DESC;
SELECT d_year, web_country, SUM(ws_net_paid_inc_ship_tax) AS total_revenue, AVG(ws_net_paid_inc_ship_tax) AS avg_order_value, COUNT(DISTINCT ws_order_number) AS total_orders, SUM(ws_quantity) AS total_units_sold, SUM(ws_ext_wholesale_cost) AS total_cost, (SUM(ws_net_paid_inc_ship_tax) - SUM(ws_ext_wholesale_cost)) AS total_profit FROM web_sales JOIN web_site ON ws_web_site_sk = web_site_sk JOIN date_dim ON ws_sold_date_sk = d_date_sk WHERE web_country = 'United States' AND d_year = 2001 GROUP BY d_year, web_country ORDER BY total_revenue DESC;
