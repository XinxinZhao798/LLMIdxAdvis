SELECT w.w_warehouse_name, w.w_warehouse_sq_ft, w.w_city, w.w_state, ib.ib_lower_bound, ib.ib_upper_bound, AVG(cs.cs_sales_price) AS avg_sales_price, AVG(cs.cs_ext_discount_amt) AS avg_discount_amount, SUM(cs.cs_quantity) AS total_quantity_sold, COUNT(DISTINCT cs.cs_order_number) AS total_orders, COUNT(DISTINCT p.p_promo_sk) AS total_promotions_applied FROM catalog_sales cs JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk JOIN warehouse w ON cs.cs_warehouse_sk = w.w_warehouse_sk JOIN promotion p ON cs.cs_promo_sk = p.p_promo_sk JOIN income_band ib ON cs.cs_bill_customer_sk = ib.ib_income_band_sk WHERE d.d_year = 2021 AND w.w_county = 'Williamson County' AND p.p_discount_active = 'Y' AND p.p_response_target > 50 AND cs.cs_sales_price IS NOT NULL AND cs.cs_ext_discount_amt IS NOT NULL GROUP BY w.w_warehouse_name, w.w_warehouse_sq_ft, w.w_city, w.w_state, ib.ib_lower_bound, ib.ib_upper_bound ORDER BY avg_sales_price DESC, avg_discount_amount DESC;
SELECT p.p_promo_name, p.p_start_date_sk, p.p_end_date_sk, SUM(cs.cs_net_paid) AS total_sales, AVG(cs.cs_sales_price) AS average_sales_price, COUNT(DISTINCT cs.cs_order_number) AS order_count, SUM(inv.inv_quantity_on_hand) AS total_inventory_quantity FROM catalog_sales cs JOIN promotion p ON cs.cs_promo_sk = p.p_promo_sk JOIN inventory inv ON cs.cs_item_sk = inv.inv_item_sk JOIN web_site ws ON cs.cs_warehouse_sk = ws.web_site_sk WHERE inv.inv_quantity_on_hand >= 500 AND ws.web_mkt_class = 'Well-known, patient proposals m' AND p.p_purpose <> 'Unknown' AND ws.web_site_id IN ('AAAAAAAAJBAAAAAA', 'AAAAAAAACAAAAAAA') GROUP BY p.p_promo_name, p.p_start_date_sk, p.p_end_date_sk ORDER BY total_sales DESC, average_sales_price DESC;
SELECT d_year, d_qoy, hd_income_band_sk, COUNT(DISTINCT ss_customer_sk) AS total_customers, SUM(ss_quantity) AS total_quantity_sold, AVG(ss_sales_price) AS avg_sales_price, SUM(ss_net_paid_inc_tax) AS total_revenue, AVG(ws_wholesale_cost) AS avg_wholesale_cost, SUM(ws_net_profit) AS total_web_profit, COUNT(DISTINCT ws_order_number) AS total_web_orders, SUM(wr_return_quantity) AS total_return_quantity, SUM(wr_return_amt_inc_tax) AS total_return_amount FROM date_dim JOIN store_sales ON ss_sold_date_sk = d_date_sk JOIN web_sales ON ws_sold_date_sk = d_date_sk JOIN web_returns ON wr_returned_date_sk = d_date_sk AND ws_item_sk = wr_item_sk JOIN household_demographics ON (ss_hdemo_sk = hd_demo_sk OR ws_ship_hdemo_sk = hd_demo_sk OR wr_returning_hdemo_sk = hd_demo_sk) WHERE d_year = 1999 AND hd_income_band_sk IN (8, 9, 10) AND ss_addr_sk IN (43285, 30010, 21588) AND ss_net_paid_inc_tax > 5000 AND wr_refunded_cdemo_sk IN ('55573', '303149', '71175') AND wr_return_tax IN (12.36, 35.06, 21.54, 6.11, 363.36, 106.37) GROUP BY d_year, d_qoy, hd_income_band_sk ORDER BY total_revenue DESC, total_web_profit DESC;
SELECT r.r_reason_desc AS reason_for_return, w.w_state AS warehouse_state, COUNT(wr.wr_order_number) AS number_of_returns, AVG(wr.wr_return_amt_inc_tax) AS average_return_amount_inc_tax, SUM(wr.wr_return_tax) AS total_return_tax, AVG(wr.wr_net_loss) AS average_net_loss FROM web_returns wr JOIN reason r ON wr.wr_reason_sk = r.r_reason_sk JOIN warehouse w ON wr.wr_returning_addr_sk = w.w_warehouse_sk WHERE r.r_reason_desc IN ('reason 33', 'it is a girl', 'Lost my job', 'Found a better extended warranty in a store') AND w.w_warehouse_name IN ('Important issues liv', 'Bad cards must make.', 'Conventional childr', 'Doors canno') AND wr.wr_return_amt_inc_tax > 0 GROUP BY reason_for_return, warehouse_state ORDER BY number_of_returns DESC, average_return_amount_inc_tax DESC;
SELECT cc.cc_call_center_id, cc.cc_name, cc.cc_city, cc.cc_state, SUM(ss.ss_net_paid) AS total_sales, AVG(ss.ss_ext_discount_amt) AS avg_discount_amount, COUNT(DISTINCT ss.ss_ticket_number) AS total_tickets, COUNT(DISTINCT p.p_promo_sk) AS total_promotions FROM call_center cc JOIN store_sales ss ON cc.cc_call_center_sk = ss.ss_store_sk JOIN promotion p ON ss.ss_promo_sk = p.p_promo_sk WHERE p.p_channel_dmail = 'Y' AND ss.ss_sold_date_sk BETWEEN p.p_start_date_sk AND p.p_end_date_sk GROUP BY cc.cc_call_center_id, cc.cc_name, cc.cc_city, cc.cc_state ORDER BY total_sales DESC, avg_discount_amount DESC;
