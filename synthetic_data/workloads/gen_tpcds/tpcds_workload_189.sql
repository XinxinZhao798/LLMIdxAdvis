SELECT cc.cc_city, i.i_category, COUNT(DISTINCT cc.cc_call_center_sk) AS total_call_centers, SUM(cc.cc_employees) AS total_employees, AVG(cc.cc_sq_ft) AS avg_square_footage, COUNT(DISTINCT i.i_item_sk) AS total_items, AVG(i.i_current_price) AS avg_item_price, MIN(ib.ib_lower_bound) AS min_income_band_lower_bound, MAX(ib.ib_upper_bound) AS max_income_band_upper_bound, AVG(cc.cc_tax_percentage) AS avg_tax_percentage FROM call_center cc JOIN item i ON cc.cc_division = i.i_manufact_id JOIN income_band ib ON ib.ib_income_band_sk = cc.cc_mkt_id WHERE cc.cc_street_type IN ('Boulevard', 'RD', 'Way') AND i.i_units IN ('Dram', 'Ounce', 'Gram') AND ib.ib_income_band_sk IN (3, 5, 7, 8) AND cc.cc_tax_percentage BETWEEN 0.01 AND 0.12 GROUP BY cc.cc_city, i.i_category ORDER BY total_call_centers DESC, avg_item_price ASC LIMIT 10;
SELECT r.r_reason_desc, i.i_item_id, i.i_category, p.p_promo_name, AVG(wr.wr_return_amt_inc_tax) AS avg_return_amount_inc_tax, SUM(wr.wr_net_loss) AS total_net_loss, COUNT(*) AS num_of_returns FROM web_returns wr JOIN reason r ON wr.wr_reason_sk = r.r_reason_sk JOIN item i ON wr.wr_item_sk = i.i_item_sk JOIN promotion p ON p.p_item_sk = i.i_item_sk JOIN call_center cc ON cc.cc_call_center_sk = wr.wr_refunded_addr_sk WHERE i.i_current_price > 100.00 AND cc.cc_gmt_offset = -5.00 GROUP BY r.r_reason_desc, i.i_item_id, i.i_category, p.p_promo_name ORDER BY total_net_loss DESC, avg_return_amount_inc_tax DESC;
SELECT cc.cc_name, cc.cc_city, cc.cc_state, SUM(ss.ss_quantity) AS total_quantity_sold, AVG(ss.ss_sales_price) AS average_sales_price, COUNT(DISTINCT ss.ss_ticket_number) AS number_of_sales_transactions, SUM(wr.wr_return_quantity) AS total_quantity_returned, AVG(wr.wr_return_amt) AS average_return_amount, COUNT(DISTINCT wr.wr_order_number) AS number_of_return_transactions FROM call_center cc JOIN store_sales ss ON cc.cc_call_center_sk = ss.ss_store_sk JOIN web_returns wr ON ss.ss_item_sk = wr.wr_item_sk AND ss.ss_ticket_number = wr.wr_order_number WHERE cc.cc_mkt_class IN ('Silly particles could pro', 'Dealers make most historical, direct students', 'Wrong troops shall work sometimes in a opti', 'A bit narrow forms matter animals. Consist', 'More than other authori') AND cc.cc_sq_ft IN (795, 4134, 3514) AND wr.wr_refunded_addr_sk IN ('15506', '16033', '22303') AND ss.ss_item_sk IN (5893, 944) AND ss.ss_ticket_number IN (3473, 3634, 3530) GROUP BY cc.cc_name, cc.cc_city, cc.cc_state ORDER BY total_quantity_sold DESC, total_quantity_returned DESC;
SELECT s.s_store_name, s.s_city, s.s_state, i.i_category, i.i_brand, SUM(inv.inv_quantity_on_hand) AS total_inventory, AVG(i.i_current_price) AS average_price, COUNT(DISTINCT c.c_customer_sk) AS unique_customers, SUM(CASE WHEN c.c_preferred_cust_flag = 'Y' THEN 1 ELSE 0 END) AS preferred_customers_count FROM store s JOIN inventory inv ON s.s_store_sk = inv.inv_warehouse_sk JOIN item i ON inv.inv_item_sk = i.i_item_sk JOIN customer c ON s.s_store_sk = c.c_current_addr_sk WHERE s.s_state IN ('CA', 'TX', 'NY') AND c.c_last_review_date_sk BETWEEN 2452306 AND 2452404 AND i.i_rec_start_date <= CURRENT_DATE AND (i.i_rec_end_date IS NULL OR i.i_rec_end_date > CURRENT_DATE) GROUP BY s.s_store_name, s.s_city, s.s_state, i.i_category, i.i_brand ORDER BY total_inventory DESC, s.s_store_name, i.i_category, i.i_brand;
SELECT cc.cc_division_name, ib.ib_upper_bound, SUM(ss.ss_quantity) AS total_quantity_sold, SUM(ss.ss_net_paid) AS total_net_paid, AVG(ss.ss_net_profit) AS average_net_profit, COUNT(DISTINCT ss.ss_store_sk) AS number_of_stores, COUNT(DISTINCT cs.cs_call_center_sk) AS number_of_call_centers, COUNT(DISTINCT hd.hd_demo_sk) AS number_of_household_demographics, SUM(CASE WHEN cr.cr_return_amount > 0 THEN 1 ELSE 0 END) AS total_returns, SUM(cr.cr_return_amount) AS total_return_amount, AVG(cr.cr_fee) AS average_return_fee FROM store_sales ss JOIN store s ON ss.ss_store_sk = s.s_store_sk JOIN call_center cc ON s.s_store_sk = cc.cc_call_center_sk JOIN household_demographics hd ON ss.ss_hdemo_sk = hd.hd_demo_sk JOIN income_band ib ON hd.hd_income_band_sk = ib.ib_income_band_sk LEFT JOIN catalog_sales cs ON ss.ss_ticket_number = cs.cs_order_number LEFT JOIN catalog_returns cr ON cs.cs_order_number = cr.cr_order_number WHERE ss.ss_sold_date_sk IN (2451072, 2451839, 2451935, 2451452, 2451580, 2451465) AND cc.cc_division_name IN ('anti', 'ought', 'pri', 'ese') AND ib.ib_upper_bound IN (150000, 60000, 190000, 70000, 170000, 30000) GROUP BY cc.cc_division_name, ib.ib_upper_bound ORDER BY total_net_paid DESC, average_net_profit DESC;
SELECT ca.ca_state, COUNT(DISTINCT c.c_customer_sk) AS total_customers, SUM(sr.sr_return_amt) AS total_return_amount, AVG(sr.sr_return_amt) AS average_return_amount, SUM(sr.sr_return_quantity) AS total_return_quantity, COUNT(DISTINCT sr.sr_ticket_number) AS total_returns, COUNT(DISTINCT CASE WHEN c.c_preferred_cust_flag = 'Y' THEN sr.sr_ticket_number ELSE NULL END) AS preferred_customer_returns FROM store_returns sr JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk WHERE sr.sr_return_tax BETWEEN 5 AND 130 AND c.c_last_review_date_sk IN (2452499, 2452496, 2452479, 2452342) AND sr.sr_item_sk IN (13538, 16733, 1766, 2599, 3017, 9220) GROUP BY ca.ca_state ORDER BY total_return_amount DESC;
