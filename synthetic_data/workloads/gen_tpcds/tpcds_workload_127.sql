SELECT cc.cc_name, i.i_category, SUM(ss.ss_quantity) AS total_quantity, AVG(ss.ss_sales_price) AS avg_sales_price, COUNT(DISTINCT ss.ss_ticket_number) AS number_of_sales, SUM(ss.ss_net_paid) AS total_net_paid, SUM(ss.ss_net_paid_inc_tax) AS total_net_paid_inc_tax, SUM(ss.ss_net_profit) AS total_net_profit FROM store_sales ss JOIN item i ON ss.ss_item_sk = i.i_item_sk JOIN call_center cc ON cc.cc_division = i.i_class_id JOIN warehouse w ON w.w_warehouse_sk = cc.cc_division WHERE cc.cc_call_center_sk IN ('5', '3', '1') AND cc.cc_division IN ('1', '4', '5', '3') AND w.w_warehouse_sk IN ('3', '5', '1', '4', '2') AND ss.ss_net_paid_inc_tax = '3682.66' GROUP BY cc.cc_name, i.i_category ORDER BY total_net_paid DESC, avg_sales_price DESC;
SELECT dd.d_year, dd.d_qoy, cc.cc_name, COUNT(DISTINCT cs_order_number) AS total_orders, SUM(cs_quantity) AS total_quantity, AVG(cs_sales_price) AS average_sales_price, SUM(cs_net_paid) AS total_net_paid, SUM(cs_net_paid_inc_tax) AS total_net_paid_inc_tax, SUM(cs_net_paid_inc_ship) AS total_net_paid_inc_ship, SUM(cs_net_paid_inc_ship_tax) AS total_net_paid_inc_ship_tax, SUM(cs_net_profit) AS total_net_profit FROM catalog_sales cs JOIN call_center cc ON cs.cs_call_center_sk = cc.cc_call_center_sk JOIN date_dim dd ON cs.cs_sold_date_sk = dd.d_date_sk WHERE cc.cc_name = 'North Midwest' AND dd.d_year = 2003 GROUP BY dd.d_year, dd.d_qoy, cc.cc_name ORDER BY dd.d_year, dd.d_qoy, cc.cc_name;
SELECT s_state AS state, AVG(ws_sales_price) AS avg_web_sales_price, SUM(ws_quantity) AS total_web_sales_quantity, COUNT(DISTINCT s_store_sk) AS num_stores, COUNT(DISTINCT w_warehouse_sk) AS num_warehouses FROM web_sales JOIN store ON web_sales.ws_ship_addr_sk = store.s_store_sk JOIN warehouse ON web_sales.ws_warehouse_sk = warehouse.w_warehouse_sk GROUP BY state ORDER BY state;
SELECT d_year, c_preferred_cust_flag, cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, SUM(cr_return_amount) AS total_return_amount, AVG(cr_return_quantity) AS avg_return_quantity, COUNT(DISTINCT cr_order_number) AS total_returns, COUNT(DISTINCT cr_returning_customer_sk) AS distinct_returning_customers FROM catalog_returns JOIN date_dim ON catalog_returns.cr_returned_date_sk = date_dim.d_date_sk JOIN customer ON catalog_returns.cr_returning_customer_sk = customer.c_customer_sk JOIN customer_demographics ON customer.c_current_cdemo_sk = customer_demographics.cd_demo_sk WHERE d_year = 2003 AND cd_dep_count IN ('1', '2') AND c_birth_day IN (6, 20) AND cr_warehouse_sk IN (1, 2, 4) AND c_current_addr_sk IN (28702, 39227, 11533, 21702) GROUP BY d_year, c_preferred_cust_flag, cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate ORDER BY total_return_amount DESC, avg_return_quantity DESC, total_returns DESC, distinct_returning_customers DESC;
SELECT hd.hd_demo_sk, COUNT(DISTINCT sr.sr_ticket_number) AS total_store_returns, COUNT(DISTINCT wr.wr_order_number) AS total_web_returns, SUM(sr.sr_return_amt) AS total_store_return_amount, AVG(sr.sr_return_amt) AS avg_store_return_amount, SUM(wr.wr_return_amt) AS total_web_return_amount, AVG(wr.wr_return_amt) AS avg_web_return_amount, SUM(CASE WHEN p.p_channel_radio = 'N' AND p.p_channel_demo = 'N' THEN p.p_cost ELSE 0 END) AS non_radio_demo_promo_cost, AVG(CASE WHEN p.p_channel_radio = 'N' AND p.p_channel_demo = 'N' THEN p.p_response_target ELSE NULL END) AS avg_non_radio_demo_response_target FROM household_demographics hd LEFT JOIN store_returns sr ON hd.hd_demo_sk = sr.sr_hdemo_sk LEFT JOIN web_returns wr ON (hd.hd_demo_sk = wr.wr_refunded_hdemo_sk OR hd.hd_demo_sk = wr.wr_returning_hdemo_sk) LEFT JOIN promotion p ON p.p_promo_sk = sr.sr_reason_sk WHERE hd.hd_demo_sk IN (560, 4858) AND (sr.sr_store_sk IN (8, 10) OR sr.sr_store_sk IS NULL) GROUP BY hd.hd_demo_sk ORDER BY hd.hd_demo_sk;
SELECT c.c_customer_id, ca.ca_state, i.i_category, i.i_brand, SUM(i.i_current_price) AS total_revenue, AVG(i.i_wholesale_cost) AS average_wholesale_cost, COUNT(DISTINCT w.w_warehouse_sk) AS number_of_warehouses, COUNT(DISTINCT wp.wp_web_page_sk) AS number_of_web_pages FROM customer AS c JOIN customer_address AS ca ON c.c_current_addr_sk = ca.ca_address_sk JOIN item AS i ON i.i_manufact_id = c.c_customer_sk LEFT JOIN warehouse AS w ON w.w_state = ca.ca_state LEFT JOIN web_page AS wp ON wp.wp_customer_sk = c.c_customer_sk WHERE i.i_brand = 'amalgunivamalg #14' AND i.i_product_name IN ('eingprioughtable', 'eingationese', 'n stoughtation', 'antiationese', 'n stableeseese', 'anticallycally') AND ca.ca_country = 'United States' AND w.w_country = ca.ca_country GROUP BY c.c_customer_id, ca.ca_state, i.i_category, i.i_brand ORDER BY total_revenue DESC;
SELECT c.c_first_name, c.c_last_name, sm.sm_type AS shipping_type, COUNT(ss.ss_ticket_number) AS total_sales_transactions, SUM(ss.ss_quantity) AS total_quantity_sold, AVG(ss.ss_sales_price) AS average_sales_price, SUM(ss.ss_net_profit) AS total_net_profit, SUM(sr.sr_return_quantity) AS total_returned_quantity, AVG(sr.sr_return_amt) AS average_return_amount, SUM(wr.wr_return_quantity) AS total_web_returned_quantity, AVG(wr.wr_return_amt) AS average_web_return_amount, COUNT(DISTINCT p.p_promo_sk) AS number_of_promotions, SUM(ws.ws_quantity) AS total_web_quantity_sold, AVG(ws.ws_sales_price) AS average_web_sales_price, SUM(ws.ws_net_profit) AS total_web_net_profit FROM customer c LEFT JOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk LEFT JOIN store_returns sr ON c.c_customer_sk = sr.sr_customer_sk LEFT JOIN web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk LEFT JOIN web_returns wr ON c.c_customer_sk = wr.wr_refunded_customer_sk LEFT JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk LEFT JOIN promotion p ON ss.ss_promo_sk = p.p_promo_sk OR ws.ws_promo_sk = p.p_promo_sk WHERE c.c_first_sales_date_sk IN (2450046, 2449304, 2451981, 2451206, 2449744) AND sm.sm_code IN ('SEA', 'BIKE', 'AIR', 'SURFACE') GROUP BY c.c_first_name, c.c_last_name, sm.sm_type ORDER BY total_net_profit DESC, total_web_net_profit DESC LIMIT 100;
SELECT s.s_store_name, s.s_city, s.s_manager, COUNT(DISTINCT sm.sm_ship_mode_sk) AS distinct_shipping_modes, SUM(s.s_floor_space) AS total_floor_space, AVG(s.s_number_employees) AS average_number_of_employees, SUM(s.s_tax_precentage) AS total_tax_percentage, COUNT(*) AS count_of_stores FROM store s LEFT JOIN ship_mode sm ON s.s_store_sk = sm.sm_ship_mode_sk LEFT JOIN reason r ON r.r_reason_sk = s.s_closed_date_sk WHERE s.s_manager IN ('Scott Smith', 'William Ward') AND s.s_city IN ('Fairview', 'Midway') AND r.r_reason_id IN ('AAAAAAAAOBAAAAAA', 'AAAAAAAAMBAAAAAA', 'AAAAAAAAGAAAAAAA', 'AAAAAAAAJBAAAAAA') AND sm.sm_type IN ('NEXT DAY', 'TWO DAY', 'LIBRARY', 'EXPRESS', 'REGULAR', 'OVERNIGHT') GROUP BY s.s_store_name, s.s_city, s.s_manager ORDER BY s.s_city, s.s_store_name;
SELECT dd.d_year, dd.d_quarter_name, sm.sm_type, ca.ca_state, COUNT(DISTINCT cp.cp_catalog_page_sk) AS total_catalog_pages, SUM(CASE WHEN ca.ca_location_type = 'single family' THEN 1 ELSE 0 END) AS single_family_count, SUM(CASE WHEN ca.ca_location_type = 'apartment' THEN 1 ELSE 0 END) AS apartment_count, SUM(CASE WHEN ca.ca_location_type = 'condo' THEN 1 ELSE 0 END) AS condo_count, AVG(ca.ca_gmt_offset) AS avg_gmt_offset FROM catalog_page cp JOIN date_dim dd ON cp.cp_start_date_sk = dd.d_date_sk OR cp.cp_end_date_sk = dd.d_date_sk JOIN customer_address ca ON cp.cp_catalog_page_sk = ca.ca_address_sk JOIN ship_mode sm ON sm.sm_ship_mode_sk = dd.d_date_sk WHERE dd.d_year = 2023 GROUP BY dd.d_year, dd.d_quarter_name, sm.sm_type, ca.ca_state ORDER BY dd.d_year, dd.d_quarter_name, sm.sm_type, ca.ca_state;
SELECT d_year, d_quarter_name, SUM(cs_quantity) AS total_quantity_sold, AVG(cs_sales_price) AS average_sales_price, COUNT(DISTINCT cs_order_number) AS total_orders, COUNT(DISTINCT c_customer_sk) AS total_customers, SUM(cs_net_profit) AS total_net_profit FROM catalog_sales JOIN date_dim ON (cs_sold_date_sk = d_date_sk) JOIN customer ON (cs_bill_customer_sk = c_customer_sk) JOIN time_dim ON (cs_sold_time_sk = t_time_sk) JOIN inventory ON (cs_item_sk = inv_item_sk AND cs_sold_date_sk = inv_date_sk) JOIN income_band ON (c_current_cdemo_sk BETWEEN ib_lower_bound AND ib_upper_bound) WHERE d_current_quarter = 'N' AND d_current_week = 'N' AND t_minute IN ('54', '2', '7', '14', '21', '15') AND inv_warehouse_sk IN ('1', '2') AND inv_item_sk IN ('12016', '13675', '10315', '13106', '14791') AND ib_upper_bound IN ('30000', '20000', '170000', '180000', '70000', '60000') AND ib_lower_bound IN ('160001', '110001', '130001', '180001', '120001', '40001') GROUP BY d_year, d_quarter_name ORDER BY d_year, d_quarter_name;
SELECT ib.ib_income_band_sk, ib.ib_lower_bound, ib.ib_upper_bound, COUNT(DISTINCT cs.cs_order_number) AS total_orders, SUM(cs.cs_net_paid_inc_ship) AS total_revenue_inc_ship, AVG(cs.cs_net_paid_inc_tax) AS avg_revenue_inc_tax, wp.wp_type, COUNT(wp.wp_web_page_sk) AS page_count, SUM(wp.wp_image_count) AS total_image_count, r.r_reason_desc, COUNT(r.r_reason_sk) AS reason_count FROM catalog_sales cs JOIN income_band ib ON cs.cs_bill_hdemo_sk = ib.ib_income_band_sk JOIN web_page wp ON cs.cs_catalog_page_sk = wp.wp_web_page_sk LEFT JOIN reason r ON cs.cs_ship_mode_sk = r.r_reason_sk WHERE cs.cs_ship_cdemo_sk IN ('895212', '186278', '897167') AND cs.cs_net_paid_inc_ship IN (3933.80, 801.00, 5246.97) AND cs.cs_net_paid_inc_tax IN (103.42, 7068.42, 500.16) AND cs.cs_sold_date_sk IN (2450829, 2450822, 2450816) AND r.r_reason_desc IN ('Wrong size', 'No service location in my area', 'Lost my job') AND r.r_reason_id IN ('AAAAAAAANAAAAAAA', 'AAAAAAAAOAAAAAAA', 'AAAAAAAACCAAAAAA') AND r.r_reason_sk IN (11, 14, 19) AND wp.wp_autogen_flag IN ('N', 'Y') AND wp.wp_type IN ('ad', 'order', 'dynamic') AND wp.wp_image_count IN (1, 3, 6) AND wp.wp_web_page_sk IN (44, 58, 40) AND ib.ib_upper_bound IN (70000, 200000, 140000) AND ib.ib_income_band_sk IN (10, 15, 2) AND ib.ib_lower_bound IN (130001, 190001, 20001) GROUP BY ib.ib_income_band_sk, wp.wp_type, r.r_reason_desc ORDER BY total_revenue_inc_ship DESC, avg_revenue_inc_tax DESC, total_orders DESC, page_count DESC, total_image_count DESC, reason_count DESC;
SELECT s.s_store_name, COUNT(sr.sr_ticket_number) AS total_returns, SUM(sr.sr_return_quantity) AS total_returned_quantity, SUM(sr.sr_return_amt) AS total_refund_amount, AVG(sr.sr_return_amt) AS average_refund_amount, SUM(sr.sr_fee) AS total_fees_collected, r.r_reason_desc AS return_reason, d.d_year AS return_year, d.d_quarter_name AS return_quarter FROM store_returns sr JOIN store s ON sr.sr_store_sk = s.s_store_sk JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk WHERE s.s_company_id = '1' AND s.s_gmt_offset = '-5.00' AND sr.sr_reason_sk IN ('24', '25', '31', '13', '17', '4') AND sr.sr_returned_date_sk IS NOT NULL GROUP BY s.s_store_name, r.r_reason_desc, d.d_year, d.d_quarter_name ORDER BY s.s_store_name, total_returns DESC, total_refund_amount DESC;
SELECT w.w_city, w.w_state, w.w_country, COUNT(*) AS number_of_households, AVG(hd.hd_dep_count) AS average_dependency_count, AVG(hd.hd_vehicle_count) AS average_vehicle_count, AVG(ib.ib_lower_bound) AS average_income_lower_bound, AVG(ib.ib_upper_bound) AS average_income_upper_bound, SUM(CASE WHEN hd.hd_buy_potential = 'Unknown' THEN 1 ELSE 0 END) AS unknown_buy_potential_count, SUM(CASE WHEN hd.hd_buy_potential = 'High' THEN 1 ELSE 0 END) AS high_buy_potential_count, SUM(CASE WHEN hd.hd_buy_potential = 'Low' THEN 1 ELSE 0 END) AS low_buy_potential_count FROM warehouse w JOIN household_demographics hd ON w.w_warehouse_sk = hd.hd_demo_sk JOIN income_band ib ON hd.hd_income_band_sk = ib.ib_income_band_sk GROUP BY w.w_city, w.w_state, w.w_country ORDER BY w.w_country, w.w_state, w.w_city;
SELECT s.s_store_name, s.s_number_employees, AVG(ss.ss_sales_price) AS average_sale_amount, AVG(sr.sr_return_amt) AS average_return_amount, SUM(inv.inv_quantity_on_hand) AS total_inventory, COUNT(DISTINCT ss.ss_ticket_number) AS total_sales_transactions, COUNT(DISTINCT sr.sr_ticket_number) AS total_return_transactions FROM store s LEFT JOIN store_sales ss ON s.s_store_sk = ss.ss_store_sk LEFT JOIN store_returns sr ON s.s_store_sk = sr.sr_store_sk AND ss.ss_item_sk = sr.sr_item_sk LEFT JOIN inventory inv ON ss.ss_item_sk = inv.inv_item_sk AND s.s_store_sk = inv.inv_warehouse_sk WHERE (ss.ss_sold_date_sk IS NOT NULL OR sr.sr_returned_date_sk IS NOT NULL) AND (ss.ss_item_sk IN (14547, 403, 14095, 8557) OR sr.sr_item_sk IN (14547, 403, 14095, 8557)) AND EXISTS ( SELECT 1 FROM household_demographics hd WHERE (ss.ss_hdemo_sk = hd.hd_demo_sk OR sr.sr_hdemo_sk = hd.hd_demo_sk) AND hd.hd_dep_count = 1 ) GROUP BY s.s_store_name, s.s_number_employees ORDER BY s.s_store_name;
SELECT c_birth_country, cd_gender, cd_marital_status, cd_education_status, AVG(cd_purchase_estimate) AS avg_purchase_estimate, COUNT(DISTINCT c_customer_sk) AS total_customers, SUM(inv_quantity_on_hand) AS total_inventory, COUNT(DISTINCT wr_order_number) AS total_returns, AVG(wr_return_amt_inc_tax) AS avg_return_amount_inc_tax, SUM(wr_fee) AS total_return_fees FROM customer c JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk JOIN inventory inv ON inv.inv_date_sk = '2450815' JOIN web_returns wr ON wr.wr_refunded_customer_sk = c.c_customer_sk JOIN web_page wp ON wp.wp_web_page_sk = wr.wr_web_page_sk AND wp.wp_max_ad_count IN ('0', '1') JOIN time_dim t ON t.t_time_sk = wr.wr_returned_time_sk AND t.t_time_id IN ('AAAAAAAALDIAAAAA', 'AAAAAAAAPEJAAAAA', 'AAAAAAAAKMNAAAAA', 'AAAAAAAAIHFAAAAA', 'AAAAAAAAOEBBAAAA', 'AAAAAAAALNDAAAAA') JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk WHERE cd.cd_marital_status IN ('D', 'M', 'U', 'S', 'W') AND cd.cd_gender = 'M' GROUP BY c_birth_country, cd_gender, cd_marital_status, cd_education_status ORDER BY avg_purchase_estimate DESC, total_customers DESC LIMIT 100;
SELECT ib.ib_income_band_sk, ib.ib_lower_bound, ib.ib_upper_bound, COUNT(DISTINCT ss.ss_customer_sk) AS num_customers, SUM(ss.ss_quantity) AS total_quantity_sold, AVG(ss.ss_sales_price) AS avg_sales_price, SUM(ss.ss_net_profit) AS total_net_profit, SUM(sr.sr_return_quantity) AS total_return_quantity, SUM(sr.sr_return_amt) AS total_return_amount, AVG(sr.sr_fee) AS avg_return_fee, COUNT(DISTINCT wp.wp_web_page_sk) AS num_visited_pages, SUM(wp.wp_link_count) AS total_link_count FROM income_band ib LEFT JOIN store_sales ss ON ib.ib_income_band_sk = ss.ss_cdemo_sk LEFT JOIN store_returns sr ON ss.ss_customer_sk = sr.sr_customer_sk AND sr.sr_reason_sk IN (21, 2, 14, 30) LEFT JOIN web_page wp ON ss.ss_customer_sk = wp.wp_customer_sk AND wp.wp_type IN ('protected', 'ad') WHERE ss.ss_sold_date_sk IN (2451298, 2450872, 2451390, 2451634) AND ib.ib_upper_bound IN (30000, 130000, 90000) AND ib.ib_income_band_sk IN (17, 6) GROUP BY ib.ib_income_band_sk, ib.ib_lower_bound, ib.ib_upper_bound ORDER BY ib.ib_income_band_sk;
SELECT ca_state, cd_education_status, AVG(cs_net_paid) AS avg_sales_amount, SUM(cs_net_paid) AS total_sales_amount, COUNT(DISTINCT cs_bill_customer_sk) AS unique_customers FROM catalog_sales JOIN date_dim ON catalog_sales.cs_sold_date_sk = date_dim.d_date_sk JOIN customer_demographics ON catalog_sales.cs_bill_cdemo_sk = customer_demographics.cd_demo_sk JOIN customer_address ON catalog_sales.cs_bill_addr_sk = customer_address.ca_address_sk WHERE date_dim.d_quarter_name IN ('1901Q4', '1913Q3', '1902Q3') AND date_dim.d_current_quarter = 'N' AND customer_address.ca_county IN ('Claiborne County', 'Scott County', 'Borden County', 'Juneau County') GROUP BY ca_state, cd_education_status ORDER BY ca_state, cd_education_status, total_sales_amount DESC;
SELECT cd.cd_gender, cd.cd_marital_status, cd.cd_education_status, COUNT(DISTINCT cs.cs_order_number) AS total_catalog_orders, SUM(cs.cs_quantity) AS total_catalog_quantity, AVG(cs.cs_sales_price) AS avg_catalog_sales_price, SUM(ss.ss_net_profit) AS total_store_net_profit, AVG(ss.ss_sales_price) AS avg_store_sales_price, COUNT(DISTINCT wp.wp_web_page_sk) AS total_web_page_visits, SUM(wp.wp_link_count) AS total_web_page_links, ws.web_name, ws.web_company_name, ib.ib_lower_bound, ib.ib_upper_bound, s.s_store_name, s.s_number_employees, s.s_floor_space FROM customer_demographics cd LEFT JOIN catalog_sales cs ON cd.cd_demo_sk = cs.cs_bill_cdemo_sk LEFT JOIN store_sales ss ON cd.cd_demo_sk = ss.ss_cdemo_sk LEFT JOIN web_page wp ON cd.cd_demo_sk = wp.wp_customer_sk LEFT JOIN web_site ws ON wp.wp_web_page_id = ws.web_site_id LEFT JOIN income_band ib ON cd.cd_purchase_estimate BETWEEN ib.ib_lower_bound AND ib.ib_upper_bound LEFT JOIN store s ON ss.ss_store_sk = s.s_store_sk LEFT JOIN catalog_page cp ON cs.cs_catalog_page_sk = cp.cp_catalog_page_sk WHERE ib.ib_income_band_sk IN (6, 11, 7) AND (s.s_rec_end_date IN ('1999-03-13', '2000-03-12', '2001-03-12') OR s.s_rec_end_date IS NULL) AND (s.s_store_name LIKE '%cally%' OR s.s_store_name LIKE '%ation%' OR s.s_store_name LIKE '%eing%') AND wp.wp_web_page_id IN ('AAAAAAAAJBAAAAAA', 'AAAAAAAAIAAAAAAA', 'AAAAAAAAMCAAAAAA') AND wp.wp_web_page_sk IN (30, 40, 9) AND wp.wp_rec_end_date IN ('2000-09-02', '1999-09-03', '2001-09-02') AND cd.cd_dep_college_count = 0 AND cd.cd_marital_status IN ('U', 'W', 'S') AND cd.cd_dep_employed_count = 0 AND ss.ss_sales_price IN (6.97, 54.53, 6.01) AND ss.ss_net_profit IN (-2115.52, -1765.80, -614.39) AND cs.cs_ext_tax IN (18.59, 2.99, 205.24) AND cs.cs_sold_date_sk IN (2450841, 2450829, 2450825) AND ws.web_name IN ('site_2', 'site_4', 'site_0') AND ws.web_street_number IN ('887', '973', '892') AND cp.cp_type IN ('quarterly', 'monthly', 'bi-annual') AND cp.cp_catalog_number IN (31, 32, 13) AND cp.cp_end_date_sk IN (2451574, 2451539, 2451299) GROUP BY cd.cd_gender, cd.cd_marital_status, cd.cd_education_status, ws.web_name, ws.web_company_name, ib.ib_lower_bound, ib.ib_upper_bound, s.s_store_name, s.s_number_employees, s.s_floor_space ORDER BY total_catalog_orders DESC, total_store_net_profit DESC, total_web_page_visits DESC;
SELECT i.i_category, i.i_brand, sm.sm_type, COUNT(DISTINCT wr.wr_order_number) AS total_returns, SUM(wr.wr_return_quantity) AS total_returned_quantity, AVG(wr.wr_return_amt) AS avg_return_amount, SUM(wr.wr_return_amt) AS total_return_amount, SUM(wr.wr_fee) AS total_fees, SUM(wr.wr_net_loss) AS total_net_loss FROM web_returns wr JOIN item i ON wr.wr_item_sk = i.i_item_sk JOIN ship_mode sm ON wr.wr_returned_date_sk = sm.sm_ship_mode_sk WHERE i.i_item_id IN ('AAAAAAAAEKBBAAAA', 'AAAAAAAACAAAAAAA', 'AAAAAAAAGCCAAAAA', 'AAAAAAAAKMEAAAAA') AND wr.wr_return_tax IN (29.73, 18.36, 50.38, 6.84) AND wr.wr_fee IN (85.54, 18.90, 40.73, 20.86, 73.81) AND sm.sm_ship_mode_sk IN (13, 7, 6, 16, 10) AND sm.sm_type IN ('TWO DAY', 'OVERNIGHT') GROUP BY i.i_category, i.i_brand, sm.sm_type ORDER BY total_net_loss DESC, total_returned_quantity DESC;
SELECT dd.d_year, ca.ca_state, SUM(cs.cs_quantity) AS total_quantity, AVG(cs.cs_sales_price) AS average_sales_price, COUNT(DISTINCT cs.cs_order_number) AS order_count, SUM(cs.cs_net_paid_inc_tax) AS total_revenue_inc_tax, SUM(cs.cs_net_profit) AS total_profit FROM catalog_sales cs JOIN date_dim dd ON cs.cs_sold_date_sk = dd.d_date_sk JOIN customer_address ca ON cs.cs_bill_addr_sk = ca.ca_address_sk JOIN store s ON ca.ca_state = s.s_state JOIN warehouse w ON cs.cs_warehouse_sk = w.w_warehouse_sk WHERE dd.d_fy_year = 1912 GROUP BY dd.d_year, ca.ca_state ORDER BY total_revenue_inc_tax DESC, ca.ca_state;
SELECT d_year, ca_state, COUNT(DISTINCT c_customer_sk) AS num_customers, SUM(ss_quantity) AS total_quantity, AVG(ss_sales_price) AS avg_sales_price, SUM(ss_net_paid) AS total_net_paid, SUM(ss_net_paid_inc_tax) AS total_net_paid_inc_tax, SUM(ss_net_profit) AS total_net_profit FROM store_sales JOIN date_dim ON store_sales.ss_sold_date_sk = date_dim.d_date_sk JOIN customer ON store_sales.ss_customer_sk = customer.c_customer_sk JOIN customer_address ON customer.c_current_addr_sk = customer_address.ca_address_sk WHERE d_weekend = 'N' AND ss_list_price IN (79.50, 143.98, 117.62) AND ca_state IS NOT NULL GROUP BY d_year, ca_state ORDER BY d_year, ca_state;
SELECT hd.hd_buy_potential, COUNT(DISTINCT ss.ss_ticket_number) AS total_sales_transactions, SUM(ss.ss_quantity) AS total_items_sold, AVG(ss.ss_sales_price) AS avg_item_sales_price, SUM(wr.wr_return_quantity) AS total_items_returned, AVG(wr.wr_return_amt) AS avg_return_amount, SUM(sr.sr_return_quantity) AS total_store_returned_items, AVG(sr.sr_return_amt) AS avg_store_return_amount, (SUM(ss.ss_net_profit) - SUM(wr.wr_net_loss) - SUM(sr.sr_net_loss)) AS net_profit_after_returns FROM store_sales ss JOIN household_demographics hd ON ss.ss_hdemo_sk = hd.hd_demo_sk LEFT JOIN web_returns wr ON ss.ss_item_sk = wr.wr_item_sk AND ss.ss_customer_sk = wr.wr_refunded_customer_sk LEFT JOIN store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_customer_sk = sr.sr_customer_sk WHERE hd.hd_buy_potential = '>10000' AND ss.ss_store_sk IN (1, 2, 7) AND wr.wr_refunded_customer_sk IN (48471, 57503, 93352) AND wr.wr_refunded_hdemo_sk IN (1649, 5785) AND sr.sr_reason_sk = 5 AND sr.sr_return_amt = 10.56 GROUP BY hd.hd_buy_potential;
SELECT cc.cc_call_center_id, cc.cc_name, cc.cc_city, cc.cc_state, SUM(ss.ss_net_paid_inc_tax) AS total_sales_including_tax, AVG(ss.ss_sales_price) AS average_sales_price, COUNT(DISTINCT ss.ss_customer_sk) AS unique_customer_count, COUNT(DISTINCT CASE WHEN c.c_preferred_cust_flag = 'Y' THEN ss.ss_customer_sk END) AS preferred_customer_count, SUM(sr.sr_return_amt_inc_tax) AS total_returns_including_tax, COUNT(DISTINCT sr.sr_customer_sk) AS total_return_customers FROM call_center cc LEFT JOIN store_sales ss ON cc.cc_call_center_sk = ss.ss_store_sk LEFT JOIN store_returns sr ON ss.ss_ticket_number = sr.sr_ticket_number AND ss.ss_item_sk = sr.sr_item_sk LEFT JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk WHERE cc.cc_rec_start_date > '1998-01-01' AND cc.cc_sq_ft = '1138' GROUP BY cc.cc_call_center_id, cc.cc_name, cc.cc_city, cc.cc_state ORDER BY total_sales_including_tax DESC;
SELECT c.c_customer_id AS customer_id, CONCAT(c.c_last_name, ', ', c.c_first_name) AS customer_name, cd.cd_gender, cd.cd_marital_status, cd.cd_education_status, cd.cd_purchase_estimate, hd.hd_income_band_sk, hd.hd_buy_potential, COUNT(cr.cr_order_number) AS total_returns, SUM(cr.cr_return_quantity) AS total_returned_quantity, AVG(cr.cr_return_amount) AS avg_return_amount, SUM(cr.cr_return_amt_inc_tax) AS total_return_amount_inc_tax, SUM(cr.cr_net_loss) AS total_net_loss FROM customer c JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk JOIN catalog_returns cr ON c.c_customer_sk = cr.cr_returning_customer_sk WHERE c.c_first_sales_date_sk IN (2452027, 2451966, 2450163) AND cr.cr_returned_time_sk IN (66035, 17738, 73881) AND cr.cr_return_quantity = 49 GROUP BY customer_id, customer_name, cd.cd_gender, cd.cd_marital_status, cd.cd_education_status, cd.cd_purchase_estimate, hd.hd_income_band_sk, hd.hd_buy_potential ORDER BY total_returns DESC, total_returned_quantity DESC LIMIT 100;
