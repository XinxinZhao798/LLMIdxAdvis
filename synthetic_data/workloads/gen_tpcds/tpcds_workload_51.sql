SELECT ss.ss_store_sk AS store_id, hd.hd_vehicle_count AS vehicle_count, COUNT(DISTINCT ss.ss_ticket_number) AS total_sales_transactions, SUM(ss.ss_quantity) AS total_items_sold, AVG(ss.ss_sales_price) AS avg_sales_price, SUM(ss.ss_net_profit) AS total_sales_net_profit, COUNT(DISTINCT sr.sr_ticket_number) AS total_return_transactions, SUM(sr.sr_return_quantity) AS total_items_returned, AVG(sr.sr_return_amt) AS avg_return_amount, SUM(sr.sr_net_loss) AS total_returns_net_loss, ARRAY_AGG(DISTINCT r.r_reason_desc) FILTER (WHERE sr.sr_reason_sk IS NOT NULL) AS return_reasons FROM store_sales ss JOIN household_demographics hd ON ss.ss_hdemo_sk = hd.hd_demo_sk LEFT JOIN store_returns sr ON ss.ss_ticket_number = sr.sr_ticket_number AND ss.ss_item_sk = sr.sr_item_sk LEFT JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk WHERE ss.ss_store_sk IN ('10', '4', '7', '8') AND hd.hd_vehicle_count IN ('3', '2', '1', '4') GROUP BY ss.ss_store_sk, hd.hd_vehicle_count ORDER BY total_sales_net_profit DESC, total_returns_net_loss ASC;
SELECT ca_state, sm_type, COUNT(*) AS total_returns, SUM(cr_return_quantity) AS total_returned_quantity, AVG(cr_return_amount) AS avg_return_amount, SUM(cr_return_amt_inc_tax) AS total_return_amount_inc_tax, AVG(cr_fee) AS avg_fee, SUM(cr_net_loss) AS total_net_loss FROM catalog_returns JOIN customer_address ON catalog_returns.cr_returning_addr_sk = customer_address.ca_address_sk JOIN ship_mode ON catalog_returns.cr_ship_mode_sk = ship_mode.sm_ship_mode_sk JOIN time_dim ON catalog_returns.cr_returned_time_sk = time_dim.t_time_sk JOIN household_demographics ON catalog_returns.cr_returning_hdemo_sk = household_demographics.hd_demo_sk WHERE cr_return_amt_inc_tax > 1000.00 AND time_dim.t_minute IN (40, 31, 37) AND time_dim.t_shift = 'third' AND household_demographics.hd_buy_potential IN ('5001-10000', '1001-5000', '>10000') AND household_demographics.hd_demo_sk = 2502 GROUP BY ca_state, sm_type ORDER BY total_return_amount_inc_tax DESC, avg_return_amount DESC;
SELECT ca.ca_country, ca.ca_state, COUNT(DISTINCT sr.sr_ticket_number) AS num_returns, SUM(sr.sr_return_amt) AS total_return_amount, AVG(sr.sr_return_amt) AS avg_return_amount, SUM(sr.sr_return_quantity) AS total_returned_quantity, SUM(sr.sr_fee) AS total_fees, SUM(sr.sr_net_loss) AS total_net_loss FROM store_returns sr JOIN customer_address ca ON sr.sr_addr_sk = ca.ca_address_sk JOIN store s ON sr.sr_store_sk = s.s_store_sk WHERE ca.ca_country = 'United States' AND s.s_rec_start_date BETWEEN '1997-03-13' AND '2001-03-13' AND s.s_number_employees BETWEEN 236 AND 288 AND sr.sr_returned_date_sk IN ('2452372', '2451953', '2452254') GROUP BY ca.ca_country, ca.ca_state ORDER BY total_return_amount DESC;
SELECT cp_department, cp_type, COUNT(DISTINCT cp_catalog_page_sk) AS num_catalog_pages, SUM(ss_quantity) AS total_quantity_sold, AVG(ss_sales_price) AS average_sales_price, SUM(ss_net_paid_inc_tax) AS total_revenue, SUM(ss_net_profit) AS total_profit, COUNT(DISTINCT ss_customer_sk) AS unique_customers, ib_lower_bound, ib_upper_bound FROM catalog_page JOIN store_sales ON cp_catalog_page_sk = ss_promo_sk JOIN income_band ON ss_hdemo_sk = ib_income_band_sk JOIN time_dim ON ss_sold_time_sk = t_time_sk WHERE cp_start_date_sk IS NOT NULL AND cp_end_date_sk IS NOT NULL AND (cp_type = 'quarterly' OR cp_type = 'monthly') AND t_sub_shift = 'night' AND ib_upper_bound IN (170000, 140000) AND ib_lower_bound >= 120001 GROUP BY cp_department, cp_type, ib_lower_bound, ib_upper_bound ORDER BY total_revenue DESC, total_profit DESC;
SELECT i.i_category, COUNT(DISTINCT ws.ws_order_number) AS total_sales_orders, SUM(ws.ws_quantity) AS total_quantity_sold, SUM(ws.ws_net_paid) - SUM(cr.cr_return_amount) AS net_sales, AVG(ws.ws_sales_price) AS average_sale_amount, COUNT(DISTINCT cr.cr_order_number) AS total_return_orders, SUM(cr.cr_return_quantity) AS total_quantity_returned, AVG(cr.cr_return_amount) AS average_return_amount FROM item i LEFT JOIN web_sales ws ON i.i_item_sk = ws.ws_item_sk LEFT JOIN catalog_returns cr ON i.i_item_sk = cr.cr_item_sk WHERE (ws.ws_sold_date_sk BETWEEN 20010101 AND 20011231 OR cr.cr_returned_date_sk BETWEEN 20010101 AND 20011231) AND i.i_category IN ('Electronics', 'Clothing', 'Home Goods') GROUP BY i.i_category ORDER BY net_sales DESC;
SELECT hd.hd_dep_count AS number_of_dependents, hd.hd_vehicle_count AS number_of_vehicles, ca.ca_location_type AS customer_location_type, ca.ca_street_type AS street_type, t.t_am_pm AS return_time_period, COUNT(DISTINCT cr.cr_order_number) AS total_returned_orders, SUM(cr.cr_return_quantity) AS total_returned_quantity, AVG(cr.cr_return_amount) AS average_return_amount, SUM(cr.cr_net_loss) AS total_net_loss FROM catalog_returns cr JOIN household_demographics hd ON cr.cr_returning_hdemo_sk = hd.hd_demo_sk JOIN customer_address ca ON cr.cr_returning_addr_sk = ca.ca_address_sk JOIN time_dim t ON cr.cr_returned_time_sk = t.t_time_sk WHERE ca.ca_location_type IN ('single family', 'apartment', 'condo') AND ca.ca_street_type IN ('Boulevard', 'Ct.', 'Avenue', 'Way', 'Parkway', 'ST') AND t.t_am_pm = 'AM' GROUP BY hd.hd_dep_count, hd.hd_vehicle_count, ca.ca_location_type, ca.ca_street_type, t.t_am_pm ORDER BY total_net_loss DESC, average_return_amount DESC;
SELECT w_state, s_county, p_promo_name, COUNT(*) AS num_sales, SUM(cs_net_paid) AS total_net_sales, AVG(cs_net_profit) AS avg_net_profit, SUM(ws_net_paid) AS total_web_net_sales, AVG(ws_net_profit) AS avg_web_net_profit FROM warehouse JOIN catalog_sales ON cs_warehouse_sk = w_warehouse_sk JOIN web_sales ON ws_warehouse_sk = w_warehouse_sk JOIN promotion ON cs_promo_sk = p_promo_sk AND ws_promo_sk = p_promo_sk JOIN store ON w_state = s_state WHERE w_state = 'TN' AND s_county = 'Williamson County' AND (p_promo_id = 'AAAAAAAAIAAAAAAA' OR p_promo_id = 'AAAAAAAACAAAAAAA') GROUP BY w_state, s_county, p_promo_name ORDER BY total_net_sales DESC, total_web_net_sales DESC;
SELECT s.s_store_name, s.s_city, s.s_state, SUM(s.s_number_employees) AS total_employees, AVG(s.s_floor_space) AS average_floor_space, COUNT(DISTINCT cp.cp_catalog_page_sk) AS number_of_catalog_pages, SUM(CASE WHEN r.r_reason_id = 'AAAAAAAAMBAAAAAA' THEN 1 ELSE 0 END) AS count_mb_reason, SUM(CASE WHEN r.r_reason_id = 'AAAAAAAACAAAAAAA' THEN 1 ELSE 0 END) AS count_ca_reason, AVG(s.s_tax_precentage) AS average_tax_percentage FROM store s LEFT JOIN catalog_page cp ON (s.s_store_sk = cp.cp_catalog_number) LEFT JOIN reason r ON (r.r_reason_desc = cp.cp_description) WHERE s.s_street_type IN ('Boulevard', 'Court', 'Dr.', 'Circle') AND s.s_number_employees > 200 AND cp.cp_end_date_sk = '2451634' AND cp.cp_catalog_page_id IN ('AAAAAAAAFHPAAAAA', 'AAAAAAAAGPGAAAAA') GROUP BY s.s_store_name, s.s_city, s.s_state ORDER BY s.s_store_name;
SELECT i.i_category, i.i_brand, t.t_shift, COUNT(DISTINCT ss.ss_ticket_number) AS total_sales_transactions, SUM(ss.ss_quantity) AS total_quantities_sold, AVG(ss.ss_sales_price) AS average_selling_price, SUM(ss.ss_net_paid) AS total_net_paid, SUM(ss.ss_net_paid_inc_tax) - SUM(ss.ss_net_paid) AS total_tax_collected, SUM(ss.ss_net_profit) AS total_net_profit FROM store_sales ss JOIN item i ON ss.ss_item_sk = i.i_item_sk JOIN time_dim t ON ss.ss_sold_time_sk = t.t_time_sk WHERE ss.ss_sold_date_sk IN (2451375, 2451147, 2451762, 2451572, 2452439, 2452222) AND ss.ss_sales_price BETWEEN 4.90 AND 95.65 GROUP BY i.i_category, i.i_brand, t.t_shift ORDER BY total_net_profit DESC, i.i_category, i.i_brand, t.t_shift;
SELECT h.hd_income_band_sk, p.p_promo_name, p.p_channel_dmail, p.p_channel_email, p.p_channel_tv, COUNT(DISTINCT s.ss_ticket_number) AS total_sales_transactions, SUM(s.ss_quantity) AS total_units_sold, SUM(s.ss_net_paid) AS total_revenue, AVG(s.ss_sales_price) AS average_sales_price, r.r_reason_desc, COUNT(DISTINCT sr.sr_ticket_number) AS total_return_transactions, SUM(sr.sr_return_quantity) AS total_units_returned, SUM(sr.sr_net_loss) AS total_loss_from_returns FROM store_sales s LEFT JOIN promotion p ON s.ss_promo_sk = p.p_promo_sk LEFT JOIN household_demographics h ON s.ss_hdemo_sk = h.hd_demo_sk LEFT JOIN store_returns sr ON s.ss_ticket_number = sr.sr_ticket_number AND s.ss_item_sk = sr.sr_item_sk LEFT JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk WHERE s.ss_item_sk IN (13423, 9310) GROUP BY h.hd_income_band_sk, p.p_promo_name, p.p_channel_dmail, p.p_channel_email, p.p_channel_tv, r.r_reason_desc ORDER BY total_revenue DESC;
SELECT wp.wp_type, sm.sm_type, COUNT(DISTINCT wr.wr_refunded_customer_sk) AS unique_customers, SUM(wr.wr_return_quantity) AS total_returned_quantity, AVG(wr.wr_return_amt_inc_tax) AS avg_return_amt_inc_tax, SUM(wr.wr_fee) AS total_fees, SUM(wr.wr_net_loss) AS total_net_loss FROM web_returns wr JOIN web_page wp ON wr.wr_web_page_sk = wp.wp_web_page_sk JOIN ship_mode sm ON wr.wr_returning_addr_sk = sm.sm_ship_mode_sk WHERE wp.wp_type IN ('feedback', 'order', 'general') AND sm.sm_type = 'TWO DAY' AND wr.wr_returning_addr_sk IN ('28100', '12237', '16942', '45981', '17051', '17924') AND wr.wr_refunded_customer_sk IN ('91486', '46332', '17456', '11868', '724', '87845') GROUP BY wp.wp_type, sm.sm_type;
SELECT r.r_reason_desc, cc.cc_name AS call_center_name, cc.cc_city AS call_center_city, cc.cc_state AS call_center_state, SUM(cr.cr_return_amount) AS total_return_amount, AVG(cr.cr_return_amount) AS avg_return_amount, COUNT(cr.cr_order_number) AS total_returns, SUM(cr.cr_return_quantity) AS total_returned_items, SUM(cr.cr_fee) AS total_fees_collected, SUM(cr.cr_store_credit) AS total_store_credit_issued, SUM(cr.cr_net_loss) AS total_net_loss FROM catalog_returns cr JOIN call_center cc ON cr.cr_call_center_sk = cc.cc_call_center_sk JOIN reason r ON cr.cr_reason_sk = r.r_reason_sk WHERE cr.cr_returned_date_sk BETWEEN 20000101 AND 20001231 AND cr.cr_returning_hdemo_sk IN (5491, 6517, 636, 7063, 3950, 2509) GROUP BY r.r_reason_desc, cc.cc_name, cc.cc_city, cc.cc_state ORDER BY total_return_amount DESC, total_returns DESC;
SELECT i_category, r_reason_desc, EXTRACT(YEAR FROM d_date) AS return_year, EXTRACT(MONTH FROM d_date) AS return_month, COUNT(DISTINCT cr_order_number) AS total_returns, SUM(cr_return_quantity) AS total_returned_quantity, AVG(cr_return_amount) AS average_return_amount, SUM(cr_net_loss) AS total_net_loss FROM catalog_returns cr JOIN item i ON cr.cr_item_sk = i.i_item_sk JOIN date_dim dd ON cr.cr_returned_date_sk = dd.d_date_sk JOIN reason r ON cr.cr_reason_sk = r.r_reason_sk WHERE dd.d_current_week = 'N' AND r.r_reason_desc IN ('reason 26', 'Did not get it on time', 'Did not like the make', 'reason 23', 'reason 24') GROUP BY i_category, r_reason_desc, return_year, return_month ORDER BY i_category, return_year, return_month, r_reason_desc;
SELECT r.r_reason_desc AS reason_for_return, w.w_state AS warehouse_state, COUNT(wr.wr_order_number) AS number_of_returns, AVG(wr.wr_return_amt_inc_tax) AS average_return_amount_inc_tax, SUM(wr.wr_return_tax) AS total_return_tax, AVG(wr.wr_net_loss) AS average_net_loss FROM web_returns wr JOIN reason r ON wr.wr_reason_sk = r.r_reason_sk JOIN warehouse w ON wr.wr_returning_addr_sk = w.w_warehouse_sk WHERE r.r_reason_desc IN ('reason 33', 'it is a girl', 'Lost my job', 'Found a better extended warranty in a store') AND w.w_warehouse_name IN ('Important issues liv', 'Bad cards must make.', 'Conventional childr', 'Doors canno') AND wr.wr_return_amt_inc_tax > 0 GROUP BY reason_for_return, warehouse_state ORDER BY number_of_returns DESC, average_return_amount_inc_tax DESC;
SELECT s.s_store_name, COUNT(DISTINCT ss.ss_ticket_number) AS total_sales_transactions, SUM(ss.ss_quantity) AS total_items_sold, AVG(ss.ss_sales_price) AS average_sales_price, SUM(ss.ss_ext_discount_amt) AS total_discount_amount, SUM(ss.ss_net_paid) AS total_net_sales, SUM(ss.ss_net_paid_inc_tax) AS net_sales_including_tax, SUM(ss.ss_net_profit) AS total_net_profit, COUNT(DISTINCT wr.wr_order_number) AS total_returns_transactions, SUM(wr.wr_return_quantity) AS total_items_returned, AVG(wr.wr_return_amt) AS average_return_amount, SUM(wr.wr_fee) AS total_return_fees, SUM(wr.wr_net_loss) AS total_net_loss FROM store s JOIN store_sales ss ON s.s_store_sk = ss.ss_store_sk LEFT JOIN web_returns wr ON ss.ss_item_sk = wr.wr_item_sk AND ss.ss_ticket_number = wr.wr_order_number WHERE s.s_county = 'Williamson County' AND ss.ss_coupon_amt IN (215.60, 1007.22, 1869.51) GROUP BY s.s_store_name ORDER BY s.s_store_name;
SELECT cs.cc_state AS call_center_state, ws.web_state AS web_site_state, cs.cc_name AS call_center_name, ws.web_name AS web_site_name, COUNT(DISTINCT cs.cc_call_center_sk) AS number_of_call_centers, COUNT(DISTINCT ws.web_site_sk) AS number_of_web_sites, AVG(cs.cc_employees) AS average_employees_per_call_center, AVG(cs.cc_sq_ft) AS average_square_footage_per_call_center, SUM(cd.cd_purchase_estimate) AS total_purchase_estimate, AVG(cd.cd_dep_count) AS average_dependents_per_customer FROM call_center cs JOIN web_site ws ON cs.cc_state = ws.web_state JOIN customer_demographics cd ON (cs.cc_mkt_id = ws.web_mkt_id) WHERE cs.cc_state = 'TN' AND ws.web_state = 'TN' AND (cd.cd_demo_sk = '19181' OR cd.cd_demo_sk = '20612') AND (cd.cd_marital_status = 'M' OR cd.cd_marital_status = 'U') AND ( cs.cc_rec_start_date <= CURRENT_DATE AND (cs.cc_rec_end_date IS NULL OR cs.cc_rec_end_date >= CURRENT_DATE) AND ws.web_rec_start_date <= CURRENT_DATE AND (ws.web_rec_end_date IS NULL OR ws.web_rec_end_date >= CURRENT_DATE) ) GROUP BY cs.cc_state, ws.web_state, cs.cc_name, ws.web_name ORDER BY number_of_call_centers DESC, number_of_web_sites DESC;
SELECT sm.sm_type AS shipping_method, dd.d_year AS year, dd.d_quarter_name AS quarter, SUM(cs.cs_net_paid_inc_ship_tax) AS total_sales, COUNT(DISTINCT cs.cs_order_number) AS total_sales_orders, SUM(cr.cr_net_loss) AS total_returns, COUNT(DISTINCT cr.cr_order_number) AS total_return_orders FROM ship_mode sm LEFT JOIN catalog_sales cs ON sm.sm_ship_mode_sk = cs.cs_ship_mode_sk LEFT JOIN date_dim dd ON cs.cs_sold_date_sk = dd.d_date_sk LEFT JOIN catalog_returns cr ON cs.cs_order_number = cr.cr_order_number WHERE sm.sm_code IN ('AIR', 'SEA', 'SURFACE', 'BIKE') AND dd.d_quarter_seq IN (47, 48) GROUP BY shipping_method, year, quarter ORDER BY year, quarter, shipping_method;
SELECT i.i_category, cd.cd_gender, cd.cd_marital_status, cd.cd_education_status, COUNT(DISTINCT ss.ss_item_sk) AS item_count, SUM(ss.ss_quantity) AS total_quantity_sold, SUM(ss.ss_net_paid) AS total_sales, AVG(ss.ss_sales_price) AS average_sale_price FROM store_sales ss JOIN item i ON ss.ss_item_sk = i.i_item_sk JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk LEFT JOIN promotion p ON ss.ss_promo_sk = p.p_promo_sk AND p.p_channel_catalog = 'N' AND p.p_channel_email = 'N' WHERE ss.ss_customer_sk IS NOT NULL AND p.p_promo_sk IS NULL GROUP BY i.i_category, cd.cd_gender, cd.cd_marital_status, cd.cd_education_status ORDER BY total_sales DESC, i.i_category, cd.cd_gender, cd.cd_marital_status, cd.cd_education_status;
SELECT cc.cc_name, cc.cc_manager, sm.sm_type, COUNT(cs.cs_order_number) AS total_orders, SUM(cs.cs_quantity) AS total_quantity, AVG(cs.cs_net_paid) AS avg_payment, SUM(cs.cs_net_profit) AS total_profit, SUM(cs.cs_coupon_amt) AS total_coupons, p.p_promo_name, COUNT(DISTINCT c.c_customer_sk) AS unique_customers FROM call_center cc JOIN catalog_sales cs ON cc.cc_call_center_sk = cs.cs_call_center_sk JOIN ship_mode sm ON cs.cs_ship_mode_sk = sm.sm_ship_mode_sk JOIN promotion p ON cs.cs_promo_sk = p.p_promo_sk JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk WHERE cc.cc_open_date_sk IN ('2450952', '2450806', '2451063') AND cc.cc_manager IN ('Bob Belcher', 'Felipe Perkins', 'Larry Mccray', 'Mark Hightower') AND cs.cs_ext_sales_price IN ('8162.40', '242.11', '869.67', '42.33') AND c.c_birth_country IN ('GERMANY', 'YEMEN', 'SWAZILAND', 'MARTINIQUE', 'ROMANIA') AND c.c_customer_sk IN ('758', '3345') GROUP BY cc.cc_name, cc.cc_manager, sm.sm_type, p.p_promo_name ORDER BY total_profit DESC, total_orders DESC, avg_payment DESC;
SELECT COUNT(DISTINCT c.c_customer_sk) AS total_customers, AVG(w.w_warehouse_sq_ft) AS average_warehouse_size, SUM(p.p_cost) AS total_promotion_cost, s.s_state, s.s_city, COUNT(DISTINCT s.s_store_sk) AS total_stores, AVG(s.s_number_employees) AS average_store_employees FROM customer c JOIN store s ON c.c_current_addr_sk = s.s_store_sk JOIN warehouse w ON s.s_zip = w.w_zip JOIN promotion p ON p.p_channel_event = 'N' AND p.p_purpose != 'Unknown' GROUP BY s.s_state, s.s_city ORDER BY total_customers DESC, average_warehouse_size DESC, total_promotion_cost DESC;
SELECT ca.ca_state, ca.ca_city, COUNT(DISTINCT c.c_customer_sk) AS total_customers, SUM(ws.ws_quantity) AS total_items_sold, AVG(ws.ws_net_paid) AS average_net_paid_per_sale, SUM(ws.ws_net_profit) AS total_net_profit, COUNT(DISTINCT ws.ws_promo_sk) AS distinct_promotions_used FROM customer_address ca JOIN customer c ON c.c_current_addr_sk = ca.ca_address_sk JOIN web_sales ws ON ws.ws_bill_customer_sk = c.c_customer_sk JOIN promotion p ON ws.ws_promo_sk = p.p_promo_sk WHERE ca.ca_country = 'United States' AND p.p_channel_details IN ('Signs hear moreover nations. There perfect', 'Regional schemes would devise even loc') AND p.p_response_target = 1 AND ws.ws_sales_price > 0 GROUP BY ca.ca_state, ca.ca_city ORDER BY total_net_profit DESC, ca.ca_state, ca.ca_city;
SELECT s.s_store_name, s.s_manager, SUM(cs.cs_net_profit) AS total_profit, AVG(cs.cs_quantity) AS average_quantity_sold, COUNT(DISTINCT cs.cs_order_number) AS total_orders, SUM(wr.wr_net_loss) AS total_net_loss, AVG(wr.wr_fee) AS average_return_fee, COUNT(DISTINCT wr.wr_order_number) AS total_returns, r.r_reason_desc, d.d_year, d.d_quarter_name FROM store s JOIN catalog_sales cs ON s.s_store_sk = cs.cs_ship_addr_sk JOIN web_returns wr ON cs.cs_order_number = wr.wr_order_number JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk JOIN reason r ON wr.wr_reason_sk = r.r_reason_sk WHERE s.s_manager IN ('Raymond Jacobs', 'William Ward') AND r.r_reason_desc IN ('duplicate purchase', 'Did not fit') AND d.d_year = 2001 AND d.d_quarter_name IN ('Q1', 'Q2', 'Q3', 'Q4') GROUP BY s.s_store_name, s.s_manager, r.r_reason_desc, d.d_year, d.d_quarter_name ORDER BY total_profit DESC, total_net_loss DESC;
SELECT d.d_year, d.d_month_seq, COUNT(DISTINCT cp.cp_catalog_page_sk) AS total_catalog_pages, AVG(w.w_warehouse_sq_ft) AS avg_warehouse_size, SUM(p.p_cost) AS total_promotion_cost, COUNT(DISTINCT ca.ca_state) AS num_states_with_customers, COUNT(DISTINCT w.w_state) AS num_states_with_warehouses, SUM(CASE WHEN p.p_channel_press = 'N' THEN p.p_cost ELSE 0 END) AS total_cost_non_press_channel FROM date_dim d JOIN catalog_page cp ON (d.d_date_sk = cp.cp_start_date_sk OR d.d_date_sk = cp.cp_end_date_sk) JOIN promotion p ON (p.p_start_date_sk = d.d_date_sk OR p.p_end_date_sk = d.d_date_sk) JOIN customer_address ca ON cp.cp_catalog_page_sk = ca.ca_address_sk JOIN warehouse w ON w.w_zip = ca.ca_zip WHERE d.d_fy_quarter_seq IN (41, 35, 15, 54, 14, 9) AND cp.cp_catalog_number IN (27, 41) AND d.d_year = 2023 GROUP BY d.d_year, d.d_month_seq ORDER BY d.d_year, d.d_month_seq;
SELECT cd.cd_education_status, sm.sm_type, p.p_promo_name, COUNT(DISTINCT ss.ss_ticket_number) AS total_sales_transactions, SUM(ss.ss_quantity) AS total_quantity_sold, AVG(ss.ss_sales_price) AS average_sales_price, SUM(ss.ss_net_paid) AS total_net_paid, SUM(ss.ss_net_paid_inc_tax) AS total_net_paid_inc_tax, SUM(ss.ss_net_profit) AS total_net_profit, COUNT(DISTINCT CASE WHEN cd.cd_credit_rating = 'High Risk' THEN ss.ss_ticket_number END) AS high_risk_sales_transactions, COUNT(DISTINCT CASE WHEN cd.cd_credit_rating = 'Low Risk' THEN ss.ss_ticket_number END) AS low_risk_sales_transactions, COUNT(DISTINCT CASE WHEN cd.cd_credit_rating = 'Unknown' THEN ss.ss_ticket_number END) AS unknown_risk_sales_transactions FROM store_sales ss JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk JOIN ship_mode sm ON sm.sm_ship_mode_sk = ss.ss_addr_sk JOIN promotion p ON ss.ss_promo_sk = p.p_promo_sk WHERE cd.cd_purchase_estimate IN ('2000', '1000', '4500') AND cd.cd_dep_employed_count = '0' AND sm.sm_ship_mode_sk IN ('13', '8', '20') AND sm.sm_type IN ('OVERNIGHT', 'NEXT DAY', 'EXPRESS') AND p.p_promo_name SIMILAR TO '%(eing|ation|able)%' AND p.p_promo_id IN ('AAAAAAAAJEAAAAAA', 'AAAAAAAALABAAAAA', 'AAAAAAAALNAAAAAA') AND p.p_channel_email = 'N' AND p.p_channel_event = 'N' AND ss.ss_ext_wholesale_cost IN ('3979.00', '2858.52', '5927.86') AND ss.ss_addr_sk IN ('19112', '41507', '33733') AND ss.ss_wholesale_cost IN ('17.80', '5.24', '22.67') AND ss.ss_sold_time_sk IN ('35178', '54001', '41756') GROUP BY cd.cd_education_status, sm.sm_type, p.p_promo_name ORDER BY total_net_profit DESC, total_sales_transactions DESC, average_sales_price DESC;
SELECT ca_state, ca_city, ca_country, EXTRACT(YEAR FROM TO_TIMESTAMP(t_time)) AS sale_year, COUNT(DISTINCT w_warehouse_sk) AS number_of_warehouses, SUM(w_warehouse_sq_ft) AS total_warehouse_area, AVG(w_warehouse_sq_ft) AS avg_warehouse_area, COUNT(DISTINCT ca_address_sk) AS number_of_customers, AVG(ca_gmt_offset) AS avg_gmt_offset FROM customer_address JOIN warehouse ON customer_address.ca_state = warehouse.w_state JOIN time_dim ON (warehouse.w_gmt_offset = -5 OR warehouse.w_street_name IN ('Ash Laurel', '6th', 'Wilson Elm', 'View First')) WHERE ca_country = 'United States' AND t_hour BETWEEN 8 AND 17 AND EXTRACT(ISODOW FROM TO_TIMESTAMP(t_time)) < 6 GROUP BY ca_state, ca_city, ca_country, sale_year ORDER BY ca_state, ca_city, sale_year;
SELECT cd.cd_gender, ca.ca_state, AVG(ws.ws_sales_price) AS avg_web_sales, SUM(cr.cr_return_amount) AS total_catalog_returns, COUNT(DISTINCT ws.ws_order_number) AS count_web_orders, COUNT(DISTINCT cr.cr_order_number) AS count_catalog_returns FROM web_sales ws JOIN customer_demographics cd ON ws.ws_bill_cdemo_sk = cd.cd_demo_sk JOIN customer_address ca ON ws.ws_bill_addr_sk = ca.ca_address_sk LEFT JOIN catalog_returns cr ON ws.ws_order_number = cr.cr_order_number JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk WHERE d.d_year = 2023 AND ws.ws_net_paid > 0 AND (cr.cr_return_amount IS NULL OR cr.cr_return_amount > 0) GROUP BY cd.cd_gender, ca.ca_state ORDER BY avg_web_sales DESC, total_catalog_returns DESC;
SELECT d_year, d_quarter_name, COUNT(DISTINCT cs_order_number) AS total_orders, SUM(cs_net_profit) AS total_profit, AVG(cs_net_profit) AS avg_profit_per_order, SUM(cs_quantity) AS total_items_sold, SUM(cr_net_loss) AS total_returns_loss, COUNT(DISTINCT cr_order_number) AS total_return_orders, AVG(cr_return_amount) AS avg_return_amount, COUNT(DISTINCT inv_item_sk) AS distinct_items_in_inventory, AVG(inv_quantity_on_hand) AS avg_inventory_quantity FROM date_dim JOIN catalog_sales ON (cs_sold_date_sk = date_dim.d_date_sk) JOIN catalog_returns ON (cr_returned_date_sk = date_dim.d_date_sk) JOIN inventory ON (inv_date_sk = date_dim.d_date_sk) JOIN store ON (store.s_rec_start_date <= date_dim.d_date AND (store.s_rec_end_date IS NULL OR store.s_rec_end_date >= date_dim.d_date)) WHERE d_year = 2001 AND cs_item_sk = 24 AND cr_refunded_customer_sk IN ('87999', '35845', '11067') AND inv_quantity_on_hand IN (801, 112, 394, 739, 17, 940) AND cr_net_loss IN (30.69, 55.49) AND inv_date_sk = 2450815 AND store.s_company_id = 1 AND store.s_suite_number IN ('Suite 410', 'Suite 80', 'Suite T', 'Suite 190') GROUP BY d_year, d_quarter_name ORDER BY d_year, d_quarter_name;
SELECT dd.d_year, dd.d_quarter_name, ca.ca_state, ca.ca_country, SUM(cs.cs_quantity) AS total_quantity_sold, AVG(cs.cs_sales_price) AS average_sales_price, COUNT(DISTINCT cs.cs_order_number) AS total_orders, SUM(cs.cs_net_paid_inc_ship_tax) AS total_revenue, SUM(cs.cs_net_profit) AS total_profit FROM catalog_sales cs JOIN date_dim dd ON cs.cs_sold_date_sk = dd.d_date_sk JOIN customer_address ca ON cs.cs_bill_addr_sk = ca.ca_address_sk JOIN store s ON cs.cs_warehouse_sk = s.s_store_sk WHERE dd.d_year = 2002 AND ca.ca_country = 'United States' AND s.s_division_id = 1 AND ( dd.d_week_seq IN (54, 685, 542) OR dd.d_quarter_seq IN (43, 26, 39) ) AND ( cs.cs_item_sk IN (58, 10, 49) OR cs.cs_warehouse_sk IN (3, 2, 4) ) AND cs.cs_net_paid_inc_ship_tax IN (2242.98, 10093.84, 2662.12) GROUP BY dd.d_year, dd.d_quarter_name, ca.ca_state, ca.ca_country ORDER BY total_revenue DESC, total_profit DESC LIMIT 100;
