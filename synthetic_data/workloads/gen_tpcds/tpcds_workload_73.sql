SELECT dd.d_year, dd.d_quarter_name, w.w_state, SUM(inv.inv_quantity_on_hand) AS total_inventory, AVG(inv.inv_quantity_on_hand) AS avg_inventory, COUNT(DISTINCT inv.inv_warehouse_sk) AS number_of_warehouses, COUNT(DISTINCT web.web_site_sk) AS number_of_websites, SUM(cc.cc_employees) AS total_employees, AVG(cc.cc_tax_percentage) AS avg_tax_percentage FROM inventory inv JOIN date_dim dd ON inv.inv_date_sk = dd.d_date_sk JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk JOIN web_site web ON web.web_state = w.w_state JOIN call_center cc ON cc.cc_state = w.w_state WHERE inv.inv_quantity_on_hand IN (232, 844, 624) AND dd.d_year = 2023 AND web.web_open_date_sk <= dd.d_date_sk AND (web.web_close_date_sk IS NULL OR web.web_close_date_sk >= dd.d_date_sk) AND cc.cc_open_date_sk <= dd.d_date_sk AND (cc.cc_closed_date_sk IS NULL OR cc.cc_closed_date_sk >= dd.d_date_sk) GROUP BY dd.d_year, dd.d_quarter_name, w.w_state ORDER BY dd.d_year, dd.d_quarter_name, w.w_state;
SELECT ca.ca_city, ca.ca_state, COUNT(DISTINCT ca.ca_address_sk) AS num_addresses, AVG(hd.hd_dep_count) AS avg_dependency_count, SUM(hd.hd_vehicle_count) AS total_vehicles, ib.ib_lower_bound, ib.ib_upper_bound, COUNT(DISTINCT sm.sm_ship_mode_sk) AS num_ship_modes, COUNT(DISTINCT r.r_reason_sk) AS num_reasons, SUM(CASE WHEN cp.cp_department = 'Electronics' THEN 1 ELSE 0 END) AS num_electronics_pages, SUM(CASE WHEN sm.sm_type = 'OVERNIGHT' THEN 1 ELSE 0 END) AS overnight_shipments, AVG(CASE WHEN t.t_am_pm = 'PM' THEN t.t_hour END) AS avg_hour_pm FROM customer_address ca JOIN household_demographics hd ON ca.ca_address_sk = hd.hd_demo_sk JOIN income_band ib ON hd.hd_income_band_sk = ib.ib_income_band_sk JOIN ship_mode sm ON sm.sm_carrier = 'UPS' JOIN reason r ON r.r_reason_desc LIKE 'reason %' LEFT JOIN catalog_page cp ON cp.cp_department = ca.ca_city LEFT JOIN time_dim t ON t.t_shift = 'Evening' WHERE r.r_reason_sk IN ('9', '6', '11', '2') AND ib.ib_income_band_sk IN ('20', '6') AND hd.hd_buy_potential = 'Unknown' AND sm.sm_type IN ('LIBRARY', 'OVERNIGHT', 'NEXT DAY') GROUP BY ca.ca_city, ca.ca_state, ib.ib_lower_bound, ib.ib_upper_bound ORDER BY ca.ca_city, ca.ca_state;
SELECT w_state, cd_education_status, SUM(inv_quantity_on_hand) AS total_inventory, AVG(sr_return_amt) AS avg_return_amount, COUNT(DISTINCT p_promo_sk) AS num_promotions, SUM(CASE WHEN wp_max_ad_count = 0 THEN 1 ELSE 0 END) AS num_pages_no_ads, AVG(cd_purchase_estimate) AS avg_purchase_estimate, SUM(sr_return_quantity) AS total_returned_quantity FROM warehouse w JOIN inventory i ON w.w_warehouse_sk = i.inv_warehouse_sk JOIN store_returns sr ON i.inv_item_sk = sr.sr_item_sk JOIN customer_demographics cd ON sr.sr_cdemo_sk = cd.cd_demo_sk JOIN promotion p ON p.p_item_sk = i.inv_item_sk JOIN web_page wp ON wp.wp_customer_sk = sr.sr_customer_sk WHERE w.w_gmt_offset = -5.00 AND w.w_zip = '35709' AND cd.cd_education_status IN ('4 yr Degree', 'Secondary', '2 yr Degree') AND sr.sr_cdemo_sk = 1839405 AND (wp.wp_max_ad_count = 3 OR wp.wp_max_ad_count = 0) AND wp.wp_rec_end_date = '2001-09-02' GROUP BY w_state, cd_education_status ORDER BY w_state, cd_education_status;
SELECT s.s_store_name, i.i_category, r.r_reason_desc, COUNT(DISTINCT wr_order_number) AS total_returns, SUM(wr_return_quantity) AS total_returned_quantity, AVG(wr_return_amt) AS avg_return_amount, AVG(wr_return_ship_cost) AS avg_shipping_cost, SUM(wr_net_loss) AS total_net_loss FROM web_returns wr JOIN store s ON s.s_store_sk = wr.wr_refunded_addr_sk JOIN item i ON i.i_item_sk = wr.wr_item_sk JOIN reason r ON r.r_reason_sk = wr.wr_reason_sk WHERE s.s_market_id = 7 AND s.s_rec_start_date IN ('2001-03-13', '1997-03-13') AND i.i_manager_id = 52 AND wr.wr_reason_sk = 13 GROUP BY ROLLUP(s.s_store_name, i.i_category, r.r_reason_desc) ORDER BY s.s_store_name, i.i_category, r.r_reason_desc;
SELECT ca_state, cd_gender, cd_education_status, COUNT(DISTINCT cs_order_number) AS total_orders, SUM(cs_quantity) AS total_quantity, AVG(cs_sales_price) AS avg_sales_price, SUM(cs_net_paid) AS total_net_paid, SUM(cs_net_profit) AS total_net_profit FROM catalog_sales JOIN customer_address ON cs_bill_addr_sk = ca_address_sk JOIN customer_demographics ON cs_bill_cdemo_sk = cd_demo_sk JOIN time_dim ON cs_sold_time_sk = t_time_sk JOIN web_page ON cs_sold_date_sk = wp_access_date_sk WHERE ca_country = 'United States' AND t_shift = 'Day' AND wp_type IN ('order', 'general') AND cd_gender IN ('M', 'F') AND cd_dep_count IN (1, 2) GROUP BY ca_state, cd_gender, cd_education_status ORDER BY total_net_profit DESC, total_net_paid DESC, avg_sales_price DESC;
SELECT s_state, cp_department, COUNT(DISTINCT s_store_sk) AS store_count, AVG(s_number_employees) AS avg_number_employees, SUM(wr_return_amt_inc_tax) AS total_return_amount_inc_tax, AVG(wr_return_quantity) AS avg_return_quantity, SUM(wr_net_loss) AS total_net_loss FROM store JOIN catalog_page ON (s_store_sk = cp_catalog_page_sk) JOIN web_returns ON (s_store_sk = wr_returning_addr_sk) WHERE s_suite_number IN ('Suite T', 'Suite 140') AND cp_start_date_sk IS NOT NULL AND wr_returned_date_sk IS NOT NULL GROUP BY ROLLUP(s_state, cp_department) ORDER BY s_state, cp_department;
SELECT cp.cp_department, ca.ca_state, COUNT(cs.cs_order_number) AS total_orders, SUM(cs.cs_quantity) AS total_quantity, AVG(cs.cs_sales_price) AS average_sales_price, SUM(cs.cs_net_paid) AS total_net_paid, SUM(cs.cs_net_paid_inc_tax) AS total_net_paid_inc_tax, SUM(cs.cs_net_paid_inc_ship) AS total_net_paid_inc_ship, SUM(cs.cs_net_paid_inc_ship_tax) AS total_net_paid_inc_ship_tax, SUM(cs.cs_net_profit) AS total_net_profit FROM catalog_sales cs JOIN catalog_page cp ON cs.cs_catalog_page_sk = cp.cp_catalog_page_sk JOIN customer_address ca ON cs.cs_ship_addr_sk = ca.ca_address_sk WHERE cs.cs_net_paid_inc_ship > 500 AND cp.cp_catalog_page_sk IN (621, 2091, 4644, 4608, 3010) AND ca.ca_state IS NOT NULL GROUP BY cp.cp_department, ca.ca_state ORDER BY cp.cp_department, ca.ca_state;
SELECT SUM(ss.ss_net_profit) AS total_net_profit, AVG(ss.ss_quantity) AS average_quantity_sold, COUNT(DISTINCT ss.ss_customer_sk) AS unique_customers, COUNT(DISTINCT sr.sr_reason_sk) AS number_of_return_reasons, SUM(sr.sr_return_amt_inc_tax) AS total_returns_with_tax, AVG(p.p_cost) AS average_promotion_cost, COUNT(DISTINCT w.w_warehouse_sk) AS number_of_warehouses_used, AVG(w.w_gmt_offset) AS average_warehouse_gmt_offset, SUM(CASE WHEN c.c_preferred_cust_flag = 'Y' THEN 1 ELSE 0 END) AS preferred_customer_count FROM store_sales ss LEFT JOIN store_returns sr ON ss.ss_ticket_number = sr.sr_ticket_number LEFT JOIN promotion p ON ss.ss_promo_sk = p.p_promo_sk AND p.p_discount_active = 'N' LEFT JOIN warehouse w ON w.w_suite_number IN ('Suite 80', 'Suite 0', 'Suite P', 'Suite 470') LEFT JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk WHERE (ss.ss_sold_date_sk BETWEEN 20180101 AND 20181231 OR ss.ss_sold_date_sk IS NULL) AND (sr.sr_returned_date_sk BETWEEN 20180101 AND 20181231 OR sr.sr_returned_date_sk IS NULL) AND (c.c_customer_sk IN ('824', '4397', '807', '476') OR c.c_customer_sk IS NULL) AND (sr.sr_reason_sk IN (SELECT r_reason_sk FROM reason WHERE r_reason_desc IN ('duplicate purchase', 'reason 34', 'Found a better price in a store', 'Gift exchange', 'Parts missing', 'Lost my job')) OR sr.sr_reason_sk IS NULL) GROUP BY w.w_city, c.c_birth_year;
SELECT d_year, d_month_seq, cc_state, p_channel_tv, SUM(ss_quantity) AS total_quantity_sold, AVG(ss_sales_price) AS average_sales_price, COUNT(DISTINCT ss_ticket_number) AS unique_tickets, SUM(ss_coupon_amt) AS total_coupon_amount_used, SUM(ss_net_paid_inc_tax) AS total_sales_with_tax, SUM(ss_net_profit) AS total_net_profit FROM date_dim JOIN store_sales ON d_date_sk = ss_sold_date_sk JOIN call_center ON cc_call_center_sk = ss_store_sk JOIN promotion ON p_promo_sk = ss_promo_sk WHERE d_year = 1999 AND p_channel_tv = 'Y' AND ss_addr_sk IN ('31017', '33096', '32929') AND ss_coupon_amt IN (65.92, 3048.43) AND (cc_state = 'CA' OR cc_state = 'NY') GROUP BY d_year, d_month_seq, cc_state, p_channel_tv ORDER BY d_year, d_month_seq, cc_state, p_channel_tv;
SELECT w.web_site_id AS website, COUNT(DISTINCT c.c_customer_sk) AS unique_customers, SUM(i.i_current_price) AS total_sales, AVG(i.i_wholesale_cost) AS avg_wholesale_cost, ca.ca_state AS state, ca.ca_country AS country, ca.ca_city AS city FROM web_site w JOIN customer c ON w.web_site_sk = c.c_first_sales_date_sk JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk JOIN item i ON w.web_site_sk = i.i_manufact_id WHERE ca.ca_zip IN ('67941', '33451', '79275', '59454') AND ca.ca_suite_number IN ('Suite 470', 'Suite 440', 'Suite H', 'Suite R', 'Suite L') AND w.web_rec_start_date <= CURRENT_DATE AND (w.web_rec_end_date IS NULL OR w.web_rec_end_date > CURRENT_DATE) GROUP BY w.web_site_id, ca.ca_state, ca.ca_country, ca.ca_city ORDER BY total_sales DESC;
SELECT dd.d_year, dd.d_quarter_name, ca.ca_state, COUNT(DISTINCT cs.cs_order_number) AS total_orders, SUM(cs.cs_quantity) AS total_quantity, SUM(cs.cs_net_paid) AS total_net_paid, AVG(cs.cs_net_profit) AS avg_net_profit FROM catalog_sales cs JOIN date_dim dd ON cs.cs_sold_date_sk = dd.d_date_sk JOIN customer_address ca ON cs.cs_ship_addr_sk = ca.ca_address_sk JOIN customer_demographics cd ON cs.cs_bill_cdemo_sk = cd.cd_demo_sk JOIN store s ON ca.ca_state = s.s_state WHERE dd.d_current_quarter = 'N' AND dd.d_following_holiday = 'N' AND cd.cd_credit_rating = 'Good' AND s.s_market_id IS NOT NULL GROUP BY dd.d_year, dd.d_quarter_name, ca.ca_state ORDER BY dd.d_year, dd.d_quarter_name, ca.ca_state;
SELECT s.s_store_name, w.w_warehouse_name, COUNT(ss.ss_ticket_number) AS total_sales_transactions, AVG(ss.ss_net_paid) AS avg_transaction_amount, SUM(ss.ss_net_paid_inc_tax) AS total_revenue_inc_tax, SUM(wr.wr_return_amt_inc_tax) AS total_returns_inc_tax, (SUM(ss.ss_net_paid_inc_tax) - SUM(wr.wr_return_amt_inc_tax)) AS net_revenue_inc_tax, AVG(wr.wr_fee) AS avg_return_fee, SUM(wr.wr_net_loss) AS total_net_loss_from_returns FROM store s JOIN store_sales ss ON s.s_store_sk = ss.ss_store_sk LEFT JOIN web_returns wr ON ss.ss_ticket_number = wr.wr_order_number JOIN warehouse w ON s.s_state = w.w_state GROUP BY s.s_store_name, w.w_warehouse_name ORDER BY net_revenue_inc_tax DESC, s.s_store_name;
SELECT cc.cc_name, i.i_category, COUNT(i.i_item_sk) AS total_items_sold, SUM(i.i_current_price) AS total_sales, AVG(i.i_wholesale_cost) AS avg_wholesale_cost FROM call_center cc JOIN item i ON cc.cc_call_center_sk = i.i_manufact_id JOIN ship_mode sm ON sm.sm_ship_mode_sk = i.i_item_sk WHERE cc.cc_rec_end_date < '2000-12-31' AND i.i_category_id IN ('4', '5', '1', '3') AND sm.sm_code = 'AIR' GROUP BY cc.cc_name, i.i_category ORDER BY cc.cc_name, i.i_category;
SELECT dd.d_year, dd.d_quarter_name, i.i_category, i.i_brand, COUNT(DISTINCT ws.web_site_sk) AS number_of_websites, COUNT(DISTINCT wp.wp_web_page_sk) AS number_of_web_pages, COUNT(DISTINCT wr.wr_order_number) AS number_of_returns, SUM(wr.wr_return_amt) AS total_return_amount, AVG(wr.wr_return_quantity) AS avg_return_quantity, AVG(wr.wr_fee) AS avg_return_fee, hd.hd_dep_count, ib.ib_lower_bound AS income_band_lower_bound, ib.ib_upper_bound AS income_band_upper_bound, SUM(hd.hd_vehicle_count) AS total_vehicles FROM web_returns wr JOIN date_dim dd ON wr.wr_returned_date_sk = dd.d_date_sk JOIN web_page wp ON wr.wr_web_page_sk = wp.wp_web_page_sk JOIN item i ON wr.wr_item_sk = i.i_item_sk JOIN web_site ws ON wp.wp_web_page_sk = ws.web_site_sk JOIN household_demographics hd ON wr.wr_returning_hdemo_sk = hd.hd_demo_sk JOIN income_band ib ON hd.hd_income_band_sk = ib.ib_income_band_sk WHERE dd.d_year = 2001 AND i.i_category_id IN (1, 2, 3) AND wr.wr_return_tax > 100 AND hd.hd_income_band_sk = 10 AND wr.wr_refunded_cash BETWEEN 300 AND 4000 GROUP BY dd.d_year, dd.d_quarter_name, i.i_category, i.i_brand, hd.hd_dep_count, ib.ib_lower_bound, ib.ib_upper_bound ORDER BY total_return_amount DESC, avg_return_quantity DESC, avg_return_fee DESC, number_of_websites, number_of_web_pages;
SELECT w.w_warehouse_name, w.w_warehouse_sq_ft, w.w_city, w.w_state, ib.ib_lower_bound, ib.ib_upper_bound, AVG(cs.cs_sales_price) AS avg_sales_price, AVG(cs.cs_ext_discount_amt) AS avg_discount_amount, SUM(cs.cs_quantity) AS total_quantity_sold, COUNT(DISTINCT cs.cs_order_number) AS total_orders, COUNT(DISTINCT p.p_promo_sk) AS total_promotions_applied FROM catalog_sales cs JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk JOIN warehouse w ON cs.cs_warehouse_sk = w.w_warehouse_sk JOIN promotion p ON cs.cs_promo_sk = p.p_promo_sk JOIN income_band ib ON cs.cs_bill_customer_sk = ib.ib_income_band_sk WHERE d.d_year = 2021 AND w.w_county = 'Williamson County' AND p.p_discount_active = 'Y' AND p.p_response_target > 50 AND cs.cs_sales_price IS NOT NULL AND cs.cs_ext_discount_amt IS NOT NULL GROUP BY w.w_warehouse_name, w.w_warehouse_sq_ft, w.w_city, w.w_state, ib.ib_lower_bound, ib.ib_upper_bound ORDER BY avg_sales_price DESC, avg_discount_amount DESC;
SELECT i_category, ca_state, SUM(sr_return_amt) AS total_return_amount, AVG(sr_return_amt) AS avg_return_amount, COUNT(DISTINCT sr_customer_sk) AS unique_customers_returning, COUNT(*) AS total_returns FROM store_returns sr JOIN item i ON sr.sr_item_sk = i.i_item_sk JOIN store s ON sr.sr_store_sk = s.s_store_sk JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk WHERE ca.ca_gmt_offset IN ('-5.00', '-6.00', '-10.00', '-7.00', '-9.00') AND c.c_birth_month IN (6, 1, 3, 10, 9, 8) AND ca.ca_suite_number IN ('Suite 10', 'Suite I', 'Suite 60', 'Suite 360', 'Suite C', 'Suite 320') GROUP BY i_category, ca_state ORDER BY total_return_amount DESC, unique_customers_returning DESC;
SELECT w_state, p_purpose, COUNT(DISTINCT wp_web_page_sk) AS total_web_pages, SUM(wp_image_count) AS total_images, AVG(wp_char_count) AS avg_char_count, SUM(CASE WHEN wp_web_page_id IN ('AAAAAAAAOAAAAAAA', 'AAAAAAAAJBAAAAAA', 'AAAAAAAAEBAAAAAA', 'AAAAAAAALCAAAAAA', 'AAAAAAAACAAAAAAA', 'AAAAAAAAGBAAAAAA') THEN 1 ELSE 0 END) AS targeted_web_pages_count, SUM(CASE WHEN t_shift = 'third' THEN 1 ELSE 0 END) AS third_shift_count, AVG(w_warehouse_sq_ft) AS avg_warehouse_size FROM warehouse JOIN promotion ON w_warehouse_sk = p_item_sk JOIN web_page ON wp_customer_sk = w_warehouse_sk JOIN time_dim ON t_time_sk = wp_creation_date_sk WHERE w_state = 'TN' AND (wp_image_count = 4 OR wp_image_count = 1) AND w_warehouse_sk = 2 GROUP BY w_state, p_purpose ORDER BY total_web_pages DESC;
SELECT ws.ws_item_sk, COUNT(DISTINCT ws.ws_order_number) AS total_orders, SUM(ws.ws_quantity) AS total_quantity_sold, AVG(ws.ws_ext_discount_amt) AS avg_discount_amt, AVG(ws.ws_sales_price) AS avg_sales_price, SUM(ws.ws_net_paid) AS total_net_paid, SUM(ws.ws_net_profit) AS total_net_profit, hd.hd_dep_count AS avg_dependents, hd.hd_vehicle_count AS avg_vehicles, s.s_store_name, s.s_city, s.s_state, SUM(inv.inv_quantity_on_hand) AS total_inventory_on_hand FROM web_sales ws JOIN household_demographics hd ON ws.ws_ship_hdemo_sk = hd.hd_demo_sk JOIN store s ON ws.ws_warehouse_sk = s.s_store_sk JOIN inventory inv ON (ws.ws_item_sk = inv.inv_item_sk AND ws.ws_warehouse_sk = inv.inv_warehouse_sk) WHERE ws.ws_ship_customer_sk IN ('14120', '70023', '31659', '86542') AND ws.ws_ship_addr_sk IN ('8368', '47705', '32703', '24892') AND inv.inv_date_sk = '2450815' AND hd.hd_vehicle_count IN (1, 0, 3, 2) AND s.s_number_employees IN (245, 271, 236, 218, 288, 278) GROUP BY ws.ws_item_sk, hd.hd_dep_count, hd.hd_vehicle_count, s.s_store_name, s.s_city, s.s_state ORDER BY total_net_paid DESC, total_orders DESC;
SELECT cc_state, i_category, SUM(cs_quantity) AS total_quantity, AVG(cs_sales_price) AS avg_sales_price, COUNT(DISTINCT cs_order_number) AS unique_orders, SUM(ss_net_profit) AS total_store_profit, AVG(ss_wholesale_cost) AS avg_store_wholesale_cost, COUNT(DISTINCT ss_ticket_number) AS unique_store_tickets, SUM(inv_quantity_on_hand) AS total_inventory, COUNT(DISTINCT p_promo_sk) AS distinct_promotions FROM call_center JOIN catalog_sales ON cc_call_center_sk = cs_call_center_sk JOIN item ON cs_item_sk = i_item_sk JOIN store_sales ON ss_item_sk = i_item_sk JOIN inventory ON inv_item_sk = i_item_sk JOIN promotion ON (cs_promo_sk = p_promo_sk OR ss_promo_sk = p_promo_sk) JOIN store ON ss_store_sk = s_store_sk WHERE cc_mkt_id IN ('6', '2', '5') AND cc_state = 'TN' AND inv_item_sk IN ('15746', '11656', '6211', '11858') AND i_item_sk IN ('2579', '2638', '2347', '3924', '3976', '4905') AND s_store_sk IN ('8', '11', '6') GROUP BY cc_state, i_category;
SELECT c.c_first_name, c.c_last_name, c.c_email_address, cd.cd_education_status, cd.cd_credit_rating, sum(cs.cs_quantity) AS total_quantity_sold, avg(cs.cs_sales_price) AS average_sales_price, sum(cs.cs_net_profit) AS total_net_profit, cp.cp_department, w.w_warehouse_name, w.w_state FROM customer c JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk JOIN catalog_sales cs ON c.c_customer_sk = cs.cs_bill_customer_sk JOIN catalog_page cp ON cs.cs_catalog_page_sk = cp.cp_catalog_page_sk JOIN warehouse w ON cs.cs_warehouse_sk = w.w_warehouse_sk WHERE c.c_birth_day IN (10, 3, 18) AND w.w_street_type IN ('Parkway', 'Avenue', 'Drive') AND cd.cd_dep_college_count = 0 GROUP BY c.c_first_name, c.c_last_name, c.c_email_address, cd.cd_education_status, cd.cd_credit_rating, cp.cp_department, w.w_warehouse_name, w.w_state ORDER BY total_net_profit DESC, c.c_last_name, c.c_first_name;
SELECT i_category, cd_gender, cd_marital_status, SUM(ss_quantity) AS total_quantity_sold, AVG(ss_sales_price) AS average_sales_price, COUNT(DISTINCT ss_customer_sk) AS unique_customers, SUM(ws_net_profit) AS total_web_net_profit, AVG(wr_fee) AS average_return_fee FROM store_sales JOIN item ON ss_item_sk = i_item_sk JOIN web_sales ON ws_item_sk = ss_item_sk JOIN web_returns ON wr_item_sk = ws_item_sk JOIN customer_demographics ON (ss_cdemo_sk = cd_demo_sk AND ws_bill_cdemo_sk = cd_demo_sk AND wr_refunded_cdemo_sk = cd_demo_sk) WHERE i_wholesale_cost > 14.32 AND (cd_gender = 'M' OR cd_gender = 'F') AND (cd_marital_status = 'M' OR cd_marital_status = 'U') AND ws_net_paid_inc_tax > 100 AND wr_return_amt > 0 GROUP BY i_category, cd_gender, cd_marital_status ORDER BY total_quantity_sold DESC, average_sales_price DESC;
SELECT dd.d_year, dd.d_qoy, cc.cc_name, COUNT(DISTINCT cs_order_number) AS total_orders, SUM(cs_quantity) AS total_quantity, AVG(cs_sales_price) AS average_sales_price, SUM(cs_net_paid) AS total_net_paid, SUM(cs_net_paid_inc_tax) AS total_net_paid_inc_tax, SUM(cs_net_paid_inc_ship) AS total_net_paid_inc_ship, SUM(cs_net_paid_inc_ship_tax) AS total_net_paid_inc_ship_tax, SUM(cs_net_profit) AS total_net_profit FROM catalog_sales cs JOIN call_center cc ON cs.cs_call_center_sk = cc.cc_call_center_sk JOIN date_dim dd ON cs.cs_sold_date_sk = dd.d_date_sk WHERE cc.cc_name = 'North Midwest' AND dd.d_year = 2003 GROUP BY dd.d_year, dd.d_qoy, cc.cc_name ORDER BY dd.d_year, dd.d_qoy, cc.cc_name;
SELECT d_year, SUM(ws_net_profit) AS total_net_profit, AVG(ws_quantity) AS average_quantity_sold, COUNT(DISTINCT ws.ws_web_page_sk) AS count_distinct_pages, SUM(wr_return_amt) AS total_return_amount, AVG(wr_return_quantity) AS average_return_quantity, COUNT(DISTINCT wr.wr_item_sk) AS count_distinct_returned_items FROM web_sales ws JOIN date_dim dd ON ws.ws_sold_date_sk = dd.d_date_sk LEFT JOIN web_returns wr ON ws.ws_item_sk = wr.wr_item_sk AND ws.ws_order_number = wr.wr_order_number LEFT JOIN web_page wp ON ws.ws_web_page_sk = wp.wp_web_page_sk WHERE dd.d_moy IN ('8', '11') AND dd.d_current_week = 'N' AND ws.ws_web_page_sk IN ('58', '41', '42', '15', '20') AND ws.ws_ext_list_price = 4407.89 AND (wp.wp_rec_end_date IN ('1999-09-03', '2001-09-02', '2000-09-02') OR wp.wp_creation_date_sk IN (2450815, 2450812, 2450813)) AND wr.wr_return_amt IN (78.84, 5987.96, 1527.93, 522.48, 1155.36, 2771.56) AND wr.wr_return_amt_inc_tax = 191.45 GROUP BY dd.d_year;
SELECT td.t_shift, cd.cd_gender, cd.cd_marital_status, cd.cd_education_status, ib.ib_upper_bound, SUM(ws.ws_quantity) AS total_quantity_sold, AVG(ws.ws_sales_price) AS average_sales_price, COUNT(DISTINCT ws.ws_order_number) AS count_orders, SUM(wr.wr_return_quantity) AS total_quantity_returned, AVG(wr.wr_return_amt) AS average_return_amount, COUNT(DISTINCT wr.wr_order_number) AS count_returns FROM web_sales ws INNER JOIN time_dim td ON ws.ws_sold_time_sk = td.t_time_sk INNER JOIN customer_demographics cd ON ws.ws_bill_cdemo_sk = cd.cd_demo_sk INNER JOIN income_band ib ON cd.cd_purchase_estimate BETWEEN ib.ib_lower_bound AND ib.ib_upper_bound LEFT JOIN web_returns wr ON ws.ws_order_number = wr.wr_order_number AND ws.ws_item_sk = wr.wr_item_sk WHERE td.t_shift = 'third' AND td.t_sub_shift = 'night' AND (ib.ib_upper_bound = 10000 OR ib.ib_upper_bound = 20000 OR ib.ib_upper_bound = 130000) GROUP BY td.t_shift, cd.cd_gender, cd.cd_marital_status, cd.cd_education_status, ib.ib_upper_bound ORDER BY total_quantity_sold DESC, average_sales_price DESC;
SELECT cd.cd_gender, cd.cd_marital_status, cd.cd_education_status, cd.cd_credit_rating, COUNT(*) AS total_customers, AVG(cd.cd_purchase_estimate) AS avg_purchase_estimate, SUM(ss.ss_quantity) AS total_quantity_sold, SUM(ss.ss_net_paid) AS total_net_paid, SUM(ss.ss_net_paid_inc_tax) AS total_net_paid_inc_tax, AVG(ss.ss_sales_price) AS avg_sales_price, s.s_state, s.s_city, t.t_shift FROM customer_demographics cd JOIN store_sales ss ON cd.cd_demo_sk = ss.ss_cdemo_sk JOIN store s ON ss.ss_store_sk = s.s_store_sk JOIN time_dim t ON ss.ss_sold_time_sk = t.t_time_sk WHERE cd.cd_dep_count IN (1, 2) AND s.s_market_id IS NOT NULL GROUP BY cd.cd_gender, cd.cd_marital_status, cd.cd_education_status, cd.cd_credit_rating, s.s_state, s.s_city, t.t_shift ORDER BY total_net_paid DESC, s.s_state, s.s_city LIMIT 100;
SELECT dd.d_year, dd.d_quarter_name, COUNT(DISTINCT sr.sr_ticket_number) AS total_store_returns, SUM(sr.sr_return_amt_inc_tax) AS total_store_return_value, AVG(sr.sr_return_amt_inc_tax) AS avg_store_return_value, COUNT(DISTINCT cr.cr_order_number) AS total_catalog_returns, SUM(cr.cr_return_amt_inc_tax) AS total_catalog_return_value, AVG(cr.cr_return_amt_inc_tax) AS avg_catalog_return_value, SUM(inv.inv_quantity_on_hand) AS total_inventory, AVG(inv.inv_quantity_on_hand) AS avg_inventory, COUNT(DISTINCT p.p_promo_sk) AS total_promotions, SUM(p.p_cost) AS total_promotion_cost, AVG(p.p_cost) AS avg_promotion_cost FROM date_dim dd LEFT JOIN store_returns sr ON dd.d_date_sk = sr.sr_returned_date_sk LEFT JOIN catalog_returns cr ON dd.d_date_sk = cr.cr_returned_date_sk LEFT JOIN inventory inv ON dd.d_date_sk = inv.inv_date_sk LEFT JOIN promotion p ON dd.d_date_sk BETWEEN p.p_start_date_sk AND p.p_end_date_sk WHERE dd.d_current_quarter = 'N' AND dd.d_dow IN ('2', '1', '3') AND dd.d_week_seq IN ('357', '270', '599') AND dd.d_day_name IN ('Friday', 'Wednesday', 'Thursday') AND cr.cr_refunded_cash IN ('41.98', '2827.18', '326.60') AND cr.cr_return_tax IN ('78.35', '1.90', '17.50') AND cr.cr_reason_sk IN ('10', '6', '34') AND inv.inv_date_sk = '2450815' AND inv.inv_quantity_on_hand IN ('527', '833', '192') AND sr.sr_store_credit IN ('65.83', '69.57', '46.64') AND sr.sr_return_amt_inc_tax IN ('1345.99', '37.28', '546.00') AND sr.sr_hdemo_sk IN ('5161', '6269', '797') AND p.p_channel_radio = 'N' AND p.p_channel_press = 'N' GROUP BY dd.d_year, dd.d_quarter_name ORDER BY dd.d_year, dd.d_quarter_name;
SELECT ib.ib_income_band_sk, avg(hd.hd_dep_count) AS average_dependents, avg(hd.hd_vehicle_count) AS average_vehicles, sum(cs.cs_quantity) AS total_quantity_sold, sum(cs.cs_net_paid) AS total_net_paid, sum(cs.cs_net_profit) AS total_net_profit, count(DISTINCT cs.cs_order_number) AS total_orders FROM household_demographics hd JOIN income_band ib ON hd.hd_income_band_sk = ib.ib_income_band_sk JOIN catalog_sales cs ON hd.hd_demo_sk = cs.cs_bill_hdemo_sk WHERE hd.hd_dep_count IN (9, 7) AND cs.cs_catalog_page_sk IN (149, 116) AND cs.cs_ext_discount_amt IN (1062.45, 2397.98, 286.76) AND ib.ib_income_band_sk IN (8, 5, 2, 9, 13) GROUP BY ib.ib_income_band_sk ORDER BY total_net_profit DESC;
SELECT ib.ib_lower_bound, ib.ib_upper_bound, hd.hd_dep_count, COUNT(DISTINCT cs.cs_order_number) AS total_sales_orders, AVG(cs.cs_sales_price) AS avg_sales_price, SUM(cs.cs_quantity) AS total_quantity_sold, COUNT(DISTINCT wr.wr_order_number) AS total_return_orders, AVG(wr.wr_return_amt) AS avg_return_amount, SUM(wr.wr_return_quantity) AS total_quantity_returned FROM catalog_sales cs JOIN household_demographics hd ON cs.cs_bill_hdemo_sk = hd.hd_demo_sk JOIN income_band ib ON hd.hd_income_band_sk = ib.ib_income_band_sk LEFT JOIN web_returns wr ON cs.cs_item_sk = wr.wr_item_sk AND cs.cs_order_number = wr.wr_order_number GROUP BY ib.ib_lower_bound, ib.ib_upper_bound, hd.hd_dep_count ORDER BY ib.ib_lower_bound, ib.ib_upper_bound, hd.hd_dep_count;
SELECT cc.cc_division_name, cc.cc_class, wp.wp_type, COUNT(*) AS number_of_calls, SUM(cr.cr_return_quantity) AS total_returned_quantity, AVG(cr.cr_return_amount) AS average_return_amount, SUM(cr.cr_fee) AS total_fee_collected, SUM(cr.cr_return_ship_cost) AS total_shipping_cost, SUM(cr.cr_net_loss) AS total_net_loss FROM call_center AS cc JOIN catalog_returns AS cr ON cc.cc_call_center_sk = cr.cr_call_center_sk JOIN web_page AS wp ON cr.cr_catalog_page_sk = wp.wp_web_page_sk WHERE cc.cc_division_name LIKE '%anti%' AND (cc.cc_class = 'small' OR cc.cc_class = 'large') AND (wp.wp_char_count = 3128 OR wp.wp_char_count = 701 OR wp.wp_char_count = 2129) GROUP BY cc.cc_division_name, cc.cc_class, wp.wp_type ORDER BY cc.cc_division_name, cc.cc_class, wp.wp_type;
