SELECT w.w_warehouse_name, w.w_state, w.w_county, sm.sm_type, sm.sm_carrier, p.p_promo_name, p.p_channel_details, s.s_store_name, s.s_city, s.s_state, SUM(ss.ss_quantity) AS total_quantity_sold, SUM(ss.ss_net_paid) AS total_net_paid, AVG(ss.ss_net_profit) AS average_net_profit, COUNT(DISTINCT ss.ss_customer_sk) AS unique_customers, SUM(wr.wr_return_quantity) AS total_return_quantity, SUM(wr.wr_net_loss) AS total_net_loss FROM warehouse w JOIN store_sales ss ON ss.ss_store_sk = w.w_warehouse_sk JOIN promotion p ON ss.ss_promo_sk = p.p_promo_sk JOIN store s ON ss.ss_store_sk = s.s_store_sk JOIN ship_mode sm ON sm.sm_ship_mode_sk = ss.ss_sold_date_sk LEFT JOIN web_returns wr ON wr.wr_item_sk = ss.ss_item_sk AND wr.wr_order_number = ss.ss_ticket_number WHERE w.w_county = 'Williamson County' AND w.w_street_name IN ('Ash Laurel', 'Wilson Elm', '6th') AND w.w_warehouse_name IN ('Bad cards must make.', 'Important issues liv', 'Doors canno') AND w.w_state = 'TN' AND wr.wr_web_page_sk IN ('18', '44', '3') AND wr.wr_returned_date_sk IN ('2451082', '2451321', '2452281') AND p.p_channel_event = 'N' AND p.p_channel_press = 'N' AND p.p_item_sk IN ('10297', '13006', '12968') AND p.p_promo_name LIKE '%cally%' OR p.p_promo_name LIKE '%able%' OR p.p_promo_name LIKE '%eing%' AND s.s_rec_start_date IN ('1997-03-13', '2001-03-13', '2000-03-13') AND s.s_closed_date_sk IN ('2451044', '2450910', '2451189') AND sm.sm_type IN ('NEXT DAY', 'TWO DAY', 'LIBRARY') AND sm.sm_carrier IN ('AIRBORNE', 'USPS', 'DHL') AND sm.sm_ship_mode_id IN ('AAAAAAAABBAAAAAA', 'AAAAAAAAFAAAAAAA', 'AAAAAAAAOAAAAAAA') AND ss.ss_store_sk IN ('10', '1', '7') AND ss.ss_net_profit IN ('182.58', '990.60', '525.80') AND ss.ss_ext_sales_price IN ('6976.75', '971.85', '10.15') GROUP BY w.w_warehouse_name, w.w_state, w.w_county, sm.sm_type, sm.sm_carrier, p.p_promo_name, p.p_channel_details, s.s_store_name, s.s_city, s.s_state ORDER BY total_net_paid DESC, average_net_profit DESC, total_net_loss ASC;
SELECT w_state, cd_education_status, SUM(cr_return_amount) AS total_return_amount, AVG(cr_return_quantity) AS avg_return_quantity, COUNT(DISTINCT cr_order_number) AS total_orders_returned, SUM(inv_quantity_on_hand) AS total_inventory_on_hand FROM catalog_returns JOIN customer_demographics ON cr_returning_cdemo_sk = cd_demo_sk JOIN warehouse ON cr_warehouse_sk = w_warehouse_sk JOIN inventory ON (catalog_returns.cr_warehouse_sk = inventory.inv_warehouse_sk AND catalog_returns.cr_item_sk = inventory.inv_item_sk) JOIN web_page ON cr_catalog_page_sk = wp_web_page_sk WHERE w_street_type IN ('Drive', 'Dr.', 'Avenue', 'Parkway') AND cd_dep_count IN (1, 2) AND cd_education_status IN ('Secondary', 'Unknown') AND wp_max_ad_count = 2 AND wp_autogen_flag = 'Y' GROUP BY w_state, cd_education_status ORDER BY total_return_amount DESC, avg_return_quantity DESC, total_orders_returned DESC, total_inventory_on_hand DESC;
SELECT i.i_category, AVG(ss.ss_quantity) AS avg_quantity_sold, AVG(ss.ss_sales_price) AS avg_sales_price, AVG(ss.ss_ext_discount_amt) AS avg_discount_amount, COUNT(DISTINCT ss.ss_ticket_number) AS total_sales_tickets, COUNT(DISTINCT hd.hd_demo_sk) AS total_high_income_household FROM store_sales ss JOIN item i ON ss.ss_item_sk = i.i_item_sk JOIN household_demographics hd ON ss.ss_hdemo_sk = hd.hd_demo_sk JOIN income_band ib ON hd.hd_income_band_sk = ib.ib_income_band_sk WHERE ib.ib_lower_bound > ( SELECT AVG(ib_inner.ib_lower_bound) FROM income_band ib_inner ) AND ss.ss_net_paid > 2000 AND hd.hd_vehicle_count BETWEEN 2 AND 4 GROUP BY ROLLUP(i.i_category) ORDER BY i.i_category, avg_sales_price DESC;
SELECT ib.ib_income_band_sk, avg(hd.hd_dep_count) AS average_dependents, avg(hd.hd_vehicle_count) AS average_vehicles, sum(cs.cs_quantity) AS total_quantity_sold, sum(cs.cs_net_paid) AS total_net_paid, sum(cs.cs_net_profit) AS total_net_profit, count(DISTINCT cs.cs_order_number) AS total_orders FROM household_demographics hd JOIN income_band ib ON hd.hd_income_band_sk = ib.ib_income_band_sk JOIN catalog_sales cs ON hd.hd_demo_sk = cs.cs_bill_hdemo_sk WHERE hd.hd_dep_count IN (9, 7) AND cs.cs_catalog_page_sk IN (149, 116) AND cs.cs_ext_discount_amt IN (1062.45, 2397.98, 286.76) AND ib.ib_income_band_sk IN (8, 5, 2, 9, 13) GROUP BY ib.ib_income_band_sk ORDER BY total_net_profit DESC;
SELECT c.c_customer_id, sm.sm_type as shipping_type, count(cs_order_number) as total_orders, sum(cs_quantity) as total_quantity, avg(cs_net_paid) as average_net_paid, sum(cs_net_profit) as total_net_profit, date_part('year', d.d_date) as sale_year, d.d_quarter_name as sale_quarter, ib.ib_lower_bound as income_band_lower_bound, ib.ib_upper_bound as income_band_upper_bound FROM catalog_sales cs JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk JOIN ship_mode sm ON cs.cs_ship_mode_sk = sm.sm_ship_mode_sk JOIN income_band ib ON c.c_current_hdemo_sk = ib.ib_income_band_sk WHERE d.d_year = 2023 AND sm.sm_code = 'SEA' AND ib.ib_lower_bound >= 30001 AND ib.ib_upper_bound <= 80001 GROUP BY c.c_customer_id, shipping_type, sale_year, sale_quarter, income_band_lower_bound, income_band_upper_bound ORDER BY total_net_profit DESC, total_orders DESC;
SELECT s.s_store_name, i.i_category, p.p_channel_details, SUM(cs.cs_net_paid_inc_ship) AS total_sales, SUM(cs.cs_net_profit) AS total_profit, COUNT(DISTINCT cs.cs_order_number) AS total_orders, AVG(cs.cs_quantity) AS average_quantity, SUM(wr.wr_net_loss) AS total_net_loss, COUNT(DISTINCT wr.wr_order_number) AS total_returns, r.r_reason_desc FROM store s JOIN catalog_sales cs ON s.s_store_sk = cs.cs_warehouse_sk JOIN item i ON cs.cs_item_sk = i.i_item_sk LEFT JOIN promotion p ON cs.cs_promo_sk = p.p_promo_sk LEFT JOIN web_returns wr ON cs.cs_item_sk = wr.wr_item_sk AND cs.cs_order_number = wr.wr_order_number LEFT JOIN reason r ON wr.wr_reason_sk = r.r_reason_sk WHERE s.s_country = 'United States' AND ( s.s_store_sk = '8' OR s.s_store_sk = '1' ) AND ( cs.cs_net_paid_inc_ship IN ('6377.67', '3521.76', '158.56', '2257.47', '739.93', '7973.92') ) AND ( r.r_reason_sk IN ('17', '4', '20', '18', '31') OR r.r_reason_sk IS NULL ) AND i.i_class = 'cooking' GROUP BY s.s_store_name, i.i_category, p.p_channel_details, r.r_reason_desc ORDER BY total_sales DESC, total_profit DESC;
SELECT sm.sm_ship_mode_id, sm.sm_type, sm.sm_carrier, COUNT(DISTINCT cr.cr_order_number) AS total_orders_returned, SUM(cr.cr_return_quantity) AS total_quantity_returned, AVG(cr.cr_return_amt_inc_tax) AS avg_refunded_amount_inc_tax, SUM(cr.cr_net_loss) AS total_net_loss FROM catalog_returns cr JOIN ship_mode sm ON cr.cr_ship_mode_sk = sm.sm_ship_mode_sk JOIN time_dim t ON cr.cr_returned_time_sk = t.t_time_sk JOIN date_dim d ON cr.cr_returned_date_sk = d.d_date_sk WHERE d.d_year = 2003 AND sm.sm_carrier IN ('HARMSTORF', 'TBS', 'ZOUROS', 'MSC', 'DIAMOND', 'AIRBORNE') GROUP BY sm.sm_ship_mode_id, sm.sm_type, sm.sm_carrier ORDER BY total_net_loss DESC;
SELECT p.p_promo_name, sm.sm_type AS shipping_mode, COUNT(wr.wr_order_number) AS total_returns, SUM(wr.wr_return_amt_inc_tax) AS total_returned_amount, AVG(wr.wr_return_amt_inc_tax) AS average_return_amount FROM promotion p JOIN web_returns wr ON p.p_promo_sk = wr.wr_reason_sk JOIN inventory i ON wr.wr_item_sk = i.inv_item_sk JOIN warehouse w ON i.inv_warehouse_sk = w.w_warehouse_sk JOIN ship_mode sm ON sm.sm_ship_mode_id = w.w_zip JOIN income_band ib ON ib.ib_income_band_sk = w.w_warehouse_sk WHERE ib.ib_lower_bound >= 30000 AND ib.ib_upper_bound <= 90000 AND i.inv_item_sk IN (14186, 15508, 7795, 15079) AND sm.sm_type = 'EXPRESS' GROUP BY p.p_promo_name, sm.sm_type ORDER BY total_returned_amount DESC;
SELECT s.s_store_name, SUM(ss.ss_quantity) AS total_quantity_sold, AVG(ss.ss_sales_price) AS average_sales_price, SUM(ss.ss_net_profit) AS total_store_profit, w.w_warehouse_name, sm.sm_type, COUNT(DISTINCT ws.ws_order_number) AS total_web_orders, SUM(ws.ws_net_profit) AS total_web_profit, SUM(wr.wr_return_quantity) AS total_return_quantity, SUM(wr.wr_net_loss) AS total_return_loss FROM store s LEFT JOIN store_sales ss ON s.s_store_sk = ss.ss_store_sk LEFT JOIN web_sales ws ON ws.ws_item_sk = ss.ss_item_sk LEFT JOIN web_returns wr ON ws.ws_item_sk = wr.wr_item_sk AND ws.ws_order_number = wr.wr_order_number LEFT JOIN warehouse w ON ws.ws_warehouse_sk = w.w_warehouse_sk LEFT JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk WHERE s.s_market_desc IN ('Little expectations include yet forward meetings.', 'Mysterious employe', 'Events develop i', 'Architects coul') AND w.w_warehouse_id IN ('AAAAAAAADAAAAAAA', 'AAAAAAAACAAAAAAA', 'AAAAAAAAEAAAAAAA', 'AAAAAAAAFAAAAAAA') GROUP BY s.s_store_name, w.w_warehouse_name, sm.sm_type ORDER BY total_quantity_sold DESC, total_web_profit DESC, total_return_loss ASC;
SELECT ca.ca_state, COUNT(DISTINCT cr.cr_order_number) AS total_returns, AVG(cr.cr_return_amount) AS avg_return_amount, SUM(cr.cr_net_loss) AS total_net_loss, COUNT(DISTINCT ss.ss_ticket_number) AS total_sales, AVG(ss.ss_sales_price) AS avg_sales_price, SUM(ss.ss_net_profit) AS total_net_profit FROM customer_address ca LEFT JOIN catalog_returns cr ON ca.ca_address_sk = cr.cr_returning_addr_sk LEFT JOIN store_sales ss ON ca.ca_address_sk = ss.ss_addr_sk LEFT JOIN catalog_page cp ON cr.cr_catalog_page_sk = cp.cp_catalog_page_sk LEFT JOIN inventory inv ON ss.ss_item_sk = inv.inv_item_sk AND cr.cr_item_sk = inv.inv_item_sk WHERE ss.ss_net_paid IN (2118.53, 811.65, 477.37) OR ss.ss_ext_sales_price IN (43.89, 681.72, 440.10, 1852.62, 93.60, 2554.68) GROUP BY ca.ca_state ORDER BY total_net_profit DESC, total_net_loss DESC
SELECT w.w_warehouse_name, w.w_warehouse_sq_ft, AVG(i.inv_quantity_on_hand) AS avg_quantity_on_hand, COUNT(DISTINCT p.p_promo_sk) AS num_promotions, SUM(CASE WHEN p.p_discount_active = 'Y' THEN 1 ELSE 0 END) AS active_discounts FROM warehouse w JOIN inventory i ON w.w_warehouse_sk = i.inv_warehouse_sk LEFT JOIN promotion p ON i.inv_item_sk = p.p_item_sk WHERE w.w_city = 'Fairview' GROUP BY w.w_warehouse_sk, w.w_warehouse_name, w.w_warehouse_sq_ft ORDER BY w.w_warehouse_name;
