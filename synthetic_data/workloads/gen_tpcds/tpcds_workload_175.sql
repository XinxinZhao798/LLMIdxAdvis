SELECT c.ca_state, c.ca_city, COUNT(DISTINCT cust.c_customer_sk) AS total_customers, SUM(CASE WHEN p.p_channel_dmail = 'Y' THEN 1 ELSE 0 END) AS dmail_promo_count, AVG(p.p_cost) AS avg_promotion_cost, MAX(cust.c_birth_year) AS latest_birth_year FROM customer_address c JOIN customer cust ON c.ca_address_sk = cust.c_current_addr_sk LEFT JOIN promotion p ON p.p_start_date_sk <= cust.c_first_sales_date_sk AND p.p_end_date_sk >= cust.c_first_sales_date_sk WHERE cust.c_birth_year > 1980 AND c.ca_country = 'United States' AND (p.p_channel_dmail = 'Y' OR p.p_channel_dmail = 'N') GROUP BY c.ca_state, c.ca_city ORDER BY total_customers DESC, avg_promotion_cost DESC, dmail_promo_count DESC LIMIT 100;
SELECT s.s_store_name, i.i_category, p.p_channel_details, SUM(cs.cs_net_paid_inc_ship) AS total_sales, SUM(cs.cs_net_profit) AS total_profit, COUNT(DISTINCT cs.cs_order_number) AS total_orders, AVG(cs.cs_quantity) AS average_quantity, SUM(wr.wr_net_loss) AS total_net_loss, COUNT(DISTINCT wr.wr_order_number) AS total_returns, r.r_reason_desc FROM store s JOIN catalog_sales cs ON s.s_store_sk = cs.cs_warehouse_sk JOIN item i ON cs.cs_item_sk = i.i_item_sk LEFT JOIN promotion p ON cs.cs_promo_sk = p.p_promo_sk LEFT JOIN web_returns wr ON cs.cs_item_sk = wr.wr_item_sk AND cs.cs_order_number = wr.wr_order_number LEFT JOIN reason r ON wr.wr_reason_sk = r.r_reason_sk WHERE s.s_country = 'United States' AND ( s.s_store_sk = '8' OR s.s_store_sk = '1' ) AND ( cs.cs_net_paid_inc_ship IN ('6377.67', '3521.76', '158.56', '2257.47', '739.93', '7973.92') ) AND ( r.r_reason_sk IN ('17', '4', '20', '18', '31') OR r.r_reason_sk IS NULL ) AND i.i_class = 'cooking' GROUP BY s.s_store_name, i.i_category, p.p_channel_details, r.r_reason_desc ORDER BY total_sales DESC, total_profit DESC;
SELECT hd.hd_buy_potential, AVG(ss.ss_sales_price) AS avg_sales_price, SUM(ss.ss_quantity) AS total_quantity_sold, COUNT(DISTINCT ss.ss_customer_sk) AS unique_customers, SUM(sr.sr_return_amt_inc_tax) AS total_return_amount_incl_tax, COUNT(DISTINCT sr.sr_customer_sk) AS unique_customers_returned FROM store_sales ss LEFT JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk LEFT JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk LEFT JOIN store_returns sr ON ss.ss_customer_sk = sr.sr_customer_sk AND ss.ss_item_sk = sr.sr_item_sk GROUP BY hd.hd_buy_potential ORDER BY total_return_amount_incl_tax DESC;
SELECT d.d_year, d.d_quarter_name, p.p_promo_name, sm.sm_type, SUM(cs.cs_quantity) AS total_quantity_sold, AVG(cs.cs_sales_price) AS average_sales_price, SUM(cs.cs_net_profit) AS total_net_profit, COUNT(DISTINCT cr.cr_order_number) AS total_returns, SUM(cr.cr_return_amount) AS total_return_amount, SUM(ws.ws_net_paid_inc_tax) AS total_web_sales_inc_tax FROM date_dim d JOIN catalog_sales cs ON cs.cs_sold_date_sk = d.d_date_sk JOIN ship_mode sm ON cs.cs_ship_mode_sk = sm.sm_ship_mode_sk JOIN promotion p ON cs.cs_promo_sk = p.p_promo_sk LEFT JOIN catalog_returns cr ON cs.cs_order_number = cr.cr_order_number LEFT JOIN web_sales ws ON cs.cs_order_number = ws.ws_order_number WHERE d.d_year = 2003 AND p.p_channel_details LIKE '%early%' GROUP BY d.d_year, d.d_quarter_name, p.p_promo_name, sm.sm_type ORDER BY total_net_profit DESC, total_quantity_sold DESC LIMIT 100;
SELECT i.i_item_id, i.i_category, w.w_state, w.w_city, COUNT(cr.cr_order_number) AS total_returns, SUM(cr.cr_return_quantity) AS total_returned_quantity, AVG(cr.cr_return_amount) AS avg_return_amount, SUM(cr.cr_return_amount) AS total_return_amount, AVG(cr.cr_return_amt_inc_tax) AS avg_return_amount_incl_tax, SUM(cr.cr_return_amt_inc_tax) AS total_return_amount_incl_tax, SUM(cr.cr_fee) AS total_fees, SUM(cr.cr_return_ship_cost) AS total_shipping_cost, SUM(cr.cr_net_loss) AS total_net_loss FROM catalog_returns cr JOIN item i ON cr.cr_item_sk = i.i_item_sk JOIN warehouse w ON cr.cr_warehouse_sk = w.w_warehouse_sk GROUP BY ROLLUP (i.i_item_id, i.i_category, w.w_state, w.w_city) ORDER BY w.w_state, w.w_city, i.i_category, i.i_item_id;
SELECT s.s_store_name, s.s_street_name, s.s_street_type, s.s_city, s.s_state, s.s_zip, SUM(sr.sr_return_amt_inc_tax) AS total_store_refunds, AVG(sr.sr_return_amt_inc_tax) AS avg_store_refund, COUNT(sr.sr_return_amt_inc_tax) AS num_store_returns, SUM(wr.wr_return_amt_inc_tax) AS total_web_refunds, AVG(wr.wr_return_amt_inc_tax) AS avg_web_refund, COUNT(wr.wr_return_amt_inc_tax) AS num_web_returns FROM store s LEFT JOIN store_returns sr ON s.s_store_sk = sr.sr_store_sk LEFT JOIN date_dim d_store ON sr.sr_returned_date_sk = d_store.d_date_sk LEFT JOIN web_returns wr ON s.s_store_sk = wr.wr_returning_customer_sk LEFT JOIN date_dim d_web ON wr.wr_returned_date_sk = d_web.d_date_sk WHERE s.s_street_type IN ('Road', 'Circle', 'Court') AND (d_store.d_quarter_name = '1906Q2' OR d_web.d_quarter_name = '1906Q2') GROUP BY s.s_store_name, s.s_street_name, s.s_street_type, s.s_city, s.s_state, s.s_zip ORDER BY total_store_refunds DESC, total_web_refunds DESC;
SELECT i_category, i_class, COUNT(DISTINCT ss_ticket_number) AS total_sales_transactions, SUM(ss_sales_price) AS total_sales_revenue, AVG(ss_sales_price) AS avg_sales_price, SUM(cr_return_amount) AS total_return_revenue, AVG(cr_return_amount) AS avg_return_amount, SUM(sr_return_amt) AS total_store_return_revenue, AVG(sr_return_amt) AS avg_store_return_amount, (SUM(ss_sales_price) - SUM(cr_return_amount) - SUM(sr_return_amt)) AS net_revenue, SUM(inv_quantity_on_hand) AS total_inventory_quantity, COUNT(DISTINCT inv_warehouse_sk) AS num_warehouses_stocking FROM item LEFT JOIN store_sales ON store_sales.ss_item_sk = item.i_item_sk LEFT JOIN catalog_returns ON catalog_returns.cr_item_sk = item.i_item_sk LEFT JOIN store_returns ON store_returns.sr_item_sk = item.i_item_sk LEFT JOIN inventory ON inventory.inv_item_sk = item.i_item_sk WHERE i_manufact = 'oughtought' AND (inventory.inv_item_sk = 14212 OR inventory.inv_item_sk = 6826) AND inventory.inv_date_sk = 2450815 AND store_sales.ss_list_price = 145.48 GROUP BY i_category, i_class ORDER BY net_revenue DESC;
SELECT cc_state, cc_city, ca_country, COUNT(DISTINCT cc_call_center_sk) AS number_of_call_centers, SUM(cc_employees) AS total_employees, AVG(cc_tax_percentage) AS avg_tax_percentage, SUM(s_number_employees) AS total_store_employees, AVG(s_tax_precentage) AS avg_store_tax, SUM(ws_quantity) AS total_items_sold, SUM(ws_net_paid) AS total_revenue, SUM(ws_net_profit) AS total_profit, AVG(ws_net_profit) AS avg_profit_per_sale, SUM(ws_ext_ship_cost) AS total_shipping_cost FROM call_center JOIN store ON cc_zip = s_zip JOIN web_sales ON ws_ship_addr_sk IN (SELECT ca_address_sk FROM customer_address WHERE ca_zip = cc_zip) JOIN customer_address ON cc_zip = ca_zip WHERE cc_hours IN ('8AM-4PM', '8AM-8AM') AND ws_net_profit NOT IN (-1167.89, -63.88, -192.70, -49.59) AND ca_country = 'United States' AND ca_gmt_offset IN (-8.00, -9.00) GROUP BY cc_state, cc_city, ca_country ORDER BY total_profit DESC;
SELECT cp.cp_department, AVG(cr.cr_return_amt_inc_tax) AS avg_return_amount, SUM(cr.cr_return_quantity) AS total_return_quantity, COUNT(cr.cr_item_sk) AS return_count, AVG(t.t_time) AS avg_time_spent_on_page FROM catalog_returns cr JOIN catalog_page cp ON cr.cr_catalog_page_sk = cp.cp_catalog_page_sk JOIN customer c ON cr.cr_returning_customer_sk = c.c_customer_sk JOIN web_page wp ON c.c_customer_sk = wp.wp_customer_sk JOIN time_dim t ON cr.cr_returned_time_sk = t.t_time_sk WHERE c.c_preferred_cust_flag = 'Y' AND cp.cp_catalog_number IN (4, 47) AND cp.cp_catalog_page_id IN ('AAAAAAAALNKAAAAA', 'AAAAAAAAEHFAAAAA', 'AAAAAAAAMAIAAAAA', 'AAAAAAAAAAKAAAAA') AND wp.wp_web_page_sk IN (57, 25, 50, 44, 55) AND wp.wp_customer_sk IN (10897, 84146, 37285, 92078) AND t.t_time_id IN ('AAAAAAAAAKCBAAAA', 'AAAAAAAACKOAAAAA') GROUP BY cp.cp_department ORDER BY avg_return_amount DESC, total_return_quantity DESC, return_count DESC;
SELECT s.s_store_name, s.s_city, ca.ca_state, COUNT(DISTINCT ss.ss_ticket_number) AS store_sales_count, SUM(ss.ss_net_paid) AS total_store_sales_revenue, COUNT(DISTINCT sr.sr_ticket_number) AS store_returns_count, SUM(sr.sr_return_amt) AS total_store_returns_revenue, COUNT(DISTINCT cs.cs_order_number) AS catalog_sales_count, SUM(cs.cs_net_paid) AS total_catalog_sales_revenue, COUNT(DISTINCT cr.cr_order_number) AS catalog_returns_count, SUM(cr.cr_return_amount) AS total_catalog_returns_revenue, w.w_warehouse_name, SUM(cr.cr_fee) AS total_cr_fee, AVG(cr.cr_return_amount) AS avg_catalog_return_amount, MAX(ss.ss_net_profit) AS max_store_sale_profit FROM store AS s LEFT JOIN store_sales AS ss ON s.s_store_sk = ss.ss_store_sk LEFT JOIN store_returns AS sr ON s.s_store_sk = sr.sr_store_sk LEFT JOIN warehouse AS w ON w.w_city = s.s_city AND w.w_county = s.s_county LEFT JOIN catalog_sales AS cs ON cs.cs_warehouse_sk = w.w_warehouse_sk LEFT JOIN catalog_returns AS cr ON cr.cr_warehouse_sk = w.w_warehouse_sk LEFT JOIN customer_address AS ca ON ca.ca_address_sk = sr.sr_addr_sk WHERE s.s_company_id = 1 AND s.s_geography_class = 'Unknown' AND w.w_city = 'Fairview' AND w.w_county = 'Williamson County' AND cr.cr_fee IN ('26.50', '75.45', '76.31', '11.75', '16.52', '56.95') AND cr.cr_ship_mode_sk IN ('8', '20', '4', '1', '11') AND sr.sr_addr_sk IN ('11867', '40243') AND sr.sr_reversed_charge IN ('0.68', '96.26', '6.63', '3.63') GROUP BY s.s_store_name, s.s_city, ca.ca_state, w.w_warehouse_name ORDER BY total_store_sales_revenue DESC;
SELECT d_year, SUM(ws_net_profit) AS total_net_profit, AVG(ws_quantity) AS average_quantity_sold, COUNT(DISTINCT ws.ws_web_page_sk) AS count_distinct_pages, SUM(wr_return_amt) AS total_return_amount, AVG(wr_return_quantity) AS average_return_quantity, COUNT(DISTINCT wr.wr_item_sk) AS count_distinct_returned_items FROM web_sales ws JOIN date_dim dd ON ws.ws_sold_date_sk = dd.d_date_sk LEFT JOIN web_returns wr ON ws.ws_item_sk = wr.wr_item_sk AND ws.ws_order_number = wr.wr_order_number LEFT JOIN web_page wp ON ws.ws_web_page_sk = wp.wp_web_page_sk WHERE dd.d_moy IN ('8', '11') AND dd.d_current_week = 'N' AND ws.ws_web_page_sk IN ('58', '41', '42', '15', '20') AND ws.ws_ext_list_price = 4407.89 AND (wp.wp_rec_end_date IN ('1999-09-03', '2001-09-02', '2000-09-02') OR wp.wp_creation_date_sk IN (2450815, 2450812, 2450813)) AND wr.wr_return_amt IN (78.84, 5987.96, 1527.93, 522.48, 1155.36, 2771.56) AND wr.wr_return_amt_inc_tax = 191.45 GROUP BY dd.d_year;
SELECT ca_state, sm_type, COUNT(DISTINCT ca_address_sk) AS num_addresses, AVG(w_warehouse_sq_ft) AS avg_warehouse_sq_ft, SUM(CASE WHEN ib_upper_bound <= 70000 THEN 1 ELSE 0 END) AS count_income_band_70k_and_below, SUM(CASE WHEN ib_upper_bound > 70000 AND ib_upper_bound <= 80000 THEN 1 ELSE 0 END) AS count_income_band_70k_to_80k FROM customer_address JOIN warehouse ON ca_county = w_county AND ca_state = w_state JOIN ship_mode ON ca_zip = LEFT(w_zip, 5) JOIN income_band ON ca_gmt_offset = w_gmt_offset WHERE ca_street_name IN ('Sixth 2nd', 'Lincoln 5th', '15th Broadway') AND sm_code IN ('SEA', 'BIKE', 'AIR', 'SURFACE') GROUP BY ca_state, sm_type ORDER BY ca_state, sm_type;
SELECT i.i_category, i.i_brand, w.w_state, w.w_country, AVG(i.i_current_price) AS avg_price, SUM(i.i_wholesale_cost) AS total_wholesale_cost, COUNT(DISTINCT i.i_item_sk) AS item_count, SUM(inv.inv_quantity_on_hand) AS total_quantity_on_hand FROM item i JOIN inventory inv ON i.i_item_sk = inv.inv_item_sk JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk WHERE w.w_zip = '35709' AND w.w_gmt_offset = -5.00 AND inv.inv_quantity_on_hand > 258 GROUP BY i.i_category, i.i_brand, w.w_state, w.w_country ORDER BY i.i_category, i.i_brand;
SELECT s_state, s_city, p_channel_demo, p_promo_name, COUNT(DISTINCT sr_ticket_number) AS total_returns, SUM(sr_return_quantity) AS total_returned_quantity, AVG(sr_return_amt) AS average_return_amount, SUM(sr_net_loss) AS total_net_loss, COUNT(DISTINCT ss_ticket_number) AS total_sales, SUM(ss_quantity) AS total_sold_quantity, AVG(ss_sales_price) AS average_sales_price, SUM(ss_net_profit) AS total_net_profit FROM store_returns sr JOIN store s ON sr.sr_store_sk = s.s_store_sk JOIN store_sales ss ON sr.sr_item_sk = ss.ss_item_sk AND sr.sr_ticket_number = ss.ss_ticket_number JOIN promotion p ON ss.ss_promo_sk = p.p_promo_sk GROUP BY s_state, s_city, p_channel_demo, p_promo_name ORDER BY s_state, s_city, p_channel_demo, p_promo_name;
SELECT dd.d_year, dd.d_quarter_name, cp.cp_department, COUNT(DISTINCT cs.cs_order_number) AS total_orders, SUM(cs.cs_quantity) AS total_quantity_sold, SUM(cs.cs_net_paid) AS total_net_paid, AVG(cs.cs_net_paid / cs.cs_quantity) AS avg_net_paid_per_item, SUM(cs.cs_net_profit) AS total_net_profit FROM catalog_sales cs JOIN date_dim dd ON cs.cs_sold_date_sk = dd.d_date_sk JOIN catalog_page cp ON cs.cs_catalog_page_sk = cp.cp_catalog_page_sk WHERE dd.d_current_day = 'N' AND dd.d_qoy = '3' AND cs.cs_ship_hdemo_sk IN ('340', '2787', '2515', '487', '576', '6271') AND cp.cp_catalog_page_sk IN ('1948', '1122', '4477', '1780') GROUP BY dd.d_year, dd.d_quarter_name, cp.cp_department ORDER BY dd.d_year, dd.d_quarter_name, cp.cp_department;
SELECT d_year, d_quarter_name, cp_department, c_birth_country, COUNT(DISTINCT ws_order_number) AS total_orders, SUM(ws_quantity) AS total_quantity, AVG(ws_sales_price) AS average_sales_price, SUM(ws_net_paid) AS total_net_paid, SUM(ws_net_profit) AS total_net_profit FROM web_sales JOIN date_dim ON web_sales.ws_sold_date_sk = date_dim.d_date_sk JOIN customer ON web_sales.ws_bill_customer_sk = customer.c_customer_sk JOIN catalog_page ON web_sales.ws_web_page_sk = catalog_page.cp_catalog_page_sk WHERE d_year = 2001 AND d_quarter_name IN ('1901Q1', '1911Q1', '1910Q2') AND ws_ext_discount_amt IN (262.20, 1117.90, 736.02) AND c_birth_country IS NOT NULL GROUP BY d_year, d_quarter_name, cp_department, c_birth_country ORDER BY d_year, d_quarter_name, cp_department, c_birth_country;
SELECT cc.cc_name, cc.cc_manager, sm.sm_type, COUNT(cs.cs_order_number) AS total_orders, SUM(cs.cs_quantity) AS total_quantity, AVG(cs.cs_net_paid) AS avg_payment, SUM(cs.cs_net_profit) AS total_profit, SUM(cs.cs_coupon_amt) AS total_coupons, p.p_promo_name, COUNT(DISTINCT c.c_customer_sk) AS unique_customers FROM call_center cc JOIN catalog_sales cs ON cc.cc_call_center_sk = cs.cs_call_center_sk JOIN ship_mode sm ON cs.cs_ship_mode_sk = sm.sm_ship_mode_sk JOIN promotion p ON cs.cs_promo_sk = p.p_promo_sk JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk WHERE cc.cc_open_date_sk IN ('2450952', '2450806', '2451063') AND cc.cc_manager IN ('Bob Belcher', 'Felipe Perkins', 'Larry Mccray', 'Mark Hightower') AND cs.cs_ext_sales_price IN ('8162.40', '242.11', '869.67', '42.33') AND c.c_birth_country IN ('GERMANY', 'YEMEN', 'SWAZILAND', 'MARTINIQUE', 'ROMANIA') AND c.c_customer_sk IN ('758', '3345') GROUP BY cc.cc_name, cc.cc_manager, sm.sm_type, p.p_promo_name ORDER BY total_profit DESC, total_orders DESC, avg_payment DESC;
SELECT cc.cc_call_center_id, cc.cc_name, cc.cc_city, cp.cp_type, COUNT(DISTINCT ss.ss_ticket_number) AS total_sales_transactions, SUM(ss.ss_quantity) AS total_items_sold, SUM(ss.ss_net_paid) AS total_net_sales, AVG(ss.ss_sales_price) AS average_sales_price, SUM(ss.ss_ext_discount_amt) AS total_discount_amount, AVG(ss.ss_quantity) AS average_quantity_per_transaction FROM store_sales ss JOIN call_center cc ON ss.ss_store_sk = cc.cc_call_center_sk JOIN catalog_page cp ON ss.ss_item_sk = cp.cp_catalog_page_sk WHERE ss.ss_customer_sk IN ('79119', '51420') GROUP BY cc.cc_call_center_id, cc.cc_name, cc.cc_city, cp.cp_type ORDER BY total_net_sales DESC, average_sales_price DESC;
SELECT dd.d_year, dd.d_quarter_name, SUM(cs.cs_quantity) AS total_catalog_quantity, AVG(cs.cs_sales_price) AS average_catalog_sales_price, SUM(cs.cs_net_profit) AS total_catalog_net_profit, SUM(ws.ws_quantity) AS total_web_quantity, AVG(ws.ws_sales_price) AS average_web_sales_price, SUM(ws.ws_net_profit) AS total_web_net_profit, SUM(cs.cs_quantity) + SUM(ws.ws_quantity) AS total_combined_quantity, AVG(cs.cs_sales_price * cs.cs_quantity + ws.ws_sales_price * ws.ws_quantity) / AVG(cs.cs_quantity + ws.ws_quantity) AS average_combined_sales_price, SUM(cs.cs_net_profit) + SUM(ws.ws_net_profit) AS total_combined_net_profit FROM date_dim dd LEFT JOIN catalog_sales cs ON dd.d_date_sk = cs.cs_sold_date_sk LEFT JOIN web_sales ws ON dd.d_date_sk = ws.ws_sold_date_sk WHERE dd.d_year = 2001 AND dd.d_current_quarter = 'N' GROUP BY dd.d_year, dd.d_quarter_name ORDER BY dd.d_year, dd.d_quarter_name;
SELECT sm.sm_type AS Ship_Mode_Type, web.web_name AS Website_Name, COUNT(*) AS Total_Orders, SUM(cs.cs_quantity) AS Total_Quantity_Sold, AVG(cs.cs_sales_price) AS Average_Sales_Price, SUM(cs.cs_net_paid) AS Total_Net_Paid, SUM(cs.cs_net_profit) AS Total_Net_Profit, AVG(inv.inv_quantity_on_hand) AS Average_Inventory_On_Hand FROM catalog_sales cs JOIN ship_mode sm ON sm.sm_ship_mode_sk = cs.cs_ship_mode_sk JOIN web_site web ON web.web_site_sk = cs.cs_ship_customer_sk JOIN inventory inv ON inv.inv_item_sk = cs.cs_item_sk AND inv.inv_warehouse_sk = cs.cs_warehouse_sk JOIN time_dim td ON td.t_time_sk = cs.cs_sold_time_sk WHERE td.t_minute IN ('40', '56', '11', '1', '36') AND web.web_company_id IN ('3', '5', '6', '1', '4', '2') AND cs.cs_sold_time_sk IN ('40476', '14275', '33265', '81680') GROUP BY sm.sm_type, web.web_name ORDER BY Total_Net_Paid DESC, Website_Name, Ship_Mode_Type;
SELECT cp.cp_department, COUNT(DISTINCT cr.cr_order_number) AS total_returns, SUM(cr.cr_return_amount) AS total_return_amount, AVG(cr.cr_return_amount) AS avg_return_amount, SUM(cr.cr_return_quantity) AS total_return_quantity, AVG(cr.cr_fee) AS avg_fee, i.i_category, i.i_class, COUNT(DISTINCT c.c_customer_sk) AS total_customers, AVG(hd.hd_vehicle_count) AS avg_vehicle_count, SUM(wr.wr_account_credit) AS total_account_credit FROM catalog_page cp JOIN catalog_returns cr ON cp.cp_catalog_page_sk = cr.cr_catalog_page_sk JOIN item i ON cr.cr_item_sk = i.i_item_sk JOIN customer c ON cr.cr_returning_customer_sk = c.c_customer_sk JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk JOIN web_returns wr ON i.i_item_sk = wr.wr_item_sk AND cr.cr_order_number = wr.wr_order_number WHERE i.i_formulation IN ('83313678042thistle61', '41681222olive4963389', '57585sienna024168653') AND i.i_product_name IN ('oughtbarn stpri', 'oughteingeingable', 'barcallycally', 'antieseantiable', 'antiprioughtable', 'priationpri') AND wr.wr_account_credit IN ('8.73', '59.44', '133.59') AND hd.hd_vehicle_count IN ('4', '2', '0', '1') AND c.c_email_address = 'Andrew.Lowery@T7T4.com' GROUP BY cp.cp_department, i.i_category, i.i_class ORDER BY total_return_amount DESC, avg_vehicle_count DESC, total_account_credit DESC;
SELECT ca_state, i_category, COUNT(DISTINCT sr_customer_sk) AS unique_customers, SUM(sr_return_quantity) AS total_returned_quantity, AVG(sr_return_amt) AS average_return_amount, SUM(sr_return_amt) AS total_return_amount, SUM(sr_fee) AS total_fees_collected, SUM(sr_net_loss) AS total_net_loss FROM store_returns JOIN item ON sr_item_sk = i_item_sk JOIN customer_address ON sr_addr_sk = ca_address_sk WHERE sr_returned_date_sk IS NOT NULL AND sr_store_sk IN (4, 8, 10, 7, 2) AND ca_street_type = 'Cir.' GROUP BY ca_state, i_category ORDER BY ca_state, i_category;
SELECT AVG(ws.ws_sales_price) AS average_sales_price, SUM(ws.ws_ext_discount_amt) AS total_discount_amount, COUNT(DISTINCT p.p_promo_sk) AS number_of_promotions FROM web_sales ws JOIN promotion p ON ws.ws_promo_sk = p.p_promo_sk JOIN store s ON s.s_zip = '31904' JOIN web_page wp ON ws.ws_web_page_sk = wp.wp_web_page_sk WHERE wp.wp_image_count IN (2, 3, 5) AND wp.wp_autogen_flag = 'N' AND (s.s_street_name = 'Lee 6th' OR s.s_street_name = '4th') AND p.p_channel_press = 'N' AND ws.ws_bill_hdemo_sk IN (2055, 5724, 3336) AND p.p_cost = 1000.00 GROUP BY s.s_market_id;
SELECT s_state, COUNT(DISTINCT ss_customer_sk) as total_customers, SUM(ss_quantity) as total_quantity_sold, AVG(ss_sales_price) as average_sales_price, SUM(ss_net_profit) as total_net_profit, SUM(cr_return_amount) as total_return_amount, AVG(hd_dep_count) as average_dependent_count FROM store_sales JOIN store ON ss_store_sk = s_store_sk JOIN catalog_returns ON ss_item_sk = cr_item_sk AND ss_ticket_number = cr_order_number JOIN household_demographics ON ss_hdemo_sk = hd_demo_sk GROUP BY s_state ORDER BY total_net_profit DESC LIMIT 10;
SELECT dd.d_year, dd.d_quarter_name, ca.ca_state, ca.ca_country, SUM(cs.cs_quantity) AS total_quantity_sold, AVG(cs.cs_sales_price) AS average_sales_price, COUNT(DISTINCT cs.cs_order_number) AS total_orders, SUM(cs.cs_net_paid_inc_ship_tax) AS total_revenue, SUM(cs.cs_net_profit) AS total_profit FROM catalog_sales cs JOIN date_dim dd ON cs.cs_sold_date_sk = dd.d_date_sk JOIN customer_address ca ON cs.cs_bill_addr_sk = ca.ca_address_sk JOIN store s ON cs.cs_warehouse_sk = s.s_store_sk WHERE dd.d_year = 2002 AND ca.ca_country = 'United States' AND s.s_division_id = 1 AND ( dd.d_week_seq IN (54, 685, 542) OR dd.d_quarter_seq IN (43, 26, 39) ) AND ( cs.cs_item_sk IN (58, 10, 49) OR cs.cs_warehouse_sk IN (3, 2, 4) ) AND cs.cs_net_paid_inc_ship_tax IN (2242.98, 10093.84, 2662.12) GROUP BY dd.d_year, dd.d_quarter_name, ca.ca_state, ca.ca_country ORDER BY total_revenue DESC, total_profit DESC LIMIT 100;
