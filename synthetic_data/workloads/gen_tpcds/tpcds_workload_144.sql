SELECT cp.cp_department, AVG(cr.cr_return_amount) AS avg_return_amount, SUM(cr.cr_return_amount) AS total_return_amount, COUNT(cr.cr_return_amount) AS num_returns, AVG(cs.cs_sales_price) AS avg_sales_price, SUM(cs.cs_sales_price) AS total_sales, COUNT(cs.cs_sales_price) AS num_sales, ca.ca_state, COUNT(DISTINCT ca.ca_city) AS num_cities FROM catalog_page cp JOIN catalog_sales cs ON cp.cp_catalog_page_sk = cs.cs_catalog_page_sk JOIN catalog_returns cr ON cp.cp_catalog_page_sk = cr.cr_catalog_page_sk JOIN customer_address ca ON cs.cs_ship_addr_sk = ca.ca_address_sk WHERE cp.cp_catalog_number IN (29, 40) AND cr.cr_refunded_cdemo_sk = 1173022 GROUP BY cp.cp_department, ca.ca_state ORDER BY total_return_amount DESC, total_sales DESC;
SELECT i.i_category, cc.cc_city, cc.cc_state, sum(cr.cr_return_amount) as total_return_amount, avg(cr.cr_return_amount) as avg_return_amount, count(cr.cr_order_number) as total_returns, count(DISTINCT cr.cr_returning_customer_sk) as unique_customers_returning, sum(cr.cr_return_quantity) as total_returned_items, sum(cr.cr_net_loss) as total_net_loss FROM catalog_returns cr JOIN call_center cc ON cr.cr_call_center_sk = cc.cc_call_center_sk JOIN item i ON cr.cr_item_sk = i.i_item_sk JOIN customer c ON cr.cr_returning_customer_sk = c.c_customer_sk JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk WHERE hd.hd_buy_potential IN ('0-500', 'Unknown') AND cc.cc_mkt_id IN (6, 2, 5) AND cr.cr_returning_cdemo_sk IN (877247, 315703, 978233, 1405433, 1704734, 711632) AND i.i_brand_id IN (9010001, 7011009, 9008009, 7006004, 6013007, 6016005) AND i.i_category IN ('Sports', 'Books', 'Shoes') GROUP BY i.i_category, cc.cc_city, cc.cc_state ORDER BY total_return_amount DESC, avg_return_amount DESC;
SELECT sm.sm_type, p.p_promo_name, hd.hd_income_band_sk, COUNT(DISTINCT cs.cs_order_number) AS total_orders, SUM(cs.cs_quantity) AS total_quantity, AVG(cs.cs_sales_price) AS avg_sales_price, SUM(cs.cs_net_paid) AS total_net_paid, SUM(cs.cs_net_paid_inc_tax) AS total_net_paid_inc_tax, SUM(cs.cs_net_paid_inc_ship) AS total_net_paid_inc_ship, SUM(cs.cs_net_paid_inc_ship_tax) AS total_net_paid_inc_ship_tax, SUM(cs.cs_net_profit) AS total_net_profit FROM catalog_sales cs JOIN ship_mode sm ON cs.cs_ship_mode_sk = sm.sm_ship_mode_sk JOIN promotion p ON cs.cs_promo_sk = p.p_promo_sk JOIN household_demographics hd ON cs.cs_ship_hdemo_sk = hd.hd_demo_sk WHERE sm.sm_ship_mode_sk IN (15, 11, 1) AND sm.sm_type IN ('TWO DAY', 'EXPRESS', 'NEXT DAY') AND p.p_channel_details IN ('Only red systems ring right b', 'Strong cells could dis', 'Finally glad reasons mobili') AND p.p_channel_dmail IN ('N', 'Y') AND p.p_promo_name LIKE '%ese%' OR p.p_promo_name LIKE '%eing%' OR p.p_promo_name LIKE '%able%' AND p.p_purpose = 'Unknown' AND hd.hd_income_band_sk IN (11, 1, 6) AND hd.hd_dep_count IN (5, 0, 2) AND cs.cs_ship_customer_sk IN (6024, 65323, 92049) AND cs.cs_ext_ship_cost IN (36.27, 943.02, 662.47) GROUP BY sm.sm_type, p.p_promo_name, hd.hd_income_band_sk ORDER BY total_net_profit DESC, avg_sales_price DESC, total_orders DESC;
SELECT w_state, ib_income_band_sk, COUNT(DISTINCT cs_order_number) AS total_orders, SUM(cs_quantity) AS total_quantity, AVG(cs_net_paid) AS average_net_paid, SUM(cs_net_profit) AS total_profit, COUNT(DISTINCT ws_order_number) AS total_web_orders, SUM(ws_quantity) AS total_web_quantity, AVG(ws_net_paid_inc_ship) AS average_web_net_paid_inc_ship, SUM(ws_net_profit) AS total_web_profit, COUNT(DISTINCT wr_order_number) AS total_returns, SUM(wr_return_quantity) AS total_returned_quantity, AVG(wr_return_amt_inc_tax) AS average_return_amount_inc_tax, SUM(wr_net_loss) AS total_net_loss FROM warehouse w JOIN catalog_sales cs ON w.w_warehouse_sk = cs.cs_warehouse_sk JOIN household_demographics hd ON cs.cs_bill_hdemo_sk = hd.hd_demo_sk JOIN income_band ib ON hd.hd_income_band_sk = ib.ib_income_band_sk JOIN web_sales ws ON w.w_warehouse_sk = ws.ws_warehouse_sk JOIN web_returns wr ON ws.ws_order_number = wr.wr_order_number WHERE w.w_county = 'Williamson County' AND w.w_warehouse_sk IN (2, 3) AND cs.cs_ship_addr_sk IN (27775, 21962, 3537, 27769) AND wr.wr_refunded_customer_sk IN (51283, 671, 63734, 16023, 8581, 84835) AND ib.ib_lower_bound IN (80001, 30001, 0, 140001, 110001) GROUP BY w_state, ib_income_band_sk ORDER BY w_state, ib_income_band_sk;
SELECT p_channel_dmail, p_channel_email, p_channel_catalog, p_channel_tv, p_channel_radio, p_channel_press, p_channel_event, p_channel_demo, AVG(p_cost) AS average_promo_cost, SUM(p_cost) AS total_promo_cost, COUNT(p_promo_sk) AS number_of_promotions, SUM(inv_quantity_on_hand) AS total_inventory, AVG(inv_quantity_on_hand) AS average_inventory, COUNT(DISTINCT inv_item_sk) AS distinct_items_in_inventory, MIN(ib_lower_bound) AS min_income_band_lower_bound, MAX(ib_upper_bound) AS max_income_band_upper_bound FROM promotion JOIN inventory ON promotion.p_item_sk = inventory.inv_item_sk LEFT JOIN income_band ON inventory.inv_quantity_on_hand BETWEEN income_band.ib_lower_bound AND income_band.ib_upper_bound WHERE p_response_target = 1 AND ib_income_band_sk IN (10, 19, 13) AND inv_item_sk = 15788 AND inv_quantity_on_hand IN (329, 356, 513, 875, 262) AND p_discount_active = 'Y' GROUP BY p_channel_dmail, p_channel_email, p_channel_catalog, p_channel_tv, p_channel_radio, p_channel_press, p_channel_event, p_channel_demo ORDER BY number_of_promotions DESC, total_promo_cost DESC;
SELECT cc.cc_call_center_id, cc.cc_name, cc.cc_city, cc.cc_state, COUNT(cs.cs_order_number) AS total_orders, SUM(cs.cs_net_paid) AS total_sales_amount, AVG(cs.cs_sales_price) AS average_sales_amount_per_order, MAX(cs.cs_sales_price) AS max_sale_amount, AVG(cs.cs_ext_discount_amt) AS average_discount_amount, SUM(cs.cs_ext_tax) AS total_tax_collected, COUNT(DISTINCT cs.cs_bill_customer_sk) AS unique_customers FROM call_center cc JOIN catalog_sales cs ON cc.cc_call_center_sk = cs.cs_call_center_sk JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk WHERE d.d_date BETWEEN '2023-01-01'::DATE AND '2023-12-31'::DATE AND cs.cs_list_price > 100 GROUP BY cc.cc_call_center_id, cc.cc_name, cc.cc_city, cc.cc_state ORDER BY total_sales_amount DESC, average_sales_amount_per_order DESC;
SELECT dd.d_year, dd.d_quarter_name, SUM(cs.cs_quantity) AS total_quantity_sold, AVG(cs.cs_sales_price) AS average_sales_price, COUNT(DISTINCT cs.cs_order_number) AS total_orders, SUM(cs.cs_net_profit) AS total_net_profit, cc.cc_name AS call_center_name, cc.cc_division_name AS call_center_division, cc.cc_city AS call_center_city FROM catalog_sales cs JOIN date_dim dd ON cs.cs_sold_date_sk = dd.d_date_sk JOIN call_center cc ON cs.cs_call_center_sk = cc.cc_call_center_sk WHERE dd.d_qoy IN (1, 2, 3, 4) AND dd.d_dom IN (20, 24) AND cc.cc_sq_ft IN ('4134', '1138', '2268') AND cc.cc_division IN ('1', '4') GROUP BY dd.d_year, dd.d_quarter_name, cc.cc_name, cc.cc_division_name, cc.cc_city ORDER BY dd.d_year, dd.d_quarter_name, total_net_profit DESC;
