SELECT ca_state, SUM(hd_dep_count) AS total_dependents, AVG(hd_vehicle_count) AS avg_vehicles, COUNT(DISTINCT ca_address_sk) AS total_addresses, SUM(CASE WHEN p_channel_email = '1' THEN p_response_target ELSE 0 END) AS email_promo_targets, AVG(inv_quantity_on_hand) AS avg_inventory_on_hand FROM customer_address ca JOIN household_demographics hd ON ca.ca_address_sk = hd.hd_demo_sk JOIN promotion p ON ca.ca_address_sk = p.p_promo_sk JOIN inventory i ON ca.ca_address_sk = i.inv_warehouse_sk GROUP BY ca_state ORDER BY ca_state;
SELECT c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address, sum(i.i_current_price) AS total_spent, avg(i.i_wholesale_cost) AS average_wholesale_cost, count(DISTINCT cp.cp_catalog_page_sk) AS number_of_catalog_pages, count(DISTINCT web.web_site_sk) AS number_of_websites_visited, sm.sm_type AS shipping_type, sm.sm_code AS shipping_code FROM customer c JOIN catalog_page cp ON c.c_first_shipto_date_sk = cp.cp_start_date_sk JOIN item i ON i.i_category_id = cp.cp_catalog_number JOIN web_site web ON web.web_open_date_sk = c.c_first_sales_date_sk JOIN ship_mode sm ON sm.sm_ship_mode_sk = web.web_site_sk WHERE i.i_brand_id IN ('6016004', '7006002', '6004007') AND i.i_manufact_id IN ('86', '35', '590') AND web.web_suite_number IN ('Suite 330', 'Suite R', 'Suite Q') AND web.web_open_date_sk IN ('2450798', '2450654', '2450756') AND cp.cp_catalog_page_number IN ('93', '92', '1') AND cp.cp_start_date_sk IN ('2451088', '2451180', '2451271') AND cp.cp_department = 'DEPARTMENT' AND cp.cp_catalog_number IN ('19', '13', '33') AND sm.sm_code IN ('BIKE', 'SURFACE', 'SEA') AND sm.sm_type IN ('REGULAR', 'NEXT DAY', 'LIBRARY') AND c.c_salutation IN ('Ms.', 'Mr.', 'Miss') AND c.c_first_name IN ('Arturo', 'Gudrun', 'Douglas') AND c.c_birth_country IN ('ISLE OF MAN', 'AMERICAN SAMOA', 'EQUATORIAL GUINEA') AND c.c_customer_sk IN ('4875', '3748', '2364') GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address, sm.sm_type, sm.sm_code ORDER BY total_spent DESC LIMIT 100;
SELECT w_state, p_purpose, COUNT(DISTINCT wp_web_page_sk) AS total_web_pages, SUM(wp_image_count) AS total_images, AVG(wp_char_count) AS avg_char_count, SUM(CASE WHEN wp_web_page_id IN ('AAAAAAAAOAAAAAAA', 'AAAAAAAAJBAAAAAA', 'AAAAAAAAEBAAAAAA', 'AAAAAAAALCAAAAAA', 'AAAAAAAACAAAAAAA', 'AAAAAAAAGBAAAAAA') THEN 1 ELSE 0 END) AS targeted_web_pages_count, SUM(CASE WHEN t_shift = 'third' THEN 1 ELSE 0 END) AS third_shift_count, AVG(w_warehouse_sq_ft) AS avg_warehouse_size FROM warehouse JOIN promotion ON w_warehouse_sk = p_item_sk JOIN web_page ON wp_customer_sk = w_warehouse_sk JOIN time_dim ON t_time_sk = wp_creation_date_sk WHERE w_state = 'TN' AND (wp_image_count = 4 OR wp_image_count = 1) AND w_warehouse_sk = 2 GROUP BY w_state, p_purpose ORDER BY total_web_pages DESC;
SELECT wsit.web_site_id, wsit.web_name, COUNT(DISTINCT ws.ws_order_number) AS total_orders, SUM(ws.ws_net_paid) AS total_sales, AVG(ws.ws_sales_price) AS avg_sales_price, COUNT(DISTINCT wr.wr_order_number) AS total_returns, AVG(wr.wr_return_amt) AS avg_return_amt, SUM(CASE WHEN ws.ws_promo_sk IS NOT NULL THEN 1 ELSE 0 END) AS promo_sales_count, SUM(CASE WHEN ws.ws_promo_sk IS NULL THEN 1 ELSE 0 END) AS non_promo_sales_count, AVG(hd.hd_dep_count) AS avg_household_dependents, AVG(hd.hd_vehicle_count) AS avg_household_vehicles FROM web_sales ws LEFT JOIN web_site wsit ON ws.ws_web_site_sk = wsit.web_site_sk LEFT JOIN web_returns wr ON ws.ws_order_number = wr.wr_order_number AND ws.ws_item_sk = wr.wr_item_sk LEFT JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk LEFT JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk LEFT JOIN promotion p ON ws.ws_promo_sk = p.p_promo_sk GROUP BY wsit.web_site_id, wsit.web_name ORDER BY total_sales DESC;
SELECT ws.web_site_id, ws.web_class, ws.web_name, COUNT(DISTINCT wr.wr_order_number) AS total_returns, SUM(wr.wr_return_quantity) AS total_returned_quantity, AVG(wr.wr_return_amt_inc_tax) AS avg_return_amount_inc_tax, SUM(wr.wr_refunded_cash) AS total_refunded_cash, SUM(sr.sr_return_quantity) AS store_total_returned_quantity, AVG(sr.sr_return_amt_inc_tax) AS store_avg_return_amount_inc_tax, SUM(sr.sr_refunded_cash) AS store_total_refunded_cash FROM web_site ws JOIN web_page wp ON ws.web_site_sk = wp.wp_web_page_sk JOIN web_returns wr ON wp.wp_web_page_sk = wr.wr_web_page_sk LEFT JOIN store_returns sr ON wr.wr_item_sk = sr.sr_item_sk AND wr.wr_refunded_customer_sk = sr.sr_customer_sk WHERE ws.web_class = 'Unknown' AND ws.web_rec_end_date IN ('2001-08-15', '2000-08-15', '1999-08-16') AND wp.wp_rec_start_date IN ('2000-09-03', '2001-09-03', '1997-09-03') AND wp.wp_link_count IN (7, 11, 19) AND wr.wr_return_amt_inc_tax IN (43.31, 378.40, 532.83) AND wr.wr_refunded_cash IN (2425.04, 1694.98, 8.69) AND sr.sr_customer_sk IN (38344, 71012, 20816) AND sr.sr_cdemo_sk IN (1443482, 746161, 1430182) GROUP BY ws.web_site_id, ws.web_class, ws.web_name ORDER BY total_returns DESC, total_refunded_cash DESC;
SELECT sm.sm_type, COUNT(DISTINCT cs.cs_order_number) AS total_orders, SUM(cs.cs_quantity) AS total_quantity, AVG(cs.cs_sales_price) AS avg_sales_price, SUM(cs.cs_net_paid) AS total_net_paid, SUM(cs.cs_net_paid_inc_ship) AS total_net_paid_inc_ship, SUM(cs.cs_net_paid_inc_tax) AS total_net_paid_inc_tax, SUM(cs.cs_net_paid_inc_ship_tax) AS total_net_paid_inc_ship_tax, SUM(cs.cs_net_profit) AS total_net_profit, SUM(inv.inv_quantity_on_hand) AS total_inventory_quantity, SUM(ss.ss_net_profit) AS total_store_sales_net_profit, SUM(wr.wr_net_loss) AS total_web_returns_net_loss FROM ship_mode sm LEFT JOIN catalog_sales cs ON sm.sm_ship_mode_sk = cs.cs_ship_mode_sk LEFT JOIN inventory inv ON cs.cs_item_sk = inv.inv_item_sk AND inv.inv_warehouse_sk IN (1, 2) LEFT JOIN store_sales ss ON cs.cs_item_sk = ss.ss_item_sk LEFT JOIN web_returns wr ON cs.cs_item_sk = wr.wr_item_sk WHERE inv.inv_item_sk = 10208 AND (cs.cs_coupon_amt = 849.23 OR cs.cs_coupon_amt = 20.08) AND cs.cs_order_number IN (99696, 116682, 86052, 116470, 78481) AND wr.wr_net_loss IN (31.29, 420.25, 714.73, 424.40, 381.09) GROUP BY sm.sm_type ORDER BY total_net_profit DESC;
SELECT ca_state, cp_department, SUM(ss_quantity) AS total_quantity_sold, AVG(ss_sales_price) AS average_sales_price, COUNT(DISTINCT ss_customer_sk) AS unique_customers, SUM(ss_net_paid) AS total_net_paid, SUM(ss_net_paid_inc_tax) AS total_net_paid_inc_tax, SUM(ss_net_profit) AS total_net_profit FROM store_sales JOIN customer_address ON ss_addr_sk = ca_address_sk JOIN catalog_page ON ss_promo_sk = cp_catalog_page_sk WHERE ss_sold_date_sk = 2450815 AND cp_description IN ( 'Only nuclear policies understand so basic courts.', 'Just local products used to note well; areas note', 'Women apply in vain in the minutes. Officials can', 'Traditional, clear years used to cover regardless' ) AND ss_cdemo_sk IN ( SELECT cd_demo_sk FROM customer_demographics WHERE cd_dep_count IN ('1', '2') ) GROUP BY ca_state, cp_department ORDER BY total_net_profit DESC, total_quantity_sold DESC;
SELECT sm.sm_type AS shipping_type, web.web_site_sk AS website_id, web.web_name AS website_name, i.i_category AS product_category, COUNT(DISTINCT ws.ws_order_number) AS total_orders, SUM(ws.ws_quantity) AS total_quantity_sold, SUM(ws.ws_net_paid) AS total_net_paid, SUM(ws.ws_net_paid_inc_tax) AS total_net_paid_incl_tax, SUM(ws.ws_net_paid_inc_ship) AS total_net_paid_incl_shipping, SUM(ws.ws_net_paid_inc_ship_tax) AS total_net_paid_incl_shipping_tax, AVG(ws.ws_sales_price) AS average_sales_price, SUM(ws.ws_net_profit) AS total_net_profit FROM web_sales ws JOIN web_site web ON ws.ws_web_site_sk = web.web_site_sk JOIN item i ON ws.ws_item_sk = i.i_item_sk JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk JOIN date_dim dd ON ws.ws_sold_date_sk = dd.d_date_sk WHERE sm.sm_type IN ('REGULAR', 'EXPRESS', 'OVERNIGHT') AND web.web_country = 'United States' AND ws.ws_warehouse_sk IN (2, 4) AND i.i_category IN ('Electronics', 'Women', 'Children', 'Home', 'Sports', 'Books') AND dd.d_year = 1999 GROUP BY shipping_type, website_id, website_name, product_category ORDER BY total_net_profit DESC, total_net_paid DESC, website_name, product_category;
SELECT sm.sm_type AS shipping_type, COUNT(DISTINCT c.c_customer_sk) AS number_of_customers, COUNT(DISTINCT wr.wr_order_number) AS total_returns, SUM(wr.wr_return_amt) AS total_return_amount, AVG(wr.wr_return_quantity) AS average_return_quantity, SUM(wr.wr_fee) AS total_return_fees, AVG(wr.wr_net_loss) AS average_net_loss, COUNT(DISTINCT cp.cp_catalog_page_sk) AS total_catalog_pages, AVG(hd.hd_vehicle_count) AS average_vehicle_count, SUM(CASE WHEN d.d_weekend = 'Y' THEN 1 ELSE 0 END) AS weekend_dates_count, SUM(CASE WHEN d.d_holiday = 'Y' THEN 1 ELSE 0 END) AS holiday_dates_count FROM ship_mode sm JOIN web_returns wr ON sm.sm_ship_mode_sk = wr.wr_returned_time_sk JOIN customer c ON wr.wr_returning_customer_sk = c.c_customer_sk JOIN catalog_page cp ON cp.cp_start_date_sk = wr.wr_returned_date_sk JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk JOIN date_dim d ON wr.wr_returned_date_sk = d.d_date_sk WHERE sm.sm_ship_mode_id IN ('AAAAAAAADBAAAAAA', 'AAAAAAAAMAAAAAAA', 'AAAAAAAAOAAAAAAA') AND sm.sm_type IN ('EXPRESS', 'NEXT DAY', 'OVERNIGHT') AND c.c_last_name IN ('Kyle', 'Reddy', 'Bishop') AND cp.cp_type IN ('quarterly', 'monthly', 'bi-annual') AND hd.hd_vehicle_count IN (3, 1, 0) AND hd.hd_buy_potential IN ('5001-10000', '>10000', 'Unknown') AND d.d_weekend IN ('N', 'Y') GROUP BY sm.sm_type;
SELECT s.s_store_name, cc.cc_name, COUNT(sr.sr_ticket_number) AS num_returns, SUM(sr.sr_return_amt) AS total_return_amount, AVG(sr.sr_return_quantity) AS avg_return_quantity, SUM(p.p_cost) AS total_promo_cost, wp.wp_type, COUNT(DISTINCT wp.wp_web_page_sk) AS num_web_page_visits FROM store s JOIN store_returns sr ON s.s_store_sk = sr.sr_store_sk JOIN call_center cc ON cc.cc_division = s.s_division_id JOIN promotion p ON sr.sr_reason_sk = p.p_promo_sk JOIN web_page wp ON wp.wp_creation_date_sk = sr.sr_returned_date_sk WHERE s.s_county = 'Williamson County' AND s.s_geography_class = 'Unknown' AND cc.cc_gmt_offset = '-5.00' AND cc.cc_suite_number IN ('Suite 70', 'Suite 0', 'Suite U') GROUP BY s.s_store_name, cc.cc_name, wp.wp_type ORDER BY total_return_amount DESC, num_returns DESC, s.s_store_name;
SELECT w.w_warehouse_name, w.w_warehouse_sq_ft, AVG(i.inv_quantity_on_hand) AS avg_quantity_on_hand, COUNT(DISTINCT p.p_promo_sk) AS num_promotions, SUM(CASE WHEN p.p_discount_active = 'Y' THEN 1 ELSE 0 END) AS active_discounts FROM warehouse w JOIN inventory i ON w.w_warehouse_sk = i.inv_warehouse_sk LEFT JOIN promotion p ON i.inv_item_sk = p.p_item_sk WHERE w.w_city = 'Fairview' GROUP BY w.w_warehouse_sk, w.w_warehouse_name, w.w_warehouse_sq_ft ORDER BY w.w_warehouse_name;
SELECT dd.d_year, dd.d_month_seq, SUM(ss.ss_quantity) AS total_quantity_sold, AVG(ss.ss_sales_price) AS avg_sales_price, COUNT(DISTINCT ss.ss_ticket_number) AS count_unique_sales_transactions, SUM(sr.sr_return_quantity) AS total_quantity_returned, AVG(sr.sr_return_amt) AS avg_return_amount, COUNT(DISTINCT sr.sr_ticket_number) AS count_unique_return_transactions, SUM(p.p_cost) AS total_promotion_cost, COUNT(DISTINCT p.p_promo_sk) AS count_unique_promotions FROM store_sales ss JOIN date_dim dd ON ss.ss_sold_date_sk = dd.d_date_sk LEFT JOIN store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number LEFT JOIN promotion p ON ss.ss_promo_sk = p.p_promo_sk WHERE p.p_channel_catalog = 'N' AND dd.d_year = 2002 GROUP BY dd.d_year, dd.d_month_seq ORDER BY dd.d_year, dd.d_month_seq;
SELECT ca_state, SUM(cr_return_amount) AS total_return_amount, AVG(cr_return_amount) AS avg_return_amount, COUNT(*) AS return_count, SUM(ss_net_profit) AS total_store_sales_profit, AVG(ss_net_profit) AS avg_store_sales_profit, COUNT(DISTINCT ss_customer_sk) AS store_customer_count, SUM(ws_net_profit) AS total_web_sales_profit, AVG(ws_net_profit) AS avg_web_sales_profit, COUNT(DISTINCT ws_bill_customer_sk) AS web_customer_count FROM catalog_returns JOIN customer_address ON cr_returning_addr_sk = ca_address_sk JOIN store_sales ON catalog_returns.cr_item_sk = store_sales.ss_item_sk JOIN web_sales ON catalog_returns.cr_item_sk = web_sales.ws_item_sk JOIN promotion ON store_sales.ss_promo_sk = promotion.p_promo_sk AND web_sales.ws_promo_sk = promotion.p_promo_sk JOIN household_demographics ON (catalog_returns.cr_returning_hdemo_sk = household_demographics.hd_demo_sk OR store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk OR web_sales.ws_ship_hdemo_sk = household_demographics.hd_demo_sk) WHERE promotion.p_channel_demo = 'N' AND household_demographics.hd_income_band_sk IN (8, 10) AND household_demographics.hd_buy_potential IN ('>10000', 'Unknown', '0-500', '5001-10000', '1001-5000', '501-1000') AND catalog_returns.cr_reason_sk IN (9, 32, 23, 19) AND promotion.p_end_date_sk IN (2450545, 2450776) GROUP BY ca_state ORDER BY total_return_amount DESC;
SELECT cc.cc_call_center_id, cc.cc_name, cc.cc_city, cc.cc_state, r.r_reason_id, r.r_reason_desc, AVG(ws.ws_sales_price) AS avg_sales_price, SUM(ws.ws_ext_discount_amt) AS total_discount_amount, SUM(ws.ws_net_profit) AS total_profit, COUNT(ws.ws_order_number) AS number_of_orders FROM call_center cc JOIN web_sales ws ON cc.cc_call_center_sk = ws.ws_bill_addr_sk JOIN reason r ON r.r_reason_sk = ws.ws_order_number JOIN time_dim td ON ws.ws_sold_time_sk = td.t_time_sk WHERE cc.cc_hours IN ('8AM-8AM', '8AM-4PM') AND cc.cc_street_type IN ('Way', 'RD', 'Boulevard') AND r.r_reason_id IN ('AAAAAAAAEAAAAAAA', 'AAAAAAAAJAAAAAAA', 'AAAAAAAABBAAAAAA', 'AAAAAAAANBAAAAAA', 'AAAAAAAADBAAAAAA', 'AAAAAAAAFAAAAAAA') AND ws.ws_sold_date_sk IN ('2451967', '2450969', '2452345') AND ws.ws_ship_cdemo_sk IN ('1654521', '1866243', '1370635') AND td.t_hour IN (0, 1) AND td.t_second IN ('48', '12', '47', '27', '16') GROUP BY cc.cc_call_center_id, cc.cc_name, cc.cc_city, cc.cc_state, r.r_reason_id, r.r_reason_desc ORDER BY total_profit DESC;
SELECT c.c_birth_country, COUNT(DISTINCT c.c_customer_sk) AS num_customers, SUM(ss.ss_quantity) AS total_quantity_sold, AVG(ss.ss_net_paid_inc_tax) AS avg_net_paid_inc_tax, SUM(CASE WHEN ss.ss_net_paid_inc_tax > 1000 THEN ss.ss_quantity ELSE 0 END) AS quantity_sold_above_1000, COUNT(DISTINCT p.p_promo_sk) AS num_promotions, SUM(p.p_cost) AS total_promotion_cost, w.w_state, COUNT(DISTINCT w.w_warehouse_sk) AS num_warehouses, SUM(w.w_warehouse_sq_ft) AS total_warehouse_sq_ft FROM customer c JOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk JOIN promotion p ON ss.ss_promo_sk = p.p_promo_sk JOIN warehouse w ON w.w_zip = c.c_current_addr_sk::character varying WHERE c.c_birth_country IN ('THAILAND', 'ITALY') AND ss.ss_net_paid_inc_tax::text IN ('307.45', '859.21', '1169.72', '3293.51', '222.26') GROUP BY c.c_birth_country, w.w_state ORDER BY total_quantity_sold DESC;
SELECT w_state, EXTRACT(YEAR FROM wp_rec_end_date) AS year, SUM(cr_return_amount) AS total_return_amount, AVG(cr_return_amount) AS avg_return_amount, COUNT(DISTINCT cr_refunded_customer_sk) AS unique_customers, COUNT(cr_order_number) AS total_returns, SUM(cr_return_quantity) AS total_returned_items FROM catalog_returns cr JOIN warehouse w ON cr.cr_warehouse_sk = w.w_warehouse_sk JOIN web_page wp ON cr.cr_catalog_page_sk = wp.wp_web_page_sk WHERE wp.wp_rec_end_date BETWEEN '1999-01-01' AND CURRENT_DATE GROUP BY w_state, year ORDER BY w_state, year;
SELECT cc.cc_call_center_id, cc.cc_name, cc.cc_city, cc.cc_state, SUM(cs.cs_net_paid) AS total_sales, AVG(cs.cs_ext_discount_amt) AS average_discount, COUNT(cs.cs_order_number) AS number_of_orders, SUM(inv.inv_quantity_on_hand) AS total_inventory, COUNT(DISTINCT p.p_promo_id) AS number_of_promotions_used FROM call_center cc LEFT JOIN catalog_sales cs ON cc.cc_call_center_sk = cs.cs_call_center_sk LEFT JOIN promotion p ON cs.cs_promo_sk = p.p_promo_sk LEFT JOIN inventory inv ON cs.cs_item_sk = inv.inv_item_sk AND cc.cc_division = inv.inv_warehouse_sk WHERE cs.cs_sold_date_sk IN ('2450823', '2450816', '2450827', '2450829', '2450820') AND cs.cs_promo_sk IN ('130', '96', '160', '128') GROUP BY cc.cc_call_center_id, cc.cc_name, cc.cc_city, cc.cc_state ORDER BY total_sales DESC;
SELECT d_year, sm_type, COUNT(DISTINCT inv_warehouse_sk) AS number_of_warehouses, SUM(inv_quantity_on_hand) AS total_quantity_on_hand, AVG(inv_quantity_on_hand) AS average_quantity_per_warehouse, MAX(inv_quantity_on_hand) AS max_quantity_in_warehouse, MIN(inv_quantity_on_hand) AS min_quantity_in_warehouse FROM inventory JOIN date_dim ON inv_date_sk = d_date_sk JOIN ship_mode ON sm_ship_mode_id = 'AAAAAAAAEAAAAAAA' WHERE d_year = 2023 AND d_day_name = 'Saturday' AND inv_warehouse_sk IN (1, 2) AND d_current_week = 'N' GROUP BY d_year, sm_type ORDER BY total_quantity_on_hand DESC, average_quantity_per_warehouse DESC LIMIT 100;
