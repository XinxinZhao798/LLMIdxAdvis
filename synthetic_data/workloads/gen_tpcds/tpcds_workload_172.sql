SELECT cc.cc_city, cc.cc_state, r.r_reason_desc, cd.cd_gender, cd.cd_marital_status, cd.cd_education_status, hd.hd_income_band_sk, COUNT(cr.cr_item_sk) AS total_returned_items, SUM(cr.cr_return_amount) AS total_return_amount, AVG(cr.cr_return_amount) AS avg_return_amount, SUM(cr.cr_fee) AS total_fees, SUM(cr.cr_return_amt_inc_tax) AS total_amount_incl_tax, SUM(cr.cr_net_loss) AS total_net_loss, COUNT(DISTINCT p.p_promo_sk) AS total_promotions_impacted FROM catalog_returns cr LEFT JOIN call_center cc ON cr.cr_call_center_sk = cc.cc_call_center_sk LEFT JOIN reason r ON cr.cr_reason_sk = r.r_reason_sk LEFT JOIN customer_demographics cd ON cr.cr_returning_cdemo_sk = cd.cd_demo_sk LEFT JOIN household_demographics hd ON cr.cr_returning_hdemo_sk = hd.hd_demo_sk LEFT JOIN promotion p ON p.p_item_sk = cr.cr_item_sk AND p.p_channel_press = 'N' WHERE cr.cr_return_amount BETWEEN 300 AND 4500 AND r.r_reason_desc IN ('reason 24', 'reason 26', 'Parts missing', 'unauthoized purchase') AND cd.cd_purchase_estimate = 9000 GROUP BY cc.cc_city, cc.cc_state, r.r_reason_desc, cd.cd_gender, cd.cd_marital_status, cd.cd_education_status, hd.hd_income_band_sk ORDER BY total_return_amount DESC, total_returned_items DESC, cc.cc_city, cc.cc_state;
SELECT cd.cd_gender, cd.cd_marital_status, cd.cd_education_status, cd.cd_credit_rating, wsit.web_name, wsit.web_manager, COUNT(DISTINCT ws.ws_order_number) AS total_orders, SUM(ws.ws_quantity) AS total_quantity_sold, SUM(ws.ws_net_paid) AS total_net_paid, SUM(ws.ws_net_profit) AS total_net_profit, AVG(ws.ws_net_profit) AS average_net_profit_per_sale, MAX(ws.ws_net_profit) AS max_net_profit_single_sale, MIN(ws.ws_net_profit) AS min_net_profit_single_sale FROM web_sales ws JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk JOIN web_site wsit ON ws.ws_web_site_sk = wsit.web_site_sk WHERE cd.cd_credit_rating IN ('Low Risk', 'High Risk', 'Good') AND wsit.web_country = 'United States' AND ws.ws_sold_date_sk BETWEEN 2000000 AND 2020000 GROUP BY cd.cd_gender, cd.cd_marital_status, cd.cd_education_status, cd.cd_credit_rating, wsit.web_name, wsit.web_manager ORDER BY total_net_profit DESC, cd.cd_gender, cd.cd_credit_rating;
SELECT sm.sm_type AS shipping_type, sm.sm_code AS shipping_code, sm.sm_carrier AS carrier, COUNT(DISTINCT inv.inv_item_sk) AS unique_items_shipped, SUM(inv.inv_quantity_on_hand) AS total_quantity_on_hand, AVG(wr.wr_return_amt_inc_tax) AS average_return_amount_incl_tax, SUM(wr.wr_fee) AS total_return_fees, SUM(wr.wr_net_loss) AS total_net_loss, COUNT(DISTINCT wr.wr_order_number) AS total_return_orders, td.t_shift AS time_shift, COUNT(DISTINCT td.t_time_sk) AS total_shift_times FROM ship_mode sm JOIN inventory inv ON sm.sm_ship_mode_sk = inv.inv_warehouse_sk LEFT JOIN web_returns wr ON inv.inv_item_sk = wr.wr_item_sk LEFT JOIN time_dim td ON wr.wr_returned_time_sk = td.t_time_sk WHERE td.t_shift = 'third' AND inv.inv_warehouse_sk IN (1, 2) AND inv.inv_item_sk IN (15820, 14284, 6472) AND td.t_time_sk IN ('4753', '787', '4258') GROUP BY sm.sm_type, sm.sm_code, sm.sm_carrier, td.t_shift ORDER BY total_net_loss DESC;
SELECT dd.d_year, dd.d_quarter_name, SUM(ws.ws_net_paid) AS total_net_paid, AVG(ws.ws_quantity) AS average_quantity, COUNT(*) AS sales_transactions, SUM(inv.inv_quantity_on_hand) AS total_inventory, COUNT(DISTINCT ws.ws_item_sk) AS distinct_items_sold, COUNT(DISTINCT s.s_store_sk) AS number_of_stores, SUM(cr.cr_return_amount) AS total_return_amount, AVG(cr.cr_return_quantity) AS average_return_quantity, COUNT(DISTINCT cr.cr_item_sk) AS distinct_items_returned FROM date_dim AS dd JOIN web_sales AS ws ON dd.d_date_sk = ws.ws_sold_date_sk JOIN inventory AS inv ON ws.ws_item_sk = inv.inv_item_sk AND ws.ws_sold_date_sk = inv.inv_date_sk JOIN store AS s ON ws.ws_bill_customer_sk = s.s_store_sk LEFT JOIN catalog_returns AS cr ON ws.ws_item_sk = cr.cr_item_sk AND ws.ws_order_number = cr.cr_order_number WHERE dd.d_current_year = 'N' AND ws.ws_promo_sk IS NOT NULL AND s.s_market_id IN (8, 2, 4, 7) AND inv.inv_warehouse_sk IN (1, 2) GROUP BY dd.d_year, dd.d_quarter_name ORDER BY dd.d_year, dd.d_quarter_name;
SELECT ib.ib_lower_bound, ib.ib_upper_bound, COUNT(hd.hd_demo_sk) AS household_count, AVG(hd.hd_dep_count) AS average_dependency_count, AVG(hd.hd_vehicle_count) AS average_vehicle_count, SUM(CASE WHEN p.p_channel_email = 'N' THEN p.p_cost ELSE 0 END) AS total_cost_non_email_promotions, SUM(CASE WHEN p.p_channel_tv = 'Y' THEN 1 ELSE 0 END) AS number_of_tv_promotions, SUM(CASE WHEN p.p_discount_active = 'Y' THEN p.p_response_target ELSE 0 END) AS total_target_with_active_discount, COUNT(DISTINCT CASE WHEN r.r_reason_desc = 'reason 27' THEN hd.hd_demo_sk ELSE NULL END) AS count_households_reason_27 FROM household_demographics hd LEFT JOIN income_band ib ON hd.hd_income_band_sk = ib.ib_income_band_sk LEFT JOIN promotion p ON hd.hd_demo_sk = p.p_item_sk LEFT JOIN reason r ON p.p_promo_sk = r.r_reason_sk WHERE hd.hd_income_band_sk IN (15, 9, 18, 20) AND p.p_purpose <> 'Unknown' AND ib.ib_lower_bound IN (110001, 100001, 130001) AND ib.ib_upper_bound <> 70000 GROUP BY ib.ib_lower_bound, ib.ib_upper_bound ORDER BY ib.ib_lower_bound, ib.ib_upper_bound;
SELECT cp.cp_department AS department, EXTRACT(YEAR FROM d_date) AS sale_year, EXTRACT(MONTH FROM d_date) AS sale_month, SUM(ss.ss_quantity) AS total_quantity_sold, AVG(ss.ss_sales_price) AS average_sale_price, COUNT(DISTINCT ss.ss_ticket_number) AS total_sales_transactions FROM catalog_page cp JOIN store_sales ss ON cp.cp_catalog_page_sk = ss.ss_item_sk JOIN time_dim td ON ss.ss_sold_time_sk = td.t_time_sk JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk WHERE cp.cp_type IN ('monthly', 'bi-annual', 'quarterly') AND ss.ss_item_sk IN (1838, 9235) AND ss.ss_wholesale_cost IN (5.12, 59.59, 25.96, 87.72, 47.56) AND td.t_hour = 1 GROUP BY department, sale_year, sale_month ORDER BY department, sale_year, sale_month;
SELECT sm.sm_ship_mode_id, sm.sm_type, sm.sm_carrier, COUNT(DISTINCT cr.cr_order_number) AS total_orders_returned, SUM(cr.cr_return_quantity) AS total_quantity_returned, AVG(cr.cr_return_amt_inc_tax) AS avg_refunded_amount_inc_tax, SUM(cr.cr_net_loss) AS total_net_loss FROM catalog_returns cr JOIN ship_mode sm ON cr.cr_ship_mode_sk = sm.sm_ship_mode_sk JOIN time_dim t ON cr.cr_returned_time_sk = t.t_time_sk JOIN date_dim d ON cr.cr_returned_date_sk = d.d_date_sk WHERE d.d_year = 2003 AND sm.sm_carrier IN ('HARMSTORF', 'TBS', 'ZOUROS', 'MSC', 'DIAMOND', 'AIRBORNE') GROUP BY sm.sm_ship_mode_id, sm.sm_type, sm.sm_carrier ORDER BY total_net_loss DESC;
SELECT ca.ca_city, ca.ca_state, hd.hd_income_band_sk, COUNT(DISTINCT ws.ws_order_number) AS total_orders, SUM(ws.ws_quantity) AS total_quantity_sold, AVG(ws.ws_net_paid) AS average_net_paid, SUM(ws.ws_net_paid_inc_tax) AS total_net_paid_including_tax, AVG(ws.ws_net_profit) AS average_net_profit FROM web_sales ws JOIN customer_address ca ON ws.ws_bill_addr_sk = ca.ca_address_sk JOIN household_demographics hd ON ws.ws_bill_hdemo_sk = hd.hd_demo_sk WHERE ca.ca_country = 'United States' AND (ca.ca_city IN ('Argyle', 'Collinsville', 'Ferguson') OR hd.hd_demo_sk IN (1967, 3880)) AND ws.ws_sold_time_sk IN (27944, 62910, 57271, 74886, 48677, 80582) AND ws.ws_net_paid_inc_tax >= 7202.65 GROUP BY ca.ca_city, ca.ca_state, hd.hd_income_band_sk ORDER BY total_net_paid_including_tax DESC, average_net_profit DESC;
SELECT d_year, i_category, COUNT(DISTINCT ss_ticket_number) AS total_sales_transactions, SUM(ss_quantity) AS total_quantity_sold, AVG(ss_sales_price) AS average_sales_price, SUM(ss_net_profit) AS total_net_profit, SUM(cr_return_amount) AS total_return_amount, COUNT(DISTINCT cr_order_number) AS total_return_transactions, (SUM(ss_net_profit) - SUM(cr_net_loss)) AS net_profit_after_returns FROM store_sales JOIN item ON store_sales.ss_item_sk = item.i_item_sk JOIN date_dim ON store_sales.ss_sold_date_sk = date_dim.d_date_sk LEFT JOIN catalog_returns ON store_sales.ss_item_sk = catalog_returns.cr_item_sk AND store_sales.ss_ticket_number = catalog_returns.cr_order_number WHERE store_sales.ss_addr_sk = '19253' AND d_year = 1999 GROUP BY d_year, i_category ORDER BY net_profit_after_returns DESC LIMIT 10;
SELECT c.c_customer_id, COUNT(ws.ws_order_number) AS total_orders, SUM(ws.ws_quantity) AS total_units_sold, AVG(ws.ws_sales_price) AS average_sales_price, SUM(ws.ws_net_paid) AS total_net_paid, SUM(ws.ws_net_profit) AS total_net_profit, sm.sm_type AS shipping_mode, EXTRACT(YEAR FROM d_date) AS sales_year FROM web_sales ws JOIN date_dim d_date ON ws.ws_sold_date_sk = d_date.d_date_sk JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk WHERE d_date.d_year = 2020 GROUP BY c.c_customer_id, sm.sm_type, sales_year ORDER BY total_net_paid DESC, total_net_profit DESC;
SELECT r.r_reason_desc, sm.sm_type, sm.sm_code, COUNT(*) AS total_returns, SUM(cr.cr_return_amount) AS total_return_amount, AVG(cr.cr_return_amount) AS average_return_amount, SUM(cr.cr_return_quantity) AS total_return_quantity, SUM(cr.cr_net_loss) AS total_net_loss FROM catalog_returns cr JOIN reason r ON cr.cr_reason_sk = r.r_reason_sk JOIN ship_mode sm ON cr.cr_ship_mode_sk = sm.sm_ship_mode_sk WHERE cr.cr_returned_date_sk IS NOT NULL AND sm.sm_code = 'AIR' AND sm.sm_type IN ('TWO DAY', 'NEXT DAY') AND cr.cr_return_amt_inc_tax IN (93.14, 49.54, 370.20, 5187.66) GROUP BY r.r_reason_desc, sm.sm_type, sm.sm_code ORDER BY total_return_amount DESC, total_return_quantity DESC;
SELECT sm.sm_type, sm.sm_code, COUNT(wr.wr_order_number) AS total_returns, AVG(wr.wr_return_amt) AS average_return_amount, SUM(wr.wr_return_quantity) AS total_returned_quantity, SUM(wr.wr_return_ship_cost) AS total_return_shipping_cost, AVG(hd.hd_dep_count) AS average_dependent_count, AVG(hd.hd_vehicle_count) AS average_vehicle_count, td.t_shift, SUM(CASE WHEN td.t_am_pm = 'AM' THEN 1 ELSE 0 END) AS returns_in_am, SUM(CASE WHEN td.t_am_pm = 'PM' THEN 1 ELSE 0 END) AS returns_in_pm FROM web_returns wr JOIN ship_mode sm ON wr.wr_order_number = sm.sm_ship_mode_sk JOIN household_demographics hd ON wr.wr_returning_hdemo_sk = hd.hd_demo_sk JOIN time_dim td ON wr.wr_returned_time_sk = td.t_time_sk WHERE sm.sm_type IN ('NEXT DAY', 'TWO DAY', 'LIBRARY', 'EXPRESS', 'REGULAR', 'OVERNIGHT') AND sm.sm_code IN ('SEA', 'BIKE', 'AIR', 'SURFACE') AND td.t_second IN ('18', '2', '56', '30') AND wr.wr_return_ship_cost IN ('3700.56', '275.65', '284.48') GROUP BY sm.sm_type, sm.sm_code, td.t_shift ORDER BY total_returns DESC, total_return_shipping_cost DESC;
SELECT r.r_reason_desc, cc.cc_name AS call_center_name, cc.cc_city AS call_center_city, cc.cc_state AS call_center_state, SUM(cr.cr_return_amount) AS total_return_amount, AVG(cr.cr_return_amount) AS avg_return_amount, COUNT(cr.cr_order_number) AS total_returns, SUM(cr.cr_return_quantity) AS total_returned_items, SUM(cr.cr_fee) AS total_fees_collected, SUM(cr.cr_store_credit) AS total_store_credit_issued, SUM(cr.cr_net_loss) AS total_net_loss FROM catalog_returns cr JOIN call_center cc ON cr.cr_call_center_sk = cc.cc_call_center_sk JOIN reason r ON cr.cr_reason_sk = r.r_reason_sk WHERE cr.cr_returned_date_sk BETWEEN 20000101 AND 20001231 AND cr.cr_returning_hdemo_sk IN (5491, 6517, 636, 7063, 3950, 2509) GROUP BY r.r_reason_desc, cc.cc_name, cc.cc_city, cc.cc_state ORDER BY total_return_amount DESC, total_returns DESC;
SELECT cp_department, i_category, i_class, COUNT(DISTINCT i_item_sk) AS item_count, SUM(i_current_price) AS total_price, AVG(i_current_price) AS average_price, AVG(i_wholesale_cost) AS average_cost, SUM(i_wholesale_cost) AS total_cost, sm_type, COUNT(DISTINCT sm_ship_mode_sk) AS ship_mode_count FROM catalog_page JOIN item ON (cp_catalog_page_sk = i_item_sk) JOIN ship_mode ON (i_item_sk = sm_ship_mode_sk) WHERE cp_catalog_page_sk IN (2547, 2038, 1714) GROUP BY cp_department, i_category, i_class, sm_type ORDER BY cp_department, i_category, i_class;
SELECT ca_state, r_reason_desc, COUNT(*) AS return_count, SUM(sr_return_amt) AS total_return_amount, AVG(sr_return_quantity) AS average_quantity_returned, SUM(sr_return_amt_inc_tax) AS total_amount_including_tax, SUM(sr_fee) AS total_fees, SUM(sr_return_ship_cost) AS total_shipping_costs, SUM(sr_refunded_cash) AS total_cash_refunded, SUM(sr_reversed_charge) AS total_reversed_charges, SUM(sr_store_credit) AS total_store_credit_issued, SUM(sr_net_loss) AS total_net_loss FROM store_returns JOIN reason ON store_returns.sr_reason_sk = reason.r_reason_sk JOIN customer_address ON store_returns.sr_addr_sk = customer_address.ca_address_sk WHERE (sr_reason_sk IN (13, 15, 26, 31, 21, 27)) AND (sr_reversed_charge IN (269.66, 29.95, 131.41, 123.32, 10.07, 1.54)) AND (sr_item_sk IN (6759, 10097, 13141, 10841, 4022)) GROUP BY ca_state, r_reason_desc ORDER BY ca_state, total_return_amount DESC;
SELECT p.p_promo_name, d_return.d_year AS return_year, d_return.d_quarter_name, COUNT(DISTINCT cr.cr_order_number) AS total_returns, SUM(cr.cr_return_quantity) AS total_returned_quantity, SUM(cr.cr_return_amount) AS total_returned_amount, AVG(cr.cr_return_amount) AS avg_return_amount, SUM(cr.cr_net_loss) AS total_net_loss FROM catalog_returns cr JOIN date_dim d_return ON cr.cr_returned_date_sk = d_return.d_date_sk JOIN promotion p ON cr.cr_item_sk = p.p_item_sk JOIN date_dim d_start ON p.p_start_date_sk = d_start.d_date_sk JOIN date_dim d_end ON p.p_end_date_sk = d_end.d_date_sk WHERE cr.cr_call_center_sk IN ('2', '4') AND cr.cr_reason_sk IN ('11', '25') AND d_return.d_current_week = 'N' AND p.p_channel_tv = 'N' AND p.p_channel_radio = 'N' AND d_return.d_date BETWEEN d_start.d_date AND d_end.d_date GROUP BY p.p_promo_name, return_year, d_return.d_quarter_name ORDER BY total_returned_amount DESC, total_returns DESC, return_year, d_return.d_quarter_name;
SELECT ca.ca_state, COUNT(DISTINCT ss.ss_ticket_number) AS total_sales_transactions, SUM(ss.ss_net_paid) AS total_sales_amount, AVG(ss.ss_net_paid) AS average_sales_amount, SUM(ss.ss_quantity) AS total_quantity_sold FROM store_sales AS ss JOIN customer_address AS ca ON ss.ss_addr_sk = ca.ca_address_sk JOIN inventory AS inv ON ss.ss_item_sk = inv.inv_item_sk AND ss.ss_sold_date_sk = inv.inv_date_sk WHERE ca.ca_location_type = 'single family' AND inv.inv_warehouse_sk IN (1, 2) GROUP BY ca.ca_state ORDER BY total_sales_amount DESC;
SELECT cp.cp_department, cp.cp_catalog_number, sm.sm_carrier, COUNT(*) AS total_returns, SUM(sr.sr_return_quantity) AS total_returned_quantity, AVG(sr.sr_return_amt_inc_tax) AS average_return_amount_inc_tax, SUM(sr.sr_fee) AS total_fees, SUM(sr.sr_net_loss) AS total_net_loss FROM store_returns sr JOIN catalog_page cp ON sr.sr_item_sk = cp.cp_catalog_page_sk JOIN ship_mode sm ON sm.sm_ship_mode_sk = sr.sr_item_sk WHERE cp.cp_catalog_page_number IN (20, 88, 103, 108, 56, 9) AND cp.cp_catalog_page_id IN ('AAAAAAAAMECBAAAA', 'AAAAAAAAPENAAAAA', 'AAAAAAAAHKMAAAAA', 'AAAAAAAADBGAAAAA', 'AAAAAAAADEPAAAAA', 'AAAAAAAALIDAAAAA') AND sm.sm_ship_mode_id IN ('AAAAAAAAABAAAAAA', 'AAAAAAAACBAAAAAA', 'AAAAAAAAJAAAAAAA', 'AAAAAAAAFAAAAAAA', 'AAAAAAAAEBAAAAAA') AND sm.sm_carrier IN ('TBS', 'DIAMOND', 'AIRBORNE', 'GREAT EASTERN', 'LATVIAN') GROUP BY cp.cp_department, cp.cp_catalog_number, sm.sm_carrier;
SELECT i.i_category AS category, ca.ca_state AS customer_state, EXTRACT(MONTH FROM (DATE '1970-01-01' + c.c_first_sales_date_sk * INTERVAL '1 day')) AS sale_month, COUNT(DISTINCT s.s_store_sk) AS num_stores, SUM(i.i_current_price) AS total_sales_amount, AVG(i.i_wholesale_cost) AS avg_wholesale_cost, COUNT(i.i_item_sk) AS items_sold, SUM(sr.sr_return_amt) AS total_return_amount, AVG(sr.sr_return_amt) AS avg_return_amount, COUNT(sr.sr_item_sk) AS items_returned FROM store s JOIN customer c ON s.s_store_sk = c.c_current_addr_sk JOIN item i ON s.s_store_sk = i.i_manufact_id JOIN store_returns sr ON i.i_item_sk = sr.sr_item_sk JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk WHERE ca.ca_state IN ('TN', 'DE', 'VA', 'CO') AND i.i_category_id IS NOT NULL AND c.c_first_sales_date_sk IS NOT NULL AND (c.c_birth_month = 1 OR c.c_birth_month IS NULL) AND sr.sr_returned_date_sk IS NOT NULL GROUP BY category, customer_state, sale_month ORDER BY total_sales_amount DESC, avg_wholesale_cost DESC, total_return_amount DESC LIMIT 100;
SELECT ib.ib_lower_bound, ib.ib_upper_bound, cc.cc_state, d.d_year, SUM(cs.cs_net_paid) AS total_sales, AVG(cs.cs_ext_discount_amt) AS average_discount, COUNT(DISTINCT cs.cs_order_number) AS total_orders FROM catalog_sales cs JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk JOIN income_band ib ON cs.cs_bill_customer_sk = ib.ib_income_band_sk JOIN call_center cc ON cs.cs_call_center_sk = cc.cc_call_center_sk WHERE d.d_year = 2003 AND ib.ib_upper_bound IN (40000, 90000, 100000, 20000, 140000, 180000) AND cc.cc_state = 'TN' GROUP BY ib.ib_lower_bound, ib.ib_upper_bound, cc.cc_state, d.d_year ORDER BY ib.ib_lower_bound, total_sales DESC;
SELECT cc.cc_name, cc.cc_city, cc.cc_state, COUNT(*) AS number_of_promotions, SUM(inv.inv_quantity_on_hand) AS total_inventory, AVG(p.p_cost) AS average_promotion_cost, SUM(CASE WHEN p.p_discount_active = 'Y' THEN 1 ELSE 0 END) AS active_discounts FROM call_center cc JOIN promotion p ON cc.cc_call_center_sk = p.p_item_sk JOIN inventory inv ON p.p_item_sk = inv.inv_item_sk WHERE cc.cc_rec_end_date = '2000-12-31' AND inv.inv_date_sk = 2450815 AND inv.inv_quantity_on_hand IN (104, 11, 180) AND cc.cc_employees IN (1, 2, 3) GROUP BY cc.cc_name, cc.cc_city, cc.cc_state ORDER BY cc.cc_name, cc.cc_city, cc.cc_state;
SELECT cp.cp_department, COUNT(*) AS total_pages, AVG(wp.wp_link_count) AS average_link_count, SUM(wp.wp_image_count) AS total_image_count, COUNT(DISTINCT hd.hd_demo_sk) AS unique_households, AVG(hd.hd_vehicle_count) AS average_vehicle_count FROM catalog_page cp JOIN web_page wp ON cp.cp_catalog_page_sk = wp.wp_customer_sk JOIN household_demographics hd ON wp.wp_customer_sk = hd.hd_demo_sk WHERE cp.cp_catalog_number IN (29, 27, 21, 36) AND wp.wp_autogen_flag = 'Y' AND wp.wp_url LIKE 'http://www.foo.com%' GROUP BY cp.cp_department ORDER BY total_pages DESC, average_link_count DESC;
SELECT ws.ws_item_sk, COUNT(DISTINCT ws.ws_order_number) AS total_orders, SUM(ws.ws_quantity) AS total_quantity_sold, AVG(ws.ws_ext_discount_amt) AS avg_discount_amt, AVG(ws.ws_sales_price) AS avg_sales_price, SUM(ws.ws_net_paid) AS total_net_paid, SUM(ws.ws_net_profit) AS total_net_profit, hd.hd_dep_count AS avg_dependents, hd.hd_vehicle_count AS avg_vehicles, s.s_store_name, s.s_city, s.s_state, SUM(inv.inv_quantity_on_hand) AS total_inventory_on_hand FROM web_sales ws JOIN household_demographics hd ON ws.ws_ship_hdemo_sk = hd.hd_demo_sk JOIN store s ON ws.ws_warehouse_sk = s.s_store_sk JOIN inventory inv ON (ws.ws_item_sk = inv.inv_item_sk AND ws.ws_warehouse_sk = inv.inv_warehouse_sk) WHERE ws.ws_ship_customer_sk IN ('14120', '70023', '31659', '86542') AND ws.ws_ship_addr_sk IN ('8368', '47705', '32703', '24892') AND inv.inv_date_sk = '2450815' AND hd.hd_vehicle_count IN (1, 0, 3, 2) AND s.s_number_employees IN (245, 271, 236, 218, 288, 278) GROUP BY ws.ws_item_sk, hd.hd_dep_count, hd.hd_vehicle_count, s.s_store_name, s.s_city, s.s_state ORDER BY total_net_paid DESC, total_orders DESC;
SELECT ws.ws_web_site_sk, COUNT(DISTINCT ws.ws_order_number) AS total_orders, SUM(ws.ws_quantity) AS total_quantity_sold, AVG(ws.ws_sales_price) AS average_sales_price, SUM(ws.ws_net_paid) AS total_net_paid, SUM(ws.ws_net_profit) AS total_net_profit, ws_site.web_tax_percentage, cd.cd_gender, cd.cd_marital_status, cd.cd_education_status, COUNT(cd.cd_dep_college_count) AS total_college_dependents FROM web_sales ws JOIN web_site ws_site ON ws.ws_web_site_sk = ws_site.web_site_sk JOIN customer_demographics cd ON ws.ws_bill_cdemo_sk = cd.cd_demo_sk WHERE ws.ws_sales_price BETWEEN 6.61 AND 60.51 AND ws_site.web_tax_percentage IN ('0.07', '0.02') AND ws_site.web_zip IN ('35709', '31904') AND ws.ws_sold_date_sk IS NOT NULL AND ws.ws_sold_time_sk IS NOT NULL GROUP BY ws.ws_web_site_sk, ws_site.web_tax_percentage, cd.cd_gender, cd.cd_marital_status, cd.cd_education_status ORDER BY ws.ws_web_site_sk, cd.cd_gender, cd.cd_marital_status, cd.cd_education_status;
SELECT cc.cc_name, cc.cc_city, cc.cc_state, SUM(cs.cs_net_paid) AS total_sales, AVG(cs.cs_net_paid_inc_tax) AS avg_sales_inc_tax, COUNT(*) AS number_of_sales, SUM(ws.ws_quantity) AS total_web_quantity_sold, AVG(ws.ws_net_profit) AS avg_web_net_profit FROM call_center cc JOIN catalog_sales cs ON cc.cc_call_center_sk = cs.cs_call_center_sk JOIN web_sales ws ON cs.cs_item_sk = ws.ws_item_sk AND cs.cs_order_number = ws.ws_order_number JOIN promotion p ON cs.cs_promo_sk = p.p_promo_sk AND ws.ws_promo_sk = p.p_promo_sk WHERE cs.cs_ship_customer_sk IN (17646, 63607, 15126, 61460) AND p.p_discount_active = '1' AND cc.cc_rec_start_date <= CURRENT_DATE AND (cc.cc_rec_end_date IS NULL OR cc.cc_rec_end_date > CURRENT_DATE) GROUP BY cc.cc_name, cc.cc_city, cc.cc_state ORDER BY total_sales DESC LIMIT 10;
SELECT w_state, w_city, ib.ib_income_band_sk AS income_band_sk, p_promo_name, COUNT(DISTINCT w.w_warehouse_sk) AS num_warehouses, SUM(w.w_warehouse_sq_ft) AS total_warehouse_sq_ft, AVG(w.w_warehouse_sq_ft) AS avg_warehouse_sq_ft, SUM(wr_return_amt_inc_tax) AS total_return_amount_inc_tax, COUNT(DISTINCT wr.wr_returned_date_sk) AS num_return_days, AVG(wr_return_amt_inc_tax) AS avg_return_amount_inc_tax FROM warehouse w JOIN web_returns wr ON w.w_warehouse_sk = wr.wr_returning_addr_sk JOIN income_band ib ON ib.ib_income_band_sk = wr.wr_returning_hdemo_sk JOIN promotion p ON p.p_item_sk = wr.wr_item_sk WHERE w_state = 'TN' AND w_city = 'Fairview' AND wr_reason_sk IN (7, 17, 21, 6) AND ib_upper_bound IN (50000, 190000, 80000) AND wr_returning_hdemo_sk IN (4812, 3393, 981, 1249) GROUP BY w_state, w_city, ib.ib_income_band_sk, p_promo_name ORDER BY total_return_amount_inc_tax DESC LIMIT 100;
