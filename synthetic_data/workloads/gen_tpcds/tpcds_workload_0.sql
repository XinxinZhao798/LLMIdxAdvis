SELECT ca.ca_state AS customer_state, COUNT(DISTINCT cs.cs_order_number) AS total_orders, SUM(cs.cs_quantity) AS total_quantity_sold, AVG(cs.cs_sales_price) AS average_sale_price, SUM(cr.cr_return_quantity) AS total_quantity_returned, SUM(cr.cr_return_amount) AS total_return_amount, AVG(cr.cr_return_amount) AS average_return_amount, COUNT(DISTINCT p.p_promo_sk) AS total_promotions_used, COUNT(DISTINCT w.w_warehouse_sk) AS total_warehouses_used FROM customer_address ca JOIN customer c ON ca.ca_address_sk = c.c_current_addr_sk JOIN catalog_sales cs ON c.c_customer_sk = cs.cs_bill_customer_sk JOIN catalog_returns cr ON cs.cs_order_number = cr.cr_order_number JOIN promotion p ON cs.cs_promo_sk = p.p_promo_sk JOIN warehouse w ON cs.cs_warehouse_sk = w.w_warehouse_sk WHERE ca.ca_state IS NOT NULL AND p.p_channel_radio = 'N' AND (p.p_promo_name LIKE '%bar%' OR p.p_promo_name LIKE '%anti%') AND w.w_warehouse_id IN ('AAAAAAAABAAAAAAA', 'AAAAAAAADAAAAAAA', 'AAAAAAAAEAAAAAAA', 'AAAAAAAAFAAAAAAA', 'AAAAAAAACAAAAAAA') AND cs.cs_catalog_page_sk IN ( SELECT cp_catalog_page_sk FROM catalog_page WHERE cp_catalog_page_number IN (29, 24, 40) ) GROUP BY ca.ca_state ORDER BY total_return_amount DESC, average_sale_price DESC LIMIT 100;
SELECT ca.ca_state AS customer_state, i.i_category AS item_category, SUM(cs.cs_sales_price) AS total_sales, AVG(cs.cs_quantity) AS average_quantity_sold, COUNT(cs.cs_order_number) AS total_orders, SUM(cs.cs_net_profit) AS total_net_profit FROM catalog_sales cs JOIN item i ON cs.cs_item_sk = i.i_item_sk JOIN customer_address ca ON cs.cs_ship_addr_sk = ca.ca_address_sk WHERE i.i_container <> 'Unknown' AND cs.cs_sold_date_sk IS NOT NULL AND ca.ca_country = 'United States' GROUP BY customer_state, item_category HAVING SUM(cs.cs_sales_price) > 10000 ORDER BY total_sales DESC, customer_state, item_category;
SELECT cc.cc_call_center_id, cc.cc_name, cc.cc_city, cc.cc_state, SUM(ss.ss_net_paid) AS total_sales, AVG(ss.ss_ext_discount_amt) AS avg_discount_amount, COUNT(DISTINCT ss.ss_ticket_number) AS total_tickets, COUNT(DISTINCT p.p_promo_sk) AS total_promotions FROM call_center cc JOIN store_sales ss ON cc.cc_call_center_sk = ss.ss_store_sk JOIN promotion p ON ss.ss_promo_sk = p.p_promo_sk WHERE p.p_channel_dmail = 'Y' AND ss.ss_sold_date_sk BETWEEN p.p_start_date_sk AND p.p_end_date_sk GROUP BY cc.cc_call_center_id, cc.cc_name, cc.cc_city, cc.cc_state ORDER BY total_sales DESC, avg_discount_amount DESC;
SELECT c.c_birth_country, sm.sm_type AS shipping_type, COUNT(DISTINCT ws.ws_order_number) AS total_orders, SUM(ws.ws_quantity) AS total_quantity, AVG(ws.ws_sales_price) AS average_sales_price, SUM(ws.ws_net_paid) AS total_net_paid, SUM(ws.ws_ext_tax) AS total_tax_collected, SUM(ws.ws_coupon_amt) AS total_coupon_amount, SUM(ws.ws_net_profit) AS total_net_profit FROM web_sales ws JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk GROUP BY c.c_birth_country, sm.sm_type ORDER BY c.c_birth_country, sm.sm_type;
SELECT s.s_store_id, s.s_store_name, d.d_year, COUNT(DISTINCT c.c_customer_sk) AS total_customers, SUM(CASE WHEN c.c_preferred_cust_flag = 'Y' THEN 1 ELSE 0 END) AS preferred_customers, AVG(s.s_number_employees) AS average_employees, AVG(s.s_floor_space) AS average_floor_space, SUM(s.s_tax_precentage) AS total_tax_percentage FROM store s JOIN customer c ON s.s_store_sk = c.c_current_addr_sk JOIN date_dim d ON c.c_first_sales_date_sk = d.d_date_sk WHERE s.s_division_name <> 'Unknown' AND c.c_last_review_date_sk IN ('2452522', '2452308', '2452629', '2452335', '2452592', '2452622') AND c.c_first_name IN ('Tyler', 'Rhona', 'Mohammad') AND d.d_last_dom IN ('2417208', '2418853') AND d.d_following_holiday = 'Y' GROUP BY s.s_store_id, s.s_store_name, d.d_year ORDER BY total_customers DESC, preferred_customers DESC, average_employees DESC, average_floor_space DESC, total_tax_percentage DESC;
SELECT sm.sm_type, w.w_state, COUNT(DISTINCT cr.cr_order_number) AS total_returns, SUM(cr.cr_return_amount) AS total_return_amount, AVG(cr.cr_return_amount) AS average_return_amount, SUM(cr.cr_net_loss) AS total_net_loss, SUM(cs.cs_sales_price) AS total_sales, AVG(cs.cs_sales_price) AS average_sales_price, SUM(cs.cs_net_profit) AS total_net_profit, SUM(i.inv_quantity_on_hand) AS total_inventory_on_hand FROM catalog_returns cr JOIN ship_mode sm ON cr.cr_ship_mode_sk = sm.sm_ship_mode_sk JOIN warehouse w ON cr.cr_warehouse_sk = w.w_warehouse_sk JOIN catalog_sales cs ON cr.cr_item_sk = cs.cs_item_sk AND cr.cr_order_number = cs.cs_order_number JOIN inventory i ON cr.cr_item_sk = i.inv_item_sk AND w.w_warehouse_sk = i.inv_warehouse_sk WHERE cr.cr_returning_customer_sk IN ('98306', '44541', '85') GROUP BY sm.sm_type, w.w_state ORDER BY total_net_loss DESC;
SELECT s.s_store_name, s.s_city, s.s_manager, COUNT(DISTINCT sm.sm_ship_mode_sk) AS distinct_shipping_modes, SUM(s.s_floor_space) AS total_floor_space, AVG(s.s_number_employees) AS average_number_of_employees, SUM(s.s_tax_precentage) AS total_tax_percentage, COUNT(*) AS count_of_stores FROM store s LEFT JOIN ship_mode sm ON s.s_store_sk = sm.sm_ship_mode_sk LEFT JOIN reason r ON r.r_reason_sk = s.s_closed_date_sk WHERE s.s_manager IN ('Scott Smith', 'William Ward') AND s.s_city IN ('Fairview', 'Midway') AND r.r_reason_id IN ('AAAAAAAAOBAAAAAA', 'AAAAAAAAMBAAAAAA', 'AAAAAAAAGAAAAAAA', 'AAAAAAAAJBAAAAAA') AND sm.sm_type IN ('NEXT DAY', 'TWO DAY', 'LIBRARY', 'EXPRESS', 'REGULAR', 'OVERNIGHT') GROUP BY s.s_store_name, s.s_city, s.s_manager ORDER BY s.s_city, s.s_store_name;
SELECT cd.cd_gender, cd.cd_marital_status, cd.cd_education_status, cd.cd_purchase_estimate, hd.hd_buy_potential, hd.hd_income_band_sk, COUNT(DISTINCT cr.cr_order_number) AS total_returned_orders, SUM(cr.cr_return_quantity) AS total_returned_quantity, AVG(cr.cr_return_amount) AS avg_return_amount, AVG(cr.cr_return_tax) AS avg_return_tax, AVG(cr.cr_net_loss) AS avg_net_loss FROM catalog_returns cr JOIN customer_demographics cd ON cr.cr_returning_cdemo_sk = cd.cd_demo_sk JOIN household_demographics hd ON cr.cr_returning_hdemo_sk = hd.hd_demo_sk WHERE cr.cr_call_center_sk IN (1, 2, 4) AND hd.hd_buy_potential IN ('0-500', '501-1000', '>10000') AND hd.hd_income_band_sk = 20 AND cd.cd_dep_employed_count = 0 AND cd.cd_gender IN ('M', 'F') GROUP BY cd.cd_gender, cd.cd_marital_status, cd.cd_education_status, cd.cd_purchase_estimate, hd.hd_buy_potential, hd.hd_income_band_sk ORDER BY cd.cd_gender, cd.cd_marital_status, cd.cd_education_status, cd.cd_purchase_estimate, hd.hd_buy_potential, hd.hd_income_band_sk;
SELECT ca_state, EXTRACT(YEAR FROM d_date) AS sale_year, COUNT(DISTINCT cs_order_number) AS total_orders, SUM(cs_quantity) AS total_quantity, SUM(cs_ext_sales_price) AS total_sales, AVG(cs_sales_price) AS avg_sales_price, SUM(cs_net_profit) AS total_profit FROM catalog_sales JOIN customer ON cs_bill_customer_sk = c_customer_sk JOIN customer_address ON c_current_addr_sk = ca_address_sk JOIN date_dim ON cs_sold_date_sk = d_date_sk WHERE ca_country = 'United States' AND ca_state IN ('LA', 'NC', 'KS', 'MI') AND cs_ext_sales_price > 100.00 AND cs_ext_sales_price < 15000.00 AND d_year = 2022 AND d_moy BETWEEN 1 AND 6 GROUP BY ca_state, sale_year ORDER BY total_sales DESC;
SELECT s.s_store_name, s.s_floor_space, s.s_number_employees, s.s_city, s.s_state, dd.d_year, dd.d_quarter_name, SUM(i.inv_quantity_on_hand) AS total_inventory, AVG(i.inv_quantity_on_hand) AS average_inventory, COUNT(DISTINCT i.inv_item_sk) AS unique_items_count, COUNT(DISTINCT i.inv_warehouse_sk) AS unique_warehouses_count FROM inventory i JOIN store s ON i.inv_warehouse_sk = s.s_store_sk JOIN date_dim dd ON i.inv_date_sk = dd.d_date_sk WHERE dd.d_current_month = 'N' AND s.s_store_name LIKE ANY (ARRAY['%eing%', '%ought%', '%bar%', '%ation%', '%anti%', '%able%']) GROUP BY s.s_store_name, s.s_floor_space, s.s_number_employees, s.s_city, s.s_state, dd.d_year, dd.d_quarter_name ORDER BY s.s_state, s.s_city, dd.d_year, dd.d_quarter_name;
SELECT dd.d_year, dd.d_quarter_name, ca.ca_state, COUNT(DISTINCT cs.cs_order_number) AS total_orders, SUM(cs.cs_quantity) AS total_quantity, SUM(cs.cs_net_paid) AS total_net_paid, AVG(cs.cs_net_profit) AS avg_net_profit FROM catalog_sales cs JOIN date_dim dd ON cs.cs_sold_date_sk = dd.d_date_sk JOIN customer_address ca ON cs.cs_ship_addr_sk = ca.ca_address_sk JOIN customer_demographics cd ON cs.cs_bill_cdemo_sk = cd.cd_demo_sk JOIN store s ON ca.ca_state = s.s_state WHERE dd.d_current_quarter = 'N' AND dd.d_following_holiday = 'N' AND cd.cd_credit_rating = 'Good' AND s.s_market_id IS NOT NULL GROUP BY dd.d_year, dd.d_quarter_name, ca.ca_state ORDER BY dd.d_year, dd.d_quarter_name, ca.ca_state;
SELECT dd.d_year, dd.d_moy, sm.sm_type, COUNT(DISTINCT cs.cs_order_number) AS total_orders, SUM(cs.cs_quantity) AS total_quantity_sold, SUM(cs.cs_net_paid) AS total_net_sales, AVG(cs.cs_net_paid) AS avg_net_sales_per_order, SUM(sr.sr_return_quantity) AS total_quantity_returned, SUM(sr.sr_net_loss) AS total_net_loss, AVG(sr.sr_net_loss) AS avg_net_loss_per_return, SUM(wr.wr_return_quantity) AS total_web_quantity_returned, SUM(wr.wr_net_loss) AS total_web_net_loss, AVG(wr.wr_net_loss) AS avg_web_net_loss_per_return, COUNT(DISTINCT hd.hd_demo_sk) AS unique_customers FROM date_dim dd LEFT JOIN catalog_sales cs ON dd.d_date_sk = cs.cs_sold_date_sk LEFT JOIN store_returns sr ON dd.d_date_sk = sr.sr_returned_date_sk LEFT JOIN web_returns wr ON dd.d_date_sk = wr.wr_returned_date_sk LEFT JOIN ship_mode sm ON cs.cs_ship_mode_sk = sm.sm_ship_mode_sk LEFT JOIN household_demographics hd ON cs.cs_bill_hdemo_sk = hd.hd_demo_sk WHERE dd.d_year = 2003 AND sm.sm_carrier IN ('ZOUROS', 'ALLIANCE', 'GREAT EASTERN') AND hd.hd_income_band_sk IN (10, 3, 16) AND hd.hd_buy_potential IN ('Unknown', '501-1000', '1001-5000') GROUP BY dd.d_year, dd.d_moy, sm.sm_type ORDER BY dd.d_year, dd.d_moy, sm.sm_type;
