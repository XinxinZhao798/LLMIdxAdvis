SELECT s.s_state, s.s_county, cd.cd_marital_status, COUNT(DISTINCT i.i_item_sk) AS total_items, SUM(i.i_current_price) AS total_revenue, AVG(i.i_wholesale_cost) AS average_wholesale_cost, COUNT(DISTINCT hd.hd_demo_sk) AS total_households, AVG(hd.hd_vehicle_count) AS average_vehicle_count, SUM(CASE WHEN i.i_units = 'Bundle' THEN 1 ELSE 0 END) AS bundle_units, SUM(CASE WHEN i.i_units = 'Pound' THEN 1 ELSE 0 END) AS pound_units, SUM(CASE WHEN i.i_units = 'Oz' THEN 1 ELSE 0 END) AS oz_units, COUNT(DISTINCT s.s_store_sk) AS total_stores, AVG(s.s_floor_space) AS average_floor_space FROM item i JOIN store s ON (i.i_manufact_id = s.s_store_sk) JOIN household_demographics hd ON (s.s_store_sk = hd.hd_income_band_sk) JOIN customer_demographics cd ON (hd.hd_demo_sk = cd.cd_demo_sk) WHERE hd.hd_dep_count IN ('6', '9', '5') AND hd.hd_demo_sk IN ('28', '1536', '3779') AND hd.hd_vehicle_count IN ('2', '1', '3') AND i.i_units IN ('Bundle', 'Pound', 'Oz') AND i.i_rec_end_date IN ('1999-10-27', '2000-10-26', '2001-10-26') AND s.s_market_desc IN ('Events develop i', 'Architects coul', 'Little expectations include yet forward meetings.') AND s.s_state = 'TN' AND s.s_county = 'Williamson County' AND s.s_floor_space IN ('8954883', '9341467', '5285950') AND cd.cd_dep_college_count = '0' AND cd.cd_demo_sk IN ('20554', '21012', '21822') AND cd.cd_marital_status IN ('S', 'M', 'D') GROUP BY s.s_state, s.s_county, cd.cd_marital_status ORDER BY total_revenue DESC, average_wholesale_cost DESC;
SELECT cc.cc_call_center_id, cc.cc_name, cc.cc_class, SUM(ss.ss_quantity) AS total_quantity_sold, AVG(ss.ss_sales_price) AS average_sales_price, COUNT(DISTINCT c.c_customer_sk) AS unique_customers, COUNT(DISTINCT cp.cp_catalog_page_sk) AS catalog_pages_used, SUM(ss.ss_net_paid) AS total_net_paid, SUM(ss.ss_net_paid_inc_tax) AS total_net_paid_including_tax, SUM(ss.ss_net_profit) AS total_net_profit, AVG(t.t_hour) AS average_hour_of_sale FROM call_center cc JOIN store_sales ss ON cc.cc_call_center_sk = ss.ss_store_sk JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk JOIN catalog_page cp ON c.c_current_cdemo_sk = cp.cp_catalog_page_sk JOIN time_dim t ON ss.ss_sold_time_sk = t.t_time_sk WHERE (cc.cc_rec_start_date IS NULL OR cc.cc_rec_start_date <= CURRENT_DATE) AND (cc.cc_rec_end_date IS NULL OR cc.cc_rec_end_date >= CURRENT_DATE) AND t.t_second IN ('16', '11') AND ss.ss_hdemo_sk IN ('1989', '6188') AND c.c_current_hdemo_sk IN ('3971', '3131', '4808', '7162', '6897', '2935') AND cc.cc_call_center_sk = 5 GROUP BY cc.cc_call_center_id, cc.cc_name, cc.cc_class ORDER BY total_net_profit DESC, average_sales_price DESC;
SELECT cc.cc_division_name, COUNT(DISTINCT cc.cc_call_center_sk) AS num_call_centers, AVG(cc.cc_employees) AS avg_employees, SUM(inv.inv_quantity_on_hand) AS total_inventory, SUM(wr.wr_return_amt_inc_tax) AS total_returns_inc_tax, AVG(wp.wp_link_count) AS avg_link_count_per_page FROM call_center cc JOIN inventory inv ON cc.cc_call_center_sk = inv.inv_warehouse_sk JOIN web_returns wr ON inv.inv_item_sk = wr.wr_item_sk JOIN web_page wp ON wr.wr_web_page_sk = wp.wp_web_page_sk WHERE cc.cc_division IN (1, 3, 5) AND cc.cc_open_date_sk IN (2450952, 2450806, 2451063) AND wr.wr_web_page_sk IN (2, 32, 58, 26, 39) GROUP BY cc.cc_division_name ORDER BY total_returns_inc_tax DESC, avg_link_count_per_page DESC;
SELECT ca_state, cp_department, SUM(ss_quantity) AS total_quantity_sold, AVG(ss_sales_price) AS average_sales_price, COUNT(DISTINCT ss_customer_sk) AS unique_customers, SUM(ss_net_paid) AS total_net_paid, SUM(ss_net_paid_inc_tax) AS total_net_paid_inc_tax, SUM(ss_net_profit) AS total_net_profit FROM store_sales JOIN customer_address ON ss_addr_sk = ca_address_sk JOIN catalog_page ON ss_promo_sk = cp_catalog_page_sk WHERE ss_sold_date_sk = 2450815 AND cp_description IN ( 'Only nuclear policies understand so basic courts.', 'Just local products used to note well; areas note', 'Women apply in vain in the minutes. Officials can', 'Traditional, clear years used to cover regardless' ) AND ss_cdemo_sk IN ( SELECT cd_demo_sk FROM customer_demographics WHERE cd_dep_count IN ('1', '2') ) GROUP BY ca_state, cp_department ORDER BY total_net_profit DESC, total_quantity_sold DESC;
SELECT ca_state, SUM(sr_return_amt) AS total_return_amount, AVG(sr_return_quantity) AS avg_return_quantity, COUNT(DISTINCT sr_customer_sk) AS unique_customers_returning, SUM(CASE WHEN p_channel_press = 'N' AND p_channel_catalog = 'N' THEN sr_return_amt ELSE 0 END) AS total_return_amount_no_press_no_catalog, wm.warehouse_count, sm.sm_count, ib.ib_count FROM store_returns sr JOIN customer_address ca ON sr.sr_addr_sk = ca.ca_address_sk JOIN (SELECT w_state, COUNT(*) AS warehouse_count FROM warehouse GROUP BY w_state) wm ON ca.ca_state = wm.w_state JOIN (SELECT sm_carrier, COUNT(*) AS sm_count FROM ship_mode WHERE sm_carrier IN ('ALLIANCE', 'ZOUROS', 'UPS') GROUP BY sm_carrier) sm ON 1=1 JOIN (SELECT ib_lower_bound, COUNT(*) AS ib_count FROM income_band GROUP BY ib_lower_bound) ib ON 1=1 LEFT JOIN promotion p ON sr.sr_reason_sk = p.p_promo_sk WHERE sr.sr_reason_sk IN (19, 26, 34, 7, 29) AND ca.ca_street_name IN ('Johnson Spruce', '12th View', 'Dogwood 12th', '15th Third', 'Ninth Fourth', '1st 7th') AND sr_return_amt > 0 GROUP BY ca_state, wm.warehouse_count, sm.sm_count, ib.ib_count ORDER BY total_return_amount DESC LIMIT 100;
SELECT cd.cd_education_status, cd.cd_marital_status, CASE WHEN cd.cd_purchase_estimate < 2000 THEN 'Low' WHEN cd.cd_purchase_estimate BETWEEN 2000 AND 3500 THEN 'Medium' WHEN cd.cd_purchase_estimate > 3500 THEN 'High' ELSE 'Unknown' END AS purchase_estimate_range, COUNT(DISTINCT ws.ws_order_number) AS total_orders, SUM(ws.ws_net_paid) AS total_revenue, AVG(ws.ws_net_paid) AS average_revenue_per_order, COUNT(DISTINCT ws.ws_bill_customer_sk) AS total_customers FROM web_sales ws JOIN customer_demographics cd ON ws.ws_bill_cdemo_sk = cd.cd_demo_sk JOIN time_dim t ON ws.ws_sold_time_sk = t.t_time_sk JOIN web_site wsit ON ws.ws_web_site_sk = wsit.web_site_sk WHERE wsit.web_market_manager = 'Jeffrey Campbell' AND t.t_shift = 'third' AND cd.cd_dep_college_count = 0 GROUP BY cd.cd_education_status, cd.cd_marital_status, purchase_estimate_range ORDER BY total_revenue DESC;
SELECT ca_state, cd_gender, cd_marital_status, sm_type, SUM(ss_quantity) AS total_quantity_sold, AVG(ss_sales_price) AS average_sales_price, COUNT(DISTINCT ss_customer_sk) AS unique_customers, SUM(sr_return_quantity) AS total_quantity_returned, AVG(sr_return_amt) AS average_return_amount, SUM(sr_net_loss) AS total_net_loss FROM store_sales JOIN customer_address ON ss_addr_sk = ca_address_sk JOIN customer_demographics ON ss_cdemo_sk = cd_demo_sk JOIN ship_mode ON sm_ship_mode_sk = ss_promo_sk LEFT JOIN store_returns ON sr_ticket_number = ss_ticket_number AND sr_item_sk = ss_item_sk WHERE ca_state IS NOT NULL AND cd_gender IN ('M', 'F') AND cd_marital_status IN ('M', 'U', 'S', 'D') GROUP BY ca_state, cd_gender, cd_marital_status, sm_type ORDER BY total_quantity_sold DESC, average_sales_price DESC;
SELECT i.i_category, i.i_size, hd.hd_buy_potential, COUNT(p.p_promo_sk) AS total_promotions, SUM(p.p_cost) AS total_promo_cost, AVG(p.p_cost) AS average_promo_cost, CASE WHEN p.p_channel_catalog = 'N' THEN 'Not Catalog' ELSE 'Catalog' END AS promo_channel_catalog, SUM(CASE WHEN p.p_discount_active = 'Y' THEN 1 ELSE 0 END) AS active_discounts FROM promotion p JOIN item i ON p.p_item_sk = i.i_item_sk JOIN household_demographics hd ON i.i_size = hd.hd_buy_potential JOIN customer_demographics cd ON hd.hd_income_band_sk = cd.cd_purchase_estimate WHERE i.i_size IN ('economy', 'medium', 'large') AND hd.hd_buy_potential IN ('>10000', 'Unknown', '0-500', '5001-10000', '1001-5000', '501-1000') AND p.p_channel_catalog = 'N' AND i.i_category_id = '8' AND p.p_purpose NOT IN ('Unknown') GROUP BY i.i_category, i.i_size, hd.hd_buy_potential, promo_channel_catalog ORDER BY total_promotions DESC, total_promo_cost DESC;
SELECT sm.sm_ship_mode_id, sm.sm_type, cd.cd_credit_rating, COUNT(DISTINCT ws.ws_order_number) AS total_sales_transactions, AVG(ws.ws_net_paid_inc_tax) AS avg_sales_amount, COUNT(DISTINCT cr.cr_order_number) AS total_return_transactions, AVG(cr.cr_return_amt_inc_tax) AS avg_return_amount, SUM(ws.ws_quantity) AS total_quantity_sold, SUM(cr.cr_return_quantity) AS total_quantity_returned FROM ship_mode sm LEFT JOIN web_sales ws ON sm.sm_ship_mode_sk = ws.ws_ship_mode_sk LEFT JOIN catalog_returns cr ON ws.ws_order_number = cr.cr_order_number LEFT JOIN customer_demographics cd ON ws.ws_ship_cdemo_sk = cd.cd_demo_sk WHERE sm.sm_ship_mode_id IN ('AAAAAAAANAAAAAAA', 'AAAAAAAADBAAAAAA', 'AAAAAAAADAAAAAAA', 'AAAAAAAACAAAAAAA') AND cd.cd_credit_rating IN ('Low Risk', 'High Risk', 'Unknown', 'Good') GROUP BY sm.sm_ship_mode_id, sm.sm_type, cd.cd_credit_rating ORDER BY sm.sm_ship_mode_id, cd.cd_credit_rating;
SELECT d_year, sm_type, r_reason_desc, COUNT(*) AS total_returns, SUM(cr_return_amount) AS total_return_amount, AVG(cr_return_amount) AS average_return_amount, SUM(cr_return_quantity) AS total_return_quantity, AVG(cr_return_quantity) AS average_return_quantity FROM catalog_returns JOIN date_dim ON cr_returned_date_sk = d_date_sk JOIN reason ON cr_reason_sk = r_reason_sk JOIN ship_mode ON cr_ship_mode_sk = sm_ship_mode_sk WHERE d_year IN (2020, 2021) AND cr_refunded_hdemo_sk IN ('6319', '1691', '6783', '2583', '2054', '1550') AND cr_refunded_customer_sk IN ('44015', '70912', '7271') GROUP BY d_year, sm_type, r_reason_desc ORDER BY d_year, total_return_amount DESC, total_returns DESC;
