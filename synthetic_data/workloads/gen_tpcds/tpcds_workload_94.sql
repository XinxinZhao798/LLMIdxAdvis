SELECT dd.d_year, i.i_category, COUNT(DISTINCT cs_order_number) AS total_orders, SUM(cs_quantity) AS total_quantity_sold, AVG(cs_sales_price) AS average_sales_price, SUM(cs_net_profit) AS total_net_profit, COUNT(DISTINCT wr_order_number) AS total_returns, SUM(wr_return_quantity) AS total_quantity_returned, AVG(wr_return_amt) AS average_return_amount, SUM(wr_net_loss) AS total_net_loss FROM date_dim dd JOIN catalog_sales cs ON dd.d_date_sk = cs.cs_sold_date_sk JOIN item i ON cs.cs_item_sk = i.i_item_sk LEFT JOIN web_returns wr ON i.i_item_sk = wr.wr_item_sk AND cs.cs_order_number = wr.wr_order_number WHERE dd.d_year = 2001 AND i.i_size = 'medium' AND ( wr.wr_refunded_hdemo_sk = '4852' OR wr.wr_fee IN ('29.43', '58.44') OR dd.d_same_day_lq IN ('2415041', '2417033', '2416545', '2418165', '2417025', '2416046') ) GROUP BY dd.d_year, i.i_category ORDER BY total_net_profit DESC, total_net_loss ASC;
SELECT ca.ca_country, r.r_reason_desc, COUNT(cr.cr_order_number) AS return_count, SUM(cr.cr_return_amount) AS total_return_amount, AVG(cr.cr_return_amount) AS avg_return_amount, SUM(cr.cr_return_amt_inc_tax) AS total_return_inc_tax, AVG(cr.cr_return_amt_inc_tax) AS avg_return_inc_tax FROM catalog_returns cr JOIN reason r ON cr.cr_reason_sk = r.r_reason_sk JOIN customer_address ca ON cr.cr_refunded_addr_sk = ca.ca_address_sk WHERE ca.ca_country = 'United States' AND r.r_reason_desc = 'reason 27' GROUP BY ca.ca_country, r.r_reason_desc ORDER BY total_return_amount DESC;
SELECT d_year, i_category, s_state, SUM(i_current_price) AS total_price, AVG(i_current_price) AS avg_price, COUNT(DISTINCT i_item_sk) AS unique_items_sold, COUNT(DISTINCT s_store_sk) AS number_of_stores, SUM(p_cost) AS total_promotion_cost, AVG(p_cost) AS avg_promotion_cost, COUNT(DISTINCT p_promo_sk) AS number_of_promotions, MAX(wp_max_ad_count) AS max_ad_count_webpage FROM date_dim, item, store, promotion, web_page, ship_mode WHERE i_rec_start_date <= d_date AND (i_rec_end_date IS NULL OR i_rec_end_date > d_date) AND s_rec_start_date <= d_date AND (s_rec_end_date IS NULL OR s_rec_end_date > d_date) AND wp_rec_start_date <= d_date AND (wp_rec_end_date IS NULL OR wp_rec_end_date > d_date) AND p_start_date_sk = d_date_sk AND (p_end_date_sk IS NULL OR p_end_date_sk >= d_date_sk) AND sm_type IN ('REGULAR', 'LIBRARY') AND i_class IN ('sports-apparel', 'decor', 'dvd/vcr players', 'shirts', 'bedding', 'fishing') AND p_channel_event = 'N' AND p_purpose <> 'Unknown' GROUP BY d_year, i_category, s_state ORDER BY d_year, i_category, s_state;
SELECT c.cc_call_center_id AS call_center, c.cc_name AS call_center_name, c.cc_manager AS call_center_manager, i.i_manufact_id AS manufacturer_id, COUNT(ws.ws_order_number) AS total_orders, SUM(ws.ws_quantity) AS total_quantity_sold, AVG(ws.ws_sales_price) AS average_sales_price, SUM(ws.ws_net_profit) AS total_net_profit FROM call_center c JOIN web_sales ws ON c.cc_call_center_sk = ws.ws_warehouse_sk JOIN item i ON ws.ws_item_sk = i.i_item_sk JOIN customer_demographics cd ON ws.ws_bill_cdemo_sk = cd.cd_demo_sk JOIN date_dim dd ON ws.ws_sold_date_sk = dd.d_date_sk WHERE i.i_manufact_id IN (275, 862, 397) AND c.cc_open_date_sk <= dd.d_date_sk AND (c.cc_rec_end_date IS NULL OR c.cc_rec_end_date >= dd.d_date) GROUP BY c.cc_call_center_id, c.cc_name, c.cc_manager, i.i_manufact_id ORDER BY total_net_profit DESC;
SELECT wd.wp_type AS web_page_type, cd.cd_education_status AS customer_education_status, cd.cd_credit_rating AS customer_credit_rating, COUNT(DISTINCT cr.cr_order_number) AS total_returns, AVG(cr.cr_return_amount) AS avg_return_amount, SUM(cr.cr_return_amount) AS total_return_amount, COUNT(DISTINCT ws.ws_order_number) AS total_sales_orders, AVG(ws.ws_net_profit) AS avg_net_profit, SUM(ws.ws_net_profit) AS total_net_profit, SUM(ws.ws_quantity) AS total_items_sold, AVG(ws.ws_sales_price) AS avg_sales_price FROM catalog_returns cr JOIN customer_demographics cd ON cr.cr_returning_cdemo_sk = cd.cd_demo_sk JOIN web_sales ws ON cr.cr_order_number = ws.ws_order_number JOIN web_page wd ON ws.ws_web_page_sk = wd.wp_web_page_sk WHERE wd.wp_char_count = 1564 AND (ws.ws_ext_wholesale_cost = 1838.55 OR ws.ws_ext_wholesale_cost = 3498.48 OR ws.ws_ext_wholesale_cost = 1969.22 OR ws.ws_ext_wholesale_cost = 5894.70 OR ws.ws_ext_wholesale_cost = 5691.84) AND (ws.ws_net_paid = 34.31 OR ws.ws_net_paid = 2469.75 OR ws.ws_net_paid = 2146.56 OR ws.ws_net_paid = 35.86) AND cd.cd_marital_status = 'D' AND (cd.cd_demo_sk = 20608 OR cd.cd_demo_sk = 17946 OR cd.cd_demo_sk = 16993 OR cd.cd_demo_sk = 17510 OR cd.cd_demo_sk = 20633) AND cr.cr_call_center_sk = 2 AND cr.cr_item_sk = 14684 GROUP BY wd.wp_type, cd.cd_education_status, cd.cd_credit_rating ORDER BY total_returns DESC, total_net_profit DESC;
SELECT w.w_warehouse_name, cc.cc_name AS call_center_name, cd.cp_department, sm.sm_type AS ship_mode_type, AVG(ss.ss_sales_price) AS avg_sales_price, SUM(ss.ss_quantity) AS total_quantity_sold, COUNT(DISTINCT ss.ss_customer_sk) AS unique_customers, SUM(CASE WHEN hd.hd_vehicle_count > 2 THEN ss.ss_net_paid ELSE 0 END) AS net_paid_more_than_2_vehicles, SUM(CASE WHEN cd.cp_type = 'quarterly' THEN ss.ss_net_paid_inc_tax ELSE 0 END) AS net_paid_inc_tax_for_quarterly_pages FROM store_sales ss JOIN warehouse w ON ss.ss_store_sk = w.w_warehouse_sk JOIN call_center cc ON w.w_zip = cc.cc_zip JOIN catalog_page cd ON ss.ss_promo_sk = cd.cp_catalog_page_sk JOIN ship_mode sm ON sm.sm_code = 'AIR' JOIN household_demographics hd ON ss.ss_hdemo_sk = hd.hd_demo_sk WHERE cc.cc_street_type = 'Boulevard' AND cd.cp_type IN ('quarterly', 'bi-annual') AND w.w_suite_number IN ('Suite 80', 'Suite P') GROUP BY w.w_warehouse_name, cc.cc_name, cd.cp_department, sm.sm_type ORDER BY avg_sales_price DESC, total_quantity_sold DESC, unique_customers DESC, net_paid_more_than_2_vehicles DESC, net_paid_inc_tax_for_quarterly_pages DESC;
SELECT cd.cd_gender, cd.cd_marital_status, cd.cd_education_status, COUNT(DISTINCT cs.cs_order_number) AS total_catalog_orders, SUM(cs.cs_quantity) AS total_catalog_quantity, AVG(cs.cs_sales_price) AS avg_catalog_sales_price, SUM(ss.ss_net_profit) AS total_store_net_profit, AVG(ss.ss_sales_price) AS avg_store_sales_price, COUNT(DISTINCT wp.wp_web_page_sk) AS total_web_page_visits, SUM(wp.wp_link_count) AS total_web_page_links, ws.web_name, ws.web_company_name, ib.ib_lower_bound, ib.ib_upper_bound, s.s_store_name, s.s_number_employees, s.s_floor_space FROM customer_demographics cd LEFT JOIN catalog_sales cs ON cd.cd_demo_sk = cs.cs_bill_cdemo_sk LEFT JOIN store_sales ss ON cd.cd_demo_sk = ss.ss_cdemo_sk LEFT JOIN web_page wp ON cd.cd_demo_sk = wp.wp_customer_sk LEFT JOIN web_site ws ON wp.wp_web_page_id = ws.web_site_id LEFT JOIN income_band ib ON cd.cd_purchase_estimate BETWEEN ib.ib_lower_bound AND ib.ib_upper_bound LEFT JOIN store s ON ss.ss_store_sk = s.s_store_sk LEFT JOIN catalog_page cp ON cs.cs_catalog_page_sk = cp.cp_catalog_page_sk WHERE ib.ib_income_band_sk IN (6, 11, 7) AND (s.s_rec_end_date IN ('1999-03-13', '2000-03-12', '2001-03-12') OR s.s_rec_end_date IS NULL) AND (s.s_store_name LIKE '%cally%' OR s.s_store_name LIKE '%ation%' OR s.s_store_name LIKE '%eing%') AND wp.wp_web_page_id IN ('AAAAAAAAJBAAAAAA', 'AAAAAAAAIAAAAAAA', 'AAAAAAAAMCAAAAAA') AND wp.wp_web_page_sk IN (30, 40, 9) AND wp.wp_rec_end_date IN ('2000-09-02', '1999-09-03', '2001-09-02') AND cd.cd_dep_college_count = 0 AND cd.cd_marital_status IN ('U', 'W', 'S') AND cd.cd_dep_employed_count = 0 AND ss.ss_sales_price IN (6.97, 54.53, 6.01) AND ss.ss_net_profit IN (-2115.52, -1765.80, -614.39) AND cs.cs_ext_tax IN (18.59, 2.99, 205.24) AND cs.cs_sold_date_sk IN (2450841, 2450829, 2450825) AND ws.web_name IN ('site_2', 'site_4', 'site_0') AND ws.web_street_number IN ('887', '973', '892') AND cp.cp_type IN ('quarterly', 'monthly', 'bi-annual') AND cp.cp_catalog_number IN (31, 32, 13) AND cp.cp_end_date_sk IN (2451574, 2451539, 2451299) GROUP BY cd.cd_gender, cd.cd_marital_status, cd.cd_education_status, ws.web_name, ws.web_company_name, ib.ib_lower_bound, ib.ib_upper_bound, s.s_store_name, s.s_number_employees, s.s_floor_space ORDER BY total_catalog_orders DESC, total_store_net_profit DESC, total_web_page_visits DESC;
SELECT c.c_last_name, c.c_first_name, c.c_email_address, SUM(ss.ss_net_paid) AS total_sales, AVG(ss.ss_quantity) AS avg_quantity_sold, COUNT(DISTINCT ss.ss_ticket_number) AS number_of_transactions, SUM(wr.wr_fee) AS total_return_fees, AVG(wr.wr_return_quantity) AS avg_return_quantity, COUNT(DISTINCT wr.wr_order_number) AS number_of_returns, r.r_reason_desc AS most_common_return_reason FROM store_sales ss JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk LEFT JOIN web_returns wr ON wr.wr_returning_customer_sk = c.c_customer_sk LEFT JOIN reason r ON wr.wr_reason_sk = r.r_reason_sk WHERE c.c_birth_day IN (12, 23, 14, 10, 22, 11) AND r.r_reason_desc IN ('Wrong size', 'unauthoized purchase', 'reason 32') GROUP BY c.c_last_name, c.c_first_name, c.c_email_address, r.r_reason_desc ORDER BY total_sales DESC, total_return_fees DESC;
SELECT cc.cc_city, cc.cc_name, i.i_category, sum(sr.sr_return_amt_inc_tax) AS total_return_amount_including_tax, avg(sr.sr_return_quantity) AS average_return_quantity, count(sr.sr_ticket_number) AS total_returns, sum(CASE WHEN hd.hd_dep_count BETWEEN 1 AND 3 THEN sr.sr_return_amt_inc_tax ELSE 0 END) AS return_amount_families_1_to_3_kids, sum(CASE WHEN hd.hd_dep_count >= 4 THEN sr.sr_return_amt_inc_tax ELSE 0 END) AS return_amount_families_4_or_more_kids, sum(CASE WHEN sr.sr_return_amt > 0 AND sr.sr_fee > 0 THEN 1 ELSE 0 END) AS returns_with_fees FROM store_returns sr JOIN item i ON sr.sr_item_sk = i.i_item_sk JOIN call_center cc ON cc.cc_city = 'Midway' LEFT JOIN household_demographics hd ON sr.sr_hdemo_sk = hd.hd_demo_sk WHERE sr.sr_returned_date_sk IS NOT NULL AND sr.sr_store_credit > 0 GROUP BY cc.cc_city, cc.cc_name, i.i_category ORDER BY total_return_amount_including_tax DESC, cc.cc_city, cc.cc_name, i.i_category;
SELECT w_state, i_manufact_id, i_manufact, SUM(sr_return_amt + wr_return_amt) AS total_return_amount, AVG(sr_return_amt + wr_return_amt) AS avg_return_amount, COUNT(DISTINCT sr_ticket_number) AS count_store_returns, COUNT(DISTINCT wr_order_number) AS count_web_returns, SUM(CASE WHEN p_promo_sk IS NOT NULL THEN 1 ELSE 0 END) AS promo_related_returns FROM warehouse w LEFT JOIN store_returns sr ON w.w_warehouse_sk = sr.sr_addr_sk LEFT JOIN web_returns wr ON w.w_warehouse_sk = wr.wr_refunded_addr_sk LEFT JOIN item i ON i.i_item_sk = sr.sr_item_sk OR i.i_item_sk = wr.wr_item_sk LEFT JOIN promotion p ON p.p_item_sk = i.i_item_sk AND (sr.sr_returned_date_sk BETWEEN p.p_start_date_sk AND p.p_end_date_sk OR wr.wr_returned_date_sk BETWEEN p.p_start_date_sk AND p.p_end_date_sk) WHERE w_state = 'TN' AND i_manufact_id IN (70, 177, 479) GROUP BY w_state, i_manufact_id, i_manufact HAVING SUM(sr_return_amt + wr_return_amt) > 0 ORDER BY total_return_amount DESC;
SELECT cd.cd_education_status, ib.ib_income_band_sk, COUNT(DISTINCT ws.ws_order_number) AS number_of_orders, SUM(ws.ws_net_profit) AS total_net_profit, AVG(ws.ws_sales_price) AS average_sales_price FROM web_sales ws JOIN customer_demographics cd ON ws.ws_bill_cdemo_sk = cd.cd_demo_sk JOIN household_demographics hd ON ws.ws_bill_hdemo_sk = hd.hd_demo_sk JOIN income_band ib ON hd.hd_income_band_sk = ib.ib_income_band_sk WHERE cd.cd_purchase_estimate IS NOT NULL AND ib.ib_upper_bound <= 110000 AND ib.ib_income_band_sk IN (4, 1, 14, 13, 8) GROUP BY ROLLUP (cd.cd_education_status, ib.ib_income_band_sk) ORDER BY total_net_profit DESC, cd.cd_education_status, ib.ib_income_band_sk;
SELECT cd.cd_gender, cd.cd_marital_status, cd.cd_education_status, cd.cd_purchase_estimate, cd.cd_credit_rating, hd.hd_income_band_sk, hd.hd_buy_potential, p.p_channel_dmail, p.p_channel_email, p.p_channel_catalog, p.p_channel_tv, p.p_channel_radio, p.p_channel_press, p.p_channel_event, p.p_channel_demo, AVG(ss.ss_sales_price) AS avg_sales_price, AVG(ss.ss_coupon_amt) AS avg_coupon_amt, SUM(ss.ss_quantity) AS total_quantity_sold, COUNT(DISTINCT ss.ss_ticket_number) AS total_sales_transactions, AVG((ss.ss_list_price - ss.ss_sales_price) / ss.ss_list_price * 100) AS avg_discount_rate FROM store_sales ss JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk JOIN household_demographics hd ON ss.ss_hdemo_sk = hd.hd_demo_sk JOIN promotion p ON ss.ss_promo_sk = p.p_promo_sk GROUP BY ROLLUP ( cd.cd_gender, cd.cd_marital_status, cd.cd_education_status, cd.cd_purchase_estimate, cd.cd_credit_rating, hd.hd_income_band_sk, hd.hd_buy_potential, p.p_channel_dmail, p.p_channel_email, p.p_channel_catalog, p.p_channel_tv, p.p_channel_radio, p.p_channel_press, p.p_channel_event, p.p_channel_demo ) ORDER BY cd.cd_gender, cd.cd_marital_status, cd.cd_education_status, cd.cd_purchase_estimate, cd.cd_credit_rating, hd.hd_income_band_sk, hd.hd_buy_potential, p.p_channel_dmail, p.p_channel_email, p.p_channel_catalog, p.p_channel_tv, p.p_channel_radio, p.p_channel_press, p.p_channel_event, p.p_channel_demo;
SELECT ssm.sm_code AS shipping_mode, AVG(ws.ws_ext_ship_cost) AS avg_shipping_cost, SUM(ws.ws_net_paid_inc_tax) AS total_net_sales, SUM(sr.sr_return_amt_inc_tax) AS total_return_amount, AVG(cr.cr_return_amount) AS avg_return_amount, COUNT(DISTINCT ws.ws_order_number) AS total_web_orders, COUNT(DISTINCT ss.ss_ticket_number) AS total_store_sales_transactions, COUNT(DISTINCT sr.sr_ticket_number) AS total_store_returns_transactions, COUNT(DISTINCT cr.cr_order_number) AS total_catalog_returns_transactions, (SUM(ws.ws_net_paid_inc_tax) - SUM(sr.sr_return_amt_inc_tax) - SUM(cr.cr_return_amt_inc_tax)) AS net_revenue FROM ship_mode AS ssm LEFT JOIN web_sales AS ws ON ssm.sm_ship_mode_sk = ws.ws_ship_mode_sk LEFT JOIN store_sales AS ss ON ws.ws_item_sk = ss.ss_item_sk LEFT JOIN store_returns AS sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_customer_sk = sr.sr_customer_sk LEFT JOIN catalog_returns AS cr ON cr.cr_item_sk = ws.ws_item_sk AND cr.cr_returning_customer_sk = ws.ws_bill_customer_sk GROUP BY ssm.sm_code ORDER BY net_revenue DESC;
SELECT ib.ib_lower_bound, ib.ib_upper_bound, COUNT(wr.wr_item_sk) AS total_returns, AVG(wr.wr_net_loss) AS avg_net_loss, AVG(wr.wr_return_amt) AS avg_return_amount FROM web_returns wr JOIN customer c ON wr.wr_refunded_customer_sk = c.c_customer_sk JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk JOIN income_band ib ON hd.hd_income_band_sk = ib.ib_income_band_sk WHERE wr.wr_net_loss IS NOT NULL AND ib.ib_lower_bound IN (120001, 160001, 170001, 130001, 190001) AND hd.hd_income_band_sk = 14 AND wr.wr_refunded_customer_sk IN (2008, 38728, 70489, 86208, 44407) GROUP BY ib.ib_lower_bound, ib.ib_upper_bound ORDER BY avg_net_loss DESC;
SELECT cc.cc_name, SUM(CASE WHEN p.p_channel_catalog = 'N' THEN p.p_cost ELSE 0 END) AS total_promotion_cost_catalog, AVG(i.i_current_price) AS average_item_price, COUNT(DISTINCT p.p_promo_sk) AS number_of_promotions, COUNT(DISTINCT i.i_item_sk) AS number_of_items_promoted, SUM(CASE WHEN cc.cc_hours = '8AM-4PM' THEN 1 ELSE 0 END) AS call_centers_8am_to_4pm, SUM(CASE WHEN cc.cc_hours = '8AM-8AM' THEN 1 ELSE 0 END) AS call_centers_24_hours FROM call_center cc JOIN promotion p ON cc.cc_call_center_sk = p.p_promo_sk JOIN item i ON p.p_item_sk = i.i_item_sk WHERE p.p_end_date_sk IN (2450406, 2450872, 2450915, 2450756, 2450513) AND cc.cc_hours IN ('8AM-4PM', '8AM-8AM') GROUP BY cc.cc_name ORDER BY total_promotion_cost_catalog DESC, average_item_price DESC;
SELECT p.p_promo_name, COUNT(DISTINCT s.sr_customer_sk) AS num_customers_affected, SUM(s.sr_return_quantity) AS total_returned_quantity, AVG(s.sr_return_amt_inc_tax) AS avg_return_amount_inc_tax, SUM(s.sr_fee) AS total_fees_collected, SUM(s.sr_net_loss) AS total_net_loss, r.r_reason_desc, cd.cd_credit_rating, sm.sm_carrier FROM store_returns s JOIN promotion p ON s.sr_item_sk = p.p_item_sk JOIN reason r ON s.sr_reason_sk = r.r_reason_sk JOIN customer_demographics cd ON s.sr_cdemo_sk = cd.cd_demo_sk JOIN ship_mode sm ON sm.sm_ship_mode_sk = s.sr_item_sk WHERE p.p_start_date_sk >= 2450905 AND (s.sr_return_ship_cost = 482.43 OR s.sr_return_ship_cost = 95.68 OR s.sr_return_ship_cost = 82.62 OR s.sr_return_ship_cost = 37.74 OR s.sr_return_ship_cost = 670.08 OR s.sr_return_ship_cost = 40.56) AND p.p_purpose = 'Unknown' AND r.r_reason_sk = 11 GROUP BY p.p_promo_name, r.r_reason_desc, cd.cd_credit_rating, sm.sm_carrier ORDER BY num_customers_affected DESC, total_net_loss DESC;
SELECT dd.d_year, dd.d_month_seq, SUM(ss.ss_quantity) AS total_quantity_sold, AVG(ss.ss_sales_price) AS avg_sales_price, COUNT(DISTINCT ss.ss_ticket_number) AS count_unique_sales_transactions, SUM(sr.sr_return_quantity) AS total_quantity_returned, AVG(sr.sr_return_amt) AS avg_return_amount, COUNT(DISTINCT sr.sr_ticket_number) AS count_unique_return_transactions, SUM(p.p_cost) AS total_promotion_cost, COUNT(DISTINCT p.p_promo_sk) AS count_unique_promotions FROM store_sales ss JOIN date_dim dd ON ss.ss_sold_date_sk = dd.d_date_sk LEFT JOIN store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number LEFT JOIN promotion p ON ss.ss_promo_sk = p.p_promo_sk WHERE p.p_channel_catalog = 'N' AND dd.d_year = 2002 GROUP BY dd.d_year, dd.d_month_seq ORDER BY dd.d_year, dd.d_month_seq;
SELECT sm.sm_type, sm.sm_carrier, COUNT(DISTINCT inv.inv_item_sk) AS distinct_items_shipped, SUM(inv.inv_quantity_on_hand) AS total_quantity_on_hand, AVG(inv.inv_quantity_on_hand) AS avg_quantity_per_item, s.s_store_name, s.s_company_name, s.s_city, s.s_state, COUNT(DISTINCT s.s_store_sk) AS number_of_stores, AVG(s.s_number_employees) AS avg_employees_per_store, SUM(s.s_floor_space) AS total_floor_space FROM ship_mode sm JOIN inventory inv ON sm.sm_ship_mode_sk = inv.inv_warehouse_sk JOIN store s ON inv.inv_warehouse_sk = s.s_store_sk WHERE inv.inv_item_sk = 11749 AND s.s_rec_end_date IS NULL GROUP BY sm.sm_type, sm.sm_carrier, s.s_store_name, s.s_company_name, s.s_city, s.s_state ORDER BY total_quantity_on_hand DESC, avg_employees_per_store DESC LIMIT 100;
SELECT s.s_store_name, w.web_name, SUM(i.i_current_price) AS total_sales_price, AVG(i.i_wholesale_cost) AS average_wholesale_cost, COUNT(DISTINCT c.cp_catalog_page_sk) AS num_catalog_pages, COUNT(DISTINCT w.web_site_sk) AS num_websites, COUNT(DISTINCT wp.wp_web_page_sk) AS num_web_pages, COUNT(DISTINCT sm.sm_ship_mode_sk) AS num_ship_modes, MAX(i.i_current_price) AS max_item_price, MIN(i.i_current_price) AS min_item_price FROM store s JOIN web_site w ON s.s_market_id = w.web_mkt_id JOIN web_page wp ON w.web_site_sk = wp.wp_customer_sk JOIN catalog_page c ON c.cp_department = s.s_geography_class JOIN item i ON i.i_category = c.cp_description JOIN ship_mode sm ON sm.sm_type = wp.wp_type WHERE s.s_company_name = 'Unknown' AND wp.wp_autogen_flag = 'N' AND s.s_street_name IN ('Park Green', 'Park Laurel', '4th') AND w.web_city IN ('Fairview', 'Midway') GROUP BY s.s_store_name, w.web_name ORDER BY total_sales_price DESC, average_wholesale_cost DESC LIMIT 100;
SELECT s_store_name, sm_type, COUNT(DISTINCT ss_ticket_number) AS total_sales_transactions, SUM(ss_quantity) AS total_units_sold, SUM(ss_net_paid) AS total_revenue, AVG(ss_net_profit) AS average_profit_per_sale, SUM(wr_return_quantity) AS total_units_returned, SUM(wr_net_loss) AS total_loss_from_returns, (SUM(ss_net_paid) - SUM(wr_net_loss)) AS net_revenue_after_returns FROM store_sales ss JOIN store s ON ss.ss_store_sk = s.s_store_sk JOIN ship_mode sm ON ss.ss_store_sk = sm.sm_ship_mode_sk LEFT JOIN web_returns wr ON ss.ss_item_sk = wr.wr_item_sk AND ss.ss_ticket_number = wr.wr_order_number WHERE ss_addr_sk IN ('39848', '37282') AND s_store_sk IN (5, 8, 1, 3, 6, 12) AND wr_returning_hdemo_sk IN (772, 5914) AND sm_ship_mode_sk IN (19, 20, 9) AND sm_carrier IN ('USPS', 'DHL', 'UPS') GROUP BY s_store_name, sm_type ORDER BY total_sales_transactions DESC;
SELECT web_name, SUM(p_cost) AS total_promotion_cost, AVG(inv_quantity_on_hand) AS avg_inventory_quantity, COUNT(DISTINCT c_customer_sk) AS unique_customer_count, COUNT(DISTINCT r_reason_sk) AS unique_reason_count FROM web_site JOIN promotion ON (web_close_date_sk BETWEEN p_start_date_sk AND p_end_date_sk) JOIN inventory ON (inv_date_sk BETWEEN p_start_date_sk AND p_end_date_sk) JOIN customer ON (c_first_sales_date_sk BETWEEN p_start_date_sk AND p_end_date_sk) LEFT JOIN reason ON (c_last_review_date_sk = r_reason_sk) WHERE p_channel_press = 'N' AND inv_warehouse_sk IN (1, 2) AND p_end_date_sk IN (2450816, 2450598, 2450185, 2450481) GROUP BY web_name ORDER BY total_promotion_cost DESC, avg_inventory_quantity DESC, unique_customer_count DESC, unique_reason_count DESC;
SELECT w.w_warehouse_name, i.ib_lower_bound, i.ib_upper_bound, COUNT(DISTINCT ss.ss_ticket_number) AS total_sales_transactions, SUM(ss.ss_quantity) AS total_quantity_sold, AVG(ss.ss_sales_price) AS average_sales_price, SUM(ss.ss_net_paid) AS total_net_paid, SUM(ss.ss_net_paid_inc_tax) AS total_net_paid_inc_tax, SUM(wr.wr_return_quantity) AS total_return_quantity, AVG(wr.wr_return_amt) AS average_return_amount, SUM(wr.wr_fee) AS total_return_fees, COUNT(DISTINCT wr.wr_order_number) AS total_return_transactions FROM warehouse w JOIN store_sales ss ON ss.ss_addr_sk = w.w_warehouse_sk JOIN household_demographics hd ON ss.ss_hdemo_sk = hd.hd_demo_sk JOIN income_band i ON hd.hd_income_band_sk = i.ib_income_band_sk LEFT JOIN web_returns wr ON wr.wr_item_sk = ss.ss_item_sk AND wr.wr_refunded_customer_sk = ss.ss_customer_sk WHERE w.w_county = 'Williamson County' AND ss.ss_sold_time_sk = 35623 AND i.ib_income_band_sk IN (SELECT hd_income_band_sk FROM household_demographics WHERE hd_demo_sk IN (6765, 6298, 2035)) GROUP BY w.w_warehouse_name, i.ib_lower_bound, i.ib_upper_bound ORDER BY w.w_warehouse_name, i.ib_lower_bound;
SELECT p.p_promo_name, sm.sm_type AS shipping_mode, COUNT(wr.wr_order_number) AS total_returns, SUM(wr.wr_return_amt_inc_tax) AS total_returned_amount, AVG(wr.wr_return_amt_inc_tax) AS average_return_amount FROM promotion p JOIN web_returns wr ON p.p_promo_sk = wr.wr_reason_sk JOIN inventory i ON wr.wr_item_sk = i.inv_item_sk JOIN warehouse w ON i.inv_warehouse_sk = w.w_warehouse_sk JOIN ship_mode sm ON sm.sm_ship_mode_id = w.w_zip JOIN income_band ib ON ib.ib_income_band_sk = w.w_warehouse_sk WHERE ib.ib_lower_bound >= 30000 AND ib.ib_upper_bound <= 90000 AND i.inv_item_sk IN (14186, 15508, 7795, 15079) AND sm.sm_type = 'EXPRESS' GROUP BY p.p_promo_name, sm.sm_type ORDER BY total_returned_amount DESC;
SELECT cc.cc_name, i.i_category, SUM(ss.ss_quantity) AS total_quantity, AVG(ss.ss_sales_price) AS avg_sales_price, COUNT(DISTINCT ss.ss_ticket_number) AS number_of_sales, SUM(ss.ss_net_paid) AS total_net_paid, SUM(ss.ss_net_paid_inc_tax) AS total_net_paid_inc_tax, SUM(ss.ss_net_profit) AS total_net_profit FROM store_sales ss JOIN item i ON ss.ss_item_sk = i.i_item_sk JOIN call_center cc ON cc.cc_division = i.i_class_id JOIN warehouse w ON w.w_warehouse_sk = cc.cc_division WHERE cc.cc_call_center_sk IN ('5', '3', '1') AND cc.cc_division IN ('1', '4', '5', '3') AND w.w_warehouse_sk IN ('3', '5', '1', '4', '2') AND ss.ss_net_paid_inc_tax = '3682.66' GROUP BY cc.cc_name, i.i_category ORDER BY total_net_paid DESC, avg_sales_price DESC;
SELECT cc.cc_name, cc.cc_city, cc.cc_state, SUM(ss.ss_quantity) AS total_quantity_sold, AVG(ss.ss_sales_price) AS average_sales_price, COUNT(DISTINCT ss.ss_ticket_number) AS number_of_sales, SUM(CASE WHEN p.p_discount_active = '1' THEN ss.ss_net_paid_inc_tax ELSE 0 END) AS total_revenue_with_discount, SUM(CASE WHEN p.p_discount_active = '0' THEN ss.ss_net_paid_inc_tax ELSE 0 END) AS total_revenue_without_discount FROM call_center cc JOIN store_sales ss ON cc.cc_call_center_sk = ss.ss_store_sk LEFT JOIN promotion p ON ss.ss_promo_sk = p.p_promo_sk WHERE cc.cc_sq_ft IN ('1138', '4134', '649', '3514', '2268') AND ss.ss_net_paid_inc_tax IN ('3576.44', '1406.62', '935.06', '961.29', '3070.18', '6397.11') AND ss.ss_list_price = '158.68' GROUP BY cc.cc_name, cc.cc_city, cc.cc_state ORDER BY total_quantity_sold DESC, average_sales_price DESC;
SELECT p.p_promo_name, cd.cd_gender, cd.cd_marital_status, cd.cd_education_status, COUNT(DISTINCT cs.cs_order_number) AS total_orders, SUM(cs.cs_quantity) AS total_quantity_sold, AVG(cs.cs_net_paid) AS avg_net_paid, SUM(cs.cs_net_paid_inc_tax) AS sum_net_paid_inc_tax, SUM(ws.ws_net_profit) AS sum_web_net_profit, COUNT(DISTINCT wr.wr_order_number) AS total_returns, SUM(wr.wr_return_amt) AS total_return_amount, AVG(wr.wr_fee) AS avg_return_fee FROM catalog_sales cs JOIN promotion p ON cs.cs_promo_sk = p.p_promo_sk JOIN customer_demographics cd ON cs.cs_bill_cdemo_sk = cd.cd_demo_sk JOIN web_sales ws ON cs.cs_order_number = ws.ws_order_number AND cs.cs_item_sk = ws.ws_item_sk LEFT JOIN web_returns wr ON ws.ws_order_number = wr.wr_order_number AND ws.ws_item_sk = wr.wr_item_sk WHERE cd.cd_credit_rating IN ('Good', 'Unknown') AND p.p_discount_active = 'N' AND cs.cs_net_paid_inc_tax NOT IN ('5209.58', '3100.79') AND NOT EXISTS ( SELECT 1 FROM reason r WHERE r.r_reason_sk = wr.wr_reason_sk AND r.r_reason_desc LIKE 'Wrong size' ) GROUP BY p.p_promo_name, cd.cd_gender, cd.cd_marital_status, cd.cd_education_status ORDER BY sum_net_paid_inc_tax DESC, total_orders DESC;
SELECT ca.ca_state AS customer_state, COUNT(DISTINCT cs.cs_order_number) AS total_orders, SUM(cs.cs_quantity) AS total_quantity_sold, AVG(cs.cs_sales_price) AS average_sale_price, SUM(cr.cr_return_quantity) AS total_quantity_returned, SUM(cr.cr_return_amount) AS total_return_amount, AVG(cr.cr_return_amount) AS average_return_amount, COUNT(DISTINCT p.p_promo_sk) AS total_promotions_used, COUNT(DISTINCT w.w_warehouse_sk) AS total_warehouses_used FROM customer_address ca JOIN customer c ON ca.ca_address_sk = c.c_current_addr_sk JOIN catalog_sales cs ON c.c_customer_sk = cs.cs_bill_customer_sk JOIN catalog_returns cr ON cs.cs_order_number = cr.cr_order_number JOIN promotion p ON cs.cs_promo_sk = p.p_promo_sk JOIN warehouse w ON cs.cs_warehouse_sk = w.w_warehouse_sk WHERE ca.ca_state IS NOT NULL AND p.p_channel_radio = 'N' AND (p.p_promo_name LIKE '%bar%' OR p.p_promo_name LIKE '%anti%') AND w.w_warehouse_id IN ('AAAAAAAABAAAAAAA', 'AAAAAAAADAAAAAAA', 'AAAAAAAAEAAAAAAA', 'AAAAAAAAFAAAAAAA', 'AAAAAAAACAAAAAAA') AND cs.cs_catalog_page_sk IN ( SELECT cp_catalog_page_sk FROM catalog_page WHERE cp_catalog_page_number IN (29, 24, 40) ) GROUP BY ca.ca_state ORDER BY total_return_amount DESC, average_sale_price DESC LIMIT 100;
