SELECT s.s_store_name, SUM(ss.ss_quantity) AS total_quantity_sold, AVG(ss.ss_sales_price) AS average_sales_price, SUM(ss.ss_net_profit) AS total_store_profit, w.w_warehouse_name, sm.sm_type, COUNT(DISTINCT ws.ws_order_number) AS total_web_orders, SUM(ws.ws_net_profit) AS total_web_profit, SUM(wr.wr_return_quantity) AS total_return_quantity, SUM(wr.wr_net_loss) AS total_return_loss FROM store s LEFT JOIN store_sales ss ON s.s_store_sk = ss.ss_store_sk LEFT JOIN web_sales ws ON ws.ws_item_sk = ss.ss_item_sk LEFT JOIN web_returns wr ON ws.ws_item_sk = wr.wr_item_sk AND ws.ws_order_number = wr.wr_order_number LEFT JOIN warehouse w ON ws.ws_warehouse_sk = w.w_warehouse_sk LEFT JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk WHERE s.s_market_desc IN ('Little expectations include yet forward meetings.', 'Mysterious employe', 'Events develop i', 'Architects coul') AND w.w_warehouse_id IN ('AAAAAAAADAAAAAAA', 'AAAAAAAACAAAAAAA', 'AAAAAAAAEAAAAAAA', 'AAAAAAAAFAAAAAAA') GROUP BY s.s_store_name, w.w_warehouse_name, sm.sm_type ORDER BY total_quantity_sold DESC, total_web_profit DESC, total_return_loss ASC;
SELECT ca.ca_state, COUNT(DISTINCT ca.ca_address_sk) AS num_customers, AVG(inv.inv_quantity_on_hand) AS avg_inventory_quantity, t.t_shift, COUNT(DISTINCT inv.inv_warehouse_sk) AS num_warehouses FROM customer_address ca JOIN inventory inv ON ca.ca_address_sk = inv.inv_warehouse_sk JOIN time_dim t ON inv.inv_date_sk = t.t_time_sk WHERE t.t_shift IN ('Morning', 'Afternoon', 'Evening') GROUP BY ca.ca_state, t.t_shift ORDER BY ca.ca_state, t.t_shift;
SELECT i.i_category, sm.sm_type, w.w_state, SUM(ws.ws_sales_price) AS total_sales, AVG(ws.ws_sales_price) AS avg_sales_price, COUNT(DISTINCT ws.ws_order_number) AS total_orders, SUM(sr.sr_return_amt) AS total_returns, AVG(sr.sr_return_amt) AS avg_return_amt, COUNT(DISTINCT sr.sr_ticket_number) AS total_return_tickets FROM web_sales ws JOIN item i ON ws.ws_item_sk = i.i_item_sk JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk JOIN warehouse w ON ws.ws_warehouse_sk = w.w_warehouse_sk LEFT JOIN store_returns sr ON ws.ws_item_sk = sr.sr_item_sk WHERE sm.sm_code IN ('SEA', 'BIKE', 'AIR', 'SURFACE') AND i.i_class IN ('loose stones', 'swimwear', 'semi-precious', 'maternity', 'camping') AND i.i_manager_id IN ('92', '83') AND w.w_street_name LIKE '%6th%' GROUP BY i.i_category, sm.sm_type, w.w_state ORDER BY total_sales DESC, total_returns DESC;
SELECT s.s_store_name, s.s_company_name, COUNT(DISTINCT wr.wr_order_number) AS total_returns, SUM(wr.wr_return_amt) AS total_return_amount, AVG(wr.wr_return_quantity) AS average_return_quantity, SUM(wr.wr_return_amt_inc_tax) AS total_return_amount_incl_tax, SUM(wr.wr_fee) AS total_fees, SUM(wr.wr_net_loss) AS total_net_loss, cd.cd_education_status, AVG(cd.cd_purchase_estimate) AS average_purchase_estimate, COUNT(DISTINCT wp.wp_web_page_sk) AS total_web_pages_involved, td.t_shift, SUM(CASE WHEN td.t_am_pm = 'PM' THEN 1 ELSE 0 END) AS returns_in_pm, SUM(CASE WHEN td.t_am_pm = 'AM' THEN 1 ELSE 0 END) AS returns_in_am FROM store s JOIN web_returns wr ON s.s_store_sk = wr.wr_returning_addr_sk JOIN customer_demographics cd ON wr.wr_returning_cdemo_sk = cd.cd_demo_sk JOIN web_page wp ON wr.wr_web_page_sk = wp.wp_web_page_sk JOIN time_dim td ON wr.wr_returned_time_sk = td.t_time_sk WHERE s.s_tax_precentage BETWEEN 0.06 AND 0.08 AND s.s_company_name <> 'Unknown' AND wp.wp_type = 'feedback' AND wp.wp_rec_start_date > '1999-09-04' AND td.t_minute IN (50, 18) GROUP BY s.s_store_name, s.s_company_name, cd.cd_education_status, td.t_shift ORDER BY total_returns DESC, total_return_amount DESC;
SELECT w.w_city AS warehouse_city, i.i_manufact AS item_manufacturer, i.i_brand AS item_brand, i.i_category AS item_category, COUNT(DISTINCT i.i_item_sk) AS item_count, AVG(i.i_current_price) AS avg_price, SUM(inv.inv_quantity_on_hand) AS total_quantity, AVG(ca.ca_gmt_offset) AS avg_gmt_offset, cd.cd_education_status AS customer_education_status, COUNT(DISTINCT ca.ca_address_sk) AS customer_address_count FROM inventory inv JOIN item i ON inv.inv_item_sk = i.i_item_sk JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk JOIN customer_address ca ON w.w_state = ca.ca_state JOIN customer_demographics cd ON ca.ca_zip = cd.cd_purchase_estimate::character varying WHERE w.w_city = 'Fairview' AND i.i_manufact = 'ableeseeing' AND i.i_brand = 'edu packbrand #7' AND inv.inv_date_sk BETWEEN 100 AND 200 AND ca.ca_county LIKE 'Fairview%' GROUP BY w.w_city, i.i_manufact, i.i_brand, i.i_category, cd.cd_education_status ORDER BY w.w_city, i.i_manufact, i.i_brand, i.i_category, cd.cd_education_status;
SELECT s_state, EXTRACT(YEAR FROM s_rec_start_date) AS year_opened, COUNT(*) AS store_count, SUM(ss_net_profit) AS total_net_profit, AVG(hd_dep_count) AS avg_dependency_count, SUM(sr_return_amt) AS total_return_amount, AVG(sr_return_amt) AS avg_return_amount, SUM(sr_net_loss) AS total_net_loss FROM store JOIN store_sales ON s_store_sk = ss_store_sk JOIN household_demographics ON ss_hdemo_sk = hd_demo_sk JOIN store_returns ON s_store_sk = sr_store_sk WHERE s_state IN ('CA', 'TX', 'FL') AND s_closed_date_sk IS NULL AND ss_sold_date_sk BETWEEN 2451189 AND 2451489 AND sr_return_tax > 0 AND hd_buy_potential IN ('>10000', '5001-10000', '1001-5000') GROUP BY s_state, year_opened ORDER BY total_net_profit DESC, total_return_amount DESC;
SELECT st.s_store_name, st.s_store_id, SUM(ws.ws_net_paid) AS total_net_sales, AVG(ws.ws_sales_price) AS avg_sales_price, COUNT(wr.wr_order_number) AS total_returns, AVG(wr.wr_return_amt) AS avg_return_amount, ARRAY_AGG(DISTINCT re.r_reason_desc) AS reasons_for_returns FROM store st LEFT JOIN web_sales ws ON st.s_store_sk = ws.ws_warehouse_sk LEFT JOIN web_returns wr ON ws.ws_order_number = wr.wr_order_number LEFT JOIN reason re ON wr.wr_reason_sk = re.r_reason_sk WHERE st.s_division_id = 1 AND st.s_tax_precentage BETWEEN 0.01 AND 0.06 GROUP BY st.s_store_name, st.s_store_id ORDER BY total_net_sales DESC, avg_sales_price DESC, total_returns DESC, avg_return_amount DESC;
SELECT hd.hd_income_band_sk, COUNT(DISTINCT cs.cs_order_number) AS total_orders, SUM(cs.cs_quantity) AS total_quantity_sold, AVG(cs.cs_sales_price) AS average_sales_price, SUM(cs.cs_net_profit) AS total_net_profit, SUM(sr.sr_return_quantity) AS total_quantity_returned, SUM(sr.sr_return_amt) AS total_return_amount, AVG(sr.sr_fee) AS average_return_fee, SUM(sr.sr_net_loss) AS total_net_loss, (SUM(cs.cs_net_profit) - SUM(sr.sr_net_loss)) AS net_gain_loss FROM household_demographics hd LEFT JOIN catalog_sales cs ON hd.hd_demo_sk = cs.cs_bill_hdemo_sk OR hd.hd_demo_sk = cs.cs_ship_hdemo_sk LEFT JOIN store_returns sr ON hd.hd_demo_sk = sr.sr_hdemo_sk LEFT JOIN time_dim td ON cs.cs_sold_time_sk = td.t_time_sk OR sr.sr_return_time_sk = td.t_time_sk WHERE (cs.cs_ship_cdemo_sk IN ('512236', '76858', '1078452', '1665528', '234732', '598521') OR cs.cs_ext_ship_cost IN ('4483.57', '946.40', '622.83', '8.12', '342.58', '889.92')) AND (td.t_time_id IN ('AAAAAAAAAKIAAAAA', 'AAAAAAAAHKMAAAAA', 'AAAAAAAAEJNAAAAA', 'AAAAAAAADIOAAAAA', 'AAAAAAAAKMOAAAAA') OR td.t_minute IN ('17', '18', '57', '25')) GROUP BY hd.hd_income_band_sk ORDER BY total_net_profit DESC, total_orders DESC;
SELECT sm.sm_ship_mode_id, sm.sm_type, cc.cc_name, cc.cc_city, SUM(cs.cs_quantity) AS total_quantity_sold, SUM(cs.cs_net_paid) AS total_sales, AVG(cs.cs_sales_price) AS average_sales_price, COUNT(DISTINCT cs.cs_order_number) AS total_orders FROM catalog_sales cs JOIN ship_mode sm ON cs.cs_ship_mode_sk = sm.sm_ship_mode_sk JOIN call_center cc ON cs.cs_call_center_sk = cc.cc_call_center_sk GROUP BY sm.sm_ship_mode_id, sm.sm_type, cc.cc_name, cc.cc_city ORDER BY total_sales DESC, sm.sm_ship_mode_id, cc.cc_name;
SELECT s.s_division_name, AVG(s.s_floor_space) AS avg_floor_space, AVG(s.s_number_employees) AS avg_number_employees, AVG(ib.ib_upper_bound) AS avg_income_upper_bound, COUNT(wp.wp_web_page_sk) AS web_page_count, SUM(wp.wp_image_count) AS total_image_count, SUM(wp.wp_link_count) AS total_link_count FROM store AS s INNER JOIN income_band AS ib ON s.s_store_sk = ib.ib_income_band_sk LEFT JOIN web_page AS wp ON wp.wp_customer_sk = s.s_store_sk WHERE s.s_rec_start_date >= '2020-01-01' AND (s.s_rec_end_date IS NULL OR s.s_rec_end_date <= '2023-01-01') AND ib.ib_upper_bound BETWEEN 60000 AND 190000 AND wp.wp_type = 'monthly' GROUP BY s.s_division_name ORDER BY avg_floor_space DESC, avg_number_employees DESC;
SELECT ws.web_name, ws.web_class, ws.web_manager, ws.web_market_manager, COUNT(DISTINCT wp.wp_web_page_sk) AS total_pages, AVG(wp.wp_char_count) AS avg_char_count, SUM(wp.wp_link_count) AS total_link_count, SUM(wp.wp_image_count) AS total_image_count, COUNT(DISTINCT wr.wr_order_number) AS total_returns, SUM(wr.wr_return_amt) AS total_return_amount, AVG(wr.wr_fee) AS avg_return_fee, COUNT(DISTINCT c.c_customer_sk) AS unique_customers, SUM(CASE WHEN c.c_preferred_cust_flag = 'Y' THEN 1 ELSE 0 END) AS preferred_customer_count FROM web_site ws LEFT JOIN web_page wp ON ws.web_site_sk = wp.wp_customer_sk LEFT JOIN web_returns wr ON wp.wp_web_page_sk = wr.wr_web_page_sk LEFT JOIN customer c ON wr.wr_returning_customer_sk = c.c_customer_sk GROUP BY ws.web_name, ws.web_class, ws.web_manager, ws.web_market_manager ORDER BY total_return_amount DESC, total_pages DESC LIMIT 100;
SELECT i_category, i_brand, EXTRACT(YEAR FROM i_rec_start_date) AS year_started, COUNT(DISTINCT cs_order_number) AS total_orders, SUM(cs_quantity) AS total_quantity_sold, AVG(cs_sales_price) AS average_sales_price, SUM(cs_net_paid) AS total_net_paid, SUM(cs_net_profit) AS total_net_profit, SUM(cs_coupon_amt) AS total_coupon_amount, AVG(cs_net_paid_inc_ship_tax) AS average_net_paid_including_shipping_and_tax FROM item JOIN catalog_sales ON i_item_sk = cs_item_sk WHERE cs_net_paid > 10000 GROUP BY i_category, i_brand, year_started ORDER BY total_net_paid DESC, i_category, i_brand;
