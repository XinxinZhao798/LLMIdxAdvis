SELECT sm.sm_type AS shipping_type, COUNT(DISTINCT cs.cs_order_number) AS total_orders, SUM(cs.cs_quantity) AS total_quantity, AVG(cs.cs_sales_price) AS avg_sales_price, SUM(cs.cs_net_paid) AS total_net_paid, SUM(cs.cs_net_profit) AS total_net_profit, COUNT(DISTINCT p.p_promo_sk) AS distinct_promotions_used, SUM(CASE WHEN t.t_am_pm = 'AM' THEN cs.cs_quantity ELSE 0 END) AS total_quantity_am, SUM(CASE WHEN t.t_am_pm = 'PM' THEN cs.cs_quantity ELSE 0 END) AS total_quantity_pm FROM catalog_sales cs JOIN time_dim t ON cs.cs_sold_time_sk = t.t_time_sk JOIN ship_mode sm ON cs.cs_ship_mode_sk = sm.sm_ship_mode_sk JOIN promotion p ON cs.cs_promo_sk = p.p_promo_sk WHERE cs.cs_sold_date_sk IS NOT NULL AND cs.cs_ship_date_sk IS NOT NULL AND sm.sm_contract IN ('uukTktPYycct8', 'GNJr3g5i7oorKqtX', 'hGoF18SLDDPBj', 'Ek', 'YvxVaJI10') AND p.p_cost = 1000.00 AND p.p_channel_catalog = 'N' GROUP BY sm.sm_type ORDER BY total_net_paid DESC;
SELECT ca.ca_state AS state, i.d_year AS fiscal_year, COUNT(DISTINCT ss.ss_store_sk) AS num_stores, COUNT(DISTINCT ss.ss_item_sk) AS num_products_sold, SUM(ss.ss_quantity) AS total_quantity_sold, SUM(ss.ss_net_paid) AS total_sales, COUNT(DISTINCT sr.sr_store_sk) AS num_stores_with_returns, COUNT(DISTINCT sr.sr_item_sk) AS num_returned_products, SUM(sr.sr_return_quantity) AS total_quantity_returned, SUM(sr.sr_return_amt) AS total_returns, COUNT(DISTINCT cr.cr_call_center_sk) AS num_call_centers_with_returns, COUNT(DISTINCT cr.cr_item_sk) AS num_catalog_returned_products, SUM(cr.cr_return_quantity) AS total_catalog_quantity_returned, SUM(cr.cr_return_amount) AS total_catalog_returns FROM store_sales ss JOIN date_dim i ON ss.ss_sold_date_sk = i.d_date_sk JOIN customer_address ca ON ss.ss_addr_sk = ca.ca_address_sk LEFT JOIN store_returns sr ON ss.ss_ticket_number = sr.sr_ticket_number LEFT JOIN catalog_returns cr ON cr.cr_order_number = ss.ss_ticket_number WHERE i.d_fy_year = 2001 GROUP BY ca.ca_state, i.d_year ORDER BY ca.ca_state, i.d_year;
SELECT cc.cc_state, SUM(ss.ss_net_paid) AS total_net_sales, AVG(ss.ss_sales_price) AS average_sales_price, COUNT(DISTINCT cc.cc_call_center_sk) AS number_of_call_centers, SUM(cc.cc_employees) AS total_employees FROM call_center cc JOIN store_sales ss ON cc.cc_call_center_sk = ss.ss_store_sk WHERE cc.cc_rec_start_date <= CURRENT_DATE AND (cc.cc_rec_end_date IS NULL OR cc.cc_rec_end_date > CURRENT_DATE) AND ss.ss_sold_date_sk BETWEEN cc.cc_open_date_sk AND COALESCE(cc.cc_closed_date_sk, ss.ss_sold_date_sk) GROUP BY cc.cc_state ORDER BY total_net_sales DESC, average_sales_price DESC;
SELECT d_year, i_category, s_store_name, s_state, COUNT(DISTINCT c_customer_sk) AS customer_count, SUM(i_current_price) AS total_sales, AVG(i_wholesale_cost) AS average_wholesale_cost, MAX(i_current_price) AS max_item_price, MIN(i_current_price) AS min_item_price FROM customer c JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk JOIN item i ON i.i_item_sk = c.c_customer_sk JOIN store s ON s.s_store_sk = c.c_current_addr_sk JOIN date_dim d ON c.c_first_sales_date_sk = d.d_date_sk WHERE i.i_item_sk IN (2285) AND c.c_customer_id IN ('AAAAAAAAHJNAAAAA', 'AAAAAAAAMADFAAAA', 'AAAAAAAAKCPAAAAA', 'AAAAAAAALGEAAAAA') AND s.s_market_desc IN ('Mysterious employe', 'Events develop i') AND s.s_hours = '8AM-12AM' AND d.d_year = 2021 GROUP BY d_year, i_category, s_store_name, s_state ORDER BY total_sales DESC, customer_count DESC;
SELECT ca.ca_country, COUNT(DISTINCT cp.cp_catalog_page_sk) AS total_catalog_pages, COUNT(DISTINCT p.p_promo_sk) AS total_promotions, SUM(p.p_cost) AS total_promotion_cost, AVG(p.p_response_target) AS average_promotion_response_target, SUM(sr.sr_return_amt_inc_tax) AS total_returns_inc_tax, AVG(sr.sr_return_amt_inc_tax) AS average_return_inc_tax, SUM(sr.sr_net_loss) AS total_net_loss, COUNT(DISTINCT sr.sr_returned_date_sk) AS days_with_returns FROM promotion p JOIN catalog_page cp ON cp.cp_start_date_sk <= p.p_end_date_sk AND cp.cp_end_date_sk >= p.p_start_date_sk JOIN store_returns sr ON sr.sr_reason_sk = p.p_promo_sk JOIN customer_address ca ON sr.sr_addr_sk = ca.ca_address_sk WHERE ca.ca_country = 'United States' AND p.p_end_date_sk IN ('2450816', '2450904', '2450773') AND p.p_purpose <> 'Unknown' AND cp.cp_end_date_sk IN ('2450964', '2451419', '2451664') GROUP BY ca.ca_country ORDER BY total_returns_inc_tax DESC;
SELECT sm.sm_type AS shipping_type, w.w_city AS warehouse_city, r.r_reason_desc AS return_reason, COUNT(*) AS total_returns, SUM(cr.cr_return_quantity) AS total_returned_quantity, AVG(cr.cr_return_amount) AS average_return_amount, SUM(cr.cr_return_amt_inc_tax) AS total_return_amount_inc_tax, AVG(cr.cr_fee) AS average_fee, SUM(cr.cr_net_loss) AS total_net_loss FROM catalog_returns cr JOIN reason r ON cr.cr_reason_sk = r.r_reason_sk JOIN ship_mode sm ON cr.cr_ship_mode_sk = sm.sm_ship_mode_sk JOIN warehouse w ON cr.cr_warehouse_sk = w.w_warehouse_sk GROUP BY shipping_type, warehouse_city, return_reason ORDER BY total_returns DESC, total_returned_quantity DESC;
SELECT s_state, COUNT(DISTINCT ss_customer_sk) as total_customers, SUM(ss_quantity) as total_quantity_sold, AVG(ss_sales_price) as average_sales_price, SUM(ss_net_profit) as total_net_profit, SUM(cr_return_amount) as total_return_amount, AVG(hd_dep_count) as average_dependent_count FROM store_sales JOIN store ON ss_store_sk = s_store_sk JOIN catalog_returns ON ss_item_sk = cr_item_sk AND ss_ticket_number = cr_order_number JOIN household_demographics ON ss_hdemo_sk = hd_demo_sk GROUP BY s_state ORDER BY total_net_profit DESC LIMIT 10;
SELECT i.i_category AS item_category, s.s_division_name AS store_division, AVG(i.i_current_price) AS avg_current_price, AVG(i.i_wholesale_cost) AS avg_wholesale_cost, COUNT(DISTINCT cp.cp_catalog_page_sk) AS num_catalog_pages FROM item i JOIN store s ON i.i_manufact_id = s.s_store_sk LEFT JOIN catalog_page cp ON cp.cp_department = s.s_division_name GROUP BY item_category, store_division ORDER BY item_category, store_division;
SELECT ca.ca_state AS State, AVG(hd.hd_income_band_sk) AS Avg_Income_Band, AVG(hd.hd_dep_count) AS Avg_Dependent_Count, AVG(hd.hd_vehicle_count) AS Avg_Vehicle_Count, COUNT(*) FILTER (WHERE hd.hd_buy_potential = 'High') AS High_Buying_Potential_Count, COUNT(*) FILTER (WHERE hd.hd_buy_potential = 'Medium') AS Medium_Buying_Potential_Count, COUNT(*) FILTER (WHERE hd.hd_buy_potential = 'Low') AS Low_Buying_Potential_Count, COUNT(DISTINCT ca.ca_address_sk) AS Address_Count, AVG(ws.web_tax_percentage) AS Avg_Web_Tax_Percentage FROM customer_address ca JOIN household_demographics hd ON ca.ca_address_sk = hd.hd_demo_sk JOIN web_site ws ON ca.ca_state = ws.web_state WHERE ca.ca_country = 'United States' AND ws.web_country = 'United States' AND ca.ca_state IS NOT NULL AND ws.web_tax_percentage IS NOT NULL GROUP BY ca.ca_state ORDER BY Avg_Income_Band DESC, High_Buying_Potential_Count DESC, Medium_Buying_Potential_Count DESC, Low_Buying_Potential_Count DESC;
SELECT ws.web_site_id, ws.web_name, c.c_birth_country, SUM(wsl.ws_sales_price) AS total_sales, AVG(wsl.ws_sales_price) AS average_sales, COUNT(DISTINCT wsl.ws_order_number) AS total_orders, COUNT(DISTINCT wsl.ws_item_sk) AS total_items_sold, s.s_store_name, s.s_market_manager FROM web_sales wsl JOIN web_site ws ON wsl.ws_web_site_sk = ws.web_site_sk JOIN customer c ON wsl.ws_bill_customer_sk = c.c_customer_sk JOIN store s ON s.s_market_id = ws.web_mkt_id WHERE (s.s_store_name LIKE '%ought%' OR s.s_store_name LIKE '%ation%' OR s.s_store_name LIKE '%anti%') AND s.s_market_manager = 'Charles Bartley' AND ws.web_suite_number IN ('Suite 150', 'Suite 260', 'Suite 350', 'Suite 450', 'Suite 280', 'Suite 470') AND c.c_first_sales_date_sk = '2451321' GROUP BY ws.web_site_id, ws.web_name, c.c_birth_country, s.s_store_name, s.s_market_manager ORDER BY total_sales DESC, average_sales DESC;
