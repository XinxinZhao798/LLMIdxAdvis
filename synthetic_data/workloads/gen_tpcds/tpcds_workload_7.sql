SELECT site.web_name AS website_name, COUNT(DISTINCT ss.ss_ticket_number) AS store_sales_transactions, COUNT(DISTINCT ws.ws_order_number) AS web_sales_transactions, SUM(ss.ss_net_paid_inc_tax) AS total_store_sales, SUM(ws.ws_net_paid_inc_ship_tax) AS total_web_sales, AVG(ss.ss_quantity) AS avg_store_quantity_sold, AVG(ws.ws_quantity) AS avg_web_quantity_sold, cp.cp_department AS department, SUM(CASE WHEN ss.ss_hdemo_sk IN (1437, 496, 6460, 2527, 4508, 4026) THEN ss.ss_net_profit ELSE 0 END) AS store_profit_from_selected_hdemo, SUM(CASE WHEN ws.ws_web_site_sk IN (SELECT web_site_sk FROM web_site WHERE web_company_id IN (3, 5, 2)) THEN ws.ws_net_profit ELSE 0 END) AS web_profit_from_selected_companies FROM store_sales ss FULL OUTER JOIN web_sales ws ON ss.ss_item_sk = ws.ws_item_sk AND ss.ss_sold_date_sk = ws.ws_sold_date_sk LEFT JOIN catalog_page cp ON ws.ws_web_page_sk = cp.cp_catalog_page_sk LEFT JOIN web_site site ON ws.ws_web_site_sk = site.web_site_sk WHERE (cp.cp_catalog_page_sk IN (10, 2795, 1844, 4860) OR cp.cp_catalog_page_sk IS NULL) GROUP BY site.web_name, cp.cp_department ORDER BY total_store_sales DESC, total_web_sales DESC;
SELECT i_category, i_brand, EXTRACT(YEAR FROM i_rec_start_date) AS year_started, COUNT(DISTINCT cs_order_number) AS total_orders, SUM(cs_quantity) AS total_quantity_sold, AVG(cs_sales_price) AS average_sales_price, SUM(cs_net_paid) AS total_net_paid, SUM(cs_net_profit) AS total_net_profit, SUM(cs_coupon_amt) AS total_coupon_amount, AVG(cs_net_paid_inc_ship_tax) AS average_net_paid_including_shipping_and_tax FROM item JOIN catalog_sales ON i_item_sk = cs_item_sk WHERE cs_net_paid > 10000 GROUP BY i_category, i_brand, year_started ORDER BY total_net_paid DESC, i_category, i_brand;
SELECT ws.ws_web_site_sk, ws_item_sk, web_country, SUM(ws_sales_price) AS total_sales_price, AVG(ws_sales_price) AS avg_sales_price, COUNT(ws_order_number) AS total_orders, SUM(ws_quantity) AS total_quantity_sold, SUM(ws_net_profit) AS total_net_profit, SUM(wr_return_quantity) AS total_return_quantity, SUM(wr_return_amt) AS total_return_amount, AVG(wr_fee) AS avg_return_fee, COUNT(DISTINCT wr_order_number) AS total_returned_orders FROM web_sales ws JOIN web_site wsite ON ws.ws_web_site_sk = wsite.web_site_sk LEFT JOIN web_returns wr ON ws.ws_order_number = wr.wr_order_number AND ws.ws_item_sk = wr.wr_item_sk WHERE wsite.web_country = 'United States' AND ws.ws_net_paid BETWEEN 141.68 AND 2100.98 AND ws.ws_warehouse_sk = 3 GROUP BY ws.ws_web_site_sk, ws_item_sk, web_country ORDER BY total_net_profit DESC, total_sales_price DESC;
SELECT c.c_first_name, c.c_last_name, sum(ss.ss_quantity) as total_items_sold, avg(ss.ss_sales_price) as average_sales_price, sum(ss.ss_net_paid) as total_revenue, sum(ss.ss_net_profit) as total_profit, p.p_promo_name, count(DISTINCT ss.ss_ticket_number) as number_of_sales_transactions FROM store_sales ss JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk JOIN promotion p ON ss.ss_promo_sk = p.p_promo_sk JOIN inventory i ON ss.ss_item_sk = i.inv_item_sk AND i.inv_date_sk = ss.ss_sold_date_sk WHERE c.c_last_name IN ('Waggoner', 'Hoyt', 'Moffitt', 'Buchanan', 'Orourke') AND i.inv_warehouse_sk IN ('1', '2') AND p.p_channel_catalog = 'N' AND ss.ss_promo_sk IN ('11', '103', '131', '133', '275') GROUP BY c.c_first_name, c.c_last_name, p.p_promo_name ORDER BY total_revenue DESC, c.c_last_name, c.c_first_name;
SELECT t_hour, COUNT(DISTINCT ws_order_number) AS number_of_transactions, SUM(ws_net_paid) AS total_sales_amount, AVG(ws_ext_discount_amt) AS average_discount_amount FROM web_sales ws JOIN time_dim td ON ws.ws_sold_time_sk = td.t_time_sk LEFT JOIN promotion p ON ws.ws_promo_sk = p.p_promo_sk WHERE td.t_am_pm = 'AM' AND (p.p_purpose IS NULL OR p.p_purpose <> 'Unknown') GROUP BY t_hour ORDER BY t_hour;
SELECT dd.d_year, ca.ca_state, SUM(cs.cs_quantity) AS total_quantity, AVG(cs.cs_sales_price) AS average_sales_price, COUNT(DISTINCT cs.cs_order_number) AS order_count, SUM(cs.cs_net_paid_inc_tax) AS total_revenue_inc_tax, SUM(cs.cs_net_profit) AS total_profit FROM catalog_sales cs JOIN date_dim dd ON cs.cs_sold_date_sk = dd.d_date_sk JOIN customer_address ca ON cs.cs_bill_addr_sk = ca.ca_address_sk JOIN store s ON ca.ca_state = s.s_state JOIN warehouse w ON cs.cs_warehouse_sk = w.w_warehouse_sk WHERE dd.d_fy_year = 1912 GROUP BY dd.d_year, ca.ca_state ORDER BY total_revenue_inc_tax DESC, ca.ca_state;
SELECT ib.ib_income_band_sk, ib.ib_lower_bound, ib.ib_upper_bound, AVG(sr.sr_return_amt) AS avg_return_amount, AVG(sr.sr_return_quantity) AS avg_return_quantity, COUNT(sr.sr_ticket_number) AS total_returns FROM income_band ib JOIN store_returns sr ON sr.sr_cdemo_sk = ib.ib_income_band_sk JOIN inventory i ON sr.sr_item_sk = i.inv_item_sk GROUP BY ib.ib_income_band_sk, ib.ib_lower_bound, ib.ib_upper_bound ORDER BY ib.ib_income_band_sk;
SELECT ca.ca_city, sm.sm_type AS shipping_type, COUNT(DISTINCT ws.ws_order_number) AS total_web_orders, SUM(ws.ws_quantity) AS total_web_quantity_sold, AVG(ws.ws_sales_price) AS average_web_sales_price, SUM(ws.ws_net_profit) AS total_web_net_profit, COUNT(DISTINCT cs.cs_order_number) AS total_catalog_orders, SUM(cs.cs_quantity) AS total_catalog_quantity_sold, AVG(cs.cs_sales_price) AS average_catalog_sales_price, SUM(cs.cs_net_profit) AS total_catalog_net_profit, COUNT(DISTINCT sr.sr_ticket_number) AS total_store_returns, SUM(sr.sr_return_quantity) AS total_returned_quantity, AVG(sr.sr_return_amt) AS average_return_amount, SUM(sr.sr_net_loss) AS total_net_loss FROM customer_address ca LEFT JOIN web_sales ws ON ca.ca_address_sk = ws.ws_bill_addr_sk LEFT JOIN catalog_sales cs ON ca.ca_address_sk = cs.cs_bill_addr_sk LEFT JOIN store_returns sr ON ca.ca_address_sk = sr.sr_addr_sk LEFT JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk WHERE ca.ca_city IN ('Ruth', 'Tabor', 'Altamont', 'Morgantown', 'Hartland', 'Richville') AND (ws.ws_wholesale_cost IN (9.45, 10.23, 52.95, 12.11, 47.17) OR cs.cs_bill_customer_sk IN (79309, 53472, 7567, 9353, 49484) OR sr.sr_returned_date_sk IN (2452085, 2451229)) GROUP BY ca.ca_city, sm.sm_type ORDER BY ca.ca_city, shipping_type;
SELECT ca.ca_county, ca.ca_state, w.w_warehouse_name, hd.hd_income_band_sk, SUM(inv.inv_quantity_on_hand) AS total_quantity_on_hand, AVG(hd.hd_dep_count) AS average_dependency_count, AVG(hd.hd_vehicle_count) AS average_vehicle_count, COUNT(DISTINCT ca.ca_address_sk) AS total_addresses, COUNT(DISTINCT hd.hd_demo_sk) AS total_households FROM inventory inv JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk JOIN customer_address ca ON ca.ca_state = w.w_state JOIN household_demographics hd ON ca.ca_zip = w.w_zip WHERE ca.ca_county = 'Jeff Davis County' AND (ca.ca_zip = '78482' OR ca.ca_zip = '48054') AND (inv.inv_warehouse_sk = 1 OR inv.inv_warehouse_sk = 2) AND (inv.inv_item_sk IN (7786, 9218, 15079, 13832, 11164)) GROUP BY ca.ca_county, ca.ca_state, w.w_warehouse_name, hd.hd_income_band_sk ORDER BY ca.ca_county, ca.ca_state, w.w_warehouse_name, hd.hd_income_band_sk;
SELECT c.c_first_name, c.c_last_name, ca.ca_state, w.w_warehouse_name, SUM(i.inv_quantity_on_hand) AS total_inventory, AVG(cc.cc_tax_percentage) AS average_tax_percentage, COUNT(DISTINCT cc.cc_call_center_sk) AS number_of_call_centers FROM customer c JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk JOIN inventory i ON ca.ca_address_sk = i.inv_warehouse_sk JOIN warehouse w ON i.inv_warehouse_sk = w.w_warehouse_sk JOIN call_center cc ON w.w_state = cc.cc_state WHERE ca.ca_state IN ('MA', 'FL') AND w.w_warehouse_id IN ('AAAAAAAADAAAAAAA', 'AAAAAAAAFAAAAAAA', 'AAAAAAAABAAAAAAA') AND cc.cc_tax_percentage IN (0.01, 0.05, 0.11, 0.12) GROUP BY c.c_first_name, c.c_last_name, ca.ca_state, w.w_warehouse_name ORDER BY total_inventory DESC, average_tax_percentage, number_of_call_centers DESC;
SELECT dd.d_year AS sale_year, dd.d_moy AS sale_month, dd.d_dom AS sale_day, COUNT(DISTINCT ss.ss_ticket_number) AS store_sales_count, SUM(ss.ss_quantity) AS store_items_sold, AVG(ss.ss_sales_price) AS avg_store_sale_price, SUM(cs.cs_net_paid_inc_tax) AS catalog_total_revenue_inc_tax, SUM(ws.ws_net_paid_inc_ship_tax) AS web_total_revenue_inc_ship_tax, AVG(cc.cc_employees) AS avg_call_center_employees, ws.ws_web_site_sk, web_site.web_name FROM store_sales ss JOIN date_dim dd ON ss.ss_sold_date_sk = dd.d_date_sk JOIN catalog_sales cs ON ss.ss_sold_date_sk = cs.cs_sold_date_sk JOIN web_sales ws ON ss.ss_sold_date_sk = ws.ws_sold_date_sk JOIN call_center cc ON cs.cs_call_center_sk = cc.cc_call_center_sk JOIN web_site ON ws.ws_web_site_sk = web_site.web_site_sk WHERE dd.d_year = 2000 AND ss.ss_list_price BETWEEN 100 AND 200 AND ws.ws_quantity IN (64, 84, 57) AND cc.cc_open_date_sk IS NOT NULL AND ws.ws_web_page_sk IN (211, 510, 171, 90, 132, 78) AND dd.d_last_dom IN ('2418669', '2418489', '2415993', '2419340', '2418000', '2417392') GROUP BY sale_year, sale_month, sale_day, ws.ws_web_site_sk, web_site.web_name ORDER BY sale_year, sale_month, sale_day, ws.ws_web_site_sk;
SELECT i.i_category, i.i_brand, COUNT(DISTINCT cs_order_number) AS total_orders, SUM(cs_quantity) AS total_quantity_sold, AVG(cs_sales_price) AS average_sales_price, SUM(cs_net_paid) AS total_net_paid, SUM(cs_net_profit) AS total_net_profit, AVG(hd_dep_count) AS average_dependency_count, AVG(hd_vehicle_count) AS average_vehicle_count FROM catalog_sales cs JOIN item i ON cs.cs_item_sk = i.i_item_sk JOIN household_demographics hd ON cs.cs_ship_hdemo_sk = hd.hd_demo_sk WHERE i.i_category = 'Men' AND (i.i_color = 'lawn' OR i.i_color = 'peach' OR i.i_color = 'red') AND cs.cs_catalog_page_sk IN (118, 44) AND hd.hd_demo_sk IN (714, 1213, 4049, 4231, 2781, 3780) GROUP BY i.i_category, i.i_brand ORDER BY total_net_profit DESC, total_orders DESC;
