SELECT ca_state, ca_country, AVG(wp_char_count) AS average_character_count, SUM(wp_link_count) AS total_link_count, COUNT(wp_web_page_sk) AS total_pages, AVG(ib_lower_bound) AS average_income_lower_bound, AVG(ib_upper_bound) AS average_income_upper_bound, COUNT(DISTINCT ib_income_band_sk) AS distinct_income_band_count FROM web_page JOIN customer_address ON wp_customer_sk = ca_address_sk JOIN income_band ON ca_address_id::integer = ib_income_band_sk WHERE wp_type = 'product' AND ca_country = 'United States' AND ib_lower_bound >= 70001 AND (ib_income_band_sk IN (3, 8, 1, 10, 13, 9) OR wp_autogen_flag = 'Y') GROUP BY ca_state, ca_country ORDER BY ca_state, ca_country;
SELECT c.c_first_name, c.c_last_name, c.c_birth_country, c.c_email_address, COUNT(sr.sr_return_quantity) AS total_returns, SUM(sr.sr_return_amt) AS total_return_amt, AVG(sr.sr_return_amt) AS avg_return_amt, SUM(sr.sr_fee) AS total_fees, SUM(sr.sr_return_ship_cost) AS total_ship_cost, SUM(sr.sr_net_loss) AS total_net_loss, ib.ib_lower_bound, ib.ib_upper_bound, sm.sm_carrier FROM customer c JOIN store_returns sr ON c.c_customer_sk = sr.sr_customer_sk JOIN income_band ib ON c.c_current_cdemo_sk = ib.ib_income_band_sk JOIN ship_mode sm ON sm.sm_ship_mode_id = 'AAAAAAAABBAAAAAA' WHERE c.c_preferred_cust_flag = 'Y' GROUP BY c.c_first_name, c.c_last_name, c.c_birth_country, c.c_email_address, ib.ib_lower_bound, ib.ib_upper_bound, sm.sm_carrier ORDER BY total_return_amt DESC;
SELECT sm.sm_type AS shipping_type, COUNT(DISTINCT c.c_customer_sk) AS number_of_customers, COUNT(DISTINCT wr.wr_order_number) AS total_returns, SUM(wr.wr_return_amt) AS total_return_amount, AVG(wr.wr_return_quantity) AS average_return_quantity, SUM(wr.wr_fee) AS total_return_fees, AVG(wr.wr_net_loss) AS average_net_loss, COUNT(DISTINCT cp.cp_catalog_page_sk) AS total_catalog_pages, AVG(hd.hd_vehicle_count) AS average_vehicle_count, SUM(CASE WHEN d.d_weekend = 'Y' THEN 1 ELSE 0 END) AS weekend_dates_count, SUM(CASE WHEN d.d_holiday = 'Y' THEN 1 ELSE 0 END) AS holiday_dates_count FROM ship_mode sm JOIN web_returns wr ON sm.sm_ship_mode_sk = wr.wr_returned_time_sk JOIN customer c ON wr.wr_returning_customer_sk = c.c_customer_sk JOIN catalog_page cp ON cp.cp_start_date_sk = wr.wr_returned_date_sk JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk JOIN date_dim d ON wr.wr_returned_date_sk = d.d_date_sk WHERE sm.sm_ship_mode_id IN ('AAAAAAAADBAAAAAA', 'AAAAAAAAMAAAAAAA', 'AAAAAAAAOAAAAAAA') AND sm.sm_type IN ('EXPRESS', 'NEXT DAY', 'OVERNIGHT') AND c.c_last_name IN ('Kyle', 'Reddy', 'Bishop') AND cp.cp_type IN ('quarterly', 'monthly', 'bi-annual') AND hd.hd_vehicle_count IN (3, 1, 0) AND hd.hd_buy_potential IN ('5001-10000', '>10000', 'Unknown') AND d.d_weekend IN ('N', 'Y') GROUP BY sm.sm_type;
SELECT d_year, d_quarter_name, cc_name, SUM(cs_quantity) AS total_quantity_sold, SUM(cs_net_paid) AS total_net_paid, AVG(cs_net_profit) AS average_net_profit, COUNT(DISTINCT cs_order_number) AS number_of_orders, SUM(ws_quantity) AS total_web_quantity_sold, SUM(ws_net_paid) AS total_web_net_paid, AVG(ws_net_profit) AS average_web_net_profit, COUNT(DISTINCT ws_order_number) AS number_of_web_orders, SUM(cr_return_quantity) AS total_return_quantity, SUM(cr_return_amount) AS total_return_amount, AVG(cr_net_loss) AS average_net_loss, COUNT(DISTINCT cr_order_number) AS number_of_returns FROM date_dim JOIN catalog_sales ON cs_sold_date_sk = d_date_sk JOIN web_sales ON ws_sold_date_sk = d_date_sk JOIN catalog_returns ON cr_returned_date_sk = d_date_sk JOIN call_center ON cs_call_center_sk = cc_call_center_sk WHERE d_fy_year IN ('1910', '1903', '1905', '1900') AND (cs_net_paid_inc_ship_tax IN ('289.42', '1479.37') OR ws_net_paid_inc_ship_tax IN ('3079.90', '243.98', '3911.52')) GROUP BY d_year, d_quarter_name, cc_name ORDER BY d_year, d_quarter_name, cc_name;
SELECT ws.web_name, d.d_year, d.d_quarter_name, i.i_category, SUM(cs_quantity) AS total_quantity_sold, SUM(cs_ext_sales_price) AS total_sales, AVG(cs_sales_price) AS avg_sales_price, COUNT(DISTINCT cs_order_number) AS total_orders, SUM(wr_return_quantity) AS total_returned_quantity, SUM(wr_return_amt) AS total_return_amount, (SUM(cs_ext_sales_price) - SUM(cs_ext_discount_amt)) AS net_sales_after_discounts, (SUM(cs_ext_sales_price) - SUM(wr_return_amt)) AS net_sales_after_returns FROM web_site ws JOIN catalog_sales cs ON ws.web_site_sk = cs.cs_warehouse_sk JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk JOIN item i ON cs.cs_item_sk = i.i_item_sk LEFT JOIN web_returns wr ON cs.cs_order_number = wr.wr_order_number AND cs.cs_item_sk = wr.wr_item_sk WHERE d.d_year = 2001 AND ws.web_zip IN ('35709', '31904') AND i.i_units IN ('Gross', 'Oz') AND d.d_current_day = 'N' GROUP BY ws.web_name, d.d_year, d.d_quarter_name, i.i_category ORDER BY total_sales DESC, net_sales_after_discounts DESC, net_sales_after_returns DESC;
SELECT cc_state, COUNT(cc_call_center_sk) AS total_call_centers, AVG(cc_employees) AS avg_employees, SUM(cc_sq_ft) AS total_sq_ft, COUNT(DISTINCT p_promo_sk) AS total_promotions, AVG(p_cost) AS avg_promotion_cost, AVG(hd_income_band_sk) AS avg_income_band, AVG(hd_vehicle_count) AS avg_vehicle_count, AVG(cc_tax_percentage) AS avg_tax_percentage, SUM(CASE WHEN p_channel_email = '1' THEN 1 ELSE 0 END) AS total_email_promotions, SUM(CASE WHEN p_channel_tv = '1' THEN 1 ELSE 0 END) AS total_tv_promotions, SUM(CASE WHEN p_channel_radio = '1' THEN 1 ELSE 0 END) AS total_radio_promotions FROM call_center LEFT JOIN promotion ON cc_mkt_id = p_promo_sk LEFT JOIN customer_address ON cc_county = ca_county LEFT JOIN household_demographics ON ca_address_sk = hd_demo_sk WHERE cc_rec_start_date <= CURRENT_DATE AND (cc_rec_end_date IS NULL OR cc_rec_end_date > CURRENT_DATE) AND ca_county IN ('Cowlitz County', 'Bay County', 'Loudon County', 'Santa Rosa County', 'Lebanon County') GROUP BY cc_state ORDER BY total_call_centers DESC;
SELECT sm.sm_type, p.p_promo_name, hd.hd_income_band_sk, COUNT(DISTINCT cs.cs_order_number) AS total_orders, SUM(cs.cs_quantity) AS total_quantity, AVG(cs.cs_sales_price) AS avg_sales_price, SUM(cs.cs_net_paid) AS total_net_paid, SUM(cs.cs_net_paid_inc_tax) AS total_net_paid_inc_tax, SUM(cs.cs_net_paid_inc_ship) AS total_net_paid_inc_ship, SUM(cs.cs_net_paid_inc_ship_tax) AS total_net_paid_inc_ship_tax, SUM(cs.cs_net_profit) AS total_net_profit FROM catalog_sales cs JOIN ship_mode sm ON cs.cs_ship_mode_sk = sm.sm_ship_mode_sk JOIN promotion p ON cs.cs_promo_sk = p.p_promo_sk JOIN household_demographics hd ON cs.cs_ship_hdemo_sk = hd.hd_demo_sk WHERE sm.sm_ship_mode_sk IN (15, 11, 1) AND sm.sm_type IN ('TWO DAY', 'EXPRESS', 'NEXT DAY') AND p.p_channel_details IN ('Only red systems ring right b', 'Strong cells could dis', 'Finally glad reasons mobili') AND p.p_channel_dmail IN ('N', 'Y') AND p.p_promo_name LIKE '%ese%' OR p.p_promo_name LIKE '%eing%' OR p.p_promo_name LIKE '%able%' AND p.p_purpose = 'Unknown' AND hd.hd_income_band_sk IN (11, 1, 6) AND hd.hd_dep_count IN (5, 0, 2) AND cs.cs_ship_customer_sk IN (6024, 65323, 92049) AND cs.cs_ext_ship_cost IN (36.27, 943.02, 662.47) GROUP BY sm.sm_type, p.p_promo_name, hd.hd_income_band_sk ORDER BY total_net_profit DESC, avg_sales_price DESC, total_orders DESC;
SELECT cd.cd_gender, cd.cd_marital_status, cd.cd_education_status, cd.cd_purchase_estimate, cd.cd_credit_rating, AVG(cd.cd_dep_count) AS avg_dependents, AVG(cd.cd_dep_employed_count) AS avg_employed_dependents, AVG(cd.cd_dep_college_count) AS avg_college_dependents, COUNT(DISTINCT sr.sr_customer_sk) AS num_returning_customers, SUM(sr.sr_return_quantity) AS total_returned_quantity, SUM(sr.sr_return_amt) AS total_returned_amount, SUM(sr.sr_return_amt_inc_tax) AS total_returned_amount_inc_tax, AVG(sr.sr_return_amt) AS avg_return_amount, AVG(sr.sr_return_amt_inc_tax) AS avg_return_amount_inc_tax, MAX(sr.sr_return_amt_inc_tax) AS max_return_amount_inc_tax, MIN(sr.sr_return_amt_inc_tax) AS min_return_amount_inc_tax, td.t_shift, COUNT(DISTINCT wp.wp_web_page_sk) AS num_web_pages, SUM(wp.wp_char_count) AS total_char_count FROM customer_demographics cd JOIN store_returns sr ON cd.cd_demo_sk = sr.sr_cdemo_sk JOIN time_dim td ON sr.sr_return_time_sk = td.t_time_sk LEFT JOIN web_page wp ON cd.cd_demo_sk = wp.wp_customer_sk WHERE cd.cd_gender = 'M' AND sr.sr_return_amt_inc_tax BETWEEN 8.31 AND 5055.81 AND wp.wp_url LIKE 'http://www.foo.com%' AND wp.wp_char_count IN (5676, 3034) GROUP BY cd.cd_gender, cd.cd_marital_status, cd.cd_education_status, cd.cd_purchase_estimate, cd.cd_credit_rating, td.t_shift ORDER BY total_returned_amount_inc_tax DESC, avg_dependents DESC LIMIT 100;
SELECT i.i_category, i.i_brand, w.w_state, COUNT(DISTINCT cr.cr_order_number) as total_returns, SUM(cr.cr_return_amount) as total_return_amount, AVG(cr.cr_return_amount) as avg_return_amount, SUM(cr.cr_return_quantity) as total_return_quantity, AVG(cr.cr_return_quantity) as avg_return_quantity, COUNT(DISTINCT wr.wr_order_number) as total_web_returns, SUM(wr.wr_return_amt) as total_web_return_amount, AVG(wr.wr_return_amt) as avg_web_return_amount, SUM(wr.wr_return_quantity) as total_web_return_quantity, AVG(wr.wr_return_quantity) as avg_web_return_quantity, SUM(cr.cr_refunded_cash + wr.wr_refunded_cash) as total_refunded_cash, SUM(cr.cr_return_ship_cost + wr.wr_return_ship_cost) as total_shipping_cost FROM catalog_returns cr JOIN item i ON cr.cr_item_sk = i.i_item_sk JOIN warehouse w ON cr.cr_warehouse_sk = w.w_warehouse_sk LEFT JOIN web_returns wr ON cr.cr_item_sk = wr.wr_item_sk AND cr.cr_order_number = wr.wr_order_number GROUP BY i.i_category, i.i_brand, w.w_state ORDER BY total_returns DESC, total_return_amount DESC, total_web_returns DESC, total_web_return_amount DESC;
SELECT ca.ca_state, sm.sm_type, ws.ws_web_site_sk, COUNT(DISTINCT ws.ws_order_number) AS total_orders, SUM(ws.ws_quantity) AS total_quantity, AVG(ws.ws_sales_price) AS average_sales_price, SUM(ws.ws_net_paid) AS total_net_paid, SUM(ws.ws_net_profit) AS total_net_profit FROM web_sales ws JOIN customer_address ca ON ws.ws_ship_addr_sk = ca.ca_address_sk JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk JOIN date_dim dd ON ws.ws_sold_date_sk = dd.d_date_sk WHERE ca.ca_state IN ('CT', 'SD') AND sm.sm_type = 'OVERNIGHT' AND ws.ws_web_site_sk IN (SELECT web_site_sk FROM web_site WHERE web_market_manager = 'John Doe') AND dd.d_year = 2023 AND dd.d_moy BETWEEN 1 AND 6 GROUP BY ca.ca_state, sm.sm_type, ws.ws_web_site_sk ORDER BY total_net_profit DESC;
SELECT cc.cc_call_center_id, cc.cc_name, cc.cc_city, cc.cc_state, SUM(cs.cs_net_paid) AS total_sales, AVG(cs.cs_ext_discount_amt) AS average_discount, COUNT(cs.cs_order_number) AS number_of_orders, SUM(inv.inv_quantity_on_hand) AS total_inventory, COUNT(DISTINCT p.p_promo_id) AS number_of_promotions_used FROM call_center cc LEFT JOIN catalog_sales cs ON cc.cc_call_center_sk = cs.cs_call_center_sk LEFT JOIN promotion p ON cs.cs_promo_sk = p.p_promo_sk LEFT JOIN inventory inv ON cs.cs_item_sk = inv.inv_item_sk AND cc.cc_division = inv.inv_warehouse_sk WHERE cs.cs_sold_date_sk IN ('2450823', '2450816', '2450827', '2450829', '2450820') AND cs.cs_promo_sk IN ('130', '96', '160', '128') GROUP BY cc.cc_call_center_id, cc.cc_name, cc.cc_city, cc.cc_state ORDER BY total_sales DESC;
SELECT d_year, i_category, s_state, SUM(i_current_price) AS total_price, AVG(i_current_price) AS avg_price, COUNT(DISTINCT i_item_sk) AS unique_items_sold, COUNT(DISTINCT s_store_sk) AS number_of_stores, SUM(p_cost) AS total_promotion_cost, AVG(p_cost) AS avg_promotion_cost, COUNT(DISTINCT p_promo_sk) AS number_of_promotions, MAX(wp_max_ad_count) AS max_ad_count_webpage FROM date_dim, item, store, promotion, web_page, ship_mode WHERE i_rec_start_date <= d_date AND (i_rec_end_date IS NULL OR i_rec_end_date > d_date) AND s_rec_start_date <= d_date AND (s_rec_end_date IS NULL OR s_rec_end_date > d_date) AND wp_rec_start_date <= d_date AND (wp_rec_end_date IS NULL OR wp_rec_end_date > d_date) AND p_start_date_sk = d_date_sk AND (p_end_date_sk IS NULL OR p_end_date_sk >= d_date_sk) AND sm_type IN ('REGULAR', 'LIBRARY') AND i_class IN ('sports-apparel', 'decor', 'dvd/vcr players', 'shirts', 'bedding', 'fishing') AND p_channel_event = 'N' AND p_purpose <> 'Unknown' GROUP BY d_year, i_category, s_state ORDER BY d_year, i_category, s_state;
SELECT dd.d_year, dd.d_quarter_name, SUM(cs.cs_net_paid_inc_tax) AS total_revenue, AVG(cs.cs_net_paid_inc_tax) AS avg_revenue_per_sale, COUNT(cs.cs_order_number) AS total_orders, AVG(cd.cd_purchase_estimate) AS avg_customer_purchase_estimate, COUNT(DISTINCT c.c_customer_sk) AS total_customers, AVG(i.inv_quantity_on_hand) AS avg_inventory_quantity, COUNT(DISTINCT w.web_site_sk) AS total_web_sites FROM date_dim dd JOIN catalog_sales cs ON dd.d_date_sk = cs.cs_sold_date_sk JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk JOIN inventory i ON cs.cs_sold_date_sk = i.inv_date_sk JOIN web_site w ON w.web_zip = '35709' OR w.web_zip = '31904' WHERE dd.d_year = 2000 AND cd.cd_gender = 'M' AND cd.cd_dep_college_count = 0 AND cs.cs_item_sk IN ('34', '4', '13', '54') AND i.inv_date_sk = 2450815 GROUP BY dd.d_year, dd.d_quarter_name ORDER BY total_revenue DESC, avg_revenue_per_sale DESC;
SELECT s_state, cd_gender, cd_marital_status, cd_education_status, hd_buy_potential, AVG(cd_purchase_estimate) AS avg_purchase_estimate, SUM(s_number_employees) AS total_employees, COUNT(DISTINCT s_store_sk) AS num_stores, MIN(s_floor_space) AS min_floor_space, MAX(s_floor_space) AS max_floor_space, AVG(s_floor_space) AS avg_floor_space, COUNT(DISTINCT hd_demo_sk) AS num_households, SUM(hd_vehicle_count) AS total_vehicles, AVG(hd_vehicle_count) AS avg_vehicles_per_household FROM store JOIN household_demographics ON (s_store_sk = hd_demo_sk) JOIN customer_demographics ON (hd_demo_sk = cd_demo_sk) WHERE s_country = 'United States' AND s_state IN ('CA', 'TX', 'FL') AND cd_dep_employed_count = 0 AND hd_buy_potential LIKE 'Unknown%' AND cd_education_status IN ('College', '4 yr Degree', 'Graduate Degree') AND s_market_id IS NOT NULL GROUP BY s_state, cd_gender, cd_marital_status, cd_education_status, hd_buy_potential ORDER BY s_state, avg_purchase_estimate DESC, total_employees DESC LIMIT 50;
SELECT dd.d_year, dd.d_quarter_name, w.w_state, SUM(inv.inv_quantity_on_hand) AS total_inventory, AVG(inv.inv_quantity_on_hand) AS avg_inventory, COUNT(DISTINCT inv.inv_warehouse_sk) AS number_of_warehouses, COUNT(DISTINCT web.web_site_sk) AS number_of_websites, SUM(cc.cc_employees) AS total_employees, AVG(cc.cc_tax_percentage) AS avg_tax_percentage FROM inventory inv JOIN date_dim dd ON inv.inv_date_sk = dd.d_date_sk JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk JOIN web_site web ON web.web_state = w.w_state JOIN call_center cc ON cc.cc_state = w.w_state WHERE inv.inv_quantity_on_hand IN (232, 844, 624) AND dd.d_year = 2023 AND web.web_open_date_sk <= dd.d_date_sk AND (web.web_close_date_sk IS NULL OR web.web_close_date_sk >= dd.d_date_sk) AND cc.cc_open_date_sk <= dd.d_date_sk AND (cc.cc_closed_date_sk IS NULL OR cc.cc_closed_date_sk >= dd.d_date_sk) GROUP BY dd.d_year, dd.d_quarter_name, w.w_state ORDER BY dd.d_year, dd.d_quarter_name, w.w_state;
SELECT ca.ca_state, COUNT(DISTINCT c.c_customer_sk) AS total_customers, AVG(s.s_floor_space) AS average_store_floor_space, SUM(s.s_number_employees) AS total_employees, COUNT(DISTINCT w.web_site_sk) AS total_websites, AVG(w.web_tax_percentage) AS average_web_tax_percentage FROM customer_address ca JOIN customer c ON ca.ca_address_sk = c.c_current_addr_sk JOIN store s ON ca.ca_state = s.s_state JOIN web_site w ON w.web_state = ca.ca_state WHERE c.c_preferred_cust_flag = 'Y' AND c.c_birth_year BETWEEN 1933 AND 1975 AND s.s_company_id = 1 AND w.web_open_date_sk IN ('2450730', '2450747') GROUP BY ca.ca_state ORDER BY total_customers DESC;
SELECT cd.cd_education_status, cd.cd_gender, cd.cd_marital_status, COUNT(DISTINCT c.c_customer_sk) AS total_customers, AVG(cd.cd_purchase_estimate) AS avg_purchase_estimate, AVG(wp.wp_char_count) AS avg_webpage_char_count, COUNT(DISTINCT wp.wp_web_page_sk) AS total_web_pages_accessed, SUM(CASE WHEN cd.cd_credit_rating = 'High' THEN 1 ELSE 0 END) AS high_credit_rating_count, SUM(CASE WHEN cd.cd_credit_rating = 'Medium' THEN 1 ELSE 0 END) AS medium_credit_rating_count, SUM(CASE WHEN cd.cd_credit_rating = 'Low' THEN 1 ELSE 0 END) AS low_credit_rating_count FROM customer_demographics cd JOIN customer c ON cd.cd_demo_sk = c.c_current_cdemo_sk LEFT JOIN web_page wp ON c.c_customer_sk = wp.wp_customer_sk WHERE c.c_birth_country = 'BOTSWANA' AND c.c_email_address LIKE '%@Bk.com' GROUP BY cd.cd_education_status, cd.cd_gender, cd.cd_marital_status ORDER BY cd.cd_education_status, cd.cd_gender, cd.cd_marital_status;
SELECT sm.sm_type AS shipping_mode_type, sm.sm_carrier AS carrier, cp.cp_department AS catalog_department, COUNT(DISTINCT wr.wr_order_number) AS number_of_returns, SUM(wr.wr_return_quantity) AS total_returned_quantity, AVG(wr.wr_return_amt) AS average_return_amount, SUM(wr.wr_return_tax) AS total_tax, SUM(wr.wr_return_ship_cost) AS total_shipping_cost, SUM(wr.wr_net_loss) AS total_net_loss FROM web_returns wr JOIN ship_mode sm ON wr.wr_returned_date_sk = sm.sm_ship_mode_sk JOIN catalog_page cp ON wr.wr_web_page_sk = cp.cp_catalog_page_sk WHERE wr.wr_returned_date_sk = 2451368 AND cp.cp_catalog_page_sk IN ('859', '3510', '105', '4419') GROUP BY shipping_mode_type, carrier, catalog_department ORDER BY total_net_loss DESC;
SELECT i.i_item_id, i.i_category, i.i_class, i.i_brand, SUM(cr.cr_return_amount) AS total_return_amount, AVG(cr.cr_return_amount) AS avg_return_amount, COUNT(cr.cr_returned_date_sk) AS return_count, SUM(cr.cr_fee) AS total_fee, SUM(cr.cr_return_ship_cost) AS total_shipping_cost, SUM(cr.cr_net_loss) AS total_net_loss FROM catalog_returns cr JOIN item i ON cr.cr_item_sk = i.i_item_sk JOIN web_site ws ON cr.cr_returned_date_sk = ws.web_open_date_sk WHERE ws.web_gmt_offset = '-5.00' AND ws.web_mkt_id IN (3, 5, 6, 1, 4, 2) AND i.i_size IN ('small', 'extra large') AND i.i_class IN ('hockey', 'infants', 'portable', 'memory') AND cr.cr_reason_sk = 3 GROUP BY i.i_item_id, i.i_category, i.i_class, i.i_brand ORDER BY total_return_amount DESC, return_count DESC LIMIT 100;
SELECT i.i_category_id, i.i_category, COUNT(DISTINCT sr.sr_item_sk) AS total_returned_items, SUM(sr.sr_return_amt_inc_tax) AS total_return_amount, AVG(sr.sr_return_amt_inc_tax) AS avg_return_amount FROM store_returns sr JOIN item i ON sr.sr_item_sk = i.i_item_sk JOIN web_page wp ON wp.wp_access_date_sk = sr.sr_returned_date_sk JOIN catalog_page cp ON sr.sr_returned_date_sk BETWEEN cp.cp_start_date_sk AND cp.cp_end_date_sk WHERE wp.wp_access_date_sk IN ('2452566', '2452648', '2452619', '2452639') AND i.i_category_id IN ('9', '10', '4') GROUP BY i.i_category_id, i.i_category ORDER BY total_return_amount DESC LIMIT 5;
SELECT ca.ca_state, COUNT(DISTINCT c.c_customer_sk) AS total_customers, SUM(sr.sr_return_amt) AS total_return_amount, AVG(sr.sr_return_amt) AS average_return_amount, SUM(sr.sr_return_quantity) AS total_return_quantity, COUNT(DISTINCT sr.sr_ticket_number) AS total_returns, COUNT(DISTINCT CASE WHEN c.c_preferred_cust_flag = 'Y' THEN sr.sr_ticket_number ELSE NULL END) AS preferred_customer_returns FROM store_returns sr JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk WHERE sr.sr_return_tax BETWEEN 5 AND 130 AND c.c_last_review_date_sk IN (2452499, 2452496, 2452479, 2452342) AND sr.sr_item_sk IN (13538, 16733, 1766, 2599, 3017, 9220) GROUP BY ca.ca_state ORDER BY total_return_amount DESC;
SELECT ws.ws_web_site_sk, AVG(ws.ws_sales_price) AS avg_sales_price, COUNT(ws.ws_order_number) AS total_orders, AVG(ws.ws_quantity) AS avg_quantity, SUM(ws.ws_net_paid_inc_tax) AS total_revenue, SUM(ws.ws_net_paid) AS total_net_paid, SUM(ws.ws_coupon_amt) AS total_coupon_amt, AVG(hd.hd_dep_count) AS avg_dependency_count, AVG(hd.hd_vehicle_count) AS avg_vehicle_count, wp.wp_type, COUNT(DISTINCT hd.hd_demo_sk) AS unique_households FROM web_sales ws JOIN web_page wp ON ws.ws_web_page_sk = wp.wp_web_page_sk JOIN household_demographics hd ON ws.ws_ship_hdemo_sk = hd.hd_demo_sk JOIN time_dim td ON ws.ws_sold_time_sk = td.t_time_sk JOIN web_site wsit ON ws.ws_web_site_sk = wsit.web_site_sk WHERE wsit.web_gmt_offset = '-5.00' AND wsit.web_site_sk IN (6, 17, 14) AND td.t_time IN (3552, 4450, 1742) AND ws.ws_sales_price BETWEEN 17.54 AND 205.36 AND ws.ws_item_sk IN (51, 14, 107, 50, 104, 108) GROUP BY ws.ws_web_site_sk, wp.wp_type ORDER BY total_revenue DESC;
SELECT cd.cd_education_status, cd.cd_marital_status, CASE WHEN cd.cd_purchase_estimate < 2000 THEN 'Low' WHEN cd.cd_purchase_estimate BETWEEN 2000 AND 3500 THEN 'Medium' WHEN cd.cd_purchase_estimate > 3500 THEN 'High' ELSE 'Unknown' END AS purchase_estimate_range, COUNT(DISTINCT ws.ws_order_number) AS total_orders, SUM(ws.ws_net_paid) AS total_revenue, AVG(ws.ws_net_paid) AS average_revenue_per_order, COUNT(DISTINCT ws.ws_bill_customer_sk) AS total_customers FROM web_sales ws JOIN customer_demographics cd ON ws.ws_bill_cdemo_sk = cd.cd_demo_sk JOIN time_dim t ON ws.ws_sold_time_sk = t.t_time_sk JOIN web_site wsit ON ws.ws_web_site_sk = wsit.web_site_sk WHERE wsit.web_market_manager = 'Jeffrey Campbell' AND t.t_shift = 'third' AND cd.cd_dep_college_count = 0 GROUP BY cd.cd_education_status, cd.cd_marital_status, purchase_estimate_range ORDER BY total_revenue DESC;
SELECT sm.sm_type AS shipping_type, web.web_site_sk AS website_id, web.web_name AS website_name, i.i_category AS product_category, COUNT(DISTINCT ws.ws_order_number) AS total_orders, SUM(ws.ws_quantity) AS total_quantity_sold, SUM(ws.ws_net_paid) AS total_net_paid, SUM(ws.ws_net_paid_inc_tax) AS total_net_paid_incl_tax, SUM(ws.ws_net_paid_inc_ship) AS total_net_paid_incl_shipping, SUM(ws.ws_net_paid_inc_ship_tax) AS total_net_paid_incl_shipping_tax, AVG(ws.ws_sales_price) AS average_sales_price, SUM(ws.ws_net_profit) AS total_net_profit FROM web_sales ws JOIN web_site web ON ws.ws_web_site_sk = web.web_site_sk JOIN item i ON ws.ws_item_sk = i.i_item_sk JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk JOIN date_dim dd ON ws.ws_sold_date_sk = dd.d_date_sk WHERE sm.sm_type IN ('REGULAR', 'EXPRESS', 'OVERNIGHT') AND web.web_country = 'United States' AND ws.ws_warehouse_sk IN (2, 4) AND i.i_category IN ('Electronics', 'Women', 'Children', 'Home', 'Sports', 'Books') AND dd.d_year = 1999 GROUP BY shipping_type, website_id, website_name, product_category ORDER BY total_net_profit DESC, total_net_paid DESC, website_name, product_category;
