SELECT cc.cc_name AS call_center_name, cc.cc_city AS call_center_city, cc.cc_state AS call_center_state, hd.hd_income_band_sk AS income_band, COUNT(DISTINCT sr.sr_ticket_number) AS total_returns, SUM(sr.sr_return_quantity) AS total_returned_items, AVG(sr.sr_return_amt) AS average_return_amount, SUM(sr.sr_return_amt_inc_tax) AS total_return_amount_including_tax, SUM(sr.sr_net_loss) AS total_net_loss FROM call_center cc JOIN store_returns sr ON cc.cc_call_center_sk = sr.sr_store_sk JOIN household_demographics hd ON sr.sr_hdemo_sk = hd.hd_demo_sk JOIN warehouse w ON cc.cc_state = w.w_state WHERE w.w_county = 'Williamson County' AND hd.hd_demo_sk = 1887 AND cc.cc_rec_start_date <= CURRENT_DATE AND (cc.cc_rec_end_date IS NULL OR cc.cc_rec_end_date > CURRENT_DATE) GROUP BY call_center_name, call_center_city, call_center_state, income_band ORDER BY total_returns DESC, total_returned_items DESC;
SELECT ca_state, r_reason_desc, COUNT(*) AS return_count, SUM(sr_return_amt) AS total_return_amount, AVG(sr_return_quantity) AS average_quantity_returned, SUM(sr_return_amt_inc_tax) AS total_amount_including_tax, SUM(sr_fee) AS total_fees, SUM(sr_return_ship_cost) AS total_shipping_costs, SUM(sr_refunded_cash) AS total_cash_refunded, SUM(sr_reversed_charge) AS total_reversed_charges, SUM(sr_store_credit) AS total_store_credit_issued, SUM(sr_net_loss) AS total_net_loss FROM store_returns JOIN reason ON store_returns.sr_reason_sk = reason.r_reason_sk JOIN customer_address ON store_returns.sr_addr_sk = customer_address.ca_address_sk WHERE (sr_reason_sk IN (13, 15, 26, 31, 21, 27)) AND (sr_reversed_charge IN (269.66, 29.95, 131.41, 123.32, 10.07, 1.54)) AND (sr_item_sk IN (6759, 10097, 13141, 10841, 4022)) GROUP BY ca_state, r_reason_desc ORDER BY ca_state, total_return_amount DESC;
SELECT cd.cd_gender, cd.cd_marital_status, SUM(ss.ss_ext_sales_price) AS total_sales, AVG(ss.ss_coupon_amt) AS average_coupon_amt, COUNT(ss.ss_item_sk) AS total_items_sold, AVG(inv.inv_quantity_on_hand) AS average_inventory_on_hand FROM store_sales ss JOIN promotion p ON ss.ss_promo_sk = p.p_promo_sk JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk JOIN inventory inv ON ss.ss_item_sk = inv.inv_item_sk WHERE cd.cd_gender IN ('M', 'F') AND ss.ss_ext_sales_price IN (672.96, 2541.35, 528.00, 4835.54, 2912.12, 416.88) AND ss.ss_promo_sk IN (144, 107, 228, 186, 28, 37) AND inv.inv_warehouse_sk IN (1, 2) AND inv.inv_quantity_on_hand = 24 GROUP BY cd.cd_gender, cd.cd_marital_status ORDER BY cd.cd_gender, cd.cd_marital_status;
SELECT ca.ca_state, ib.ib_income_band_sk, i.i_category, COUNT(DISTINCT ws.ws_order_number) AS total_orders, SUM(ws.ws_quantity) AS total_quantity, AVG(ws.ws_sales_price) AS avg_sales_price, SUM(ws.ws_net_paid) AS total_net_paid, SUM(ws.ws_net_profit) AS total_net_profit FROM web_sales ws JOIN item i ON ws.ws_item_sk = i.i_item_sk JOIN customer_address ca ON ws.ws_ship_addr_sk = ca.ca_address_sk JOIN income_band ib ON ws.ws_ship_hdemo_sk = ib.ib_income_band_sk WHERE i.i_class IN ('infants', 'diamonds', 'camcorders', 'karoke', 'pendants', 'wireless') AND ca.ca_street_name IN ('Oak Franklin', 'Park Fourteenth', '2nd 5th', 'Second Main') AND ws.ws_ship_hdemo_sk IN ('5884', '5775', '5849', '958', '2572') AND ws.ws_ext_list_price IN ('5273.64', '22629.95', '2666.62') AND ib.ib_income_band_sk IN ('1', '6', '14', '13', '2') GROUP BY ca.ca_state, ib.ib_income_band_sk, i.i_category ORDER BY total_net_profit DESC, ca.ca_state, ib.ib_income_band_sk, i.i_category;
SELECT cc.cc_name AS call_center_name, i.i_brand AS item_brand, sum(ws.ws_sales_price) AS total_sales, avg(ws.ws_sales_price) AS average_sales_price, count(ws.ws_order_number) AS total_orders, sum(wr.wr_return_amt) AS total_returns, avg(wr.wr_return_amt) AS average_return_amount, count(DISTINCT wr.wr_order_number) AS total_return_orders, sum(hd.hd_dep_count) AS total_dependents, sum(hd.hd_vehicle_count) AS total_vehicles FROM call_center cc JOIN web_sales ws ON cc.cc_call_center_sk = ws.ws_warehouse_sk JOIN web_returns wr ON ws.ws_item_sk = wr.wr_item_sk AND ws.ws_order_number = wr.wr_order_number JOIN item i ON ws.ws_item_sk = i.i_item_sk JOIN household_demographics hd ON ws.ws_bill_hdemo_sk = hd.hd_demo_sk WHERE cc.cc_name IN ('North Midwest', 'NY Metro') AND i.i_brand_id IN ('6007005', '10003009', '4001002') AND i.i_wholesale_cost IN (24.96, 1.76, 2.66, 5.22) GROUP BY cc.cc_name, i.i_brand ORDER BY total_sales DESC, total_returns DESC;
SELECT w_state, web_name, ca_city, COUNT(DISTINCT cr_order_number) AS total_returns, AVG(cr_return_amount) AS avg_return_amount, SUM(cr_return_quantity) AS total_returned_quantity, SUM(cr_return_amount) AS total_returned_amount, SUM(cr_fee) AS total_fees, SUM(cr_net_loss) AS total_net_loss, COUNT(DISTINCT ss_ticket_number) AS total_sales_transactions, AVG(ss_sales_price) AS avg_sales_price, SUM(ss_quantity) AS total_sold_quantity, SUM(ss_net_profit) AS total_net_profit FROM warehouse JOIN catalog_returns ON w_warehouse_sk = cr_warehouse_sk JOIN reason ON cr_reason_sk = r_reason_sk JOIN customer_address ON cr_returning_addr_sk = ca_address_sk JOIN store_sales ON cr_item_sk = ss_item_sk AND cr_order_number = ss_ticket_number JOIN store ON ss_store_sk = s_store_sk JOIN web_site ON s_store_sk = web_site_sk WHERE w_country = 'United States' AND ca_street_number IN ('125', '871', '690') AND ca_city = 'Glenville' AND web_rec_end_date IN ('1999-08-16', '2000-08-15', '2001-08-15') AND web_site_sk IN ('25', '29', '21', '17') GROUP BY w_state, web_name, ca_city ORDER BY total_returns DESC, total_net_profit DESC;
SELECT w_state, COUNT(DISTINCT c_customer_sk) AS number_of_customers, AVG(inv_quantity_on_hand) AS average_inventory, SUM(case when c_preferred_cust_flag = 'Y' then 1 else 0 end) AS preferred_customer_count, MAX(wp_link_count) AS max_webpage_link_count, MIN(web_tax_percentage) AS min_tax_percentage FROM customer JOIN warehouse ON c_current_addr_sk = w_warehouse_sk JOIN inventory ON inv_warehouse_sk = w_warehouse_sk JOIN web_page ON wp_customer_sk = c_customer_sk JOIN web_site ON wp_web_page_sk = web_site_sk AND web_class <> 'Unknown' WHERE web_close_date_sk IN ('2446944', '2446978', '2447046') GROUP BY w_state ORDER BY number_of_customers DESC, average_inventory DESC;
SELECT t.t_shift, SUM(i.inv_quantity_on_hand) AS total_quantity_on_hand, AVG(s.s_number_employees) AS avg_number_of_employees, COUNT(DISTINCT s.s_store_sk) AS number_of_stores, SUM(s.s_floor_space) AS total_floor_space FROM inventory i JOIN time_dim t ON i.inv_date_sk = t.t_time_sk JOIN store s ON i.inv_warehouse_sk = s.s_store_sk WHERE s.s_store_id = 'AAAAAAAAIAAAAAAA' AND t.t_am_pm = 'PM' AND s.s_rec_start_date <= CURRENT_DATE AND (s.s_rec_end_date IS NULL OR s.s_rec_end_date > CURRENT_DATE) GROUP BY t.t_shift ORDER BY t.t_shift;
