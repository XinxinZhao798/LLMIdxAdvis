SELECT s_state, s_city, s_county, COUNT(DISTINCT s_store_sk) AS num_stores, SUM(ss_quantity) AS total_quantity_sold, AVG(ss_sales_price) AS average_sales_price, SUM(ss_net_paid) AS total_net_paid, SUM(ss_net_paid_inc_tax) AS total_net_paid_inc_tax, SUM(ss_net_profit) AS total_net_profit, COUNT(DISTINCT ss_customer_sk) AS unique_customers, AVG(inv_quantity_on_hand) AS average_inventory_on_hand FROM store JOIN store_sales ON s_store_sk = ss_store_sk JOIN inventory ON ss_item_sk = inv_item_sk AND ss_store_sk = inv_warehouse_sk JOIN time_dim ON ss_sold_time_sk = t_time_sk WHERE inv_quantity_on_hand IN (553, 372, 818, 629, 791, 623) AND inv_warehouse_sk IN (1, 2) AND t_hour BETWEEN 9 AND 17 GROUP BY s_state, s_city, s_county ORDER BY s_state, s_city, s_county;
SELECT i.i_category, c.c_birth_country, COUNT(DISTINCT ws.ws_order_number) AS total_orders, SUM(ws.ws_quantity) AS total_quantity, AVG(ws.ws_sales_price) AS average_sales_price, SUM(ws.ws_net_paid) AS total_net_paid, SUM(ws.ws_net_profit) AS total_net_profit FROM web_sales ws JOIN item i ON ws.ws_item_sk = i.i_item_sk JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk WHERE i.i_rec_start_date >= '1999-10-28' AND i.i_rec_start_date <= '2001-10-27' AND i.i_brand IN ('importocorp #2', 'exportiexporti #2', 'scholarbrand #3', 'namelessmaxi #10', 'exportiexporti #1') AND ws.ws_web_page_sk IN (19, 18, 56, 24) AND c.c_birth_country IN ('MARSHALL ISLANDS', 'NEW CALEDONIA', 'MALTA', 'CHILE', 'GRENADA') GROUP BY i.i_category, c.c_birth_country ORDER BY total_net_profit DESC, total_net_paid DESC, i.i_category, c.c_birth_country;
SELECT s_state, i_category, COUNT(DISTINCT i_item_sk) AS num_items, SUM(i_current_price) AS total_current_price, AVG(i_wholesale_cost) AS avg_wholesale_cost, COUNT(DISTINCT w_warehouse_sk) AS num_warehouses, SUM(w_warehouse_sq_ft) AS total_warehouse_sq_ft, COUNT(DISTINCT wp_web_page_sk) AS num_web_pages, AVG(wp_char_count) AS avg_char_count_on_web_pages FROM store JOIN item ON (s_store_sk = i_manufact_id) JOIN warehouse ON (s_zip = w_zip) JOIN web_page ON (wp_access_date_sk = '2452583' OR wp_access_date_sk = '2452565' OR wp_access_date_sk = '2452618') WHERE s_state IN ('CA', 'TX', 'NY') AND i_category IN ('Electronics', 'Clothing', 'Furniture') GROUP BY s_state, i_category ORDER BY s_state, i_category;
SELECT s.s_state, COUNT(sr.sr_ticket_number) AS total_returns_count, SUM(sr.sr_return_amt) AS total_returns_amount, AVG(sr.sr_return_amt) AS average_return_amount, AVG(w.w_warehouse_sq_ft) AS average_warehouse_sq_footage FROM store s JOIN store_returns sr ON s.s_store_sk = sr.sr_store_sk LEFT JOIN warehouse w ON s.s_state = w.w_state WHERE s.s_closed_date_sk IS NULL GROUP BY s.s_state ORDER BY s.s_state;
SELECT cd.cd_education_status, cd.cd_credit_rating, AVG(sr.sr_return_amt) AS avg_store_return_amt, SUM(cr.cr_return_amount) AS sum_catalog_return_amt, COUNT(DISTINCT sr.sr_customer_sk) AS unique_store_customers, COUNT(DISTINCT cr.cr_returning_customer_sk) AS unique_catalog_customers FROM customer_demographics cd LEFT JOIN store_returns sr ON cd.cd_demo_sk = sr.sr_cdemo_sk LEFT JOIN catalog_returns cr ON cd.cd_demo_sk = cr.cr_returning_cdemo_sk LEFT JOIN household_demographics hd ON cd.cd_demo_sk = hd.hd_demo_sk WHERE cd.cd_purchase_estimate IN (3500, 1500, 10000) AND cd.cd_dep_college_count = 0 AND hd.hd_income_band_sk IN (19, 8, 15, 3, 1) GROUP BY cd.cd_education_status, cd.cd_credit_rating ORDER BY avg_store_return_amt DESC, sum_catalog_return_amt DESC;
SELECT dd.d_year, cc.cc_country, SUM(ss.ss_quantity) AS total_quantity_sold, AVG(ss.ss_sales_price) AS avg_sales_price, COUNT(DISTINCT wp.wp_web_page_sk) AS webpage_count, SUM(ss.ss_net_paid) - SUM(ss.ss_net_paid_inc_tax) AS total_tax_collected FROM store_sales ss JOIN date_dim dd ON ss.ss_sold_date_sk = dd.d_date_sk JOIN call_center cc ON cc.cc_call_center_sk = ss.ss_store_sk LEFT JOIN web_page wp ON dd.d_date_sk = wp.wp_access_date_sk WHERE dd.d_current_week = 'N' AND cc.cc_country = 'United States' AND cc.cc_call_center_sk IN ('3', '1', '5') AND wp.wp_image_count IN ('1', '2', '4', '5', '6', '7') GROUP BY dd.d_year, cc.cc_country ORDER BY dd.d_year, total_quantity_sold DESC;
