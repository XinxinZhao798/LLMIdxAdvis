SELECT i.i_category AS category, i.i_brand AS brand, SUM(cs.cs_sales_price) AS total_sales, AVG(cs.cs_sales_price) AS avg_sales_price, COUNT(cs.cs_order_number) AS total_orders, AVG(hd.hd_dep_count) AS avg_dependency_count, AVG(hd.hd_vehicle_count) AS avg_vehicle_count FROM catalog_sales cs JOIN item i ON cs.cs_item_sk = i.i_item_sk JOIN household_demographics hd ON cs.cs_bill_hdemo_sk = hd.hd_demo_sk JOIN warehouse w ON cs.cs_warehouse_sk = w.w_warehouse_sk WHERE w.w_city = 'Fairview' AND w.w_zip = '35709' AND hd.hd_demo_sk IN ('3429', '3835', '1080', '381', '3354') AND cs.cs_sold_time_sk = '67862' GROUP BY i.i_category, i.i_brand ORDER BY total_sales DESC;
SELECT cu.c_salutation, wh.w_state, COUNT(DISTINCT cs.cs_order_number) AS total_sales_transactions, SUM(cs.cs_net_paid_inc_tax) AS total_sales_amount, AVG(cs.cs_ext_discount_amt) AS average_discount, COUNT(DISTINCT sr.sr_ticket_number) AS total_return_transactions, SUM(sr.sr_return_amt_inc_tax) AS total_return_amount FROM customer cu LEFT JOIN catalog_sales cs ON cu.c_customer_sk = cs.cs_ship_customer_sk LEFT JOIN store_returns sr ON cu.c_customer_sk = sr.sr_customer_sk LEFT JOIN warehouse wh ON (cs.cs_warehouse_sk = wh.w_warehouse_sk OR sr.sr_store_sk = wh.w_warehouse_sk) LEFT JOIN promotion p ON cs.cs_promo_sk = p.p_promo_sk WHERE (cs.cs_sold_date_sk IN ('2450819', '2450822', '2450817') OR sr.sr_returned_date_sk IN ('2450819', '2450822', '2450817')) AND (cu.c_salutation IN ('Dr.', 'Mr.', 'Sir', 'Ms.', 'Mrs.', 'Miss')) AND (wh.w_city = 'Fairview') AND (wh.w_suite_number IN ('Suite 80', 'Suite 0', 'Suite P', 'Suite 470')) AND (cu.c_last_review_date_sk IN ('2452425', '2452326', '2452389')) AND (sr.sr_reversed_charge IN ('44.04', '12.34') OR sr.sr_reversed_charge IS NULL) GROUP BY cu.c_salutation, wh.w_state ORDER BY total_sales_amount DESC, total_return_amount ASC;
SELECT dd.d_year, dd.d_quarter_name, i.i_category, COUNT(sr.sr_ticket_number) AS total_returns, SUM(sr.sr_return_quantity) AS total_returned_items, AVG(sr.sr_return_amt) AS average_return_amount, SUM(sr.sr_return_amt_inc_tax) AS total_return_amount_inc_tax, SUM(sr.sr_fee) AS total_fees, SUM(sr.sr_net_loss) AS total_net_loss FROM store_returns sr JOIN date_dim dd ON sr.sr_returned_date_sk = dd.d_date_sk JOIN item i ON sr.sr_item_sk = i.i_item_sk JOIN customer_demographics cd ON sr.sr_cdemo_sk = cd.cd_demo_sk JOIN time_dim td ON sr.sr_return_time_sk = td.t_time_sk WHERE (i.i_brand_id IN ('8007010', '6006007', '9004004', '9010002') OR i.i_container = 'Unknown') AND dd.d_quarter_name IN ('1907Q4', '1912Q3', '1913Q3') AND td.t_time_sk = '4464' AND td.t_shift = 'third' GROUP BY dd.d_year, dd.d_quarter_name, i.i_category ORDER BY dd.d_year, dd.d_quarter_name, total_returned_items DESC;
SELECT p.p_channel_dmail AS promo_channel_direct_mail, p.p_channel_email AS promo_channel_email, p.p_channel_catalog AS promo_channel_catalog, p.p_channel_tv AS promo_channel_tv, p.p_channel_radio AS promo_channel_radio, p.p_channel_press AS promo_channel_press, p.p_channel_event AS promo_channel_event, p.p_channel_demo AS promo_channel_demo, COUNT(p.p_promo_sk) AS num_promotions, SUM(p.p_cost) AS total_promo_cost, AVG(p.p_cost) AS avg_promo_cost, SUM(i.inv_quantity_on_hand) AS total_inventory_qty FROM promotion p LEFT JOIN inventory i ON p.p_item_sk = i.inv_item_sk WHERE p.p_discount_active = '1' GROUP BY promo_channel_direct_mail, promo_channel_email, promo_channel_catalog, promo_channel_tv, promo_channel_radio, promo_channel_press, promo_channel_event, promo_channel_demo ORDER BY num_promotions DESC, total_promo_cost DESC;
SELECT ca.ca_city, ca.ca_state, ca.ca_location_type, COUNT(*) AS address_count, AVG(ca.ca_gmt_offset) AS average_gmt_offset, MAX(r.r_reason_sk) AS max_reason_sk, t.t_shift, SUM(CASE WHEN t.t_am_pm = 'AM' THEN 1 ELSE 0 END) AS am_shifts, SUM(CASE WHEN t.t_am_pm = 'PM' THEN 1 ELSE 0 END) AS pm_shifts FROM customer_address ca JOIN reason r ON ca.ca_address_sk = r.r_reason_sk JOIN time_dim t ON t.t_time_sk = r.r_reason_sk WHERE ca.ca_location_type IN ('single family', 'apartment', 'condo') AND t.t_shift = 'third' AND r.r_reason_id IN ('AAAAAAAAOAAAAAAA', 'AAAAAAAAIAAAAAAA', 'AAAAAAAADCAAAAAA') GROUP BY ca.ca_city, ca.ca_state, ca.ca_location_type, t.t_shift ORDER BY ca.ca_city, ca.ca_state, ca.ca_location_type, t.t_shift;
SELECT s.s_store_name, s.s_manager, SUM(cs.cs_net_profit) AS total_profit, AVG(cs.cs_quantity) AS average_quantity_sold, COUNT(DISTINCT cs.cs_order_number) AS total_orders, SUM(wr.wr_net_loss) AS total_net_loss, AVG(wr.wr_fee) AS average_return_fee, COUNT(DISTINCT wr.wr_order_number) AS total_returns, r.r_reason_desc, d.d_year, d.d_quarter_name FROM store s JOIN catalog_sales cs ON s.s_store_sk = cs.cs_ship_addr_sk JOIN web_returns wr ON cs.cs_order_number = wr.wr_order_number JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk JOIN reason r ON wr.wr_reason_sk = r.r_reason_sk WHERE s.s_manager IN ('Raymond Jacobs', 'William Ward') AND r.r_reason_desc IN ('duplicate purchase', 'Did not fit') AND d.d_year = 2001 AND d.d_quarter_name IN ('Q1', 'Q2', 'Q3', 'Q4') GROUP BY s.s_store_name, s.s_manager, r.r_reason_desc, d.d_year, d.d_quarter_name ORDER BY total_profit DESC, total_net_loss DESC;
SELECT i.i_category, i.i_brand, COUNT(DISTINCT ss.ss_ticket_number) AS total_sales_tickets, SUM(ss.ss_quantity) AS total_items_sold, AVG(ss.ss_sales_price) AS avg_sales_price, SUM(ss.ss_net_profit) AS total_sales_profit, COUNT(DISTINCT sr.sr_ticket_number) AS total_return_tickets, SUM(sr.sr_return_quantity) AS total_items_returned, AVG(sr.sr_return_amt) AS avg_return_amount, SUM(sr.sr_net_loss) AS total_return_loss, AVG(hd.hd_dep_count) AS avg_dependency_count, AVG(hd.hd_vehicle_count) AS avg_vehicle_count FROM item i JOIN store_sales ss ON i.i_item_sk = ss.ss_item_sk LEFT JOIN store_returns sr ON i.i_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number LEFT JOIN household_demographics hd ON ss.ss_hdemo_sk = hd.hd_demo_sk WHERE i.i_brand IN ('corpunivamalg #17', 'namelessnameless #4', 'brandmaxi #10', 'exportimaxi #7') AND i.i_size IN ('large', 'N/A') AND ss.ss_hdemo_sk IN (4195, 6112, 6478, 517, 450, 4114) AND ss.ss_net_paid BETWEEN 34.68 AND 1485.96 GROUP BY i.i_category, i.i_brand ORDER BY total_sales_profit DESC, total_return_loss ASC;
SELECT s.s_store_name, COUNT(DISTINCT ws.ws_order_number) AS total_orders, SUM(ws.ws_quantity) AS total_quantity_sold, AVG(ws.ws_sales_price) AS average_sales_price, SUM(ws.ws_net_paid) AS total_net_paid, SUM(ws.ws_net_profit) AS total_net_profit, AVG(cd.cd_purchase_estimate) AS average_customer_purchase_estimate, COUNT(DISTINCT c.c_customer_sk) AS unique_customers, cd.cd_gender, cd.cd_marital_status, cd.cd_education_status FROM store s JOIN web_sales ws ON s.s_store_sk = ws.ws_ship_addr_sk JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk WHERE s.s_company_id = '1' AND cd.cd_marital_status IN ('D', 'M', 'U', 'S', 'W') AND cd.cd_dep_employed_count = 0 AND c.c_current_addr_sk IN (13869, 35082) GROUP BY s.s_store_name, cd.cd_gender, cd.cd_marital_status, cd.cd_education_status ORDER BY s.s_store_name, cd.cd_gender, cd.cd_marital_status, cd.cd_education_status;
SELECT dd.d_year, dd.d_quarter_name, cd.cd_education_status, sum(cr.cr_return_quantity) AS total_returned_quantity, avg(cr.cr_return_amount) AS avg_return_amount, count(distinct cr.cr_refunded_customer_sk) AS unique_customers_refunded, sum(inv.inv_quantity_on_hand) AS total_inventory_on_hand, sum(p.p_cost) AS total_promotion_cost FROM catalog_returns cr JOIN date_dim dd ON cr.cr_returned_date_sk = dd.d_date_sk JOIN customer_demographics cd ON cr.cr_returning_cdemo_sk = cd.cd_demo_sk JOIN inventory inv ON cr.cr_item_sk = inv.inv_item_sk AND inv.inv_date_sk = dd.d_date_sk JOIN promotion p ON p.p_item_sk = cr.cr_item_sk AND p.p_start_date_sk <= dd.d_date_sk AND p.p_end_date_sk >= dd.d_date_sk WHERE dd.d_year = 2022 AND cd.cd_dep_college_count = 0 AND dd.d_qoy IN (1, 2, 3, 4) AND cr.cr_item_sk IN (12109, 7004, 944, 13729, 16502) GROUP BY dd.d_year, dd.d_quarter_name, cd.cd_education_status ORDER BY dd.d_year, dd.d_quarter_name, cd.cd_education_status;
SELECT dd.d_year, dd.d_month_seq, dd.d_quarter_seq, cc.cc_class, SUM(sr.sr_return_amt) AS total_store_returns, AVG(sr.sr_return_quantity) AS avg_store_return_quantity, COUNT(DISTINCT sr.sr_ticket_number) AS count_store_return_tickets, SUM(wr.wr_return_amt) AS total_web_returns, AVG(wr.wr_return_quantity) AS avg_web_return_quantity, COUNT(DISTINCT wr.wr_order_number) AS count_web_return_orders FROM date_dim dd JOIN store_returns sr ON dd.d_date_sk = sr.sr_returned_date_sk JOIN web_returns wr ON dd.d_date_sk = wr.wr_returned_date_sk JOIN call_center cc ON cc.cc_open_date_sk = dd.d_date_sk WHERE dd.d_year = 2002 AND cc.cc_rec_start_date = '2002-01-01' AND (cc.cc_street_name = 'Center Hill' OR cc.cc_street_name = 'Ash Hill') AND (wr.wr_returned_time_sk IS NOT NULL AND sr.sr_return_time_sk IS NOT NULL) AND (wr.wr_returned_time_sk IN (SELECT t_time_sk FROM time_dim WHERE t_minute IN ('51', '4', '29', '2', '14', '12'))) AND EXISTS (SELECT 1 FROM warehouse w WHERE w.w_warehouse_sk = sr.sr_item_sk AND w.w_county = 'Williamson County' AND w.w_state = 'TN') GROUP BY dd.d_year, dd.d_month_seq, dd.d_quarter_seq, cc.cc_class ORDER BY dd.d_year, dd.d_month_seq, dd.d_quarter_seq, cc.cc_class;
SELECT COALESCE(customer_sales.cd_gender, customer_returns.cd_gender) AS cd_gender, SUM(total_sales) AS total_sales_amount, AVG(average_sales) AS average_sales_amount, COUNT(DISTINCT customer_sales.c_customer_sk) AS number_of_customers, SUM(total_returns) AS total_returns_amount, AVG(average_returns) AS average_returns_amount, COUNT(DISTINCT customer_returns.c_customer_sk) AS number_of_returning_customers FROM ( SELECT c_customer_sk, cd_gender, ss_sold_date_sk, SUM(ss_sales_price) AS total_sales, AVG(ss_sales_price) AS average_sales FROM customer JOIN customer_demographics ON c_current_cdemo_sk = cd_demo_sk JOIN store_sales ON ss_customer_sk = c_customer_sk JOIN date_dim ON ss_sold_date_sk = d_date_sk WHERE d_year = 2023 AND cd_gender IN ('M', 'F') GROUP BY c_customer_sk, cd_gender, ss_sold_date_sk ) AS customer_sales FULL OUTER JOIN ( SELECT c_customer_sk, cd_gender, sr_returned_date_sk, SUM(sr_return_amt) AS total_returns, AVG(sr_return_amt) AS average_returns FROM customer JOIN customer_demographics ON c_current_cdemo_sk = cd_demo_sk JOIN store_returns ON sr_customer_sk = c_customer_sk JOIN date_dim ON sr_returned_date_sk = d_date_sk WHERE d_year = 2023 AND cd_gender IN ('M', 'F') GROUP BY c_customer_sk, cd_gender, sr_returned_date_sk ) AS customer_returns ON customer_sales.c_customer_sk = customer_returns.c_customer_sk GROUP BY COALESCE(customer_sales.cd_gender, customer_returns.cd_gender);
SELECT ss.ss_item_sk AS item_sku, SUM(ss.ss_quantity) AS total_quantity_sold, SUM(ss.ss_net_paid_inc_tax) AS total_sales_inc_tax, AVG(ss.ss_ext_discount_amt) AS avg_discount_amt, COUNT(DISTINCT ss.ss_ticket_number) AS total_sales_transactions, SUM(wr.wr_return_quantity) AS total_quantity_returned, SUM(wr.wr_return_amt_inc_tax) AS total_return_amount_inc_tax, SUM(wr.wr_net_loss) AS total_net_loss_from_returns, SUM(ws.ws_net_profit) AS total_net_profit_from_web_sales FROM store_sales ss LEFT JOIN web_returns wr ON ss.ss_item_sk = wr.wr_item_sk AND ss.ss_ticket_number = wr.wr_order_number LEFT JOIN web_sales ws ON ss.ss_item_sk = ws.ws_item_sk AND ss.ss_ticket_number = ws.ws_order_number GROUP BY ss.ss_item_sk ORDER BY total_net_profit_from_web_sales DESC;
SELECT cc.cc_name, cc.cc_city, cc.cc_state, SUM(cr.cr_return_amount) AS total_return_amount, AVG(cr.cr_return_amount) AS avg_return_amount, COUNT(cr.cr_order_number) AS total_returns, SUM(cr.cr_return_quantity) AS total_returned_items, COUNT(DISTINCT cr.cr_returning_customer_sk) AS unique_returning_customers, SUM(case when hd.hd_dep_count IS NOT NULL THEN 1 ELSE 0 END) AS returns_with_dep_count, SUM(case when hd.hd_vehicle_count IS NOT NULL THEN 1 ELSE 0 END) AS returns_with_vehicle_count, COUNT(DISTINCT p.p_promo_sk) AS total_promotions_involved, SUM(p.p_cost) AS total_promotion_cost FROM call_center cc LEFT JOIN catalog_returns cr ON cc.cc_call_center_sk = cr.cr_call_center_sk LEFT JOIN household_demographics hd ON cr.cr_returning_hdemo_sk = hd.hd_demo_sk LEFT JOIN promotion p ON p.p_item_sk = cr.cr_item_sk WHERE cc.cc_company_name IN ('able', 'ought', 'cally', 'pri') AND cc.cc_hours IN ('8AM-4PM', '8AM-8AM') AND p.p_channel_tv = 'N' AND p.p_purpose = 'Unknown' AND cr.cr_refunded_cash IN ('5415.08', '1.89', '288.51', '2.49', '307.01') GROUP BY cc.cc_name, cc.cc_city, cc.cc_state ORDER BY total_return_amount DESC;
SELECT w.w_warehouse_name AS warehouse_name, w.w_city AS warehouse_city, w.w_state AS warehouse_state, ib.ib_lower_bound AS income_lower_bound, ib.ib_upper_bound AS income_upper_bound, SUM(sr.sr_return_amt) AS total_return_amount, AVG(sr.sr_return_amt) AS avg_return_amount, COUNT(sr.sr_return_amt) AS num_returns, SUM(cr.cr_return_amount) AS total_catalog_return_amount, AVG(cr.cr_return_amount) AS avg_catalog_return_amount, COUNT(cr.cr_return_amount) AS num_catalog_returns FROM store_returns sr JOIN warehouse w ON sr.sr_addr_sk = w.w_warehouse_sk JOIN household_demographics hd ON sr.sr_hdemo_sk = hd.hd_demo_sk JOIN income_band ib ON hd.hd_income_band_sk = ib.ib_income_band_sk JOIN catalog_returns cr ON sr.sr_item_sk = cr.cr_item_sk WHERE w.w_country = 'United States' AND (ib.ib_income_band_sk IN (19, 8, 15) OR sr.sr_customer_sk IN (48071, 49096)) AND sr.sr_refunded_cash IN (53.31, 1261.77, 176.73) AND w.w_warehouse_name IN ('Important issues liv', 'Bad cards must make.', 'Conventional childr', 'Doors canno') GROUP BY w.w_warehouse_name, w.w_city, w.w_state, ib.ib_lower_bound, ib.ib_upper_bound ORDER BY total_return_amount DESC;
SELECT sm.sm_type AS shipping_mode_type, sm.sm_carrier AS carrier, cp.cp_department AS catalog_department, COUNT(DISTINCT wr.wr_order_number) AS number_of_returns, SUM(wr.wr_return_quantity) AS total_returned_quantity, AVG(wr.wr_return_amt) AS average_return_amount, SUM(wr.wr_return_tax) AS total_tax, SUM(wr.wr_return_ship_cost) AS total_shipping_cost, SUM(wr.wr_net_loss) AS total_net_loss FROM web_returns wr JOIN ship_mode sm ON wr.wr_returned_date_sk = sm.sm_ship_mode_sk JOIN catalog_page cp ON wr.wr_web_page_sk = cp.cp_catalog_page_sk WHERE wr.wr_returned_date_sk = 2451368 AND cp.cp_catalog_page_sk IN ('859', '3510', '105', '4419') GROUP BY shipping_mode_type, carrier, catalog_department ORDER BY total_net_loss DESC;
SELECT cc.cc_name AS call_center_name, w.w_warehouse_name AS warehouse_name, s.s_state AS state, SUM(cs.cs_quantity) AS total_items_sold, AVG(cs.cs_sales_price) AS average_sales_price, COUNT(DISTINCT cs.cs_item_sk) AS number_of_unique_items_sold FROM catalog_sales cs INNER JOIN call_center cc ON cs.cs_call_center_sk = cc.cc_call_center_sk INNER JOIN warehouse w ON cs.cs_warehouse_sk = w.w_warehouse_sk INNER JOIN store s ON cc.cc_division = s.s_division_id WHERE cc.cc_market_manager IN ('Matthew Clifton', 'Gary Colburn') AND s.s_country = 'United States' GROUP BY call_center_name, warehouse_name, state ORDER BY total_items_sold DESC, average_sales_price DESC;
SELECT c.c_customer_id, c.c_first_name, c.c_last_name, ib.ib_income_band_sk, COUNT(sr.sr_item_sk) AS total_returns, SUM(sr.sr_return_quantity) AS total_returned_quantity, AVG(sr.sr_return_amt) AS avg_return_amount, SUM(sr.sr_return_amt_inc_tax) AS total_return_amount_inc_tax, SUM(sr.sr_net_loss) AS total_net_loss FROM customer c JOIN store_returns sr ON c.c_customer_sk = sr.sr_customer_sk JOIN income_band ib ON c.c_current_hdemo_sk = ib.ib_income_band_sk WHERE sr.sr_return_quantity > 5 AND ib.ib_lower_bound >= 120001 AND (c.c_birth_year BETWEEN 1980 AND 1990) GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, ib.ib_income_band_sk ORDER BY total_net_loss DESC, avg_return_amount DESC LIMIT 100;
SELECT cd.cd_gender, cd.cd_marital_status, cd.cd_education_status, COUNT(DISTINCT ws.ws_order_number) AS total_orders, SUM(ws.ws_quantity) AS total_quantity_sold, AVG(ws.ws_sales_price) AS average_sales_price, SUM(ws.ws_net_paid) AS total_net_paid, SUM(ws.ws_net_paid_inc_tax) AS total_net_paid_inc_tax, SUM(wr.wr_return_amt) AS total_return_amt, COUNT(DISTINCT wr.wr_order_number) AS total_returns, (SUM(ws.ws_net_paid_inc_tax) - SUM(wr.wr_return_amt_inc_tax)) AS net_sales_after_returns FROM web_sales ws LEFT JOIN web_returns wr ON ws.ws_order_number = wr.wr_order_number AND ws.ws_item_sk = wr.wr_item_sk JOIN customer_demographics cd ON ws.ws_bill_cdemo_sk = cd.cd_demo_sk WHERE ws.ws_sold_date_sk BETWEEN '2451330' AND '2451329' AND cd.cd_dep_employed_count = '0' GROUP BY cd.cd_gender, cd.cd_marital_status, cd.cd_education_status ORDER BY total_net_paid DESC, total_returns DESC;
SELECT ca.ca_state, ca.ca_city, COUNT(DISTINCT c.c_customer_sk) AS num_customers, AVG(ss.ss_sales_price) AS avg_sales_price, SUM(ss.ss_quantity) AS total_quantity_sold, SUM(ss.ss_ext_discount_amt) AS total_discount_amount, SUM(wr.wr_return_quantity) AS total_returned_quantity, AVG(wr.wr_net_loss) AS avg_net_loss, SUM(CASE WHEN r.r_reason_sk IS NOT NULL THEN 1 ELSE 0 END) AS num_returns_with_reason FROM customer c JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk JOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk LEFT JOIN web_returns wr ON wr.wr_refunded_customer_sk = c.c_customer_sk LEFT JOIN reason r ON wr.wr_reason_sk = r.r_reason_sk GROUP BY ca.ca_state, ca.ca_city HAVING COUNT(DISTINCT c.c_customer_sk) > 5 AND SUM(ss.ss_quantity) > 50 ORDER BY total_discount_amount DESC, avg_sales_price DESC LIMIT 100;
SELECT ca.ca_state, i.i_category, SUM(cs.cs_sales_price) AS total_sales, AVG(cs.cs_net_profit) AS avg_net_profit, COUNT(DISTINCT cs.cs_order_number) AS order_count FROM catalog_sales cs JOIN item i ON cs.cs_item_sk = i.i_item_sk JOIN customer_address ca ON cs.cs_ship_addr_sk = ca.ca_address_sk WHERE ca.ca_location_type = 'single family' AND i.i_brand_id IN ('9013007', '10012013', '9001003', '7015010', '7010010', '10007007') AND cs.cs_net_paid_inc_ship_tax BETWEEN 100 AND 5000 AND ca.ca_county IN ('Wahkiakum County', 'Murray County') GROUP BY ca.ca_state, i.i_category ORDER BY total_sales DESC, avg_net_profit DESC;
SELECT ca.ca_state, ib.ib_income_band_sk, COUNT(DISTINCT cs.cs_order_number) AS total_orders, SUM(cs.cs_net_paid_inc_tax) AS total_sales, AVG(cs.cs_sales_price) AS average_sales_price, SUM(ws.ws_net_paid_inc_tax) AS total_web_sales, AVG(ws.ws_sales_price) AS average_web_sales_price FROM catalog_sales cs JOIN customer_address ca ON cs.cs_ship_addr_sk = ca.ca_address_sk JOIN web_sales ws ON cs.cs_order_number = ws.ws_order_number JOIN income_band ib ON (cs.cs_bill_cdemo_sk BETWEEN ib.ib_lower_bound AND ib.ib_upper_bound) WHERE ca.ca_state IN ('CA', 'TX', 'NY', 'FL') AND ib.ib_income_band_sk IN (1, 2, 4, 8, 10) AND cs.cs_sales_price > 0 AND ws.ws_sales_price > 0 GROUP BY ca.ca_state, ib.ib_income_band_sk ORDER BY ca.ca_state, ib.ib_income_band_sk;
SELECT r.r_reason_desc, cc.cc_name AS call_center_name, cc.cc_city AS call_center_city, cc.cc_state AS call_center_state, SUM(cr.cr_return_amount) AS total_return_amount, AVG(cr.cr_return_amount) AS avg_return_amount, COUNT(cr.cr_order_number) AS total_returns, SUM(cr.cr_return_quantity) AS total_returned_items, SUM(cr.cr_fee) AS total_fees_collected, SUM(cr.cr_store_credit) AS total_store_credit_issued, SUM(cr.cr_net_loss) AS total_net_loss FROM catalog_returns cr JOIN call_center cc ON cr.cr_call_center_sk = cc.cc_call_center_sk JOIN reason r ON cr.cr_reason_sk = r.r_reason_sk WHERE cr.cr_returned_date_sk BETWEEN 20000101 AND 20001231 AND cr.cr_returning_hdemo_sk IN (5491, 6517, 636, 7063, 3950, 2509) GROUP BY r.r_reason_desc, cc.cc_name, cc.cc_city, cc.cc_state ORDER BY total_return_amount DESC, total_returns DESC;
SELECT cp_department, i_category, AVG(i_current_price) AS average_price, SUM(i_wholesale_cost) AS total_wholesale_cost, COUNT(DISTINCT i_item_sk) AS item_count, COUNT(DISTINCT cp_catalog_page_sk) AS page_count, AVG(ib_upper_bound - ib_lower_bound) AS average_income_band_range FROM catalog_page JOIN item ON cp_catalog_page_id = i_item_id JOIN income_band ON i_size::integer = ib_income_band_sk WHERE cp_start_date_sk IS NOT NULL AND cp_end_date_sk IS NOT NULL AND i_rec_start_date <= CURRENT_DATE AND (i_rec_end_date IS NULL OR i_rec_end_date >= CURRENT_DATE) AND ib_lower_bound >= 20000 AND cp_department IN ('Electronics', 'Clothing', 'Home Goods') GROUP BY cp_department, i_category ORDER BY average_price DESC, total_wholesale_cost DESC;
SELECT cc.cc_name, cc.cc_city, cc.cc_state, ib.ib_income_band_sk, COUNT(DISTINCT ws.ws_order_number) AS total_orders, SUM(ws.ws_quantity) AS total_quantity_sold, SUM(ws.ws_net_paid) AS total_net_paid, AVG(ws.ws_net_profit) AS average_net_profit, SUM(ws.ws_net_paid_inc_tax) AS total_net_paid_inc_tax, SUM(ws.ws_net_paid_inc_ship) AS total_net_paid_inc_ship, SUM(ws.ws_net_paid_inc_ship_tax) AS total_net_paid_inc_ship_tax FROM call_center cc JOIN web_sales ws ON cc.cc_call_center_sk = ws.ws_web_site_sk JOIN income_band ib ON ws.ws_bill_cdemo_sk = ib.ib_income_band_sk WHERE cc.cc_rec_end_date > CURRENT_DATE AND ib.ib_lower_bound > 50000 AND ib.ib_upper_bound < 180000 AND ws.ws_list_price BETWEEN 100 AND 200 GROUP BY cc.cc_name, cc.cc_city, cc.cc_state, ib.ib_income_band_sk ORDER BY total_net_paid DESC, cc.cc_state, cc.cc_city;
SELECT s_state, i_category, COUNT(DISTINCT i_item_sk) AS num_items, SUM(i_current_price) AS total_current_price, AVG(i_wholesale_cost) AS avg_wholesale_cost, COUNT(DISTINCT w_warehouse_sk) AS num_warehouses, SUM(w_warehouse_sq_ft) AS total_warehouse_sq_ft, COUNT(DISTINCT wp_web_page_sk) AS num_web_pages, AVG(wp_char_count) AS avg_char_count_on_web_pages FROM store JOIN item ON (s_store_sk = i_manufact_id) JOIN warehouse ON (s_zip = w_zip) JOIN web_page ON (wp_access_date_sk = '2452583' OR wp_access_date_sk = '2452565' OR wp_access_date_sk = '2452618') WHERE s_state IN ('CA', 'TX', 'NY') AND i_category IN ('Electronics', 'Clothing', 'Furniture') GROUP BY s_state, i_category ORDER BY s_state, i_category;
SELECT i.i_category, i.i_class, call_center.cc_name, SUM(cr.cr_return_amount) AS total_return_amount, AVG(cr.cr_return_quantity) AS avg_return_quantity, COUNT(DISTINCT cr.cr_order_number) AS total_returned_orders, MAX(i.i_current_price) AS max_item_price FROM catalog_returns cr JOIN call_center ON cr.cr_call_center_sk = call_center.cc_call_center_sk JOIN item i ON cr.cr_item_sk = i.i_item_sk WHERE i.i_manufact = 'barcallycally' GROUP BY i.i_category, i.i_class, call_center.cc_name ORDER BY total_return_amount DESC, i.i_category, i.i_class, call_center.cc_name;
SELECT c.c_birth_month, COUNT(DISTINCT ss.ss_customer_sk) AS total_customers_made_purchase, SUM(ss.ss_net_paid) AS total_sales, AVG(ss.ss_sales_price) AS avg_sale_amount, COUNT(DISTINCT cr.cr_returning_customer_sk) AS total_customers_made_return, SUM(cr.cr_return_amount) AS total_returns, AVG(cr.cr_return_amount) AS avg_return_amount FROM customer c LEFT JOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk LEFT JOIN catalog_returns cr ON c.c_customer_sk = cr.cr_returning_customer_sk LEFT JOIN catalog_page cp ON cr.cr_catalog_page_sk = cp.cp_catalog_page_sk AND cp.cp_catalog_page_number = 104 LEFT JOIN web_returns wr ON c.c_customer_sk = wr.wr_returning_customer_sk LEFT JOIN web_site ws ON wr.wr_web_page_sk = ws.web_site_sk AND ws.web_open_date_sk = 2450628 WHERE c.c_birth_month IN (5, 6, 11) GROUP BY c.c_birth_month ORDER BY c.c_birth_month;
SELECT d.d_year, d.d_quarter_name, s.s_state, sm.sm_type, COUNT(DISTINCT cs.cs_order_number) AS total_orders, SUM(cs.cs_quantity) AS total_quantity_sold, SUM(cs.cs_net_paid) AS total_revenue, AVG(cs.cs_sales_price) AS average_sales_price, SUM(cs.cs_net_profit) AS total_profit FROM catalog_sales cs JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk JOIN store s ON cs.cs_ship_addr_sk = s.s_store_sk JOIN ship_mode sm ON cs.cs_ship_mode_sk = sm.sm_ship_mode_sk WHERE d.d_year = (SELECT MAX(d_year) FROM date_dim) - 1 AND s.s_rec_end_date IS NULL GROUP BY d.d_year, d.d_quarter_name, s.s_state, sm.sm_type ORDER BY d.d_year, d.d_quarter_name, s.s_state, sm.sm_type;
SELECT ws.ws_web_site_sk, web.web_name, web.web_class, cd.cd_gender, cd.cd_marital_status, cd.cd_education_status, SUM(ws.ws_quantity) as total_quantity_sold, AVG(ws.ws_sales_price) as average_sales_price, COUNT(DISTINCT ws.ws_order_number) as total_orders, SUM(ws.ws_net_paid) as total_net_paid, SUM(ws.ws_net_paid_inc_tax) as total_net_paid_inc_tax, SUM(ws.ws_net_profit) as total_net_profit FROM web_sales ws JOIN web_site web ON ws.ws_web_site_sk = web.web_site_sk JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk JOIN promotion p ON ws.ws_promo_sk = p.p_promo_sk AND p.p_response_target = '1' WHERE p.p_start_date_sk IN (2451635, 2451362, 2451818, 2451605, 2451420, 2451665) GROUP BY ws.ws_web_site_sk, web.web_name, web.web_class, cd.cd_gender, cd.cd_marital_status, cd.cd_education_status ORDER BY total_net_profit DESC, web.web_name, cd.cd_gender, cd.cd_marital_status, cd.cd_education_status;
SELECT st.s_store_name AS store_name, SUM(sales.ss_net_paid) AS total_sales, AVG(sales.ss_quantity) AS average_quantity_sold, COUNT(DISTINCT customer.c_customer_sk) AS unique_customers, cd.cd_education_status AS education_status, cd.cd_gender AS gender, COUNT(promo.p_promo_sk) AS promotion_count, AVG(promo.p_cost) AS average_promotion_cost FROM store_sales sales JOIN store st ON sales.ss_store_sk = st.s_store_sk JOIN customer ON sales.ss_customer_sk = customer.c_customer_sk JOIN customer_demographics cd ON customer.c_current_cdemo_sk = cd.cd_demo_sk JOIN promotion promo ON sales.ss_promo_sk = promo.p_promo_sk WHERE st.s_hours IN ('8AM-12AM', '8AM-4PM') AND cd.cd_education_status IN ('Unknown', 'Advanced Degree', '2 yr Degree', 'College') AND cd.cd_gender IN ('M', 'F') AND sales.ss_sold_date_sk BETWEEN promo.p_start_date_sk AND promo.p_end_date_sk GROUP BY st.s_store_name, cd.cd_education_status, cd.cd_gender ORDER BY total_sales DESC, average_quantity_sold DESC;
