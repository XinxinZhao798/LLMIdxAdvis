SELECT c.c_birth_month, COUNT(DISTINCT ss.ss_customer_sk) AS total_customers_made_purchase, SUM(ss.ss_net_paid) AS total_sales, AVG(ss.ss_sales_price) AS avg_sale_amount, COUNT(DISTINCT cr.cr_returning_customer_sk) AS total_customers_made_return, SUM(cr.cr_return_amount) AS total_returns, AVG(cr.cr_return_amount) AS avg_return_amount FROM customer c LEFT JOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk LEFT JOIN catalog_returns cr ON c.c_customer_sk = cr.cr_returning_customer_sk LEFT JOIN catalog_page cp ON cr.cr_catalog_page_sk = cp.cp_catalog_page_sk AND cp.cp_catalog_page_number = 104 LEFT JOIN web_returns wr ON c.c_customer_sk = wr.wr_returning_customer_sk LEFT JOIN web_site ws ON wr.wr_web_page_sk = ws.web_site_sk AND ws.web_open_date_sk = 2450628 WHERE c.c_birth_month IN (5, 6, 11) GROUP BY c.c_birth_month ORDER BY c.c_birth_month;
SELECT p_promo_name, SUM(cs_quantity) AS total_quantity_sold, SUM(cs_net_paid) AS total_revenue, AVG(cs_sales_price) AS average_sales_price, COUNT(DISTINCT cs_order_number) AS total_orders, SUM(cr_return_quantity) AS total_quantity_returned, SUM(cr_return_amount) AS total_returns, AVG(sr_return_amt) AS average_return_amount, COUNT(DISTINCT sr_ticket_number) AS total_return_tickets FROM catalog_sales JOIN promotion ON cs_promo_sk = p_promo_sk AND p_channel_tv = 'N' LEFT JOIN catalog_returns ON cs_item_sk = cr_item_sk AND cs_order_number = cr_order_number LEFT JOIN store_returns ON cs_item_sk = sr_item_sk AND sr_store_sk IN ('8', '2', '10', '4') WHERE cs_ship_date_sk = 2450936 GROUP BY p_promo_name ORDER BY total_revenue DESC;
SELECT ca.ca_state, SUM(ss.ss_quantity) AS total_quantity_sold, AVG(ss.ss_sales_price) AS avg_sales_price, SUM(ss.ss_net_paid) AS total_net_paid, SUM(ss.ss_net_profit) AS total_net_profit, COUNT(DISTINCT ss.ss_ticket_number) AS total_sales_transactions, SUM(CASE WHEN p.p_channel_event = 'N' THEN ss.ss_quantity ELSE 0 END) AS quantity_sold_no_event_channel, SUM(CASE WHEN p.p_channel_email = 'N' THEN ss.ss_quantity ELSE 0 END) AS quantity_sold_no_email_channel, COUNT(DISTINCT i.inv_warehouse_sk) AS distinct_warehouses_stocked, AVG(i.inv_quantity_on_hand) AS avg_quantity_on_hand FROM store_sales ss JOIN customer_address ca ON ss.ss_addr_sk = ca.ca_address_sk LEFT JOIN promotion p ON ss.ss_promo_sk = p.p_promo_sk LEFT JOIN inventory i ON ss.ss_item_sk = i.inv_item_sk WHERE i.inv_warehouse_sk IN (1, 2) AND i.inv_date_sk = 2450815 GROUP BY ca.ca_state ORDER BY total_net_profit DESC, ca.ca_state;
SELECT ib.ib_lower_bound, ib.ib_upper_bound, sm.sm_type, COUNT(DISTINCT cp.cp_catalog_page_sk) AS total_catalog_pages, MIN(cp.cp_catalog_number) AS min_catalog_number, MAX(cp.cp_catalog_number) AS max_catalog_number, COUNT(DISTINCT sm.sm_ship_mode_sk) AS total_ship_modes FROM income_band ib CROSS JOIN ship_mode sm LEFT JOIN catalog_page cp ON cp.cp_department = 'Books' WHERE sm.sm_type IN ('LIBRARY', 'REGULAR') GROUP BY ib.ib_lower_bound, ib.ib_upper_bound, sm.sm_type ORDER BY ib.ib_lower_bound, sm.sm_type;
SELECT i_category, i_brand, COUNT(DISTINCT i_item_sk) AS total_items, SUM(i_current_price) AS total_sales_value, AVG(i_wholesale_cost) AS average_wholesale_cost FROM item WHERE i_units IN ('Dozen', 'Bundle', 'Lb') AND i_manufact IN ('eseantieing', 'ableablepri') GROUP BY i_category, i_brand ORDER BY total_sales_value DESC LIMIT 100;
SELECT d_year, i_category, sm_type, COUNT(*) AS total_shipments, SUM(i_current_price * i_wholesale_cost) AS revenue, AVG(i_current_price) AS avg_price, AVG(i_wholesale_cost) AS avg_cost FROM date_dim, item, ship_mode, income_band WHERE i_rec_start_date <= d_date AND (i_rec_end_date IS NULL OR i_rec_end_date >= d_date) AND sm_ship_mode_sk IN (SELECT sm_ship_mode_sk FROM ship_mode WHERE sm_type = 'AIR' OR sm_type = 'GROUND') AND ib_income_band_sk IN (4, 15, 3, 18) AND ib_upper_bound IN (200000, 50000) GROUP BY d_year, i_category, sm_type ORDER BY revenue DESC, d_year, i_category;
SELECT dd.d_year, dd.d_quarter_name, COUNT(DISTINCT cr.cr_order_number) AS catalog_return_orders, SUM(cr.cr_return_quantity) AS total_catalog_returned_qty, AVG(cr.cr_return_amount) AS avg_catalog_return_amount, SUM(cr.cr_net_loss) AS total_catalog_net_loss, COUNT(DISTINCT wr.wr_order_number) AS web_return_orders, SUM(wr.wr_return_quantity) AS total_web_returned_qty, AVG(wr.wr_return_amt) AS avg_web_return_amount, SUM(wr.wr_net_loss) AS total_web_net_loss, COUNT(DISTINCT h.hd_demo_sk) AS unique_households_affected, SUM(CASE WHEN i.i_rec_end_date = '2001-10-26' THEN cr.cr_return_quantity ELSE 0 END) AS qty_items_end_date_oct26 FROM date_dim dd LEFT JOIN catalog_returns cr ON dd.d_date_sk = cr.cr_returned_date_sk LEFT JOIN web_returns wr ON dd.d_date_sk = wr.wr_returned_date_sk LEFT JOIN item i ON cr.cr_item_sk = i.i_item_sk OR wr.wr_item_sk = i.i_item_sk LEFT JOIN household_demographics h ON cr.cr_returning_hdemo_sk = h.hd_demo_sk OR wr.wr_returning_hdemo_sk = h.hd_demo_sk WHERE dd.d_date IS NOT NULL AND (cr.cr_return_amount > 0 OR wr.wr_return_amt > 0) AND (cr.cr_reason_sk = 28 OR wr.wr_reason_sk = 28) GROUP BY dd.d_year, dd.d_quarter_name ORDER BY dd.d_year, dd.d_quarter_name;
SELECT sm.sm_code AS shipping_mode, s.s_store_name AS store_name, cc.cc_name AS call_center_name, COUNT(cr.cr_order_number) AS total_returns, SUM(cr.cr_return_amount) AS total_return_amount, AVG(cr.cr_return_quantity) AS avg_return_quantity, COUNT(DISTINCT cr.cr_refunded_customer_sk) AS unique_customers, COUNT(DISTINCT ws.ws_order_number) AS total_web_sales_orders, SUM(ws.ws_net_profit) AS total_web_sales_profit FROM catalog_returns cr JOIN call_center cc ON cr.cr_call_center_sk = cc.cc_call_center_sk JOIN ship_mode sm ON cr.cr_ship_mode_sk = sm.sm_ship_mode_sk JOIN store s ON cc.cc_division = s.s_division_id JOIN web_sales ws ON cr.cr_item_sk = ws.ws_item_sk AND cr.cr_order_number = ws.ws_order_number WHERE cr.cr_returned_date_sk BETWEEN 2450952 AND 2451063 AND sm.sm_code IN ('SEA', 'BIKE', 'AIR', 'SURFACE') AND s.s_hours IN ('8AM-12AM', '8AM-4PM') GROUP BY shipping_mode, store_name, call_center_name ORDER BY total_returns DESC, total_return_amount DESC;
SELECT w.web_class AS website_category, ca.ca_state AS customer_state, COUNT(ws.ws_order_number) AS total_orders, SUM(ws.ws_net_paid_inc_ship_tax) AS total_sales, AVG(ws.ws_ext_discount_amt) AS avg_discount_amount, AVG(ws.ws_net_profit) AS avg_net_profit FROM web_sales ws JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk JOIN customer_address ca ON ws.ws_ship_addr_sk = ca.ca_address_sk WHERE ws.ws_net_paid_inc_ship BETWEEN 500 AND 9500 GROUP BY ROLLUP(website_category, customer_state) ORDER BY total_sales DESC, website_category, customer_state;
SELECT cc.cc_name, COUNT(DISTINCT cs.cs_order_number) AS total_orders, SUM(cs.cs_quantity) AS total_quantity_sold, SUM(cs.cs_net_paid) AS total_net_paid, AVG(cs.cs_net_paid) AS avg_net_paid_per_order, SUM(cs.cs_net_profit) AS total_net_profit, AVG(cs.cs_net_profit) AS avg_net_profit_per_order, p.p_promo_name, COUNT(DISTINCT p.p_promo_sk) FILTER (WHERE cs.cs_promo_sk IS NOT NULL) AS promo_count, cd.cd_gender, COUNT(DISTINCT cd.cd_demo_sk) FILTER (WHERE cd.cd_gender = 'M') AS male_customers, COUNT(DISTINCT cd.cd_demo_sk) FILTER (WHERE cd.cd_gender = 'F') AS female_customers FROM call_center cc LEFT JOIN catalog_sales cs ON cc.cc_call_center_sk = cs.cs_call_center_sk LEFT JOIN promotion p ON cs.cs_promo_sk = p.p_promo_sk LEFT JOIN customer_demographics cd ON cs.cs_bill_cdemo_sk = cd.cd_demo_sk GROUP BY cc.cc_name, p.p_promo_name, cd.cd_gender ORDER BY total_net_paid DESC, total_net_profit DESC;
SELECT s.s_store_name, ca.ca_city, cd.cd_marital_status, SUM(ss.ss_quantity) AS total_quantity_sold, AVG(ss.ss_sales_price) AS average_sales_price, COUNT(DISTINCT ss.ss_customer_sk) AS unique_customers, SUM(cr.cr_return_quantity) AS total_quantity_returned, AVG(cr.cr_return_amount) AS average_return_amount, SUM(cr.cr_fee) AS total_return_fees, SUM(cr.cr_store_credit) AS total_store_credit_issued FROM store_sales ss JOIN store s ON ss.ss_store_sk = s.s_store_sk JOIN customer_address ca ON ss.ss_addr_sk = ca.ca_address_sk JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk LEFT JOIN catalog_returns cr ON ss.ss_item_sk = cr.cr_item_sk AND ss.ss_ticket_number = cr.cr_order_number WHERE s.s_company_id = '1' AND s.s_number_employees IN ('271', '297', '218') AND cr.cr_fee IN ('1.88', '20.33', '98.78') AND cr.cr_store_credit IN ('209.99', '238.11', '154.49') AND cr.cr_returning_addr_sk IN ('12346', '30572', '1273') AND ca.ca_street_number IN ('667', '111', '746') AND ca.ca_street_type IN ('Street', 'Dr.', 'Way') AND ca.ca_street_name IN ('Maple 5th', 'Walnut Lee', 'Ash Oak') AND ca.ca_city IN ('Fairview', 'Calhoun', 'Sullivan') AND cd.cd_purchase_estimate IN ('8500', '5000', '6500') AND cd.cd_marital_status IN ('U', 'M', 'D') AND ss.ss_hdemo_sk IN ('2140', '4187', '6514') AND ss.ss_ticket_number IN ('3439', '3527', '3698') GROUP BY s.s_store_name, ca.ca_city, cd.cd_marital_status ORDER BY total_quantity_sold DESC, average_sales_price DESC, unique_customers DESC, total_quantity_returned DESC, average_return_amount DESC, total_return_fees DESC, total_store_credit_issued DESC;
SELECT cd.cd_gender, cd.cd_marital_status, cd.cd_education_status, cd.cd_credit_rating, SUM(ss.ss_quantity) AS total_quantity_sold, AVG(ss.ss_sales_price) AS average_sales_price, COUNT(DISTINCT ss.ss_ticket_number) AS total_tickets, SUM(ss.ss_net_profit) AS total_net_profit FROM store_sales ss JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk JOIN promotion p ON ss.ss_promo_sk = p.p_promo_sk JOIN time_dim t ON ss.ss_sold_time_sk = t.t_time_sk JOIN ship_mode sm ON sm.sm_ship_mode_sk = ss.ss_promo_sk JOIN income_band ib ON ib.ib_income_band_sk = cd.cd_demo_sk WHERE sm.sm_contract IN ('ldhM8IvpzHgdbBgDfI', 'qENFQ', '6Hzzp4JkzjqD8MGXLCDa', 'uukTktPYycct8') AND t.t_hour IN (1, 0) AND ib.ib_upper_bound <= 10000 AND ib.ib_income_band_sk IN (18, 2, 4, 16, 13, 9) AND cd.cd_credit_rating IN ('High Risk', 'Low Risk', 'Good', 'Unknown') AND cd.cd_marital_status IN ('D', 'M', 'W', 'U') GROUP BY cd.cd_gender, cd.cd_marital_status, cd.cd_education_status, cd.cd_credit_rating ORDER BY total_net_profit DESC, total_tickets DESC;
SELECT ca.ca_country, COUNT(DISTINCT cp.cp_catalog_page_sk) AS total_catalog_pages, COUNT(DISTINCT p.p_promo_sk) AS total_promotions, SUM(p.p_cost) AS total_promotion_cost, AVG(p.p_response_target) AS average_promotion_response_target, SUM(sr.sr_return_amt_inc_tax) AS total_returns_inc_tax, AVG(sr.sr_return_amt_inc_tax) AS average_return_inc_tax, SUM(sr.sr_net_loss) AS total_net_loss, COUNT(DISTINCT sr.sr_returned_date_sk) AS days_with_returns FROM promotion p JOIN catalog_page cp ON cp.cp_start_date_sk <= p.p_end_date_sk AND cp.cp_end_date_sk >= p.p_start_date_sk JOIN store_returns sr ON sr.sr_reason_sk = p.p_promo_sk JOIN customer_address ca ON sr.sr_addr_sk = ca.ca_address_sk WHERE ca.ca_country = 'United States' AND p.p_end_date_sk IN ('2450816', '2450904', '2450773') AND p.p_purpose <> 'Unknown' AND cp.cp_end_date_sk IN ('2450964', '2451419', '2451664') GROUP BY ca.ca_country ORDER BY total_returns_inc_tax DESC;
SELECT ca.ca_state, i.i_category, COUNT(cs.cs_order_number) AS total_orders, SUM(cs.cs_ext_sales_price) AS total_sales, AVG(cs.cs_sales_price) AS avg_sales_price, SUM(inv.inv_quantity_on_hand) AS total_inventory FROM catalog_sales cs JOIN customer_address ca ON cs.cs_ship_addr_sk = ca.ca_address_sk JOIN item i ON cs.cs_item_sk = i.i_item_sk JOIN inventory inv ON i.i_item_sk = inv.inv_item_sk AND cs.cs_sold_date_sk = inv.inv_date_sk WHERE cs.cs_wholesale_cost != 26.15 AND i.i_item_sk IN (2, 27, 23, 43, 36, 38) AND inv.inv_date_sk = 2450815 GROUP BY ca.ca_state, i.i_category ORDER BY total_sales DESC, ca.ca_state, i.i_category;
SELECT cp.cp_department, r.r_reason_desc, COUNT(DISTINCT cr.cr_order_number) AS total_returns, AVG(cr.cr_return_amount) AS avg_return_amount, SUM(cr.cr_return_amount) AS total_return_amount, AVG(cr.cr_return_quantity) AS avg_return_quantity, SUM(cr.cr_return_quantity) AS total_return_quantity, AVG(cr.cr_net_loss) AS avg_net_loss, SUM(cr.cr_net_loss) AS total_net_loss, AVG(ws.ws_net_paid_inc_ship_tax) AS avg_sale_amount_inc_ship_tax, SUM(ws.ws_net_paid_inc_ship_tax) AS total_sale_amount_inc_ship_tax FROM catalog_returns cr JOIN catalog_page cp ON cr.cr_catalog_page_sk = cp.cp_catalog_page_sk JOIN reason r ON cr.cr_reason_sk = r.r_reason_sk JOIN item i ON cr.cr_item_sk = i.i_item_sk JOIN web_sales ws ON cr.cr_item_sk = ws.ws_item_sk AND cr.cr_order_number = ws.ws_order_number JOIN household_demographics hd ON cr.cr_returning_hdemo_sk = hd.hd_demo_sk WHERE cp.cp_start_date_sk IS NOT NULL AND cp.cp_end_date_sk IS NOT NULL AND i.i_size IN ('large', 'petite', 'N/A') AND hd.hd_dep_count IN (6, 2, 0) AND hd.hd_income_band_sk IN (15, 14, 17, 18, 8) AND cr.cr_return_ship_cost IN (1215.68, 5.50, 311.58, 319.00, 3656.16, 1740.04) AND ws.ws_net_paid_inc_ship_tax = 1414.78 AND i.i_formulation IN ('ivory457370549352452', '77416linen1913860202', '32linen2899537977429', '61439655670steel4120') GROUP BY cp.cp_department, r.r_reason_desc ORDER BY total_return_amount DESC, avg_return_amount DESC, total_returns DESC;
SELECT s.s_division_id AS store_division_id, s.s_division_name AS store_division_name, hd.hd_income_band_sk AS household_income_band, COUNT(DISTINCT ws.ws_order_number) AS total_web_sales, AVG(ws.ws_sales_price) AS average_sales_price, COUNT(DISTINCT sr.sr_ticket_number) AS total_store_returns, AVG(sr.sr_return_amt) AS average_return_amount FROM store s LEFT JOIN web_sales ws ON s.s_store_sk = ws.ws_ship_customer_sk LEFT JOIN store_returns sr ON s.s_store_sk = sr.sr_store_sk LEFT JOIN household_demographics hd ON (ws.ws_ship_hdemo_sk = hd.hd_demo_sk OR sr.sr_hdemo_sk = hd.hd_demo_sk) WHERE ws.ws_order_number IS NOT NULL OR sr.sr_ticket_number IS NOT NULL GROUP BY s.s_division_id, s.s_division_name, hd.hd_income_band_sk ORDER BY s.s_division_id, hd.hd_income_band_sk;
SELECT d_year, d_month_seq, COUNT(wp_web_page_sk) AS total_web_pages, AVG(wp_char_count) AS avg_char_count, SUM(wp_link_count) AS total_links, AVG(wp_image_count) AS avg_image_count, MAX(wp_max_ad_count) AS max_ad_count FROM web_page JOIN date_dim ON wp_access_date_sk = d_date_sk GROUP BY d_year, d_month_seq ORDER BY d_year, d_month_seq;
SELECT i.i_category, cc.cc_mkt_class, SUM(cs.cs_net_paid) AS total_sales, AVG(cs.cs_sales_price) AS avg_sales_price, SUM(cs.cs_quantity) AS total_quantity_sold, AVG(cs.cs_wholesale_cost) AS avg_wholesale_cost FROM catalog_sales cs JOIN item i ON cs.cs_item_sk = i.i_item_sk JOIN call_center cc ON cs.cs_call_center_sk = cc.cc_call_center_sk WHERE cc.cc_name IN ('North Midwest', 'Mid Atlantic') AND i.i_class_id IN (3, 5, 12, 10) AND i.i_rec_start_date = '2001-10-27' GROUP BY i.i_category, cc.cc_mkt_class ORDER BY i.i_category, cc.cc_mkt_class;
SELECT ca_state, r_reason_desc, COUNT(*) AS return_count, SUM(sr_return_amt) AS total_return_amount, AVG(sr_return_quantity) AS average_quantity_returned, SUM(sr_return_amt_inc_tax) AS total_amount_including_tax, SUM(sr_fee) AS total_fees, SUM(sr_return_ship_cost) AS total_shipping_costs, SUM(sr_refunded_cash) AS total_cash_refunded, SUM(sr_reversed_charge) AS total_reversed_charges, SUM(sr_store_credit) AS total_store_credit_issued, SUM(sr_net_loss) AS total_net_loss FROM store_returns JOIN reason ON store_returns.sr_reason_sk = reason.r_reason_sk JOIN customer_address ON store_returns.sr_addr_sk = customer_address.ca_address_sk WHERE (sr_reason_sk IN (13, 15, 26, 31, 21, 27)) AND (sr_reversed_charge IN (269.66, 29.95, 131.41, 123.32, 10.07, 1.54)) AND (sr_item_sk IN (6759, 10097, 13141, 10841, 4022)) GROUP BY ca_state, r_reason_desc ORDER BY ca_state, total_return_amount DESC;
SELECT w.w_state, t.t_shift, s.s_geography_class, COUNT(ss.ss_ticket_number) AS total_sales_transactions, SUM(ss.ss_quantity) AS total_items_sold, AVG(ss.ss_sales_price) AS average_sales_price, SUM(ss.ss_coupon_amt) AS total_coupon_amount, SUM(wr.wr_return_quantity) AS total_returned_items, AVG(wr.wr_fee) AS average_return_fee, SUM(wr.wr_net_loss) AS total_net_loss FROM store_sales ss JOIN store s ON ss.ss_store_sk = s.s_store_sk JOIN time_dim t ON ss.ss_sold_time_sk = t.t_time_sk JOIN warehouse w ON s.s_state = w.w_state LEFT JOIN web_returns wr ON ss.ss_item_sk = wr.wr_item_sk AND ss.ss_ticket_number = wr.wr_order_number WHERE w.w_state = 'TN' AND t.t_am_pm = 'AM' AND s.s_geography_class = 'Unknown' AND ( ss.ss_coupon_amt = 449.88 OR ss.ss_coupon_amt = 3399.87 OR ss.ss_coupon_amt = 28.33 OR ss.ss_coupon_amt = 434.01 OR ss.ss_coupon_amt = 1885.51 ) GROUP BY w.w_state, t.t_shift, s.s_geography_class;
SELECT cp_department, COUNT(DISTINCT cs_order_number) AS total_orders, SUM(cs_quantity) AS total_quantity_sold, AVG(cs_sales_price) AS average_sales_price, SUM(cs_net_paid) AS total_net_paid, SUM(cs_net_profit) AS total_net_profit, COUNT(DISTINCT ss_ticket_number) AS total_store_sales_tickets, SUM(ss_quantity) AS total_store_quantity_sold, AVG(ss_sales_price) AS average_store_sales_price, SUM(ss_net_paid_inc_tax) AS total_store_net_paid_inc_tax FROM catalog_sales JOIN catalog_page ON cs_catalog_page_sk = cp_catalog_page_sk JOIN store_sales ON catalog_sales.cs_item_sk = store_sales.ss_item_sk JOIN store ON store_sales.ss_store_sk = s_store_sk JOIN customer ON store_sales.ss_customer_sk = c_customer_sk WHERE c_birth_country IN ('MOLDOVA, REPUBLIC OF', 'TOGO', 'IRAQ', 'BURUNDI') AND cp_department IS NOT NULL AND cp_start_date_sk IS NOT NULL AND cp_end_date_sk IS NOT NULL AND (cp_end_date_sk - cp_start_date_sk) > 0 AND s_market_id IS NOT NULL GROUP BY cp_department ORDER BY total_net_profit DESC, total_orders DESC LIMIT 10;
SELECT i.i_category, SUM(ss.ss_quantity) AS total_quantity_sold, AVG(ss.ss_sales_price) AS average_sales_price, COUNT(DISTINCT ss.ss_ticket_number) AS number_of_sales_transactions, SUM(inv.inv_quantity_on_hand) AS total_inventory_on_hand, SUM(ss.ss_net_profit) AS total_net_profit FROM item i JOIN store_sales ss ON i.i_item_sk = ss.ss_item_sk JOIN inventory inv ON i.i_item_sk = inv.inv_item_sk JOIN time_dim t ON ss.ss_sold_time_sk = t.t_time_sk WHERE i.i_wholesale_cost BETWEEN 4 AND 7 AND inv.inv_date_sk = '2450815' AND ss.ss_ext_sales_price < 5000 AND t.t_hour BETWEEN 0 AND 1 GROUP BY i.i_category ORDER BY total_net_profit DESC;
SELECT cc.cc_call_center_id, cc.cc_name, cc.cc_city, cc.cc_state, r.r_reason_desc, COUNT(cr.cr_order_number) AS total_returns, SUM(cr.cr_return_quantity) AS total_returned_items, AVG(cr.cr_return_amount) AS avg_return_amount, SUM(cr.cr_return_tax) AS total_tax, SUM(cr.cr_return_ship_cost) AS total_ship_cost, SUM(cr.cr_net_loss) AS total_net_loss FROM call_center cc JOIN catalog_returns cr ON cc.cc_call_center_sk = cr.cr_call_center_sk JOIN reason r ON cr.cr_reason_sk = r.r_reason_sk WHERE cc.cc_zip = '31904' AND cr.cr_return_amt_inc_tax > 0 AND r.r_reason_desc IN ('Found a better price in a store', 'its is a boy') GROUP BY cc.cc_call_center_id, cc.cc_name, cc.cc_city, cc.cc_state, r.r_reason_desc ORDER BY total_returns DESC, total_returned_items DESC;
SELECT cc.cc_state, AVG(cc.cc_employees) AS avg_employees, SUM(cc.cc_sq_ft) AS total_sq_ft, COUNT(DISTINCT hd.hd_demo_sk) AS households_with_buy_potential, SUM(CASE WHEN p.p_discount_active = 'Y' THEN p.p_cost ELSE 0 END) AS total_active_promo_cost FROM call_center cc LEFT JOIN household_demographics hd ON hd.hd_income_band_sk IN (5, 1, 17, 14) AND hd.hd_buy_potential IS NOT NULL LEFT JOIN promotion p ON p.p_discount_active = 'Y' AND p.p_channel_press = 'N' WHERE cc.cc_state = 'TN' GROUP BY cc.cc_state;
SELECT cp.cp_department, COUNT(*) AS total_pages, AVG(wp.wp_link_count) AS average_link_count, SUM(wp.wp_image_count) AS total_image_count, COUNT(DISTINCT hd.hd_demo_sk) AS unique_households, AVG(hd.hd_vehicle_count) AS average_vehicle_count FROM catalog_page cp JOIN web_page wp ON cp.cp_catalog_page_sk = wp.wp_customer_sk JOIN household_demographics hd ON wp.wp_customer_sk = hd.hd_demo_sk WHERE cp.cp_catalog_number IN (29, 27, 21, 36) AND wp.wp_autogen_flag = 'Y' AND wp.wp_url LIKE 'http://www.foo.com%' GROUP BY cp.cp_department ORDER BY total_pages DESC, average_link_count DESC;
