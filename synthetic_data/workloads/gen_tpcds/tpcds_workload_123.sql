SELECT dd.d_year, dd.d_quarter_name, SUM(cs.cs_net_paid_inc_ship_tax) AS total_sales, AVG(cs.cs_net_paid_inc_ship_tax) AS avg_sales, COUNT(*) AS number_of_sales, SUM(cr.cr_return_amt_inc_tax) AS total_returns, AVG(cr.cr_return_amt_inc_tax) AS avg_returns, COUNT(cr.cr_order_number) AS number_of_returns, SUM(hd.hd_dep_count) AS total_dependants, AVG(w.w_warehouse_sq_ft) AS avg_warehouse_size FROM date_dim dd LEFT JOIN catalog_sales cs ON dd.d_date_sk = cs.cs_sold_date_sk LEFT JOIN catalog_returns cr ON dd.d_date_sk = cr.cr_returned_date_sk LEFT JOIN household_demographics hd ON cs.cs_bill_hdemo_sk = hd.hd_demo_sk LEFT JOIN warehouse w ON cs.cs_warehouse_sk = w.w_warehouse_sk WHERE dd.d_year = 1999 AND (cs.cs_net_paid_inc_ship_tax > 1000 OR cr.cr_return_amt_inc_tax > 100) AND hd.hd_buy_potential = '1001-5000' AND hd.hd_dep_count BETWEEN 4 AND 9 AND cr.cr_ship_mode_sk IN (4, 7) GROUP BY dd.d_year, dd.d_quarter_name ORDER BY dd.d_year, dd.d_quarter_name;
SELECT i_category, i_class, w_city, p_promo_name, SUM(ws_quantity) AS total_quantity_sold, AVG(ws_sales_price) AS average_sales_price, SUM(ws_net_paid) AS total_net_paid, SUM(ws_net_paid_inc_tax) AS total_net_paid_inc_tax, COUNT(DISTINCT ws_order_number) AS total_orders, COUNT(DISTINCT ws_bill_cdemo_sk) AS total_unique_customers FROM web_sales JOIN item ON ws_item_sk = i_item_sk JOIN warehouse ON ws_warehouse_sk = w_warehouse_sk JOIN promotion ON ws_promo_sk = p_promo_sk JOIN customer_demographics ON ws_bill_cdemo_sk = cd_demo_sk WHERE w_city = 'Fairview' AND p_cost = 1000.00 AND p_channel_demo = 'N' GROUP BY i_category, i_class, w_city, p_promo_name ORDER BY total_net_paid DESC, total_quantity_sold DESC;
SELECT c.c_customer_id, c.c_first_name, c.c_last_name, cd.cd_education_status, sum(cs.cs_quantity) as total_quantity_sold, avg(cs.cs_sales_price) as average_sales_price, count(distinct cs.cs_order_number) as number_of_orders, sum(cs.cs_net_profit) as total_net_profit FROM customer c JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk JOIN catalog_sales cs ON c.c_customer_sk = cs.cs_bill_customer_sk JOIN item i ON cs.cs_item_sk = i.i_item_sk JOIN warehouse w ON cs.cs_warehouse_sk = w.w_warehouse_sk JOIN promotion p ON cs.cs_promo_sk = p.p_promo_sk WHERE cd.cd_education_status IN ('College', 'Advanced Degree', '4 yr Degree') AND i.i_manager_id IN (69, 90) AND (cs.cs_sold_date_sk BETWEEN 2004001 AND 2004003 OR cs.cs_sold_date_sk BETWEEN 2004025 AND 2004028) AND (w.w_state = 'TN' OR w.w_country = 'United States') AND p.p_channel_email = 'Y' AND cs.cs_quantity >= 5 AND cs.cs_net_profit > 0 GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, cd.cd_education_status HAVING count(distinct cs.cs_order_number) > 1 ORDER BY total_net_profit DESC, number_of_orders DESC, cd.cd_education_status, c.c_last_name, c.c_first_name;
SELECT w.w_state, SUM(w.w_warehouse_sq_ft) AS total_warehouse_sq_ft, AVG(w.w_gmt_offset) AS average_gmt_offset, COUNT(r.r_reason_sk) AS gift_exchange_occurrences FROM warehouse w LEFT JOIN reason r ON r.r_reason_desc = 'Gift exchange' JOIN time_dim t ON t.t_minute BETWEEN 25 AND 35 GROUP BY w.w_state ORDER BY total_warehouse_sq_ft DESC, average_gmt_offset DESC;
SELECT ws.ws_web_site_sk, web.web_name, web.web_class, cd.cd_gender, cd.cd_marital_status, cd.cd_education_status, SUM(ws.ws_quantity) as total_quantity_sold, AVG(ws.ws_sales_price) as average_sales_price, COUNT(DISTINCT ws.ws_order_number) as total_orders, SUM(ws.ws_net_paid) as total_net_paid, SUM(ws.ws_net_paid_inc_tax) as total_net_paid_inc_tax, SUM(ws.ws_net_profit) as total_net_profit FROM web_sales ws JOIN web_site web ON ws.ws_web_site_sk = web.web_site_sk JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk JOIN promotion p ON ws.ws_promo_sk = p.p_promo_sk AND p.p_response_target = '1' WHERE p.p_start_date_sk IN (2451635, 2451362, 2451818, 2451605, 2451420, 2451665) GROUP BY ws.ws_web_site_sk, web.web_name, web.web_class, cd.cd_gender, cd.cd_marital_status, cd.cd_education_status ORDER BY total_net_profit DESC, web.web_name, cd.cd_gender, cd.cd_marital_status, cd.cd_education_status;
SELECT s.s_store_name, ib.hd_income_band_sk, hd.hd_buy_potential, SUM(ss.ss_net_paid) AS total_sales, AVG(ss.ss_sales_price) AS average_sales_price, COUNT(DISTINCT ss.ss_ticket_number) AS transaction_count FROM store_sales ss JOIN store s ON ss.ss_store_sk = s.s_store_sk JOIN household_demographics hd ON ss.ss_hdemo_sk = hd.hd_demo_sk LEFT JOIN household_demographics ib ON hd.hd_income_band_sk = ib.hd_income_band_sk WHERE hd.hd_income_band_sk = 9 GROUP BY s.s_store_name, ib.hd_income_band_sk, hd.hd_buy_potential ORDER BY total_sales DESC, average_sales_price DESC;
SELECT cp.cp_department, ca.ca_city, ca.ca_state, cd.cd_education_status, td.t_shift, SUM(cs.cs_quantity) AS total_quantity_sold, AVG(cs.cs_sales_price) AS average_sales_price, COUNT(DISTINCT cs.cs_order_number) AS total_orders, SUM(cs.cs_net_profit) AS total_net_profit FROM catalog_sales cs JOIN catalog_page cp ON cs.cs_catalog_page_sk = cp.cp_catalog_page_sk JOIN customer_address ca ON cs.cs_ship_addr_sk = ca.ca_address_sk JOIN customer_demographics cd ON cs.cs_ship_cdemo_sk = cd.cd_demo_sk JOIN time_dim td ON cs.cs_sold_time_sk = td.t_time_sk WHERE cp.cp_start_date_sk IN (2451145, 2451271, 2451088, 2450845, 2451360) AND cp.cp_type IN ('bi-annual', 'quarterly') AND td.t_hour IN (1, 0) AND cd.cd_dep_college_count = 0 GROUP BY cp.cp_department, ca.ca_city, ca.ca_state, cd.cd_education_status, td.t_shift ORDER BY total_net_profit DESC, total_orders DESC;
SELECT cp.cp_department, i.i_category, i.i_brand, sm.sm_carrier, s.s_store_name, s.s_company_name, COUNT(DISTINCT inv.inv_item_sk) AS num_items, SUM(inv.inv_quantity_on_hand) AS total_quantity, AVG(i.i_current_price) AS avg_current_price, MAX(i.i_wholesale_cost) AS max_wholesale_cost, MIN(s.s_number_employees) AS min_num_employees, AVG(s.s_tax_precentage) AS avg_tax_percentage FROM catalog_page cp JOIN item i ON cp.cp_catalog_page_sk = i.i_item_sk JOIN inventory inv ON i.i_item_sk = inv.inv_item_sk JOIN ship_mode sm ON sm.sm_ship_mode_sk = inv.inv_warehouse_sk JOIN store s ON s.s_store_sk = inv.inv_warehouse_sk WHERE i.i_brand = 'exportibrand #7' AND s.s_number_employees = 271 AND sm.sm_carrier IN ('BOXBUNDLES', 'ALLIANCE', 'PRIVATECARRIER', 'ORIENTAL', 'UPS') AND inv.inv_warehouse_sk IN (1, 2) GROUP BY cp.cp_department, i.i_category, i.i_brand, sm.sm_carrier, s.s_store_name, s.s_company_name ORDER BY total_quantity DESC, avg_current_price DESC;
SELECT cp.cp_department, r.r_reason_desc, COUNT(DISTINCT cr.cr_order_number) AS total_returns, AVG(cr.cr_return_amount) AS avg_return_amount, SUM(cr.cr_return_amount) AS total_return_amount, AVG(cr.cr_return_quantity) AS avg_return_quantity, SUM(cr.cr_return_quantity) AS total_return_quantity, AVG(cr.cr_net_loss) AS avg_net_loss, SUM(cr.cr_net_loss) AS total_net_loss, AVG(ws.ws_net_paid_inc_ship_tax) AS avg_sale_amount_inc_ship_tax, SUM(ws.ws_net_paid_inc_ship_tax) AS total_sale_amount_inc_ship_tax FROM catalog_returns cr JOIN catalog_page cp ON cr.cr_catalog_page_sk = cp.cp_catalog_page_sk JOIN reason r ON cr.cr_reason_sk = r.r_reason_sk JOIN item i ON cr.cr_item_sk = i.i_item_sk JOIN web_sales ws ON cr.cr_item_sk = ws.ws_item_sk AND cr.cr_order_number = ws.ws_order_number JOIN household_demographics hd ON cr.cr_returning_hdemo_sk = hd.hd_demo_sk WHERE cp.cp_start_date_sk IS NOT NULL AND cp.cp_end_date_sk IS NOT NULL AND i.i_size IN ('large', 'petite', 'N/A') AND hd.hd_dep_count IN (6, 2, 0) AND hd.hd_income_band_sk IN (15, 14, 17, 18, 8) AND cr.cr_return_ship_cost IN (1215.68, 5.50, 311.58, 319.00, 3656.16, 1740.04) AND ws.ws_net_paid_inc_ship_tax = 1414.78 AND i.i_formulation IN ('ivory457370549352452', '77416linen1913860202', '32linen2899537977429', '61439655670steel4120') GROUP BY cp.cp_department, r.r_reason_desc ORDER BY total_return_amount DESC, avg_return_amount DESC, total_returns DESC;
SELECT dd.d_year, dd.d_quarter_name, SUM(cs.cs_quantity) AS total_quantity_sold, AVG(cs.cs_sales_price) AS average_sales_price, COUNT(DISTINCT cs.cs_order_number) AS total_orders, SUM(cs.cs_net_profit) AS total_net_profit, cc.cc_name AS call_center_name, cc.cc_division_name AS call_center_division, cc.cc_city AS call_center_city FROM catalog_sales cs JOIN date_dim dd ON cs.cs_sold_date_sk = dd.d_date_sk JOIN call_center cc ON cs.cs_call_center_sk = cc.cc_call_center_sk WHERE dd.d_qoy IN (1, 2, 3, 4) AND dd.d_dom IN (20, 24) AND cc.cc_sq_ft IN ('4134', '1138', '2268') AND cc.cc_division IN ('1', '4') GROUP BY dd.d_year, dd.d_quarter_name, cc.cc_name, cc.cc_division_name, cc.cc_city ORDER BY dd.d_year, dd.d_quarter_name, total_net_profit DESC;
SELECT cd.cd_gender, cd.cd_marital_status, cd.cd_education_status, hd.hd_buy_potential, AVG(cr.cr_return_amt_inc_tax) AS avg_return_amount_inc_tax, COUNT(cr.cr_order_number) AS total_returns, SUM(cr.cr_return_quantity) AS total_returned_quantity FROM catalog_returns cr JOIN customer_demographics cd ON cr.cr_returning_cdemo_sk = cd.cd_demo_sk JOIN household_demographics hd ON cr.cr_returning_hdemo_sk = hd.hd_demo_sk JOIN store s ON cr.cr_returning_addr_sk = s.s_store_sk WHERE cd.cd_marital_status IN ('D', 'S') AND hd.hd_buy_potential IN ('5001-10000', '0-500', '501-1000', 'Unknown', '1001-5000') AND s.s_company_id = 1 GROUP BY ROLLUP(cd.cd_gender, cd.cd_marital_status, cd.cd_education_status, hd.hd_buy_potential) ORDER BY total_returns DESC, avg_return_amount_inc_tax DESC;
SELECT w_state, COUNT(DISTINCT w_warehouse_sk) AS total_warehouses, SUM(w_warehouse_sq_ft) AS total_warehouse_sq_ft, AVG(w_warehouse_sq_ft) AS avg_warehouse_sq_ft, SUM(sr_return_amt) AS total_return_amt, AVG(sr_return_amt) AS avg_return_amt, COUNT(DISTINCT sr_ticket_number) AS total_return_transactions, SUM(wp_char_count) AS total_webpage_char_count, AVG(wp_link_count) AS avg_webpage_link_count, COUNT(DISTINCT web_site_sk) AS total_websites, SUM(web_tax_percentage) AS total_web_tax_percentage, AVG(web_tax_percentage) AS avg_web_tax_percentage FROM warehouse w LEFT JOIN store_returns sr ON w.w_warehouse_sk = sr.sr_store_sk LEFT JOIN web_page wp ON w.w_warehouse_sk = wp.wp_customer_sk LEFT JOIN web_site ws ON wp.wp_web_page_sk = ws.web_site_sk GROUP BY w_state ORDER BY total_return_amt DESC;
SELECT s.s_store_name, i.i_category, p.p_channel_details, SUM(cs.cs_net_paid_inc_ship) AS total_sales, SUM(cs.cs_net_profit) AS total_profit, COUNT(DISTINCT cs.cs_order_number) AS total_orders, AVG(cs.cs_quantity) AS average_quantity, SUM(wr.wr_net_loss) AS total_net_loss, COUNT(DISTINCT wr.wr_order_number) AS total_returns, r.r_reason_desc FROM store s JOIN catalog_sales cs ON s.s_store_sk = cs.cs_warehouse_sk JOIN item i ON cs.cs_item_sk = i.i_item_sk LEFT JOIN promotion p ON cs.cs_promo_sk = p.p_promo_sk LEFT JOIN web_returns wr ON cs.cs_item_sk = wr.wr_item_sk AND cs.cs_order_number = wr.wr_order_number LEFT JOIN reason r ON wr.wr_reason_sk = r.r_reason_sk WHERE s.s_country = 'United States' AND ( s.s_store_sk = '8' OR s.s_store_sk = '1' ) AND ( cs.cs_net_paid_inc_ship IN ('6377.67', '3521.76', '158.56', '2257.47', '739.93', '7973.92') ) AND ( r.r_reason_sk IN ('17', '4', '20', '18', '31') OR r.r_reason_sk IS NULL ) AND i.i_class = 'cooking' GROUP BY s.s_store_name, i.i_category, p.p_channel_details, r.r_reason_desc ORDER BY total_sales DESC, total_profit DESC;
SELECT ib.ib_income_band_sk, ib.ib_lower_bound, ib.ib_upper_bound, COUNT(DISTINCT hd.hd_demo_sk) AS household_count, SUM(cs.cs_ext_sales_price) AS total_sales_amount, AVG(cs.cs_sales_price) AS average_sales_price, COUNT(DISTINCT cs.cs_order_number) AS total_orders FROM catalog_sales cs JOIN household_demographics hd ON cs.cs_bill_hdemo_sk = hd.hd_demo_sk JOIN income_band ib ON hd.hd_income_band_sk = ib.ib_income_band_sk JOIN time_dim t ON cs.cs_sold_time_sk = t.t_time_sk JOIN warehouse w ON cs.cs_warehouse_sk = w.w_warehouse_sk WHERE t.t_shift = 'Morning' AND ib.ib_upper_bound <= 190000 AND w.w_gmt_offset = -5.00 AND w.w_street_name IN ('Ash Laurel', '6th', 'Wilson Elm', 'View First') GROUP BY ib.ib_income_band_sk, ib.ib_lower_bound, ib.ib_upper_bound ORDER BY ib.ib_income_band_sk;
SELECT s_state, s_city, ib_lower_bound, ib_upper_bound, AVG(s_number_employees) AS avg_employees, AVG(s_floor_space) AS avg_floor_space, SUM(w_warehouse_sq_ft) AS total_warehouse_sq_ft, COUNT(DISTINCT cp_catalog_page_sk) AS num_catalog_pages, AVG(hd_vehicle_count) AS avg_vehicle_count FROM store JOIN household_demographics ON (s_store_sk = hd_demo_sk) JOIN income_band ON (hd_income_band_sk = ib_income_band_sk) JOIN warehouse ON (s_zip = w_zip) JOIN catalog_page ON (s_market_id = cp_catalog_number) WHERE s_state = 'TN' AND (s_closed_date_sk IN (2450910, 2451189, 2451044) OR s_closed_date_sk IS NULL) AND hd_dep_count IN (2, 3, 4, 5, 8, 9) AND cp_end_date_sk IN (2451087, 2451114, 2450996, 2451664) AND w_warehouse_sq_ft IN (977787, 294242, 621234, 138504) AND w_warehouse_id IN ('AAAAAAAABAAAAAAA', 'AAAAAAAAEAAAAAAA', 'AAAAAAAADAAAAAAA', 'AAAAAAAAFAAAAAAA', 'AAAAAAAACAAAAAAA') GROUP BY s_state, s_city, ib_lower_bound, ib_upper_bound ORDER BY s_city, ib_lower_bound;
SELECT ws.web_name, ws.web_manager, cd.cd_gender, cd.cd_credit_rating, SUM(cr.cr_return_amount) AS total_catalog_return_amount, AVG(cr.cr_return_amount) AS avg_catalog_return_amount, COUNT(cr.cr_order_number) AS count_catalog_returns, SUM(wr.wr_return_amt) AS total_web_return_amount, AVG(wr.wr_return_amt) AS avg_web_return_amount, COUNT(wr.wr_order_number) AS count_web_returns FROM web_site ws JOIN web_returns wr ON ws.web_site_sk = wr.wr_web_page_sk JOIN customer_demographics cd ON wr.wr_refunded_cdemo_sk = cd.cd_demo_sk JOIN catalog_returns cr ON cr.cr_catalog_page_sk = ws.web_site_sk AND cr.cr_refunded_cdemo_sk = cd.cd_demo_sk WHERE cd.cd_gender = 'F' AND (cd.cd_credit_rating = 'High Risk' OR cd.cd_credit_rating = 'Low Risk' OR cd.cd_credit_rating = 'Good' OR cd.cd_credit_rating = 'Unknown') AND ws.web_street_number = '828' GROUP BY ws.web_name, ws.web_manager, cd.cd_gender, cd.cd_credit_rating ORDER BY total_catalog_return_amount DESC, total_web_return_amount DESC;
SELECT s.s_store_name, s.s_state, cc.cc_name AS call_center_name, cc.cc_class, SUM(sr.sr_return_amt) AS total_return_amount, AVG(sr.sr_return_quantity) AS average_return_quantity, COUNT(DISTINCT sr.sr_customer_sk) AS unique_customers_returning, COUNT(*) AS total_returns FROM store_returns sr JOIN store s ON sr.sr_store_sk = s.s_store_sk JOIN call_center cc ON s.s_market_id = cc.cc_mkt_id WHERE sr.sr_return_amt > 0 AND s.s_rec_end_date IN ('1999-03-13', '2000-03-12') AND s.s_floor_space IN (9294113, 5285950, 6995995, 5219562) AND sr.sr_store_sk IN (4, 2, 1, 10, 7) AND cc.cc_country = 'United States' GROUP BY s.s_store_name, s.s_state, cc.cc_name, cc.cc_class ORDER BY total_return_amount DESC, s.s_store_name, cc.cc_name;
SELECT d.d_year AS year, d.d_quarter_name AS quarter, w.w_warehouse_name AS warehouse_name, ib.ib_income_band_sk AS income_band, SUM(inv.inv_quantity_on_hand) AS total_quantity_sold, AVG(inv.inv_quantity_on_hand) AS average_quantity_per_transaction, COUNT(DISTINCT inv.inv_item_sk) AS distinct_item_count, COUNT(*) AS transaction_count FROM inventory inv JOIN date_dim d ON inv.inv_date_sk = d.d_date_sk JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk JOIN income_band ib ON ib.ib_income_band_sk BETWEEN 5 AND 15 WHERE d.d_dom = 25 AND w.w_warehouse_sq_ft IN (977787, 294242, 621234, 138504) AND inv.inv_quantity_on_hand IN (781, 841, 802, 251) AND ib.ib_lower_bound >= 90001 GROUP BY year, quarter, warehouse_name, income_band ORDER BY year, quarter, warehouse_name, income_band;
SELECT c.c_customer_id, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_sales, SUM(cr.cr_return_amount) AS total_returns, (SUM(cs.cs_net_paid) - SUM(cr.cr_return_amount)) AS net_profit, AVG(cs.cs_sales_price) AS average_sales_price, COUNT(DISTINCT cs.cs_order_number) AS number_of_orders, COUNT(DISTINCT cr.cr_order_number) AS number_of_returns FROM customer c LEFT JOIN catalog_sales cs ON c.c_customer_sk = cs.cs_bill_customer_sk LEFT JOIN catalog_returns cr ON cs.cs_order_number = cr.cr_order_number GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name HAVING COUNT(DISTINCT cs.cs_order_number) > 0 AND COUNT(DISTINCT cr.cr_order_number) > 0 ORDER BY net_profit DESC, total_sales DESC LIMIT 100;
SELECT sm.sm_type, sm.sm_carrier, COUNT(DISTINCT cs.cs_order_number) AS total_orders, SUM(cs.cs_quantity) AS total_quantity_sold, SUM(cs.cs_net_paid) AS total_net_paid, AVG(cs.cs_sales_price) AS average_sales_price, SUM(cs.cs_net_profit) AS total_net_profit FROM catalog_sales cs JOIN ship_mode sm ON cs.cs_ship_mode_sk = sm.sm_ship_mode_sk JOIN web_page wp ON cs.cs_catalog_page_sk = wp.wp_web_page_sk WHERE wp.wp_char_count IN (701, 1931) AND sm.sm_type = 'OVERNIGHT' AND cs.cs_call_center_sk IN (1, 2, 4) GROUP BY sm.sm_type, sm.sm_carrier ORDER BY total_net_paid DESC;
