SELECT s_store_name, i_category, cd_gender, cd_education_status, r_reason_desc, COUNT(DISTINCT wr_item_sk) AS unique_items_returned, SUM(wr_return_quantity) AS total_return_quantity, AVG(wr_return_amt) AS avg_return_amount, AVG(i_wholesale_cost) AS avg_wholesale_cost, COUNT(wr_returned_date_sk) AS total_returns FROM web_returns JOIN item ON wr_item_sk = i_item_sk JOIN store ON s_store_sk = wr_returning_addr_sk JOIN customer_demographics ON cd_demo_sk = wr_returning_cdemo_sk JOIN reason ON r_reason_sk = wr_reason_sk JOIN date_dim ON wr_returned_date_sk = d_date_sk JOIN time_dim ON wr_returned_time_sk = t_time_sk WHERE d_year = 2022 AND s_state = 'CA' AND wr_return_amt > 0 AND i_current_price > i_wholesale_cost AND t_shift = 'third' GROUP BY s_store_name, i_category, cd_gender, cd_education_status, r_reason_desc ORDER BY total_return_quantity DESC, avg_return_amount DESC LIMIT 100;
SELECT d_year, d_month_seq, COUNT(wp_web_page_sk) AS total_web_pages, AVG(wp_char_count) AS avg_char_count, SUM(wp_link_count) AS total_links, AVG(wp_image_count) AS avg_image_count, MAX(wp_max_ad_count) AS max_ad_count FROM web_page JOIN date_dim ON wp_access_date_sk = d_date_sk GROUP BY d_year, d_month_seq ORDER BY d_year, d_month_seq;
SELECT i.i_category, ib.ib_income_band_sk, AVG(cs.cs_sales_price) AS avg_sales_price, SUM(cs.cs_net_paid_inc_ship_tax) AS total_sales, COUNT(DISTINCT cs.cs_order_number) AS total_orders, SUM(cr.cr_return_amount) AS total_returns, COUNT(DISTINCT cr.cr_order_number) AS total_return_orders FROM catalog_sales cs JOIN item i ON cs.cs_item_sk = i.i_item_sk JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk JOIN income_band ib ON c.c_current_cdemo_sk = ib.ib_income_band_sk LEFT JOIN catalog_returns cr ON cs.cs_order_number = cr.cr_order_number WHERE cs.cs_sold_date_sk IS NOT NULL AND ( ib.ib_lower_bound IN (110001, 190001, 30001) OR ib.ib_income_band_sk IN (1, 9, 3) ) GROUP BY i.i_category, ib.ib_income_band_sk ORDER BY total_sales DESC, total_returns DESC;
SELECT ca.ca_city, ca.ca_state, hd.hd_income_band_sk, COUNT(DISTINCT ws.ws_order_number) AS total_orders, SUM(ws.ws_quantity) AS total_quantity_sold, AVG(ws.ws_net_paid) AS average_net_paid, SUM(ws.ws_net_paid_inc_tax) AS total_net_paid_including_tax, AVG(ws.ws_net_profit) AS average_net_profit FROM web_sales ws JOIN customer_address ca ON ws.ws_bill_addr_sk = ca.ca_address_sk JOIN household_demographics hd ON ws.ws_bill_hdemo_sk = hd.hd_demo_sk WHERE ca.ca_country = 'United States' AND (ca.ca_city IN ('Argyle', 'Collinsville', 'Ferguson') OR hd.hd_demo_sk IN (1967, 3880)) AND ws.ws_sold_time_sk IN (27944, 62910, 57271, 74886, 48677, 80582) AND ws.ws_net_paid_inc_tax >= 7202.65 GROUP BY ca.ca_city, ca.ca_state, hd.hd_income_band_sk ORDER BY total_net_paid_including_tax DESC, average_net_profit DESC;
SELECT cc.cc_name, cc.cc_city, cc.cc_state, AVG(cc.cc_employees) AS average_employee_count, SUM(cc.cc_sq_ft) AS total_call_center_sq_ft, COUNT(DISTINCT w.w_warehouse_sk) AS number_of_warehouses, AVG(w.w_warehouse_sq_ft) AS average_warehouse_sq_ft, SUM(wp.wp_link_count) AS total_web_page_link_count, COUNT(DISTINCT cp.cp_catalog_page_sk) AS number_of_catalog_pages FROM call_center cc LEFT JOIN warehouse w ON cc.cc_city = w.w_city AND cc.cc_state = w.w_state LEFT JOIN web_page wp ON wp.wp_url LIKE '%' || cc.cc_state || '%' LEFT JOIN catalog_page cp ON cc.cc_division = cp.cp_catalog_number WHERE cc.cc_class IN ('small', 'medium', 'large') AND wp.wp_autogen_flag = 'N' AND cp.cp_start_date_sk IN ('2451636', '2451271') AND w.w_suite_number = 'Suite 0' AND w.w_warehouse_sq_ft IN ('621234', '294242', '977787', '138504') GROUP BY cc.cc_name, cc.cc_city, cc.cc_state ORDER BY total_call_center_sq_ft DESC, average_employee_count DESC LIMIT 100;
SELECT r.r_reason_desc AS return_reason, s.s_state AS store_state, SUM(cr.cr_net_loss) AS total_net_loss, COUNT(cr.cr_order_number) AS total_returns, SUM(cs.cs_sales_price) AS total_sales, AVG(cs.cs_wholesale_cost) AS average_wholesale_cost FROM catalog_returns cr JOIN reason r ON cr.cr_reason_sk = r.r_reason_sk JOIN catalog_sales cs ON cr.cr_order_number = cs.cs_order_number JOIN store s ON cs.cs_ship_addr_sk = s.s_store_sk WHERE s.s_state = 'TN' AND (s.s_rec_end_date = '2000-03-12' OR s.s_rec_end_date = '2001-03-12' OR s.s_rec_end_date = '1999-03-13') AND cr.cr_refunded_cdemo_sk IN ('1036988', '1625235', '677128', '477491', '1394507') AND cs.cs_sales_price IN ('39.95', '82.47', '120.86', '44.27', '31.55', '39.02') AND cs.cs_wholesale_cost IN ('73.36', '50.92', '95.23', '92.26') GROUP BY return_reason, store_state ORDER BY total_net_loss DESC, store_state, return_reason;
SELECT i_category, i_class, COUNT(DISTINCT cr_order_number) AS total_returns, SUM(cr_return_quantity) AS total_returned_quantity, AVG(cr_return_amount) AS avg_return_amount, SUM(cr_net_loss) AS total_net_loss, COUNT(DISTINCT ws_order_number) AS total_sales_orders, SUM(ws_quantity) AS total_sold_quantity, AVG(ws_sales_price) AS avg_sales_price, SUM(ws_net_profit) AS total_net_profit FROM catalog_returns JOIN item ON catalog_returns.cr_item_sk = item.i_item_sk JOIN web_sales ON item.i_item_sk = web_sales.ws_item_sk JOIN customer ON web_sales.ws_bill_customer_sk = customer.c_customer_sk JOIN income_band ON customer.c_current_hdemo_sk = income_band.ib_income_band_sk WHERE cr_returned_date_sk BETWEEN 20000101 AND 20001231 AND ws_sold_date_sk BETWEEN 20000101 AND 20001231 AND ib_income_band_sk IN (5, 8) AND cr_net_loss > 100 GROUP BY i_category, i_class ORDER BY total_net_loss DESC, total_net_profit DESC;
SELECT ca.ca_county, ca.ca_state, w.w_warehouse_name, hd.hd_income_band_sk, SUM(inv.inv_quantity_on_hand) AS total_quantity_on_hand, AVG(hd.hd_dep_count) AS average_dependency_count, AVG(hd.hd_vehicle_count) AS average_vehicle_count, COUNT(DISTINCT ca.ca_address_sk) AS total_addresses, COUNT(DISTINCT hd.hd_demo_sk) AS total_households FROM inventory inv JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk JOIN customer_address ca ON ca.ca_state = w.w_state JOIN household_demographics hd ON ca.ca_zip = w.w_zip WHERE ca.ca_county = 'Jeff Davis County' AND (ca.ca_zip = '78482' OR ca.ca_zip = '48054') AND (inv.inv_warehouse_sk = 1 OR inv.inv_warehouse_sk = 2) AND (inv.inv_item_sk IN (7786, 9218, 15079, 13832, 11164)) GROUP BY ca.ca_county, ca.ca_state, w.w_warehouse_name, hd.hd_income_band_sk ORDER BY ca.ca_county, ca.ca_state, w.w_warehouse_name, hd.hd_income_band_sk;
SELECT dd.d_year, dd.d_quarter_name, SUM(sr.sr_return_quantity) AS total_returned_quantity, AVG(sr.sr_return_amt) AS avg_return_amt, COUNT(DISTINCT sr.sr_customer_sk) AS unique_customers, COUNT(DISTINCT hd.hd_demo_sk) AS unique_households, r.r_reason_desc, COUNT(*) AS return_instances, SUM(sr.sr_net_loss) AS total_net_loss FROM store_returns sr JOIN date_dim dd ON sr.sr_returned_date_sk = dd.d_date_sk LEFT JOIN household_demographics hd ON sr.sr_hdemo_sk = hd.hd_demo_sk LEFT JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk WHERE dd.d_fy_year BETWEEN 1907 AND 1913 GROUP BY dd.d_year, dd.d_quarter_name, r.r_reason_desc ORDER BY dd.d_year, total_returned_quantity DESC, avg_return_amt DESC;
SELECT s.s_state, w.w_country, p.p_promo_name, SUM(ss.ss_quantity) AS total_quantity_sold, AVG(ss.ss_sales_price) AS average_sales_price, COUNT(DISTINCT ss.ss_ticket_number) AS number_of_sales_transactions, SUM(ss.ss_net_paid) AS total_net_paid, SUM(ss.ss_net_profit) AS total_net_profit FROM store_sales ss JOIN store s ON ss.ss_store_sk = s.s_store_sk JOIN warehouse w ON s.s_state = w.w_state LEFT JOIN promotion p ON ss.ss_promo_sk = p.p_promo_sk AND p.p_channel_catalog = 'N' GROUP BY s.s_state, w.w_country, p.p_promo_name ORDER BY s.s_state, w.w_country, p.p_promo_name;
SELECT s_state, s_city, ib_lower_bound, ib_upper_bound, AVG(s_number_employees) AS avg_employees, AVG(s_floor_space) AS avg_floor_space, SUM(w_warehouse_sq_ft) AS total_warehouse_sq_ft, COUNT(DISTINCT cp_catalog_page_sk) AS num_catalog_pages, AVG(hd_vehicle_count) AS avg_vehicle_count FROM store JOIN household_demographics ON (s_store_sk = hd_demo_sk) JOIN income_band ON (hd_income_band_sk = ib_income_band_sk) JOIN warehouse ON (s_zip = w_zip) JOIN catalog_page ON (s_market_id = cp_catalog_number) WHERE s_state = 'TN' AND (s_closed_date_sk IN (2450910, 2451189, 2451044) OR s_closed_date_sk IS NULL) AND hd_dep_count IN (2, 3, 4, 5, 8, 9) AND cp_end_date_sk IN (2451087, 2451114, 2450996, 2451664) AND w_warehouse_sq_ft IN (977787, 294242, 621234, 138504) AND w_warehouse_id IN ('AAAAAAAABAAAAAAA', 'AAAAAAAAEAAAAAAA', 'AAAAAAAADAAAAAAA', 'AAAAAAAAFAAAAAAA', 'AAAAAAAACAAAAAAA') GROUP BY s_state, s_city, ib_lower_bound, ib_upper_bound ORDER BY s_city, ib_lower_bound;
