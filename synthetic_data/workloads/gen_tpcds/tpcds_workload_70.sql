SELECT ca_state, cp_department, p_promo_name, SUM(ss_quantity) AS total_quantity_sold, AVG(ss_sales_price) AS average_sales_price, COUNT(DISTINCT ss_customer_sk) AS unique_customers, SUM(ss_net_paid) AS total_net_paid, SUM(ss_net_profit) AS total_net_profit FROM store_sales JOIN promotion ON ss_promo_sk = p_promo_sk JOIN customer_address ON ss_addr_sk = ca_address_sk JOIN catalog_page ON ss_item_sk = cp_catalog_page_sk WHERE p_end_date_sk IN ('2450360', '2450791', '2450178', '2450468', '2450825') GROUP BY ca_state, cp_department, p_promo_name ORDER BY ca_state, cp_department, p_promo_name;
SELECT hd.hd_dep_count, COUNT(*) AS total_returns, SUM(cr.cr_return_amount) AS total_return_amount, AVG(cr.cr_return_amount) AS average_return_amount, SUM(cr.cr_return_quantity) AS total_return_quantity, AVG(cr.cr_return_quantity) AS average_return_quantity, SUM(cr.cr_net_loss) AS total_net_loss FROM catalog_returns cr JOIN household_demographics hd ON cr.cr_returning_hdemo_sk = hd.hd_demo_sk GROUP BY ROLLUP(hd.hd_dep_count) HAVING hd.hd_dep_count IN (2, 7, 9, 4, 8, 3) ORDER BY hd.hd_dep_count;
SELECT r.r_reason_desc, COUNT(sr.sr_ticket_number) AS return_count, SUM(sr.sr_return_quantity) AS total_returned_quantity, AVG(sr.sr_return_amt) AS average_return_amount, SUM(sr.sr_return_amt_inc_tax) AS total_amount_incl_tax, SUM(sr.sr_fee) AS total_fees, AVG(wp.wp_link_count) AS average_link_count, AVG(wp.wp_image_count) AS average_image_count FROM store_returns sr JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk LEFT JOIN web_page wp ON c.c_customer_sk = wp.wp_customer_sk WHERE sr.sr_return_quantity > 1 AND c.c_birth_country IN ('YEMEN', 'POLAND', 'SWITZERLAND') AND wp.wp_image_count IN (2, 4, 5) GROUP BY r.r_reason_desc ORDER BY total_returned_quantity DESC, average_return_amount DESC;
SELECT cd_gender, cd_marital_status, cd_education_status, sm_carrier, SUM(cs_net_paid_inc_tax) AS total_net_paid_inc_tax, AVG(cs_quantity) AS average_quantity, COUNT(*) AS num_transactions FROM catalog_sales JOIN customer_demographics ON catalog_sales.cs_bill_cdemo_sk = customer_demographics.cd_demo_sk JOIN ship_mode ON catalog_sales.cs_ship_mode_sk = ship_mode.sm_ship_mode_sk JOIN time_dim ON catalog_sales.cs_sold_time_sk = time_dim.t_time_sk WHERE cd_credit_rating = 'Good' AND sm_carrier IN ('UPS', 'FEDEX') AND t_hour BETWEEN 8 AND 17 GROUP BY cd_gender, cd_marital_status, cd_education_status, sm_carrier ORDER BY total_net_paid_inc_tax DESC, average_quantity DESC, num_transactions DESC;
SELECT ws.web_site_id, ws.web_name, ws.web_class, ws.web_market_manager, AVG(p.p_cost) AS average_promotion_cost, SUM(CASE WHEN p.p_channel_email = 'N' THEN 1 ELSE 0 END) AS num_promotions_not_via_email, COUNT(DISTINCT cp.cp_catalog_page_sk) AS num_catalog_pages, MAX(hd.hd_dep_count) AS max_dependency_count, AVG(hd.hd_vehicle_count) AS avg_vehicle_count FROM web_site ws LEFT JOIN promotion p ON ws.web_site_sk = p.p_item_sk LEFT JOIN catalog_page cp ON cp.cp_catalog_page_number IN (26, 38) AND cp.cp_start_date_sk IN (2450965, 2451115, 2451300, 2451818, 2450935) LEFT JOIN household_demographics hd ON hd.hd_income_band_sk IN (15, 2) GROUP BY ws.web_site_id, ws.web_name, ws.web_class, ws.web_market_manager ORDER BY ws.web_site_id;
SELECT s.s_store_name, COUNT(sr.sr_ticket_number) AS total_returns, SUM(sr.sr_return_quantity) AS total_returned_quantity, SUM(sr.sr_return_amt) AS total_refund_amount, AVG(sr.sr_return_amt) AS average_refund_amount, SUM(sr.sr_fee) AS total_fees_collected, r.r_reason_desc AS return_reason, d.d_year AS return_year, d.d_quarter_name AS return_quarter FROM store_returns sr JOIN store s ON sr.sr_store_sk = s.s_store_sk JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk WHERE s.s_company_id = '1' AND s.s_gmt_offset = '-5.00' AND sr.sr_reason_sk IN ('24', '25', '31', '13', '17', '4') AND sr.sr_returned_date_sk IS NOT NULL GROUP BY s.s_store_name, r.r_reason_desc, d.d_year, d.d_quarter_name ORDER BY s.s_store_name, total_returns DESC, total_refund_amount DESC;
SELECT st.s_store_name, st.s_store_id, SUM(ws.ws_net_paid) AS total_net_sales, AVG(ws.ws_sales_price) AS avg_sales_price, COUNT(wr.wr_order_number) AS total_returns, AVG(wr.wr_return_amt) AS avg_return_amount, ARRAY_AGG(DISTINCT re.r_reason_desc) AS reasons_for_returns FROM store st LEFT JOIN web_sales ws ON st.s_store_sk = ws.ws_warehouse_sk LEFT JOIN web_returns wr ON ws.ws_order_number = wr.wr_order_number LEFT JOIN reason re ON wr.wr_reason_sk = re.r_reason_sk WHERE st.s_division_id = 1 AND st.s_tax_precentage BETWEEN 0.01 AND 0.06 GROUP BY st.s_store_name, st.s_store_id ORDER BY total_net_sales DESC, avg_sales_price DESC, total_returns DESC, avg_return_amount DESC;
SELECT cc.cc_call_center_id, cc.cc_name, cc.cc_city, cc.cc_state, SUM(inv.inv_quantity_on_hand) AS total_inventory, AVG(i.i_current_price) AS average_item_price, COUNT(DISTINCT c.cd_demo_sk) AS unique_customer_count, SUM(CASE WHEN t.t_shift = 'Morning' THEN 1 ELSE 0 END) AS morning_shifts, SUM(CASE WHEN t.t_shift = 'Evening' THEN 1 ELSE 0 END) AS evening_shifts FROM call_center cc JOIN inventory inv ON cc.cc_call_center_sk = inv.inv_warehouse_sk JOIN item i ON inv.inv_item_sk = i.i_item_sk JOIN customer_demographics c ON i.i_manager_id = c.cd_demo_sk JOIN time_dim t ON inv.inv_date_sk = t.t_time_sk WHERE cc.cc_tax_percentage IN (0.01, 0.05, 0.11, 0.12) AND i.i_category_id IN (7, 6, 2, 9, 5, 10) AND t.t_time_id IN ('AAAAAAAALICBAAAA', 'AAAAAAAALJJAAAAA', 'AAAAAAAAEMJAAAAA', 'AAAAAAAAAEBAAAAA') GROUP BY cc.cc_call_center_id, cc.cc_name, cc.cc_city, cc.cc_state ORDER BY total_inventory DESC, average_item_price DESC, unique_customer_count DESC LIMIT 100;
SELECT s.s_store_id, s.s_store_name, s.s_city, s.s_state, s.s_country, s.s_tax_precentage, COUNT(DISTINCT inv.inv_item_sk) AS unique_items, SUM(inv.inv_quantity_on_hand) AS total_inventory, AVG(inv.inv_quantity_on_hand) AS avg_inventory, MAX(i.i_current_price) AS max_item_price, MIN(i.i_current_price) AS min_item_price, AVG(i.i_current_price) AS avg_item_price, COUNT(DISTINCT ca.ca_address_sk) AS customer_address_count, SUM(CASE WHEN d.d_weekend = 'Y' THEN 1 ELSE 0 END) AS weekend_days, SUM(CASE WHEN d.d_holiday = 'Y' THEN 1 ELSE 0 END) AS holiday_days FROM store s JOIN inventory inv ON s.s_store_sk = inv.inv_warehouse_sk JOIN item i ON inv.inv_item_sk = i.i_item_sk JOIN date_dim d ON inv.inv_date_sk = d.d_date_sk JOIN customer_address ca ON s.s_zip = ca.ca_zip WHERE s.s_country = 'United States' AND d.d_month_seq IN (68, 76, 131) AND d.d_current_day = 'N' AND d.d_last_dom IN (2419461, 2416174, 2419399) AND d.d_week_seq IN (41, 224, 47) AND inv.inv_warehouse_sk IN (2, 1) AND inv.inv_item_sk IN (6787, 15910, 13876) AND i.i_item_id IN ('AAAAAAAAJEGAAAAA', 'AAAAAAAAOICBAAAA', 'AAAAAAAAKECBAAAA') AND i.i_rec_start_date IN ('2001-10-27', '1999-10-28', '1997-10-27') AND i.i_current_price IN (9.36, 0.92, 7.12) AND i.i_container = 'Unknown' AND ca.ca_street_number IN ('244', '496', '119') AND ca.ca_zip IN ('82293', '14244', '98877') GROUP BY s.s_store_id, s.s_store_name, s.s_city, s.s_state, s.s_country, s.s_tax_precentage ORDER BY s.s_store_name, total_inventory DESC;
