SELECT c.c_first_name, c.c_last_name, sum(ss.ss_quantity) as total_items_sold, avg(ss.ss_sales_price) as average_sales_price, sum(ss.ss_net_paid) as total_revenue, sum(ss.ss_net_profit) as total_profit, p.p_promo_name, count(DISTINCT ss.ss_ticket_number) as number_of_sales_transactions FROM store_sales ss JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk JOIN promotion p ON ss.ss_promo_sk = p.p_promo_sk JOIN inventory i ON ss.ss_item_sk = i.inv_item_sk AND i.inv_date_sk = ss.ss_sold_date_sk WHERE c.c_last_name IN ('Waggoner', 'Hoyt', 'Moffitt', 'Buchanan', 'Orourke') AND i.inv_warehouse_sk IN ('1', '2') AND p.p_channel_catalog = 'N' AND ss.ss_promo_sk IN ('11', '103', '131', '133', '275') GROUP BY c.c_first_name, c.c_last_name, p.p_promo_name ORDER BY total_revenue DESC, c.c_last_name, c.c_first_name;
SELECT hd.hd_income_band_sk, COUNT(DISTINCT cs.cs_order_number) AS total_orders, SUM(cs.cs_quantity) AS total_quantity_sold, AVG(cs.cs_sales_price) AS average_sales_price, SUM(cs.cs_net_profit) AS total_net_profit, SUM(sr.sr_return_quantity) AS total_quantity_returned, SUM(sr.sr_return_amt) AS total_return_amount, AVG(sr.sr_fee) AS average_return_fee, SUM(sr.sr_net_loss) AS total_net_loss, (SUM(cs.cs_net_profit) - SUM(sr.sr_net_loss)) AS net_gain_loss FROM household_demographics hd LEFT JOIN catalog_sales cs ON hd.hd_demo_sk = cs.cs_bill_hdemo_sk OR hd.hd_demo_sk = cs.cs_ship_hdemo_sk LEFT JOIN store_returns sr ON hd.hd_demo_sk = sr.sr_hdemo_sk LEFT JOIN time_dim td ON cs.cs_sold_time_sk = td.t_time_sk OR sr.sr_return_time_sk = td.t_time_sk WHERE (cs.cs_ship_cdemo_sk IN ('512236', '76858', '1078452', '1665528', '234732', '598521') OR cs.cs_ext_ship_cost IN ('4483.57', '946.40', '622.83', '8.12', '342.58', '889.92')) AND (td.t_time_id IN ('AAAAAAAAAKIAAAAA', 'AAAAAAAAHKMAAAAA', 'AAAAAAAAEJNAAAAA', 'AAAAAAAADIOAAAAA', 'AAAAAAAAKMOAAAAA') OR td.t_minute IN ('17', '18', '57', '25')) GROUP BY hd.hd_income_band_sk ORDER BY total_net_profit DESC, total_orders DESC;
SELECT cd.cd_gender, cd.cd_marital_status, cd.cd_education_status, ib.ib_income_band_sk, ib.ib_lower_bound, ib.ib_upper_bound, COUNT(DISTINCT ws.ws_order_number) AS web_order_count, SUM(ws.ws_net_paid) AS total_web_sales, AVG(ws.ws_quantity) AS average_web_quantity, SUM(sr.sr_return_amt) AS total_return_amount, AVG(sr.sr_return_quantity) AS average_return_quantity, COUNT(DISTINCT sr.sr_ticket_number) AS return_ticket_count FROM customer_demographics cd JOIN web_sales ws ON cd.cd_demo_sk = ws.ws_bill_cdemo_sk JOIN income_band ib ON cd.cd_purchase_estimate BETWEEN ib.ib_lower_bound AND ib.ib_upper_bound LEFT JOIN store_returns sr ON ws.ws_bill_customer_sk = sr.sr_customer_sk AND ws.ws_item_sk = sr.sr_item_sk WHERE cd.cd_dep_count IN ('1', '2') AND ib.ib_income_band_sk IN ('1', '10', '19', '16', '6') AND ws.ws_bill_addr_sk IN ('46947', '12502', '40790', '6718') AND sr.sr_ticket_number IN ('40231', '36947', '37079', '39174', '39687') AND sr.sr_store_credit IN ('113.23', '47.72', '298.96', '136.00', '370.20', '203.23') GROUP BY cd.cd_gender, cd.cd_marital_status, cd.cd_education_status, ib.ib_income_band_sk, ib.ib_lower_bound, ib.ib_upper_bound ORDER BY total_web_sales DESC, total_return_amount DESC;
SELECT i.i_category, s.s_state, s.s_market_id, COUNT(DISTINCT i.i_item_sk) AS total_items, AVG(i.i_current_price) AS avg_price, SUM(i.i_wholesale_cost) AS total_wholesale_cost, COUNT(DISTINCT wp.wp_web_page_sk) AS total_web_pages, wp.wp_type, COUNT(DISTINCT wp.wp_customer_sk) AS total_customers_accessed FROM item i JOIN store s ON i.i_manufact_id = s.s_company_id JOIN web_page wp ON wp.wp_type = 'order' WHERE i.i_category IN ('Books', 'Sports', 'Women', 'Men') AND s.s_state = 'TN' AND s.s_market_id = '7' AND i.i_current_price BETWEEN 2.21 AND 81.80 AND (wp.wp_creation_date_sk BETWEEN '2450811' AND '2450813' OR wp.wp_creation_date_sk = '2450808') GROUP BY i.i_category, s.s_state, s.s_market_id, wp.wp_type ORDER BY total_items DESC, avg_price DESC, total_wholesale_cost DESC;
SELECT hd.hd_income_band_sk, SUM(sr.sr_return_quantity) AS total_returned_quantity, AVG(sr.sr_return_amt) AS average_return_amount, COUNT(DISTINCT sr.sr_customer_sk) AS unique_customers_returned, SUM(CASE WHEN p.p_channel_email = 'Y' THEN sr.sr_return_quantity ELSE 0 END) AS email_promo_returned_quantity, SUM(sr.sr_net_loss) AS total_net_loss FROM store_returns sr JOIN household_demographics hd ON sr.sr_hdemo_sk = hd.hd_demo_sk JOIN promotion p ON sr.sr_item_sk = p.p_item_sk JOIN inventory i ON sr.sr_item_sk = i.inv_item_sk AND i.inv_warehouse_sk = 1 WHERE hd.hd_demo_sk IN (1588, 4700) AND sr.sr_refunded_cash IN (10.38, 1818.70) GROUP BY hd.hd_income_band_sk ORDER BY total_net_loss DESC;
SELECT s.s_store_id, s.s_store_name, s.s_city, s.s_state, s.s_country, s.s_tax_precentage, COUNT(DISTINCT inv.inv_item_sk) AS unique_items, SUM(inv.inv_quantity_on_hand) AS total_inventory, AVG(inv.inv_quantity_on_hand) AS avg_inventory, MAX(i.i_current_price) AS max_item_price, MIN(i.i_current_price) AS min_item_price, AVG(i.i_current_price) AS avg_item_price, COUNT(DISTINCT ca.ca_address_sk) AS customer_address_count, SUM(CASE WHEN d.d_weekend = 'Y' THEN 1 ELSE 0 END) AS weekend_days, SUM(CASE WHEN d.d_holiday = 'Y' THEN 1 ELSE 0 END) AS holiday_days FROM store s JOIN inventory inv ON s.s_store_sk = inv.inv_warehouse_sk JOIN item i ON inv.inv_item_sk = i.i_item_sk JOIN date_dim d ON inv.inv_date_sk = d.d_date_sk JOIN customer_address ca ON s.s_zip = ca.ca_zip WHERE s.s_country = 'United States' AND d.d_month_seq IN (68, 76, 131) AND d.d_current_day = 'N' AND d.d_last_dom IN (2419461, 2416174, 2419399) AND d.d_week_seq IN (41, 224, 47) AND inv.inv_warehouse_sk IN (2, 1) AND inv.inv_item_sk IN (6787, 15910, 13876) AND i.i_item_id IN ('AAAAAAAAJEGAAAAA', 'AAAAAAAAOICBAAAA', 'AAAAAAAAKECBAAAA') AND i.i_rec_start_date IN ('2001-10-27', '1999-10-28', '1997-10-27') AND i.i_current_price IN (9.36, 0.92, 7.12) AND i.i_container = 'Unknown' AND ca.ca_street_number IN ('244', '496', '119') AND ca.ca_zip IN ('82293', '14244', '98877') GROUP BY s.s_store_id, s.s_store_name, s.s_city, s.s_state, s.s_country, s.s_tax_precentage ORDER BY s.s_store_name, total_inventory DESC;
SELECT cc.cc_name, i.i_category, SUM(ss.ss_quantity) AS total_quantity, AVG(ss.ss_sales_price) AS avg_sales_price, COUNT(DISTINCT ss.ss_ticket_number) AS number_of_sales, SUM(ss.ss_net_paid) AS total_net_paid, SUM(ss.ss_net_paid_inc_tax) AS total_net_paid_inc_tax, SUM(ss.ss_net_profit) AS total_net_profit FROM store_sales ss JOIN item i ON ss.ss_item_sk = i.i_item_sk JOIN call_center cc ON cc.cc_division = i.i_class_id JOIN warehouse w ON w.w_warehouse_sk = cc.cc_division WHERE cc.cc_call_center_sk IN ('5', '3', '1') AND cc.cc_division IN ('1', '4', '5', '3') AND w.w_warehouse_sk IN ('3', '5', '1', '4', '2') AND ss.ss_net_paid_inc_tax = '3682.66' GROUP BY cc.cc_name, i.i_category ORDER BY total_net_paid DESC, avg_sales_price DESC;
SELECT c.c_customer_id, sm.sm_type as shipping_type, count(cs_order_number) as total_orders, sum(cs_quantity) as total_quantity, avg(cs_net_paid) as average_net_paid, sum(cs_net_profit) as total_net_profit, date_part('year', d.d_date) as sale_year, d.d_quarter_name as sale_quarter, ib.ib_lower_bound as income_band_lower_bound, ib.ib_upper_bound as income_band_upper_bound FROM catalog_sales cs JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk JOIN ship_mode sm ON cs.cs_ship_mode_sk = sm.sm_ship_mode_sk JOIN income_band ib ON c.c_current_hdemo_sk = ib.ib_income_band_sk WHERE d.d_year = 2023 AND sm.sm_code = 'SEA' AND ib.ib_lower_bound >= 30001 AND ib.ib_upper_bound <= 80001 GROUP BY c.c_customer_id, shipping_type, sale_year, sale_quarter, income_band_lower_bound, income_band_upper_bound ORDER BY total_net_profit DESC, total_orders DESC;
SELECT i_category, i_class, w_warehouse_name, w_city, w_state, EXTRACT(YEAR FROM i_rec_start_date) AS year_introduced, SUM(cs_sales_price) AS total_sales, AVG(cs_sales_price) AS avg_sales_price, COUNT(DISTINCT cs_order_number) AS total_orders, SUM(inv_quantity_on_hand) AS total_inventory FROM item JOIN catalog_sales ON cs_item_sk = i_item_sk JOIN warehouse ON cs_warehouse_sk = w_warehouse_sk JOIN inventory ON inv_item_sk = i_item_sk AND inv_warehouse_sk = w_warehouse_sk JOIN time_dim ON cs_sold_time_sk = t_time_sk WHERE w_warehouse_name = 'Central' AND t_shift = 'third' AND cs_ship_mode_sk IN ('12', '20', '5') AND t_time IN ('1847', '2034', '2419', '4815', '2779') AND i_rec_start_date >= '2000-01-01' GROUP BY i_category, i_class, w_warehouse_name, w_city, w_state, year_introduced ORDER BY total_sales DESC, total_orders DESC LIMIT 100;
SELECT cd.cd_education_status, COUNT(*) AS total_customers, AVG(cd.cd_purchase_estimate) AS avg_purchase_estimate, SUM(cs.cs_quantity) AS total_items_sold, SUM(cs.cs_net_paid) AS total_revenue, SUM(sr.sr_return_quantity) AS total_items_returned, SUM(sr.sr_net_loss) AS total_loss FROM customer_demographics cd LEFT JOIN catalog_sales cs ON cd.cd_demo_sk = cs.cs_bill_cdemo_sk LEFT JOIN store_returns sr ON cd.cd_demo_sk = sr.sr_cdemo_sk WHERE cd.cd_credit_rating IN ('High Risk', 'Low Risk', 'Good') AND cs.cs_order_number IN (136032, 15467, 59785, 76201, 136250, 105478) AND sr.sr_item_sk IN (13089, 10527, 1538, 10362, 3961) AND sr.sr_hdemo_sk IN (1928, 4567, 1918, 2937) GROUP BY cd.cd_education_status ORDER BY total_revenue DESC;
SELECT cc.cc_call_center_id, cc.cc_name, cc.cc_class, ws.web_site_id, ws.web_name, ws.web_class, SUM(cs.cs_net_paid) AS total_sales, AVG(cs.cs_ext_discount_amt) AS avg_discount, COUNT(DISTINCT cs.cs_order_number) AS total_orders FROM call_center cc JOIN catalog_sales cs ON cc.cc_call_center_sk = cs.cs_call_center_sk JOIN web_site ws ON cc.cc_mkt_id = ws.web_mkt_id JOIN catalog_page cp ON cs.cs_catalog_page_sk = cp.cp_catalog_page_sk WHERE cc.cc_mkt_class IN ('A bit narrow forms matter animals.', 'Dealers make most historical, direct students') AND cp.cp_catalog_page_sk BETWEEN 4000 AND 4200 AND cp.cp_description IN ('Women apply in vain in the minutes. Officials can', 'Better fine individuals predict small, optimistic') GROUP BY cc.cc_call_center_id, cc.cc_name, cc.cc_class, ws.web_site_id, ws.web_name, ws.web_class ORDER BY total_sales DESC;
SELECT c.c_first_name, c.c_last_name, SUM(w.w_warehouse_sq_ft) AS total_warehouse_sq_ft, AVG(s.s_number_employees) AS avg_store_employees, COUNT(DISTINCT wp.wp_web_page_sk) AS total_web_pages, MAX(sm.sm_code) AS max_ship_mode_code FROM customer c JOIN web_page wp ON c.c_customer_sk = wp.wp_customer_sk JOIN store s ON s.s_zip = CAST(c.c_current_addr_sk AS CHAR(10)) JOIN warehouse w ON w.w_zip = s.s_zip JOIN ship_mode sm ON sm.sm_code = w.w_zip WHERE w.w_gmt_offset = '-5.00' AND (wp.wp_char_count = '2129' OR wp.wp_char_count = '2531') AND (wp.wp_rec_end_date = '1999-09-03' OR wp.wp_rec_end_date = '2001-09-02' OR wp.wp_rec_end_date = '2000-09-02') GROUP BY c.c_first_name, c.c_last_name;
SELECT wp.wp_type AS web_page_type, i.i_brand AS item_brand, ca.ca_state AS customer_state, COUNT(DISTINCT ws.ws_order_number) AS total_orders, SUM(ws.ws_quantity) AS total_items_sold, SUM(ws.ws_sales_price) AS total_sales, AVG(i.i_wholesale_cost) AS average_wholesale_cost FROM web_sales ws JOIN web_page wp ON ws.ws_web_page_sk = wp.wp_web_page_sk JOIN item i ON ws.ws_item_sk = i.i_item_sk JOIN customer_address ca ON ws.ws_ship_addr_sk = ca.ca_address_sk WHERE wp.wp_autogen_flag = 'Y' AND wp.wp_type IN ('order', 'dynamic') AND i.i_brand IN ('brandunivamalg #10', 'scholarbrand #7', 'maxibrand #2') GROUP BY web_page_type, item_brand, customer_state ORDER BY total_sales DESC, total_orders DESC LIMIT 10;
SELECT s.s_state AS store_state, s.s_city AS store_city, SUM(s.s_floor_space) AS total_store_floor_space, SUM(s.s_number_employees) AS total_store_employees, AVG(s.s_tax_precentage) AS avg_store_tax_percentage, COUNT(DISTINCT w.w_warehouse_sk) AS total_warehouses, SUM(w.w_warehouse_sq_ft) AS total_warehouse_sq_ft, AVG(wp.wp_image_count) AS avg_webpage_image_count, AVG(wp.wp_link_count) AS avg_webpage_link_count FROM store s LEFT JOIN warehouse w ON s.s_city = w.w_city AND s.s_state = w.w_state LEFT JOIN web_page wp ON s.s_store_sk = wp.wp_customer_sk WHERE s.s_geography_class = 'Unknown' AND w.w_street_name IN ('View First', 'Wilson Elm', '6th', 'Ash Laurel') AND w.w_warehouse_id IN ('AAAAAAAACAAAAAAA', 'AAAAAAAAFAAAAAAA', 'AAAAAAAADAAAAAAA') AND wp.wp_url = 'http://www.foo.com' AND wp.wp_web_page_sk IN ('33', '24', '36', '14', '7', '49') GROUP BY s.s_state, s.s_city ORDER BY s.s_state, s.s_city;
SELECT w.w_warehouse_name, w.w_city, w.w_state, w.w_country, d.d_year, d.d_quarter_name, COUNT(DISTINCT ws.ws_order_number) AS total_web_orders, SUM(ws.ws_quantity) AS total_web_quantity, AVG(ws.ws_sales_price) AS avg_web_sales_price, SUM(ws.ws_net_paid) AS total_web_net_paid, COUNT(DISTINCT ss.ss_ticket_number) AS total_store_sales, SUM(ss.ss_quantity) AS total_store_quantity, AVG(ss.ss_sales_price) AS avg_store_sales_price, SUM(ss.ss_net_paid) AS total_store_net_paid, SUM(CASE WHEN hd.hd_dep_count BETWEEN 3 AND 5 THEN 1 ELSE 0 END) AS households_with_3_to_5_dependents, SUM(CASE WHEN hd.hd_vehicle_count BETWEEN 1 AND 4 THEN 1 ELSE 0 END) AS households_with_1_to_4_vehicles FROM warehouse w LEFT JOIN web_sales ws ON w.w_warehouse_sk = ws.ws_warehouse_sk LEFT JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk LEFT JOIN household_demographics hd ON ws.ws_ship_hdemo_sk = hd.hd_demo_sk LEFT JOIN store_sales ss ON d.d_date_sk = ss.ss_sold_date_sk AND hd.hd_demo_sk = ss.ss_hdemo_sk WHERE w.w_city = 'Fairview' AND w.w_suite_number IN ('Suite P', 'Suite 0', 'Suite 80') AND w.w_street_type IN ('Avenue', 'Parkway', 'Drive') AND w.w_country = 'United States' AND hd.hd_dep_count IN (3, 4, 5) AND hd.hd_buy_potential IN ('5001-10000', 'Unknown', '501-1000') AND hd.hd_vehicle_count IN (1, 3, 4) AND d.d_following_holiday IN ('N', 'Y') AND d.d_last_dom IN ('2418672', '2418852', '2416539') AND d.d_month_seq IN (24, 151, 94) AND d.d_holiday IN ('N', 'Y') GROUP BY w.w_warehouse_name, w.w_city, w.w_state, w.w_country, d.d_year, d.d_quarter_name ORDER BY w.w_warehouse_name, d.d_year, d.d_quarter_name;
SELECT cp_department, i_category, i_class, COUNT(DISTINCT i_item_sk) AS item_count, SUM(i_current_price) AS total_price, AVG(i_current_price) AS average_price, AVG(i_wholesale_cost) AS average_cost, SUM(i_wholesale_cost) AS total_cost, sm_type, COUNT(DISTINCT sm_ship_mode_sk) AS ship_mode_count FROM catalog_page JOIN item ON (cp_catalog_page_sk = i_item_sk) JOIN ship_mode ON (i_item_sk = sm_ship_mode_sk) WHERE cp_catalog_page_sk IN (2547, 2038, 1714) GROUP BY cp_department, i_category, i_class, sm_type ORDER BY cp_department, i_category, i_class;
SELECT ws.web_manager, ws.web_class, COUNT(DISTINCT sr.sr_ticket_number) AS total_return_transactions, SUM(sr.sr_return_amt_inc_tax) AS total_return_amount_inc_tax, COUNT(DISTINCT cr.cr_order_number) AS total_catalog_return_transactions, SUM(cr.cr_return_amt_inc_tax) AS total_catalog_return_amount_inc_tax, COUNT(DISTINCT p.p_promo_sk) AS total_promotions, SUM(p.p_cost) AS total_promotion_cost FROM web_site ws LEFT JOIN store_returns sr ON ws.web_site_sk = sr.sr_store_sk LEFT JOIN catalog_returns cr ON ws.web_site_sk = cr.cr_catalog_page_sk LEFT JOIN promotion p ON cr.cr_item_sk = p.p_item_sk AND cr.cr_returned_date_sk BETWEEN p.p_start_date_sk AND p.p_end_date_sk WHERE ws.web_manager = 'Jimmy Pope' AND (ws.web_zip = '35709' OR ws.web_zip = '31904') GROUP BY ws.web_manager, ws.web_class ORDER BY total_return_amount_inc_tax DESC, total_catalog_return_amount_inc_tax DESC;
SELECT c.c_first_name, c.c_last_name, ca.ca_state, ca.ca_county, SUM(cs.cs_sales_price) AS total_sales, AVG(cs.cs_sales_price) AS avg_sales_price, COUNT(cs.cs_order_number) AS number_of_orders, SUM(cr.cr_return_amount) AS total_returns, AVG(cr.cr_return_amount) AS avg_return_amount, COUNT(DISTINCT cr.cr_order_number) AS number_of_returns FROM customer c JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk JOIN catalog_sales cs ON c.c_customer_sk = cs.cs_bill_customer_sk LEFT JOIN catalog_returns cr ON cs.cs_order_number = cr.cr_order_number AND cs.cs_item_sk = cr.cr_item_sk JOIN store s ON ca.ca_county = s.s_county AND ca.ca_state = s.s_state JOIN catalog_page cp ON cs.cs_catalog_page_sk = cp.cp_catalog_page_sk WHERE c.c_birth_year IN ('1972', '1975', '1960') AND ca.ca_state = 'TN' AND s.s_county = 'Williamson County' AND cp.cp_description LIKE '%nuclear%' OR cp.cp_description LIKE '%optimistic%' AND cp.cp_end_date_sk IN ('2451239', '2450934', '2450904', '2451389') GROUP BY c.c_first_name, c.c_last_name, ca.ca_state, ca.ca_county ORDER BY total_sales DESC, total_returns DESC LIMIT 100;
SELECT d_year, d_moy, c.c_last_name, cd.cd_education_status, cd.cd_marital_status, COUNT(*) AS customer_count, SUM(cd.cd_purchase_estimate) AS total_purchase_estimate, AVG(cd.cd_dep_count) AS average_dependents, AVG(cd.cd_dep_employed_count) AS average_employed_dependents, AVG(cd.cd_dep_college_count) AS average_college_dependents FROM customer c JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk JOIN date_dim d ON c.c_first_sales_date_sk = d.d_date_sk WHERE c.c_first_sales_date_sk IN (2449879, 2452004, 2451328, 2452389, 2450342, 2449052) AND c.c_last_name IN ('Searcy', 'Joyner', 'Livingston', 'Wise', 'Webb', 'Branch') AND cd.cd_marital_status IN ('S', 'U', 'W', 'M') AND cd.cd_education_status = 'Advanced Degree' AND d.d_last_dom IN ('2417090', '2415990') GROUP BY d_year, d_moy, c.c_last_name, cd.cd_education_status, cd.cd_marital_status ORDER BY d_year DESC, d_moy DESC, c.c_last_name;
