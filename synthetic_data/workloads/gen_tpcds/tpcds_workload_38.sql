SELECT i.i_category, i.i_brand, t.t_shift, COUNT(DISTINCT ss.ss_ticket_number) AS total_sales_transactions, SUM(ss.ss_quantity) AS total_quantities_sold, AVG(ss.ss_sales_price) AS average_selling_price, SUM(ss.ss_net_paid) AS total_net_paid, SUM(ss.ss_net_paid_inc_tax) - SUM(ss.ss_net_paid) AS total_tax_collected, SUM(ss.ss_net_profit) AS total_net_profit FROM store_sales ss JOIN item i ON ss.ss_item_sk = i.i_item_sk JOIN time_dim t ON ss.ss_sold_time_sk = t.t_time_sk WHERE ss.ss_sold_date_sk IN (2451375, 2451147, 2451762, 2451572, 2452439, 2452222) AND ss.ss_sales_price BETWEEN 4.90 AND 95.65 GROUP BY i.i_category, i.i_brand, t.t_shift ORDER BY total_net_profit DESC, i.i_category, i.i_brand, t.t_shift;
SELECT cc.cc_name AS call_center_name, st.s_store_name AS store_name, st.s_state AS store_state, ws.web_name AS website_name, p.p_promo_name AS promotion_name, p.p_channel_details AS promotion_channel_details, SUM(ss.ss_quantity) AS total_quantity_sold, AVG(ss.ss_sales_price) AS average_sales_price, SUM(ss.ss_net_paid) AS total_net_sales, SUM(ss.ss_net_profit) AS total_net_profit FROM call_center cc JOIN store_sales ss ON cc.cc_call_center_sk = ss.ss_store_sk JOIN store st ON ss.ss_store_sk = st.s_store_sk JOIN web_site ws ON st.s_market_id = ws.web_mkt_id JOIN promotion p ON ss.ss_promo_sk = p.p_promo_sk WHERE cc.cc_manager IN ('Mark Hightower', 'Felipe Perkins', 'Bob Belcher') AND cc.cc_call_center_id = 'AAAAAAAAEAAAAAAA' AND st.s_market_id IN (4, 6, 7, 2, 8, 10) AND st.s_country = 'United States' AND p.p_start_date_sk IN (2450694, 2450318, 2450696, 2450508, 2450764, 2450750) AND ss.ss_customer_sk IN (169, 28519, 57009, 32392) GROUP BY call_center_name, store_name, store_state, website_name, promotion_name, promotion_channel_details ORDER BY total_net_sales DESC;
SELECT dd.d_year AS sale_year, dd.d_moy AS sale_month, dd.d_dom AS sale_day, COUNT(DISTINCT ss.ss_ticket_number) AS store_sales_count, SUM(ss.ss_quantity) AS store_items_sold, AVG(ss.ss_sales_price) AS avg_store_sale_price, SUM(cs.cs_net_paid_inc_tax) AS catalog_total_revenue_inc_tax, SUM(ws.ws_net_paid_inc_ship_tax) AS web_total_revenue_inc_ship_tax, AVG(cc.cc_employees) AS avg_call_center_employees, ws.ws_web_site_sk, web_site.web_name FROM store_sales ss JOIN date_dim dd ON ss.ss_sold_date_sk = dd.d_date_sk JOIN catalog_sales cs ON ss.ss_sold_date_sk = cs.cs_sold_date_sk JOIN web_sales ws ON ss.ss_sold_date_sk = ws.ws_sold_date_sk JOIN call_center cc ON cs.cs_call_center_sk = cc.cc_call_center_sk JOIN web_site ON ws.ws_web_site_sk = web_site.web_site_sk WHERE dd.d_year = 2000 AND ss.ss_list_price BETWEEN 100 AND 200 AND ws.ws_quantity IN (64, 84, 57) AND cc.cc_open_date_sk IS NOT NULL AND ws.ws_web_page_sk IN (211, 510, 171, 90, 132, 78) AND dd.d_last_dom IN ('2418669', '2418489', '2415993', '2419340', '2418000', '2417392') GROUP BY sale_year, sale_month, sale_day, ws.ws_web_site_sk, web_site.web_name ORDER BY sale_year, sale_month, sale_day, ws.ws_web_site_sk;
SELECT cd.cd_gender, cd.cd_marital_status, SUM(cr.cr_return_amount) AS total_return_amount, AVG(cr.cr_return_amount) AS avg_return_amount, COUNT(cr.cr_return_amount) AS return_count, AVG(cs.cs_sales_price) AS avg_sales_price, COUNT(cs.cs_sales_price) AS sales_count FROM catalog_returns cr JOIN customer_demographics cd ON (cr.cr_returning_cdemo_sk = cd.cd_demo_sk OR cr.cr_refunded_cdemo_sk = cd.cd_demo_sk) JOIN catalog_sales cs ON (cr.cr_order_number = cs.cs_order_number) GROUP BY cd.cd_gender, cd.cd_marital_status ORDER BY total_return_amount DESC, avg_sales_price DESC, return_count DESC, sales_count DESC;
SELECT c.c_customer_sk, ca.ca_state, SUM(inv.inv_quantity_on_hand) AS total_inventory, AVG(hd.hd_dep_count) AS avg_dependency_count, COUNT(DISTINCT w.w_warehouse_sk) AS number_of_warehouses, MAX(t.t_time) AS latest_time FROM customer c JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk JOIN inventory inv ON inv.inv_warehouse_sk = ca.ca_address_sk JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk JOIN time_dim t ON inv.inv_date_sk = t.t_time_sk WHERE ca.ca_state IN ('TX', 'NV') AND hd.hd_vehicle_count = 2 AND t.t_sub_shift = 'night' AND c.c_birth_month IN (2, 9, 12, 4, 5) AND c.c_birth_year IN (1928, 1924) GROUP BY c.c_customer_sk, ca.ca_state ORDER BY total_inventory DESC, avg_dependency_count, number_of_warehouses, latest_time;
SELECT sm.sm_type AS shipping_type, web.web_site_sk, web.web_name AS website_name, COUNT(DISTINCT ws.ws_order_number) AS total_orders, SUM(ws.ws_net_paid) AS total_revenue, AVG(ws.ws_quantity) AS average_quantity, AVG(ws.ws_ext_discount_amt) AS average_discount, SUM(ws.ws_coupon_amt) AS total_coupon_amount, SUM(ws.ws_net_profit) AS total_profit FROM web_sales ws JOIN web_site web ON ws.ws_web_site_sk = web.web_site_sk JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk WHERE web.web_name IN ('site_3', 'site_4', 'site_1', 'site_0', 'site_2') AND sm.sm_contract IN ('GNJr3g5i7oorKqtX', 'uukTktPYycct8', 'ldhM8IvpzHgdbBgDfI', '2mM8l') AND ws.ws_sold_date_sk BETWEEN 20230101 AND 20231231 GROUP BY sm.sm_type, web.web_site_sk, web.web_name ORDER BY total_revenue DESC;
SELECT d_year, sm_type, COUNT(DISTINCT inv_warehouse_sk) AS number_of_warehouses, SUM(inv_quantity_on_hand) AS total_quantity_on_hand, AVG(inv_quantity_on_hand) AS average_quantity_per_warehouse, MAX(inv_quantity_on_hand) AS max_quantity_in_warehouse, MIN(inv_quantity_on_hand) AS min_quantity_in_warehouse FROM inventory JOIN date_dim ON inv_date_sk = d_date_sk JOIN ship_mode ON sm_ship_mode_id = 'AAAAAAAAEAAAAAAA' WHERE d_year = 2023 AND d_day_name = 'Saturday' AND inv_warehouse_sk IN (1, 2) AND d_current_week = 'N' GROUP BY d_year, sm_type ORDER BY total_quantity_on_hand DESC, average_quantity_per_warehouse DESC LIMIT 100;
SELECT p.p_promo_name, p.p_channel_details, cp.cp_department, w.w_state, AVG(ws_net_profit) AS avg_web_sales_profit, AVG(wr_net_loss) AS avg_web_returns_loss, SUM(ws_quantity) AS total_quantity_sold, COUNT(DISTINCT ws_web_page_sk) AS count_unique_pages_sold, COUNT(DISTINCT wr_web_page_sk) AS count_unique_pages_returned FROM promotion p JOIN web_sales ws ON p.p_promo_sk = ws.ws_promo_sk JOIN catalog_page cp ON ws.ws_web_page_sk = cp.cp_catalog_page_sk JOIN warehouse w ON ws.ws_warehouse_sk = w.w_warehouse_sk LEFT JOIN web_returns wr ON ws.ws_item_sk = wr.wr_item_sk AND ws.ws_order_number = wr.wr_order_number WHERE cp.cp_start_date_sk BETWEEN '2450906' AND '2451420' AND cp.cp_end_date_sk BETWEEN '2451419' AND '2451664' AND (wr.wr_returned_date_sk IS NULL OR wr.wr_returned_date_sk BETWEEN ws_sold_date_sk AND ws_sold_date_sk + 30) GROUP BY p.p_promo_name, p.p_channel_details, cp.cp_department, w.w_state ORDER BY avg_web_sales_profit DESC, avg_web_returns_loss DESC;
SELECT cp.cp_department, COUNT(DISTINCT cs.cs_item_sk) AS distinct_items_sold, SUM(cs.cs_quantity) AS total_quantity_sold, SUM(cs.cs_ext_sales_price) AS total_sales, AVG(cs.cs_sales_price) AS average_sales_price, SUM(cs.cs_ext_discount_amt) AS total_discount_amount FROM catalog_sales cs JOIN catalog_page cp ON cs.cs_catalog_page_sk = cp.cp_catalog_page_sk WHERE cs.cs_sold_date_sk BETWEEN cp.cp_start_date_sk AND cp.cp_end_date_sk GROUP BY cp.cp_department ORDER BY total_sales DESC;
SELECT p.p_promo_name, p.p_channel_details, COUNT(*) AS num_promotions, AVG(p.p_cost) AS avg_promo_cost, SUM(p.p_response_target) AS total_response_target, ca.ca_country, ca.ca_state, ca.ca_city, AVG(hd.hd_dep_count) AS avg_dependency_count, AVG(hd.hd_vehicle_count) AS avg_vehicle_count, SUM(CASE WHEN hd.hd_buy_potential = 'High' THEN 1 ELSE 0 END) AS high_buy_potential_count, SUM(CASE WHEN hd.hd_buy_potential = 'Low' THEN 1 ELSE 0 END) AS low_buy_potential_count FROM promotion p JOIN household_demographics hd ON p.p_item_sk = hd.hd_demo_sk JOIN customer_address ca ON hd.hd_demo_sk = ca.ca_address_sk WHERE ca.ca_address_id IN ('AAAAAAAAOBJAAAAA', 'AAAAAAAAINCBAAAA', 'AAAAAAAABBBBAAAA') AND p.p_discount_active = 'Y' GROUP BY ROLLUP (p.p_promo_name, p.p_channel_details, ca.ca_country, ca.ca_state, ca.ca_city) ORDER BY ca.ca_country, ca.ca_state, ca.ca_city, p.p_promo_name;
