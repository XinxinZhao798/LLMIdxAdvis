SELECT dd.d_year, dd.d_quarter_name, ca.ca_country, ca.ca_state, COUNT(DISTINCT ss.ss_ticket_number) AS total_sales_transactions, SUM(ss.ss_quantity) AS total_quantity_sold, AVG(ss.ss_sales_price) AS average_sales_price, SUM(ss.ss_net_paid) AS total_net_paid, SUM(ss.ss_net_paid_inc_tax) AS total_net_paid_inc_tax, SUM(ss.ss_net_profit) AS total_net_profit, COUNT(DISTINCT web.web_site_sk) AS distinct_websites, COUNT(DISTINCT wp.wp_web_page_sk) AS distinct_web_pages FROM store_sales ss JOIN date_dim dd ON ss.ss_sold_date_sk = dd.d_date_sk JOIN customer_address ca ON ss.ss_addr_sk = ca.ca_address_sk JOIN web_page wp ON wp.wp_customer_sk = ss.ss_customer_sk JOIN web_site web ON web.web_company_id = wp.wp_web_page_sk WHERE dd.d_year = 1998 AND ca.ca_country = 'United States' AND ca.ca_state IN ('NY', 'CA', 'TX') AND web.web_company_id IN ('6', '3', '5') AND wp.wp_autogen_flag = 'N' GROUP BY ROLLUP (dd.d_year, dd.d_quarter_name, ca.ca_country, ca.ca_state) ORDER BY dd.d_year, dd.d_quarter_name, ca.ca_country, ca.ca_state;
SELECT ws.ws_web_site_sk, ws.ws_item_sk, i.i_product_name, i.i_category, sm.sm_type AS shipping_type, w.w_state AS warehouse_state, ca.ca_state AS customer_state, COUNT(*) AS total_orders, SUM(ws.ws_quantity) AS total_quantity_sold, AVG(ws.ws_sales_price) AS average_sales_price, SUM(ws.ws_net_paid) AS total_net_paid, SUM(ws.ws_net_profit) AS total_net_profit, AVG(ws.ws_net_profit) AS average_net_profit FROM web_sales ws JOIN item i ON ws.ws_item_sk = i.i_item_sk JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk JOIN warehouse w ON ws.ws_warehouse_sk = w.w_warehouse_sk JOIN customer_address ca ON ws.ws_ship_addr_sk = ca.ca_address_sk WHERE ca.ca_gmt_offset IN ('-8.00', '-10.00', '-5.00', '-9.00', '-7.00') AND (w.w_zip = '35709' OR w.w_zip = '31904') GROUP BY ws.ws_web_site_sk, ws.ws_item_sk, i.i_product_name, i.i_category, sm.sm_type, w.w_state, ca.ca_state ORDER BY total_net_profit DESC, total_orders DESC LIMIT 100;
SELECT d_year, d_quarter_name, s_state, COUNT(DISTINCT s_store_sk) AS number_of_stores, SUM(s_number_employees) AS total_employees, AVG(s_floor_space) AS avg_floor_space, SUM(wp_char_count) AS total_char_count, AVG(wp_link_count) AS avg_link_count, AVG(wp_image_count) AS avg_image_count, COUNT(DISTINCT wp_web_page_sk) AS number_of_web_pages, SUM(CASE WHEN wp_max_ad_count = 3 THEN 1 ELSE 0 END) AS count_max_ad_3, AVG(s_tax_precentage) AS avg_tax_percentage FROM store JOIN date_dim ON s_rec_end_date = d_date LEFT JOIN web_page ON wp_access_date_sk = d_date_sk WHERE s_rec_end_date BETWEEN '1999-01-01' AND '2001-12-31' AND wp_url LIKE 'http://www.foo.com%' AND wp_max_ad_count IN ('1', '2', '3', '4') GROUP BY d_year, d_quarter_name, s_state ORDER BY d_year DESC, d_quarter_name, s_state;
SELECT d.d_year, d.d_month_seq, COUNT(DISTINCT cp.cp_catalog_page_sk) AS total_catalog_pages, AVG(w.w_warehouse_sq_ft) AS avg_warehouse_size, SUM(p.p_cost) AS total_promotion_cost, COUNT(DISTINCT ca.ca_state) AS num_states_with_customers, COUNT(DISTINCT w.w_state) AS num_states_with_warehouses, SUM(CASE WHEN p.p_channel_press = 'N' THEN p.p_cost ELSE 0 END) AS total_cost_non_press_channel FROM date_dim d JOIN catalog_page cp ON (d.d_date_sk = cp.cp_start_date_sk OR d.d_date_sk = cp.cp_end_date_sk) JOIN promotion p ON (p.p_start_date_sk = d.d_date_sk OR p.p_end_date_sk = d.d_date_sk) JOIN customer_address ca ON cp.cp_catalog_page_sk = ca.ca_address_sk JOIN warehouse w ON w.w_zip = ca.ca_zip WHERE d.d_fy_quarter_seq IN (41, 35, 15, 54, 14, 9) AND cp.cp_catalog_number IN (27, 41) AND d.d_year = 2023 GROUP BY d.d_year, d.d_month_seq ORDER BY d.d_year, d.d_month_seq;
SELECT w_state, COUNT(DISTINCT w_warehouse_sk) AS total_warehouses, SUM(w_warehouse_sq_ft) AS total_warehouse_sq_ft, AVG(w_warehouse_sq_ft) AS avg_warehouse_sq_ft, SUM(sr_return_amt) AS total_return_amt, AVG(sr_return_amt) AS avg_return_amt, COUNT(DISTINCT sr_ticket_number) AS total_return_transactions, SUM(wp_char_count) AS total_webpage_char_count, AVG(wp_link_count) AS avg_webpage_link_count, COUNT(DISTINCT web_site_sk) AS total_websites, SUM(web_tax_percentage) AS total_web_tax_percentage, AVG(web_tax_percentage) AS avg_web_tax_percentage FROM warehouse w LEFT JOIN store_returns sr ON w.w_warehouse_sk = sr.sr_store_sk LEFT JOIN web_page wp ON w.w_warehouse_sk = wp.wp_customer_sk LEFT JOIN web_site ws ON wp.wp_web_page_sk = ws.web_site_sk GROUP BY w_state ORDER BY total_return_amt DESC;
SELECT ib.ib_income_band_sk, ib.ib_lower_bound, ib.ib_upper_bound, COUNT(DISTINCT cs.cs_order_number) AS total_orders, SUM(cs.cs_quantity) AS total_quantity_sold, AVG(cs.cs_sales_price) AS average_sales_price, SUM(cs.cs_net_profit) AS total_net_profit, AVG(hd.hd_dep_count) AS average_dependency_count, AVG(hd.hd_vehicle_count) AS average_vehicle_count, SUM(ws.ws_net_paid_inc_ship) AS total_web_net_paid_inc_ship, AVG(ws.ws_net_paid_inc_ship) AS average_web_net_paid_inc_ship, SUM(ws.ws_quantity) AS total_web_quantity_sold, COUNT(DISTINCT ws.ws_order_number) AS total_web_orders, s.s_country, s.s_tax_precentage, MAX(t.t_time) AS max_time_of_purchase, MIN(t.t_time) AS min_time_of_purchase FROM income_band ib LEFT JOIN household_demographics hd ON ib.ib_income_band_sk = hd.hd_income_band_sk LEFT JOIN catalog_sales cs ON hd.hd_demo_sk = cs.cs_bill_hdemo_sk LEFT JOIN web_sales ws ON hd.hd_demo_sk = ws.ws_bill_hdemo_sk LEFT JOIN store s ON s.s_store_sk = cs.cs_warehouse_sk LEFT JOIN time_dim t ON t.t_time_sk = cs.cs_sold_time_sk WHERE s.s_country = 'United States' AND t.t_am_pm = 'AM' AND s.s_tax_precentage IN (0.08, 0.01) AND ws.ws_net_paid_inc_ship IN (1475.10, 4030.95, 1226.89, 21728.07) AND t.t_second = 36 GROUP BY ib.ib_income_band_sk, s.s_country, s.s_tax_precentage ORDER BY total_net_profit DESC, total_web_net_paid_inc_ship DESC;
SELECT cc.cc_call_center_id, cc.cc_name, cc.cc_manager, cc.cc_county, SUM(cs.cs_quantity) AS total_quantity_sold, AVG(cs.cs_sales_price) AS average_sales_price, SUM(cs.cs_net_paid_inc_tax) AS total_net_sales_inc_tax, COUNT(*) AS total_sales_transactions, SUM(wr.wr_return_quantity) AS total_quantity_returned, SUM(wr.wr_net_loss) AS total_net_loss FROM call_center cc JOIN catalog_sales cs ON cc.cc_call_center_sk = cs.cs_call_center_sk LEFT JOIN web_returns wr ON cs.cs_item_sk = wr.wr_item_sk AND cs.cs_order_number = wr.wr_order_number WHERE cc.cc_manager IN ('Bob Belcher', 'Felipe Perkins', 'Larry Mccray', 'Mark Hightower') AND (wr.wr_net_loss = 420.16 OR wr.wr_net_loss = 722.98 OR wr.wr_net_loss IS NULL) AND cc.cc_county = 'Williamson County' AND (cs.cs_net_paid_inc_ship_tax IN (916.29, 1861.60, 1365.77, 6061.91, 2472.55) OR wr.wr_returned_time_sk IN (8001, 30891, 54739, 78943, 77408, 21386)) GROUP BY cc.cc_call_center_id, cc.cc_name, cc.cc_manager, cc.cc_county ORDER BY total_net_sales_inc_tax DESC, total_net_loss ASC;
SELECT cp.cp_department, i.i_category, sum(ss.ss_quantity) AS total_quantity_sold, avg(ss.ss_sales_price) AS average_sales_price, count(DISTINCT w.w_warehouse_sk) AS number_of_warehouses, count(DISTINCT ss.ss_customer_sk) AS number_of_customers, sum(wr.wr_return_quantity) AS total_quantity_returned, sum(wr.wr_return_amt) AS total_return_amount FROM catalog_page cp JOIN item i ON cp.cp_catalog_page_sk = i.i_item_sk JOIN store_sales ss ON i.i_item_sk = ss.ss_item_sk JOIN inventory inv ON i.i_item_sk = inv.inv_item_sk JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk LEFT JOIN web_returns wr ON i.i_item_sk = wr.wr_item_sk WHERE cp.cp_department LIKE 'DEPARTMENT%' AND i.i_manager_id IN ('54', '71', '14') AND i.i_brand_id IN ('7014003', '9006005', '10012001') AND cp.cp_catalog_page_number IN ('24', '68', '70', '62', '42') AND w.w_warehouse_id IN ('AAAAAAAAFAAAAAAA', 'AAAAAAAACAAAAAAA', 'AAAAAAAABAAAAAAA') GROUP BY cp.cp_department, i.i_category;
SELECT d_year, i_category, s_state, SUM(i_current_price) AS total_price, AVG(i_current_price) AS avg_price, COUNT(DISTINCT i_item_sk) AS unique_items_sold, COUNT(DISTINCT s_store_sk) AS number_of_stores, SUM(p_cost) AS total_promotion_cost, AVG(p_cost) AS avg_promotion_cost, COUNT(DISTINCT p_promo_sk) AS number_of_promotions, MAX(wp_max_ad_count) AS max_ad_count_webpage FROM date_dim, item, store, promotion, web_page, ship_mode WHERE i_rec_start_date <= d_date AND (i_rec_end_date IS NULL OR i_rec_end_date > d_date) AND s_rec_start_date <= d_date AND (s_rec_end_date IS NULL OR s_rec_end_date > d_date) AND wp_rec_start_date <= d_date AND (wp_rec_end_date IS NULL OR wp_rec_end_date > d_date) AND p_start_date_sk = d_date_sk AND (p_end_date_sk IS NULL OR p_end_date_sk >= d_date_sk) AND sm_type IN ('REGULAR', 'LIBRARY') AND i_class IN ('sports-apparel', 'decor', 'dvd/vcr players', 'shirts', 'bedding', 'fishing') AND p_channel_event = 'N' AND p_purpose <> 'Unknown' GROUP BY d_year, i_category, s_state ORDER BY d_year, i_category, s_state;
SELECT ca.ca_city, ca.ca_state, i.i_category, COUNT(DISTINCT c.c_customer_sk) AS number_of_customers, AVG(i.i_current_price) AS average_item_price, SUM(i.i_wholesale_cost) AS total_wholesale_cost, COUNT(i.i_item_sk) AS items_sold, SUM(CASE WHEN c.c_birth_year = 1928 THEN 1 ELSE 0 END) AS customers_born_1928, SUM(CASE WHEN c.c_birth_year = 1948 THEN 1 ELSE 0 END) AS customers_born_1948, SUM(CASE WHEN c.c_birth_country = 'HUNGARY' THEN 1 ELSE 0 END) AS customers_from_hungary, SUM(CASE WHEN c.c_birth_country = 'GUERNSEY' THEN 1 ELSE 0 END) AS customers_from_guernsey, COUNT(DISTINCT CASE WHEN ca.ca_location_type = 'single family' THEN c.c_customer_sk END) AS single_family_homes, COUNT(DISTINCT CASE WHEN ca.ca_location_type = 'apartment' THEN c.c_customer_sk END) AS apartments, COUNT(DISTINCT CASE WHEN ca.ca_location_type = 'condo' THEN c.c_customer_sk END) AS condos FROM customer c JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk JOIN item i ON c.c_customer_sk = i.i_manager_id WHERE i.i_size IN ('economy', 'large', 'petite') AND i.i_product_name IN ('barbarbarought', 'esecallyesepri') AND ca.ca_city IN ('Watkins', 'Sawyer', 'Ruth', 'Sheffield') GROUP BY ca.ca_city, ca.ca_state, i.i_category ORDER BY ca.ca_state, ca.ca_city, i.i_category;
SELECT s_state, s_city, s_county, COUNT(DISTINCT s_store_sk) AS num_stores, SUM(ss_quantity) AS total_quantity_sold, AVG(ss_sales_price) AS average_sales_price, SUM(ss_net_paid) AS total_net_paid, SUM(ss_net_paid_inc_tax) AS total_net_paid_inc_tax, SUM(ss_net_profit) AS total_net_profit, COUNT(DISTINCT ss_customer_sk) AS unique_customers, AVG(inv_quantity_on_hand) AS average_inventory_on_hand FROM store JOIN store_sales ON s_store_sk = ss_store_sk JOIN inventory ON ss_item_sk = inv_item_sk AND ss_store_sk = inv_warehouse_sk JOIN time_dim ON ss_sold_time_sk = t_time_sk WHERE inv_quantity_on_hand IN (553, 372, 818, 629, 791, 623) AND inv_warehouse_sk IN (1, 2) AND t_hour BETWEEN 9 AND 17 GROUP BY s_state, s_city, s_county ORDER BY s_state, s_city, s_county;
SELECT hd.hd_income_band_sk, sm.sm_type, COUNT(DISTINCT wr.wr_order_number) AS total_returns, SUM(wr.wr_return_quantity) AS total_returned_quantity, AVG(wr.wr_return_amt) AS avg_return_amount, SUM(wr.wr_return_amt) AS sum_return_amount, SUM(wr.wr_fee) AS sum_fees, SUM(wr.wr_return_ship_cost) AS sum_shipping_costs, SUM(wr.wr_net_loss) AS sum_net_loss FROM web_returns wr JOIN household_demographics hd ON wr.wr_refunded_hdemo_sk = hd.hd_demo_sk JOIN ship_mode sm ON sm.sm_ship_mode_sk = wr.wr_returned_time_sk GROUP BY hd.hd_income_band_sk, sm.sm_type ORDER BY sum_net_loss DESC;
SELECT d.d_year, d.d_quarter_name, SUM(ss_net_profit) AS total_profit, AVG(ss_sales_price) AS average_sales_price, COUNT(DISTINCT ss_customer_sk) AS unique_customers, SUM(wr_return_amt) AS total_returns, COUNT(DISTINCT wr_refunded_customer_sk) AS unique_refunded_customers, COUNT(wr_return_quantity) AS total_returned_items FROM store_sales ss JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk LEFT JOIN web_returns wr ON ss.ss_item_sk = wr.wr_item_sk AND ss.ss_ticket_number = wr.wr_order_number WHERE d.d_year = 2002 AND ss.ss_ext_discount_amt > 0 GROUP BY d.d_year, d.d_quarter_name ORDER BY d.d_year, d.d_quarter_name;
SELECT d_year, i_category, COUNT(DISTINCT cs_order_number) AS total_orders, SUM(cs_quantity) AS total_quantity_sold, SUM(cs_net_paid) AS total_sales, AVG(cs_net_profit) AS average_profit_per_sale, SUM(cr_return_quantity) AS total_quantity_returned, SUM(cr_return_amount) AS total_returns, AVG(cr_net_loss) AS average_loss_per_return FROM catalog_sales JOIN item ON cs_item_sk = i_item_sk JOIN date_dim ON cs_sold_date_sk = d_date_sk LEFT JOIN catalog_returns ON cs_order_number = cr_order_number AND cs_item_sk = cr_item_sk WHERE (i_class_id IN (7, 14, 9)) AND (cr_reason_sk IN (17, 4, 20, 34, 25) OR cr_reason_sk IS NULL) AND (cs_coupon_amt IN (1589.39, 1893.80, 3358.21) OR cs_coupon_amt IS NULL) AND (catalog_sales.cs_ext_wholesale_cost IN (936.76, 3257.86) OR catalog_sales.cs_ext_wholesale_cost IS NULL) GROUP BY d_year, i_category ORDER BY d_year DESC, i_category;
SELECT p.p_promo_name, cd.cd_gender, cd.cd_marital_status, cd.cd_education_status, COUNT(DISTINCT cs.cs_order_number) AS total_orders, SUM(cs.cs_quantity) AS total_quantity_sold, AVG(cs.cs_net_paid) AS avg_net_paid, SUM(cs.cs_net_paid_inc_tax) AS sum_net_paid_inc_tax, SUM(ws.ws_net_profit) AS sum_web_net_profit, COUNT(DISTINCT wr.wr_order_number) AS total_returns, SUM(wr.wr_return_amt) AS total_return_amount, AVG(wr.wr_fee) AS avg_return_fee FROM catalog_sales cs JOIN promotion p ON cs.cs_promo_sk = p.p_promo_sk JOIN customer_demographics cd ON cs.cs_bill_cdemo_sk = cd.cd_demo_sk JOIN web_sales ws ON cs.cs_order_number = ws.ws_order_number AND cs.cs_item_sk = ws.ws_item_sk LEFT JOIN web_returns wr ON ws.ws_order_number = wr.wr_order_number AND ws.ws_item_sk = wr.wr_item_sk WHERE cd.cd_credit_rating IN ('Good', 'Unknown') AND p.p_discount_active = 'N' AND cs.cs_net_paid_inc_tax NOT IN ('5209.58', '3100.79') AND NOT EXISTS ( SELECT 1 FROM reason r WHERE r.r_reason_sk = wr.wr_reason_sk AND r.r_reason_desc LIKE 'Wrong size' ) GROUP BY p.p_promo_name, cd.cd_gender, cd.cd_marital_status, cd.cd_education_status ORDER BY sum_net_paid_inc_tax DESC, total_orders DESC;
SELECT i.i_category, sm.sm_type, COUNT(DISTINCT cs.cs_order_number) AS total_orders, SUM(cs.cs_quantity) AS total_quantity_sold, AVG(cs.cs_sales_price) AS average_sales_price, SUM(cs.cs_net_paid) AS total_net_paid, SUM(cs.cs_net_profit) AS total_net_profit, AVG(cs.cs_net_profit) AS average_net_profit, SUM(inv.inv_quantity_on_hand) AS total_inventory_on_hand FROM catalog_sales cs JOIN item i ON cs.cs_item_sk = i.i_item_sk JOIN ship_mode sm ON cs.cs_ship_mode_sk = sm.sm_ship_mode_sk JOIN inventory inv ON i.i_item_sk = inv.inv_item_sk WHERE sm.sm_type = 'EXPRESS' AND inv.inv_date_sk = 2450815 AND (inv.inv_quantity_on_hand IN (339, 505, 759, 226, 679) OR cs.cs_bill_hdemo_sk IN (523, 2390, 5794)) GROUP BY i.i_category, sm.sm_type ORDER BY total_net_profit DESC;
SELECT cp.cp_department AS department, i.i_category AS category, i.i_class AS class, COUNT(DISTINCT ws.ws_order_number) AS total_orders, SUM(ws.ws_quantity) AS total_quantity_sold, AVG(ws.ws_sales_price) AS average_sales_price, SUM(ws.ws_net_paid) AS total_net_paid, SUM(ws.ws_net_profit) AS total_net_profit, AVG(hd.hd_dep_count) AS average_dependents, AVG(hd.hd_vehicle_count) AS average_vehicles FROM web_sales ws JOIN item i ON ws.ws_item_sk = i.i_item_sk JOIN catalog_page cp ON i.i_item_sk = cp.cp_catalog_page_sk JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk WHERE hd.hd_vehicle_count IN (0, 3) AND hd.hd_buy_potential IN ('>10000', '5001-10000', '501-1000', '0-500') AND cp.cp_start_date_sk <= ws.ws_sold_date_sk AND (cp.cp_end_date_sk IS NULL OR cp.cp_end_date_sk >= ws.ws_sold_date_sk) GROUP BY cp.cp_department, i.i_category, i.i_class ORDER BY total_net_profit DESC, total_orders DESC;
SELECT p.p_promo_name, COUNT(DISTINCT cs_order_number) AS num_catalog_orders, SUM(cs_net_paid) AS total_catalog_sales, AVG(cs_net_profit) AS avg_catalog_profit, COUNT(DISTINCT ws_order_number) AS num_web_orders, SUM(ws_net_paid) AS total_web_sales, AVG(ws_net_profit) AS avg_web_profit, w.w_warehouse_name, SUM(w.w_warehouse_sq_ft) AS total_warehouse_sq_ft, AVG(w.w_gmt_offset) AS avg_warehouse_gmt_offset FROM promotion p LEFT JOIN catalog_sales cs ON p.p_promo_sk = cs.cs_promo_sk LEFT JOIN web_sales ws ON p.p_promo_sk = ws.ws_promo_sk LEFT JOIN warehouse w ON cs.cs_warehouse_sk = w.w_warehouse_sk OR ws.ws_warehouse_sk = w.w_warehouse_sk WHERE (p.p_start_date_sk IN ('2450692', '2450536', '2450464') OR p.p_end_date_sk IN ('2450692', '2450536', '2450464')) AND (cs.cs_sales_price IS NOT NULL OR ws.ws_sales_price IS NOT NULL) AND (w.w_warehouse_name IS NOT NULL) GROUP BY p.p_promo_name, w.w_warehouse_name ORDER BY total_catalog_sales DESC, total_web_sales DESC;
SELECT s.s_store_id, s.s_store_name, d.d_year, COUNT(DISTINCT c.c_customer_sk) AS total_customers, SUM(CASE WHEN c.c_preferred_cust_flag = 'Y' THEN 1 ELSE 0 END) AS preferred_customers, AVG(s.s_number_employees) AS average_employees, AVG(s.s_floor_space) AS average_floor_space, SUM(s.s_tax_precentage) AS total_tax_percentage FROM store s JOIN customer c ON s.s_store_sk = c.c_current_addr_sk JOIN date_dim d ON c.c_first_sales_date_sk = d.d_date_sk WHERE s.s_division_name <> 'Unknown' AND c.c_last_review_date_sk IN ('2452522', '2452308', '2452629', '2452335', '2452592', '2452622') AND c.c_first_name IN ('Tyler', 'Rhona', 'Mohammad') AND d.d_last_dom IN ('2417208', '2418853') AND d.d_following_holiday = 'Y' GROUP BY s.s_store_id, s.s_store_name, d.d_year ORDER BY total_customers DESC, preferred_customers DESC, average_employees DESC, average_floor_space DESC, total_tax_percentage DESC;
SELECT cc.cc_name AS call_center_name, st.s_store_name AS store_name, st.s_state AS store_state, ws.web_name AS website_name, p.p_promo_name AS promotion_name, p.p_channel_details AS promotion_channel_details, SUM(ss.ss_quantity) AS total_quantity_sold, AVG(ss.ss_sales_price) AS average_sales_price, SUM(ss.ss_net_paid) AS total_net_sales, SUM(ss.ss_net_profit) AS total_net_profit FROM call_center cc JOIN store_sales ss ON cc.cc_call_center_sk = ss.ss_store_sk JOIN store st ON ss.ss_store_sk = st.s_store_sk JOIN web_site ws ON st.s_market_id = ws.web_mkt_id JOIN promotion p ON ss.ss_promo_sk = p.p_promo_sk WHERE cc.cc_manager IN ('Mark Hightower', 'Felipe Perkins', 'Bob Belcher') AND cc.cc_call_center_id = 'AAAAAAAAEAAAAAAA' AND st.s_market_id IN (4, 6, 7, 2, 8, 10) AND st.s_country = 'United States' AND p.p_start_date_sk IN (2450694, 2450318, 2450696, 2450508, 2450764, 2450750) AND ss.ss_customer_sk IN (169, 28519, 57009, 32392) GROUP BY call_center_name, store_name, store_state, website_name, promotion_name, promotion_channel_details ORDER BY total_net_sales DESC;
SELECT dd.d_year, dd.d_quarter_name, wa.w_country, ca.ca_state, COUNT(DISTINCT ws.ws_order_number) AS total_orders, SUM(ws.ws_quantity) AS total_quantity_sold, AVG(ws.ws_sales_price) AS average_sales_price, SUM(ws.ws_net_paid) AS total_net_paid, SUM(ws.ws_net_profit) AS total_net_profit, AVG(cd.cd_purchase_estimate) AS avg_customer_purchase_estimate, SUM(CASE WHEN pr.p_channel_email = '1' THEN ws.ws_quantity ELSE 0 END) as total_quantity_sold_via_email, SUM(CASE WHEN pr.p_channel_tv = '1' THEN ws.ws_quantity ELSE 0 END) as total_quantity_sold_via_tv FROM web_sales ws JOIN date_dim dd ON ws.ws_sold_date_sk = dd.d_date_sk JOIN customer_address ca ON ws.ws_bill_addr_sk = ca.ca_address_sk JOIN customer_demographics cd ON ws.ws_bill_cdemo_sk = cd.cd_demo_sk JOIN warehouse wa ON ws.ws_warehouse_sk = wa.w_warehouse_sk JOIN promotion pr ON ws.ws_promo_sk = pr.p_promo_sk WHERE dd.d_quarter_seq IN (25, 41) AND wa.w_country = 'United States' AND wa.w_street_name IN ('Ash Laurel', '6th', 'Wilson Elm', 'View First') AND cd.cd_purchase_estimate BETWEEN 1000 AND 5500 GROUP BY ROLLUP(dd.d_year, dd.d_quarter_name, wa.w_country, ca.ca_state) ORDER BY dd.d_year, dd.d_quarter_name, wa.w_country, ca.ca_state;
SELECT c_birth_country, cd_gender, cd_marital_status, cd_education_status, AVG(cd_purchase_estimate) AS avg_purchase_estimate, COUNT(DISTINCT c_customer_sk) AS total_customers, SUM(inv_quantity_on_hand) AS total_inventory, COUNT(DISTINCT wr_order_number) AS total_returns, AVG(wr_return_amt_inc_tax) AS avg_return_amount_inc_tax, SUM(wr_fee) AS total_return_fees FROM customer c JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk JOIN inventory inv ON inv.inv_date_sk = '2450815' JOIN web_returns wr ON wr.wr_refunded_customer_sk = c.c_customer_sk JOIN web_page wp ON wp.wp_web_page_sk = wr.wr_web_page_sk AND wp.wp_max_ad_count IN ('0', '1') JOIN time_dim t ON t.t_time_sk = wr.wr_returned_time_sk AND t.t_time_id IN ('AAAAAAAALDIAAAAA', 'AAAAAAAAPEJAAAAA', 'AAAAAAAAKMNAAAAA', 'AAAAAAAAIHFAAAAA', 'AAAAAAAAOEBBAAAA', 'AAAAAAAALNDAAAAA') JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk WHERE cd.cd_marital_status IN ('D', 'M', 'U', 'S', 'W') AND cd.cd_gender = 'M' GROUP BY c_birth_country, cd_gender, cd_marital_status, cd_education_status ORDER BY avg_purchase_estimate DESC, total_customers DESC LIMIT 100;
SELECT p.p_promo_name, p.p_channel_dmail, p.p_channel_email, p.p_channel_catalog, p.p_channel_tv, p.p_channel_radio, p.p_channel_press, p.p_channel_event, p.p_channel_demo, SUM(p.p_cost) AS total_promotion_cost, COUNT(p.p_promo_sk) AS number_of_promotions, AVG(cd.cd_dep_count) AS average_number_of_dependents FROM promotion p JOIN web_page wp ON p.p_item_sk = wp.wp_web_page_sk JOIN customer_demographics cd ON wp.wp_customer_sk = cd.cd_demo_sk WHERE wp.wp_creation_date_sk IN ('2450808', '2450809') AND p.p_response_target = 1 AND cd.cd_marital_status IN ('W', 'D', 'U', 'S') GROUP BY p.p_promo_name, p.p_channel_dmail, p.p_channel_email, p.p_channel_catalog, p.p_channel_tv, p.p_channel_radio, p.p_channel_press, p.p_channel_event, p.p_channel_demo ORDER BY total_promotion_cost DESC, number_of_promotions DESC;
SELECT d_year, i_category, SUM(wr_return_quantity) AS total_return_quantity, AVG(wr_return_amt) AS avg_return_amount, COUNT(DISTINCT wr_order_number) AS total_orders, SUM(wr_return_amt_inc_tax) AS total_return_amount_inc_tax, SUM(wr_fee) AS total_fees, SUM(wr_net_loss) AS total_net_loss, r_reason_desc, hd_dep_count, hd_vehicle_count FROM web_returns JOIN date_dim ON web_returns.wr_returned_date_sk = date_dim.d_date_sk JOIN item ON web_returns.wr_item_sk = item.i_item_sk JOIN reason ON web_returns.wr_reason_sk = reason.r_reason_sk JOIN household_demographics ON web_returns.wr_returning_hdemo_sk = household_demographics.hd_demo_sk WHERE d_year = 2022 AND i_wholesale_cost BETWEEN 2.00 AND 10.00 AND i_container <> 'Unknown' GROUP BY d_year, i_category, r_reason_desc, hd_dep_count, hd_vehicle_count ORDER BY total_return_quantity DESC, avg_return_amount DESC;
SELECT ca.ca_country, ca.ca_state, COUNT(DISTINCT sr.sr_ticket_number) AS num_returns, SUM(sr.sr_return_amt) AS total_return_amount, AVG(sr.sr_return_amt) AS avg_return_amount, SUM(sr.sr_return_quantity) AS total_returned_quantity, SUM(sr.sr_fee) AS total_fees, SUM(sr.sr_net_loss) AS total_net_loss FROM store_returns sr JOIN customer_address ca ON sr.sr_addr_sk = ca.ca_address_sk JOIN store s ON sr.sr_store_sk = s.s_store_sk WHERE ca.ca_country = 'United States' AND s.s_rec_start_date BETWEEN '1997-03-13' AND '2001-03-13' AND s.s_number_employees BETWEEN 236 AND 288 AND sr.sr_returned_date_sk IN ('2452372', '2451953', '2452254') GROUP BY ca.ca_country, ca.ca_state ORDER BY total_return_amount DESC;
SELECT p.p_promo_name, sm.sm_type AS shipping_type, COUNT(DISTINCT cs.cs_order_number) AS total_orders, SUM(cs.cs_quantity) AS total_quantity, SUM(cs.cs_net_paid) AS total_sales, AVG(cs.cs_net_paid) AS average_sales_per_order, SUM(cs.cs_net_profit) AS total_profit, COUNT(DISTINCT ws.ws_order_number) AS total_web_orders, SUM(ws.ws_quantity) AS total_web_quantity, SUM(ws.ws_net_paid) AS total_web_sales, AVG(ws.ws_net_paid) AS average_web_sales_per_order, SUM(ws.ws_net_profit) AS total_web_profit FROM promotion p LEFT JOIN catalog_sales cs ON p.p_promo_sk = cs.cs_promo_sk LEFT JOIN web_sales ws ON p.p_promo_sk = ws.ws_promo_sk LEFT JOIN ship_mode sm ON (cs.cs_ship_mode_sk = sm.sm_ship_mode_sk OR ws.ws_ship_mode_sk = sm.sm_ship_mode_sk) WHERE p.p_start_date_sk IN ('2450688', '2450248', '2450699', '2450857', '2450196', '2450745') AND (sm.sm_type IN ('EXPRESS', 'OVERNIGHT', 'TWO DAY', 'NEXT DAY') OR sm.sm_type IS NULL) AND (cs.cs_ship_customer_sk IN ('65147', '83434', '5487', '82518') OR ws.ws_ship_customer_sk IN ('65147', '83434', '5487', '82518')) AND p.p_channel_tv = 'N' GROUP BY p.p_promo_name, sm.sm_type ORDER BY total_sales DESC, total_web_sales DESC;
SELECT r.r_reason_desc, i.i_item_id, i.i_category, p.p_promo_name, AVG(wr.wr_return_amt_inc_tax) AS avg_return_amount_inc_tax, SUM(wr.wr_net_loss) AS total_net_loss, COUNT(*) AS num_of_returns FROM web_returns wr JOIN reason r ON wr.wr_reason_sk = r.r_reason_sk JOIN item i ON wr.wr_item_sk = i.i_item_sk JOIN promotion p ON p.p_item_sk = i.i_item_sk JOIN call_center cc ON cc.cc_call_center_sk = wr.wr_refunded_addr_sk WHERE i.i_current_price > 100.00 AND cc.cc_gmt_offset = -5.00 GROUP BY r.r_reason_desc, i.i_item_id, i.i_category, p.p_promo_name ORDER BY total_net_loss DESC, avg_return_amount_inc_tax DESC;
SELECT ca.ca_state AS customer_state, ib.ib_income_band_sk AS income_band, date_dim.d_year AS sale_year, SUM(ss.ss_sales_price) AS total_sales, AVG(ss.ss_sales_price) AS avg_sales_price, COUNT(DISTINCT ss.ss_ticket_number) AS sales_transactions, SUM(wr.wr_return_amt) AS total_returns, AVG(wr.wr_return_amt) AS avg_return_amt, COUNT(DISTINCT wr.wr_order_number) AS return_transactions, (SUM(ss.ss_sales_price) - SUM(wr.wr_return_amt)) AS net_sales FROM store_sales ss LEFT JOIN web_returns wr ON ss.ss_item_sk = wr.wr_item_sk AND ss.ss_customer_sk = wr.wr_refunded_customer_sk INNER JOIN date_dim ON ss.ss_sold_date_sk = date_dim.d_date_sk INNER JOIN customer_address ca ON ss.ss_addr_sk = ca.ca_address_sk INNER JOIN income_band ib ON ss.ss_cdemo_sk = ib.ib_income_band_sk WHERE ca.ca_state IS NOT NULL AND date_dim.d_year >= 2000 GROUP BY ca.ca_state, ib.ib_income_band_sk, date_dim.d_year ORDER BY ca.ca_state, ib.ib_income_band_sk, date_dim.d_year;
SELECT cc.cc_name, i.i_category, cd.cd_education_status, COUNT(DISTINCT ws.ws_order_number) AS total_orders, SUM(ws.ws_quantity) AS total_quantity, AVG(ws.ws_sales_price) AS average_sales_price, SUM(ws.ws_net_profit) AS total_net_profit FROM web_sales ws JOIN item i ON ws.ws_item_sk = i.i_item_sk JOIN customer_demographics cd ON ws.ws_bill_cdemo_sk = cd.cd_demo_sk JOIN call_center cc ON cc.cc_gmt_offset = '-5.00' JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk WHERE i.i_units = 'Pallet' AND c.c_birth_day IN (3, 20) AND cd.cd_education_status IN ('2 yr Degree', 'Advanced Degree', 'Secondary', 'College') AND ws.ws_sold_date_sk IS NOT NULL GROUP BY cc.cc_name, i.i_category, cd.cd_education_status ORDER BY total_net_profit DESC, total_orders DESC;
