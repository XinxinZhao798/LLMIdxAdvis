SELECT ca_state, ca_country, w_state, w_country, SUM(sr_return_quantity) AS total_returned_quantity, AVG(sr_return_amt) AS average_return_amount, SUM(sr_fee) AS total_fees, COUNT(DISTINCT sr_customer_sk) AS unique_customers_returning, COUNT(DISTINCT sr_ticket_number) AS total_return_transactions FROM store_returns JOIN customer_address ON store_returns.sr_addr_sk = customer_address.ca_address_sk JOIN warehouse ON store_returns.sr_store_sk = warehouse.w_warehouse_sk WHERE customer_address.ca_gmt_offset IN (-6.00, -10.00, -8.00, -9.00, -7.00) AND warehouse.w_zip = '35709' AND store_returns.sr_addr_sk = '47239' GROUP BY ca_state, ca_country, w_state, w_country ORDER BY ca_state, ca_country;
SELECT cd.cd_gender, cd.cd_marital_status, SUM(ss.ss_ext_sales_price) AS total_sales, AVG(ss.ss_coupon_amt) AS average_coupon_amt, COUNT(ss.ss_item_sk) AS total_items_sold, AVG(inv.inv_quantity_on_hand) AS average_inventory_on_hand FROM store_sales ss JOIN promotion p ON ss.ss_promo_sk = p.p_promo_sk JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk JOIN inventory inv ON ss.ss_item_sk = inv.inv_item_sk WHERE cd.cd_gender IN ('M', 'F') AND ss.ss_ext_sales_price IN (672.96, 2541.35, 528.00, 4835.54, 2912.12, 416.88) AND ss.ss_promo_sk IN (144, 107, 228, 186, 28, 37) AND inv.inv_warehouse_sk IN (1, 2) AND inv.inv_quantity_on_hand = 24 GROUP BY cd.cd_gender, cd.cd_marital_status ORDER BY cd.cd_gender, cd.cd_marital_status;
SELECT cc.cc_call_center_id, cc.cc_name, cc.cc_city, cc.cc_state, r.r_reason_desc, COUNT(cr.cr_order_number) AS total_returns, SUM(cr.cr_return_quantity) AS total_returned_items, AVG(cr.cr_return_amount) AS avg_return_amount, SUM(cr.cr_return_tax) AS total_tax, SUM(cr.cr_return_ship_cost) AS total_ship_cost, SUM(cr.cr_net_loss) AS total_net_loss FROM call_center cc JOIN catalog_returns cr ON cc.cc_call_center_sk = cr.cr_call_center_sk JOIN reason r ON cr.cr_reason_sk = r.r_reason_sk WHERE cc.cc_zip = '31904' AND cr.cr_return_amt_inc_tax > 0 AND r.r_reason_desc IN ('Found a better price in a store', 'its is a boy') GROUP BY cc.cc_call_center_id, cc.cc_name, cc.cc_city, cc.cc_state, r.r_reason_desc ORDER BY total_returns DESC, total_returned_items DESC;
SELECT w.w_warehouse_name, AVG(i.inv_quantity_on_hand) AS avg_quantity_on_hand, SUM(ws.ws_net_paid_inc_tax) AS total_net_paid_including_tax, AVG(ws.ws_quantity) AS avg_quantity_sold, COUNT(DISTINCT s.s_store_sk) AS number_of_stores, COUNT(DISTINCT wp.wp_web_page_sk) AS number_of_web_pages, SUM(ws.ws_ext_sales_price) AS total_sales, SUM(ws.ws_ext_ship_cost) AS total_shipping_cost, AVG(ws.ws_net_profit) AS avg_net_profit FROM warehouse w JOIN inventory i ON w.w_warehouse_sk = i.inv_warehouse_sk JOIN web_sales ws ON w.w_warehouse_sk = ws.ws_warehouse_sk JOIN store s ON w.w_state = s.s_state JOIN web_page wp ON ws.ws_web_page_sk = wp.wp_web_page_sk WHERE i.inv_item_sk IN ('12967', '13462') AND ws.ws_net_paid_inc_ship_tax IN ('2903.39', '10322.19', '71.04') AND ws.ws_ship_cdemo_sk IN ('1497159', '165796', '556771', '542355') AND w.w_zip = '35709' AND w.w_street_type IN ('Avenue', 'Drive', 'Dr.') GROUP BY w.w_warehouse_name ORDER BY w.w_warehouse_name;
SELECT i.i_category AS item_category, ib.ib_income_band_sk AS income_band_id, COUNT(DISTINCT i.i_item_sk) AS num_items_sold, SUM(inv.inv_quantity_on_hand) AS total_quantity, AVG(i.i_current_price) AS average_sales_price FROM inventory inv JOIN item i ON inv.inv_item_sk = i.i_item_sk JOIN income_band ib ON i.i_wholesale_cost BETWEEN ib.ib_lower_bound AND ib.ib_upper_bound WHERE i.i_rec_start_date <= CURRENT_DATE AND (i.i_rec_end_date IS NULL OR i.i_rec_end_date > CURRENT_DATE) GROUP BY i.i_category, ib.ib_income_band_sk ORDER BY ib.ib_income_band_sk, average_sales_price DESC;
SELECT cp.cp_type, cp.cp_department, SUM(cs.cs_quantity) AS total_quantity_sold, AVG(cs.cs_sales_price) AS avg_sales_price, COUNT(DISTINCT cs.cs_order_number) AS unique_orders, SUM(sr.sr_return_quantity) AS total_return_quantity, AVG(sr.sr_return_amt) AS avg_return_amount, SUM(inv.inv_quantity_on_hand) AS total_inventory_on_hand, SUM(ss.ss_quantity) AS total_store_sales_quantity, AVG(ss.ss_net_paid) AS avg_net_paid_store_sales FROM catalog_page cp JOIN catalog_sales cs ON cp.cp_catalog_page_sk = cs.cs_catalog_page_sk LEFT JOIN store_returns sr ON cs.cs_item_sk = sr.sr_item_sk AND cs.cs_order_number = CAST(sr.sr_ticket_number AS integer) LEFT JOIN inventory inv ON cs.cs_item_sk = inv.inv_item_sk LEFT JOIN store_sales ss ON cs.cs_item_sk = ss.ss_item_sk AND cs.cs_order_number = CAST(ss.ss_ticket_number AS integer) WHERE cp.cp_catalog_number IN (36, 10, 1, 39, 15, 23) AND cp.cp_type IN ('quarterly', 'bi-annual', 'monthly') AND inv.inv_date_sk = 2450815 AND cs.cs_ship_date_sk = 2450901 AND cs.cs_list_price IN (127.89, 61.80, 132.26) GROUP BY cp.cp_type, cp.cp_department ORDER BY cp.cp_type, cp.cp_department;
SELECT ca.ca_state AS State, AVG(hd.hd_income_band_sk) AS Avg_Income_Band, AVG(hd.hd_dep_count) AS Avg_Dependent_Count, AVG(hd.hd_vehicle_count) AS Avg_Vehicle_Count, COUNT(*) FILTER (WHERE hd.hd_buy_potential = 'High') AS High_Buying_Potential_Count, COUNT(*) FILTER (WHERE hd.hd_buy_potential = 'Medium') AS Medium_Buying_Potential_Count, COUNT(*) FILTER (WHERE hd.hd_buy_potential = 'Low') AS Low_Buying_Potential_Count, COUNT(DISTINCT ca.ca_address_sk) AS Address_Count, AVG(ws.web_tax_percentage) AS Avg_Web_Tax_Percentage FROM customer_address ca JOIN household_demographics hd ON ca.ca_address_sk = hd.hd_demo_sk JOIN web_site ws ON ca.ca_state = ws.web_state WHERE ca.ca_country = 'United States' AND ws.web_country = 'United States' AND ca.ca_state IS NOT NULL AND ws.web_tax_percentage IS NOT NULL GROUP BY ca.ca_state ORDER BY Avg_Income_Band DESC, High_Buying_Potential_Count DESC, Medium_Buying_Potential_Count DESC, Low_Buying_Potential_Count DESC;
SELECT d_year, d_qoy, cc_name, COUNT(DISTINCT cr_order_number) AS num_returns, SUM(cr_return_amount) AS total_return_amount, AVG(cr_return_amount) AS avg_return_amount, COUNT(DISTINCT sr_ticket_number) AS num_store_returns, SUM(sr_return_amt) AS total_store_return_amount, AVG(sr_return_amt) AS avg_store_return_amount, SUM(hd_dep_count) AS total_dependants, AVG(hd_vehicle_count) AS avg_vehicles FROM date_dim JOIN catalog_returns ON cr_returned_date_sk = d_date_sk JOIN call_center ON cr_call_center_sk = cc_call_center_sk JOIN store_returns ON sr_returned_date_sk = d_date_sk JOIN household_demographics ON cr_returning_hdemo_sk = hd_demo_sk AND sr_hdemo_sk = hd_demo_sk WHERE d_qoy = 2 AND d_following_holiday = 'Y' AND hd_income_band_sk = 15 AND (cr_item_sk IN (10036, 2977) OR sr_item_sk IN (10036, 2977)) AND (cr_refunded_customer_sk IN (78674, 95319, 63625, 45060, 53817, 43545) OR sr_customer_sk IN (78674, 95319, 63625, 45060, 53817, 43545)) AND cc_street_name IN ('Center Hill', 'Pine Ridge', 'Ash Hill') GROUP BY d_year, d_qoy, cc_name ORDER BY d_year, d_qoy, cc_name;
