SELECT s.s_state, w.w_country, p.p_promo_name, SUM(ss.ss_quantity) AS total_quantity_sold, AVG(ss.ss_sales_price) AS average_sales_price, COUNT(DISTINCT ss.ss_ticket_number) AS number_of_sales_transactions, SUM(ss.ss_net_paid) AS total_net_paid, SUM(ss.ss_net_profit) AS total_net_profit FROM store_sales ss JOIN store s ON ss.ss_store_sk = s.s_store_sk JOIN warehouse w ON s.s_state = w.w_state LEFT JOIN promotion p ON ss.ss_promo_sk = p.p_promo_sk AND p.p_channel_catalog = 'N' GROUP BY s.s_state, w.w_country, p.p_promo_name ORDER BY s.s_state, w.w_country, p.p_promo_name;
SELECT p.p_promo_name, COUNT(DISTINCT cs_order_number) AS num_catalog_orders, SUM(cs_net_paid) AS total_catalog_sales, AVG(cs_net_profit) AS avg_catalog_profit, COUNT(DISTINCT ws_order_number) AS num_web_orders, SUM(ws_net_paid) AS total_web_sales, AVG(ws_net_profit) AS avg_web_profit, w.w_warehouse_name, SUM(w.w_warehouse_sq_ft) AS total_warehouse_sq_ft, AVG(w.w_gmt_offset) AS avg_warehouse_gmt_offset FROM promotion p LEFT JOIN catalog_sales cs ON p.p_promo_sk = cs.cs_promo_sk LEFT JOIN web_sales ws ON p.p_promo_sk = ws.ws_promo_sk LEFT JOIN warehouse w ON cs.cs_warehouse_sk = w.w_warehouse_sk OR ws.ws_warehouse_sk = w.w_warehouse_sk WHERE (p.p_start_date_sk IN ('2450692', '2450536', '2450464') OR p.p_end_date_sk IN ('2450692', '2450536', '2450464')) AND (cs.cs_sales_price IS NOT NULL OR ws.ws_sales_price IS NOT NULL) AND (w.w_warehouse_name IS NOT NULL) GROUP BY p.p_promo_name, w.w_warehouse_name ORDER BY total_catalog_sales DESC, total_web_sales DESC;
SELECT cc.cc_country, cc.cc_open_date_sk, i.i_category, COUNT(cs.cs_order_number) AS total_orders, SUM(cs.cs_quantity) AS total_quantity_sold, AVG(cs.cs_sales_price) AS average_sales_price, SUM(cs.cs_net_paid) AS total_net_paid, SUM(cs.cs_net_paid_inc_tax) - SUM(cs.cs_net_paid) AS total_tax_collected, SUM(cs.cs_net_profit) AS total_net_profit, COUNT(DISTINCT wr.wr_order_number) AS total_returns, SUM(wr.wr_return_quantity) AS total_returned_quantity, AVG(wr.wr_return_amt) AS average_return_amount, SUM(wr.wr_net_loss) AS total_net_loss FROM call_center cc JOIN catalog_sales cs ON cc.cc_call_center_sk = cs.cs_call_center_sk JOIN item i ON cs.cs_item_sk = i.i_item_sk LEFT JOIN web_returns wr ON cs.cs_item_sk = wr.wr_item_sk AND cs.cs_order_number = wr.wr_order_number WHERE cc.cc_country = 'United States' AND cc.cc_open_date_sk IN ('2450952', '2450806', '2451063') GROUP BY ROLLUP(cc.cc_country, cc.cc_open_date_sk, i.i_category) ORDER BY cc.cc_country, cc.cc_open_date_sk, i.i_category;
SELECT ws.ws_web_site_sk, web.web_name, COUNT(ws.ws_order_number) AS total_orders, SUM(ws.ws_quantity) AS total_quantity_sold, AVG(ws.ws_sales_price) AS average_sales_price, SUM(ws.ws_net_profit) AS total_net_profit, SUM(cr.cr_net_loss) AS total_net_loss, (SUM(ws.ws_net_profit) - SUM(cr.cr_net_loss)) AS net_gain_loss, COUNT(DISTINCT ws.ws_bill_customer_sk) AS unique_customers, COUNT(DISTINCT cr.cr_returning_customer_sk) AS unique_returning_customers, COUNT(DISTINCT cr.cr_item_sk) AS unique_returned_items, SUM(cr.cr_return_quantity) AS total_returned_quantity, AVG(cr.cr_return_amount) AS average_return_amount FROM web_sales ws JOIN web_site web ON ws.ws_web_site_sk = web.web_site_sk LEFT JOIN catalog_returns cr ON ws.ws_order_number = cr.cr_order_number AND ws.ws_item_sk = cr.cr_item_sk WHERE web.web_county = 'Williamson County' AND (web.web_rec_end_date = '2000-08-15' OR web.web_rec_end_date = '1999-08-16') AND (ws.ws_ext_sales_price = 1271.34 OR ws.ws_ext_sales_price = 2832.48 OR ws.ws_ext_sales_price = 205.59 OR ws.ws_ext_sales_price = 4175.82 OR ws.ws_ext_sales_price = 885.30) GROUP BY ws.ws_web_site_sk, web.web_name ORDER BY net_gain_loss DESC;
SELECT w_state, EXTRACT(YEAR FROM wp_rec_end_date) AS year, SUM(cr_return_amount) AS total_return_amount, AVG(cr_return_amount) AS avg_return_amount, COUNT(DISTINCT cr_refunded_customer_sk) AS unique_customers, COUNT(cr_order_number) AS total_returns, SUM(cr_return_quantity) AS total_returned_items FROM catalog_returns cr JOIN warehouse w ON cr.cr_warehouse_sk = w.w_warehouse_sk JOIN web_page wp ON cr.cr_catalog_page_sk = wp.wp_web_page_sk WHERE wp.wp_rec_end_date BETWEEN '1999-01-01' AND CURRENT_DATE GROUP BY w_state, year ORDER BY w_state, year;
SELECT ca_state, EXTRACT(YEAR FROM d_date) AS sale_year, COUNT(DISTINCT cs_order_number) AS total_orders, SUM(cs_quantity) AS total_quantity, SUM(cs_ext_sales_price) AS total_sales, AVG(cs_sales_price) AS avg_sales_price, SUM(cs_net_profit) AS total_profit FROM catalog_sales JOIN customer ON cs_bill_customer_sk = c_customer_sk JOIN customer_address ON c_current_addr_sk = ca_address_sk JOIN date_dim ON cs_sold_date_sk = d_date_sk WHERE ca_country = 'United States' AND ca_state IN ('LA', 'NC', 'KS', 'MI') AND cs_ext_sales_price > 100.00 AND cs_ext_sales_price < 15000.00 AND d_year = 2022 AND d_moy BETWEEN 1 AND 6 GROUP BY ca_state, sale_year ORDER BY total_sales DESC;
SELECT d_year, p_channel_details, COUNT(DISTINCT ws_order_number) AS web_order_count, SUM(ws_net_paid) AS total_web_sales, SUM(ws_net_profit) AS total_web_profit, AVG(ws_quantity) AS average_quantity_sold, SUM(ss_net_paid) AS total_store_sales, SUM(ss_net_profit) AS total_store_profit, AVG(ss_quantity) AS average_store_quantity_sold FROM web_sales JOIN store_sales ON ws_item_sk = ss_item_sk JOIN date_dim ON ws_sold_date_sk = d_date_sk JOIN promotion ON ws_promo_sk = p_promo_sk WHERE d_year IN (1902, 1903, 1904) AND p_channel_details IS NOT NULL AND (ws_net_paid > 0 OR ss_net_paid > 0) GROUP BY d_year, p_channel_details ORDER BY d_year, p_channel_details;
SELECT s_state, cd_gender, cd_marital_status, cd_education_status, hd_buy_potential, AVG(cd_purchase_estimate) AS avg_purchase_estimate, SUM(s_number_employees) AS total_employees, COUNT(DISTINCT s_store_sk) AS num_stores, MIN(s_floor_space) AS min_floor_space, MAX(s_floor_space) AS max_floor_space, AVG(s_floor_space) AS avg_floor_space, COUNT(DISTINCT hd_demo_sk) AS num_households, SUM(hd_vehicle_count) AS total_vehicles, AVG(hd_vehicle_count) AS avg_vehicles_per_household FROM store JOIN household_demographics ON (s_store_sk = hd_demo_sk) JOIN customer_demographics ON (hd_demo_sk = cd_demo_sk) WHERE s_country = 'United States' AND s_state IN ('CA', 'TX', 'FL') AND cd_dep_employed_count = 0 AND hd_buy_potential LIKE 'Unknown%' AND cd_education_status IN ('College', '4 yr Degree', 'Graduate Degree') AND s_market_id IS NOT NULL GROUP BY s_state, cd_gender, cd_marital_status, cd_education_status, hd_buy_potential ORDER BY s_state, avg_purchase_estimate DESC, total_employees DESC LIMIT 50;
SELECT hd.hd_dep_count, hd.hd_vehicle_count, ib.ib_lower_bound, ib.ib_upper_bound, COUNT(DISTINCT p.p_promo_sk) AS num_promotions, SUM(p.p_cost) AS total_promo_cost, AVG(p.p_cost) AS avg_promo_cost, COUNT(DISTINCT r.r_reason_sk) AS num_reasons, AVG(hd.hd_vehicle_count) AS avg_vehicle_count, SUM(CASE WHEN p.p_channel_event = 'N' THEN 1 ELSE 0 END) AS non_event_promos, SUM(CASE WHEN p.p_response_target = 1 THEN 1 ELSE 0 END) AS target_response_promos FROM promotion p JOIN household_demographics hd ON p.p_item_sk = hd.hd_demo_sk JOIN income_band ib ON hd.hd_income_band_sk = ib.ib_income_band_sk LEFT JOIN reason r ON r.r_reason_sk = p.p_promo_sk WHERE p.p_channel_event = 'N' AND p.p_response_target = 1 GROUP BY hd.hd_dep_count, hd.hd_vehicle_count, ib.ib_lower_bound, ib.ib_upper_bound ORDER BY total_promo_cost DESC, num_promotions DESC;
SELECT w.web_name, cp.cp_department, sm.sm_type, COUNT(distinct i.i_item_sk) as total_items, SUM(i.i_current_price) as total_sales, AVG(i.i_wholesale_cost) as avg_wholesale_cost, COUNT(distinct w.web_site_sk) as total_websites FROM web_site w JOIN catalog_page cp ON w.web_site_sk = cp.cp_catalog_number JOIN item i ON cp.cp_department = i.i_category JOIN ship_mode sm ON sm.sm_carrier = i.i_manufact WHERE i.i_category = 'Music' AND w.web_city IN ('Fairview', 'Midway') AND sm.sm_ship_mode_id IN ('AAAAAAAAIAAAAAAA', 'AAAAAAAALAAAAAAA') AND i.i_item_id IN ('AAAAAAAAJCCAAAAA', 'AAAAAAAANGMAAAAA', 'AAAAAAAAICDAAAAA', 'AAAAAAAAHLABAAAA', 'AAAAAAAAIIEAAAAA', 'AAAAAAAALAOAAAAA') AND w.web_name IN ('site_3', 'site_4', 'site_1', 'site_0', 'site_2') GROUP BY w.web_name, cp.cp_department, sm.sm_type ORDER BY total_sales DESC;
SELECT ws.ws_item_sk, COUNT(DISTINCT ws.ws_order_number) AS total_orders, SUM(ws.ws_quantity) AS total_quantity_sold, AVG(ws.ws_ext_discount_amt) AS avg_discount_amt, AVG(ws.ws_sales_price) AS avg_sales_price, SUM(ws.ws_net_paid) AS total_net_paid, SUM(ws.ws_net_profit) AS total_net_profit, hd.hd_dep_count AS avg_dependents, hd.hd_vehicle_count AS avg_vehicles, s.s_store_name, s.s_city, s.s_state, SUM(inv.inv_quantity_on_hand) AS total_inventory_on_hand FROM web_sales ws JOIN household_demographics hd ON ws.ws_ship_hdemo_sk = hd.hd_demo_sk JOIN store s ON ws.ws_warehouse_sk = s.s_store_sk JOIN inventory inv ON (ws.ws_item_sk = inv.inv_item_sk AND ws.ws_warehouse_sk = inv.inv_warehouse_sk) WHERE ws.ws_ship_customer_sk IN ('14120', '70023', '31659', '86542') AND ws.ws_ship_addr_sk IN ('8368', '47705', '32703', '24892') AND inv.inv_date_sk = '2450815' AND hd.hd_vehicle_count IN (1, 0, 3, 2) AND s.s_number_employees IN (245, 271, 236, 218, 288, 278) GROUP BY ws.ws_item_sk, hd.hd_dep_count, hd.hd_vehicle_count, s.s_store_name, s.s_city, s.s_state ORDER BY total_net_paid DESC, total_orders DESC;
