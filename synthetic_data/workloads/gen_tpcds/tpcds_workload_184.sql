SELECT p.p_promo_name, p.p_channel_dmail, p.p_channel_email, p.p_channel_catalog, p.p_channel_tv, p.p_channel_radio, p.p_channel_press, p.p_channel_event, p.p_channel_demo, SUM(p.p_cost) AS total_promotion_cost, COUNT(p.p_promo_sk) AS number_of_promotions, AVG(cd.cd_dep_count) AS average_number_of_dependents FROM promotion p JOIN web_page wp ON p.p_item_sk = wp.wp_web_page_sk JOIN customer_demographics cd ON wp.wp_customer_sk = cd.cd_demo_sk WHERE wp.wp_creation_date_sk IN ('2450808', '2450809') AND p.p_response_target = 1 AND cd.cd_marital_status IN ('W', 'D', 'U', 'S') GROUP BY p.p_promo_name, p.p_channel_dmail, p.p_channel_email, p.p_channel_catalog, p.p_channel_tv, p.p_channel_radio, p.p_channel_press, p.p_channel_event, p.p_channel_demo ORDER BY total_promotion_cost DESC, number_of_promotions DESC;
SELECT dd.d_year, dd.d_quarter_name, SUM(cs.cs_quantity) AS total_quantity_sold, SUM(cs.cs_ext_sales_price) AS total_sales, SUM(cs.cs_ext_discount_amt) AS total_discount, SUM(cs.cs_ext_tax) AS total_tax_collected, SUM(cs.cs_net_profit) AS total_net_profit, AVG(cs.cs_sales_price) AS average_sales_price, COUNT(DISTINCT cs.cs_order_number) AS total_orders FROM catalog_sales cs JOIN date_dim dd ON cs.cs_sold_date_sk = dd.d_date_sk WHERE dd.d_year IN (2001, 2002) AND dd.d_quarter_name IN ('1905Q4', '1906Q3', '1908Q2', '1903Q2') GROUP BY dd.d_year, dd.d_quarter_name ORDER BY dd.d_year, dd.d_quarter_name;
SELECT cp.cp_department, s.s_state, AVG(sr.sr_net_loss) AS avg_net_loss, AVG(s.s_floor_space) AS avg_store_floor_space, AVG(sr.sr_return_quantity) AS avg_items_returned FROM store_returns sr INNER JOIN store s ON sr.sr_store_sk = s.s_store_sk INNER JOIN catalog_page cp ON s.s_market_id = cp.cp_catalog_number INNER JOIN customer_address ca ON sr.sr_addr_sk = ca.ca_address_sk WHERE s.s_rec_end_date IS NULL AND ca.ca_location_type = 'condo' AND s.s_company_id = 1 GROUP BY cp.cp_department, s.s_state ORDER BY avg_net_loss DESC, avg_store_floor_space DESC, avg_items_returned DESC LIMIT 10;
SELECT c.cc_name, c.cc_class, c.cc_employees, c.cc_sq_ft, AVG(s.s_number_employees) AS avg_store_employees, AVG(s.s_floor_space) AS avg_store_floor_space, SUM(sr.sr_return_amt) AS total_return_amount, SUM(sr.sr_return_amt_inc_tax) AS total_return_amount_inc_tax, SUM(sr.sr_return_quantity) AS total_return_quantity, COUNT(DISTINCT hd.hd_demo_sk) AS distinct_household_count, AVG(hd.hd_vehicle_count) AS avg_vehicle_count, SUM(ib.ib_upper_bound) AS total_income_upper_bound, COUNT(DISTINCT s.s_store_sk) AS distinct_store_count FROM call_center c LEFT JOIN store s ON c.cc_mkt_id = s.s_market_id LEFT JOIN store_returns sr ON sr.sr_store_sk = s.s_store_sk LEFT JOIN household_demographics hd ON sr.sr_hdemo_sk = hd.hd_demo_sk LEFT JOIN income_band ib ON hd.hd_income_band_sk = ib.ib_income_band_sk WHERE c.cc_sq_ft::integer > 3000 AND sr.sr_return_amt_inc_tax::numeric > 1.5 AND sr.sr_return_ship_cost::numeric BETWEEN 3.5 AND 1601.73 GROUP BY c.cc_name, c.cc_class, c.cc_employees, c.cc_sq_ft ORDER BY total_return_amount DESC, total_return_quantity DESC LIMIT 100;
SELECT cc.cc_country, cc.cc_open_date_sk, i.i_category, COUNT(cs.cs_order_number) AS total_orders, SUM(cs.cs_quantity) AS total_quantity_sold, AVG(cs.cs_sales_price) AS average_sales_price, SUM(cs.cs_net_paid) AS total_net_paid, SUM(cs.cs_net_paid_inc_tax) - SUM(cs.cs_net_paid) AS total_tax_collected, SUM(cs.cs_net_profit) AS total_net_profit, COUNT(DISTINCT wr.wr_order_number) AS total_returns, SUM(wr.wr_return_quantity) AS total_returned_quantity, AVG(wr.wr_return_amt) AS average_return_amount, SUM(wr.wr_net_loss) AS total_net_loss FROM call_center cc JOIN catalog_sales cs ON cc.cc_call_center_sk = cs.cs_call_center_sk JOIN item i ON cs.cs_item_sk = i.i_item_sk LEFT JOIN web_returns wr ON cs.cs_item_sk = wr.wr_item_sk AND cs.cs_order_number = wr.wr_order_number WHERE cc.cc_country = 'United States' AND cc.cc_open_date_sk IN ('2450952', '2450806', '2451063') GROUP BY ROLLUP(cc.cc_country, cc.cc_open_date_sk, i.i_category) ORDER BY cc.cc_country, cc.cc_open_date_sk, i.i_category;
SELECT dd.d_year, dd.d_quarter_name, sm.sm_carrier, sm.sm_code, COUNT(DISTINCT cs.cs_order_number) AS total_orders, SUM(cs.cs_quantity) AS total_quantity_sold, SUM(cs.cs_net_paid) AS total_revenue, AVG(cs.cs_net_profit) AS average_profit, SUM(cr.cr_return_quantity) AS total_quantity_returned, SUM(cr.cr_return_amount) AS total_return_amount, AVG(cr.cr_net_loss) AS average_net_loss, ib.ib_lower_bound, ib.ib_upper_bound, COUNT(DISTINCT cr.cr_returning_customer_sk) AS total_returning_customers FROM catalog_sales cs JOIN date_dim dd ON cs.cs_sold_date_sk = dd.d_date_sk JOIN ship_mode sm ON cs.cs_ship_mode_sk = sm.sm_ship_mode_sk JOIN income_band ib ON cs.cs_bill_cdemo_sk = ib.ib_income_band_sk LEFT JOIN catalog_returns cr ON cs.cs_order_number = cr.cr_order_number AND cs.cs_item_sk = cr.cr_item_sk WHERE cs.cs_net_profit BETWEEN -140.39 AND 2770.24 AND cs.cs_ship_date_sk IN (2451009, 2450882, 2450900) AND sm.sm_carrier IN ('ORIENTAL', 'ZOUROS', 'ALLIANCE') AND sm.sm_code IN ('SURFACE', 'AIR', 'BIKE') AND ib.ib_upper_bound IN (140000, 130000, 30000) AND ib.ib_income_band_sk IN (4, 11, 1) AND ib.ib_lower_bound IN (160001, 100001, 170001) AND dd.d_date_id IN ('AAAAAAAAHBLNECAA', 'AAAAAAAAEDBOECAA', 'AAAAAAAADAKNECAA') AND dd.d_quarter_seq IN (21, 43, 22) AND dd.d_month_seq IN (135, 159, 125) AND dd.d_moy IN (4, 6, 7) AND cr.cr_order_number IN (3796, 710, 4775) AND cr.cr_return_tax IN (28.41, 24.46, 171.99) AND cr.cr_returning_customer_sk IN (14182, 22448, 94068) GROUP BY dd.d_year, dd.d_quarter_name, sm.sm_carrier, sm.sm_code, ib.ib_lower_bound, ib.ib_upper_bound ORDER BY total_revenue DESC, average_profit DESC;
SELECT ca_state, cd_education_status, AVG(cs_net_paid) AS avg_sales_amount, SUM(cs_net_paid) AS total_sales_amount, COUNT(DISTINCT cs_bill_customer_sk) AS unique_customers FROM catalog_sales JOIN date_dim ON catalog_sales.cs_sold_date_sk = date_dim.d_date_sk JOIN customer_demographics ON catalog_sales.cs_bill_cdemo_sk = customer_demographics.cd_demo_sk JOIN customer_address ON catalog_sales.cs_bill_addr_sk = customer_address.ca_address_sk WHERE date_dim.d_quarter_name IN ('1901Q4', '1913Q3', '1902Q3') AND date_dim.d_current_quarter = 'N' AND customer_address.ca_county IN ('Claiborne County', 'Scott County', 'Borden County', 'Juneau County') GROUP BY ca_state, cd_education_status ORDER BY ca_state, cd_education_status, total_sales_amount DESC;
SELECT cc_state, r_reason_desc, SUM(inv_quantity_on_hand) AS total_inventory, AVG(c_birth_year) AS average_customer_birth_year, COUNT(DISTINCT c_customer_sk) AS unique_customers, COUNT(DISTINCT web_site_sk) AS web_sites_operating FROM inventory JOIN reason ON (r_reason_sk = inv_quantity_on_hand) JOIN call_center ON (cc_division = inv_warehouse_sk) JOIN customer ON (c_current_addr_sk = cc_open_date_sk) JOIN web_site ON (web_state = cc_state) WHERE inv_date_sk = 2450815 AND c_customer_id IN ('AAAAAAAACHMAAAAA', 'AAAAAAAANPEAAAAA') AND (cc_rec_end_date IS NULL OR cc_rec_end_date > CURRENT_DATE) AND (web_rec_end_date IS NULL OR web_rec_end_date > CURRENT_DATE) GROUP BY cc_state, r_reason_desc ORDER BY total_inventory DESC, average_customer_birth_year;
SELECT p.p_channel_dmail AS promo_channel_direct_mail, p.p_channel_email AS promo_channel_email, p.p_channel_catalog AS promo_channel_catalog, p.p_channel_tv AS promo_channel_tv, p.p_channel_radio AS promo_channel_radio, p.p_channel_press AS promo_channel_press, p.p_channel_event AS promo_channel_event, p.p_channel_demo AS promo_channel_demo, COUNT(p.p_promo_sk) AS num_promotions, SUM(p.p_cost) AS total_promo_cost, AVG(p.p_cost) AS avg_promo_cost, SUM(i.inv_quantity_on_hand) AS total_inventory_qty FROM promotion p LEFT JOIN inventory i ON p.p_item_sk = i.inv_item_sk WHERE p.p_discount_active = '1' GROUP BY promo_channel_direct_mail, promo_channel_email, promo_channel_catalog, promo_channel_tv, promo_channel_radio, promo_channel_press, promo_channel_event, promo_channel_demo ORDER BY num_promotions DESC, total_promo_cost DESC;
SELECT i.i_category AS category, p.p_channel_dmail AS promo_direct_mail, p.p_channel_email AS promo_email, p.p_channel_catalog AS promo_catalog, COUNT(DISTINCT i.i_item_sk) AS total_items, SUM(ws.ws_quantity) AS total_quantity_sold, AVG(ws.ws_sales_price) AS average_sales_price, SUM(ws.ws_net_paid) AS total_net_paid, SUM(ws.ws_net_profit) AS total_net_profit FROM web_sales ws JOIN item i ON ws.ws_item_sk = i.i_item_sk JOIN promotion p ON ws.ws_promo_sk = p.p_promo_sk GROUP BY i.i_category, p.p_channel_dmail, p.p_channel_email, p.p_channel_catalog ORDER BY total_net_profit DESC, total_quantity_sold DESC;
SELECT sm.sm_type AS shipping_mode, hd.hd_vehicle_count AS household_vehicle_count, COUNT(DISTINCT ws.ws_order_number) AS total_sales_orders, SUM(ws.ws_quantity) AS total_sales_quantity, AVG(ws.ws_sales_price) AS average_sales_price, SUM(ws.ws_net_paid_inc_tax) AS total_sales_amount_inc_tax, COUNT(DISTINCT wr.wr_order_number) AS total_return_orders, SUM(wr.wr_return_quantity) AS total_return_quantity, AVG(wr.wr_return_amt_inc_tax) AS average_return_amount_inc_tax, SUM(wr.wr_net_loss) AS total_net_loss FROM web_sales ws LEFT JOIN web_returns wr ON ws.ws_order_number = wr.wr_order_number LEFT JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk LEFT JOIN household_demographics hd ON ws.ws_bill_hdemo_sk = hd.hd_demo_sk LEFT JOIN inventory inv ON ws.ws_item_sk = inv.inv_item_sk WHERE inv.inv_warehouse_sk IN (1, 2) AND inv.inv_item_sk IN (15040, 8833, 9514) AND hd.hd_vehicle_count = '1' GROUP BY sm.sm_type, hd.hd_vehicle_count ORDER BY total_sales_amount_inc_tax DESC, total_net_loss DESC;
SELECT ca_state, ca_county, COUNT(DISTINCT c_customer_sk) AS total_customers, COUNT(DISTINCT ws_order_number) AS total_web_orders, SUM(ws_net_paid) AS total_web_sales, SUM(ws_net_profit) AS total_web_profit, COUNT(DISTINCT sr_ticket_number) AS total_returns, SUM(sr_return_amt) AS total_return_amount, AVG(sr_return_quantity) AS average_return_quantity, r_reason_desc FROM customer JOIN customer_address ON c_current_addr_sk = ca_address_sk JOIN web_sales ON ws_bill_customer_sk = c_customer_sk LEFT JOIN store_returns ON sr_customer_sk = c_customer_sk AND sr_reason_sk IS NOT NULL LEFT JOIN reason ON sr_reason_sk = r_reason_sk JOIN time_dim ON ws_sold_time_sk = t_time_sk JOIN warehouse ON ws_warehouse_sk = w_warehouse_sk WHERE ca_state IN ('CA', 'TX') AND ((t_hour = '1' AND t_am_pm = 'AM') OR (t_hour = '0')) AND (w_street_number IN ('534', '368', '651', '600')) AND (r_reason_id = 'AAAAAAAANAAAAAAA' OR r_reason_id IS NULL) GROUP BY ca_state, ca_county, r_reason_desc ORDER BY total_web_sales DESC, ca_state, ca_county;
