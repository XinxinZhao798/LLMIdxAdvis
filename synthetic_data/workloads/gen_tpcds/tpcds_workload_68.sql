SELECT cc.cc_country, dd.d_year, sm.sm_type, COUNT(DISTINCT cc.cc_call_center_sk) AS num_call_centers, SUM(hd.hd_vehicle_count) AS total_vehicles, AVG(hd.hd_dep_count) AS avg_dep_count, COUNT(DISTINCT cp.cp_catalog_page_sk) AS num_catalog_pages FROM call_center cc JOIN date_dim dd ON cc.cc_open_date_sk = dd.d_date_sk JOIN household_demographics hd ON cc.cc_mkt_id = hd.hd_income_band_sk JOIN catalog_page cp ON cc.cc_division = cp.cp_catalog_number JOIN ship_mode sm ON cc.cc_company = sm.sm_carrier::integer WHERE cc.cc_country = 'United States' AND hd.hd_demo_sk IN ('2794', '432') AND hd.hd_income_band_sk IN ('7', '2', '11', '12') AND dd.d_current_year = 'N' AND cp.cp_catalog_page_id IN ('AAAAAAAACKOAAAAA', 'AAAAAAAAODAAAAAA', 'AAAAAAAAEBMAAAAA', 'AAAAAAAAGLCBAAAA') AND dd.d_same_day_lq = '2419796' GROUP BY cc.cc_country, dd.d_year, sm.sm_type ORDER BY dd.d_year, sm.sm_type;
SELECT sm.sm_type AS shipping_type, COUNT(DISTINCT cs.cs_order_number) AS total_orders, SUM(cs.cs_quantity) AS total_items_sold, AVG(cs.cs_sales_price) AS average_sales_price, SUM(cs.cs_net_paid) AS total_revenue, SUM(cs.cs_net_profit) AS total_profit, COUNT(DISTINCT wr.wr_order_number) AS total_returns, SUM(wr.wr_return_quantity) AS total_items_returned, AVG(wr.wr_return_amt) AS average_return_amount, SUM(wr.wr_net_loss) AS total_loss FROM catalog_sales cs JOIN ship_mode sm ON cs.cs_ship_mode_sk = sm.sm_ship_mode_sk LEFT JOIN web_returns wr ON cs.cs_order_number = wr.wr_order_number AND cs.cs_item_sk = wr.wr_item_sk JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk WHERE sm.sm_type IN ('REGULAR', 'OVERNIGHT') AND cd.cd_gender IN ('M', 'F') AND cs.cs_quantity IN (91, 62, 46, 68, 45) AND (wr.wr_returned_time_sk = 74117 OR wr.wr_returned_time_sk IS NULL) GROUP BY sm.sm_type ORDER BY total_revenue DESC, total_loss ASC;
SELECT w_state, w_city, i_category, i_class, i_brand, AVG(i_current_price) AS avg_price, SUM(inv_quantity_on_hand) AS total_inventory, COUNT(DISTINCT i_item_sk) AS unique_items_count, MAX(i_current_price) AS max_price, MIN(i_current_price) AS min_price, COUNT(DISTINCT hd_demo_sk) AS unique_households, AVG(hd_dep_count) AS avg_dependency_count FROM warehouse w JOIN inventory inv ON w.w_warehouse_sk = inv.inv_warehouse_sk JOIN item i ON inv.inv_item_sk = i.i_item_sk LEFT JOIN household_demographics hd ON hd.hd_income_band_sk = i.i_brand_id WHERE w.w_zip = '35709' AND w.w_state = 'TN' AND w.w_street_type IN ('Dr.', 'Drive', 'Parkway') AND w.w_city = 'Fairview' AND inv.inv_date_sk = 2450815 AND inv.inv_quantity_on_hand IN (396, 595, 454) AND inv.inv_warehouse_sk IN (2, 1) AND i.i_container = 'Unknown' AND i.i_item_sk IN (4699, 4967, 949) AND hd.hd_dep_count IN (4, 1, 6) AND hd.hd_income_band_sk IN (9, 18, 10) GROUP BY w_state, w_city, i_category, i_class, i_brand ORDER BY total_inventory DESC, avg_price DESC;
SELECT s_store_name, cd_gender, cd_marital_status, cd_education_status, SUM(ss_quantity) AS total_quantity_sold, SUM(ss_net_paid) AS total_revenue, AVG(ss_sales_price) AS average_sales_price, COUNT(DISTINCT c_customer_sk) AS unique_customers, SUM(wr_return_quantity) AS total_return_quantity, SUM(wr_return_amt) AS total_return_amount, AVG(wr_fee) AS average_return_fee FROM store_sales JOIN store ON ss_store_sk = s_store_sk JOIN customer ON ss_customer_sk = c_customer_sk JOIN customer_demographics ON ss_cdemo_sk = cd_demo_sk LEFT JOIN web_returns ON ss_item_sk = wr_item_sk AND ss_ticket_number = wr_order_number WHERE ss_sold_date_sk BETWEEN 20020101 AND 20020131 AND cd_purchase_estimate > 10000 AND s_number_employees BETWEEN 50 AND 200 AND (wr_returned_date_sk IS NULL OR wr_returned_date_sk BETWEEN 20020201 AND 20020228) GROUP BY s_store_name, cd_gender, cd_marital_status, cd_education_status ORDER BY total_revenue DESC, s_store_name, cd_gender, cd_marital_status, cd_education_status;
SELECT p.p_promo_name AS promotion_name, i.ib_lower_bound AS income_band_lower_bound, i.ib_upper_bound AS income_band_upper_bound, COUNT(DISTINCT c.cd_demo_sk) AS number_of_customers, SUM(ss.ss_quantity) AS total_quantity_sold, AVG(ss.ss_sales_price) AS average_sales_price, SUM(ss.ss_net_paid) AS total_net_paid, SUM(ws.ws_net_paid_inc_tax) AS web_total_net_paid_inc_tax, COUNT(DISTINCT cp.cp_catalog_page_sk) AS number_of_catalog_pages_used, COUNT(DISTINCT inv.inv_item_sk) AS number_of_items_sold FROM store_sales ss JOIN promotion p ON ss.ss_promo_sk = p.p_promo_sk JOIN customer_demographics c ON ss.ss_cdemo_sk = c.cd_demo_sk JOIN income_band i ON c.cd_purchase_estimate BETWEEN i.ib_lower_bound AND i.ib_upper_bound JOIN web_sales ws ON ss.ss_item_sk = ws.ws_item_sk AND ss.ss_customer_sk = ws.ws_bill_customer_sk JOIN catalog_page cp ON ws.ws_web_page_sk = cp.cp_catalog_page_sk JOIN inventory inv ON ws.ws_item_sk = inv.inv_item_sk WHERE p.p_discount_active = 'Y' AND ss.ss_sold_date_sk BETWEEN 2451271 AND 2451575 AND cp.cp_start_date_sk BETWEEN 2451088 AND 2451420 AND inv.inv_quantity_on_hand > 0 GROUP BY promotion_name, income_band_lower_bound, income_band_upper_bound ORDER BY total_net_paid DESC, number_of_customers DESC;
