SELECT d_year, cd_gender, cd_marital_status, cd_education_status, sm_type, COUNT(DISTINCT cs_order_number) AS total_orders, SUM(cs_quantity) AS total_items_sold, AVG(cs_sales_price) AS avg_sales_price, SUM(cs_net_paid) AS total_net_paid, SUM(cs_net_paid_inc_tax) AS total_net_paid_inc_tax, SUM(cs_net_paid_inc_ship) AS total_net_paid_inc_ship, SUM(cs_net_paid_inc_ship_tax) AS total_net_paid_inc_ship_tax, SUM(cs_net_profit) AS total_net_profit FROM catalog_sales JOIN customer_demographics ON cs_bill_cdemo_sk = cd_demo_sk JOIN date_dim ON cs_sold_date_sk = d_date_sk JOIN ship_mode ON cs_ship_mode_sk = sm_ship_mode_sk WHERE d_year = 2003 AND cd_dep_count BETWEEN 1 AND 2 AND cd_purchase_estimate IN (3000, 6000, 8000, 7000) AND sm_ship_mode_id IN ('AAAAAAAABBAAAAAA', 'AAAAAAAAOAAAAAAA', 'AAAAAAAAFAAAAAAA', 'AAAAAAAAJAAAAAAA') AND sm_contract IN ('GNJr3g5i7oorKqtX', 'O9V6oF8RJnLMmZYd1', 'UaAJjKDnL4gTOqbpj') AND cs_net_paid_inc_tax IN ('3193.96', '1181.18', '1413.67') GROUP BY ROLLUP(d_year, cd_gender, cd_marital_status, cd_education_status, sm_type) ORDER BY d_year, cd_gender, cd_marital_status, cd_education_status, sm_type;
SELECT ca.ca_state AS customer_state, EXTRACT(YEAR FROM d_date) AS year_of_return, COUNT(DISTINCT wr.wr_order_number) AS total_returns, SUM(wr.wr_return_quantity) AS total_returned_quantity, SUM(wr.wr_return_amt) AS total_return_amount, SUM(wr.wr_return_tax) AS total_tax, SUM(wr.wr_return_amt_inc_tax) AS total_amount_including_tax, SUM(wr.wr_return_ship_cost) AS total_shipping_cost, SUM(wr.wr_refunded_cash) AS total_refunded_cash, SUM(wr.wr_reversed_charge) AS total_reversed_charge, SUM(wr.wr_account_credit) AS total_account_credit, SUM(wr.wr_net_loss) AS total_net_loss FROM web_returns wr JOIN customer c ON wr.wr_returning_customer_sk = c.c_customer_sk JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk JOIN date_dim d ON wr.wr_returned_date_sk = d.d_date_sk WHERE d.d_year >= 2003 GROUP BY ca.ca_state, year_of_return ORDER BY ca.ca_state, year_of_return;
SELECT ca.ca_state, i.i_category, COUNT(cs.cs_order_number) AS total_orders, SUM(cs.cs_ext_sales_price) AS total_sales, AVG(cs.cs_sales_price) AS avg_sales_price, SUM(inv.inv_quantity_on_hand) AS total_inventory FROM catalog_sales cs JOIN customer_address ca ON cs.cs_ship_addr_sk = ca.ca_address_sk JOIN item i ON cs.cs_item_sk = i.i_item_sk JOIN inventory inv ON i.i_item_sk = inv.inv_item_sk AND cs.cs_sold_date_sk = inv.inv_date_sk WHERE cs.cs_wholesale_cost != 26.15 AND i.i_item_sk IN (2, 27, 23, 43, 36, 38) AND inv.inv_date_sk = 2450815 GROUP BY ca.ca_state, i.i_category ORDER BY total_sales DESC, ca.ca_state, i.i_category;
SELECT w_state, i_category, i_brand, SUM(ss_quantity) AS total_quantity_sold, AVG(ss_sales_price) AS average_sales_price, COUNT(DISTINCT ss_customer_sk) AS unique_customer_count, SUM(ss_net_profit) AS total_net_profit FROM store_sales JOIN item ON ss_item_sk = i_item_sk JOIN inventory ON inv_item_sk = i_item_sk JOIN warehouse ON w_warehouse_sk = inventory.inv_warehouse_sk JOIN household_demographics ON ss_hdemo_sk = hd_demo_sk WHERE (i_rec_start_date BETWEEN '2000-01-01' AND '2002-12-31') AND (inv_date_sk BETWEEN 20010101 AND 20021231) AND (w_street_name IN ('Ash Laurel', '6th', 'Wilson Elm', 'View First')) AND (hd_demo_sk IN (156, 867, 379)) AND (ss_sold_time_sk IN (48439, 35208, 48824, 49199, 58065, 67684)) AND (ss_ext_wholesale_cost IN (2791.40, 1191.68, 2550.20, 1499.76, 3663.96, 2041.47)) GROUP BY w_state, i_category, i_brand ORDER BY total_net_profit DESC, total_quantity_sold DESC LIMIT 100;
SELECT i.i_category, i.i_brand, COUNT(DISTINCT ws.ws_order_number) AS total_web_orders, SUM(ws.ws_quantity) AS total_web_quantity_sold, SUM(ws.ws_net_paid) AS total_web_net_paid, AVG(ws.ws_net_profit) AS avg_web_net_profit, COUNT(DISTINCT ss.ss_ticket_number) AS total_store_sales_transactions, SUM(ss.ss_quantity) AS total_store_quantity_sold, SUM(ss.ss_net_paid_inc_tax) AS total_store_net_paid_inc_tax, AVG(ss.ss_net_profit) AS avg_store_net_profit, COUNT(DISTINCT hd.hd_demo_sk) AS unique_customers, AVG(hd.hd_dep_count) AS avg_dependent_count FROM item i LEFT JOIN web_sales ws ON i.i_item_sk = ws.ws_item_sk LEFT JOIN store_sales ss ON i.i_item_sk = ss.ss_item_sk LEFT JOIN household_demographics hd ON ss.ss_hdemo_sk = hd.hd_demo_sk OR ws.ws_ship_hdemo_sk = hd.hd_demo_sk WHERE i.i_brand IN ('edu packunivamalg #16', 'univmaxi #4', 'univnameless #5', 'amalgamalgamalg #17', 'edu packexporti #1') AND (ws.ws_order_number IN ('32000', '17527', '16129', '59722', '23980') OR ss.ss_ticket_number IS NOT NULL) GROUP BY i.i_category, i.i_brand ORDER BY i.i_category, i.i_brand;
SELECT dd.d_year, dd.d_quarter_name, SUM(ws.ws_net_paid) AS total_net_paid, AVG(ws.ws_quantity) AS average_quantity, COUNT(*) AS sales_transactions, SUM(inv.inv_quantity_on_hand) AS total_inventory, COUNT(DISTINCT ws.ws_item_sk) AS distinct_items_sold, COUNT(DISTINCT s.s_store_sk) AS number_of_stores, SUM(cr.cr_return_amount) AS total_return_amount, AVG(cr.cr_return_quantity) AS average_return_quantity, COUNT(DISTINCT cr.cr_item_sk) AS distinct_items_returned FROM date_dim AS dd JOIN web_sales AS ws ON dd.d_date_sk = ws.ws_sold_date_sk JOIN inventory AS inv ON ws.ws_item_sk = inv.inv_item_sk AND ws.ws_sold_date_sk = inv.inv_date_sk JOIN store AS s ON ws.ws_bill_customer_sk = s.s_store_sk LEFT JOIN catalog_returns AS cr ON ws.ws_item_sk = cr.cr_item_sk AND ws.ws_order_number = cr.cr_order_number WHERE dd.d_current_year = 'N' AND ws.ws_promo_sk IS NOT NULL AND s.s_market_id IN (8, 2, 4, 7) AND inv.inv_warehouse_sk IN (1, 2) GROUP BY dd.d_year, dd.d_quarter_name ORDER BY dd.d_year, dd.d_quarter_name;
SELECT d_year, d_quarter_name, SUM(cs_net_profit) AS total_profit, AVG(cs_quantity) AS average_quantity, COUNT(DISTINCT cs_order_number) AS total_orders, COUNT(DISTINCT sr_ticket_number) AS total_returns, SUM(sr_net_loss) AS total_return_loss, AVG(sr_return_quantity) AS average_return_quantity, COUNT(DISTINCT c_customer_sk) AS total_customers FROM date_dim JOIN catalog_sales ON cs_sold_date_sk = d_date_sk JOIN store_returns ON sr_returned_date_sk = d_date_sk JOIN customer ON (cs_bill_customer_sk = c_customer_sk OR sr_customer_sk = c_customer_sk) JOIN web_site ON c_first_shipto_date_sk = web_open_date_sk WHERE d_moy IN (5, 1, 6) AND web_close_date_sk IN (2448854, 2446944, 2448752) AND sr_returned_date_sk IN (2451779, 2451809) AND c_first_shipto_date_sk IN (2450817, 2450990, 2450273, 2449359, 2449289, 2449658) AND c_first_name IN ('Alecia', 'Allen', 'Deanne') GROUP BY d_year, d_quarter_name ORDER BY d_year, d_quarter_name;
SELECT ca.ca_state, ca.ca_location_type, COUNT(DISTINCT cs.cs_order_number) AS total_orders, SUM(cs.cs_quantity) AS total_quantity_sold, AVG(cs.cs_sales_price) AS average_sales_price, SUM(cs.cs_net_profit) AS total_net_profit, w.w_street_name, w.w_city FROM catalog_sales cs JOIN customer_address ca ON cs.cs_ship_addr_sk = ca.ca_address_sk JOIN warehouse w ON cs.cs_warehouse_sk = w.w_warehouse_sk WHERE ca.ca_state = 'VA' AND ca.ca_location_type IN ('single family', 'apartment', 'condo') AND cs.cs_net_profit > 0 AND w.w_gmt_offset = -5.00 GROUP BY ca.ca_state, ca.ca_location_type, w.w_street_name, w.w_city ORDER BY total_net_profit DESC;
SELECT cc.cc_state, AVG(cc.cc_employees) AS avg_employees, SUM(cc.cc_sq_ft) AS total_sq_ft, COUNT(DISTINCT hd.hd_demo_sk) AS households_with_buy_potential, SUM(CASE WHEN p.p_discount_active = 'Y' THEN p.p_cost ELSE 0 END) AS total_active_promo_cost FROM call_center cc LEFT JOIN household_demographics hd ON hd.hd_income_band_sk IN (5, 1, 17, 14) AND hd.hd_buy_potential IS NOT NULL LEFT JOIN promotion p ON p.p_discount_active = 'Y' AND p.p_channel_press = 'N' WHERE cc.cc_state = 'TN' GROUP BY cc.cc_state;
SELECT c.c_first_name, c.c_last_name, cs_total_sales, ws_total_sales, (cs_total_net_sales + ws_total_net_sales) AS total_combined_net_sales FROM customer c JOIN (SELECT cs_bill_customer_sk, SUM(cs_net_paid) AS cs_total_sales FROM catalog_sales GROUP BY cs_bill_customer_sk) cs_sales ON c.c_customer_sk = cs_sales.cs_bill_customer_sk JOIN (SELECT ws_bill_customer_sk, SUM(ws_net_paid) AS ws_total_sales FROM web_sales GROUP BY ws_bill_customer_sk) ws_sales ON c.c_customer_sk = ws_sales.ws_bill_customer_sk JOIN (SELECT cs_bill_customer_sk, SUM(cs_net_paid_inc_ship_tax) AS cs_total_net_sales FROM catalog_sales GROUP BY cs_bill_customer_sk) total_cs_sales ON c.c_customer_sk = total_cs_sales.cs_bill_customer_sk JOIN (SELECT ws_bill_customer_sk, SUM(ws_net_paid_inc_ship_tax) AS ws_total_net_sales FROM web_sales GROUP BY ws_bill_customer_sk) total_ws_sales ON c.c_customer_sk = total_ws_sales.ws_bill_customer_sk WHERE c.c_birth_country IN ('BRAZIL', 'ROMANIA', 'ICELAND') AND EXISTS (SELECT 1 FROM call_center WHERE cc_call_center_sk = cs_sales.cs_bill_customer_sk AND cc_company_name LIKE 'pri%') AND EXISTS (SELECT 1 FROM web_site WHERE web_site_sk = ws_sales.ws_bill_customer_sk AND web_street_type IN ('Road', 'Way', 'Dr.', 'Cir.', 'Parkway') AND web_street_number IN ('292', '409', '887', '805')) ORDER BY total_combined_net_sales DESC LIMIT 100;
SELECT p.p_promo_id, p.p_promo_name, COUNT(ws.ws_order_number) AS total_orders, SUM(ws.ws_quantity) AS total_quantity_sold, AVG(ws.ws_sales_price) AS average_sales_price, SUM(ws.ws_net_profit) AS total_net_profit FROM web_sales ws INNER JOIN promotion p ON ws.ws_promo_sk = p.p_promo_sk INNER JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk INNER JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk INNER JOIN income_band ib ON hd.hd_income_band_sk = ib.ib_income_band_sk WHERE p.p_channel_press = 'N' AND hd.hd_vehicle_count IN (1, 2) AND ib.ib_income_band_sk IN (20, 8) AND p.p_purpose <> 'Unknown' GROUP BY p.p_promo_id, p.p_promo_name ORDER BY total_net_profit DESC, total_quantity_sold DESC;
SELECT ca_state, r_reason_desc, COUNT(*) AS total_returns, SUM(sr_return_quantity) AS total_returned_quantity, AVG(sr_return_amt_inc_tax) AS average_return_amount_inc_tax, SUM(ss_net_paid_inc_tax) AS total_sales_amount_inc_tax, AVG(ss_quantity) AS average_quantity_sold, SUM(ss_net_profit) AS total_net_profit FROM store_returns JOIN store_sales ON store_returns.sr_item_sk = store_sales.ss_item_sk AND store_returns.sr_ticket_number = store_sales.ss_ticket_number JOIN reason ON store_returns.sr_reason_sk = reason.r_reason_sk JOIN customer_address ON store_returns.sr_addr_sk = customer_address.ca_address_sk GROUP BY ca_state, r_reason_desc ORDER BY ca_state, r_reason_desc;
SELECT cc.cc_call_center_id, cc.cc_name, cc.cc_city, cc.cc_state, r.r_reason_desc, COUNT(cr.cr_order_number) AS total_returns, SUM(cr.cr_return_quantity) AS total_returned_items, AVG(cr.cr_return_amount) AS avg_return_amount, SUM(cr.cr_return_tax) AS total_tax, SUM(cr.cr_return_ship_cost) AS total_ship_cost, SUM(cr.cr_net_loss) AS total_net_loss FROM call_center cc JOIN catalog_returns cr ON cc.cc_call_center_sk = cr.cr_call_center_sk JOIN reason r ON cr.cr_reason_sk = r.r_reason_sk WHERE cc.cc_zip = '31904' AND cr.cr_return_amt_inc_tax > 0 AND r.r_reason_desc IN ('Found a better price in a store', 'its is a boy') GROUP BY cc.cc_call_center_id, cc.cc_name, cc.cc_city, cc.cc_state, r.r_reason_desc ORDER BY total_returns DESC, total_returned_items DESC;
