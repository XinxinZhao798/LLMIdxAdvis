SELECT dd.d_year, dd.d_quarter_name, SUM(ws.ws_sales_price) AS total_sales, AVG(ws.ws_quantity) AS average_quantity, COUNT(DISTINCT ws.ws_order_number) AS order_count, SUM(CASE WHEN ca.ca_location_type = 'condo' THEN ws.ws_net_paid_inc_tax ELSE 0 END) AS condo_sales_tax, SUM(CASE WHEN ca.ca_location_type = 'single family' THEN ws.ws_net_paid_inc_tax ELSE 0 END) AS single_family_sales_tax, SUM(CASE WHEN ib.ib_income_band_sk = 17 THEN ws.ws_net_paid ELSE 0 END) AS band_17_net_paid, COUNT(DISTINCT CASE WHEN ca.ca_county IN ('Telfair County', 'Cherokee County') THEN ws.ws_bill_addr_sk ELSE NULL END) AS unique_addresses_in_counties, COUNT(DISTINCT CASE WHEN p.p_discount_active = '1' THEN ws.ws_promo_sk ELSE NULL END) AS active_promo_count FROM web_sales ws JOIN date_dim dd ON ws.ws_sold_date_sk = dd.d_date_sk JOIN customer_address ca ON ws.ws_bill_addr_sk = ca.ca_address_sk JOIN income_band ib ON ws.ws_bill_cdemo_sk = ib.ib_income_band_sk LEFT JOIN promotion p ON ws.ws_promo_sk = p.p_promo_sk WHERE dd.d_year = 2023 AND ib.ib_lower_bound >= 0 AND (ca.ca_location_type IN ('condo', 'single family') OR ca.ca_county IN ('Telfair County', 'Cherokee County')) GROUP BY dd.d_year, dd.d_quarter_name ORDER BY dd.d_year, dd.d_quarter_name;
SELECT i.i_category AS item_category, ib.ib_income_band_sk AS income_band_id, COUNT(DISTINCT i.i_item_sk) AS num_items_sold, SUM(inv.inv_quantity_on_hand) AS total_quantity, AVG(i.i_current_price) AS average_sales_price FROM inventory inv JOIN item i ON inv.inv_item_sk = i.i_item_sk JOIN income_band ib ON i.i_wholesale_cost BETWEEN ib.ib_lower_bound AND ib.ib_upper_bound WHERE i.i_rec_start_date <= CURRENT_DATE AND (i.i_rec_end_date IS NULL OR i.i_rec_end_date > CURRENT_DATE) GROUP BY i.i_category, ib.ib_income_band_sk ORDER BY ib.ib_income_band_sk, average_sales_price DESC;
SELECT c.c_birth_country, COUNT(DISTINCT c.c_customer_sk) AS num_customers, SUM(ss.ss_quantity) AS total_quantity_sold, AVG(ss.ss_net_paid_inc_tax) AS avg_net_paid_inc_tax, SUM(CASE WHEN ss.ss_net_paid_inc_tax > 1000 THEN ss.ss_quantity ELSE 0 END) AS quantity_sold_above_1000, COUNT(DISTINCT p.p_promo_sk) AS num_promotions, SUM(p.p_cost) AS total_promotion_cost, w.w_state, COUNT(DISTINCT w.w_warehouse_sk) AS num_warehouses, SUM(w.w_warehouse_sq_ft) AS total_warehouse_sq_ft FROM customer c JOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk JOIN promotion p ON ss.ss_promo_sk = p.p_promo_sk JOIN warehouse w ON w.w_zip = c.c_current_addr_sk::character varying WHERE c.c_birth_country IN ('THAILAND', 'ITALY') AND ss.ss_net_paid_inc_tax::text IN ('307.45', '859.21', '1169.72', '3293.51', '222.26') GROUP BY c.c_birth_country, w.w_state ORDER BY total_quantity_sold DESC;
SELECT cc.cc_call_center_id, cc.cc_name, cc.cc_class, SUM(ss.ss_quantity) AS total_quantity_sold, AVG(ss.ss_sales_price) AS average_sales_price, COUNT(DISTINCT c.c_customer_sk) AS unique_customers, COUNT(DISTINCT cp.cp_catalog_page_sk) AS catalog_pages_used, SUM(ss.ss_net_paid) AS total_net_paid, SUM(ss.ss_net_paid_inc_tax) AS total_net_paid_including_tax, SUM(ss.ss_net_profit) AS total_net_profit, AVG(t.t_hour) AS average_hour_of_sale FROM call_center cc JOIN store_sales ss ON cc.cc_call_center_sk = ss.ss_store_sk JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk JOIN catalog_page cp ON c.c_current_cdemo_sk = cp.cp_catalog_page_sk JOIN time_dim t ON ss.ss_sold_time_sk = t.t_time_sk WHERE (cc.cc_rec_start_date IS NULL OR cc.cc_rec_start_date <= CURRENT_DATE) AND (cc.cc_rec_end_date IS NULL OR cc.cc_rec_end_date >= CURRENT_DATE) AND t.t_second IN ('16', '11') AND ss.ss_hdemo_sk IN ('1989', '6188') AND c.c_current_hdemo_sk IN ('3971', '3131', '4808', '7162', '6897', '2935') AND cc.cc_call_center_sk = 5 GROUP BY cc.cc_call_center_id, cc.cc_name, cc.cc_class ORDER BY total_net_profit DESC, average_sales_price DESC;
SELECT cp.cp_department, COUNT(DISTINCT ss.ss_ticket_number) AS total_sales_transactions, SUM(ss.ss_quantity) AS total_sales_quantity, SUM(ss.ss_net_paid) AS total_sales_amount, COUNT(DISTINCT sr.sr_ticket_number) AS total_return_transactions, SUM(sr.sr_return_quantity) AS total_return_quantity, SUM(sr.sr_net_loss) AS total_return_amount, AVG(hd.hd_dep_count) AS avg_dependents, AVG(hd.hd_vehicle_count) AS avg_vehicles FROM catalog_page cp LEFT JOIN store_sales ss ON cp.cp_catalog_page_sk = ss.ss_sold_date_sk LEFT JOIN store_returns sr ON cp.cp_catalog_page_sk = sr.sr_returned_date_sk LEFT JOIN time_dim td ON ss.ss_sold_time_sk = td.t_time_sk LEFT JOIN household_demographics hd ON ss.ss_hdemo_sk = hd.hd_demo_sk WHERE cp.cp_start_date_sk IN ('2451450', '2451545', '2451115', '2450997', '2450935', '2451330') GROUP BY cp.cp_department ORDER BY cp.cp_department;
SELECT cc.cc_name AS call_center_name, cc.cc_city AS city, cc.cc_state AS state, AVG(cd.cd_purchase_estimate) AS avg_purchase_estimate, SUM(cr.cr_return_amount) AS total_return_amount, SUM(cr.cr_return_quantity) AS total_returned_items, COUNT(DISTINCT cr.cr_returned_date_sk) AS days_with_returns, SUM(cr.cr_return_amt_inc_tax - cr.cr_return_amount) AS total_tax_collected, COUNT(DISTINCT cr.cr_refunded_customer_sk) AS unique_customers_refunded, COUNT(DISTINCT cr.cr_returning_customer_sk) AS unique_customers_returning, SUM(CASE WHEN cd.cd_marital_status = 'U' THEN 1 ELSE 0 END) AS unmarried_customers, SUM(CASE WHEN cd.cd_marital_status = 'D' THEN 1 ELSE 0 END) AS divorced_customers, SUM(CASE WHEN cd.cd_marital_status = 'W' THEN 1 ELSE 0 END) AS widowed_customers FROM call_center cc JOIN catalog_returns cr ON cc.cc_call_center_sk = cr.cr_call_center_sk JOIN customer_demographics cd ON cd.cd_demo_sk = cr.cr_refunded_cdemo_sk OR cd.cd_demo_sk = cr.cr_returning_cdemo_sk WHERE cc_rec_end_date IS NULL GROUP BY call_center_name, city, state ORDER BY total_return_amount DESC LIMIT 100;
SELECT d.d_year, d.d_quarter_name, COUNT(distinct wp.wp_web_page_sk) AS webpage_count, AVG(sr.sr_return_amt_inc_tax) AS avg_return_amount_inc_tax, SUM(sr.sr_fee) AS total_return_fees, MAX(cp.cp_catalog_page_number) AS max_catalog_page_number, sm.sm_type AS ship_mode_type, COUNT(distinct ib.ib_income_band_sk) AS income_band_count FROM date_dim d LEFT JOIN web_page wp ON d.d_date_sk = wp.wp_access_date_sk LEFT JOIN store_returns sr ON d.d_date_sk = sr.sr_returned_date_sk LEFT JOIN catalog_page cp ON (d.d_date_sk >= cp.cp_start_date_sk AND d.d_date_sk <= cp.cp_end_date_sk) LEFT JOIN ship_mode sm ON sr.sr_return_ship_cost BETWEEN 36.08 AND 716.95 LEFT JOIN income_band ib ON sr.sr_return_amt_inc_tax BETWEEN ib.ib_lower_bound AND ib.ib_upper_bound WHERE d.d_current_quarter = 'N' AND d.d_year = 2022 AND sm.sm_contract IN ('UaAJjKDnL4gTOqbpj', 'O9V6oF8RJnLMmZYd1', 'fop0bcSd91J26IVpR', 'A5BYO1qH8HGTTN', '5FKNB0j8aaqTB') AND cp.cp_catalog_page_id IN ('AAAAAAAAAEIAAAAA', 'AAAAAAAAMNNAAAAA') GROUP BY d.d_year, d.d_quarter_name, sm.sm_type ORDER BY d.d_year, d.d_quarter_name;
SELECT cs.cs_call_center_sk, cc.cc_name AS call_center_name, cp.cp_catalog_page_id, cp.cp_department, COUNT(cs.cs_order_number) AS total_orders, SUM(cs.cs_quantity) AS total_quantity_sold, AVG(cs.cs_sales_price) AS avg_sales_price, SUM(cs.cs_net_paid) AS total_revenue, SUM(cs.cs_net_profit) AS total_profit, AVG(cs.cs_net_profit) AS avg_profit_per_sale, cd.cd_marital_status, COUNT(DISTINCT cs.cs_bill_customer_sk) AS unique_customers, SUM(inv.inv_quantity_on_hand) AS total_inventory_on_hand FROM catalog_sales cs LEFT JOIN call_center cc ON cs.cs_call_center_sk = cc.cc_call_center_sk LEFT JOIN catalog_page cp ON cs.cs_catalog_page_sk = cp.cp_catalog_page_sk LEFT JOIN customer_demographics cd ON cs.cs_bill_cdemo_sk = cd.cd_demo_sk LEFT JOIN inventory inv ON cs.cs_item_sk = inv.inv_item_sk AND cs_sold_date_sk = inv.inv_date_sk WHERE cc.cc_country = 'United States' AND cs.cs_net_profit > 0 AND inv.inv_date_sk = 2450815 GROUP BY cs.cs_call_center_sk, call_center_name, cp.cp_catalog_page_id, cp.cp_department, cd.cd_marital_status ORDER BY total_revenue DESC, total_profit DESC LIMIT 100;
SELECT hd.hd_income_band_sk, cd.cd_education_status, AVG(ss.ss_sales_price) AS avg_sales_price, SUM(ss.ss_ext_discount_amt) AS total_discount_amt, COUNT(ss.ss_ticket_number) AS sales_count FROM store_sales ss JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk JOIN household_demographics hd ON ss.ss_hdemo_sk = hd.hd_demo_sk WHERE d.d_year = 2022 AND d.d_weekend = 'Y' AND d.d_holiday = 'N' GROUP BY hd.hd_income_band_sk, cd.cd_education_status ORDER BY hd.hd_income_band_sk, cd.cd_education_status;
SELECT sm.sm_type, COUNT(DISTINCT ws.ws_order_number) AS total_orders, SUM(ws.ws_quantity) AS total_quantity_sold, AVG(ws.ws_wholesale_cost) AS avg_wholesale_cost, AVG(ws.ws_sales_price) AS avg_sales_price, SUM(ws.ws_net_profit) AS total_net_profit FROM web_sales ws JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk JOIN warehouse w ON ws.ws_warehouse_sk = w.w_warehouse_sk WHERE w.w_zip = '35709' AND ws.ws_web_site_sk IN (30, 17, 4, 15, 14, 2) AND sm.sm_ship_mode_sk IN (4, 9, 13, 10, 8, 20) GROUP BY sm.sm_type ORDER BY total_net_profit DESC;
SELECT ca.ca_state, ca.ca_city, SUM(cs.cs_quantity) AS total_quantity_sold, AVG(cs.cs_sales_price) AS average_sales_price, COUNT(DISTINCT cs.cs_order_number) AS total_orders, SUM(cs.cs_net_profit) AS total_net_profit, p.p_promo_name, SUM(CASE WHEN p.p_channel_press = 'N' THEN cs.cs_net_paid ELSE 0 END) AS net_paid_no_press_promo, SUM(cs.cs_coupon_amt) AS total_coupon_amount FROM customer_address ca JOIN catalog_sales cs ON ca.ca_address_sk = cs.cs_ship_addr_sk LEFT JOIN promotion p ON cs.cs_promo_sk = p.p_promo_sk WHERE ca.ca_address_sk IN (957, 1773) AND cs.cs_coupon_amt IN (278.88, 333.46, 10.60) AND p.p_channel_press = 'N' AND p.p_start_date_sk IN (2450607, 2450356, 2450342, 2450745) GROUP BY ca.ca_state, ca.ca_city, p.p_promo_name ORDER BY total_net_profit DESC, total_quantity_sold DESC;
SELECT dd.d_year, dd.d_quarter_name, ca.ca_country, ca.ca_state, COUNT(DISTINCT ss.ss_ticket_number) AS total_sales_transactions, SUM(ss.ss_quantity) AS total_quantity_sold, AVG(ss.ss_sales_price) AS average_sales_price, SUM(ss.ss_net_paid) AS total_net_paid, SUM(ss.ss_net_paid_inc_tax) AS total_net_paid_inc_tax, SUM(ss.ss_net_profit) AS total_net_profit, COUNT(DISTINCT web.web_site_sk) AS distinct_websites, COUNT(DISTINCT wp.wp_web_page_sk) AS distinct_web_pages FROM store_sales ss JOIN date_dim dd ON ss.ss_sold_date_sk = dd.d_date_sk JOIN customer_address ca ON ss.ss_addr_sk = ca.ca_address_sk JOIN web_page wp ON wp.wp_customer_sk = ss.ss_customer_sk JOIN web_site web ON web.web_company_id = wp.wp_web_page_sk WHERE dd.d_year = 1998 AND ca.ca_country = 'United States' AND ca.ca_state IN ('NY', 'CA', 'TX') AND web.web_company_id IN ('6', '3', '5') AND wp.wp_autogen_flag = 'N' GROUP BY ROLLUP (dd.d_year, dd.d_quarter_name, ca.ca_country, ca.ca_state) ORDER BY dd.d_year, dd.d_quarter_name, ca.ca_country, ca.ca_state;
SELECT d_year, d_quarter_name, sm_type, ca_state, COUNT(DISTINCT cs_order_number) AS total_orders, SUM(cs_quantity) AS total_quantity_sold, SUM(cs_net_paid) AS total_net_paid, AVG(cs_net_paid_inc_tax) AS avg_net_paid_inc_tax, SUM(cs_net_profit) AS total_net_profit FROM catalog_sales JOIN date_dim ON (cs_sold_date_sk = d_date_sk) JOIN ship_mode ON (cs_ship_mode_sk = sm_ship_mode_sk) JOIN customer_address ON (cs_ship_addr_sk = ca_address_sk) JOIN promotion ON (cs_promo_sk = p_promo_sk) JOIN catalog_page ON (cs_catalog_page_sk = cp_catalog_page_sk) WHERE ca_state IN ('CA', 'TN') AND sm_type IN ('NEXT DAY', 'TWO DAY', 'LIBRARY') AND d_year = 2023 AND p_channel_event = 'N' AND cp_department = 'DEPARTMENT' GROUP BY d_year, d_quarter_name, sm_type, ca_state ORDER BY d_year, d_quarter_name, sm_type, ca_state;
SELECT ws.ws_web_site_sk, ws.ws_web_page_sk, COUNT(DISTINCT ws.ws_order_number) AS total_orders, SUM(ws.ws_quantity) AS total_quantity_sold, AVG(ws.ws_sales_price) AS average_sales_price, SUM(ws.ws_net_paid) AS total_net_paid, SUM(ws.ws_net_profit) AS total_net_profit, w.w_warehouse_name, w.w_county, cd.cd_gender, cd.cd_education_status, cd.cd_credit_rating, COUNT(DISTINCT cd.cd_demo_sk) AS unique_customers FROM web_sales ws JOIN customer_demographics cd ON ws.ws_bill_cdemo_sk = cd.cd_demo_sk JOIN warehouse w ON ws.ws_warehouse_sk = w.w_warehouse_sk WHERE ws.ws_web_page_sk IN ('8', '48', '14', '26', '5') AND w.w_street_name IN ('Ash Laurel', '6th', 'Wilson Elm', 'View First') AND w.w_county = 'Williamson County' AND cd.cd_credit_rating IN ('High Risk', 'Low Risk', 'Good', 'Unknown') GROUP BY ws.ws_web_site_sk, ws.ws_web_page_sk, w.w_warehouse_name, w.w_county, cd.cd_gender, cd.cd_education_status, cd.cd_credit_rating ORDER BY total_net_profit DESC, total_net_paid DESC;
SELECT sm_type, sm_carrier, t_shift, cd_gender, cd_marital_status, cd_education_status, AVG(cd_purchase_estimate) AS avg_purchase_estimate, COUNT(DISTINCT wr_refunded_customer_sk) AS count_distinct_refunded_customers, SUM(wr_return_quantity) AS total_return_quantity, SUM(wr_return_amt) AS total_return_amount, SUM(wr_return_amt_inc_tax) AS total_return_amount_inc_tax, SUM(wr_net_loss) AS total_net_loss FROM web_returns JOIN ship_mode ON sm_ship_mode_sk = wr_item_sk JOIN time_dim ON t_time_sk = wr_returned_time_sk JOIN customer_demographics ON cd_demo_sk = wr_returning_cdemo_sk GROUP BY ROLLUP(sm_type, sm_carrier, t_shift, cd_gender, cd_marital_status, cd_education_status) ORDER BY sm_type, sm_carrier, t_shift, cd_gender, cd_marital_status, cd_education_status;
SELECT cp.cp_department, i.i_category, i.i_brand, sm.sm_type, COUNT(DISTINCT cp.cp_catalog_page_sk) AS num_catalog_pages, COUNT(DISTINCT i.i_item_sk) AS num_items, AVG(i.i_current_price) AS avg_current_price, SUM(i.i_wholesale_cost) AS total_wholesale_cost, COUNT(DISTINCT t.t_time_sk) AS num_time_records, COUNT(DISTINCT sm.sm_ship_mode_sk) AS num_ship_modes FROM catalog_page cp JOIN item i ON cp.cp_catalog_page_sk = i.i_item_sk JOIN time_dim t ON cp.cp_start_date_sk = t.t_time_sk OR cp.cp_end_date_sk = t.t_time_sk JOIN ship_mode sm ON sm.sm_carrier = i.i_manufact WHERE i.i_category IN ('Shoes', 'Jewelry', 'Sports', 'Home', 'Electronics') GROUP BY cp.cp_department, i.i_category, i.i_brand, sm.sm_type ORDER BY num_catalog_pages DESC, num_items DESC;
SELECT c.cp_catalog_page_id, i.i_category, AVG(i.i_current_price) AS avg_current_price, SUM(sr.sr_return_amt) AS total_return_amount, COUNT(DISTINCT sr.sr_customer_sk) AS unique_customers_returning, SUM(wr.wr_return_amt_inc_tax) AS total_web_return_amount_inc_tax, AVG(wr.wr_return_ship_cost) AS avg_web_return_shipping_cost FROM catalog_page AS c JOIN item AS i ON c.cp_catalog_page_sk = i.i_item_sk LEFT JOIN store_returns AS sr ON i.i_item_sk = sr.sr_item_sk LEFT JOIN web_returns AS wr ON i.i_item_sk = wr.wr_item_sk WHERE c.cp_catalog_page_id IN ('AAAAAAAANDFAAAAA', 'AAAAAAAAJNJAAAAA', 'AAAAAAAALHEAAAAA') AND i.i_container = 'Unknown' AND sr.sr_customer_sk IN ('61916', '43478', '92201', '83008') AND sr.sr_item_sk IN ('1729', '3840', '8482') AND wr.wr_return_amt_inc_tax IN ('1793.82', '1539.82', '362.24', '311.63', '176.62', '164.88') AND wr.wr_return_ship_cost IN ('78.85', '1576.94', '590.04') GROUP BY c.cp_catalog_page_id, i.i_category ORDER BY total_return_amount DESC, total_web_return_amount_inc_tax DESC;
SELECT c.c_birth_year, r.r_reason_desc, AVG(sr.sr_return_amt_inc_tax) AS avg_store_return_amount_inc_tax, AVG(wr.wr_return_amt_inc_tax) AS avg_web_return_amount_inc_tax, SUM(sr.sr_return_quantity) AS total_store_return_quantity, SUM(wr.wr_return_quantity) AS total_web_return_quantity, AVG(sr.sr_fee) AS avg_store_fee, AVG(wr.wr_fee) AS avg_web_fee, COUNT(DISTINCT sr.sr_customer_sk) AS num_customers_store, COUNT(DISTINCT wr.wr_refunded_customer_sk) AS num_customers_web FROM customer c LEFT JOIN store_returns sr ON c.c_customer_sk = sr.sr_customer_sk LEFT JOIN web_returns wr ON c.c_customer_sk = wr.wr_refunded_customer_sk LEFT JOIN reason r ON r.r_reason_sk = sr.sr_reason_sk OR r.r_reason_sk = wr.wr_reason_sk WHERE c.c_preferred_cust_flag = 'Y' AND (sr.sr_return_amt IS NOT NULL OR wr.wr_return_amt IS NOT NULL) GROUP BY c.c_birth_year, r.r_reason_desc ORDER BY c.c_birth_year, avg_store_return_amount_inc_tax DESC, avg_web_return_amount_inc_tax DESC;
SELECT cc.cc_call_center_id, cc.cc_name, cc.cc_city, cc.cc_state, AVG(cr.cr_return_amount) AS avg_return_amount, SUM(cr.cr_return_quantity) AS total_return_quantity, COUNT(*) AS total_returns, AVG(hd.hd_vehicle_count) AS avg_vehicle_count, AVG(hd.hd_dep_count) AS avg_dependent_count FROM call_center cc JOIN catalog_returns cr ON cc.cc_call_center_sk = cr.cr_call_center_sk JOIN household_demographics hd ON cr.cr_returning_hdemo_sk = hd.hd_demo_sk WHERE cc.cc_country = 'United States' AND cc.cc_rec_start_date > '1998-01-01' AND hd.hd_vehicle_count IN (1, 2, 3) GROUP BY cc.cc_call_center_id, cc.cc_name, cc.cc_city, cc.cc_state ORDER BY total_return_quantity DESC, avg_return_amount DESC;
SELECT ws.ws_web_site_sk, AVG(ws.ws_sales_price) AS avg_sales_price, COUNT(ws.ws_order_number) AS total_orders, AVG(ws.ws_quantity) AS avg_quantity, SUM(ws.ws_net_paid_inc_tax) AS total_revenue, SUM(ws.ws_net_paid) AS total_net_paid, SUM(ws.ws_coupon_amt) AS total_coupon_amt, AVG(hd.hd_dep_count) AS avg_dependency_count, AVG(hd.hd_vehicle_count) AS avg_vehicle_count, wp.wp_type, COUNT(DISTINCT hd.hd_demo_sk) AS unique_households FROM web_sales ws JOIN web_page wp ON ws.ws_web_page_sk = wp.wp_web_page_sk JOIN household_demographics hd ON ws.ws_ship_hdemo_sk = hd.hd_demo_sk JOIN time_dim td ON ws.ws_sold_time_sk = td.t_time_sk JOIN web_site wsit ON ws.ws_web_site_sk = wsit.web_site_sk WHERE wsit.web_gmt_offset = '-5.00' AND wsit.web_site_sk IN (6, 17, 14) AND td.t_time IN (3552, 4450, 1742) AND ws.ws_sales_price BETWEEN 17.54 AND 205.36 AND ws.ws_item_sk IN (51, 14, 107, 50, 104, 108) GROUP BY ws.ws_web_site_sk, wp.wp_type ORDER BY total_revenue DESC;
SELECT dd.d_year, dd.d_month_seq, COUNT(DISTINCT ws.ws_order_number) AS total_orders, SUM(ws.ws_quantity) AS total_quantity, AVG(ws.ws_sales_price) AS average_sales_price, SUM(ws.ws_net_paid) AS total_net_paid, SUM(ws.ws_net_profit) AS total_net_profit, w.w_country AS warehouse_country, c.c_birth_country AS customer_birth_country FROM web_sales ws JOIN date_dim dd ON ws.ws_sold_date_sk = dd.d_date_sk JOIN warehouse w ON ws.ws_warehouse_sk = w.w_warehouse_sk JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk WHERE dd.d_year = 2023 AND w.w_country IN ('United States', 'Canada') AND c.c_birth_country IN ('MALTA', 'GRENADA') GROUP BY dd.d_year, dd.d_month_seq, w.w_country, c.c_birth_country ORDER BY total_net_profit DESC, dd.d_month_seq, warehouse_country, customer_birth_country;
SELECT cd.cd_gender, cd.cd_marital_status, cd.cd_education_status, COUNT(DISTINCT ws.ws_order_number) AS total_orders, SUM(ws.ws_quantity) AS total_quantity_sold, AVG(ws.ws_sales_price) AS average_sales_price, SUM(ws.ws_net_paid) AS total_net_paid, SUM(ws.ws_net_paid_inc_tax) AS total_net_paid_inc_tax, SUM(wr.wr_return_amt) AS total_return_amt, COUNT(DISTINCT wr.wr_order_number) AS total_returns, (SUM(ws.ws_net_paid_inc_tax) - SUM(wr.wr_return_amt_inc_tax)) AS net_sales_after_returns FROM web_sales ws LEFT JOIN web_returns wr ON ws.ws_order_number = wr.wr_order_number AND ws.ws_item_sk = wr.wr_item_sk JOIN customer_demographics cd ON ws.ws_bill_cdemo_sk = cd.cd_demo_sk WHERE ws.ws_sold_date_sk BETWEEN '2451330' AND '2451329' AND cd.cd_dep_employed_count = '0' GROUP BY cd.cd_gender, cd.cd_marital_status, cd.cd_education_status ORDER BY total_net_paid DESC, total_returns DESC;
SELECT i.i_item_id, i.i_product_name, i.i_category, COUNT(DISTINCT p.p_promo_sk) AS number_of_promotions, SUM(p.p_cost) AS total_promotion_cost, AVG(i.i_wholesale_cost) AS average_wholesale_cost, s.s_state, s.s_store_name, COUNT(DISTINCT s.s_store_sk) AS number_of_stores, AVG(s.s_tax_precentage) AS average_tax_percentage FROM promotion p JOIN item i ON p.p_item_sk = i.i_item_sk JOIN store s ON s.s_state IN ('AK', 'LA', 'MA', 'IA', 'CO', 'NY') WHERE p.p_start_date_sk BETWEEN '2450133' AND '2450769' AND p.p_end_date_sk BETWEEN '2450150' AND '2450824' AND i.i_product_name IN ('ationeseationable', 'antioughtpriable') AND s.s_gmt_offset = '-5.00' AND s.s_store_id IN ('AAAAAAAAHAAAAAAA', 'AAAAAAAABAAAAAAA', 'AAAAAAAAIAAAAAAA') GROUP BY i.i_item_id, i.i_product_name, i.i_category, s.s_state, s.s_store_name ORDER BY i.i_category, s.s_state, total_promotion_cost DESC;
SELECT cc.cc_name, cc.cc_city, cc.cc_state, SUM(cr.cr_return_amount) AS total_return_amount, AVG(cr.cr_return_amount) AS avg_return_amount, COUNT(*) AS total_returns, SUM(cr.cr_net_loss) AS total_net_loss, r.r_reason_desc, COUNT(r.r_reason_desc) AS reason_count FROM call_center cc JOIN catalog_returns cr ON cc.cc_call_center_sk = cr.cr_call_center_sk JOIN reason r ON cr.cr_reason_sk = r.r_reason_sk GROUP BY cc.cc_name, cc.cc_city, cc.cc_state, r.r_reason_desc ORDER BY total_net_loss DESC, total_returns DESC;
SELECT ca.ca_state AS state, i.d_year AS fiscal_year, COUNT(DISTINCT ss.ss_store_sk) AS num_stores, COUNT(DISTINCT ss.ss_item_sk) AS num_products_sold, SUM(ss.ss_quantity) AS total_quantity_sold, SUM(ss.ss_net_paid) AS total_sales, COUNT(DISTINCT sr.sr_store_sk) AS num_stores_with_returns, COUNT(DISTINCT sr.sr_item_sk) AS num_returned_products, SUM(sr.sr_return_quantity) AS total_quantity_returned, SUM(sr.sr_return_amt) AS total_returns, COUNT(DISTINCT cr.cr_call_center_sk) AS num_call_centers_with_returns, COUNT(DISTINCT cr.cr_item_sk) AS num_catalog_returned_products, SUM(cr.cr_return_quantity) AS total_catalog_quantity_returned, SUM(cr.cr_return_amount) AS total_catalog_returns FROM store_sales ss JOIN date_dim i ON ss.ss_sold_date_sk = i.d_date_sk JOIN customer_address ca ON ss.ss_addr_sk = ca.ca_address_sk LEFT JOIN store_returns sr ON ss.ss_ticket_number = sr.sr_ticket_number LEFT JOIN catalog_returns cr ON cr.cr_order_number = ss.ss_ticket_number WHERE i.d_fy_year = 2001 GROUP BY ca.ca_state, i.d_year ORDER BY ca.ca_state, i.d_year;
SELECT ca_state, sm_type, hd_income_band_sk, COUNT(*) AS total_returns, AVG(cr_return_amount) AS avg_return_amount, SUM(cr_return_amount) AS sum_return_amount, MAX(cr_return_amount) AS max_return_amount, MIN(cr_return_amount) AS min_return_amount, AVG(cr_fee) AS avg_fee, SUM(cr_fee) AS sum_fee FROM catalog_returns JOIN customer_address ON catalog_returns.cr_returning_addr_sk = customer_address.ca_address_sk JOIN household_demographics ON catalog_returns.cr_returning_hdemo_sk = household_demographics.hd_demo_sk JOIN ship_mode ON catalog_returns.cr_ship_mode_sk = ship_mode.sm_ship_mode_sk WHERE cr_return_tax > 200 AND cr_order_number IN (4607, 1986, 3937, 3931) AND hd_income_band_sk IN (4, 10) AND sm_contract IN ('6Hzzp4JkzjqD8MGXLCDa', 'Xjy3ZPuiDjzHlRx14Z3', 'O9V6oF8RJnLMmZYd1', 'I3uCelXtjP', 'OrDuVy2H', 'qENFQ') AND sm_carrier IN ('BOXBUNDLES', 'ZOUROS', 'DHL', 'MSC', 'GREAT EASTERN', 'AIRBORNE') GROUP BY ca_state, sm_type, hd_income_band_sk ORDER BY ca_state, sm_type, hd_income_band_sk;
SELECT d_year, i_category, COUNT(DISTINCT c_customer_sk) AS total_customers, SUM(cr_return_quantity) AS total_returned_quantity, AVG(cr_return_amount) AS avg_return_amount, SUM(cr_return_amount) AS total_return_amount, SUM(cr_fee) AS total_fees, AVG(i_current_price) AS avg_item_price, SUM(cr_net_loss) AS total_net_loss FROM catalog_returns JOIN date_dim ON cr_returned_date_sk = d_date_sk JOIN customer ON cr_returning_customer_sk = c_customer_sk JOIN item ON cr_item_sk = i_item_sk WHERE cr_return_quantity = 2 GROUP BY d_year, i_category ORDER BY total_return_amount DESC, total_net_loss DESC LIMIT 100;
SELECT web.web_name AS website_name, COUNT(DISTINCT ws.ws_order_number) AS total_orders, SUM(ws.ws_quantity) AS total_quantity_sold, AVG(ws.ws_sales_price) AS average_sales_price, SUM(ws.ws_net_paid) AS total_net_paid, SUM(ws.ws_net_profit) AS total_net_profit, t.t_shift AS sales_shift, s.s_store_name AS store_name, s.s_number_employees AS number_of_employees, s.s_city AS store_city, SUM(s.s_tax_precentage) AS total_tax_percentage_collected FROM web_sales ws JOIN web_site web ON ws.ws_web_site_sk = web.web_site_sk JOIN time_dim t ON ws.ws_sold_time_sk = t.t_time_sk JOIN store s ON web.web_mkt_id = s.s_market_id WHERE web.web_mkt_id IN ('1', '4', '3') AND t.t_shift = 'third' AND s.s_gmt_offset = '-5.00' AND s.s_number_employees IN ('297', '278', '229', '245') GROUP BY web.web_name, t.t_shift, s.s_store_name, s.s_number_employees, s.s_city ORDER BY total_net_profit DESC;
