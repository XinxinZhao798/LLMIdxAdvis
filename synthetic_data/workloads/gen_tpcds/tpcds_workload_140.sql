SELECT cs.cs_order_number AS order_number, SUM(cs.cs_quantity) AS total_quantity, AVG(cs.cs_sales_price) AS average_sales_price, SUM(cs.cs_net_paid) AS total_net_paid, SUM(cs.cs_net_profit) AS total_net_profit, COUNT(DISTINCT cs.cs_bill_customer_sk) AS unique_customers, ib.ib_lower_bound AS income_lower_bound, ib.ib_upper_bound AS income_upper_bound, SUM(ws.ws_quantity) AS web_total_quantity, AVG(ws.ws_sales_price) AS web_average_sales_price, SUM(ws.ws_net_paid) AS web_total_net_paid, SUM(ws.ws_net_profit) AS web_total_net_profit, COUNT(DISTINCT ws.ws_bill_customer_sk) AS web_unique_customers FROM catalog_sales cs JOIN income_band ib ON cs.cs_bill_hdemo_sk = ib.ib_income_band_sk JOIN web_sales ws ON cs.cs_item_sk = ws.ws_item_sk AND cs.cs_order_number = ws.ws_order_number WHERE cs.cs_ext_tax IN (0.56, 96.57, 30.68, 46.59, 64.13) AND ib.ib_income_band_sk IN (19, 17, 16, 10, 1) GROUP BY cs.cs_order_number, ib.ib_lower_bound, ib.ib_upper_bound ORDER BY total_net_profit DESC, web_total_net_profit DESC LIMIT 100;
SELECT t_shift AS shift_period, promotion_summary.channel, COUNT(*) AS promotion_count, SUM(promotion_summary.total_cost) AS total_promotion_cost, AVG(promotion_summary.p_response_target) AS average_response_target, SUM(web_returns_summary.return_quantity) AS total_return_quantity, SUM(web_returns_summary.return_amount) AS total_return_amount, SUM(web_returns_summary.return_amount_inc_tax) AS total_return_amount_inc_tax, AVG(web_returns_summary.fee) AS average_fee, SUM(web_returns_summary.net_loss) AS total_net_loss FROM (SELECT p_promo_sk, p_start_date_sk, p_end_date_sk, p_item_sk, CASE WHEN p_channel_dmail = 'Y' THEN 'Direct Mail' WHEN p_channel_email = 'Y' THEN 'Email' WHEN p_channel_catalog = 'Y' THEN 'Catalog' WHEN p_channel_tv = 'Y' THEN 'TV' WHEN p_channel_radio = 'Y' THEN 'Radio' WHEN p_channel_press = 'Y' THEN 'Press' WHEN p_channel_event = 'Y' THEN 'Event' WHEN p_channel_demo = 'Y' THEN 'Demo' ELSE 'Other' END AS channel, p_cost AS total_cost, p_response_target FROM promotion WHERE p_discount_active = 'Y' ) AS promotion_summary JOIN time_dim ON (promotion_summary.p_start_date_sk = time_dim.t_time_sk OR promotion_summary.p_end_date_sk = time_dim.t_time_sk) LEFT JOIN (SELECT wr_returned_date_sk, wr_returned_time_sk, wr_item_sk, SUM(wr_return_quantity) AS return_quantity, SUM(wr_return_amt) AS return_amount, SUM(wr_return_amt_inc_tax) AS return_amount_inc_tax, AVG(wr_fee) AS fee, SUM(wr_net_loss) AS net_loss FROM web_returns GROUP BY wr_returned_date_sk, wr_returned_time_sk, wr_item_sk ) AS web_returns_summary ON promotion_summary.p_item_sk = web_returns_summary.wr_item_sk GROUP BY shift_period, promotion_summary.channel ORDER BY total_promotion_cost DESC, shift_period;
SELECT w.w_state, SUM(w.w_warehouse_sq_ft) AS total_warehouse_sq_ft, AVG(w.w_gmt_offset) AS average_gmt_offset, COUNT(r.r_reason_sk) AS gift_exchange_occurrences FROM warehouse w LEFT JOIN reason r ON r.r_reason_desc = 'Gift exchange' JOIN time_dim t ON t.t_minute BETWEEN 25 AND 35 GROUP BY w.w_state ORDER BY total_warehouse_sq_ft DESC, average_gmt_offset DESC;
SELECT i.i_category, i.i_brand, COUNT(DISTINCT ss.ss_ticket_number) AS total_sales_tickets, SUM(ss.ss_quantity) AS total_items_sold, AVG(ss.ss_sales_price) AS avg_sales_price, SUM(ss.ss_net_profit) AS total_sales_profit, COUNT(DISTINCT sr.sr_ticket_number) AS total_return_tickets, SUM(sr.sr_return_quantity) AS total_items_returned, AVG(sr.sr_return_amt) AS avg_return_amount, SUM(sr.sr_net_loss) AS total_return_loss, AVG(hd.hd_dep_count) AS avg_dependency_count, AVG(hd.hd_vehicle_count) AS avg_vehicle_count FROM item i JOIN store_sales ss ON i.i_item_sk = ss.ss_item_sk LEFT JOIN store_returns sr ON i.i_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number LEFT JOIN household_demographics hd ON ss.ss_hdemo_sk = hd.hd_demo_sk WHERE i.i_brand IN ('corpunivamalg #17', 'namelessnameless #4', 'brandmaxi #10', 'exportimaxi #7') AND i.i_size IN ('large', 'N/A') AND ss.ss_hdemo_sk IN (4195, 6112, 6478, 517, 450, 4114) AND ss.ss_net_paid BETWEEN 34.68 AND 1485.96 GROUP BY i.i_category, i.i_brand ORDER BY total_sales_profit DESC, total_return_loss ASC;
SELECT cc.cc_name, i.i_category, SUM(ss.ss_quantity) AS total_quantity, AVG(ss.ss_sales_price) AS avg_sales_price, COUNT(DISTINCT ss.ss_ticket_number) AS number_of_sales, SUM(ss.ss_net_paid) AS total_net_paid, SUM(ss.ss_net_paid_inc_tax) AS total_net_paid_inc_tax, SUM(ss.ss_net_profit) AS total_net_profit FROM store_sales ss JOIN item i ON ss.ss_item_sk = i.i_item_sk JOIN call_center cc ON cc.cc_division = i.i_class_id JOIN warehouse w ON w.w_warehouse_sk = cc.cc_division WHERE cc.cc_call_center_sk IN ('5', '3', '1') AND cc.cc_division IN ('1', '4', '5', '3') AND w.w_warehouse_sk IN ('3', '5', '1', '4', '2') AND ss.ss_net_paid_inc_tax = '3682.66' GROUP BY cc.cc_name, i.i_category ORDER BY total_net_paid DESC, avg_sales_price DESC;
SELECT i.inv_date_sk, COUNT(DISTINCT cr.cr_order_number) AS total_returns, SUM(cr.cr_return_quantity) AS total_returned_quantity, AVG(cr.cr_return_amount) AS average_return_amount, SUM(cr.cr_net_loss) AS total_net_loss, COUNT(DISTINCT p.p_promo_sk) AS total_promotions, SUM(p.p_cost) AS total_promotion_cost, AVG(i.inv_quantity_on_hand) AS average_inventory_quantity FROM inventory i LEFT JOIN catalog_returns cr ON i.inv_item_sk = cr.cr_item_sk LEFT JOIN promotion p ON i.inv_item_sk = p.p_item_sk WHERE i.inv_date_sk BETWEEN 2450705 AND 2450709 AND i.inv_item_sk IN (7891, 13309, 15649, 8698, 9958) AND ( p.p_channel_catalog = 'N' OR p.p_channel_catalog IS NULL ) AND ( cr.cr_returning_cdemo_sk IN (909578, 1587504, 1439824, 941784, 229946) OR cr.cr_returning_cdemo_sk IS NULL ) GROUP BY i.inv_date_sk ORDER BY i.inv_date_sk;
SELECT dd.d_year, dd.d_quarter_name, i.i_category, i.i_brand, COUNT(DISTINCT ws.web_site_sk) AS number_of_websites, COUNT(DISTINCT wp.wp_web_page_sk) AS number_of_web_pages, COUNT(DISTINCT wr.wr_order_number) AS number_of_returns, SUM(wr.wr_return_amt) AS total_return_amount, AVG(wr.wr_return_quantity) AS avg_return_quantity, AVG(wr.wr_fee) AS avg_return_fee, hd.hd_dep_count, ib.ib_lower_bound AS income_band_lower_bound, ib.ib_upper_bound AS income_band_upper_bound, SUM(hd.hd_vehicle_count) AS total_vehicles FROM web_returns wr JOIN date_dim dd ON wr.wr_returned_date_sk = dd.d_date_sk JOIN web_page wp ON wr.wr_web_page_sk = wp.wp_web_page_sk JOIN item i ON wr.wr_item_sk = i.i_item_sk JOIN web_site ws ON wp.wp_web_page_sk = ws.web_site_sk JOIN household_demographics hd ON wr.wr_returning_hdemo_sk = hd.hd_demo_sk JOIN income_band ib ON hd.hd_income_band_sk = ib.ib_income_band_sk WHERE dd.d_year = 2001 AND i.i_category_id IN (1, 2, 3) AND wr.wr_return_tax > 100 AND hd.hd_income_band_sk = 10 AND wr.wr_refunded_cash BETWEEN 300 AND 4000 GROUP BY dd.d_year, dd.d_quarter_name, i.i_category, i.i_brand, hd.hd_dep_count, ib.ib_lower_bound, ib.ib_upper_bound ORDER BY total_return_amount DESC, avg_return_quantity DESC, avg_return_fee DESC, number_of_websites, number_of_web_pages;
SELECT i_category, i_brand, COUNT(DISTINCT i_item_sk) AS num_items, AVG(i_current_price) AS avg_price, SUM(i_wholesale_cost) AS total_wholesale_cost, COUNT(DISTINCT c_customer_sk) AS num_customers, AVG(hd_dep_count) AS avg_hh_dep_count, AVG(hd_vehicle_count) AS avg_hh_vehicle_count, AVG(income_band.ib_lower_bound + income_band.ib_upper_bound)/2 AS avg_income_band_mid_point FROM item JOIN customer ON i_manager_id = c_customer_sk JOIN household_demographics ON c_current_hdemo_sk = hd_demo_sk JOIN income_band ON hd_income_band_sk = income_band.ib_income_band_sk WHERE i_rec_start_date <= CURRENT_DATE AND (i_rec_end_date IS NULL OR i_rec_end_date > CURRENT_DATE) AND (i_wholesale_cost IN (64.92, 7.17, 78.12, 2.36)) AND (i_manufact IN ('barpriable', 'callyoughtought', 'oughteseation', 'oughtbaranti', 'oughtn st', 'eseeseeing')) AND (income_band.ib_income_band_sk IN (9, 19)) AND (household_demographics.hd_income_band_sk IN (4, 18)) GROUP BY i_category, i_brand ORDER BY avg_price DESC, total_wholesale_cost DESC;
SELECT hd.hd_demo_sk, COUNT(DISTINCT sr.sr_ticket_number) AS total_store_returns, COUNT(DISTINCT wr.wr_order_number) AS total_web_returns, SUM(sr.sr_return_amt) AS total_store_return_amount, AVG(sr.sr_return_amt) AS avg_store_return_amount, SUM(wr.wr_return_amt) AS total_web_return_amount, AVG(wr.wr_return_amt) AS avg_web_return_amount, SUM(CASE WHEN p.p_channel_radio = 'N' AND p.p_channel_demo = 'N' THEN p.p_cost ELSE 0 END) AS non_radio_demo_promo_cost, AVG(CASE WHEN p.p_channel_radio = 'N' AND p.p_channel_demo = 'N' THEN p.p_response_target ELSE NULL END) AS avg_non_radio_demo_response_target FROM household_demographics hd LEFT JOIN store_returns sr ON hd.hd_demo_sk = sr.sr_hdemo_sk LEFT JOIN web_returns wr ON (hd.hd_demo_sk = wr.wr_refunded_hdemo_sk OR hd.hd_demo_sk = wr.wr_returning_hdemo_sk) LEFT JOIN promotion p ON p.p_promo_sk = sr.sr_reason_sk WHERE hd.hd_demo_sk IN (560, 4858) AND (sr.sr_store_sk IN (8, 10) OR sr.sr_store_sk IS NULL) GROUP BY hd.hd_demo_sk ORDER BY hd.hd_demo_sk;
SELECT cp.cp_department, COUNT(DISTINCT ss.ss_item_sk) AS num_products_sold, SUM(ss.ss_quantity) AS total_quantity_sold, SUM(ss.ss_net_paid_inc_tax) AS total_sales, AVG(ss.ss_sales_price) AS average_sales_price FROM store_sales ss JOIN promotion p ON ss.ss_promo_sk = p.p_promo_sk JOIN store s ON ss.ss_store_sk = s.s_store_sk JOIN catalog_page cp ON ss.ss_item_sk = cp.cp_catalog_page_sk JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk WHERE s.s_floor_space IN (6995995, 9078805) AND s.s_market_desc IN ('Mysterious employe', 'Little expectations include yet forward meetings.', 'Events develop i', 'Architects coul') AND p.p_discount_active = '1' AND cd.cd_dep_count IN (1, 2) AND cd.cd_marital_status IN ('D', 'U', 'S', 'M', 'W') AND ss.ss_ext_discount_amt IN (24.03, 205.34) GROUP BY cp.cp_department ORDER BY total_sales DESC;
SELECT i.i_category, r.r_reason_desc, COUNT(*) AS total_returns, SUM(cr.cr_return_amount) AS total_return_amount, AVG(cr.cr_return_amount) AS avg_return_amount, SUM(cr.cr_return_quantity) AS total_return_quantity, AVG(cr.cr_return_quantity) AS avg_return_quantity, COUNT(DISTINCT cr.cr_refunded_customer_sk) AS unique_customers_returned, COUNT(DISTINCT ss.ss_store_sk) AS stores_involved, SUM(ss.ss_sales_price) AS total_sales_amount, AVG(ss.ss_sales_price) AS average_sales_price FROM catalog_returns cr JOIN item i ON cr.cr_item_sk = i.i_item_sk JOIN reason r ON cr.cr_reason_sk = r.r_reason_sk LEFT JOIN store_sales ss ON cr.cr_item_sk = ss.ss_item_sk AND cr.cr_order_number = ss.ss_ticket_number WHERE i.i_size IN ('medium', 'large') AND (cr.cr_returned_date_sk BETWEEN 19990101 AND 19991231 OR cr.cr_returned_date_sk IS NULL) AND i.i_rec_end_date > '2000-01-01' GROUP BY i.i_category, r.r_reason_desc ORDER BY total_return_amount DESC, total_returns DESC LIMIT 10;
SELECT ca.ca_country, ca.ca_state, cp.cp_type, AVG(inv.inv_quantity_on_hand) AS avg_quantity_on_hand, SUM(wr.wr_return_quantity) AS total_returned_quantity, SUM(wr.wr_return_amt) AS total_return_amount, SUM(wr.wr_fee) AS total_return_fees, COUNT(DISTINCT wr.wr_returning_customer_sk) AS distinct_returning_customers FROM web_returns wr JOIN customer_address ca ON wr.wr_returning_addr_sk = ca.ca_address_sk JOIN catalog_page cp ON wr.wr_web_page_sk = cp.cp_catalog_page_sk JOIN inventory inv ON wr.wr_item_sk = inv.inv_item_sk AND wr.wr_returned_date_sk = inv.inv_date_sk WHERE ca.ca_country = 'United States' AND cp.cp_type IN ('bi-annual', 'monthly') AND wr.wr_returning_customer_sk IN ('48847', '59684', '67712', '64182', '84117') GROUP BY ca.ca_country, ca.ca_state, cp.cp_type ORDER BY ca.ca_state, cp.cp_type;
SELECT s_state, COUNT(DISTINCT ss_customer_sk) as total_customers, SUM(ss_quantity) as total_quantity_sold, AVG(ss_sales_price) as average_sales_price, SUM(ss_net_profit) as total_net_profit, SUM(cr_return_amount) as total_return_amount, AVG(hd_dep_count) as average_dependent_count FROM store_sales JOIN store ON ss_store_sk = s_store_sk JOIN catalog_returns ON ss_item_sk = cr_item_sk AND ss_ticket_number = cr_order_number JOIN household_demographics ON ss_hdemo_sk = hd_demo_sk GROUP BY s_state ORDER BY total_net_profit DESC LIMIT 10;
