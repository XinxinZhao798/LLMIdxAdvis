SELECT cc_division_name, cc_market_manager, SUM(ws_net_profit) AS total_profit, AVG(ws_quantity) AS average_quantity_sold, COUNT(DISTINCT ws_order_number) AS total_orders, SUM(wr_net_loss) AS total_net_loss, COUNT(DISTINCT wr_order_number) AS total_returns FROM call_center JOIN web_sales ON cc_call_center_sk = ws_warehouse_sk JOIN web_returns ON ws_order_number = wr_order_number WHERE ws_sold_date_sk BETWEEN 2000 AND 3000 AND ws_ship_mode_sk IN (1, 2) AND wr_reason_sk IN (12, 35, 30, 1, 29) AND cc_market_manager IN ('Julius Durham', 'Matthew Clifton', 'Gary Colburn', 'Julius Tran') GROUP BY cc_division_name, cc_market_manager ORDER BY total_profit DESC, total_net_loss ASC;
SELECT ca.ca_state AS state, i.d_year AS fiscal_year, COUNT(DISTINCT ss.ss_store_sk) AS num_stores, COUNT(DISTINCT ss.ss_item_sk) AS num_products_sold, SUM(ss.ss_quantity) AS total_quantity_sold, SUM(ss.ss_net_paid) AS total_sales, COUNT(DISTINCT sr.sr_store_sk) AS num_stores_with_returns, COUNT(DISTINCT sr.sr_item_sk) AS num_returned_products, SUM(sr.sr_return_quantity) AS total_quantity_returned, SUM(sr.sr_return_amt) AS total_returns, COUNT(DISTINCT cr.cr_call_center_sk) AS num_call_centers_with_returns, COUNT(DISTINCT cr.cr_item_sk) AS num_catalog_returned_products, SUM(cr.cr_return_quantity) AS total_catalog_quantity_returned, SUM(cr.cr_return_amount) AS total_catalog_returns FROM store_sales ss JOIN date_dim i ON ss.ss_sold_date_sk = i.d_date_sk JOIN customer_address ca ON ss.ss_addr_sk = ca.ca_address_sk LEFT JOIN store_returns sr ON ss.ss_ticket_number = sr.sr_ticket_number LEFT JOIN catalog_returns cr ON cr.cr_order_number = ss.ss_ticket_number WHERE i.d_fy_year = 2001 GROUP BY ca.ca_state, i.d_year ORDER BY ca.ca_state, i.d_year;
SELECT s.s_store_id, s.s_zip, cs.cs_sold_date_sk, AVG(cs.cs_sales_price) AS avg_sales_price, SUM(cs.cs_quantity) AS total_quantity_sold, SUM(cs.cs_ext_sales_price) AS total_sales, SUM(cs.cs_net_paid) AS net_paid, SUM(cs.cs_net_paid_inc_tax) AS net_paid_inc_tax, SUM(cs.cs_net_profit) AS net_profit, COUNT(DISTINCT cs.cs_order_number) AS total_orders, AVG(sr.sr_return_amt) AS avg_return_amt, SUM(sr.sr_return_quantity) AS total_return_quantity, SUM(sr.sr_net_loss) AS net_loss FROM catalog_sales cs JOIN store s ON cs.cs_ship_customer_sk = s.s_store_sk LEFT JOIN store_returns sr ON cs.cs_item_sk = sr.sr_item_sk AND cs.cs_order_number = sr.sr_ticket_number WHERE s.s_store_id = 'AAAAAAAACAAAAAAA' AND s.s_zip = '35709' GROUP BY s.s_store_id, s.s_zip, cs.cs_sold_date_sk ORDER BY cs.cs_sold_date_sk DESC;
SELECT cc.cc_city, cc.cc_state, r.r_reason_desc, cd.cd_gender, cd.cd_marital_status, cd.cd_education_status, hd.hd_income_band_sk, COUNT(cr.cr_item_sk) AS total_returned_items, SUM(cr.cr_return_amount) AS total_return_amount, AVG(cr.cr_return_amount) AS avg_return_amount, SUM(cr.cr_fee) AS total_fees, SUM(cr.cr_return_amt_inc_tax) AS total_amount_incl_tax, SUM(cr.cr_net_loss) AS total_net_loss, COUNT(DISTINCT p.p_promo_sk) AS total_promotions_impacted FROM catalog_returns cr LEFT JOIN call_center cc ON cr.cr_call_center_sk = cc.cc_call_center_sk LEFT JOIN reason r ON cr.cr_reason_sk = r.r_reason_sk LEFT JOIN customer_demographics cd ON cr.cr_returning_cdemo_sk = cd.cd_demo_sk LEFT JOIN household_demographics hd ON cr.cr_returning_hdemo_sk = hd.hd_demo_sk LEFT JOIN promotion p ON p.p_item_sk = cr.cr_item_sk AND p.p_channel_press = 'N' WHERE cr.cr_return_amount BETWEEN 300 AND 4500 AND r.r_reason_desc IN ('reason 24', 'reason 26', 'Parts missing', 'unauthoized purchase') AND cd.cd_purchase_estimate = 9000 GROUP BY cc.cc_city, cc.cc_state, r.r_reason_desc, cd.cd_gender, cd.cd_marital_status, cd.cd_education_status, hd.hd_income_band_sk ORDER BY total_return_amount DESC, total_returned_items DESC, cc.cc_city, cc.cc_state;
SELECT cd.cd_education_status, sm.sm_type, p.p_promo_name, COUNT(DISTINCT ss.ss_ticket_number) AS total_sales_transactions, SUM(ss.ss_quantity) AS total_quantity_sold, AVG(ss.ss_sales_price) AS average_sales_price, SUM(ss.ss_net_paid) AS total_net_paid, SUM(ss.ss_net_paid_inc_tax) AS total_net_paid_inc_tax, SUM(ss.ss_net_profit) AS total_net_profit, COUNT(DISTINCT CASE WHEN cd.cd_credit_rating = 'High Risk' THEN ss.ss_ticket_number END) AS high_risk_sales_transactions, COUNT(DISTINCT CASE WHEN cd.cd_credit_rating = 'Low Risk' THEN ss.ss_ticket_number END) AS low_risk_sales_transactions, COUNT(DISTINCT CASE WHEN cd.cd_credit_rating = 'Unknown' THEN ss.ss_ticket_number END) AS unknown_risk_sales_transactions FROM store_sales ss JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk JOIN ship_mode sm ON sm.sm_ship_mode_sk = ss.ss_addr_sk JOIN promotion p ON ss.ss_promo_sk = p.p_promo_sk WHERE cd.cd_purchase_estimate IN ('2000', '1000', '4500') AND cd.cd_dep_employed_count = '0' AND sm.sm_ship_mode_sk IN ('13', '8', '20') AND sm.sm_type IN ('OVERNIGHT', 'NEXT DAY', 'EXPRESS') AND p.p_promo_name SIMILAR TO '%(eing|ation|able)%' AND p.p_promo_id IN ('AAAAAAAAJEAAAAAA', 'AAAAAAAALABAAAAA', 'AAAAAAAALNAAAAAA') AND p.p_channel_email = 'N' AND p.p_channel_event = 'N' AND ss.ss_ext_wholesale_cost IN ('3979.00', '2858.52', '5927.86') AND ss.ss_addr_sk IN ('19112', '41507', '33733') AND ss.ss_wholesale_cost IN ('17.80', '5.24', '22.67') AND ss.ss_sold_time_sk IN ('35178', '54001', '41756') GROUP BY cd.cd_education_status, sm.sm_type, p.p_promo_name ORDER BY total_net_profit DESC, total_sales_transactions DESC, average_sales_price DESC;
SELECT ib.ib_income_band_sk, ib.ib_lower_bound, ib.ib_upper_bound, COUNT(DISTINCT cs.cs_order_number) AS total_orders, SUM(cs.cs_net_paid_inc_ship) AS total_revenue_inc_ship, AVG(cs.cs_net_paid_inc_tax) AS avg_revenue_inc_tax, wp.wp_type, COUNT(wp.wp_web_page_sk) AS page_count, SUM(wp.wp_image_count) AS total_image_count, r.r_reason_desc, COUNT(r.r_reason_sk) AS reason_count FROM catalog_sales cs JOIN income_band ib ON cs.cs_bill_hdemo_sk = ib.ib_income_band_sk JOIN web_page wp ON cs.cs_catalog_page_sk = wp.wp_web_page_sk LEFT JOIN reason r ON cs.cs_ship_mode_sk = r.r_reason_sk WHERE cs.cs_ship_cdemo_sk IN ('895212', '186278', '897167') AND cs.cs_net_paid_inc_ship IN (3933.80, 801.00, 5246.97) AND cs.cs_net_paid_inc_tax IN (103.42, 7068.42, 500.16) AND cs.cs_sold_date_sk IN (2450829, 2450822, 2450816) AND r.r_reason_desc IN ('Wrong size', 'No service location in my area', 'Lost my job') AND r.r_reason_id IN ('AAAAAAAANAAAAAAA', 'AAAAAAAAOAAAAAAA', 'AAAAAAAACCAAAAAA') AND r.r_reason_sk IN (11, 14, 19) AND wp.wp_autogen_flag IN ('N', 'Y') AND wp.wp_type IN ('ad', 'order', 'dynamic') AND wp.wp_image_count IN (1, 3, 6) AND wp.wp_web_page_sk IN (44, 58, 40) AND ib.ib_upper_bound IN (70000, 200000, 140000) AND ib.ib_income_band_sk IN (10, 15, 2) AND ib.ib_lower_bound IN (130001, 190001, 20001) GROUP BY ib.ib_income_band_sk, wp.wp_type, r.r_reason_desc ORDER BY total_revenue_inc_ship DESC, avg_revenue_inc_tax DESC, total_orders DESC, page_count DESC, total_image_count DESC, reason_count DESC;
SELECT cd.cd_gender, cd.cd_marital_status, cd.cd_education_status, cd.cd_credit_rating, wsit.web_name, wsit.web_manager, COUNT(DISTINCT ws.ws_order_number) AS total_orders, SUM(ws.ws_quantity) AS total_quantity_sold, SUM(ws.ws_net_paid) AS total_net_paid, SUM(ws.ws_net_profit) AS total_net_profit, AVG(ws.ws_net_profit) AS average_net_profit_per_sale, MAX(ws.ws_net_profit) AS max_net_profit_single_sale, MIN(ws.ws_net_profit) AS min_net_profit_single_sale FROM web_sales ws JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk JOIN web_site wsit ON ws.ws_web_site_sk = wsit.web_site_sk WHERE cd.cd_credit_rating IN ('Low Risk', 'High Risk', 'Good') AND wsit.web_country = 'United States' AND ws.ws_sold_date_sk BETWEEN 2000000 AND 2020000 GROUP BY cd.cd_gender, cd.cd_marital_status, cd.cd_education_status, cd.cd_credit_rating, wsit.web_name, wsit.web_manager ORDER BY total_net_profit DESC, cd.cd_gender, cd.cd_credit_rating;
SELECT s_store_name, s_state, COUNT(sr_ticket_number) AS total_returns, SUM(sr_return_amt) AS total_return_amount, AVG(sr_return_quantity) AS average_return_quantity, SUM(ws_net_paid_inc_tax) AS total_sales_inc_tax, AVG(ws_list_price) AS average_list_price, AVG(ws_net_profit) AS average_net_profit FROM store s JOIN store_returns sr ON s.s_store_sk = sr.sr_store_sk JOIN web_sales ws ON sr.sr_item_sk = ws.ws_item_sk JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk WHERE c.c_email_address IN ( 'Adam.Chambers@1fmL5RoSch74.edu', 'William.Kaye@Mx1n74bCJjkc08.edu', 'Imogene.Lewis@813MelxMLZ9gy.com', 'Dorothy.Garza@6Tn1dJ431OQYNTb.org', 'Ora.Spain@CT.edu', 'Denise.Gomez@3GlO.edu' ) AND ws.ws_net_paid_inc_tax IN (15407.14, 2937.00, 988.50, 3439.64, 992.77) AND ws.ws_list_price IN (177.80, 201.11) AND hd.hd_income_band_sk IN (16, 7) AND sr.sr_return_tax IN (215.85, 29.41, 35.05, 67.89) GROUP BY s_store_name, s_state ORDER BY total_return_amount DESC;
SELECT s.s_division_id AS store_division_id, s.s_division_name AS store_division_name, hd.hd_income_band_sk AS household_income_band, COUNT(DISTINCT ws.ws_order_number) AS total_web_sales, AVG(ws.ws_sales_price) AS average_sales_price, COUNT(DISTINCT sr.sr_ticket_number) AS total_store_returns, AVG(sr.sr_return_amt) AS average_return_amount FROM store s LEFT JOIN web_sales ws ON s.s_store_sk = ws.ws_ship_customer_sk LEFT JOIN store_returns sr ON s.s_store_sk = sr.sr_store_sk LEFT JOIN household_demographics hd ON (ws.ws_ship_hdemo_sk = hd.hd_demo_sk OR sr.sr_hdemo_sk = hd.hd_demo_sk) WHERE ws.ws_order_number IS NOT NULL OR sr.sr_ticket_number IS NOT NULL GROUP BY s.s_division_id, s.s_division_name, hd.hd_income_band_sk ORDER BY s.s_division_id, hd.hd_income_band_sk;
SELECT s_store_name, COUNT(DISTINCT ws_order_number) AS total_web_sales_orders, SUM(ws_net_paid) AS total_web_sales_revenue, AVG(ws_quantity) AS avg_web_sales_quantity, SUM(sr_return_amt) AS total_store_returns_revenue, AVG(sr_return_quantity) AS avg_store_returns_quantity, COUNT(DISTINCT cr_order_number) AS total_catalog_returns_orders, SUM(cr_return_amount) AS total_catalog_returns_revenue, AVG(cr_return_quantity) AS avg_catalog_returns_quantity FROM web_sales JOIN store ON ws_ship_customer_sk = s_store_sk JOIN store_returns ON sr_store_sk = s_store_sk JOIN catalog_returns ON cr_catalog_page_sk IN (SELECT cp_catalog_page_sk FROM catalog_page WHERE cp_type = 'monthly') JOIN ship_mode ON web_sales.ws_ship_mode_sk = ship_mode.sm_ship_mode_sk WHERE ws_sold_date_sk BETWEEN 2452235 AND 2452629 AND sr_returned_date_sk = ws_sold_date_sk AND cr_returned_date_sk = ws_sold_date_sk AND ws_net_paid_inc_ship_tax > 7000 AND sm_type IN ('OVERNIGHT', 'REGULAR') GROUP BY s_store_name ORDER BY total_web_sales_revenue DESC;
SELECT s.s_store_name, i.i_category, p.p_channel_details, SUM(cs.cs_net_paid_inc_ship) AS total_sales, SUM(cs.cs_net_profit) AS total_profit, COUNT(DISTINCT cs.cs_order_number) AS total_orders, AVG(cs.cs_quantity) AS average_quantity, SUM(wr.wr_net_loss) AS total_net_loss, COUNT(DISTINCT wr.wr_order_number) AS total_returns, r.r_reason_desc FROM store s JOIN catalog_sales cs ON s.s_store_sk = cs.cs_warehouse_sk JOIN item i ON cs.cs_item_sk = i.i_item_sk LEFT JOIN promotion p ON cs.cs_promo_sk = p.p_promo_sk LEFT JOIN web_returns wr ON cs.cs_item_sk = wr.wr_item_sk AND cs.cs_order_number = wr.wr_order_number LEFT JOIN reason r ON wr.wr_reason_sk = r.r_reason_sk WHERE s.s_country = 'United States' AND ( s.s_store_sk = '8' OR s.s_store_sk = '1' ) AND ( cs.cs_net_paid_inc_ship IN ('6377.67', '3521.76', '158.56', '2257.47', '739.93', '7973.92') ) AND ( r.r_reason_sk IN ('17', '4', '20', '18', '31') OR r.r_reason_sk IS NULL ) AND i.i_class = 'cooking' GROUP BY s.s_store_name, i.i_category, p.p_channel_details, r.r_reason_desc ORDER BY total_sales DESC, total_profit DESC;
SELECT cd.cd_gender, cd.cd_marital_status, cd.cd_education_status, COUNT(DISTINCT cs.cs_order_number) AS total_catalog_orders, SUM(cs.cs_quantity) AS total_catalog_quantity, AVG(cs.cs_sales_price) AS avg_catalog_sales_price, SUM(ss.ss_net_profit) AS total_store_net_profit, AVG(ss.ss_sales_price) AS avg_store_sales_price, COUNT(DISTINCT wp.wp_web_page_sk) AS total_web_page_visits, SUM(wp.wp_link_count) AS total_web_page_links, ws.web_name, ws.web_company_name, ib.ib_lower_bound, ib.ib_upper_bound, s.s_store_name, s.s_number_employees, s.s_floor_space FROM customer_demographics cd LEFT JOIN catalog_sales cs ON cd.cd_demo_sk = cs.cs_bill_cdemo_sk LEFT JOIN store_sales ss ON cd.cd_demo_sk = ss.ss_cdemo_sk LEFT JOIN web_page wp ON cd.cd_demo_sk = wp.wp_customer_sk LEFT JOIN web_site ws ON wp.wp_web_page_id = ws.web_site_id LEFT JOIN income_band ib ON cd.cd_purchase_estimate BETWEEN ib.ib_lower_bound AND ib.ib_upper_bound LEFT JOIN store s ON ss.ss_store_sk = s.s_store_sk LEFT JOIN catalog_page cp ON cs.cs_catalog_page_sk = cp.cp_catalog_page_sk WHERE ib.ib_income_band_sk IN (6, 11, 7) AND (s.s_rec_end_date IN ('1999-03-13', '2000-03-12', '2001-03-12') OR s.s_rec_end_date IS NULL) AND (s.s_store_name LIKE '%cally%' OR s.s_store_name LIKE '%ation%' OR s.s_store_name LIKE '%eing%') AND wp.wp_web_page_id IN ('AAAAAAAAJBAAAAAA', 'AAAAAAAAIAAAAAAA', 'AAAAAAAAMCAAAAAA') AND wp.wp_web_page_sk IN (30, 40, 9) AND wp.wp_rec_end_date IN ('2000-09-02', '1999-09-03', '2001-09-02') AND cd.cd_dep_college_count = 0 AND cd.cd_marital_status IN ('U', 'W', 'S') AND cd.cd_dep_employed_count = 0 AND ss.ss_sales_price IN (6.97, 54.53, 6.01) AND ss.ss_net_profit IN (-2115.52, -1765.80, -614.39) AND cs.cs_ext_tax IN (18.59, 2.99, 205.24) AND cs.cs_sold_date_sk IN (2450841, 2450829, 2450825) AND ws.web_name IN ('site_2', 'site_4', 'site_0') AND ws.web_street_number IN ('887', '973', '892') AND cp.cp_type IN ('quarterly', 'monthly', 'bi-annual') AND cp.cp_catalog_number IN (31, 32, 13) AND cp.cp_end_date_sk IN (2451574, 2451539, 2451299) GROUP BY cd.cd_gender, cd.cd_marital_status, cd.cd_education_status, ws.web_name, ws.web_company_name, ib.ib_lower_bound, ib.ib_upper_bound, s.s_store_name, s.s_number_employees, s.s_floor_space ORDER BY total_catalog_orders DESC, total_store_net_profit DESC, total_web_page_visits DESC;
SELECT d_year, d_moy, sm_type, COUNT(DISTINCT cs_order_number) AS total_orders, SUM(cs_net_paid) AS total_revenue, SUM(cs_net_profit) AS total_profit, AVG(cs_quantity) AS average_quantity, AVG(cs_net_paid_inc_tax) AS average_revenue_inc_tax, SUM(cr_return_amount) AS total_return_amount, AVG(cr_return_quantity) AS average_return_quantity, COUNT(DISTINCT wp_web_page_sk) AS total_web_page_visits, COUNT(DISTINCT s_store_sk) AS total_stores, COUNT(DISTINCT cc_call_center_sk) AS total_call_centers FROM date_dim LEFT JOIN catalog_sales ON cs_sold_date_sk = d_date_sk LEFT JOIN ship_mode ON cs_ship_mode_sk = sm_ship_mode_sk LEFT JOIN catalog_returns ON cr_returned_date_sk = d_date_sk LEFT JOIN web_page ON wp_access_date_sk = d_date_sk LEFT JOIN store ON s_store_sk = cs_ship_customer_sk LEFT JOIN call_center ON cc_call_center_sk = cs_call_center_sk LEFT JOIN customer_demographics ON cs_ship_cdemo_sk = cd_demo_sk WHERE d_year = 2001 AND d_moy BETWEEN 1 AND 6 AND cs_net_paid IS NOT NULL AND sm_type IS NOT NULL AND (cc_sq_ft = '3514' OR cc_sq_ft = '4134' OR cc_sq_ft = '1138') AND (cc_rec_end_date = '2000-12-31' OR cc_rec_end_date = '2001-12-31' OR cc_rec_end_date = '2000-01-01') AND (cc_company = '6' OR cc_company = '3' OR cc_company = '1') AND (cr_return_ship_cost = '2.66' OR cr_return_ship_cost = '13.49' OR cr_return_ship_cost = '26.44') AND (cr_catalog_page_sk = '380' OR cr_catalog_page_sk = '219' OR cr_catalog_page_sk = '388') AND (cr_returned_time_sk = '45077' OR cr_returned_time_sk = '77627' OR cr_returned_time_sk = '32496') AND (sm_contract = '2mM8l' OR sm_contract = 'uukTktPYycct8' OR sm_contract = 'fop0bcSd91J26IVpR') AND (sm_ship_mode_sk = '10' OR sm_ship_mode_sk = '6' OR sm_ship_mode_sk = '4') AND (sm_code = 'SEA' OR sm_code = 'BIKE' OR sm_code = 'SURFACE') AND (sm_carrier = 'FEDEX' OR sm_carrier = 'ZHOU' OR sm_carrier = 'PRIVATECARRIER') AND (cs_ext_tax = '89.97' OR cs_ext_tax = '687.10' OR cs_ext_tax = '221.70') AND (cs_ship_hdemo_sk = '2057' OR cs_ship_hdemo_sk = '6324' OR cs_ship_hdemo_sk = '6945') AND (cs_net_paid_inc_ship_tax = '1307.73' OR cs_net_paid_inc_ship_tax = '1740.39' OR cs_net_paid_inc_ship_tax = '1487.69') AND (d_weekend = 'N' OR d_weekend = 'Y') AND (s_gmt_offset = '-5.00') AND (s_store_sk = '1' OR s_store_sk = '12' OR s_store_sk = '9') AND (s_store_name = 'anti' OR s_store_name = 'ese' OR s_store_name = 'eing') AND (wp_access_date_sk = '2452555' OR wp_access_date_sk = '2452645' OR wp_access_date_sk = '2452576') AND (wp_customer_sk = '20213' OR wp_customer_sk = '98376' OR wp_customer_sk = '60150') AND (wp_web_page_id = 'AAAAAAAAEDAAAAAA' OR wp_web_page_id = 'AAAAAAAAHDAAAAAA' OR wp_web_page_id = 'AAAAAAAAOAAAAAAA') AND (wp_web_page_sk = '3' OR wp_web_page_sk = '17' OR wp_web_page_sk = '36') AND (cd_demo_sk = '18975' OR cd_demo_sk = '21210' OR cd_demo_sk = '20876') AND (cd_dep_count = '2' OR cd_dep_count = '1') GROUP BY d_year, d_moy, sm_type ORDER BY d_year, d_moy, sm_type;
SELECT cp.cp_department, ws_site.web_name, COUNT(DISTINCT cs.cs_order_number) AS total_catalog_orders, SUM(cs.cs_net_paid) AS total_catalog_sales, AVG(cs.cs_net_paid) AS avg_catalog_sales, COUNT(DISTINCT ws.ws_order_number) AS total_web_orders, SUM(ws.ws_net_paid) AS total_web_sales, AVG(ws.ws_net_paid) AS avg_web_sales, SUM(hd.hd_dep_count) AS total_dep_count, AVG(hd.hd_vehicle_count) AS avg_vehicle_count, COUNT(DISTINCT c.c_customer_sk) AS unique_customers FROM catalog_page cp JOIN catalog_sales cs ON cs.cs_catalog_page_sk = cp.cp_catalog_page_sk JOIN web_sales ws ON ws.ws_bill_customer_sk = cs.cs_bill_customer_sk JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk LEFT JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk JOIN web_site ws_site ON ws.ws_web_site_sk = ws_site.web_site_sk WHERE cp.cp_end_date_sk = 2450905 AND cs.cs_net_paid BETWEEN 212.28 AND 1048.16 GROUP BY cp.cp_department, ws_site.web_name ORDER BY total_catalog_sales DESC, total_web_sales DESC LIMIT 100;
SELECT w.w_city, w.w_state, w.w_country, COUNT(*) AS number_of_households, AVG(hd.hd_dep_count) AS average_dependency_count, AVG(hd.hd_vehicle_count) AS average_vehicle_count, AVG(ib.ib_lower_bound) AS average_income_lower_bound, AVG(ib.ib_upper_bound) AS average_income_upper_bound, SUM(CASE WHEN hd.hd_buy_potential = 'Unknown' THEN 1 ELSE 0 END) AS unknown_buy_potential_count, SUM(CASE WHEN hd.hd_buy_potential = 'High' THEN 1 ELSE 0 END) AS high_buy_potential_count, SUM(CASE WHEN hd.hd_buy_potential = 'Low' THEN 1 ELSE 0 END) AS low_buy_potential_count FROM warehouse w JOIN household_demographics hd ON w.w_warehouse_sk = hd.hd_demo_sk JOIN income_band ib ON hd.hd_income_band_sk = ib.ib_income_band_sk GROUP BY w.w_city, w.w_state, w.w_country ORDER BY w.w_country, w.w_state, w.w_city;
