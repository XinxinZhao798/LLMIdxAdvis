SELECT cc.cc_name, cc.cc_city, SUM(ss.ss_quantity) AS total_quantity_sold, AVG(ss.ss_sales_price) AS average_sales_price, COUNT(DISTINCT ss.ss_ticket_number) AS number_of_sales_transactions, SUM(ss.ss_net_profit) AS total_net_profit FROM call_center cc JOIN store_sales ss ON cc.cc_call_center_sk = ss.ss_store_sk JOIN item i ON ss.ss_item_sk = i.i_item_sk JOIN reason r ON r.r_reason_sk = ss.ss_promo_sk WHERE cc.cc_gmt_offset = '-5.00' AND cc.cc_rec_start_date BETWEEN '2001-01-01' AND '2002-01-01' AND ss.ss_quantity IN (65, 96, 9, 80, 52, 68) AND r.r_reason_id = 'AAAAAAAAGBAAAAAA' GROUP BY cc.cc_name, cc.cc_city ORDER BY total_net_profit DESC, total_quantity_sold DESC;
SELECT d_year, i_category, SUM(ss_quantity) AS total_store_sales_quantity, AVG(ss_sales_price) AS avg_store_sales_price, AVG(cs_sales_price) AS avg_catalog_sales_price, AVG(ws_sales_price) AS avg_web_sales_price, SUM(ss_net_paid) AS total_store_net_paid, SUM(cs_net_paid) AS total_catalog_net_paid, SUM(ws_net_paid) AS total_web_net_paid, COUNT(DISTINCT ss_store_sk) AS number_of_stores, COUNT(DISTINCT cs_catalog_page_sk) AS number_of_catalog_pages, COUNT(DISTINCT ws_web_site_sk) AS number_of_websites FROM store_sales JOIN date_dim ON (ss_sold_date_sk = d_date_sk) JOIN item ON (ss_item_sk = i_item_sk) LEFT JOIN catalog_sales ON (ss_item_sk = cs_item_sk AND ss_sold_date_sk = cs_sold_date_sk) LEFT JOIN web_sales ON (ss_item_sk = ws_item_sk AND ss_sold_date_sk = ws_sold_date_sk) WHERE d_year = 1999 AND (ss_net_paid > 900 OR cs_net_paid > 900 OR ws_net_paid > 900) AND i_manager_id IN (65, 2, 85) GROUP BY d_year, i_category ORDER BY total_store_sales_quantity DESC, total_store_net_paid DESC, i_category;
SELECT i.i_category, i.i_brand, COUNT(DISTINCT ss.ss_ticket_number) AS total_sales_tickets, SUM(ss.ss_quantity) AS total_items_sold, AVG(ss.ss_sales_price) AS avg_sales_price, SUM(ss.ss_net_profit) AS total_sales_profit, COUNT(DISTINCT sr.sr_ticket_number) AS total_return_tickets, SUM(sr.sr_return_quantity) AS total_items_returned, AVG(sr.sr_return_amt) AS avg_return_amount, SUM(sr.sr_net_loss) AS total_return_loss, AVG(hd.hd_dep_count) AS avg_dependency_count, AVG(hd.hd_vehicle_count) AS avg_vehicle_count FROM item i JOIN store_sales ss ON i.i_item_sk = ss.ss_item_sk LEFT JOIN store_returns sr ON i.i_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number LEFT JOIN household_demographics hd ON ss.ss_hdemo_sk = hd.hd_demo_sk WHERE i.i_brand IN ('corpunivamalg #17', 'namelessnameless #4', 'brandmaxi #10', 'exportimaxi #7') AND i.i_size IN ('large', 'N/A') AND ss.ss_hdemo_sk IN (4195, 6112, 6478, 517, 450, 4114) AND ss.ss_net_paid BETWEEN 34.68 AND 1485.96 GROUP BY i.i_category, i.i_brand ORDER BY total_sales_profit DESC, total_return_loss ASC;
SELECT c.c_customer_id, c.c_first_name, c.c_last_name, cd.cd_gender, cd.cd_marital_status, cd.cd_education_status, SUM(cr.cr_return_quantity) AS total_catalog_return_quantity, AVG(cr.cr_return_amount) AS avg_catalog_return_amount, COUNT(DISTINCT cr.cr_order_number) AS num_catalog_orders_returned, SUM(sr.sr_return_quantity) AS total_store_return_quantity, AVG(sr.sr_return_amt) AS avg_store_return_amount, COUNT(DISTINCT sr.sr_ticket_number) AS num_store_tickets_returned, (SUM(cr.cr_return_quantity) + SUM(sr.sr_return_quantity)) AS total_combined_return_quantity, (SUM(cr.cr_return_amount) + SUM(sr.sr_return_amt)) AS total_combined_return_amount FROM customer c JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk LEFT JOIN catalog_returns cr ON c.c_customer_sk = cr.cr_refunded_customer_sk LEFT JOIN store_returns sr ON c.c_customer_sk = sr.sr_customer_sk WHERE cd.cd_dep_college_count = 0 AND (cd.cd_dep_count = 1 OR cd.cd_dep_count = 2) AND (c.c_birth_month IN (1, 5, 8)) AND (cr.cr_refunded_cdemo_sk IN (720990, 944590, 673975, 63720) OR cr.cr_refunded_cdemo_sk IS NULL) AND (sr.sr_ticket_number::text IN ('40123', '36273') OR sr.sr_ticket_number IS NULL) GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, cd.cd_gender, cd.cd_marital_status, cd.cd_education_status ORDER BY total_combined_return_amount DESC, c.c_customer_id;
SELECT dd.d_year, dd.d_quarter_name, ca.ca_state, COUNT(cp.cp_catalog_page_sk) AS num_catalog_pages, AVG(dd.d_dom) AS avg_day_of_month, SUM(CASE WHEN dd.d_holiday = 'Y' THEN 1 ELSE 0 END) AS num_holidays, SUM(CASE WHEN dd.d_weekend = 'Y' THEN 1 ELSE 0 END) AS num_weekend_days FROM date_dim dd JOIN catalog_page cp ON dd.d_date_sk BETWEEN cp.cp_start_date_sk AND cp.cp_end_date_sk JOIN customer_address ca ON ca.ca_zip = SUBSTRING(cp.cp_description FROM 1 FOR 10) WHERE dd.d_year IN (1910, 1912, 1908, 1905) AND dd.d_dow IN ('6', '0', '4', '1') AND ca.ca_country = 'United States' AND dd.d_dom BETWEEN 1 AND 15 GROUP BY dd.d_year, dd.d_quarter_name, ca.ca_state ORDER BY dd.d_year, dd.d_quarter_name, ca.ca_state;
