SELECT cp_department, i_category, i_class, COUNT(DISTINCT i_item_sk) AS item_count, SUM(i_current_price) AS total_price, AVG(i_current_price) AS average_price, AVG(i_wholesale_cost) AS average_cost, SUM(i_wholesale_cost) AS total_cost, sm_type, COUNT(DISTINCT sm_ship_mode_sk) AS ship_mode_count FROM catalog_page JOIN item ON (cp_catalog_page_sk = i_item_sk) JOIN ship_mode ON (i_item_sk = sm_ship_mode_sk) WHERE cp_catalog_page_sk IN (2547, 2038, 1714) GROUP BY cp_department, i_category, i_class, sm_type ORDER BY cp_department, i_category, i_class;
SELECT sm.sm_type AS shipping_type, COUNT(DISTINCT c.c_customer_sk) AS number_of_customers, COUNT(DISTINCT wr.wr_order_number) AS total_returns, SUM(wr.wr_return_amt) AS total_return_amount, AVG(wr.wr_return_quantity) AS average_return_quantity, SUM(wr.wr_fee) AS total_return_fees, AVG(wr.wr_net_loss) AS average_net_loss, COUNT(DISTINCT cp.cp_catalog_page_sk) AS total_catalog_pages, AVG(hd.hd_vehicle_count) AS average_vehicle_count, SUM(CASE WHEN d.d_weekend = 'Y' THEN 1 ELSE 0 END) AS weekend_dates_count, SUM(CASE WHEN d.d_holiday = 'Y' THEN 1 ELSE 0 END) AS holiday_dates_count FROM ship_mode sm JOIN web_returns wr ON sm.sm_ship_mode_sk = wr.wr_returned_time_sk JOIN customer c ON wr.wr_returning_customer_sk = c.c_customer_sk JOIN catalog_page cp ON cp.cp_start_date_sk = wr.wr_returned_date_sk JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk JOIN date_dim d ON wr.wr_returned_date_sk = d.d_date_sk WHERE sm.sm_ship_mode_id IN ('AAAAAAAADBAAAAAA', 'AAAAAAAAMAAAAAAA', 'AAAAAAAAOAAAAAAA') AND sm.sm_type IN ('EXPRESS', 'NEXT DAY', 'OVERNIGHT') AND c.c_last_name IN ('Kyle', 'Reddy', 'Bishop') AND cp.cp_type IN ('quarterly', 'monthly', 'bi-annual') AND hd.hd_vehicle_count IN (3, 1, 0) AND hd.hd_buy_potential IN ('5001-10000', '>10000', 'Unknown') AND d.d_weekend IN ('N', 'Y') GROUP BY sm.sm_type;
SELECT d_year, i_category, s_state, SUM(i_current_price) AS total_price, AVG(i_current_price) AS avg_price, COUNT(DISTINCT i_item_sk) AS unique_items_sold, COUNT(DISTINCT s_store_sk) AS number_of_stores, SUM(p_cost) AS total_promotion_cost, AVG(p_cost) AS avg_promotion_cost, COUNT(DISTINCT p_promo_sk) AS number_of_promotions, MAX(wp_max_ad_count) AS max_ad_count_webpage FROM date_dim, item, store, promotion, web_page, ship_mode WHERE i_rec_start_date <= d_date AND (i_rec_end_date IS NULL OR i_rec_end_date > d_date) AND s_rec_start_date <= d_date AND (s_rec_end_date IS NULL OR s_rec_end_date > d_date) AND wp_rec_start_date <= d_date AND (wp_rec_end_date IS NULL OR wp_rec_end_date > d_date) AND p_start_date_sk = d_date_sk AND (p_end_date_sk IS NULL OR p_end_date_sk >= d_date_sk) AND sm_type IN ('REGULAR', 'LIBRARY') AND i_class IN ('sports-apparel', 'decor', 'dvd/vcr players', 'shirts', 'bedding', 'fishing') AND p_channel_event = 'N' AND p_purpose <> 'Unknown' GROUP BY d_year, i_category, s_state ORDER BY d_year, i_category, s_state;
SELECT p.p_promo_id, p.p_promo_name, COUNT(DISTINCT cs.cs_item_sk) AS number_of_items_sold, SUM(cs.cs_quantity) AS total_quantity_sold, AVG(cs.cs_sales_price) AS average_selling_price, SUM(cs.cs_ext_sales_price) AS total_sales_amount, SUM(cs.cs_ext_discount_amt) AS total_discount_amount, AVG((cs.cs_ext_discount_amt / cs.cs_ext_list_price) * 100) AS average_discount_percentage, SUM(cs.cs_net_profit) AS total_net_profit, AVG(inv.inv_quantity_on_hand) AS average_inventory_quantity_on_hand FROM catalog_sales cs JOIN promotion p ON cs.cs_promo_sk = p.p_promo_sk LEFT JOIN inventory inv ON cs.cs_item_sk = inv.inv_item_sk AND cs.cs_sold_date_sk = inv.inv_date_sk WHERE cs.cs_ext_list_price IN (8856.28, 4863.95, 651.00, 4727.68) GROUP BY p.p_promo_id, p.p_promo_name ORDER BY total_sales_amount DESC;
SELECT d_year, i_brand, i_class, i_category, COUNT(DISTINCT cs_order_number) AS total_orders, SUM(cs_quantity) AS total_quantity, SUM(cs_net_paid) AS total_revenue, AVG(cs_net_paid_inc_tax) AS avg_revenue_inc_tax, AVG(cs_net_paid_inc_ship_tax) AS avg_revenue_inc_ship_tax, SUM(cs_net_profit) AS total_profit, COUNT(DISTINCT cs_item_sk) AS distinct_items_sold, MAX(cs_sales_price) AS max_sales_price, MIN(cs_sales_price) AS min_sales_price FROM catalog_sales JOIN date_dim ON (cs_sold_date_sk = d_date_sk) JOIN item ON (cs_item_sk = i_item_sk) JOIN time_dim ON (cs_sold_time_sk = t_time_sk) WHERE d_year = 2000 AND t_hour BETWEEN 0 AND 1 AND t_sub_shift = 'night' AND i_rec_end_date >= '1999-10-27' AND i_rec_end_date <= '2001-10-26' AND cs_sold_date_sk IN ('2450821', '2450823') GROUP BY d_year, i_brand, i_class, i_category ORDER BY total_revenue DESC;
SELECT p.p_promo_name AS promotion_name, COUNT(DISTINCT wr.wr_order_number) AS total_returns, SUM(wr.wr_return_quantity) AS total_returned_quantity, AVG(wr.wr_return_amt) AS average_return_amount, SUM(wr.wr_return_amt_inc_tax) - SUM(wr.wr_fee) AS net_loss_after_fees, COUNT(DISTINCT wp.wp_web_page_id) AS distinct_pages_involved, sm.sm_type AS ship_method_type, MAX(wr.wr_return_amt_inc_tax) AS max_return_amount_incl_tax, MIN(wr.wr_return_amt_inc_tax) AS min_return_amount_incl_tax, COUNT(DISTINCT CASE WHEN cd.cd_gender = 'M' THEN wr.wr_returning_customer_sk END) AS male_customers, COUNT(DISTINCT CASE WHEN cd.cd_gender = 'F' THEN wr.wr_returning_customer_sk END) AS female_customers FROM web_returns wr INNER JOIN promotion p ON wr.wr_reason_sk = p.p_promo_sk INNER JOIN web_page wp ON wr.wr_web_page_sk = wp.wp_web_page_sk INNER JOIN ship_mode sm ON CAST(SUBSTRING(wp.wp_url FROM 'http://www.%#"sm"#"%' FOR '#') AS INTEGER) = sm.sm_ship_mode_sk LEFT JOIN customer_demographics cd ON wr.wr_returning_cdemo_sk = cd.cd_demo_sk WHERE wr.wr_returned_date_sk BETWEEN p.p_start_date_sk AND p.p_end_date_sk AND wp.wp_url = 'http://www.foo.com' AND wp.wp_link_count IN (15, 11) AND wr.wr_return_tax = 52.13 GROUP BY p.p_promo_name, sm.sm_type ORDER BY total_returns DESC, net_loss_after_fees DESC;
SELECT d_year, d_moy, c.c_last_name, cd.cd_education_status, cd.cd_marital_status, COUNT(*) AS customer_count, SUM(cd.cd_purchase_estimate) AS total_purchase_estimate, AVG(cd.cd_dep_count) AS average_dependents, AVG(cd.cd_dep_employed_count) AS average_employed_dependents, AVG(cd.cd_dep_college_count) AS average_college_dependents FROM customer c JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk JOIN date_dim d ON c.c_first_sales_date_sk = d.d_date_sk WHERE c.c_first_sales_date_sk IN (2449879, 2452004, 2451328, 2452389, 2450342, 2449052) AND c.c_last_name IN ('Searcy', 'Joyner', 'Livingston', 'Wise', 'Webb', 'Branch') AND cd.cd_marital_status IN ('S', 'U', 'W', 'M') AND cd.cd_education_status = 'Advanced Degree' AND d.d_last_dom IN ('2417090', '2415990') GROUP BY d_year, d_moy, c.c_last_name, cd.cd_education_status, cd.cd_marital_status ORDER BY d_year DESC, d_moy DESC, c.c_last_name;
