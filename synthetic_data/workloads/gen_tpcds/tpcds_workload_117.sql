SELECT c.c_first_name, c.c_last_name, ca.ca_city, ca.ca_state, ca.ca_country, SUM(cs.cs_sales_price) AS total_sales, AVG(cs.cs_sales_price) AS average_sale_amount, COUNT(cs.cs_order_number) AS number_of_orders, SUM(cr.cr_return_amount) AS total_returns, AVG(cr.cr_return_amount) AS average_return_amount, COUNT(DISTINCT cr.cr_order_number) AS number_of_returns, SUM(cr.cr_net_loss) AS total_net_loss FROM customer c JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk JOIN catalog_sales cs ON c.c_customer_sk = cs.cs_bill_customer_sk LEFT JOIN catalog_returns cr ON cs.cs_order_number = cr.cr_order_number AND cs.cs_item_sk = cr.cr_item_sk WHERE ca.ca_country = 'United States' AND ca.ca_gmt_offset IN ('-10.00', '-6.00', '-5.00') AND cs.cs_ext_list_price > 0 GROUP BY c.c_first_name, c.c_last_name, ca.ca_city, ca.ca_state, ca.ca_country HAVING SUM(cs.cs_sales_price) > 0 ORDER BY total_sales DESC, total_returns DESC LIMIT 100;
SELECT i.i_category, i.i_class, i.i_brand, COUNT(DISTINCT cs.cs_order_number) AS total_orders, SUM(cs.cs_quantity) AS total_quantity_sold, AVG(cs.cs_sales_price) AS avg_sales_price, SUM(cs.cs_net_paid) AS total_net_paid, SUM(wr.wr_return_quantity) AS total_quantity_returned, SUM(wr.wr_return_amt) AS total_return_amt, AVG(wr.wr_fee) AS avg_return_fee, COUNT(DISTINCT c.c_customer_sk) AS total_customers, SUM(CASE WHEN c.c_preferred_cust_flag = 'Y' THEN cs.cs_net_paid ELSE 0 END) AS preferred_customer_sales, COUNT(DISTINCT CASE WHEN c.c_preferred_cust_flag = 'Y' THEN c.c_customer_sk ELSE NULL END) AS preferred_customer_count FROM item i JOIN catalog_sales cs ON i.i_item_sk = cs.cs_item_sk LEFT JOIN web_returns wr ON cs.cs_item_sk = wr.wr_item_sk AND cs.cs_order_number = wr.wr_order_number JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk GROUP BY i.i_category, i.i_class, i.i_brand ORDER BY total_net_paid DESC, total_return_amt DESC, avg_sales_price DESC LIMIT 100;
SELECT cc.cc_country, dd.d_year, sm.sm_type, COUNT(DISTINCT cc.cc_call_center_sk) AS num_call_centers, SUM(hd.hd_vehicle_count) AS total_vehicles, AVG(hd.hd_dep_count) AS avg_dep_count, COUNT(DISTINCT cp.cp_catalog_page_sk) AS num_catalog_pages FROM call_center cc JOIN date_dim dd ON cc.cc_open_date_sk = dd.d_date_sk JOIN household_demographics hd ON cc.cc_mkt_id = hd.hd_income_band_sk JOIN catalog_page cp ON cc.cc_division = cp.cp_catalog_number JOIN ship_mode sm ON cc.cc_company = sm.sm_carrier::integer WHERE cc.cc_country = 'United States' AND hd.hd_demo_sk IN ('2794', '432') AND hd.hd_income_band_sk IN ('7', '2', '11', '12') AND dd.d_current_year = 'N' AND cp.cp_catalog_page_id IN ('AAAAAAAACKOAAAAA', 'AAAAAAAAODAAAAAA', 'AAAAAAAAEBMAAAAA', 'AAAAAAAAGLCBAAAA') AND dd.d_same_day_lq = '2419796' GROUP BY cc.cc_country, dd.d_year, sm.sm_type ORDER BY dd.d_year, sm.sm_type;
SELECT s_state AS state, AVG(ws_sales_price) AS avg_web_sales_price, SUM(ws_quantity) AS total_web_sales_quantity, COUNT(DISTINCT s_store_sk) AS num_stores, COUNT(DISTINCT w_warehouse_sk) AS num_warehouses FROM web_sales JOIN store ON web_sales.ws_ship_addr_sk = store.s_store_sk JOIN warehouse ON web_sales.ws_warehouse_sk = warehouse.w_warehouse_sk GROUP BY state ORDER BY state;
SELECT ca.ca_city, ib.ib_income_band_sk, AVG(cs.cs_sales_price) AS avg_sales_price, AVG(cr.cr_return_amount) AS avg_return_amount, COUNT(DISTINCT cs.cs_order_number) AS total_sales_orders, COUNT(DISTINCT cr.cr_order_number) AS total_return_orders, SUM(cs.cs_quantity) AS total_quantity_sold, SUM(cr.cr_return_quantity) AS total_quantity_returned FROM catalog_sales cs JOIN customer_address ca ON cs.cs_ship_addr_sk = ca.ca_address_sk JOIN catalog_returns cr ON cr.cr_returning_addr_sk = ca.ca_address_sk JOIN income_band ib ON ca.ca_gmt_offset = ib.ib_income_band_sk WHERE ca.ca_city IN ('Shannon', 'Gilbert', 'Sheridan', 'Winslow') AND ib.ib_upper_bound IN (40000, 90000, 80000, 140000, 160000, 30000) GROUP BY ca.ca_city, ib.ib_income_band_sk ORDER BY ca.ca_city, ib.ib_income_band_sk;
SELECT cc.cc_country, cc.cc_open_date_sk, i.i_category, COUNT(cs.cs_order_number) AS total_orders, SUM(cs.cs_quantity) AS total_quantity_sold, AVG(cs.cs_sales_price) AS average_sales_price, SUM(cs.cs_net_paid) AS total_net_paid, SUM(cs.cs_net_paid_inc_tax) - SUM(cs.cs_net_paid) AS total_tax_collected, SUM(cs.cs_net_profit) AS total_net_profit, COUNT(DISTINCT wr.wr_order_number) AS total_returns, SUM(wr.wr_return_quantity) AS total_returned_quantity, AVG(wr.wr_return_amt) AS average_return_amount, SUM(wr.wr_net_loss) AS total_net_loss FROM call_center cc JOIN catalog_sales cs ON cc.cc_call_center_sk = cs.cs_call_center_sk JOIN item i ON cs.cs_item_sk = i.i_item_sk LEFT JOIN web_returns wr ON cs.cs_item_sk = wr.wr_item_sk AND cs.cs_order_number = wr.wr_order_number WHERE cc.cc_country = 'United States' AND cc.cc_open_date_sk IN ('2450952', '2450806', '2451063') GROUP BY ROLLUP(cc.cc_country, cc.cc_open_date_sk, i.i_category) ORDER BY cc.cc_country, cc.cc_open_date_sk, i.i_category;
SELECT w_state, w_city, p_promo_name, COUNT(DISTINCT wr_order_number) AS total_returns, SUM(wr_return_quantity) AS total_returned_quantity, AVG(wr_return_amt) AS avg_return_amount, SUM(wr_return_amt_inc_tax) AS total_return_amount_inc_tax, SUM(wr_fee) AS total_fees, SUM(wr_net_loss) AS total_net_loss FROM warehouse JOIN web_returns ON w_warehouse_sk = wr_returning_addr_sk JOIN promotion ON p_promo_sk = wr_web_page_sk WHERE w_street_name = 'Ash Laurel' AND p_channel_catalog = 'N' AND p_channel_press = 'N' AND wr_account_credit IN ('618.25', '63.54', '2191.76', '19.59', '469.21', '464.73') GROUP BY w_state, w_city, p_promo_name ORDER BY total_net_loss DESC, w_state, w_city;
SELECT i_category, i_class, COUNT(DISTINCT ss_ticket_number) AS total_sales_transactions, SUM(ss_sales_price) AS total_sales_revenue, AVG(ss_sales_price) AS avg_sales_price, SUM(cr_return_amount) AS total_return_revenue, AVG(cr_return_amount) AS avg_return_amount, SUM(sr_return_amt) AS total_store_return_revenue, AVG(sr_return_amt) AS avg_store_return_amount, (SUM(ss_sales_price) - SUM(cr_return_amount) - SUM(sr_return_amt)) AS net_revenue, SUM(inv_quantity_on_hand) AS total_inventory_quantity, COUNT(DISTINCT inv_warehouse_sk) AS num_warehouses_stocking FROM item LEFT JOIN store_sales ON store_sales.ss_item_sk = item.i_item_sk LEFT JOIN catalog_returns ON catalog_returns.cr_item_sk = item.i_item_sk LEFT JOIN store_returns ON store_returns.sr_item_sk = item.i_item_sk LEFT JOIN inventory ON inventory.inv_item_sk = item.i_item_sk WHERE i_manufact = 'oughtought' AND (inventory.inv_item_sk = 14212 OR inventory.inv_item_sk = 6826) AND inventory.inv_date_sk = 2450815 AND store_sales.ss_list_price = 145.48 GROUP BY i_category, i_class ORDER BY net_revenue DESC;
SELECT w.web_site_id AS website, COUNT(DISTINCT c.c_customer_sk) AS unique_customers, SUM(i.i_current_price) AS total_sales, AVG(i.i_wholesale_cost) AS avg_wholesale_cost, ca.ca_state AS state, ca.ca_country AS country, ca.ca_city AS city FROM web_site w JOIN customer c ON w.web_site_sk = c.c_first_sales_date_sk JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk JOIN item i ON w.web_site_sk = i.i_manufact_id WHERE ca.ca_zip IN ('67941', '33451', '79275', '59454') AND ca.ca_suite_number IN ('Suite 470', 'Suite 440', 'Suite H', 'Suite R', 'Suite L') AND w.web_rec_start_date <= CURRENT_DATE AND (w.web_rec_end_date IS NULL OR w.web_rec_end_date > CURRENT_DATE) GROUP BY w.web_site_id, ca.ca_state, ca.ca_country, ca.ca_city ORDER BY total_sales DESC;
SELECT cc.cc_call_center_id, cc.cc_name, cc.cc_class, SUM(ss.ss_quantity) AS total_quantity_sold, AVG(ss.ss_sales_price) AS average_sales_price, COUNT(DISTINCT c.c_customer_sk) AS unique_customers, COUNT(DISTINCT cp.cp_catalog_page_sk) AS catalog_pages_used, SUM(ss.ss_net_paid) AS total_net_paid, SUM(ss.ss_net_paid_inc_tax) AS total_net_paid_including_tax, SUM(ss.ss_net_profit) AS total_net_profit, AVG(t.t_hour) AS average_hour_of_sale FROM call_center cc JOIN store_sales ss ON cc.cc_call_center_sk = ss.ss_store_sk JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk JOIN catalog_page cp ON c.c_current_cdemo_sk = cp.cp_catalog_page_sk JOIN time_dim t ON ss.ss_sold_time_sk = t.t_time_sk WHERE (cc.cc_rec_start_date IS NULL OR cc.cc_rec_start_date <= CURRENT_DATE) AND (cc.cc_rec_end_date IS NULL OR cc.cc_rec_end_date >= CURRENT_DATE) AND t.t_second IN ('16', '11') AND ss.ss_hdemo_sk IN ('1989', '6188') AND c.c_current_hdemo_sk IN ('3971', '3131', '4808', '7162', '6897', '2935') AND cc.cc_call_center_sk = 5 GROUP BY cc.cc_call_center_id, cc.cc_name, cc.cc_class ORDER BY total_net_profit DESC, average_sales_price DESC;
SELECT c.c_first_name, c.c_last_name, ca.ca_state, w.w_warehouse_name, SUM(i.inv_quantity_on_hand) AS total_inventory, AVG(cc.cc_tax_percentage) AS average_tax_percentage, COUNT(DISTINCT cc.cc_call_center_sk) AS number_of_call_centers FROM customer c JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk JOIN inventory i ON ca.ca_address_sk = i.inv_warehouse_sk JOIN warehouse w ON i.inv_warehouse_sk = w.w_warehouse_sk JOIN call_center cc ON w.w_state = cc.cc_state WHERE ca.ca_state IN ('MA', 'FL') AND w.w_warehouse_id IN ('AAAAAAAADAAAAAAA', 'AAAAAAAAFAAAAAAA', 'AAAAAAAABAAAAAAA') AND cc.cc_tax_percentage IN (0.01, 0.05, 0.11, 0.12) GROUP BY c.c_first_name, c.c_last_name, ca.ca_state, w.w_warehouse_name ORDER BY total_inventory DESC, average_tax_percentage, number_of_call_centers DESC;
SELECT cc.cc_name, cc.cc_employees, cc.cc_tax_percentage, SUM(ss.ss_net_paid_inc_tax) AS total_net_sales, AVG(ss.ss_wholesale_cost) AS avg_wholesale_cost, COUNT(DISTINCT ss.ss_item_sk) AS items_sold_count FROM store_sales ss JOIN call_center cc ON ss.ss_store_sk = cc.cc_call_center_sk WHERE ss.ss_sold_date_sk BETWEEN cc.cc_open_date_sk AND COALESCE(cc.cc_closed_date_sk, (SELECT MAX(ss_sold_date_sk) FROM store_sales)) AND cc.cc_tax_percentage IN (0.01, 0.12, 0.05, 0.11) AND ss.ss_item_sk IN (14150, 11113, 2890) GROUP BY cc.cc_name, cc.cc_employees, cc.cc_tax_percentage ORDER BY total_net_sales DESC, avg_wholesale_cost DESC, items_sold_count DESC;
SELECT ib.ib_lower_bound, ib.ib_upper_bound, SUM(ss.ss_quantity) AS total_quantity_sold, AVG(ss.ss_sales_price) AS average_sales_price, COUNT(DISTINCT hd.hd_demo_sk) AS unique_households, COUNT(DISTINCT cc.cc_call_center_sk) AS total_call_centers, SUM(wh.w_warehouse_sq_ft) AS total_warehouse_sq_ft FROM store_sales ss JOIN household_demographics hd ON ss.ss_hdemo_sk = hd.hd_demo_sk JOIN income_band ib ON hd.hd_income_band_sk = ib.ib_income_band_sk JOIN call_center cc ON cc.cc_mkt_id = ss.ss_sold_date_sk JOIN warehouse wh ON wh.w_warehouse_sk = ss.ss_addr_sk WHERE hd.hd_buy_potential = '>10000' AND ib.ib_upper_bound < 150000 AND ss.ss_ext_list_price > 2100 AND cc.cc_gmt_offset = -5.00 AND cc.cc_mkt_desc LIKE 'Rich groups catch longer other fears; future,%' GROUP BY ib.ib_lower_bound, ib.ib_upper_bound;
SELECT dd.d_year, dd.d_quarter_name, cc.cc_class, SUM(ss.ss_quantity) AS total_quantity_sold, AVG(ss.ss_sales_price) AS average_sales_price, SUM(ss.ss_net_paid) AS total_net_paid, SUM(ss.ss_net_paid_inc_tax) AS total_net_paid_inc_tax, SUM(ss.ss_net_profit) AS total_net_profit, COUNT(DISTINCT ss.ss_store_sk) AS number_of_stores, COUNT(DISTINCT w.w_warehouse_sk) AS number_of_warehouses FROM store_sales ss JOIN date_dim dd ON ss.ss_sold_date_sk = dd.d_date_sk JOIN call_center cc ON ss.ss_store_sk = cc.cc_open_date_sk JOIN warehouse w ON ss.ss_store_sk = w.w_warehouse_sk WHERE dd.d_fy_year IN ('1904', '1902', '1903', '1912', '1901', '1907') AND ss.ss_store_sk IN ('8', '4', '7', '10', '1', '2') AND cc.cc_open_date_sk IN ('2451063', '2450952', '2450806') AND cc.cc_suite_number IN ('Suite 0', 'Suite 70', 'Suite U') AND w.w_warehouse_name IN ('Important issues liv', 'Bad cards must make.', 'Conventional childr', 'Doors canno') GROUP BY dd.d_year, dd.d_quarter_name, cc.cc_class ORDER BY dd.d_year, dd.d_quarter_name, cc.cc_class;
SELECT w.w_warehouse_name, AVG(i.inv_quantity_on_hand) AS avg_quantity_on_hand, SUM(ws.ws_net_paid_inc_tax) AS total_net_paid_including_tax, AVG(ws.ws_quantity) AS avg_quantity_sold, COUNT(DISTINCT s.s_store_sk) AS number_of_stores, COUNT(DISTINCT wp.wp_web_page_sk) AS number_of_web_pages, SUM(ws.ws_ext_sales_price) AS total_sales, SUM(ws.ws_ext_ship_cost) AS total_shipping_cost, AVG(ws.ws_net_profit) AS avg_net_profit FROM warehouse w JOIN inventory i ON w.w_warehouse_sk = i.inv_warehouse_sk JOIN web_sales ws ON w.w_warehouse_sk = ws.ws_warehouse_sk JOIN store s ON w.w_state = s.s_state JOIN web_page wp ON ws.ws_web_page_sk = wp.wp_web_page_sk WHERE i.inv_item_sk IN ('12967', '13462') AND ws.ws_net_paid_inc_ship_tax IN ('2903.39', '10322.19', '71.04') AND ws.ws_ship_cdemo_sk IN ('1497159', '165796', '556771', '542355') AND w.w_zip = '35709' AND w.w_street_type IN ('Avenue', 'Drive', 'Dr.') GROUP BY w.w_warehouse_name ORDER BY w.w_warehouse_name;
SELECT cp.cp_department, COUNT(DISTINCT cr.cr_order_number) AS total_returns, SUM(cr.cr_return_amt_inc_tax) AS total_return_amount_inc_tax, AVG(cr.cr_return_amt_inc_tax) AS avg_return_amount_inc_tax, SUM(cr.cr_return_quantity) AS total_return_quantity, AVG(cr.cr_return_quantity) AS avg_return_quantity, hd.hd_dep_count, hd.hd_vehicle_count FROM catalog_page cp JOIN catalog_returns cr ON cp.cp_catalog_page_sk = cr.cr_catalog_page_sk JOIN household_demographics hd ON cr.cr_returning_hdemo_sk = hd.hd_demo_sk WHERE cp.cp_catalog_page_sk IN (22, 117, 432, 303) AND cr.cr_return_quantity > 5 AND hd.hd_dep_count IN (3, 8) GROUP BY cp.cp_department, hd.hd_dep_count, hd.hd_vehicle_count ORDER BY total_return_amount_inc_tax DESC, total_returns DESC;
