SELECT dd.d_year, dd.d_quarter_name, AVG(cd.cd_purchase_estimate) as avg_purchase_estimate, SUM(cd.cd_dep_count) as total_dep_count, SUM(cd.cd_dep_employed_count) as total_dep_employed_count, SUM(cd.cd_dep_college_count) as total_dep_college_count, COUNT(DISTINCT dd.d_date_sk) as num_days, COUNT(DISTINCT td.t_time_sk) as num_time_entries FROM date_dim dd JOIN customer_demographics cd ON dd.d_year = cd.cd_purchase_estimate / 1000 JOIN time_dim td ON td.t_minute IN (6, 51) WHERE dd.d_current_quarter = 'N' AND dd.d_fy_year IN ('1913', '1912', '1903') GROUP BY dd.d_year, dd.d_quarter_name ORDER BY dd.d_year, dd.d_quarter_name;
SELECT p.p_promo_name, cs.cs_sold_date_sk, COUNT(DISTINCT cs.cs_order_number) AS total_orders, SUM(cs.cs_quantity) AS total_quantity_sold, SUM(cs.cs_net_paid) AS total_revenue, AVG(cs.cs_sales_price) AS average_sales_price, SUM(cr.cr_return_quantity) AS total_quantity_returned, SUM(cr.cr_return_amount) AS total_amount_returned, COUNT(DISTINCT wr.wr_order_number) AS total_web_returns, SUM(wr.wr_return_amt) AS total_web_return_amount, AVG(COALESCE(cd.cd_dep_count, 0)) AS average_customer_dependents, AVG(COALESCE(cd.cd_dep_employed_count, 0)) AS average_employed_dependents, AVG(COALESCE(cd.cd_dep_college_count, 0)) AS average_college_dependents FROM promotion p LEFT JOIN catalog_sales cs ON p.p_promo_sk = cs.cs_promo_sk LEFT JOIN catalog_returns cr ON cs.cs_order_number = cr.cr_order_number AND cs.cs_item_sk = cr.cr_item_sk LEFT JOIN web_returns wr ON cs.cs_order_number = wr.wr_order_number AND cs.cs_item_sk = wr.wr_item_sk LEFT JOIN customer_demographics cd ON cs.cs_bill_cdemo_sk = cd.cd_demo_sk WHERE p.p_discount_active = 'Y' AND cs.cs_sold_date_sk IS NOT NULL GROUP BY p.p_promo_name, cs.cs_sold_date_sk ORDER BY p.p_promo_name, cs.cs_sold_date_sk;
SELECT wp.wp_type AS web_page_type, i.i_brand AS item_brand, ca.ca_state AS customer_state, COUNT(DISTINCT ws.ws_order_number) AS total_orders, SUM(ws.ws_quantity) AS total_items_sold, SUM(ws.ws_sales_price) AS total_sales, AVG(i.i_wholesale_cost) AS average_wholesale_cost FROM web_sales ws JOIN web_page wp ON ws.ws_web_page_sk = wp.wp_web_page_sk JOIN item i ON ws.ws_item_sk = i.i_item_sk JOIN customer_address ca ON ws.ws_ship_addr_sk = ca.ca_address_sk WHERE wp.wp_autogen_flag = 'Y' AND wp.wp_type IN ('order', 'dynamic') AND i.i_brand IN ('brandunivamalg #10', 'scholarbrand #7', 'maxibrand #2') GROUP BY web_page_type, item_brand, customer_state ORDER BY total_sales DESC, total_orders DESC LIMIT 10;
SELECT d_year, d_moy, c.c_last_name, cd.cd_education_status, cd.cd_marital_status, COUNT(*) AS customer_count, SUM(cd.cd_purchase_estimate) AS total_purchase_estimate, AVG(cd.cd_dep_count) AS average_dependents, AVG(cd.cd_dep_employed_count) AS average_employed_dependents, AVG(cd.cd_dep_college_count) AS average_college_dependents FROM customer c JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk JOIN date_dim d ON c.c_first_sales_date_sk = d.d_date_sk WHERE c.c_first_sales_date_sk IN (2449879, 2452004, 2451328, 2452389, 2450342, 2449052) AND c.c_last_name IN ('Searcy', 'Joyner', 'Livingston', 'Wise', 'Webb', 'Branch') AND cd.cd_marital_status IN ('S', 'U', 'W', 'M') AND cd.cd_education_status = 'Advanced Degree' AND d.d_last_dom IN ('2417090', '2415990') GROUP BY d_year, d_moy, c.c_last_name, cd.cd_education_status, cd.cd_marital_status ORDER BY d_year DESC, d_moy DESC, c.c_last_name;
SELECT dd.d_year, dd.d_quarter_name, SUM(ws.ws_quantity) AS total_quantity_sold, AVG(ws.ws_sales_price) AS average_sales_price, COUNT(DISTINCT ws.ws_order_number) AS total_orders, SUM(ws.ws_net_paid) AS total_net_paid, SUM(ws.ws_net_profit) AS total_net_profit FROM web_sales ws JOIN date_dim dd ON ws.ws_sold_date_sk = dd.d_date_sk WHERE dd.d_year = 2022 GROUP BY dd.d_year, dd.d_quarter_name ORDER BY dd.d_year, dd.d_quarter_name;
SELECT w.web_name, w.web_manager, w.web_mkt_class, SUM(ws.ws_sales_price) AS total_sales, AVG(ws.ws_sales_price) AS avg_sales_price, COUNT(DISTINCT ws.ws_order_number) AS total_orders, SUM(ws.ws_quantity) AS total_quantity_sold, SUM(ws.ws_net_profit) AS total_net_profit FROM web_sales ws JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk JOIN time_dim t ON ws.ws_sold_time_sk = t.t_time_sk WHERE w.web_open_date_sk IN ('2450577', '2450594', '2450807', '2450679') AND t.t_am_pm = 'PM' GROUP BY w.web_name, w.web_manager, w.web_mkt_class ORDER BY total_sales DESC;
SELECT s.s_store_name, s.s_city, s.s_state, s_market_desc, AVG(s.s_number_employees) AS average_employees, AVG(s.s_floor_space) AS average_floor_space, COUNT(DISTINCT s.s_store_sk) AS total_stores, SUM(wp.wp_char_count) AS total_char_count, SUM(wp.wp_link_count) AS total_link_count, SUM(wp.wp_image_count) AS total_image_count, COUNT(DISTINCT wp.wp_web_page_sk) AS total_web_pages, AVG(ib.ib_upper_bound - ib.ib_lower_bound) AS average_income_band_range FROM store s JOIN web_page wp ON s.s_store_sk = wp.wp_customer_sk LEFT JOIN income_band ib ON s.s_market_id = ib.ib_income_band_sk WHERE s.s_rec_start_date <= CURRENT_DATE AND (s.s_rec_end_date IS NULL OR s.s_rec_end_date > CURRENT_DATE) AND (wp.wp_web_page_sk = 33 OR wp.wp_web_page_sk = 6) GROUP BY s.s_store_name, s.s_city, s.s_state, s_market_desc ORDER BY s.s_state, s.s_city, s.s_store_name;
SELECT ca.ca_state, SUM(ss.ss_quantity) AS total_quantity_sold, AVG(ss.ss_sales_price) AS avg_sales_price, SUM(ss.ss_net_paid) AS total_net_paid, SUM(ss.ss_net_profit) AS total_net_profit, COUNT(DISTINCT ss.ss_ticket_number) AS total_sales_transactions, SUM(CASE WHEN p.p_channel_event = 'N' THEN ss.ss_quantity ELSE 0 END) AS quantity_sold_no_event_channel, SUM(CASE WHEN p.p_channel_email = 'N' THEN ss.ss_quantity ELSE 0 END) AS quantity_sold_no_email_channel, COUNT(DISTINCT i.inv_warehouse_sk) AS distinct_warehouses_stocked, AVG(i.inv_quantity_on_hand) AS avg_quantity_on_hand FROM store_sales ss JOIN customer_address ca ON ss.ss_addr_sk = ca.ca_address_sk LEFT JOIN promotion p ON ss.ss_promo_sk = p.p_promo_sk LEFT JOIN inventory i ON ss.ss_item_sk = i.inv_item_sk WHERE i.inv_warehouse_sk IN (1, 2) AND i.inv_date_sk = 2450815 GROUP BY ca.ca_state ORDER BY total_net_profit DESC, ca.ca_state;
SELECT ca_state, ca_country, COUNT(DISTINCT ca_address_sk) AS num_addresses, SUM(p_cost) AS total_promotion_cost, AVG(p_cost) AS avg_promotion_cost, COUNT(DISTINCT p_promo_sk) AS num_promotions, COUNT(DISTINCT web_site_sk) AS num_websites, SUM(web_tax_percentage) AS total_tax_percentage, AVG(web_tax_percentage) AS avg_tax_percentage FROM customer_address JOIN promotion ON ca_address_sk = p_item_sk JOIN web_site ON ca_address_sk = web_mkt_id WHERE ca_state IN ('DE', 'NH', 'MI', 'MA', 'ID', 'NY') AND ca_country = 'United States' AND p_discount_active = '1' AND web_rec_start_date <= CURRENT_DATE AND (web_rec_end_date IS NULL OR web_rec_end_date >= CURRENT_DATE) GROUP BY ca_state, ca_country ORDER BY ca_state, ca_country;
SELECT dd.d_year, dd.d_quarter_name, wa.w_country, ca.ca_state, COUNT(DISTINCT ws.ws_order_number) AS total_orders, SUM(ws.ws_quantity) AS total_quantity_sold, AVG(ws.ws_sales_price) AS average_sales_price, SUM(ws.ws_net_paid) AS total_net_paid, SUM(ws.ws_net_profit) AS total_net_profit, AVG(cd.cd_purchase_estimate) AS avg_customer_purchase_estimate, SUM(CASE WHEN pr.p_channel_email = '1' THEN ws.ws_quantity ELSE 0 END) as total_quantity_sold_via_email, SUM(CASE WHEN pr.p_channel_tv = '1' THEN ws.ws_quantity ELSE 0 END) as total_quantity_sold_via_tv FROM web_sales ws JOIN date_dim dd ON ws.ws_sold_date_sk = dd.d_date_sk JOIN customer_address ca ON ws.ws_bill_addr_sk = ca.ca_address_sk JOIN customer_demographics cd ON ws.ws_bill_cdemo_sk = cd.cd_demo_sk JOIN warehouse wa ON ws.ws_warehouse_sk = wa.w_warehouse_sk JOIN promotion pr ON ws.ws_promo_sk = pr.p_promo_sk WHERE dd.d_quarter_seq IN (25, 41) AND wa.w_country = 'United States' AND wa.w_street_name IN ('Ash Laurel', '6th', 'Wilson Elm', 'View First') AND cd.cd_purchase_estimate BETWEEN 1000 AND 5500 GROUP BY ROLLUP(dd.d_year, dd.d_quarter_name, wa.w_country, ca.ca_state) ORDER BY dd.d_year, dd.d_quarter_name, wa.w_country, ca.ca_state;
SELECT c.c_customer_id, c.c_first_name, c.c_last_name, cd.cd_gender, cd.cd_marital_status, cd.cd_education_status, SUM(cr.cr_return_quantity) AS total_catalog_return_quantity, AVG(cr.cr_return_amount) AS avg_catalog_return_amount, COUNT(DISTINCT cr.cr_order_number) AS num_catalog_orders_returned, SUM(sr.sr_return_quantity) AS total_store_return_quantity, AVG(sr.sr_return_amt) AS avg_store_return_amount, COUNT(DISTINCT sr.sr_ticket_number) AS num_store_tickets_returned, (SUM(cr.cr_return_quantity) + SUM(sr.sr_return_quantity)) AS total_combined_return_quantity, (SUM(cr.cr_return_amount) + SUM(sr.sr_return_amt)) AS total_combined_return_amount FROM customer c JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk LEFT JOIN catalog_returns cr ON c.c_customer_sk = cr.cr_refunded_customer_sk LEFT JOIN store_returns sr ON c.c_customer_sk = sr.sr_customer_sk WHERE cd.cd_dep_college_count = 0 AND (cd.cd_dep_count = 1 OR cd.cd_dep_count = 2) AND (c.c_birth_month IN (1, 5, 8)) AND (cr.cr_refunded_cdemo_sk IN (720990, 944590, 673975, 63720) OR cr.cr_refunded_cdemo_sk IS NULL) AND (sr.sr_ticket_number::text IN ('40123', '36273') OR sr.sr_ticket_number IS NULL) GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, cd.cd_gender, cd.cd_marital_status, cd.cd_education_status ORDER BY total_combined_return_amount DESC, c.c_customer_id;
SELECT cc_state, COUNT(cc_call_center_sk) AS total_call_centers, AVG(cc_employees) AS avg_employees, SUM(cc_sq_ft) AS total_sq_ft, COUNT(DISTINCT p_promo_sk) AS total_promotions, AVG(p_cost) AS avg_promotion_cost, AVG(hd_income_band_sk) AS avg_income_band, AVG(hd_vehicle_count) AS avg_vehicle_count, AVG(cc_tax_percentage) AS avg_tax_percentage, SUM(CASE WHEN p_channel_email = '1' THEN 1 ELSE 0 END) AS total_email_promotions, SUM(CASE WHEN p_channel_tv = '1' THEN 1 ELSE 0 END) AS total_tv_promotions, SUM(CASE WHEN p_channel_radio = '1' THEN 1 ELSE 0 END) AS total_radio_promotions FROM call_center LEFT JOIN promotion ON cc_mkt_id = p_promo_sk LEFT JOIN customer_address ON cc_county = ca_county LEFT JOIN household_demographics ON ca_address_sk = hd_demo_sk WHERE cc_rec_start_date <= CURRENT_DATE AND (cc_rec_end_date IS NULL OR cc_rec_end_date > CURRENT_DATE) AND ca_county IN ('Cowlitz County', 'Bay County', 'Loudon County', 'Santa Rosa County', 'Lebanon County') GROUP BY cc_state ORDER BY total_call_centers DESC;
SELECT i.i_category AS item_category, AVG(i.i_current_price) AS avg_current_price, COUNT(i.i_item_sk) AS total_item_count, AVG(i.i_wholesale_cost) AS avg_wholesale_cost, AVG(cd.cd_purchase_estimate) FILTER (WHERE cd.cd_credit_rating = 'Good') AS avg_good_credit_purchase_estimate, AVG(cd.cd_purchase_estimate) FILTER (WHERE cd.cd_credit_rating = 'High Risk') AS avg_high_risk_credit_purchase_estimate, AVG(cd.cd_purchase_estimate) FILTER (WHERE cd.cd_credit_rating = 'Low Risk') AS avg_low_risk_credit_purchase_estimate FROM item i JOIN promotion p ON i.i_item_sk = p.p_item_sk JOIN customer c ON p.p_start_date_sk <= c.c_first_sales_date_sk AND p.p_end_date_sk >= c.c_first_sales_date_sk JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk WHERE i.i_category IN ('Home', 'Electronics', 'Sports') AND c.c_first_sales_date_sk = '2452263' AND p.p_discount_active = '1' GROUP BY i.i_category ORDER BY avg_current_price DESC;
SELECT p.p_promo_name, p.p_purpose, COUNT(DISTINCT ss.ss_ticket_number) AS num_sales, SUM(ss.ss_quantity) AS total_quantity_sold, AVG(ss.ss_sales_price) AS avg_sale_price, SUM(ss.ss_net_profit) AS total_net_profit, COUNT(DISTINCT sr.sr_ticket_number) AS num_returns, SUM(sr.sr_return_quantity) AS total_quantity_returned, AVG(sr.sr_return_amt) AS avg_return_amount, SUM(sr.sr_net_loss) AS total_net_loss, (SUM(ss.ss_net_profit) - SUM(sr.sr_net_loss)) AS net_effect_of_promotions FROM promotion p LEFT JOIN store_sales ss ON p.p_promo_sk = ss.ss_promo_sk LEFT JOIN store_returns sr ON ss.ss_ticket_number = sr.sr_ticket_number WHERE p.p_cost::decimal > 500.00 AND p.p_purpose <> 'Unknown' AND ss.ss_sold_date_sk IS NOT NULL AND sr.sr_returned_date_sk IS NOT NULL GROUP BY p.p_promo_name, p.p_purpose ORDER BY net_effect_of_promotions DESC;
SELECT cp.cp_department, COUNT(DISTINCT cr.cr_order_number) AS total_returns, SUM(cr.cr_return_amount) AS total_return_amount, AVG(cr.cr_return_amount) AS avg_return_amount, SUM(cr.cr_return_quantity) AS total_return_quantity, AVG(cr.cr_fee) AS avg_fee, i.i_category, i.i_class, COUNT(DISTINCT c.c_customer_sk) AS total_customers, AVG(hd.hd_vehicle_count) AS avg_vehicle_count, SUM(wr.wr_account_credit) AS total_account_credit FROM catalog_page cp JOIN catalog_returns cr ON cp.cp_catalog_page_sk = cr.cr_catalog_page_sk JOIN item i ON cr.cr_item_sk = i.i_item_sk JOIN customer c ON cr.cr_returning_customer_sk = c.c_customer_sk JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk JOIN web_returns wr ON i.i_item_sk = wr.wr_item_sk AND cr.cr_order_number = wr.wr_order_number WHERE i.i_formulation IN ('83313678042thistle61', '41681222olive4963389', '57585sienna024168653') AND i.i_product_name IN ('oughtbarn stpri', 'oughteingeingable', 'barcallycally', 'antieseantiable', 'antiprioughtable', 'priationpri') AND wr.wr_account_credit IN ('8.73', '59.44', '133.59') AND hd.hd_vehicle_count IN ('4', '2', '0', '1') AND c.c_email_address = 'Andrew.Lowery@T7T4.com' GROUP BY cp.cp_department, i.i_category, i.i_class ORDER BY total_return_amount DESC, avg_vehicle_count DESC, total_account_credit DESC;
SELECT cc.cc_name AS call_center_name, cc.cc_city AS call_center_city, cc.cc_state AS call_center_state, hd.hd_income_band_sk AS income_band, COUNT(DISTINCT sr.sr_ticket_number) AS total_returns, SUM(sr.sr_return_quantity) AS total_returned_items, AVG(sr.sr_return_amt) AS average_return_amount, SUM(sr.sr_return_amt_inc_tax) AS total_return_amount_including_tax, SUM(sr.sr_net_loss) AS total_net_loss FROM call_center cc JOIN store_returns sr ON cc.cc_call_center_sk = sr.sr_store_sk JOIN household_demographics hd ON sr.sr_hdemo_sk = hd.hd_demo_sk JOIN warehouse w ON cc.cc_state = w.w_state WHERE w.w_county = 'Williamson County' AND hd.hd_demo_sk = 1887 AND cc.cc_rec_start_date <= CURRENT_DATE AND (cc.cc_rec_end_date IS NULL OR cc.cc_rec_end_date > CURRENT_DATE) GROUP BY call_center_name, call_center_city, call_center_state, income_band ORDER BY total_returns DESC, total_returned_items DESC;
SELECT dd.d_year, dd.d_quarter_name, SUM(ss.ss_quantity) AS total_quantity_sold, AVG(ss.ss_sales_price) AS average_sales_price, COUNT(DISTINCT c.c_customer_sk) AS unique_customers, COUNT(DISTINCT cc.cc_call_center_sk) AS participating_call_centers, SUM(ss.ss_net_paid_inc_tax) AS total_revenue_including_tax, SUM(ss.ss_net_profit) AS total_net_profit FROM store_sales ss JOIN date_dim dd ON ss.ss_sold_date_sk = dd.d_date_sk JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk JOIN call_center cc ON cc.cc_mkt_id::integer = ss.ss_store_sk JOIN catalog_page cp ON ss.ss_sold_date_sk BETWEEN cp.cp_start_date_sk AND cp.cp_end_date_sk JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk WHERE dd.d_year = 2001 AND cc.cc_class = 'small' AND cd.cd_credit_rating = 'Good' AND (cp.cp_type = 'monthly' OR cp.cp_type = 'bi-annual') AND (cc.cc_street_type = 'Way' OR cc.cc_street_type = 'RD' OR cc.cc_street_type = 'Boulevard') AND c.c_last_review_date_sk IN ('2452332', '2452464', '2452647', '2452396', '2452311') AND cd.cd_demo_sk IN ('20368', '16978', '19750', '17504') GROUP BY dd.d_year, dd.d_quarter_name ORDER BY dd.d_year, dd.d_quarter_name;
SELECT age_group, hd_buy_potential, AVG(ss_net_paid) AS avg_sales, SUM(ss_quantity) AS total_quantity_sold, COUNT(DISTINCT ss_customer_sk) AS unique_customers FROM customer c JOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk CROSS JOIN (SELECT CASE WHEN c_birth_year BETWEEN 1946 AND 1964 THEN 'Baby Boomers' WHEN c_birth_year BETWEEN 1965 AND 1980 THEN 'Generation X' WHEN c_birth_year BETWEEN 1981 AND 1996 THEN 'Millennials' WHEN c_birth_year >= 1997 THEN 'Generation Z' ELSE 'Unknown' END AS age_group, c_customer_sk FROM customer) AS cust_age_group WHERE cust_age_group.c_customer_sk = c.c_customer_sk GROUP BY age_group, hd_buy_potential ORDER BY age_group, hd_buy_potential;
SELECT c.c_customer_id, c.c_first_name, c.c_last_name, sum(cs.cs_quantity) AS total_quantity_sold, avg(cs.cs_sales_price) AS average_sales_price, sum(cs.cs_net_paid) AS total_net_paid, sum(cs.cs_net_profit) AS total_net_profit, sum(inv.inv_quantity_on_hand) AS total_inventory_quantity, avg(ws.web_tax_percentage) AS average_web_tax_percentage, count(DISTINCT wp.wp_web_page_sk) AS total_web_page_visits, count(DISTINCT wr.wr_order_number) AS total_web_returns, sum(wr.wr_return_amt) AS total_return_amount FROM customer c JOIN catalog_sales cs ON c.c_customer_sk = cs.cs_bill_customer_sk JOIN inventory inv ON cs.cs_item_sk = inv.inv_item_sk JOIN web_site ws ON ws.web_company_id = c.c_current_addr_sk LEFT JOIN web_page wp ON ws.web_site_sk = wp.wp_customer_sk LEFT JOIN web_returns wr ON cs.cs_item_sk = wr.wr_item_sk AND cs.cs_order_number = wr.wr_order_number WHERE inv.inv_item_sk IN ('11134', '7144', '14296') AND inv.inv_warehouse_sk IN ('2', '1') AND cs.cs_catalog_page_sk IN ('2864', '4326', '4631') AND wp.wp_max_ad_count IN ('1', '0', '4') AND ws.web_tax_percentage IN ('0.07', '0.08', '0.01') AND ws.web_mkt_class IN ('Hands look again nice years. Alre', 'Only, temporary services', 'Severe, useful funds lift; just') AND ws.web_suite_number IN ('Suite 30', 'Suite J', 'Suite 460') AND ws.web_manager IN ('Robert Arnold', 'Harold Wilson', 'Jason Silva') AND c.c_customer_sk IN ('3151', '72', '3821') AND c.c_birth_day IN ('20', '2', '10') GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name ORDER BY total_net_profit DESC, total_quantity_sold DESC LIMIT 100;
SELECT r.r_reason_desc, COUNT(*) AS total_returns, SUM(sr_return_amt) AS total_return_amount, AVG(sr_return_amt) AS average_return_amount, SUM(sr_return_quantity) AS total_returned_quantity, SUM(sr_fee) AS total_return_fees, SUM(sr_net_loss) AS total_net_loss FROM store_returns sr JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk WHERE sr.sr_return_amt > 0 AND r.r_reason_desc IN ('reason 26', 'reason 34', 'Did not fit', 'Not the product that was ordred') GROUP BY r.r_reason_desc ORDER BY total_return_amount DESC;
SELECT cp_department, i_category, i_class, COUNT(DISTINCT i_item_sk) AS item_count, SUM(i_current_price) AS total_price, AVG(i_current_price) AS average_price, AVG(i_wholesale_cost) AS average_cost, SUM(i_wholesale_cost) AS total_cost, sm_type, COUNT(DISTINCT sm_ship_mode_sk) AS ship_mode_count FROM catalog_page JOIN item ON (cp_catalog_page_sk = i_item_sk) JOIN ship_mode ON (i_item_sk = sm_ship_mode_sk) WHERE cp_catalog_page_sk IN (2547, 2038, 1714) GROUP BY cp_department, i_category, i_class, sm_type ORDER BY cp_department, i_category, i_class;
SELECT r.r_reason_desc AS reason_for_return, COUNT(*) AS total_returns, AVG(cr.cr_return_amount) AS avg_return_amount, SUM(cr.cr_return_amount) AS total_return_amount, cd.cd_gender AS customer_gender, cd.cd_education_status AS customer_education, w.w_warehouse_name AS warehouse_name, w.w_city AS warehouse_city, w.w_state AS warehouse_state FROM catalog_returns cr JOIN reason r ON cr.cr_reason_sk = r.r_reason_sk JOIN customer_demographics cd ON cr.cr_returning_cdemo_sk = cd.cd_demo_sk JOIN warehouse w ON cr.cr_warehouse_sk = w.w_warehouse_sk GROUP BY r.r_reason_desc, cd.cd_gender, cd.cd_education_status, w.w_warehouse_name, w.w_city, w.w_state ORDER BY total_returns DESC, total_return_amount DESC LIMIT 100;
SELECT cp.cp_department, COUNT(DISTINCT cs.cs_item_sk) AS distinct_items_sold, SUM(cs.cs_quantity) AS total_quantity_sold, SUM(cs.cs_ext_sales_price) AS total_sales, AVG(cs.cs_sales_price) AS average_sales_price, SUM(cs.cs_ext_discount_amt) AS total_discount_amount FROM catalog_sales cs JOIN catalog_page cp ON cs.cs_catalog_page_sk = cp.cp_catalog_page_sk WHERE cs.cs_sold_date_sk BETWEEN cp.cp_start_date_sk AND cp.cp_end_date_sk GROUP BY cp.cp_department ORDER BY total_sales DESC;
SELECT td.t_shift, cd.cd_gender, cd.cd_marital_status, cd.cd_education_status, ib.ib_upper_bound, SUM(ws.ws_quantity) AS total_quantity_sold, AVG(ws.ws_sales_price) AS average_sales_price, COUNT(DISTINCT ws.ws_order_number) AS count_orders, SUM(wr.wr_return_quantity) AS total_quantity_returned, AVG(wr.wr_return_amt) AS average_return_amount, COUNT(DISTINCT wr.wr_order_number) AS count_returns FROM web_sales ws INNER JOIN time_dim td ON ws.ws_sold_time_sk = td.t_time_sk INNER JOIN customer_demographics cd ON ws.ws_bill_cdemo_sk = cd.cd_demo_sk INNER JOIN income_band ib ON cd.cd_purchase_estimate BETWEEN ib.ib_lower_bound AND ib.ib_upper_bound LEFT JOIN web_returns wr ON ws.ws_order_number = wr.wr_order_number AND ws.ws_item_sk = wr.wr_item_sk WHERE td.t_shift = 'third' AND td.t_sub_shift = 'night' AND (ib.ib_upper_bound = 10000 OR ib.ib_upper_bound = 20000 OR ib.ib_upper_bound = 130000) GROUP BY td.t_shift, cd.cd_gender, cd.cd_marital_status, cd.cd_education_status, ib.ib_upper_bound ORDER BY total_quantity_sold DESC, average_sales_price DESC;
SELECT s_store_name, s_state, COUNT(sr_ticket_number) AS total_returns, SUM(sr_return_amt) AS total_return_amount, AVG(sr_return_quantity) AS average_return_quantity, SUM(ws_net_paid_inc_tax) AS total_sales_inc_tax, AVG(ws_list_price) AS average_list_price, AVG(ws_net_profit) AS average_net_profit FROM store s JOIN store_returns sr ON s.s_store_sk = sr.sr_store_sk JOIN web_sales ws ON sr.sr_item_sk = ws.ws_item_sk JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk WHERE c.c_email_address IN ( 'Adam.Chambers@1fmL5RoSch74.edu', 'William.Kaye@Mx1n74bCJjkc08.edu', 'Imogene.Lewis@813MelxMLZ9gy.com', 'Dorothy.Garza@6Tn1dJ431OQYNTb.org', 'Ora.Spain@CT.edu', 'Denise.Gomez@3GlO.edu' ) AND ws.ws_net_paid_inc_tax IN (15407.14, 2937.00, 988.50, 3439.64, 992.77) AND ws.ws_list_price IN (177.80, 201.11) AND hd.hd_income_band_sk IN (16, 7) AND sr.sr_return_tax IN (215.85, 29.41, 35.05, 67.89) GROUP BY s_store_name, s_state ORDER BY total_return_amount DESC;
SELECT sm.sm_type AS shipping_mode_type, sm.sm_carrier AS carrier, cp.cp_department AS catalog_department, COUNT(DISTINCT wr.wr_order_number) AS number_of_returns, SUM(wr.wr_return_quantity) AS total_returned_quantity, AVG(wr.wr_return_amt) AS average_return_amount, SUM(wr.wr_return_tax) AS total_tax, SUM(wr.wr_return_ship_cost) AS total_shipping_cost, SUM(wr.wr_net_loss) AS total_net_loss FROM web_returns wr JOIN ship_mode sm ON wr.wr_returned_date_sk = sm.sm_ship_mode_sk JOIN catalog_page cp ON wr.wr_web_page_sk = cp.cp_catalog_page_sk WHERE wr.wr_returned_date_sk = 2451368 AND cp.cp_catalog_page_sk IN ('859', '3510', '105', '4419') GROUP BY shipping_mode_type, carrier, catalog_department ORDER BY total_net_loss DESC;
SELECT dd.d_year, dd.d_quarter_name, ca.ca_state, COUNT(DISTINCT ws.ws_order_number) AS total_orders, SUM(ws.ws_quantity) AS total_quantity, SUM(ws.ws_net_paid) AS total_net_paid, AVG(ws.ws_sales_price) AS average_sales_price, SUM(ws.ws_net_profit) AS total_net_profit FROM web_sales ws JOIN date_dim dd ON ws.ws_sold_date_sk = dd.d_date_sk JOIN customer_address ca ON ws.ws_bill_addr_sk = ca.ca_address_sk WHERE dd.d_year = 2002 AND ca.ca_country = 'United States' AND ws.ws_net_paid_inc_ship_tax > 1000 GROUP BY dd.d_year, dd.d_quarter_name, ca.ca_state ORDER BY dd.d_year, dd.d_quarter_name, ca.ca_state;
SELECT cc.cc_name, ws.web_name, i.i_category, SUM(cs.cs_quantity) AS total_quantity_sold, AVG(cs.cs_sales_price) AS avg_sales_price, COUNT(DISTINCT cs.cs_bill_customer_sk) AS unique_customers, SUM(wr.wr_return_quantity) AS total_quantity_returned, SUM(wr.wr_net_loss) AS total_net_loss FROM catalog_sales cs JOIN call_center cc ON cs.cs_call_center_sk = cc.cc_call_center_sk JOIN web_site ws ON cc.cc_mkt_id = ws.web_mkt_id JOIN item i ON cs.cs_item_sk = i.i_item_sk LEFT JOIN web_returns wr ON wr.wr_item_sk = i.i_item_sk AND wr.wr_order_number = cs.cs_order_number JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk WHERE cc.cc_class = 'small' AND ws.web_site_sk IN (25, 3) AND d.d_date BETWEEN '2022-01-01' AND '2022-12-31' AND (wr.wr_reason_sk IS NULL OR wr.wr_reason_sk IN (34, 25)) GROUP BY cc.cc_name, ws.web_name, i.i_category ORDER BY total_quantity_sold DESC, total_net_loss ASC;
SELECT cc.cc_call_center_id, cc.cc_name, cc.cc_city, cc.cc_state, SUM(ss.ss_net_paid) AS total_sales, AVG(ss.ss_ext_discount_amt) AS avg_discount_amount, COUNT(DISTINCT ss.ss_ticket_number) AS total_tickets, COUNT(DISTINCT p.p_promo_sk) AS total_promotions FROM call_center cc JOIN store_sales ss ON cc.cc_call_center_sk = ss.ss_store_sk JOIN promotion p ON ss.ss_promo_sk = p.p_promo_sk WHERE p.p_channel_dmail = 'Y' AND ss.ss_sold_date_sk BETWEEN p.p_start_date_sk AND p.p_end_date_sk GROUP BY cc.cc_call_center_id, cc.cc_name, cc.cc_city, cc.cc_state ORDER BY total_sales DESC, avg_discount_amount DESC;
SELECT sm_type, AVG(ws_quantity) AS avg_quantity, AVG(ws_sales_price) AS avg_sales_price, SUM(ws_ext_sales_price) AS total_sales, COUNT(DISTINCT ws_bill_customer_sk) AS unique_customers, COUNT(DISTINCT ws_ship_customer_sk) AS unique_ship_to_customers, AVG(cd_purchase_estimate) AS avg_purchase_estimate, SUM(cd_dep_count) AS total_dependents, AVG(hd_income_band_sk) AS avg_income_band, SUM(hd_vehicle_count) AS total_vehicles FROM web_sales JOIN ship_mode ON ws_ship_mode_sk = sm_ship_mode_sk JOIN customer_demographics ON ws_bill_cdemo_sk = cd_demo_sk JOIN household_demographics ON ws_bill_hdemo_sk = hd_demo_sk JOIN customer ON ws_bill_customer_sk = c_customer_sk WHERE ws_sales_price BETWEEN 100.00 AND 200.00 AND cd_credit_rating = 'Good' AND hd_buy_potential = '5001-10000' AND c_current_addr_sk IN ('45401', '18617', '42292', '26887', '5997') GROUP BY sm_type;
