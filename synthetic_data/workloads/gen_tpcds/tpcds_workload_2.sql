SELECT d_year, ca_state, p_channel_email, p_channel_dmail, p_channel_tv, AVG(p_cost) AS avg_promo_cost, SUM(CASE WHEN p_channel_email = '1' THEN p_cost ELSE 0 END) AS total_email_promo_cost, SUM(CASE WHEN p_channel_dmail = '1' THEN p_cost ELSE 0 END) AS total_dmail_promo_cost, SUM(CASE WHEN p_channel_tv = '1' THEN p_cost ELSE 0 END) AS total_tv_promo_cost, COUNT(*) AS total_promotions, COUNT(DISTINCT p_promo_id) AS distinct_promotions FROM promotion p JOIN date_dim d ON p.p_start_date_sk = d.d_date_sk OR p.p_end_date_sk = d.d_date_sk JOIN customer_address ca ON ca.ca_state = 'CA' WHERE d.d_year = 2001 AND d.d_quarter_seq = 39 AND (d.d_dow = 1 OR d.d_dow = 0) AND p.p_discount_active = '1' GROUP BY d_year, ca_state, p_channel_email, p_channel_dmail, p_channel_tv ORDER BY d_year, ca_state, p_channel_email, p_channel_dmail, p_channel_tv;
SELECT cp.cp_department, COUNT(DISTINCT cp.cp_catalog_page_sk) AS num_catalog_pages, COUNT(DISTINCT sm.sm_ship_mode_sk) AS num_ship_modes, AVG(hd.hd_vehicle_count) AS avg_vehicle_count, SUM(CASE WHEN p.p_channel_event = 'N' THEN p.p_cost ELSE 0 END) AS total_promo_cost_no_event, COUNT(DISTINCT r.r_reason_sk) AS num_reasons, MAX(t.t_time) AS max_time FROM catalog_page cp JOIN promotion p ON cp.cp_catalog_page_sk = p.p_item_sk LEFT JOIN ship_mode sm ON sm.sm_code = cp.cp_type LEFT JOIN reason r ON r.r_reason_desc = cp.cp_description LEFT JOIN household_demographics hd ON hd.hd_income_band_sk = cp.cp_catalog_number LEFT JOIN time_dim t ON t.t_time_sk = cp.cp_start_date_sk WHERE cp.cp_end_date_sk IN (2451817, 2450905, 2450904) AND cp.cp_department = 'DEPARTMENT' AND p.p_promo_sk IN (205, 11, 114) AND p.p_cost >= 1000.00 AND p.p_purpose = 'Unknown' AND p.p_channel_event = 'N' AND r.r_reason_desc IN ('Wrong size', 'duplicate purchase', 'reason 31') AND r.r_reason_sk IN (19, 14, 6) AND r.r_reason_id IN ('AAAAAAAAHBAAAAAA', 'AAAAAAAAPBAAAAAA', 'AAAAAAAAMAAAAAAA') AND hd.hd_vehicle_count IN (1, 4, 3) AND hd.hd_dep_count IN (0, 3, 7) AND t.t_time IN (325, 4624, 1921) AND t.t_time_id IN ('AAAAAAAANDCBAAAA', 'AAAAAAAAILGAAAAA', 'AAAAAAAAACNAAAAA') AND sm.sm_code IN ('SEA', 'AIR', 'BIKE') AND sm.sm_contract IN ('P7FBIt8yd', 'O9V6oF8RJnLMmZYd1', 'Ek') AND sm.sm_ship_mode_id IN ('AAAAAAAADBAAAAAA', 'AAAAAAAAIAAAAAAA', 'AAAAAAAAEAAAAAAA') GROUP BY cp.cp_department ORDER BY num_catalog_pages DESC, total_promo_cost_no_event DESC;
SELECT ca.ca_state AS customer_state, ib.ib_income_band_sk AS income_band, COUNT(DISTINCT c.c_customer_sk) AS num_customers, AVG(cs.cs_sales_price) AS avg_sales_price, SUM(cs.cs_net_profit) AS total_profit FROM catalog_sales cs JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk JOIN income_band ib ON c.c_current_hdemo_sk = ib.ib_income_band_sk JOIN promotion p ON cs.cs_promo_sk = p.p_promo_sk WHERE ib.ib_income_band_sk IN (19, 16) AND ca.ca_state IS NOT NULL AND p.p_discount_active = '1' AND cs.cs_sales_price IS NOT NULL GROUP BY ca.ca_state, ib.ib_income_band_sk ORDER BY total_profit DESC, avg_sales_price DESC, num_customers DESC;
SELECT s_store_name AS store_name, s_state AS store_state, CONCAT(s_city, ', ', s_state) AS store_location, d_year AS sales_year, d_quarter_name AS sales_quarter, SUM(ss_quantity) AS total_quantity_sold, SUM(ss_net_paid) AS total_sales, AVG(ss_net_paid) AS average_sales_per_transaction, SUM(ss_net_paid_inc_tax) AS total_sales_including_tax, SUM(ss_ext_tax) AS total_tax_collected, COUNT(DISTINCT ss_customer_sk) AS unique_customers, COUNT(DISTINCT ss_ticket_number) AS total_transactions, SUM(wr_return_amt) AS total_returns, SUM(wr_fee) AS total_return_fees, AVG(wr_return_ship_cost) AS average_return_shipping_cost, COUNT(DISTINCT wr_refunded_customer_sk) AS unique_customers_returned, COUNT(DISTINCT wr_order_number) AS total_return_transactions, SUM(wr_net_loss) AS total_net_loss_from_returns, r_reason_desc AS most_common_return_reason FROM store_sales JOIN store ON ss_store_sk = s_store_sk JOIN date_dim ON ss_sold_date_sk = d_date_sk LEFT JOIN web_returns ON ss_item_sk = wr_item_sk AND ss_ticket_number = wr_order_number LEFT JOIN reason ON wr_reason_sk = r_reason_sk WHERE s_state IN ('NY', 'CA') AND d_year = 2023 GROUP BY s_store_name, s_state, s_city, d_year, d_quarter_name, r_reason_desc ORDER BY total_sales DESC, total_quantity_sold DESC LIMIT 10;
SELECT s.s_store_name, s.s_street_name, s.s_street_type, s.s_city, s.s_state, s.s_zip, SUM(sr.sr_return_amt_inc_tax) AS total_store_refunds, AVG(sr.sr_return_amt_inc_tax) AS avg_store_refund, COUNT(sr.sr_return_amt_inc_tax) AS num_store_returns, SUM(wr.wr_return_amt_inc_tax) AS total_web_refunds, AVG(wr.wr_return_amt_inc_tax) AS avg_web_refund, COUNT(wr.wr_return_amt_inc_tax) AS num_web_returns FROM store s LEFT JOIN store_returns sr ON s.s_store_sk = sr.sr_store_sk LEFT JOIN date_dim d_store ON sr.sr_returned_date_sk = d_store.d_date_sk LEFT JOIN web_returns wr ON s.s_store_sk = wr.wr_returning_customer_sk LEFT JOIN date_dim d_web ON wr.wr_returned_date_sk = d_web.d_date_sk WHERE s.s_street_type IN ('Road', 'Circle', 'Court') AND (d_store.d_quarter_name = '1906Q2' OR d_web.d_quarter_name = '1906Q2') GROUP BY s.s_store_name, s.s_street_name, s.s_street_type, s.s_city, s.s_state, s.s_zip ORDER BY total_store_refunds DESC, total_web_refunds DESC;
SELECT sm.sm_type, sm.sm_code, COUNT(wr.wr_order_number) AS total_returns, AVG(wr.wr_return_amt) AS average_return_amount, SUM(wr.wr_return_quantity) AS total_returned_quantity, SUM(wr.wr_return_ship_cost) AS total_return_shipping_cost, AVG(hd.hd_dep_count) AS average_dependent_count, AVG(hd.hd_vehicle_count) AS average_vehicle_count, td.t_shift, SUM(CASE WHEN td.t_am_pm = 'AM' THEN 1 ELSE 0 END) AS returns_in_am, SUM(CASE WHEN td.t_am_pm = 'PM' THEN 1 ELSE 0 END) AS returns_in_pm FROM web_returns wr JOIN ship_mode sm ON wr.wr_order_number = sm.sm_ship_mode_sk JOIN household_demographics hd ON wr.wr_returning_hdemo_sk = hd.hd_demo_sk JOIN time_dim td ON wr.wr_returned_time_sk = td.t_time_sk WHERE sm.sm_type IN ('NEXT DAY', 'TWO DAY', 'LIBRARY', 'EXPRESS', 'REGULAR', 'OVERNIGHT') AND sm.sm_code IN ('SEA', 'BIKE', 'AIR', 'SURFACE') AND td.t_second IN ('18', '2', '56', '30') AND wr.wr_return_ship_cost IN ('3700.56', '275.65', '284.48') GROUP BY sm.sm_type, sm.sm_code, td.t_shift ORDER BY total_returns DESC, total_return_shipping_cost DESC;
SELECT ca.ca_state, ca.ca_county, ca.ca_city, AVG(inv.inv_quantity_on_hand) AS avg_quantity_on_hand, COUNT(DISTINCT sm.sm_ship_mode_sk) AS num_shipment_modes, COUNT(DISTINCT ca.ca_address_sk) AS num_addresses FROM inventory inv JOIN customer_address ca ON inv.inv_warehouse_sk = ca.ca_address_sk JOIN time_dim td ON inv.inv_date_sk = td.t_time_sk JOIN ship_mode sm ON sm.sm_ship_mode_id LIKE 'AAAAAAA%' WHERE td.t_time_id = 'AAAAAAAAAGCAAAAA' AND ca.ca_address_sk IN (3195, 2241, 86, 2256, 3606) AND inv.inv_date_sk = 2450815 AND sm.sm_ship_mode_id IN ('AAAAAAAAEBAAAAAA', 'AAAAAAAAKAAAAAAA', 'AAAAAAAAMAAAAAAA', 'AAAAAAAAOAAAAAAA') GROUP BY ROLLUP (ca.ca_state, ca.ca_county, ca.ca_city) ORDER BY ca.ca_state, ca.ca_county, ca.ca_city;
SELECT c.cd_gender, c.cd_marital_status, c.cd_education_status, c.cd_credit_rating, AVG(c.cd_purchase_estimate) AS avg_purchase_estimate, SUM(c.cd_dep_count) AS total_dep_count, SUM(c.cd_dep_employed_count) AS total_dep_employed_count, SUM(c.cd_dep_college_count) AS total_dep_college_count, w.w_state, w.w_country, COUNT(DISTINCT w.w_warehouse_sk) AS num_warehouses, AVG(w.w_warehouse_sq_ft) AS avg_warehouse_size, web.web_class, web.web_market_manager, COUNT(DISTINCT web.web_site_sk) AS num_websites, AVG(web.web_tax_percentage) AS avg_web_tax_percentage FROM customer_demographics c JOIN warehouse w ON c.cd_demo_sk = w.w_warehouse_sk JOIN web_site web ON w.w_state = web.web_state GROUP BY c.cd_gender, c.cd_marital_status, c.cd_education_status, c.cd_credit_rating, w.w_state, w.w_country, web.web_class, web.web_market_manager ORDER BY w.w_country, w.w_state, c.cd_education_status, c.cd_credit_rating;
SELECT w_state, sm_type, EXTRACT(YEAR FROM wp_rec_start_date) AS year, EXTRACT(QUARTER FROM wp_rec_start_date) AS quarter, SUM(cs_quantity) AS total_quantity, AVG(cs_sales_price) AS average_sales_price, COUNT(DISTINCT cs_order_number) AS total_orders, SUM(cs_net_paid) AS total_net_paid, SUM(cs_net_profit) AS total_net_profit FROM catalog_sales JOIN warehouse ON cs_warehouse_sk = w_warehouse_sk JOIN ship_mode ON cs_ship_mode_sk = sm_ship_mode_sk JOIN web_page ON cs_catalog_page_sk = wp_web_page_sk JOIN time_dim ON cs_sold_time_sk = t_time_sk JOIN inventory ON cs_warehouse_sk = inv_warehouse_sk AND cs_item_sk = inv_item_sk WHERE t_time_sk IN (1701, 993, 898, 4227, 3566, 3142) AND sm_carrier IN ('GERMA', 'DHL', 'ORIENTAL', 'PRIVATECARRIER') AND inv_date_sk = 2450815 GROUP BY w_state, sm_type, year, quarter ORDER BY total_net_profit DESC, total_net_paid DESC, total_orders DESC;
SELECT i.i_category, cd.cd_education_status, cd.cd_marital_status, COUNT(DISTINCT i.i_item_sk) AS item_count, AVG(i.i_current_price) AS avg_current_price, AVG(i.i_wholesale_cost) AS avg_wholesale_cost FROM item i JOIN customer_demographics cd ON cd.cd_demo_sk = i.i_manager_id JOIN household_demographics hd ON hd.hd_demo_sk = i.i_manager_id WHERE i.i_rec_start_date <= CURRENT_DATE AND (i.i_rec_end_date IS NULL OR i.i_rec_end_date > CURRENT_DATE) AND cd.cd_gender IN ('M', 'F') AND cd.cd_marital_status IN ('D', 'U', 'S', 'M', 'W') GROUP BY i.i_category, cd.cd_education_status, cd.cd_marital_status ORDER BY i.i_category, cd.cd_education_status, cd.cd_marital_status;
SELECT cc.cc_call_center_id, cc.cc_name, cc.cc_city, cc.cc_state, r.r_reason_id, r.r_reason_desc, AVG(ws.ws_sales_price) AS avg_sales_price, SUM(ws.ws_ext_discount_amt) AS total_discount_amount, SUM(ws.ws_net_profit) AS total_profit, COUNT(ws.ws_order_number) AS number_of_orders FROM call_center cc JOIN web_sales ws ON cc.cc_call_center_sk = ws.ws_bill_addr_sk JOIN reason r ON r.r_reason_sk = ws.ws_order_number JOIN time_dim td ON ws.ws_sold_time_sk = td.t_time_sk WHERE cc.cc_hours IN ('8AM-8AM', '8AM-4PM') AND cc.cc_street_type IN ('Way', 'RD', 'Boulevard') AND r.r_reason_id IN ('AAAAAAAAEAAAAAAA', 'AAAAAAAAJAAAAAAA', 'AAAAAAAABBAAAAAA', 'AAAAAAAANBAAAAAA', 'AAAAAAAADBAAAAAA', 'AAAAAAAAFAAAAAAA') AND ws.ws_sold_date_sk IN ('2451967', '2450969', '2452345') AND ws.ws_ship_cdemo_sk IN ('1654521', '1866243', '1370635') AND td.t_hour IN (0, 1) AND td.t_second IN ('48', '12', '47', '27', '16') GROUP BY cc.cc_call_center_id, cc.cc_name, cc.cc_city, cc.cc_state, r.r_reason_id, r.r_reason_desc ORDER BY total_profit DESC;
SELECT cc.cc_company_name, r.r_reason_desc, COUNT(wr.wr_returned_date_sk) AS total_returns, SUM(wr.wr_return_amt_inc_tax) AS total_refund_amount, AVG(wr.wr_return_amt_inc_tax) AS average_refund_amount FROM web_returns wr JOIN call_center cc ON wr.wr_refunded_customer_sk::text LIKE '%' || cc.cc_call_center_id JOIN reason r ON wr.wr_reason_sk = r.r_reason_sk JOIN household_demographics hd ON wr.wr_refunded_hdemo_sk = hd.hd_demo_sk WHERE cc.cc_company_name IN ('able', 'pri', 'cally', 'ought') AND hd.hd_dep_count = 0 AND hd.hd_income_band_sk IN (17, 20, 13, 15, 2, 1) AND r.r_reason_desc IN ('Not working any more', 'duplicate purchase', 'reason 28', 'Stopped working', 'reason 24', 'reason 27') GROUP BY cc.cc_company_name, r.r_reason_desc ORDER BY total_refund_amount DESC;
SELECT sm.sm_type, sm.sm_carrier, COUNT(DISTINCT wr.wr_item_sk) AS total_items_returned, SUM(wr.wr_return_quantity) AS total_quantity_returned, AVG(wr.wr_return_amt) AS average_return_amount, AVG(wr.wr_fee) AS average_fee, SUM(wr.wr_net_loss) AS total_net_loss, ws.web_name, ws.web_manager, ws.web_mkt_class, COUNT(DISTINCT ws.web_site_sk) AS total_sites FROM web_returns wr JOIN ship_mode sm ON wr.wr_returned_date_sk = sm.sm_ship_mode_sk JOIN web_site ws ON wr.wr_web_page_sk = ws.web_site_sk WHERE ws.web_mkt_id IN (3, 4, 6, 2) AND ws.web_street_name = 'Hickory 3rd' AND wr.wr_returned_date_sk BETWEEN 100 AND 200 GROUP BY sm.sm_type, sm.sm_carrier, ws.web_name, ws.web_manager, ws.web_mkt_class ORDER BY total_net_loss DESC, total_quantity_returned DESC LIMIT 10;
SELECT ca_state, cd_gender, cd_education_status, COUNT(DISTINCT cs_order_number) AS total_orders, SUM(cs_quantity) AS total_quantity, AVG(cs_sales_price) AS avg_sales_price, SUM(cs_net_paid) AS total_net_paid, SUM(cs_net_profit) AS total_net_profit FROM catalog_sales JOIN customer_address ON cs_bill_addr_sk = ca_address_sk JOIN customer_demographics ON cs_bill_cdemo_sk = cd_demo_sk JOIN time_dim ON cs_sold_time_sk = t_time_sk JOIN web_page ON cs_sold_date_sk = wp_access_date_sk WHERE ca_country = 'United States' AND t_shift = 'Day' AND wp_type IN ('order', 'general') AND cd_gender IN ('M', 'F') AND cd_dep_count IN (1, 2) GROUP BY ca_state, cd_gender, cd_education_status ORDER BY total_net_profit DESC, total_net_paid DESC, avg_sales_price DESC;
SELECT d_year, i_category, SUM(ws_net_paid_inc_tax) AS total_sales, AVG(ws_quantity) AS average_quantity, COUNT(DISTINCT ws_bill_customer_sk) AS unique_customers, SUM(cr_net_loss) AS total_returns_loss, COUNT(DISTINCT cr_returned_date_sk) AS return_days FROM web_sales JOIN date_dim ON ws_sold_date_sk = d_date_sk JOIN item ON ws_item_sk = i_item_sk LEFT JOIN catalog_returns ON ws_item_sk = cr_item_sk AND ws_order_number = cr_order_number WHERE d_year = 2002 AND ws_net_paid_inc_tax > 0 AND d_current_year = 'N' GROUP BY d_year, i_category ORDER BY total_sales DESC;
SELECT cp.cp_department, SUM(ws.ws_net_profit) AS total_web_sales_profit, AVG(ws.ws_quantity) AS avg_web_sales_quantity, COUNT(DISTINCT ws.ws_order_number) AS total_web_orders, SUM(cr.cr_net_loss) AS total_catalog_returns_loss, AVG(cr.cr_return_quantity) AS avg_catalog_return_quantity, COUNT(DISTINCT cr.cr_order_number) AS total_catalog_returns, SUM(sr.sr_net_loss) AS total_store_returns_loss, AVG(sr.sr_return_quantity) AS avg_store_return_quantity, COUNT(DISTINCT sr.sr_ticket_number) AS total_store_returns, SUM(CASE WHEN p.p_channel_dmail = 'Y' THEN p.p_cost ELSE 0 END) AS total_promo_cost_via_dmail, COUNT(CASE WHEN p.p_channel_demo = 'N' AND p.p_channel_catalog = 'N' THEN p.p_promo_sk END) AS count_non_demo_catalog_promos FROM catalog_page cp LEFT JOIN web_sales ws ON cp.cp_catalog_page_sk = ws.ws_web_page_sk LEFT JOIN catalog_returns cr ON cp.cp_catalog_page_sk = cr.cr_catalog_page_sk LEFT JOIN store_returns sr ON sr.sr_item_sk = ws.ws_item_sk LEFT JOIN promotion p ON ws.ws_promo_sk = p.p_promo_sk WHERE cp.cp_start_date_sk IS NOT NULL AND cp.cp_end_date_sk IS NOT NULL AND ws.ws_sold_date_sk BETWEEN cp.cp_start_date_sk AND cp.cp_end_date_sk GROUP BY cp.cp_department ORDER BY total_web_sales_profit DESC, total_catalog_returns_loss ASC, total_store_returns_loss ASC;
SELECT s.s_store_name, s.s_state, sm.sm_type AS ship_mode_type, dd.d_fy_quarter_seq AS fiscal_year_quarter, COUNT(DISTINCT ws.ws_order_number) AS total_orders, SUM(ws.ws_quantity) AS total_quantity_sold, SUM(ws.ws_net_profit) AS total_net_profit, AVG(ws.ws_net_profit) AS average_net_profit_per_order, SUM(sr.sr_net_loss) AS total_net_loss_from_returns, AVG(sr.sr_fee) AS average_return_fee FROM store s INNER JOIN store_returns sr ON s.s_store_sk = sr.sr_store_sk INNER JOIN web_sales ws ON sr.sr_store_sk = ws.ws_ship_customer_sk INNER JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk INNER JOIN date_dim dd ON ws.ws_sold_date_sk = dd.d_date_sk WHERE s.s_state IN ('CA', 'TX', 'NY') AND ws.ws_promo_sk IN (283, 240) AND ws.ws_ext_sales_price IN (1516.11, 2342.50, 214.40) AND sr.sr_return_ship_cost IN (3.11, 720.07, 1424.48) AND dd.d_fy_quarter_seq IN (39, 22, 50) GROUP BY s.s_store_name, s.s_state, sm.sm_type, dd.d_fy_quarter_seq ORDER BY total_net_profit DESC;
SELECT s.s_store_id, s.s_zip, cs.cs_sold_date_sk, AVG(cs.cs_sales_price) AS avg_sales_price, SUM(cs.cs_quantity) AS total_quantity_sold, SUM(cs.cs_ext_sales_price) AS total_sales, SUM(cs.cs_net_paid) AS net_paid, SUM(cs.cs_net_paid_inc_tax) AS net_paid_inc_tax, SUM(cs.cs_net_profit) AS net_profit, COUNT(DISTINCT cs.cs_order_number) AS total_orders, AVG(sr.sr_return_amt) AS avg_return_amt, SUM(sr.sr_return_quantity) AS total_return_quantity, SUM(sr.sr_net_loss) AS net_loss FROM catalog_sales cs JOIN store s ON cs.cs_ship_customer_sk = s.s_store_sk LEFT JOIN store_returns sr ON cs.cs_item_sk = sr.sr_item_sk AND cs.cs_order_number = sr.sr_ticket_number WHERE s.s_store_id = 'AAAAAAAACAAAAAAA' AND s.s_zip = '35709' GROUP BY s.s_store_id, s.s_zip, cs.cs_sold_date_sk ORDER BY cs.cs_sold_date_sk DESC;
SELECT d_year, i_category, s_state, SUM(i_current_price) AS total_price, AVG(i_current_price) AS avg_price, COUNT(DISTINCT i_item_sk) AS unique_items_sold, COUNT(DISTINCT s_store_sk) AS number_of_stores, SUM(p_cost) AS total_promotion_cost, AVG(p_cost) AS avg_promotion_cost, COUNT(DISTINCT p_promo_sk) AS number_of_promotions, MAX(wp_max_ad_count) AS max_ad_count_webpage FROM date_dim, item, store, promotion, web_page, ship_mode WHERE i_rec_start_date <= d_date AND (i_rec_end_date IS NULL OR i_rec_end_date > d_date) AND s_rec_start_date <= d_date AND (s_rec_end_date IS NULL OR s_rec_end_date > d_date) AND wp_rec_start_date <= d_date AND (wp_rec_end_date IS NULL OR wp_rec_end_date > d_date) AND p_start_date_sk = d_date_sk AND (p_end_date_sk IS NULL OR p_end_date_sk >= d_date_sk) AND sm_type IN ('REGULAR', 'LIBRARY') AND i_class IN ('sports-apparel', 'decor', 'dvd/vcr players', 'shirts', 'bedding', 'fishing') AND p_channel_event = 'N' AND p_purpose <> 'Unknown' GROUP BY d_year, i_category, s_state ORDER BY d_year, i_category, s_state;
SELECT hd.hd_income_band_sk, COUNT(DISTINCT ss.ss_customer_sk) AS num_customers, SUM(ss.ss_quantity) AS total_quantity_sold, AVG(ss.ss_sales_price) AS avg_sales_price, SUM(ss.ss_net_paid) AS total_net_paid, SUM(ss.ss_net_profit) AS total_net_profit FROM store_sales ss JOIN household_demographics hd ON ss.ss_hdemo_sk = hd.hd_demo_sk JOIN income_band ib ON hd.hd_income_band_sk = ib.ib_income_band_sk JOIN promotion p ON ss.ss_promo_sk = p.p_promo_sk JOIN time_dim t ON ss.ss_sold_time_sk = t.t_time_sk WHERE hd.hd_income_band_sk IN (18, 2) AND t.t_hour BETWEEN 8 AND 17 GROUP BY hd.hd_income_band_sk ORDER BY total_net_profit DESC;
SELECT w_state, w_city, COUNT(DISTINCT w_warehouse_sk) AS number_of_warehouses, SUM(w_warehouse_sq_ft) AS total_warehouse_sq_ft, AVG(w_warehouse_sq_ft) AS avg_warehouse_sq_ft, p_channel_dmail, p_channel_email, COUNT(DISTINCT p_promo_sk) AS number_of_promotions, SUM(p_cost) AS total_promotion_cost, AVG(p_cost) AS avg_promotion_cost, s_state, s_city, COUNT(DISTINCT s_store_sk) AS number_of_stores, SUM(s_number_employees) AS total_employees, AVG(s_floor_space) AS avg_store_floor_space, SUM(s_tax_precentage) AS total_tax_percentage, AVG(s_tax_precentage) AS avg_tax_percentage FROM warehouse JOIN promotion ON w_warehouse_sk = p_item_sk JOIN store ON w_state = s_state AND w_city = s_city WHERE promotion.p_channel_press = 'N' AND promotion.p_purpose = 'Unknown' AND store.s_rec_start_date <= CURRENT_DATE AND (store.s_rec_end_date IS NULL OR store.s_rec_end_date > CURRENT_DATE) GROUP BY w_state, w_city, p_channel_dmail, p_channel_email, s_state, s_city ORDER BY w_state, w_city;
SELECT cc.cc_name AS call_center_name, st.s_store_name AS store_name, st.s_state AS store_state, ws.web_name AS website_name, p.p_promo_name AS promotion_name, p.p_channel_details AS promotion_channel_details, SUM(ss.ss_quantity) AS total_quantity_sold, AVG(ss.ss_sales_price) AS average_sales_price, SUM(ss.ss_net_paid) AS total_net_sales, SUM(ss.ss_net_profit) AS total_net_profit FROM call_center cc JOIN store_sales ss ON cc.cc_call_center_sk = ss.ss_store_sk JOIN store st ON ss.ss_store_sk = st.s_store_sk JOIN web_site ws ON st.s_market_id = ws.web_mkt_id JOIN promotion p ON ss.ss_promo_sk = p.p_promo_sk WHERE cc.cc_manager IN ('Mark Hightower', 'Felipe Perkins', 'Bob Belcher') AND cc.cc_call_center_id = 'AAAAAAAAEAAAAAAA' AND st.s_market_id IN (4, 6, 7, 2, 8, 10) AND st.s_country = 'United States' AND p.p_start_date_sk IN (2450694, 2450318, 2450696, 2450508, 2450764, 2450750) AND ss.ss_customer_sk IN (169, 28519, 57009, 32392) GROUP BY call_center_name, store_name, store_state, website_name, promotion_name, promotion_channel_details ORDER BY total_net_sales DESC;
SELECT ib.ib_income_band_sk, ib.ib_lower_bound, ib.ib_upper_bound, COUNT(DISTINCT ss.ss_customer_sk) AS num_customers, SUM(ss.ss_quantity) AS total_quantity_sold, AVG(ss.ss_sales_price) AS avg_sales_price, SUM(ss.ss_net_profit) AS total_net_profit, SUM(sr.sr_return_quantity) AS total_return_quantity, SUM(sr.sr_return_amt) AS total_return_amount, AVG(sr.sr_fee) AS avg_return_fee, COUNT(DISTINCT wp.wp_web_page_sk) AS num_visited_pages, SUM(wp.wp_link_count) AS total_link_count FROM income_band ib LEFT JOIN store_sales ss ON ib.ib_income_band_sk = ss.ss_cdemo_sk LEFT JOIN store_returns sr ON ss.ss_customer_sk = sr.sr_customer_sk AND sr.sr_reason_sk IN (21, 2, 14, 30) LEFT JOIN web_page wp ON ss.ss_customer_sk = wp.wp_customer_sk AND wp.wp_type IN ('protected', 'ad') WHERE ss.ss_sold_date_sk IN (2451298, 2450872, 2451390, 2451634) AND ib.ib_upper_bound IN (30000, 130000, 90000) AND ib.ib_income_band_sk IN (17, 6) GROUP BY ib.ib_income_band_sk, ib.ib_lower_bound, ib.ib_upper_bound ORDER BY ib.ib_income_band_sk;
SELECT d_year, cp_department, sm_type, p_promo_name, COUNT(cs_order_number) AS total_orders, SUM(cs_quantity) AS total_quantity, AVG(cs_sales_price) AS average_sales_price, SUM(cs_net_paid_inc_ship_tax) AS total_revenue, SUM(cs_ext_tax) AS total_tax_collected, AVG(cs_net_profit) AS average_profit FROM catalog_sales JOIN date_dim ON cs_sold_date_sk = d_date_sk JOIN catalog_page ON cs_catalog_page_sk = cp_catalog_page_sk JOIN ship_mode ON cs_ship_mode_sk = sm_ship_mode_sk JOIN promotion ON cs_promo_sk = p_promo_sk WHERE d_year = 2001 AND cp_department LIKE 'Electronics%' AND sm_type = 'AIR' AND p_channel_event = 'N' AND cs_net_paid_inc_ship_tax BETWEEN 500 AND 8000 GROUP BY d_year, cp_department, sm_type, p_promo_name ORDER BY total_revenue DESC, average_profit DESC;
SELECT i.i_category AS item_category, c.c_birth_month AS customer_birth_month, w.web_zip AS web_site_zip, COUNT(DISTINCT ws.ws_order_number) AS total_orders, SUM(ws.ws_net_paid) AS total_revenue, AVG(ws.ws_ext_discount_amt) AS average_discount, AVG(ws.ws_net_profit) AS average_profit FROM web_sales ws JOIN item i ON ws.ws_item_sk = i.i_item_sk JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk WHERE ws.ws_sold_date_sk BETWEEN 2450815 AND 2450915 AND i.i_item_sk IN (10310, 10207, 12818, 10796) AND w.web_zip IN ('35709', '31904') AND c.c_birth_month IN (3, 5) GROUP BY item_category, customer_birth_month, web_site_zip ORDER BY item_category, customer_birth_month, web_site_zip;
SELECT p.p_promo_name, COUNT(DISTINCT cs_order_number) AS total_orders, SUM(cs_quantity) AS total_quantity_sold, SUM(cs_net_paid) AS total_net_paid, AVG(cs_net_profit) AS average_net_profit, COUNT(DISTINCT cr_order_number) AS total_returns, SUM(cr_return_quantity) AS total_quantity_returned, SUM(cr_net_loss) AS total_net_loss, AVG(hd.hd_vehicle_count) AS average_vehicle_count FROM catalog_sales cs JOIN promotion p ON cs.cs_promo_sk = p.p_promo_sk LEFT JOIN catalog_returns cr ON cs.cs_item_sk = cr.cr_item_sk AND cs.cs_order_number = cr.cr_order_number JOIN household_demographics hd ON cs.cs_bill_hdemo_sk = hd.hd_demo_sk WHERE cs.cs_ext_wholesale_cost > 100 AND hd.hd_vehicle_count IN (0, 2, 3, 4) AND (cr.cr_returned_time_sk IS NULL OR cr.cr_returned_time_sk IN (80039, 82096, 81103)) GROUP BY p.p_promo_name ORDER BY total_net_paid DESC, total_net_loss ASC LIMIT 100;
