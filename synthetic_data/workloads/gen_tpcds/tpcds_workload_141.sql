SELECT sm.sm_type, sm.sm_carrier, w.web_site_sk, w.web_mkt_class, COUNT(DISTINCT ws.ws_order_number) AS total_orders, SUM(ws.ws_quantity) AS total_quantity, SUM(ws.ws_net_paid) AS total_net_paid, AVG(ws.ws_net_paid_inc_ship_tax) AS avg_net_paid_inc_ship_tax, SUM(ws.ws_net_profit) AS total_net_profit FROM web_sales ws JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk WHERE ws.ws_net_paid BETWEEN 100 AND 3000 AND sm.sm_code IN ('SEA', 'SURFACE') AND w.web_street_type = 'Road' AND w.web_mkt_class LIKE 'Broad, new groups show car%' GROUP BY ROLLUP(sm.sm_type, sm.sm_carrier, w.web_site_sk, w.web_mkt_class) ORDER BY total_net_profit DESC, total_quantity DESC, avg_net_paid_inc_ship_tax DESC;
SELECT d_year, p_channel_details, COUNT(DISTINCT ws_order_number) AS web_order_count, SUM(ws_net_paid) AS total_web_sales, SUM(ws_net_profit) AS total_web_profit, AVG(ws_quantity) AS average_quantity_sold, SUM(ss_net_paid) AS total_store_sales, SUM(ss_net_profit) AS total_store_profit, AVG(ss_quantity) AS average_store_quantity_sold FROM web_sales JOIN store_sales ON ws_item_sk = ss_item_sk JOIN date_dim ON ws_sold_date_sk = d_date_sk JOIN promotion ON ws_promo_sk = p_promo_sk WHERE d_year IN (1902, 1903, 1904) AND p_channel_details IS NOT NULL AND (ws_net_paid > 0 OR ss_net_paid > 0) GROUP BY d_year, p_channel_details ORDER BY d_year, p_channel_details;
SELECT s.s_store_name, s.s_city, s.s_state, SUM(i.inv_quantity_on_hand) AS total_quantity_on_hand, AVG(i.inv_quantity_on_hand) AS avg_quantity_on_hand, COUNT(DISTINCT i.inv_item_sk) AS unique_items_count, COUNT(DISTINCT i.inv_warehouse_sk) AS warehouse_count, SUM(wp.wp_link_count) AS total_webpage_links, AVG(wp.wp_image_count) AS avg_webpage_images FROM inventory i JOIN store s ON i.inv_warehouse_sk = s.s_store_sk JOIN web_page wp ON s.s_market_id = wp.wp_customer_sk WHERE i.inv_date_sk = 2450815 AND i.inv_quantity_on_hand IN (499, 291, 296, 643, 586) AND s.s_state IN ('IL', 'KY', 'OR', 'VA', 'FL', 'AL', 'OK', 'IA', 'TX') AND wp.wp_type = 'product' GROUP BY s.s_store_name, s.s_city, s.s_state ORDER BY total_quantity_on_hand DESC, avg_quantity_on_hand DESC;
SELECT ib.ib_income_band_sk, cc.cc_division_name, AVG(wr.wr_return_amt_inc_tax) AS avg_return_amt_inc_tax, SUM(wr.wr_net_loss) AS total_net_loss, COUNT(wr.wr_returned_date_sk) AS total_returns, AVG(hd.hd_dep_count) AS avg_dependents, AVG(hd.hd_vehicle_count) AS avg_vehicles FROM web_returns wr JOIN household_demographics hd ON wr.wr_returning_hdemo_sk = hd.hd_demo_sk JOIN income_band ib ON hd.hd_income_band_sk = ib.ib_income_band_sk JOIN call_center cc ON cc.cc_country = 'United States' AND cc.cc_call_center_sk = wr.wr_refunded_addr_sk WHERE hd.hd_income_band_sk IN (20, 8, 18, 11, 19, 2) GROUP BY ib.ib_income_band_sk, cc.cc_division_name ORDER BY total_net_loss DESC, avg_return_amt_inc_tax DESC;
SELECT ca_state, sm_type, COUNT(DISTINCT cs_order_number) AS total_orders, SUM(cs_quantity) AS total_quantity, AVG(cs_sales_price) AS avg_sales_price, SUM(cs_net_profit) AS total_profit FROM catalog_sales JOIN customer_address ON cs_ship_addr_sk = ca_address_sk JOIN ship_mode ON cs_ship_mode_sk = sm_ship_mode_sk JOIN catalog_page ON cs_catalog_page_sk = cp_catalog_page_sk WHERE cp_catalog_page_number IN (73, 12, 56, 26) AND ca_country = 'United States' AND sm_type = 'AIR' GROUP BY ca_state, sm_type ORDER BY total_profit DESC;
SELECT ca_state, cd_education_status, AVG(cs_net_paid) AS avg_sales_amount, SUM(cs_net_paid) AS total_sales_amount, COUNT(DISTINCT cs_bill_customer_sk) AS unique_customers FROM catalog_sales JOIN date_dim ON catalog_sales.cs_sold_date_sk = date_dim.d_date_sk JOIN customer_demographics ON catalog_sales.cs_bill_cdemo_sk = customer_demographics.cd_demo_sk JOIN customer_address ON catalog_sales.cs_bill_addr_sk = customer_address.ca_address_sk WHERE date_dim.d_quarter_name IN ('1901Q4', '1913Q3', '1902Q3') AND date_dim.d_current_quarter = 'N' AND customer_address.ca_county IN ('Claiborne County', 'Scott County', 'Borden County', 'Juneau County') GROUP BY ca_state, cd_education_status ORDER BY ca_state, cd_education_status, total_sales_amount DESC;
SELECT d_year, i_category, sm_type, COUNT(*) AS total_shipments, SUM(i_current_price * i_wholesale_cost) AS revenue, AVG(i_current_price) AS avg_price, AVG(i_wholesale_cost) AS avg_cost FROM date_dim, item, ship_mode, income_band WHERE i_rec_start_date <= d_date AND (i_rec_end_date IS NULL OR i_rec_end_date >= d_date) AND sm_ship_mode_sk IN (SELECT sm_ship_mode_sk FROM ship_mode WHERE sm_type = 'AIR' OR sm_type = 'GROUND') AND ib_income_band_sk IN (4, 15, 3, 18) AND ib_upper_bound IN (200000, 50000) GROUP BY d_year, i_category, sm_type ORDER BY revenue DESC, d_year, i_category;
SELECT ca.ca_city, ca.ca_state, sm.sm_type AS shipping_type, COUNT(DISTINCT cr.cr_order_number) AS total_returns, SUM(cr.cr_return_quantity) AS total_returned_quantity, SUM(cr.cr_return_amount) AS total_returned_amount, AVG(cr.cr_return_amount) AS avg_return_amount, SUM(cs.cs_quantity) AS total_sold_quantity, SUM(cs.cs_sales_price) AS total_sales_amount, AVG(cs.cs_sales_price) AS avg_sales_price, SUM(ss.ss_quantity) AS total_store_sold_quantity, SUM(ss.ss_sales_price) AS total_store_sales_amount, AVG(ss.ss_sales_price) AS avg_store_sales_price FROM catalog_returns cr JOIN customer_address ca ON cr.cr_returning_addr_sk = ca.ca_address_sk JOIN ship_mode sm ON cr.cr_ship_mode_sk = sm.sm_ship_mode_sk JOIN catalog_sales cs ON cr.cr_order_number = cs.cs_order_number AND cr.cr_item_sk = cs.cs_item_sk JOIN store_sales ss ON cs.cs_order_number = ss.ss_ticket_number AND cs.cs_item_sk = ss.ss_item_sk WHERE ca.ca_location_type IN ('single family', 'apartment', 'condo') AND ca.ca_address_sk IN (1045, 2742, 4441, 2983, 912) AND ss.ss_ticket_number IN (3727, 3689, 3508, 3484, 3325, 3364) AND ss.ss_addr_sk = 29811 AND cs.cs_ship_cdemo_sk = 172784 GROUP BY ca.ca_city, ca.ca_state, sm.sm_type ORDER BY total_returned_amount DESC, total_sales_amount DESC, total_store_sales_amount DESC;
SELECT hd.hd_income_band_sk AS income_band, hd.hd_buy_potential AS buy_potential, COUNT(cs.cs_order_number) AS number_of_transactions, SUM(cs.cs_net_paid) AS total_sales, AVG(cs.cs_sales_price) AS average_sales_price FROM catalog_sales cs JOIN household_demographics hd ON cs.cs_bill_hdemo_sk = hd.hd_demo_sk GROUP BY hd.hd_income_band_sk, hd.hd_buy_potential ORDER BY hd.hd_income_band_sk, hd.hd_buy_potential;
SELECT d_year, SUM(sr_return_amt) AS total_return_amount, AVG(sr_return_quantity) AS avg_return_quantity, COUNT(DISTINCT sr_customer_sk) AS unique_customers_returning, COUNT(DISTINCT p_promo_sk) AS distinct_promotions, SUM(inv_quantity_on_hand) AS total_inventory_quantity, COUNT(DISTINCT cp_catalog_page_sk) AS num_catalog_pages FROM store_returns JOIN date_dim ON store_returns.sr_returned_date_sk = date_dim.d_date_sk JOIN promotion ON store_returns.sr_item_sk = promotion.p_item_sk JOIN inventory ON store_returns.sr_item_sk = inventory.inv_item_sk JOIN catalog_page ON promotion.p_item_sk = catalog_page.cp_catalog_page_sk WHERE d_fy_year IN ('1900', '1901', '1902', '1904', '1910', '1912') AND p_channel_tv = 'N' AND sr_return_time_sk IN ('42714', '34148', '59678') AND inv_item_sk IN ('9572', '12640', '8512', '13724') AND inv_warehouse_sk IN ('1', '2') GROUP BY d_year ORDER BY d_year;
SELECT cp.cp_department, hd.hd_income_band_sk, COUNT(DISTINCT sr.sr_ticket_number) AS total_returns, SUM(sr.sr_return_quantity) AS total_returned_items, AVG(sr.sr_return_amt) AS average_return_amount, SUM(sr.sr_net_loss) AS total_net_loss, web.web_class, COUNT(DISTINCT web.web_site_sk) AS total_web_sites FROM catalog_page cp JOIN store_returns sr ON cp.cp_catalog_page_sk = sr.sr_item_sk JOIN household_demographics hd ON sr.sr_hdemo_sk = hd.hd_demo_sk JOIN web_site web ON web.web_company_id = cp.cp_catalog_number WHERE cp.cp_start_date_sk IS NOT NULL AND cp.cp_end_date_sk IS NOT NULL AND sr.sr_returned_date_sk BETWEEN cp.cp_start_date_sk AND cp.cp_end_date_sk AND (sr.sr_reversed_charge = 63.95 OR sr.sr_reversed_charge = 41.39) GROUP BY cp.cp_department, hd.hd_income_band_sk, web.web_class ORDER BY total_returns DESC, total_net_loss DESC;
