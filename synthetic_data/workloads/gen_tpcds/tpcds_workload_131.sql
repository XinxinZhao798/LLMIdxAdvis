SELECT cp.cp_department, hd.hd_buy_potential, w.w_state, SUM(ss.ss_quantity) AS total_quantity_sold, AVG(ss.ss_sales_price) AS average_sales_price, COUNT(DISTINCT ss.ss_ticket_number) AS unique_tickets, SUM(ss.ss_net_paid_inc_tax) AS total_revenue_inc_tax, SUM(ss.ss_net_profit) AS total_net_profit FROM catalog_page cp JOIN store_sales ss ON cp.cp_catalog_page_sk = ss.ss_sold_date_sk JOIN household_demographics hd ON ss.ss_hdemo_sk = hd.hd_demo_sk JOIN warehouse w ON ss.ss_addr_sk = w.w_warehouse_sk WHERE cp.cp_end_date_sk IN ('2451509', '2451817', '2451635') AND hd.hd_vehicle_count IN (0, 1, 2, 3, 4) AND w.w_state = 'TN' AND ss.ss_ticket_number IN (3518, 3677) GROUP BY cp.cp_department, hd.hd_buy_potential, w.w_state ORDER BY total_net_profit DESC;
SELECT r.r_reason_desc, COUNT(cr.cr_order_number) AS total_returns, SUM(cr.cr_return_quantity) AS total_returned_items, AVG(cr.cr_return_amount) AS avg_return_amount, SUM(cr.cr_return_amount) AS total_return_amount, SUM(cr.cr_return_amt_inc_tax) AS total_return_amount_inc_tax, SUM(cr.cr_fee) AS total_fees, SUM(cr.cr_net_loss) AS total_net_loss, SUM(cs.cs_quantity) AS total_sold_quantity, AVG(cs.cs_sales_price) AS avg_sales_price, SUM(cs.cs_sales_price) AS total_sales, SUM(cs.cs_net_profit) AS total_net_profit FROM catalog_returns cr JOIN reason r ON cr.cr_reason_sk = r.r_reason_sk JOIN catalog_sales cs ON cr.cr_item_sk = cs.cs_item_sk AND cr.cr_order_number = cs.cs_order_number WHERE cr.cr_returned_date_sk IS NOT NULL AND (cr.cr_refunded_addr_sk IN (18593, 5341, 29829) OR r.r_reason_desc IN ('reason 29', 'reason 28', 'reason 31', 'Lost my job', 'Did not get it on time')) GROUP BY r.r_reason_desc ORDER BY total_returns DESC, total_return_amount DESC;
SELECT ib.ib_lower_bound, ib.ib_upper_bound, sm.sm_type, COUNT(DISTINCT cp.cp_catalog_page_sk) AS total_catalog_pages, MIN(cp.cp_catalog_number) AS min_catalog_number, MAX(cp.cp_catalog_number) AS max_catalog_number, COUNT(DISTINCT sm.sm_ship_mode_sk) AS total_ship_modes FROM income_band ib CROSS JOIN ship_mode sm LEFT JOIN catalog_page cp ON cp.cp_department = 'Books' WHERE sm.sm_type IN ('LIBRARY', 'REGULAR') GROUP BY ib.ib_lower_bound, ib.ib_upper_bound, sm.sm_type ORDER BY ib.ib_lower_bound, sm.sm_type;
SELECT cc.cc_call_center_id, cc.cc_name, cc.cc_city, cc.cc_state, SUM(cs.cs_net_paid) AS total_sales, AVG(cs.cs_ext_discount_amt) AS average_discount, COUNT(cs.cs_order_number) AS number_of_orders, SUM(inv.inv_quantity_on_hand) AS total_inventory, COUNT(DISTINCT p.p_promo_id) AS number_of_promotions_used FROM call_center cc LEFT JOIN catalog_sales cs ON cc.cc_call_center_sk = cs.cs_call_center_sk LEFT JOIN promotion p ON cs.cs_promo_sk = p.p_promo_sk LEFT JOIN inventory inv ON cs.cs_item_sk = inv.inv_item_sk AND cc.cc_division = inv.inv_warehouse_sk WHERE cs.cs_sold_date_sk IN ('2450823', '2450816', '2450827', '2450829', '2450820') AND cs.cs_promo_sk IN ('130', '96', '160', '128') GROUP BY cc.cc_call_center_id, cc.cc_name, cc.cc_city, cc.cc_state ORDER BY total_sales DESC;
SELECT dd.d_year, dd.d_quarter_name, SUM(inv.inv_quantity_on_hand) AS total_inventory, AVG(hd.hd_dep_count) AS avg_dependent_count, COUNT(DISTINCT s.s_store_sk) AS num_stores, AVG(s.s_number_employees) AS avg_store_employees, AVG(s.s_floor_space) AS avg_store_floor_space, SUM(CASE WHEN ca.ca_state = 'CA' THEN 1 ELSE 0 END) AS num_addresses_in_california FROM inventory inv JOIN date_dim dd ON inv.inv_date_sk = dd.d_date_sk JOIN store s ON inv.inv_warehouse_sk = s.s_store_sk JOIN customer_address ca ON s.s_zip = ca.ca_zip JOIN household_demographics hd ON s.s_market_id = hd.hd_income_band_sk WHERE dd.d_year IN (1905, 1913, 1900, 1906, 1910) AND dd.d_current_month = 'N' AND inv.inv_warehouse_sk IN (1, 2) AND hd.hd_income_band_sk IN (20, 11, 4, 17, 7) GROUP BY dd.d_year, dd.d_quarter_name ORDER BY dd.d_year, dd.d_quarter_name;
SELECT c.c_first_name, c.c_last_name, sm.sm_type AS shipping_type, COUNT(ss.ss_ticket_number) AS total_sales_transactions, SUM(ss.ss_quantity) AS total_quantity_sold, AVG(ss.ss_sales_price) AS average_sales_price, SUM(ss.ss_net_profit) AS total_net_profit, SUM(sr.sr_return_quantity) AS total_returned_quantity, AVG(sr.sr_return_amt) AS average_return_amount, SUM(wr.wr_return_quantity) AS total_web_returned_quantity, AVG(wr.wr_return_amt) AS average_web_return_amount, COUNT(DISTINCT p.p_promo_sk) AS number_of_promotions, SUM(ws.ws_quantity) AS total_web_quantity_sold, AVG(ws.ws_sales_price) AS average_web_sales_price, SUM(ws.ws_net_profit) AS total_web_net_profit FROM customer c LEFT JOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk LEFT JOIN store_returns sr ON c.c_customer_sk = sr.sr_customer_sk LEFT JOIN web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk LEFT JOIN web_returns wr ON c.c_customer_sk = wr.wr_refunded_customer_sk LEFT JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk LEFT JOIN promotion p ON ss.ss_promo_sk = p.p_promo_sk OR ws.ws_promo_sk = p.p_promo_sk WHERE c.c_first_sales_date_sk IN (2450046, 2449304, 2451981, 2451206, 2449744) AND sm.sm_code IN ('SEA', 'BIKE', 'AIR', 'SURFACE') GROUP BY c.c_first_name, c.c_last_name, sm.sm_type ORDER BY total_net_profit DESC, total_web_net_profit DESC LIMIT 100;
SELECT c.cc_name, c.cc_city, c.cc_state, cp.cp_department, p.p_promo_name, t.t_shift, SUM(cs.cs_quantity) AS total_quantity_sold, AVG(cs.cs_sales_price) AS average_sales_price, COUNT(DISTINCT cs.cs_order_number) AS number_of_orders, SUM(cs.cs_net_profit) AS total_net_profit FROM catalog_sales cs JOIN call_center c ON cs.cs_call_center_sk = c.cc_call_center_sk JOIN catalog_page cp ON cs.cs_catalog_page_sk = cp.cp_catalog_page_sk JOIN promotion p ON cs.cs_promo_sk = p.p_promo_sk JOIN time_dim t ON cs.cs_sold_time_sk = t.t_time_sk WHERE c.cc_rec_start_date <= CURRENT_DATE AND (c.cc_rec_end_date IS NULL OR c.cc_rec_end_date > CURRENT_DATE) AND cp.cp_start_date_sk <= cs.cs_sold_date_sk AND (cp.cp_end_date_sk IS NULL OR cp.cp_end_date_sk >= cs.cs_sold_date_sk) AND p.p_discount_active = 'Y' GROUP BY c.cc_name, c.cc_city, c.cc_state, cp.cp_department, p.p_promo_name, t.t_shift ORDER BY total_net_profit DESC, total_quantity_sold DESC LIMIT 100;
SELECT ws.ws_web_site_sk, ws_site.web_site_id, COUNT(DISTINCT ws.ws_order_number) AS total_orders, SUM(ws.ws_quantity) AS total_quantity, AVG(ws.ws_sales_price) AS avg_sales_price, SUM(ws.ws_net_profit) AS total_net_profit, cc.cc_call_center_id, cc.cc_name, AVG(cc.cc_employees) AS avg_cc_employees, cd.cd_marital_status, COUNT(DISTINCT cd.cd_demo_sk) AS total_customers, AVG(cd.cd_purchase_estimate) AS avg_purchase_estimate, hd.hd_buy_potential, AVG(hd.hd_income_band_sk) AS avg_income_band FROM web_sales ws JOIN web_site ws_site ON ws.ws_web_site_sk = ws_site.web_site_sk JOIN call_center cc ON ws_site.web_mkt_id = cc.cc_mkt_id JOIN customer_demographics cd ON ws.ws_bill_cdemo_sk = cd.cd_demo_sk JOIN household_demographics hd ON ws.ws_bill_hdemo_sk = hd.hd_demo_sk WHERE ws.ws_sales_price > 0 AND ws.ws_sold_date_sk BETWEEN 2451569 AND 2452306 AND ws.ws_web_site_sk IN (4, 18, 20, 29, 27) AND cc.cc_call_center_sk IN (1, 4, 2) AND cd.cd_purchase_estimate > 5000 AND cd.cd_marital_status IN ('D', 'U', 'S', 'M', 'W') AND hd.hd_buy_potential IS NOT NULL GROUP BY ws.ws_web_site_sk, ws_site.web_site_id, cc.cc_call_center_id, cc.cc_name, cd.cd_marital_status, hd.hd_buy_potential ORDER BY total_net_profit DESC, avg_sales_price DESC LIMIT 100;
SELECT c.ca_county, COUNT(distinct ws.ws_order_number) AS total_orders, SUM(ws.ws_quantity) AS total_quantity_sold, AVG(ws.ws_sales_price) AS average_sales_price, SUM(ws.ws_net_paid_inc_tax) AS total_revenue_inc_tax, SUM(ws.ws_net_profit) AS total_net_profit FROM web_sales ws JOIN customer_address c ON ws.ws_bill_addr_sk = c.ca_address_sk JOIN web_page wp ON ws.ws_web_page_sk = wp.wp_web_page_sk JOIN store s ON c.ca_state = s.s_state WHERE wp.wp_char_count IN ('5918', '3732', '4894', '2129', '1526') AND c.ca_county IN ('Calloway County', 'Mifflin County', 'Dutchess County', 'Rowan County') AND s.s_number_employees = 297 AND ws.ws_bill_customer_sk IN ('50106', '534', '23933', '77910', '39966') GROUP BY c.ca_county ORDER BY total_revenue_inc_tax DESC, total_net_profit DESC;
