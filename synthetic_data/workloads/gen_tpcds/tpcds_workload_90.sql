SELECT s.s_store_name, SUM(ss.ss_quantity) AS total_quantity_sold, AVG(ss.ss_sales_price) AS average_sales_price, SUM(ss.ss_net_paid) AS total_net_paid, SUM(ss.ss_net_paid_inc_tax) AS total_net_paid_inc_tax, AVG(ss.ss_net_profit) AS average_net_profit, COUNT(DISTINCT p.p_promo_sk) AS number_of_promotions_run, SUM(CASE WHEN p.p_channel_tv = 'N' THEN ss.ss_quantity ELSE 0 END) AS quantity_sold_with_no_tv_promo FROM store_sales ss JOIN store s ON ss.ss_store_sk = s.s_store_sk JOIN promotion p ON ss.ss_promo_sk = p.p_promo_sk JOIN call_center cc ON s.s_market_id = cc.cc_mkt_id JOIN inventory i ON ss.ss_item_sk = i.inv_item_sk AND i.inv_date_sk = ss.ss_sold_date_sk WHERE ss.ss_sold_time_sk IN (63444, 44081, 71662, 70433) AND i.inv_item_sk IN (15889, 8930) AND i.inv_date_sk = 2450815 AND p.p_cost = 1000.00 AND cc.cc_sq_ft IN (795, 2268, 3514, 1138, 649) AND cc.cc_open_date_sk IN (2450806, 2450952) GROUP BY s.s_store_name ORDER BY total_net_paid DESC;
SELECT dd.d_year, dd.d_quarter_name, i.i_category, i.i_brand, COUNT(DISTINCT ws.web_site_sk) AS number_of_websites, COUNT(DISTINCT wp.wp_web_page_sk) AS number_of_web_pages, COUNT(DISTINCT wr.wr_order_number) AS number_of_returns, SUM(wr.wr_return_amt) AS total_return_amount, AVG(wr.wr_return_quantity) AS avg_return_quantity, AVG(wr.wr_fee) AS avg_return_fee, hd.hd_dep_count, ib.ib_lower_bound AS income_band_lower_bound, ib.ib_upper_bound AS income_band_upper_bound, SUM(hd.hd_vehicle_count) AS total_vehicles FROM web_returns wr JOIN date_dim dd ON wr.wr_returned_date_sk = dd.d_date_sk JOIN web_page wp ON wr.wr_web_page_sk = wp.wp_web_page_sk JOIN item i ON wr.wr_item_sk = i.i_item_sk JOIN web_site ws ON wp.wp_web_page_sk = ws.web_site_sk JOIN household_demographics hd ON wr.wr_returning_hdemo_sk = hd.hd_demo_sk JOIN income_band ib ON hd.hd_income_band_sk = ib.ib_income_band_sk WHERE dd.d_year = 2001 AND i.i_category_id IN (1, 2, 3) AND wr.wr_return_tax > 100 AND hd.hd_income_band_sk = 10 AND wr.wr_refunded_cash BETWEEN 300 AND 4000 GROUP BY dd.d_year, dd.d_quarter_name, i.i_category, i.i_brand, hd.hd_dep_count, ib.ib_lower_bound, ib.ib_upper_bound ORDER BY total_return_amount DESC, avg_return_quantity DESC, avg_return_fee DESC, number_of_websites, number_of_web_pages;
SELECT w_state, cd_education_status, SUM(inv_quantity_on_hand) AS total_inventory, AVG(sr_return_amt) AS avg_return_amount, COUNT(DISTINCT p_promo_sk) AS num_promotions, SUM(CASE WHEN wp_max_ad_count = 0 THEN 1 ELSE 0 END) AS num_pages_no_ads, AVG(cd_purchase_estimate) AS avg_purchase_estimate, SUM(sr_return_quantity) AS total_returned_quantity FROM warehouse w JOIN inventory i ON w.w_warehouse_sk = i.inv_warehouse_sk JOIN store_returns sr ON i.inv_item_sk = sr.sr_item_sk JOIN customer_demographics cd ON sr.sr_cdemo_sk = cd.cd_demo_sk JOIN promotion p ON p.p_item_sk = i.inv_item_sk JOIN web_page wp ON wp.wp_customer_sk = sr.sr_customer_sk WHERE w.w_gmt_offset = -5.00 AND w.w_zip = '35709' AND cd.cd_education_status IN ('4 yr Degree', 'Secondary', '2 yr Degree') AND sr.sr_cdemo_sk = 1839405 AND (wp.wp_max_ad_count = 3 OR wp.wp_max_ad_count = 0) AND wp.wp_rec_end_date = '2001-09-02' GROUP BY w_state, cd_education_status ORDER BY w_state, cd_education_status;
SELECT ws.web_name, ws.web_class, ws.web_manager, ws.web_market_manager, COUNT(DISTINCT wp.wp_web_page_sk) AS total_pages, AVG(wp.wp_char_count) AS avg_char_count, SUM(wp.wp_link_count) AS total_link_count, SUM(wp.wp_image_count) AS total_image_count, COUNT(DISTINCT wr.wr_order_number) AS total_returns, SUM(wr.wr_return_amt) AS total_return_amount, AVG(wr.wr_fee) AS avg_return_fee, COUNT(DISTINCT c.c_customer_sk) AS unique_customers, SUM(CASE WHEN c.c_preferred_cust_flag = 'Y' THEN 1 ELSE 0 END) AS preferred_customer_count FROM web_site ws LEFT JOIN web_page wp ON ws.web_site_sk = wp.wp_customer_sk LEFT JOIN web_returns wr ON wp.wp_web_page_sk = wr.wr_web_page_sk LEFT JOIN customer c ON wr.wr_returning_customer_sk = c.c_customer_sk GROUP BY ws.web_name, ws.web_class, ws.web_manager, ws.web_market_manager ORDER BY total_return_amount DESC, total_pages DESC LIMIT 100;
SELECT s.s_division_id, s.s_division_name, sm.sm_type, AVG(i.i_current_price) AS avg_item_price, COUNT(DISTINCT i.i_item_sk) AS total_items_sold, SUM(i.i_current_price) AS total_sales FROM item i JOIN store s ON i.i_manufact_id = s.s_store_sk JOIN ship_mode sm ON sm.sm_ship_mode_sk = s.s_store_sk WHERE i.i_item_id IN ('AAAAAAAABPCBAAAA', 'AAAAAAAAKEPAAAAA', 'AAAAAAAAHIBAAAAA') AND sm.sm_type IN ('EXPRESS', 'TWO DAY', 'NEXT DAY') AND sm.sm_ship_mode_id IN ('AAAAAAAALAAAAAAA', 'AAAAAAAAIAAAAAAA', 'AAAAAAAACBAAAAAA', 'AAAAAAAAFAAAAAAA', 'AAAAAAAABAAAAAAA') AND i.i_rec_start_date BETWEEN '1997-01-01' AND '2001-12-31' AND s.s_rec_start_date BETWEEN '1997-01-01' AND '2001-12-31' GROUP BY s.s_division_id, s.s_division_name, sm.sm_type ORDER BY s.s_division_id, sm.sm_type;
SELECT s_state, EXTRACT(YEAR FROM s_rec_start_date) AS year_opened, COUNT(*) AS store_count, SUM(ss_net_profit) AS total_net_profit, AVG(hd_dep_count) AS avg_dependency_count, SUM(sr_return_amt) AS total_return_amount, AVG(sr_return_amt) AS avg_return_amount, SUM(sr_net_loss) AS total_net_loss FROM store JOIN store_sales ON s_store_sk = ss_store_sk JOIN household_demographics ON ss_hdemo_sk = hd_demo_sk JOIN store_returns ON s_store_sk = sr_store_sk WHERE s_state IN ('CA', 'TX', 'FL') AND s_closed_date_sk IS NULL AND ss_sold_date_sk BETWEEN 2451189 AND 2451489 AND sr_return_tax > 0 AND hd_buy_potential IN ('>10000', '5001-10000', '1001-5000') GROUP BY s_state, year_opened ORDER BY total_net_profit DESC, total_return_amount DESC;
SELECT c.c_customer_id AS customer_id, CONCAT(c.c_last_name, ', ', c.c_first_name) AS customer_name, cd.cd_gender, cd.cd_marital_status, cd.cd_education_status, cd.cd_purchase_estimate, hd.hd_income_band_sk, hd.hd_buy_potential, COUNT(cr.cr_order_number) AS total_returns, SUM(cr.cr_return_quantity) AS total_returned_quantity, AVG(cr.cr_return_amount) AS avg_return_amount, SUM(cr.cr_return_amt_inc_tax) AS total_return_amount_inc_tax, SUM(cr.cr_net_loss) AS total_net_loss FROM customer c JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk JOIN catalog_returns cr ON c.c_customer_sk = cr.cr_returning_customer_sk WHERE c.c_first_sales_date_sk IN (2452027, 2451966, 2450163) AND cr.cr_returned_time_sk IN (66035, 17738, 73881) AND cr.cr_return_quantity = 49 GROUP BY customer_id, customer_name, cd.cd_gender, cd.cd_marital_status, cd.cd_education_status, cd.cd_purchase_estimate, hd.hd_income_band_sk, hd.hd_buy_potential ORDER BY total_returns DESC, total_returned_quantity DESC LIMIT 100;
SELECT p.p_promo_name, COUNT(DISTINCT sr.sr_customer_sk) AS number_of_customers, COUNT(sr.sr_ticket_number) AS number_of_returns, SUM(sr.sr_return_quantity) AS total_returned_quantity, SUM(sr.sr_return_amt) AS total_return_amount, AVG(hd.hd_vehicle_count) AS avg_vehicles_per_household, ib.ib_lower_bound AS income_band_lower_bound, ib.ib_upper_bound AS income_band_upper_bound, COUNT(DISTINCT cd.cd_demo_sk) AS number_of_unique_customers_demographics, SUM(CASE WHEN cd.cd_gender = 'M' THEN 1 ELSE 0 END) AS male_customer_count, SUM(CASE WHEN cd.cd_gender = 'F' THEN 1 ELSE 0 END) AS female_customer_count, SUM(CASE WHEN cd.cd_credit_rating = 'Low Risk' THEN 1 ELSE 0 END) AS low_risk_credit_customers, SUM(CASE WHEN cd.cd_credit_rating = 'High Risk' THEN 1 ELSE 0 END) AS high_risk_credit_customers FROM store_returns sr JOIN promotion p ON sr.sr_reason_sk = p.p_promo_sk AND p.p_channel_catalog = 'N' LEFT JOIN customer_demographics cd ON sr.sr_cdemo_sk = cd.cd_demo_sk LEFT JOIN household_demographics hd ON sr.sr_hdemo_sk = hd.hd_demo_sk LEFT JOIN income_band ib ON hd.hd_income_band_sk = ib.ib_income_band_sk WHERE p.p_purpose = 'Unknown' AND ib.ib_income_band_sk IN (19, 7, 13, 8, 15, 10) AND sr.sr_customer_sk IN (77634, 47097) AND cd.cd_credit_rating IN ('Low Risk', 'High Risk', 'Unknown') GROUP BY p.p_promo_name, ib.ib_lower_bound, ib.ib_upper_bound ORDER BY total_return_amount DESC;
SELECT d.d_holiday AS "Is Holiday", d.d_day_name AS "Day of Week", AVG(cc.cc_employees) AS "Average Number of Employees", AVG(w.w_warehouse_sq_ft) AS "Average Warehouse Square Feet", COUNT(DISTINCT cc.cc_call_center_sk) AS "Number of Call Centers", COUNT(DISTINCT w.w_warehouse_sk) AS "Number of Warehouses" FROM call_center cc JOIN date_dim d ON cc.cc_open_date_sk = d.d_date_sk OR cc.cc_closed_date_sk = d.d_date_sk JOIN warehouse w ON cc.cc_state = w.w_state GROUP BY d.d_holiday, d.d_day_name ORDER BY d.d_holiday DESC, d.d_day_name;
SELECT i_category, r_reason_desc, EXTRACT(YEAR FROM d_date) AS return_year, EXTRACT(MONTH FROM d_date) AS return_month, COUNT(DISTINCT cr_order_number) AS total_returns, SUM(cr_return_quantity) AS total_returned_quantity, AVG(cr_return_amount) AS average_return_amount, SUM(cr_net_loss) AS total_net_loss FROM catalog_returns cr JOIN item i ON cr.cr_item_sk = i.i_item_sk JOIN date_dim dd ON cr.cr_returned_date_sk = dd.d_date_sk JOIN reason r ON cr.cr_reason_sk = r.r_reason_sk WHERE dd.d_current_week = 'N' AND r.r_reason_desc IN ('reason 26', 'Did not get it on time', 'Did not like the make', 'reason 23', 'reason 24') GROUP BY i_category, r_reason_desc, return_year, return_month ORDER BY i_category, return_year, return_month, r_reason_desc;
SELECT dd.d_year, ca.ca_country, ca.ca_state, sm.sm_type, COUNT(DISTINCT hd.hd_demo_sk) AS number_of_households, AVG(hd.hd_vehicle_count) AS avg_vehicles_per_household, SUM(inv.inv_quantity_on_hand) AS total_inventory_on_hand FROM inventory inv JOIN date_dim dd ON inv.inv_date_sk = dd.d_date_sk JOIN customer_address ca ON inv.inv_warehouse_sk = ca.ca_address_sk JOIN household_demographics hd ON ca.ca_address_sk = hd.hd_demo_sk JOIN ship_mode sm ON sm.sm_ship_mode_sk = inv.inv_warehouse_sk WHERE dd.d_current_month = 'N' AND hd.hd_vehicle_count IN (0, 3) GROUP BY dd.d_year, ca.ca_country, ca.ca_state, sm.sm_type ORDER BY total_inventory_on_hand DESC, avg_vehicles_per_household DESC;
SELECT d.d_year, i.i_category, SUM(sr.sr_return_amt) AS total_return_amount, AVG(sr.sr_return_quantity) AS avg_return_quantity, COUNT(DISTINCT sr.sr_customer_sk) AS unique_customers, w.w_state, w.w_city FROM store_returns sr JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk JOIN item i ON sr.sr_item_sk = i.i_item_sk JOIN warehouse w ON sr.sr_addr_sk = w.w_warehouse_sk WHERE d.d_year = 2023 AND i.i_category_id BETWEEN 1 AND 100 AND w.w_suite_number IN ('Suite 80', 'Suite 0', 'Suite P', 'Suite 470') GROUP BY d.d_year, i.i_category, w.w_state, w.w_city ORDER BY total_return_amount DESC, avg_return_quantity DESC;
SELECT dd.d_year, dd.d_quarter_name, COUNT(DISTINCT c.c_customer_sk) AS total_customers, COUNT(DISTINCT sr.sr_store_sk) AS total_stores_with_returns, SUM(sr.sr_return_quantity) AS total_returned_quantity, AVG(sr.sr_return_amt) AS average_return_amount, SUM(sr.sr_return_amt) AS total_return_amount, SUM(sr.sr_fee) AS total_fees_collected, SUM(sr.sr_net_loss) AS total_net_loss FROM date_dim dd JOIN store_returns sr ON dd.d_date_sk = sr.sr_returned_date_sk JOIN store s ON sr.sr_store_sk = s.s_store_sk JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk WHERE dd.d_year IN (1909, 1903, 1901, 1907, 1911, 1900) AND dd.d_quarter_seq = 53 AND NOT EXISTS (SELECT 1 FROM promotion WHERE p_channel_tv = 'N' AND p_promo_sk = sr.sr_item_sk) GROUP BY dd.d_year, dd.d_quarter_name ORDER BY dd.d_year, dd.d_quarter_name;
SELECT ca.ca_state, COUNT(DISTINCT r.r_reason_sk) AS total_reasons_for_return, AVG(hd.hd_income_band_sk) AS avg_income_band, AVG(hd.hd_dep_count) AS avg_dependants FROM reason r JOIN customer_address ca ON ca.ca_address_sk = r.r_reason_sk JOIN household_demographics hd ON hd.hd_demo_sk = ca.ca_address_sk JOIN time_dim t ON t.t_time_sk = ca.ca_address_sk WHERE r.r_reason_desc IN ('Wrong size', 'Did not get it on time', 'unauthoized purchase', 'Did not like the make', 'No service location in my area') AND hd.hd_buy_potential = 'Y' AND t.t_shift = 'Evening' GROUP BY ca.ca_state ORDER BY total_reasons_for_return DESC, avg_income_band DESC, avg_dependants DESC;
SELECT ca_state, COUNT(DISTINCT ss_customer_sk) AS unique_customers, SUM(ss_quantity) AS total_quantity_sold, SUM(ss_net_paid) AS total_net_sales, AVG(ss_net_profit) AS avg_profit_per_sale, SUM(ss_net_paid_inc_tax) - SUM(ss_net_paid) AS total_tax_collected, web_company_name FROM store_sales JOIN customer_address ON store_sales.ss_addr_sk = customer_address.ca_address_sk JOIN web_site ON store_sales.ss_store_sk = web_site.web_site_sk WHERE web_site.web_company_id IN ('5', '1', '4', '6', '2') AND customer_address.ca_country = 'United States' AND EXTRACT(YEAR FROM CURRENT_DATE) - EXTRACT(YEAR FROM web_rec_start_date) <= 10 GROUP BY ca_state, web_company_name ORDER BY total_net_sales DESC, total_quantity_sold DESC;
SELECT cp.cp_department, i.i_category, i.i_brand, sm.sm_type, COUNT(DISTINCT cp.cp_catalog_page_sk) AS num_catalog_pages, COUNT(DISTINCT i.i_item_sk) AS num_items, AVG(i.i_current_price) AS avg_current_price, SUM(i.i_wholesale_cost) AS total_wholesale_cost, COUNT(DISTINCT t.t_time_sk) AS num_time_records, COUNT(DISTINCT sm.sm_ship_mode_sk) AS num_ship_modes FROM catalog_page cp JOIN item i ON cp.cp_catalog_page_sk = i.i_item_sk JOIN time_dim t ON cp.cp_start_date_sk = t.t_time_sk OR cp.cp_end_date_sk = t.t_time_sk JOIN ship_mode sm ON sm.sm_carrier = i.i_manufact WHERE i.i_category IN ('Shoes', 'Jewelry', 'Sports', 'Home', 'Electronics') GROUP BY cp.cp_department, i.i_category, i.i_brand, sm.sm_type ORDER BY num_catalog_pages DESC, num_items DESC;
SELECT i.i_category, COUNT(DISTINCT cs.cs_order_number) AS total_orders, SUM(cs.cs_quantity) AS total_items_sold, AVG(cs.cs_sales_price) AS avg_sales_price, SUM(wr.wr_return_quantity) AS total_items_returned, SUM(cs.cs_net_profit) AS total_net_profit FROM catalog_sales cs JOIN item i ON cs.cs_item_sk = i.i_item_sk JOIN customer_demographics cd ON cs.cs_bill_cdemo_sk = cd.cd_demo_sk LEFT JOIN web_returns wr ON cs.cs_order_number = wr.wr_order_number AND cs.cs_item_sk = wr.wr_item_sk WHERE cd.cd_purchase_estimate >= 10000 AND cd.cd_dep_employed_count = 0 GROUP BY i.i_category ORDER BY i.i_category;
SELECT ws.ws_item_sk, COUNT(DISTINCT ws.ws_order_number) AS total_orders, SUM(ws.ws_quantity) AS total_quantity_sold, AVG(ws.ws_ext_discount_amt) AS avg_discount_amt, AVG(ws.ws_sales_price) AS avg_sales_price, SUM(ws.ws_net_paid) AS total_net_paid, SUM(ws.ws_net_profit) AS total_net_profit, hd.hd_dep_count AS avg_dependents, hd.hd_vehicle_count AS avg_vehicles, s.s_store_name, s.s_city, s.s_state, SUM(inv.inv_quantity_on_hand) AS total_inventory_on_hand FROM web_sales ws JOIN household_demographics hd ON ws.ws_ship_hdemo_sk = hd.hd_demo_sk JOIN store s ON ws.ws_warehouse_sk = s.s_store_sk JOIN inventory inv ON (ws.ws_item_sk = inv.inv_item_sk AND ws.ws_warehouse_sk = inv.inv_warehouse_sk) WHERE ws.ws_ship_customer_sk IN ('14120', '70023', '31659', '86542') AND ws.ws_ship_addr_sk IN ('8368', '47705', '32703', '24892') AND inv.inv_date_sk = '2450815' AND hd.hd_vehicle_count IN (1, 0, 3, 2) AND s.s_number_employees IN (245, 271, 236, 218, 288, 278) GROUP BY ws.ws_item_sk, hd.hd_dep_count, hd.hd_vehicle_count, s.s_store_name, s.s_city, s.s_state ORDER BY total_net_paid DESC, total_orders DESC;
SELECT s.s_store_name, s.s_city, s.s_state, SUM(s.s_number_employees) AS total_employees, AVG(s.s_floor_space) AS average_floor_space, COUNT(DISTINCT cp.cp_catalog_page_sk) AS number_of_catalog_pages, SUM(CASE WHEN r.r_reason_id = 'AAAAAAAAMBAAAAAA' THEN 1 ELSE 0 END) AS count_mb_reason, SUM(CASE WHEN r.r_reason_id = 'AAAAAAAACAAAAAAA' THEN 1 ELSE 0 END) AS count_ca_reason, AVG(s.s_tax_precentage) AS average_tax_percentage FROM store s LEFT JOIN catalog_page cp ON (s.s_store_sk = cp.cp_catalog_number) LEFT JOIN reason r ON (r.r_reason_desc = cp.cp_description) WHERE s.s_street_type IN ('Boulevard', 'Court', 'Dr.', 'Circle') AND s.s_number_employees > 200 AND cp.cp_end_date_sk = '2451634' AND cp.cp_catalog_page_id IN ('AAAAAAAAFHPAAAAA', 'AAAAAAAAGPGAAAAA') GROUP BY s.s_store_name, s.s_city, s.s_state ORDER BY s.s_store_name;
SELECT w_state, i_category, SUM(i_current_price * inv_quantity_on_hand) AS total_value, AVG(i_current_price) AS average_price, COUNT(DISTINCT i_item_sk) AS unique_items_count, COUNT(DISTINCT w_warehouse_sk) AS warehouses_count FROM inventory INNER JOIN item ON inventory.inv_item_sk = item.i_item_sk INNER JOIN warehouse ON inventory.inv_warehouse_sk = warehouse.w_warehouse_sk GROUP BY w_state, i_category ORDER BY total_value DESC, average_price DESC;
SELECT cd.cd_education_status, ca.ca_state, AVG(ss.ss_sales_price) AS average_sales_price, SUM(ss.ss_net_profit) AS total_net_profit, COUNT(ss.ss_ticket_number) AS total_sales_transactions FROM store_sales ss JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk WHERE d.d_weekend = 'Y' AND d.d_year = 2022 GROUP BY cd.cd_education_status, ca.ca_state ORDER BY cd.cd_education_status, ca.ca_state;
SELECT cd.cd_gender, cd.cd_marital_status, cd.cd_education_status, cd.cd_credit_rating, COUNT(DISTINCT c.c_customer_sk) AS num_customers, AVG(cd.cd_purchase_estimate) AS avg_purchase_estimate, SUM(ss.ss_quantity) AS total_quantity_sold, SUM(ss.ss_net_paid_inc_tax) AS total_sales_with_tax, SUM(wr.wr_return_quantity) AS total_quantity_returned, SUM(wr.wr_return_amt_inc_tax) AS total_returns_with_tax, SUM(ss.ss_net_profit) - SUM(wr.wr_net_loss) AS net_profit FROM customer_demographics cd JOIN customer c ON cd.cd_demo_sk = c.c_current_cdemo_sk LEFT JOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk LEFT JOIN web_returns wr ON c.c_customer_sk = wr.wr_returning_customer_sk WHERE (ss.ss_sold_date_sk BETWEEN 20030101 AND 20031231 OR wr.wr_returned_date_sk BETWEEN 20030101 AND 20031231) GROUP BY cd.cd_gender, cd.cd_marital_status, cd.cd_education_status, cd.cd_credit_rating ORDER BY net_profit DESC;
SELECT p.p_promo_id, p.p_promo_name, COUNT(DISTINCT cs.cs_item_sk) AS number_of_items_sold, SUM(cs.cs_quantity) AS total_quantity_sold, AVG(cs.cs_sales_price) AS average_selling_price, SUM(cs.cs_ext_sales_price) AS total_sales_amount, SUM(cs.cs_ext_discount_amt) AS total_discount_amount, AVG((cs.cs_ext_discount_amt / cs.cs_ext_list_price) * 100) AS average_discount_percentage, SUM(cs.cs_net_profit) AS total_net_profit, AVG(inv.inv_quantity_on_hand) AS average_inventory_quantity_on_hand FROM catalog_sales cs JOIN promotion p ON cs.cs_promo_sk = p.p_promo_sk LEFT JOIN inventory inv ON cs.cs_item_sk = inv.inv_item_sk AND cs.cs_sold_date_sk = inv.inv_date_sk WHERE cs.cs_ext_list_price IN (8856.28, 4863.95, 651.00, 4727.68) GROUP BY p.p_promo_id, p.p_promo_name ORDER BY total_sales_amount DESC;
SELECT s.s_store_name, s.s_number_employees, AVG(ss.ss_sales_price) AS average_sale_amount, AVG(sr.sr_return_amt) AS average_return_amount, SUM(inv.inv_quantity_on_hand) AS total_inventory, COUNT(DISTINCT ss.ss_ticket_number) AS total_sales_transactions, COUNT(DISTINCT sr.sr_ticket_number) AS total_return_transactions FROM store s LEFT JOIN store_sales ss ON s.s_store_sk = ss.ss_store_sk LEFT JOIN store_returns sr ON s.s_store_sk = sr.sr_store_sk AND ss.ss_item_sk = sr.sr_item_sk LEFT JOIN inventory inv ON ss.ss_item_sk = inv.inv_item_sk AND s.s_store_sk = inv.inv_warehouse_sk WHERE (ss.ss_sold_date_sk IS NOT NULL OR sr.sr_returned_date_sk IS NOT NULL) AND (ss.ss_item_sk IN (14547, 403, 14095, 8557) OR sr.sr_item_sk IN (14547, 403, 14095, 8557)) AND EXISTS ( SELECT 1 FROM household_demographics hd WHERE (ss.ss_hdemo_sk = hd.hd_demo_sk OR sr.sr_hdemo_sk = hd.hd_demo_sk) AND hd.hd_dep_count = 1 ) GROUP BY s.s_store_name, s.s_number_employees ORDER BY s.s_store_name;
SELECT dd.d_year, dd.d_quarter_name, cc.cc_class, SUM(ss.ss_quantity) AS total_quantity_sold, AVG(ss.ss_sales_price) AS average_sales_price, SUM(ss.ss_net_paid) AS total_net_paid, SUM(ss.ss_net_paid_inc_tax) AS total_net_paid_inc_tax, SUM(ss.ss_net_profit) AS total_net_profit, COUNT(DISTINCT ss.ss_store_sk) AS number_of_stores, COUNT(DISTINCT w.w_warehouse_sk) AS number_of_warehouses FROM store_sales ss JOIN date_dim dd ON ss.ss_sold_date_sk = dd.d_date_sk JOIN call_center cc ON ss.ss_store_sk = cc.cc_open_date_sk JOIN warehouse w ON ss.ss_store_sk = w.w_warehouse_sk WHERE dd.d_fy_year IN ('1904', '1902', '1903', '1912', '1901', '1907') AND ss.ss_store_sk IN ('8', '4', '7', '10', '1', '2') AND cc.cc_open_date_sk IN ('2451063', '2450952', '2450806') AND cc.cc_suite_number IN ('Suite 0', 'Suite 70', 'Suite U') AND w.w_warehouse_name IN ('Important issues liv', 'Bad cards must make.', 'Conventional childr', 'Doors canno') GROUP BY dd.d_year, dd.d_quarter_name, cc.cc_class ORDER BY dd.d_year, dd.d_quarter_name, cc.cc_class;
SELECT d_year, sm_type, COUNT(DISTINCT cr_order_number) AS total_orders_returned, SUM(cr_return_amount) AS total_return_amount, AVG(cr_return_amount) AS avg_return_amount, SUM(cr_return_quantity) AS total_returned_quantity, COUNT(DISTINCT cr_refunded_customer_sk) AS unique_customers_refunded, COUNT(DISTINCT p_promo_sk) AS total_promotions_involved, ib_lower_bound, ib_upper_bound, COUNT(DISTINCT cr_item_sk) AS unique_items_returned FROM catalog_returns JOIN date_dim ON catalog_returns.cr_returned_date_sk = date_dim.d_date_sk JOIN ship_mode ON catalog_returns.cr_ship_mode_sk = ship_mode.sm_ship_mode_sk LEFT JOIN promotion ON catalog_returns.cr_item_sk = promotion.p_item_sk LEFT JOIN customer ON catalog_returns.cr_refunded_customer_sk = customer.c_customer_sk LEFT JOIN income_band ON customer.c_current_cdemo_sk = income_band.ib_income_band_sk WHERE date_dim.d_day_name IN ('Saturday', 'Wednesday', 'Monday', 'Sunday', 'Friday') AND date_dim.d_fy_week_seq IN (678, 348, 524, 575) AND ship_mode.sm_code IN ('BIKE', 'SURFACE') AND catalog_returns.cr_order_number IN ('5596', '4666', '2090', '4550', '3303') AND income_band.ib_lower_bound IN (150001, 10001, 100001) GROUP BY d_year, sm_type, ib_lower_bound, ib_upper_bound ORDER BY d_year DESC, sm_type, ib_lower_bound;
