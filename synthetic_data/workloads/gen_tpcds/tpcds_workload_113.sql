SELECT cc.cc_city AS call_center_city, cc.cc_state AS call_center_state, SUM(ws.ws_quantity) AS total_quantity_sold, AVG(ws.ws_sales_price) AS average_sales_price, COUNT(DISTINCT ws.ws_order_number) AS number_of_orders, SUM(inv.inv_quantity_on_hand) AS total_inventory_on_hand, SUM(ws.ws_net_profit) AS total_net_profit FROM call_center cc JOIN web_sales ws ON cc.cc_call_center_sk = ws.ws_warehouse_sk JOIN inventory inv ON ws.ws_item_sk = inv.inv_item_sk AND ws.ws_sold_date_sk = inv.inv_date_sk JOIN time_dim td ON ws.ws_sold_time_sk = td.t_time_sk WHERE cc.cc_mkt_id IN ('6', '2', '5') AND cc.cc_suite_number IN ('Suite 70', 'Suite 0', 'Suite U') AND inv.inv_quantity_on_hand IN (645, 327) AND td.t_time_sk IN (247, 1615, 1813, 4029, 3389) AND td.t_hour = 1 GROUP BY call_center_city, call_center_state ORDER BY total_net_profit DESC, call_center_city, call_center_state;
SELECT d_year, d_moy, sm_type, COUNT(DISTINCT cs_order_number) AS total_orders, SUM(cs_net_paid) AS total_revenue, SUM(cs_net_profit) AS total_profit, AVG(cs_quantity) AS average_quantity, AVG(cs_net_paid_inc_tax) AS average_revenue_inc_tax, SUM(cr_return_amount) AS total_return_amount, AVG(cr_return_quantity) AS average_return_quantity, COUNT(DISTINCT wp_web_page_sk) AS total_web_page_visits, COUNT(DISTINCT s_store_sk) AS total_stores, COUNT(DISTINCT cc_call_center_sk) AS total_call_centers FROM date_dim LEFT JOIN catalog_sales ON cs_sold_date_sk = d_date_sk LEFT JOIN ship_mode ON cs_ship_mode_sk = sm_ship_mode_sk LEFT JOIN catalog_returns ON cr_returned_date_sk = d_date_sk LEFT JOIN web_page ON wp_access_date_sk = d_date_sk LEFT JOIN store ON s_store_sk = cs_ship_customer_sk LEFT JOIN call_center ON cc_call_center_sk = cs_call_center_sk LEFT JOIN customer_demographics ON cs_ship_cdemo_sk = cd_demo_sk WHERE d_year = 2001 AND d_moy BETWEEN 1 AND 6 AND cs_net_paid IS NOT NULL AND sm_type IS NOT NULL AND (cc_sq_ft = '3514' OR cc_sq_ft = '4134' OR cc_sq_ft = '1138') AND (cc_rec_end_date = '2000-12-31' OR cc_rec_end_date = '2001-12-31' OR cc_rec_end_date = '2000-01-01') AND (cc_company = '6' OR cc_company = '3' OR cc_company = '1') AND (cr_return_ship_cost = '2.66' OR cr_return_ship_cost = '13.49' OR cr_return_ship_cost = '26.44') AND (cr_catalog_page_sk = '380' OR cr_catalog_page_sk = '219' OR cr_catalog_page_sk = '388') AND (cr_returned_time_sk = '45077' OR cr_returned_time_sk = '77627' OR cr_returned_time_sk = '32496') AND (sm_contract = '2mM8l' OR sm_contract = 'uukTktPYycct8' OR sm_contract = 'fop0bcSd91J26IVpR') AND (sm_ship_mode_sk = '10' OR sm_ship_mode_sk = '6' OR sm_ship_mode_sk = '4') AND (sm_code = 'SEA' OR sm_code = 'BIKE' OR sm_code = 'SURFACE') AND (sm_carrier = 'FEDEX' OR sm_carrier = 'ZHOU' OR sm_carrier = 'PRIVATECARRIER') AND (cs_ext_tax = '89.97' OR cs_ext_tax = '687.10' OR cs_ext_tax = '221.70') AND (cs_ship_hdemo_sk = '2057' OR cs_ship_hdemo_sk = '6324' OR cs_ship_hdemo_sk = '6945') AND (cs_net_paid_inc_ship_tax = '1307.73' OR cs_net_paid_inc_ship_tax = '1740.39' OR cs_net_paid_inc_ship_tax = '1487.69') AND (d_weekend = 'N' OR d_weekend = 'Y') AND (s_gmt_offset = '-5.00') AND (s_store_sk = '1' OR s_store_sk = '12' OR s_store_sk = '9') AND (s_store_name = 'anti' OR s_store_name = 'ese' OR s_store_name = 'eing') AND (wp_access_date_sk = '2452555' OR wp_access_date_sk = '2452645' OR wp_access_date_sk = '2452576') AND (wp_customer_sk = '20213' OR wp_customer_sk = '98376' OR wp_customer_sk = '60150') AND (wp_web_page_id = 'AAAAAAAAEDAAAAAA' OR wp_web_page_id = 'AAAAAAAAHDAAAAAA' OR wp_web_page_id = 'AAAAAAAAOAAAAAAA') AND (wp_web_page_sk = '3' OR wp_web_page_sk = '17' OR wp_web_page_sk = '36') AND (cd_demo_sk = '18975' OR cd_demo_sk = '21210' OR cd_demo_sk = '20876') AND (cd_dep_count = '2' OR cd_dep_count = '1') GROUP BY d_year, d_moy, sm_type ORDER BY d_year, d_moy, sm_type;
SELECT s.s_store_name, s.s_company_name, s.s_city, s.s_state, COUNT(DISTINCT w.w_warehouse_sk) AS total_warehouses, COUNT(DISTINCT c.cp_catalog_page_sk) AS total_catalog_pages, COUNT(DISTINCT wp.wp_web_page_sk) AS total_web_pages, AVG(s.s_floor_space) AS average_floor_space, SUM(s.s_number_employees) AS total_employees, AVG(s.s_tax_precentage) AS average_tax_percentage, COUNT(DISTINCT ca.ca_address_sk) FILTER (WHERE ca.ca_country = 'United States') AS total_us_customer_addresses, SUM(w.w_warehouse_sq_ft) AS total_warehouse_sq_ft FROM store s LEFT JOIN warehouse w ON s.s_zip = w.w_zip LEFT JOIN catalog_page c ON s.s_market_id = c.cp_catalog_number LEFT JOIN web_page wp ON wp.wp_type = 'bi-annual' LEFT JOIN customer_address ca ON s.s_state = ca.ca_state WHERE s.s_rec_end_date IS NULL AND c.cp_type IN ('quarterly', 'bi-annual') AND c.cp_start_date_sk NOT IN ('2451453', '2451270') AND wp.wp_web_page_sk IN ('52', '2', '42', '39', '10') AND wp.wp_autogen_flag = 'N' GROUP BY s.s_store_sk, s.s_store_name, s.s_company_name, s.s_city, s.s_state ORDER BY s.s_store_name, s.s_state;
SELECT dt.d_year, dt.d_quarter_name, COUNT(DISTINCT c.c_customer_sk) AS unique_customers, SUM(ss.ss_quantity) AS total_quantity_sold, AVG(ss.ss_sales_price) AS average_sales_price, SUM(ws.ws_net_paid_inc_tax) AS total_web_net_paid_inc_tax, cc.cc_city, AVG(hd.hd_dep_count) AS average_household_dependency_count, SUM(inv.inv_quantity_on_hand) AS total_inventory_on_hand FROM date_dim dt JOIN store_sales ss ON dt.d_date_sk = ss.ss_sold_date_sk JOIN web_sales ws ON dt.d_date_sk = ws.ws_sold_date_sk JOIN customer c ON (ss.ss_customer_sk = c.c_customer_sk OR ws.ws_bill_customer_sk = c.c_customer_sk) JOIN call_center cc ON (cc.cc_open_date_sk = dt.d_date_sk OR cc.cc_closed_date_sk = dt.d_date_sk) JOIN household_demographics hd ON (c.c_current_hdemo_sk = hd.hd_demo_sk OR ws.ws_bill_hdemo_sk = hd.hd_demo_sk) JOIN inventory inv ON dt.d_date_sk = inv.inv_date_sk WHERE dt.d_moy = 5 AND (dt.d_qoy = 1 OR dt.d_qoy = 2 OR dt.d_qoy = 3) AND (c.c_first_shipto_date_sk IN (2449442, 2451172, 2452404)) AND cc.cc_city = 'Midway' AND (ws.ws_item_sk IN (4, 103, 60)) AND (ws.ws_sales_price IN (38.82, 43.63, 82.62, 63.23)) GROUP BY dt.d_year, dt.d_quarter_name, cc.cc_city ORDER BY total_quantity_sold DESC, average_sales_price DESC, total_inventory_on_hand DESC, dt.d_year, dt.d_quarter_name;
SELECT s_store_id, s_state, s_city, COUNT(DISTINCT ss_ticket_number) AS num_transactions, SUM(ss_net_paid) AS total_sales, AVG(ss_sales_price) AS avg_sales_price, SUM(wr_return_amt_inc_tax) AS total_returns, COUNT(DISTINCT wr_order_number) AS num_returns, ARRAY_AGG(DISTINCT r_reason_desc) AS reasons_for_returns FROM store_sales AS ss JOIN store AS s ON ss.ss_store_sk = s.s_store_sk LEFT JOIN web_returns AS wr ON ss.ss_ticket_number = wr.wr_order_number LEFT JOIN reason AS r ON wr.wr_reason_sk = r.r_reason_sk JOIN date_dim AS dd ON ss.ss_sold_date_sk = dd.d_date_sk WHERE dd.d_quarter_seq = ( SELECT MAX(d_quarter_seq) FROM date_dim WHERE d_current_quarter = 'Y' ) AND s.s_state IN ('CA', 'TX', 'NY') GROUP BY s_store_id, s_state, s_city ORDER BY total_sales DESC, s_state, s_city;
SELECT w_state, cp_department, COUNT(DISTINCT cr_order_number) AS num_returns, SUM(cr_return_quantity) AS total_returned_qty, AVG(cr_return_amount) AS avg_return_amount, SUM(cr_return_amount) AS total_return_amount, SUM(cr_fee) AS total_fees, SUM(cr_return_ship_cost) AS total_shipping_cost, SUM(cr_net_loss) AS total_net_loss FROM catalog_returns JOIN catalog_page ON catalog_returns.cr_catalog_page_sk = catalog_page.cp_catalog_page_sk JOIN warehouse ON catalog_returns.cr_warehouse_sk = warehouse.w_warehouse_sk GROUP BY w_state, cp_department ORDER BY total_return_amount DESC, total_net_loss DESC LIMIT 10;
SELECT cp.cp_type, cp.cp_department, SUM(cs.cs_quantity) AS total_quantity_sold, AVG(cs.cs_sales_price) AS avg_sales_price, COUNT(DISTINCT cs.cs_order_number) AS unique_orders, SUM(sr.sr_return_quantity) AS total_return_quantity, AVG(sr.sr_return_amt) AS avg_return_amount, SUM(inv.inv_quantity_on_hand) AS total_inventory_on_hand, SUM(ss.ss_quantity) AS total_store_sales_quantity, AVG(ss.ss_net_paid) AS avg_net_paid_store_sales FROM catalog_page cp JOIN catalog_sales cs ON cp.cp_catalog_page_sk = cs.cs_catalog_page_sk LEFT JOIN store_returns sr ON cs.cs_item_sk = sr.sr_item_sk AND cs.cs_order_number = CAST(sr.sr_ticket_number AS integer) LEFT JOIN inventory inv ON cs.cs_item_sk = inv.inv_item_sk LEFT JOIN store_sales ss ON cs.cs_item_sk = ss.ss_item_sk AND cs.cs_order_number = CAST(ss.ss_ticket_number AS integer) WHERE cp.cp_catalog_number IN (36, 10, 1, 39, 15, 23) AND cp.cp_type IN ('quarterly', 'bi-annual', 'monthly') AND inv.inv_date_sk = 2450815 AND cs.cs_ship_date_sk = 2450901 AND cs.cs_list_price IN (127.89, 61.80, 132.26) GROUP BY cp.cp_type, cp.cp_department ORDER BY cp.cp_type, cp.cp_department;
SELECT d_year, i_category, SUM(inv_quantity_on_hand) AS total_inventory, AVG(i_current_price) AS avg_item_price, COUNT(DISTINCT inv_warehouse_sk) AS num_warehouses, SUM(wr_return_amt) AS total_return_amount, AVG(wr_return_ship_cost) AS avg_return_ship_cost, COUNT(DISTINCT wr_order_number) AS num_returns FROM inventory JOIN item ON inv_item_sk = i_item_sk JOIN date_dim ON inv_date_sk = d_date_sk LEFT JOIN web_returns ON wr_item_sk = i_item_sk AND wr_returned_date_sk = d_date_sk WHERE d_year = 2002 GROUP BY d_year, i_category ORDER BY total_inventory DESC, total_return_amount DESC LIMIT 10;
SELECT s_store_name, s_state, s_city, d_fy_year, ca_location_type, SUM(ss_quantity) AS total_items_sold, SUM(ss_net_paid) AS total_sales, AVG(ss_sales_price) AS average_sales_price, COUNT(DISTINCT ss_customer_sk) AS unique_customers, SUM(CASE WHEN d_holiday = 'Y' THEN ss_quantity ELSE 0 END) AS holiday_items_sold, SUM(CASE WHEN d_holiday = 'Y' THEN ss_net_paid ELSE 0 END) AS holiday_sales FROM store_sales JOIN store ON store.s_store_sk = store_sales.ss_store_sk JOIN date_dim ON date_dim.d_date_sk = store_sales.ss_sold_date_sk JOIN customer_address ON customer_address.ca_address_sk = store_sales.ss_addr_sk WHERE d_fy_year = (SELECT MAX(d_fy_year) FROM date_dim WHERE d_current_year = 'Y') AND store_sales.ss_list_price BETWEEN 51.03 AND 142.73 AND store_sales.ss_hdemo_sk IN ('3633', '6235', '1050') AND customer_address.ca_location_type IN ('single family', 'apartment') GROUP BY s_store_name, s_state, s_city, d_fy_year, ca_location_type ORDER BY total_sales DESC, s_store_name, s_state, s_city;
SELECT ca_state, cd_education_status, COUNT(DISTINCT c_customer_sk) AS total_customers, SUM(cd_purchase_estimate) AS total_purchase_estimate, AVG(cd_dep_count) AS average_dependents, SUM(CASE WHEN cd_gender = 'F' THEN 1 ELSE 0 END) AS female_customers, SUM(CASE WHEN cd_gender = 'M' THEN 1 ELSE 0 END) AS male_customers, COUNT(DISTINCT r_reason_sk) AS total_return_reasons, COUNT(DISTINCT i_item_sk) AS total_items_sold, SUM(inv_quantity_on_hand) AS total_inventory_quantity, AVG(i_current_price) AS average_item_price FROM customer c JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk JOIN inventory inv ON inv.inv_warehouse_sk = c.c_current_addr_sk JOIN item i ON i.i_item_sk = inv.inv_item_sk LEFT JOIN reason r ON r.r_reason_sk = inv.inv_warehouse_sk WHERE ca.ca_street_number IN ('470', '984', '743') AND cd_education_status IN ('College', 'Unknown', 'Advanced Degree', '2 yr Degree') AND cd_dep_employed_count = '0' AND ca_state IN (SELECT cc_state FROM call_center WHERE cc_street_name IN ('Center Hill', 'Pine Ridge', 'Ash Hill')) GROUP BY ca_state, cd_education_status ORDER BY total_customers DESC, total_purchase_estimate DESC;
SELECT s.s_store_name, s.s_city, s.s_state, SUM(s.s_number_employees) AS total_employees, AVG(s.s_floor_space) AS average_floor_space, COUNT(DISTINCT cp.cp_catalog_page_sk) AS number_of_catalog_pages, SUM(CASE WHEN r.r_reason_id = 'AAAAAAAAMBAAAAAA' THEN 1 ELSE 0 END) AS count_mb_reason, SUM(CASE WHEN r.r_reason_id = 'AAAAAAAACAAAAAAA' THEN 1 ELSE 0 END) AS count_ca_reason, AVG(s.s_tax_precentage) AS average_tax_percentage FROM store s LEFT JOIN catalog_page cp ON (s.s_store_sk = cp.cp_catalog_number) LEFT JOIN reason r ON (r.r_reason_desc = cp.cp_description) WHERE s.s_street_type IN ('Boulevard', 'Court', 'Dr.', 'Circle') AND s.s_number_employees > 200 AND cp.cp_end_date_sk = '2451634' AND cp.cp_catalog_page_id IN ('AAAAAAAAFHPAAAAA', 'AAAAAAAAGPGAAAAA') GROUP BY s.s_store_name, s.s_city, s.s_state ORDER BY s.s_store_name;
SELECT ws.web_site_id, ws.web_name, AVG(sr.sr_return_amt_inc_tax) AS avg_return_amount_inc_tax, SUM(sr.sr_return_quantity) AS total_return_quantity, SUM(sr.sr_net_loss) AS total_net_loss, COUNT(DISTINCT inv.inv_item_sk) AS number_of_distinct_items_in_inventory, AVG(inv.inv_quantity_on_hand) AS avg_quantity_on_hand_per_warehouse, COUNT(DISTINCT inv.inv_warehouse_sk) AS number_of_warehouses FROM web_site ws LEFT JOIN store_returns sr ON ws.web_site_sk = sr.sr_store_sk LEFT JOIN inventory inv ON sr.sr_item_sk = inv.inv_item_sk WHERE ws.web_street_number IN ('805', '887', '247', '671', '835') AND inv.inv_date_sk = 2450815 AND sr.sr_hdemo_sk IN ('2871', '5640') AND inv.inv_warehouse_sk IN ('1', '2') GROUP BY ws.web_site_id, ws.web_name ORDER BY avg_return_amount_inc_tax DESC, total_return_quantity DESC, total_net_loss DESC;
SELECT ca.ca_city, ca.ca_county, AVG(hd.hd_income_band_sk) AS avg_income_band, AVG(hd.hd_vehicle_count) AS avg_vehicle_count, COUNT(DISTINCT wp.wp_web_page_sk) AS num_web_pages_created, COUNT(DISTINCT wp.wp_access_date_sk) AS num_web_pages_accessed, AVG(wp.wp_char_count) AS avg_web_page_char_count FROM customer_address ca JOIN household_demographics hd ON ca.ca_address_sk = hd.hd_demo_sk LEFT JOIN web_page wp ON ca.ca_address_sk = wp.wp_customer_sk WHERE ca.ca_city IN ('Morgantown', 'Forestville', 'Sutton', 'Mount Olive', 'Texas', 'Bridgeport') AND ca.ca_county IN ('Carlton County', 'Bonneville County') AND wp.wp_type IN ('blog', 'article', 'product_review') AND wp.wp_autogen_flag = 'N' GROUP BY ca.ca_city, ca.ca_county ORDER BY ca.ca_city, ca.ca_county;
SELECT hd.hd_income_band_sk, sm.sm_type, COUNT(DISTINCT wr.wr_order_number) AS total_returns, SUM(wr.wr_return_quantity) AS total_returned_quantity, AVG(wr.wr_return_amt) AS avg_return_amount, SUM(wr.wr_return_amt) AS sum_return_amount, SUM(wr.wr_fee) AS sum_fees, SUM(wr.wr_return_ship_cost) AS sum_shipping_costs, SUM(wr.wr_net_loss) AS sum_net_loss FROM web_returns wr JOIN household_demographics hd ON wr.wr_refunded_hdemo_sk = hd.hd_demo_sk JOIN ship_mode sm ON sm.sm_ship_mode_sk = wr.wr_returned_time_sk GROUP BY hd.hd_income_band_sk, sm.sm_type ORDER BY sum_net_loss DESC;
SELECT s.s_city, sm.sm_type, COUNT(sr.sr_ticket_number) AS total_returns, SUM(sr.sr_return_quantity) AS total_returned_quantity, SUM(sr.sr_return_amt) AS total_returned_amount, AVG(sr.sr_return_amt) AS average_returned_amount, SUM(sr.sr_return_tax) AS total_returned_tax, SUM(sr.sr_fee) AS total_fees, SUM(sr.sr_net_loss) AS total_net_loss FROM store_returns sr JOIN store s ON sr.sr_store_sk = s.s_store_sk JOIN ship_mode sm ON sr.sr_reason_sk = sm.sm_ship_mode_sk WHERE s.s_city IN ('Midway', 'Fairview') AND sm.sm_type = 'LIBRARY' AND sr.sr_returned_date_sk BETWEEN 20180101 AND 20181231 GROUP BY s.s_city, sm.sm_type ORDER BY s.s_city, sm.sm_type;
SELECT hd.hd_dep_count AS number_of_dependents, hd.hd_vehicle_count AS number_of_vehicles, ca.ca_location_type AS customer_location_type, ca.ca_street_type AS street_type, t.t_am_pm AS return_time_period, COUNT(DISTINCT cr.cr_order_number) AS total_returned_orders, SUM(cr.cr_return_quantity) AS total_returned_quantity, AVG(cr.cr_return_amount) AS average_return_amount, SUM(cr.cr_net_loss) AS total_net_loss FROM catalog_returns cr JOIN household_demographics hd ON cr.cr_returning_hdemo_sk = hd.hd_demo_sk JOIN customer_address ca ON cr.cr_returning_addr_sk = ca.ca_address_sk JOIN time_dim t ON cr.cr_returned_time_sk = t.t_time_sk WHERE ca.ca_location_type IN ('single family', 'apartment', 'condo') AND ca.ca_street_type IN ('Boulevard', 'Ct.', 'Avenue', 'Way', 'Parkway', 'ST') AND t.t_am_pm = 'AM' GROUP BY hd.hd_dep_count, hd.hd_vehicle_count, ca.ca_location_type, ca.ca_street_type, t.t_am_pm ORDER BY total_net_loss DESC, average_return_amount DESC;
SELECT ca_state, ca_city, SUM(cs_net_paid_inc_tax) AS total_sales, AVG(cs_net_paid_inc_tax) AS avg_sales, COUNT(DISTINCT cs_order_number) AS num_sales_orders, SUM(cr_return_amt_inc_tax) AS total_returns, AVG(cr_return_amt_inc_tax) AS avg_returns, COUNT(DISTINCT cr_order_number) AS num_return_orders, SUM(cr_net_loss) AS total_net_loss FROM customer_address JOIN catalog_sales ON cs_bill_addr_sk = ca_address_sk LEFT JOIN catalog_returns ON cr_order_number = cs_order_number JOIN web_sales ON ws_order_number = cs_order_number JOIN time_dim ON ws_sold_time_sk = t_time_sk JOIN web_page ON ws_web_page_sk = wp_web_page_sk WHERE t_sub_shift = 'night' AND ws_ship_date_sk = 2450935 AND ws_web_page_sk IN (41, 3, 18, 4, 45) AND wp_creation_date_sk IN (2450810, 2450808, 2450812, 2450809) GROUP BY ca_state, ca_city ORDER BY ca_state, ca_city;
SELECT cc.cc_name, cc.cc_city, cc.cc_state, SUM(ss.ss_quantity) AS total_quantity_sold, AVG(ss.ss_sales_price) AS average_sales_price, COUNT(DISTINCT ss.ss_ticket_number) AS number_of_sales_transactions, SUM(wr.wr_return_quantity) AS total_quantity_returned, AVG(wr.wr_return_amt) AS average_return_amount, COUNT(DISTINCT wr.wr_order_number) AS number_of_return_transactions FROM call_center cc JOIN store_sales ss ON cc.cc_call_center_sk = ss.ss_store_sk JOIN web_returns wr ON ss.ss_item_sk = wr.wr_item_sk AND ss.ss_ticket_number = wr.wr_order_number WHERE cc.cc_mkt_class IN ('Silly particles could pro', 'Dealers make most historical, direct students', 'Wrong troops shall work sometimes in a opti', 'A bit narrow forms matter animals. Consist', 'More than other authori') AND cc.cc_sq_ft IN (795, 4134, 3514) AND wr.wr_refunded_addr_sk IN ('15506', '16033', '22303') AND ss.ss_item_sk IN (5893, 944) AND ss.ss_ticket_number IN (3473, 3634, 3530) GROUP BY cc.cc_name, cc.cc_city, cc.cc_state ORDER BY total_quantity_sold DESC, total_quantity_returned DESC;
SELECT d.d_year, d.d_quarter_name, cc.cc_city, cc.cc_state, SUM(wr.wr_return_quantity) AS total_returned_quantity, AVG(wr.wr_return_amt) AS avg_return_amount, COUNT(DISTINCT wr.wr_refunded_customer_sk) AS unique_customers, COUNT(DISTINCT wr.wr_order_number) AS total_orders_returned FROM web_returns wr JOIN date_dim d ON wr.wr_returned_date_sk = d.d_date_sk JOIN time_dim t ON wr.wr_returned_time_sk = t.t_time_sk JOIN call_center cc ON cc.cc_call_center_sk = wr.wr_returning_customer_sk WHERE d.d_year = 2023 AND t.t_sub_shift = 'night' AND cc.cc_city = 'Midway' AND wr.wr_returned_time_sk IN ('76162', '72121', '59518') GROUP BY d.d_year, d.d_quarter_name, cc.cc_city, cc.cc_state ORDER BY d.d_year, d.d_quarter_name, cc.cc_city, cc.cc_state;
SELECT sm.sm_ship_mode_id, sm.sm_type, sm.sm_carrier, COUNT(DISTINCT cr.cr_order_number) AS total_orders_returned, SUM(cr.cr_return_quantity) AS total_quantity_returned, AVG(cr.cr_return_amt_inc_tax) AS avg_refunded_amount_inc_tax, SUM(cr.cr_net_loss) AS total_net_loss FROM catalog_returns cr JOIN ship_mode sm ON cr.cr_ship_mode_sk = sm.sm_ship_mode_sk JOIN time_dim t ON cr.cr_returned_time_sk = t.t_time_sk JOIN date_dim d ON cr.cr_returned_date_sk = d.d_date_sk WHERE d.d_year = 2003 AND sm.sm_carrier IN ('HARMSTORF', 'TBS', 'ZOUROS', 'MSC', 'DIAMOND', 'AIRBORNE') GROUP BY sm.sm_ship_mode_id, sm.sm_type, sm.sm_carrier ORDER BY total_net_loss DESC;
SELECT p.p_promo_name, d_return.d_year AS return_year, d_return.d_quarter_name, COUNT(DISTINCT cr.cr_order_number) AS total_returns, SUM(cr.cr_return_quantity) AS total_returned_quantity, SUM(cr.cr_return_amount) AS total_returned_amount, AVG(cr.cr_return_amount) AS avg_return_amount, SUM(cr.cr_net_loss) AS total_net_loss FROM catalog_returns cr JOIN date_dim d_return ON cr.cr_returned_date_sk = d_return.d_date_sk JOIN promotion p ON cr.cr_item_sk = p.p_item_sk JOIN date_dim d_start ON p.p_start_date_sk = d_start.d_date_sk JOIN date_dim d_end ON p.p_end_date_sk = d_end.d_date_sk WHERE cr.cr_call_center_sk IN ('2', '4') AND cr.cr_reason_sk IN ('11', '25') AND d_return.d_current_week = 'N' AND p.p_channel_tv = 'N' AND p.p_channel_radio = 'N' AND d_return.d_date BETWEEN d_start.d_date AND d_end.d_date GROUP BY p.p_promo_name, return_year, d_return.d_quarter_name ORDER BY total_returned_amount DESC, total_returns DESC, return_year, d_return.d_quarter_name;
SELECT dd.d_year AS sale_year, dd.d_moy AS sale_month, dd.d_dom AS sale_day, COUNT(DISTINCT ss.ss_ticket_number) AS store_sales_count, SUM(ss.ss_quantity) AS store_items_sold, AVG(ss.ss_sales_price) AS avg_store_sale_price, SUM(cs.cs_net_paid_inc_tax) AS catalog_total_revenue_inc_tax, SUM(ws.ws_net_paid_inc_ship_tax) AS web_total_revenue_inc_ship_tax, AVG(cc.cc_employees) AS avg_call_center_employees, ws.ws_web_site_sk, web_site.web_name FROM store_sales ss JOIN date_dim dd ON ss.ss_sold_date_sk = dd.d_date_sk JOIN catalog_sales cs ON ss.ss_sold_date_sk = cs.cs_sold_date_sk JOIN web_sales ws ON ss.ss_sold_date_sk = ws.ws_sold_date_sk JOIN call_center cc ON cs.cs_call_center_sk = cc.cc_call_center_sk JOIN web_site ON ws.ws_web_site_sk = web_site.web_site_sk WHERE dd.d_year = 2000 AND ss.ss_list_price BETWEEN 100 AND 200 AND ws.ws_quantity IN (64, 84, 57) AND cc.cc_open_date_sk IS NOT NULL AND ws.ws_web_page_sk IN (211, 510, 171, 90, 132, 78) AND dd.d_last_dom IN ('2418669', '2418489', '2415993', '2419340', '2418000', '2417392') GROUP BY sale_year, sale_month, sale_day, ws.ws_web_site_sk, web_site.web_name ORDER BY sale_year, sale_month, sale_day, ws.ws_web_site_sk;
SELECT s.s_store_name, s.s_street_name, s.s_street_type, s.s_city, s.s_state, s.s_zip, SUM(sr.sr_return_amt_inc_tax) AS total_store_refunds, AVG(sr.sr_return_amt_inc_tax) AS avg_store_refund, COUNT(sr.sr_return_amt_inc_tax) AS num_store_returns, SUM(wr.wr_return_amt_inc_tax) AS total_web_refunds, AVG(wr.wr_return_amt_inc_tax) AS avg_web_refund, COUNT(wr.wr_return_amt_inc_tax) AS num_web_returns FROM store s LEFT JOIN store_returns sr ON s.s_store_sk = sr.sr_store_sk LEFT JOIN date_dim d_store ON sr.sr_returned_date_sk = d_store.d_date_sk LEFT JOIN web_returns wr ON s.s_store_sk = wr.wr_returning_customer_sk LEFT JOIN date_dim d_web ON wr.wr_returned_date_sk = d_web.d_date_sk WHERE s.s_street_type IN ('Road', 'Circle', 'Court') AND (d_store.d_quarter_name = '1906Q2' OR d_web.d_quarter_name = '1906Q2') GROUP BY s.s_store_name, s.s_street_name, s.s_street_type, s.s_city, s.s_state, s.s_zip ORDER BY total_store_refunds DESC, total_web_refunds DESC;
SELECT d.d_year AS year, d.d_month_seq AS month_sequence, COUNT(DISTINCT ss.ss_store_sk) AS num_stores, SUM(ss.ss_quantity) AS total_items_sold, SUM(ss.ss_net_paid_inc_tax) AS total_sales_inc_tax, AVG(ss.ss_ext_discount_amt) AS average_discount, SUM(cr.cr_return_amount) AS total_returns, AVG(cr.cr_fee) AS average_return_fee, COUNT(DISTINCT cr.cr_call_center_sk) FILTER (WHERE cc.cc_class = 'small') AS num_small_class_call_centers, COUNT(DISTINCT cr.cr_call_center_sk) FILTER (WHERE cc.cc_class = 'medium') AS num_medium_class_call_centers, COUNT(DISTINCT cr.cr_call_center_sk) FILTER (WHERE cc.cc_class = 'large') AS num_large_class_call_centers FROM store_sales ss JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk LEFT JOIN catalog_returns cr ON ss.ss_ticket_number = cr.cr_order_number LEFT JOIN call_center cc ON cr.cr_call_center_sk = cc.cc_call_center_sk WHERE d.d_month_seq IS NOT NULL AND ss.ss_store_sk IS NOT NULL GROUP BY year, month_sequence ORDER BY year, month_sequence;
SELECT ib.ib_income_band_sk, ib.ib_lower_bound, ib.ib_upper_bound, td.t_am_pm, AVG(ws.ws_sales_price) AS avg_sales_price, SUM(ws.ws_quantity) AS total_sales_quantity, SUM(wr.wr_return_quantity) AS total_return_quantity, SUM(wr.wr_net_loss) AS total_net_loss FROM web_sales ws JOIN household_demographics hd ON ws.ws_bill_hdemo_sk = hd.hd_demo_sk JOIN income_band ib ON hd.hd_income_band_sk = ib.ib_income_band_sk JOIN time_dim td ON ws.ws_sold_time_sk = td.t_time_sk LEFT JOIN web_returns wr ON ws.ws_order_number = wr.wr_order_number AND td.t_time_sk = wr.wr_returned_time_sk WHERE td.t_am_pm = 'AM' GROUP BY ib.ib_income_band_sk, ib.ib_lower_bound, ib.ib_upper_bound, td.t_am_pm ORDER BY ib.ib_income_band_sk, td.t_am_pm;
SELECT c.c_birth_year, c.c_birth_country, c.c_preferred_cust_flag, s.s_store_id, s.s_store_name, s.s_city, s.s_state, s.s_market_desc, COUNT(ws.ws_order_number) AS total_orders, SUM(ws.ws_quantity) AS total_quantity_sold, AVG(ws.ws_sales_price) AS average_sales_price, SUM(ws.ws_net_paid) AS total_net_paid, SUM(ws.ws_net_paid_inc_tax) AS total_net_paid_inc_tax, SUM(ws.ws_net_profit) AS total_net_profit FROM web_sales ws INNER JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk INNER JOIN store s ON ws.ws_ship_addr_sk = s.s_store_sk GROUP BY c.c_birth_year, c.c_birth_country, c.c_preferred_cust_flag, s.s_store_id, s.s_store_name, s.s_city, s.s_state, s.s_market_desc ORDER BY total_net_paid DESC, s.s_state, c.c_birth_year;
SELECT p_channel_dmail AS direct_mail, p_channel_email AS email, p_channel_catalog AS catalog, p_channel_tv AS tv, p_channel_radio AS radio, p_channel_press AS press, p_channel_event AS event, p_channel_demo AS demo, SUM(p_cost) AS total_promo_cost, COUNT(p_promo_sk) AS num_promotions, AVG(sr_return_amt_inc_tax) AS avg_return_amount_inc_tax, COUNT(sr_returned_date_sk) AS total_returns FROM promotion p LEFT JOIN store_returns sr ON p.p_item_sk = sr.sr_item_sk LEFT JOIN date_dim d1 ON p.p_start_date_sk = d1.d_date_sk LEFT JOIN date_dim d2 ON sr.sr_returned_date_sk = d2.d_date_sk LEFT JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk WHERE d1.d_fy_year = 1911 AND r.r_reason_sk IN ('15', '19', '29', '8') GROUP BY p_channel_dmail, p_channel_email, p_channel_catalog, p_channel_tv, p_channel_radio, p_channel_press, p_channel_event, p_channel_demo ORDER BY total_promo_cost DESC;
SELECT s.s_store_name, s.s_city, s.s_state, ib.ib_income_band_sk, ib.ib_lower_bound, ib.ib_upper_bound, COUNT(DISTINCT ws.ws_order_number) AS total_orders, SUM(ws.ws_quantity) AS total_quantity_sold, SUM(ws.ws_net_paid) AS total_net_paid, AVG(ws.ws_net_profit) AS average_net_profit, COUNT(DISTINCT cr.cr_order_number) AS total_returns, SUM(cr.cr_return_amount) AS total_return_amount, AVG(cd.cd_purchase_estimate) AS average_purchase_estimate, COUNT(DISTINCT wp.wp_web_page_sk) AS total_web_page_visits FROM store s JOIN web_sales ws ON s.s_store_sk = ws.ws_ship_addr_sk JOIN income_band ib ON ws.ws_bill_customer_sk = ib.ib_income_band_sk JOIN catalog_returns cr ON ws.ws_item_sk = cr.cr_item_sk AND ws.ws_order_number = cr.cr_order_number JOIN customer_demographics cd ON ws.ws_bill_cdemo_sk = cd.cd_demo_sk JOIN web_page wp ON ws.ws_web_page_sk = wp.wp_web_page_sk JOIN date_dim dd ON ws.ws_sold_date_sk = dd.d_date_sk WHERE ws.ws_ext_ship_cost IN (176.54, 380.00, 2131.08) AND ws.ws_ext_wholesale_cost IN (1606.13, 264.04, 476.93) AND ib.ib_income_band_sk IN (6, 20, 17) AND ib.ib_upper_bound IN (30000, 50000, 70000) AND s.s_city IN ('Fairview', 'Midway') AND s.s_market_manager IN ('Thomas Benton', 'Dustin Kelly', 'Dean Morrison') AND s.s_suite_number IN ('Suite 410', 'Suite 190', 'Suite 100') AND cr.cr_ship_mode_sk IN (5, 14, 16) AND cr.cr_item_sk IN (13561, 12757, 9220) AND cr.cr_returning_addr_sk IN (8108, 14295, 7472) AND dd.d_following_holiday IN ('N', 'Y') AND dd.d_dow IN (6, 2, 4) AND dd.d_current_year = 'N' AND wp.wp_access_date_sk IN (2452580, 2452611, 2452576) AND wp.wp_image_count IN (3, 7, 4) AND cd.cd_purchase_estimate IN (500, 2000, 3000) AND cd.cd_education_status IN ('4 yr Degree', 'Secondary', '2 yr Degree') AND cd.cd_dep_count IN (2, 1) GROUP BY s.s_store_name, s.s_city, s.s_state, ib.ib_income_band_sk, ib.ib_lower_bound, ib.ib_upper_bound ORDER BY total_net_paid DESC, average_net_profit DESC, total_web_page_visits DESC LIMIT 100;
