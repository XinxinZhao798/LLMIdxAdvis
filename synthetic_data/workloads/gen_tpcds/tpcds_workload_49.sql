SELECT i.i_category, i.i_class, cp.cp_department, w.w_state, p.p_channel_dmail, p.p_channel_email, AVG(i.i_wholesale_cost) AS avg_wholesale_cost, SUM(inv.inv_quantity_on_hand) AS total_quantity_on_hand, COUNT(DISTINCT p.p_promo_sk) AS num_promotions FROM item i JOIN catalog_page cp ON i.i_item_sk = cp.cp_catalog_page_sk JOIN inventory inv ON i.i_item_sk = inv.inv_item_sk JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk JOIN promotion p ON i.i_item_sk = p.p_item_sk WHERE w.w_state = 'TN' AND p.p_channel_dmail = 'Y' AND p.p_channel_email = 'Y' GROUP BY i.i_category, i.i_class, cp.cp_department, w.w_state, p.p_channel_dmail, p.p_channel_email HAVING AVG(i.i_wholesale_cost) > 0 ORDER BY avg_wholesale_cost DESC, total_quantity_on_hand DESC;
SELECT cp.cp_department, r.r_reason_desc, COUNT(DISTINCT cr.cr_order_number) AS total_returns, AVG(cr.cr_return_amount) AS avg_return_amount, SUM(cr.cr_return_amount) AS total_return_amount, AVG(cr.cr_return_quantity) AS avg_return_quantity, SUM(cr.cr_return_quantity) AS total_return_quantity, AVG(cr.cr_net_loss) AS avg_net_loss, SUM(cr.cr_net_loss) AS total_net_loss, AVG(ws.ws_net_paid_inc_ship_tax) AS avg_sale_amount_inc_ship_tax, SUM(ws.ws_net_paid_inc_ship_tax) AS total_sale_amount_inc_ship_tax FROM catalog_returns cr JOIN catalog_page cp ON cr.cr_catalog_page_sk = cp.cp_catalog_page_sk JOIN reason r ON cr.cr_reason_sk = r.r_reason_sk JOIN item i ON cr.cr_item_sk = i.i_item_sk JOIN web_sales ws ON cr.cr_item_sk = ws.ws_item_sk AND cr.cr_order_number = ws.ws_order_number JOIN household_demographics hd ON cr.cr_returning_hdemo_sk = hd.hd_demo_sk WHERE cp.cp_start_date_sk IS NOT NULL AND cp.cp_end_date_sk IS NOT NULL AND i.i_size IN ('large', 'petite', 'N/A') AND hd.hd_dep_count IN (6, 2, 0) AND hd.hd_income_band_sk IN (15, 14, 17, 18, 8) AND cr.cr_return_ship_cost IN (1215.68, 5.50, 311.58, 319.00, 3656.16, 1740.04) AND ws.ws_net_paid_inc_ship_tax = 1414.78 AND i.i_formulation IN ('ivory457370549352452', '77416linen1913860202', '32linen2899537977429', '61439655670steel4120') GROUP BY cp.cp_department, r.r_reason_desc ORDER BY total_return_amount DESC, avg_return_amount DESC, total_returns DESC;
SELECT cc.cc_call_center_id, cc.cc_name, cc.cc_city, cc.cc_state, SUM(inv.inv_quantity_on_hand) AS total_inventory, AVG(i.i_current_price) AS average_item_price, COUNT(DISTINCT c.cd_demo_sk) AS unique_customer_count, SUM(CASE WHEN t.t_shift = 'Morning' THEN 1 ELSE 0 END) AS morning_shifts, SUM(CASE WHEN t.t_shift = 'Evening' THEN 1 ELSE 0 END) AS evening_shifts FROM call_center cc JOIN inventory inv ON cc.cc_call_center_sk = inv.inv_warehouse_sk JOIN item i ON inv.inv_item_sk = i.i_item_sk JOIN customer_demographics c ON i.i_manager_id = c.cd_demo_sk JOIN time_dim t ON inv.inv_date_sk = t.t_time_sk WHERE cc.cc_tax_percentage IN (0.01, 0.05, 0.11, 0.12) AND i.i_category_id IN (7, 6, 2, 9, 5, 10) AND t.t_time_id IN ('AAAAAAAALICBAAAA', 'AAAAAAAALJJAAAAA', 'AAAAAAAAEMJAAAAA', 'AAAAAAAAAEBAAAAA') GROUP BY cc.cc_call_center_id, cc.cc_name, cc.cc_city, cc.cc_state ORDER BY total_inventory DESC, average_item_price DESC, unique_customer_count DESC LIMIT 100;
SELECT s.s_store_id, s.s_store_name, i.i_category, SUM(ss.ss_quantity) AS total_quantity_sold, AVG(ss.ss_sales_price) AS average_sales_price, SUM(ss.ss_net_paid) AS total_net_paid, SUM(ss.ss_net_profit) AS total_net_profit, COUNT(DISTINCT ss.ss_customer_sk) AS unique_customers, COUNT(DISTINCT ca.ca_address_sk) AS unique_addresses, SUM(ca.ca_gmt_offset) AS total_gmt_offset FROM store_sales ss JOIN store s ON ss.ss_store_sk = s.s_store_sk JOIN item i ON ss.ss_item_sk = i.i_item_sk JOIN customer_address ca ON ss.ss_addr_sk = ca.ca_address_sk WHERE s.s_suite_number = 'Suite 190' AND s.s_division_name <> 'Unknown' AND ca.ca_street_number IN ('142', '497', '990', '467') AND ss.ss_sold_date_sk IS NOT NULL GROUP BY s.s_store_id, s.s_store_name, i.i_category ORDER BY total_net_profit DESC, s.s_store_name, i.i_category;
SELECT cp_department, s_state, sm_type, COUNT(distinct cs_order_number) AS total_orders, SUM(cs_quantity) AS total_quantity, SUM(cs_net_paid) AS total_net_paid, AVG(cs_net_paid) AS avg_order_value, SUM(cs_net_profit) AS total_net_profit, COUNT(distinct hd_demo_sk) AS unique_customers, AVG(hd_vehicle_count) AS avg_vehicles_per_customer, AVG(hd_dep_count) AS avg_dependents_per_customer FROM catalog_sales JOIN catalog_page ON cs_catalog_page_sk = cp_catalog_page_sk JOIN store ON cs_bill_customer_sk = s_store_sk JOIN ship_mode ON cs_ship_mode_sk = sm_ship_mode_sk JOIN household_demographics ON cs_bill_hdemo_sk = hd_demo_sk WHERE cp_start_date_sk <= 2450822 AND cp_end_date_sk >= 2450822 AND s_state = 'TN' AND sm_contract IN ('hGoF18SLDDPBj', 'GNJr3g5i7oorKqtX') AND cs_sold_date_sk BETWEEN 2450815 AND 2450829 AND cs_quantity IN (35, 88, 62, 12, 76) GROUP BY cp_department, s_state, sm_type ORDER BY total_net_paid DESC, total_orders DESC;
SELECT cd.cd_purchase_estimate AS purchase_estimate, ib.ib_lower_bound AS income_band_lower_bound, ib.ib_upper_bound AS income_band_upper_bound, COUNT(DISTINCT wr.wr_order_number) AS total_returns, SUM(wr.wr_return_amt) AS total_returned_amount, AVG(wr.wr_return_amt) AS average_return_amount, AVG(wr.wr_fee) AS average_fee, AVG(wr.wr_net_loss) AS average_net_loss FROM web_returns wr INNER JOIN customer_demographics cd ON wr.wr_returning_cdemo_sk = cd.cd_demo_sk INNER JOIN income_band ib ON cd.cd_purchase_estimate BETWEEN ib.ib_lower_bound AND ib.ib_upper_bound WHERE wr.wr_return_quantity > 0 AND cd.cd_purchase_estimate IN (8500, 7000, 1000, 9000, 4500, 5500) AND ib.ib_lower_bound IN (70001, 90001, 180001) GROUP BY cd.cd_purchase_estimate, ib.ib_lower_bound, ib.ib_upper_bound ORDER BY total_returned_amount DESC;
SELECT s.s_state, COUNT(sr.sr_ticket_number) AS total_returns_count, SUM(sr.sr_return_amt) AS total_returns_amount, AVG(sr.sr_return_amt) AS average_return_amount, AVG(w.w_warehouse_sq_ft) AS average_warehouse_sq_footage FROM store s JOIN store_returns sr ON s.s_store_sk = sr.sr_store_sk LEFT JOIN warehouse w ON s.s_state = w.w_state WHERE s.s_closed_date_sk IS NULL GROUP BY s.s_state ORDER BY s.s_state;
SELECT cp.cp_department, COUNT(*) AS total_pages, AVG(wp.wp_link_count) AS average_link_count, SUM(wp.wp_image_count) AS total_image_count, COUNT(DISTINCT hd.hd_demo_sk) AS unique_households, AVG(hd.hd_vehicle_count) AS average_vehicle_count FROM catalog_page cp JOIN web_page wp ON cp.cp_catalog_page_sk = wp.wp_customer_sk JOIN household_demographics hd ON wp.wp_customer_sk = hd.hd_demo_sk WHERE cp.cp_catalog_number IN (29, 27, 21, 36) AND wp.wp_autogen_flag = 'Y' AND wp.wp_url LIKE 'http://www.foo.com%' GROUP BY cp.cp_department ORDER BY total_pages DESC, average_link_count DESC;
SELECT d_year, d_quarter_name, p_promo_name, COUNT(DISTINCT sr_ticket_number) AS total_returns, SUM(sr_return_quantity) AS total_returned_quantity, AVG(sr_return_amt) AS avg_return_amount, SUM(sr_return_amt_inc_tax) AS total_return_amount_inc_tax, SUM(sr_net_loss) AS total_net_loss, COUNT(DISTINCT sr_customer_sk) AS distinct_customers_returning, COUNT(DISTINCT sr_item_sk) AS distinct_items_returned FROM store_returns sr JOIN date_dim ON sr.sr_returned_date_sk = date_dim.d_date_sk JOIN promotion ON sr.sr_returned_date_sk BETWEEN promotion.p_start_date_sk AND promotion.p_end_date_sk WHERE d_year = 2000 AND promotion.p_channel_radio = 'N' AND promotion.p_discount_active = 'Y' GROUP BY d_year, d_quarter_name, p_promo_name ORDER BY d_year, d_quarter_name, p_promo_name;
SELECT item.i_category, item.i_class, reason.r_reason_desc, COUNT(DISTINCT catalog_returns.cr_order_number) AS total_catalog_returns, SUM(catalog_returns.cr_return_amount) AS total_catalog_return_amount, AVG(catalog_returns.cr_return_amount) AS avg_catalog_return_amount, SUM(catalog_returns.cr_return_tax) AS total_catalog_return_tax, COUNT(DISTINCT store_returns.sr_ticket_number) AS total_store_returns, SUM(store_returns.sr_return_amt) AS total_store_return_amount, AVG(store_returns.sr_return_amt) AS avg_store_return_amount, SUM(store_returns.sr_return_tax) AS total_store_return_tax FROM catalog_returns JOIN item ON catalog_returns.cr_item_sk = item.i_item_sk JOIN reason ON catalog_returns.cr_reason_sk = reason.r_reason_sk JOIN store_returns ON catalog_returns.cr_item_sk = store_returns.sr_item_sk WHERE item.i_category IN ('Children', 'Men', 'Shoes', 'Women', 'Home', 'Sports') AND item.i_class IN ('rings', 'camping', 'wallpaper') AND (catalog_returns.cr_returned_date_sk BETWEEN 88 AND 4202 OR store_returns.sr_returned_date_sk BETWEEN 88 AND 4202) GROUP BY item.i_category, item.i_class, reason.r_reason_desc ORDER BY item.i_category, item.i_class, reason.r_reason_desc;
SELECT d_year, i_category, COUNT(DISTINCT ss_ticket_number) AS total_sales_transactions, SUM(ss_quantity) AS total_quantity_sold, AVG(ss_sales_price) AS average_sales_price, SUM(ss_net_profit) AS total_net_profit, SUM(cr_return_amount) AS total_return_amount, COUNT(DISTINCT cr_order_number) AS total_return_transactions, (SUM(ss_net_profit) - SUM(cr_net_loss)) AS net_profit_after_returns FROM store_sales JOIN item ON store_sales.ss_item_sk = item.i_item_sk JOIN date_dim ON store_sales.ss_sold_date_sk = date_dim.d_date_sk LEFT JOIN catalog_returns ON store_sales.ss_item_sk = catalog_returns.cr_item_sk AND store_sales.ss_ticket_number = catalog_returns.cr_order_number WHERE store_sales.ss_addr_sk = '19253' AND d_year = 1999 GROUP BY d_year, i_category ORDER BY net_profit_after_returns DESC LIMIT 10;
SELECT cc.cc_name, ca.ca_state, sum(ss.ss_quantity) AS total_quantity_sold, avg(ss.ss_sales_price) AS average_sales_price, count(DISTINCT sr.sr_ticket_number) AS total_returns, sum(sr.sr_return_amt) AS total_return_amount, sum(sr.sr_fee) AS total_return_fees, sum(ws.ws_net_paid_inc_ship_tax) AS total_web_sales_incl_ship_tax, sum(ws.ws_net_profit) AS total_web_profit FROM call_center cc JOIN store_sales ss ON cc.cc_call_center_sk = ss.ss_store_sk JOIN store_returns sr ON ss.ss_ticket_number = sr.sr_ticket_number JOIN web_sales ws ON cc.cc_call_center_sk = ws.ws_warehouse_sk JOIN customer_address ca ON ss.ss_addr_sk = ca.ca_address_sk WHERE cc.cc_company IN ('1', '2', '3') AND sr.sr_return_ship_cost IN (174.24, 2574.09, 3006.72) AND ca.ca_state IN ('CA', 'TX', 'NY') GROUP BY cc.cc_name, ca.ca_state ORDER BY total_return_amount DESC, total_web_profit DESC LIMIT 100;
SELECT i_category, i_brand, ca_state, w_state, COUNT(DISTINCT i_item_sk) AS item_count, SUM(i_current_price) AS total_price, AVG(i_wholesale_cost) AS avg_wholesale_cost, SUM(i_current_price - i_wholesale_cost) AS total_profit, COUNT(DISTINCT ca_address_sk) AS customer_address_count, COUNT(DISTINCT w_warehouse_sk) AS warehouse_count FROM item JOIN customer_address ON i_manager_id = ca_address_sk JOIN warehouse ON i_manufact_id = w_warehouse_sk WHERE i_rec_start_date <= CURRENT_DATE AND (i_rec_end_date IS NULL OR i_rec_end_date > CURRENT_DATE) AND ca_city = 'Second 4th' AND w_street_name IN ('Wilson Elm', '6th', 'View First') GROUP BY i_category, i_brand, ca_state, w_state ORDER BY i_category, i_brand, ca_state, w_state;
