SELECT ws.web_class, ws.web_market_manager, SUM(cs.cs_quantity) AS total_quantity_sold, AVG(cs.cs_sales_price) AS average_sales_price, COUNT(DISTINCT cs.cs_order_number) AS number_of_orders, SUM(wr.wr_return_quantity) AS total_quantity_returned, SUM(wr.wr_net_loss) AS total_net_loss FROM catalog_sales cs JOIN web_returns wr ON cs.cs_item_sk = wr.wr_item_sk AND cs.cs_order_number = wr.wr_order_number JOIN web_site ws ON cs.cs_warehouse_sk = ws.web_site_sk WHERE cs.cs_sold_date_sk IS NOT NULL AND wr.wr_returned_date_sk IS NOT NULL AND ws.web_close_date_sk IN ('2447080', '2447148', '2448752', '2448854', '2448956', '2448820') AND ws.web_mkt_desc IN ('Concerned, royal weeks should announce.', 'Companies grow cells. Apart true eyes u', 'Formerly long minds deal aside parties. Lef', 'Political affairs ought to') GROUP BY ws.web_class, ws.web_market_manager ORDER BY total_quantity_sold DESC, total_net_loss ASC;
SELECT cpg.cp_department, it.i_category, SUM(cs.cs_quantity) AS total_quantity, AVG(cs.cs_sales_price) AS average_sales_price, COUNT(DISTINCT cs.cs_order_number) AS total_orders, SUM(cs.cs_net_profit) AS total_net_profit FROM catalog_sales cs JOIN item it ON cs.cs_item_sk = it.i_item_sk JOIN catalog_page cpg ON cs.cs_catalog_page_sk = cpg.cp_catalog_page_sk JOIN web_site ws ON cpg.cp_catalog_number = ws.web_mkt_id WHERE it.i_category_id IS NOT NULL AND cpg.cp_department IS NOT NULL AND ws.web_class <> 'Unknown' GROUP BY cpg.cp_department, it.i_category ORDER BY total_net_profit DESC, cpg.cp_department, it.i_category;
SELECT d_year, w_state AS warehouse_state, sm_type AS shipping_type, p_promo_name, COUNT(DISTINCT cc_call_center_sk) AS number_of_call_centers, SUM(inv_quantity_on_hand) AS total_inventory, AVG(w_warehouse_sq_ft) AS average_warehouse_size, MAX(p_cost) AS max_promotion_cost, MIN(p_cost) AS min_promotion_cost, AVG(p_cost) AS average_promotion_cost, SUM(CASE WHEN p_channel_demo = 'N' THEN p_cost ELSE 0 END) AS sum_cost_non_demo_promotions FROM date_dim JOIN inventory ON inv_date_sk = d_date_sk JOIN warehouse ON w_warehouse_sk = inv_warehouse_sk JOIN ship_mode ON w_zip = sm_ship_mode_id JOIN call_center ON cc_zip = w_zip LEFT JOIN promotion ON p_promo_sk = inv_item_sk WHERE d_year = 1998 AND w_warehouse_sq_ft IN (977787, 294242, 621234, 138504) AND w_zip = '35709' AND d_quarter_seq IN (24, 3) AND d_fy_week_seq IN (444, 401, 706, 517, 70) AND inv_item_sk IN (6008, 6322, 13964, 9541) AND p_channel_demo = 'N' GROUP BY d_year, warehouse_state, shipping_type, p_promo_name ORDER BY d_year, warehouse_state, shipping_type, p_promo_name;
SELECT i.i_category, ib.ib_income_band_sk, AVG(cs.cs_sales_price) AS avg_sales_price, SUM(cs.cs_net_paid_inc_ship_tax) AS total_sales, COUNT(DISTINCT cs.cs_order_number) AS total_orders, SUM(cr.cr_return_amount) AS total_returns, COUNT(DISTINCT cr.cr_order_number) AS total_return_orders FROM catalog_sales cs JOIN item i ON cs.cs_item_sk = i.i_item_sk JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk JOIN income_band ib ON c.c_current_cdemo_sk = ib.ib_income_band_sk LEFT JOIN catalog_returns cr ON cs.cs_order_number = cr.cr_order_number WHERE cs.cs_sold_date_sk IS NOT NULL AND ( ib.ib_lower_bound IN (110001, 190001, 30001) OR ib.ib_income_band_sk IN (1, 9, 3) ) GROUP BY i.i_category, ib.ib_income_band_sk ORDER BY total_sales DESC, total_returns DESC;
SELECT ca.ca_state AS customer_state, i.i_category AS item_category, SUM(cs.cs_sales_price) AS total_sales, AVG(cs.cs_quantity) AS average_quantity_sold, COUNT(cs.cs_order_number) AS total_orders, SUM(cs.cs_net_profit) AS total_net_profit FROM catalog_sales cs JOIN item i ON cs.cs_item_sk = i.i_item_sk JOIN customer_address ca ON cs.cs_ship_addr_sk = ca.ca_address_sk WHERE i.i_container <> 'Unknown' AND cs.cs_sold_date_sk IS NOT NULL AND ca.ca_country = 'United States' GROUP BY customer_state, item_category HAVING SUM(cs.cs_sales_price) > 10000 ORDER BY total_sales DESC, customer_state, item_category;
SELECT sm.sm_type, COUNT(DISTINCT cs.cs_order_number) AS total_orders, SUM(cs.cs_quantity) AS total_quantity, AVG(cs.cs_sales_price) AS avg_sales_price, SUM(cs.cs_net_paid) AS total_net_paid, SUM(cs.cs_net_paid_inc_ship) AS total_net_paid_inc_ship, SUM(cs.cs_net_paid_inc_tax) AS total_net_paid_inc_tax, SUM(cs.cs_net_paid_inc_ship_tax) AS total_net_paid_inc_ship_tax, SUM(cs.cs_net_profit) AS total_net_profit, SUM(inv.inv_quantity_on_hand) AS total_inventory_quantity, SUM(ss.ss_net_profit) AS total_store_sales_net_profit, SUM(wr.wr_net_loss) AS total_web_returns_net_loss FROM ship_mode sm LEFT JOIN catalog_sales cs ON sm.sm_ship_mode_sk = cs.cs_ship_mode_sk LEFT JOIN inventory inv ON cs.cs_item_sk = inv.inv_item_sk AND inv.inv_warehouse_sk IN (1, 2) LEFT JOIN store_sales ss ON cs.cs_item_sk = ss.ss_item_sk LEFT JOIN web_returns wr ON cs.cs_item_sk = wr.wr_item_sk WHERE inv.inv_item_sk = 10208 AND (cs.cs_coupon_amt = 849.23 OR cs.cs_coupon_amt = 20.08) AND cs.cs_order_number IN (99696, 116682, 86052, 116470, 78481) AND wr.wr_net_loss IN (31.29, 420.25, 714.73, 424.40, 381.09) GROUP BY sm.sm_type ORDER BY total_net_profit DESC;
SELECT i.i_category AS item_category, c.c_birth_month AS customer_birth_month, w.web_zip AS web_site_zip, COUNT(DISTINCT ws.ws_order_number) AS total_orders, SUM(ws.ws_net_paid) AS total_revenue, AVG(ws.ws_ext_discount_amt) AS average_discount, AVG(ws.ws_net_profit) AS average_profit FROM web_sales ws JOIN item i ON ws.ws_item_sk = i.i_item_sk JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk WHERE ws.ws_sold_date_sk BETWEEN 2450815 AND 2450915 AND i.i_item_sk IN (10310, 10207, 12818, 10796) AND w.web_zip IN ('35709', '31904') AND c.c_birth_month IN (3, 5) GROUP BY item_category, customer_birth_month, web_site_zip ORDER BY item_category, customer_birth_month, web_site_zip;
SELECT ib.ib_income_band_sk, cc.cc_division_name, AVG(wr.wr_return_amt_inc_tax) AS avg_return_amt_inc_tax, SUM(wr.wr_net_loss) AS total_net_loss, COUNT(wr.wr_returned_date_sk) AS total_returns, AVG(hd.hd_dep_count) AS avg_dependents, AVG(hd.hd_vehicle_count) AS avg_vehicles FROM web_returns wr JOIN household_demographics hd ON wr.wr_returning_hdemo_sk = hd.hd_demo_sk JOIN income_band ib ON hd.hd_income_band_sk = ib.ib_income_band_sk JOIN call_center cc ON cc.cc_country = 'United States' AND cc.cc_call_center_sk = wr.wr_refunded_addr_sk WHERE hd.hd_income_band_sk IN (20, 8, 18, 11, 19, 2) GROUP BY ib.ib_income_band_sk, cc.cc_division_name ORDER BY total_net_loss DESC, avg_return_amt_inc_tax DESC;
SELECT cc_state, r_reason_desc, SUM(inv_quantity_on_hand) AS total_inventory, AVG(c_birth_year) AS average_customer_birth_year, COUNT(DISTINCT c_customer_sk) AS unique_customers, COUNT(DISTINCT web_site_sk) AS web_sites_operating FROM inventory JOIN reason ON (r_reason_sk = inv_quantity_on_hand) JOIN call_center ON (cc_division = inv_warehouse_sk) JOIN customer ON (c_current_addr_sk = cc_open_date_sk) JOIN web_site ON (web_state = cc_state) WHERE inv_date_sk = 2450815 AND c_customer_id IN ('AAAAAAAACHMAAAAA', 'AAAAAAAANPEAAAAA') AND (cc_rec_end_date IS NULL OR cc_rec_end_date > CURRENT_DATE) AND (web_rec_end_date IS NULL OR web_rec_end_date > CURRENT_DATE) GROUP BY cc_state, r_reason_desc ORDER BY total_inventory DESC, average_customer_birth_year;
SELECT s.s_store_name, i.i_brand, i.i_category, dd.d_year, SUM(s.s_number_employees) AS total_number_employees, AVG(i.i_current_price) AS average_price, COUNT(DISTINCT h.hd_demo_sk) AS unique_household_count, SUM(CASE WHEN dd.d_holiday = 'Y' THEN 1 ELSE 0 END) AS holiday_count, SUM(CASE WHEN dd.d_weekend = 'Y' THEN 1 ELSE 0 END) AS weekend_count FROM store s JOIN item i ON s.s_store_sk = i.i_manufact_id JOIN date_dim dd ON s.s_closed_date_sk = dd.d_date_sk JOIN household_demographics h ON h.hd_income_band_sk = s.s_market_id JOIN time_dim t ON t.t_time_sk = dd.d_date_sk WHERE s.s_store_sk IN (11, 9, 5, 3) AND i.i_item_id IN ('AAAAAAAAGPIAAAAA', 'AAAAAAAAOFKAAAAA', 'AAAAAAAAKJEAAAAA', 'AAAAAAAAMLJAAAAA', 'AAAAAAAANPCBAAAA', 'AAAAAAAAEBGAAAAA') AND i.i_brand_id IN (6004005, 7004007) AND dd.d_current_year = 'N' AND dd.d_last_dom IN (2418367, 2415812, 2418122) AND t.t_hour IN (1, 0) GROUP BY s.s_store_name, i.i_brand, i.i_category, dd.d_year;
SELECT d_year, d_quarter_name, cc_name, SUM(cs_quantity) AS total_quantity_sold, SUM(cs_net_paid) AS total_net_paid, AVG(cs_net_profit) AS average_net_profit, COUNT(DISTINCT cs_order_number) AS number_of_orders, SUM(ws_quantity) AS total_web_quantity_sold, SUM(ws_net_paid) AS total_web_net_paid, AVG(ws_net_profit) AS average_web_net_profit, COUNT(DISTINCT ws_order_number) AS number_of_web_orders, SUM(cr_return_quantity) AS total_return_quantity, SUM(cr_return_amount) AS total_return_amount, AVG(cr_net_loss) AS average_net_loss, COUNT(DISTINCT cr_order_number) AS number_of_returns FROM date_dim JOIN catalog_sales ON cs_sold_date_sk = d_date_sk JOIN web_sales ON ws_sold_date_sk = d_date_sk JOIN catalog_returns ON cr_returned_date_sk = d_date_sk JOIN call_center ON cs_call_center_sk = cc_call_center_sk WHERE d_fy_year IN ('1910', '1903', '1905', '1900') AND (cs_net_paid_inc_ship_tax IN ('289.42', '1479.37') OR ws_net_paid_inc_ship_tax IN ('3079.90', '243.98', '3911.52')) GROUP BY d_year, d_quarter_name, cc_name ORDER BY d_year, d_quarter_name, cc_name;
SELECT cp.cp_department, AVG(cr.cr_return_amount) AS avg_return_amount, SUM(cr.cr_return_amount) AS total_return_amount, COUNT(cr.cr_return_amount) AS num_returns, AVG(cs.cs_sales_price) AS avg_sales_price, SUM(cs.cs_sales_price) AS total_sales, COUNT(cs.cs_sales_price) AS num_sales, ca.ca_state, COUNT(DISTINCT ca.ca_city) AS num_cities FROM catalog_page cp JOIN catalog_sales cs ON cp.cp_catalog_page_sk = cs.cs_catalog_page_sk JOIN catalog_returns cr ON cp.cp_catalog_page_sk = cr.cr_catalog_page_sk JOIN customer_address ca ON cs.cs_ship_addr_sk = ca.ca_address_sk WHERE cp.cp_catalog_number IN (29, 40) AND cr.cr_refunded_cdemo_sk = 1173022 GROUP BY cp.cp_department, ca.ca_state ORDER BY total_return_amount DESC, total_sales DESC;
SELECT dd.d_year, dd.d_quarter_name, ca.ca_state, COUNT(DISTINCT ws.ws_order_number) AS total_orders, SUM(ws.ws_quantity) AS total_quantity, SUM(ws.ws_net_paid) AS total_net_paid, AVG(ws.ws_sales_price) AS average_sales_price, SUM(ws.ws_net_profit) AS total_net_profit FROM web_sales ws JOIN date_dim dd ON ws.ws_sold_date_sk = dd.d_date_sk JOIN customer_address ca ON ws.ws_bill_addr_sk = ca.ca_address_sk WHERE dd.d_year = 2002 AND ca.ca_country = 'United States' AND ws.ws_net_paid_inc_ship_tax > 1000 GROUP BY dd.d_year, dd.d_quarter_name, ca.ca_state ORDER BY dd.d_year, dd.d_quarter_name, ca.ca_state;
