SELECT t_shift AS shift_period, promotion_summary.channel, COUNT(*) AS promotion_count, SUM(promotion_summary.total_cost) AS total_promotion_cost, AVG(promotion_summary.p_response_target) AS average_response_target, SUM(web_returns_summary.return_quantity) AS total_return_quantity, SUM(web_returns_summary.return_amount) AS total_return_amount, SUM(web_returns_summary.return_amount_inc_tax) AS total_return_amount_inc_tax, AVG(web_returns_summary.fee) AS average_fee, SUM(web_returns_summary.net_loss) AS total_net_loss FROM (SELECT p_promo_sk, p_start_date_sk, p_end_date_sk, p_item_sk, CASE WHEN p_channel_dmail = 'Y' THEN 'Direct Mail' WHEN p_channel_email = 'Y' THEN 'Email' WHEN p_channel_catalog = 'Y' THEN 'Catalog' WHEN p_channel_tv = 'Y' THEN 'TV' WHEN p_channel_radio = 'Y' THEN 'Radio' WHEN p_channel_press = 'Y' THEN 'Press' WHEN p_channel_event = 'Y' THEN 'Event' WHEN p_channel_demo = 'Y' THEN 'Demo' ELSE 'Other' END AS channel, p_cost AS total_cost, p_response_target FROM promotion WHERE p_discount_active = 'Y' ) AS promotion_summary JOIN time_dim ON (promotion_summary.p_start_date_sk = time_dim.t_time_sk OR promotion_summary.p_end_date_sk = time_dim.t_time_sk) LEFT JOIN (SELECT wr_returned_date_sk, wr_returned_time_sk, wr_item_sk, SUM(wr_return_quantity) AS return_quantity, SUM(wr_return_amt) AS return_amount, SUM(wr_return_amt_inc_tax) AS return_amount_inc_tax, AVG(wr_fee) AS fee, SUM(wr_net_loss) AS net_loss FROM web_returns GROUP BY wr_returned_date_sk, wr_returned_time_sk, wr_item_sk ) AS web_returns_summary ON promotion_summary.p_item_sk = web_returns_summary.wr_item_sk GROUP BY shift_period, promotion_summary.channel ORDER BY total_promotion_cost DESC, shift_period;
SELECT c.ca_country, c.ca_city, i.i_category_id, i.i_category, ib.ib_income_band_sk, ib.ib_lower_bound, ib.ib_upper_bound, SUM(ss.ss_quantity) AS total_quantity_sold, SUM(ss.ss_net_paid) AS total_sales, AVG(ss.ss_net_paid) AS average_sales, COUNT(DISTINCT ss.ss_customer_sk) AS unique_customers, SUM(cr.cr_return_quantity) AS total_quantity_returned, SUM(cr.cr_return_amount) AS total_return_amount, AVG(cr.cr_return_amount) AS average_return_amount, COUNT(DISTINCT cr.cr_returning_customer_sk) AS unique_customers_returned FROM store_sales ss JOIN item i ON ss.ss_item_sk = i.i_item_sk JOIN income_band ib ON ss.ss_hdemo_sk = ib.ib_income_band_sk JOIN customer_address c ON ss.ss_addr_sk = c.ca_address_sk LEFT JOIN catalog_returns cr ON cr.cr_order_number = ss.ss_ticket_number WHERE c.ca_country = 'United States' AND (c.ca_city = 'Gravel Hill' OR c.ca_city = 'Montague') AND (ib.ib_income_band_sk IN (1, 6, 19)) AND (ss.ss_cdemo_sk IN (854925, 898884, 94461)) GROUP BY c.ca_country, c.ca_city, i.i_category_id, i.i_category, ib.ib_income_band_sk, ib.ib_lower_bound, ib.ib_upper_bound ORDER BY total_sales DESC, i.i_category_id;
SELECT w.web_class AS website_category, ca.ca_state AS customer_state, COUNT(ws.ws_order_number) AS total_orders, SUM(ws.ws_net_paid_inc_ship_tax) AS total_sales, AVG(ws.ws_ext_discount_amt) AS avg_discount_amount, AVG(ws.ws_net_profit) AS avg_net_profit FROM web_sales ws JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk JOIN customer_address ca ON ws.ws_ship_addr_sk = ca.ca_address_sk WHERE ws.ws_net_paid_inc_ship BETWEEN 500 AND 9500 GROUP BY ROLLUP(website_category, customer_state) ORDER BY total_sales DESC, website_category, customer_state;
SELECT i.i_category, i.i_brand, COUNT(DISTINCT ss.ss_ticket_number) AS total_sales_transactions, SUM(ss.ss_quantity) AS total_quantity_sold, AVG(ss.ss_sales_price) AS average_sales_price, AVG(ss.ss_ext_discount_amt) AS average_discount_amount, SUM(ss.ss_net_paid) AS total_net_sales, SUM(ss.ss_net_paid_inc_tax) AS total_net_sales_including_tax, SUM(ss.ss_net_profit) AS total_net_profit, COUNT(DISTINCT p.p_promo_sk) AS number_of_promotions FROM store_sales ss JOIN item i ON ss.ss_item_sk = i.i_item_sk JOIN promotion p ON ss.ss_promo_sk = p.p_promo_sk WHERE p.p_discount_active = 'Y' AND p.p_start_date_sk IS NOT NULL AND p.p_end_date_sk IS NOT NULL GROUP BY i.i_category, i.i_brand ORDER BY total_net_sales DESC, i.i_category, i.i_brand;
SELECT cc.cc_state, cc.cc_city, cc.cc_name, AVG(ss.ss_net_profit) AS avg_net_profit, SUM(ss.ss_quantity) AS total_quantity_sold, COUNT(DISTINCT ss.ss_store_sk) AS number_of_stores, COUNT(DISTINCT ss.ss_ticket_number) AS number_of_sales_transactions, SUM(cc.cc_employees) AS total_employees_in_call_centers, AVG(cc.cc_tax_percentage) AS avg_tax_percentage_by_state FROM store_sales ss JOIN call_center cc ON ss.ss_store_sk = cc.cc_call_center_sk JOIN time_dim td ON ss.ss_sold_time_sk = td.t_time_sk WHERE ss.ss_sold_date_sk IN (SELECT inv_date_sk FROM inventory WHERE inv_quantity_on_hand IN (816, 142, 984)) AND cc.cc_tax_percentage IN (0.01, 0.12, 0.05, 0.11) AND ss.ss_net_profit IN (5.76, 45.76, 66.12, -885.72, -4074.40) AND ss.ss_hdemo_sk IN (7132, 594, 6065, 5700) GROUP BY cc.cc_state, cc.cc_city, cc.cc_name ORDER BY avg_net_profit DESC;
SELECT i.i_category AS item_category, SUM(ws.ws_quantity) AS total_quantity_sold, AVG(ws.ws_sales_price) AS average_sales_price, SUM(ws.ws_net_paid) AS total_net_paid, SUM(ws.ws_net_profit) AS total_net_profit, COUNT(DISTINCT ws.ws_order_number) AS number_of_orders, COUNT(DISTINCT h.hd_demo_sk) AS number_of_customers_by_demographics, sm.sm_type AS shipping_type, AVG(inv.inv_quantity_on_hand) AS average_inventory_on_hand FROM web_sales ws JOIN item i ON ws.ws_item_sk = i.i_item_sk JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk JOIN inventory inv ON i.i_item_sk = inv.inv_item_sk JOIN household_demographics h ON ws.ws_bill_hdemo_sk = h.hd_demo_sk WHERE i.i_category_id BETWEEN 1 AND 5 AND ws.ws_ship_mode_sk IN (6, 4, 18, 1, 5, 8) AND inv.inv_warehouse_sk IN (1, 2) AND h.hd_income_band_sk IN (20, 11, 4) GROUP BY i.i_category, sm.sm_type ORDER BY total_net_profit DESC, item_category;
SELECT s.s_store_name, SUM(ss.ss_quantity) AS total_quantity_sold, AVG(ss.ss_sales_price) AS average_sales_price, SUM(ss.ss_net_paid) AS total_net_paid, SUM(ss.ss_net_paid_inc_tax) AS total_net_paid_inc_tax, AVG(ss.ss_net_profit) AS average_net_profit, COUNT(DISTINCT p.p_promo_sk) AS number_of_promotions_run, SUM(CASE WHEN p.p_channel_tv = 'N' THEN ss.ss_quantity ELSE 0 END) AS quantity_sold_with_no_tv_promo FROM store_sales ss JOIN store s ON ss.ss_store_sk = s.s_store_sk JOIN promotion p ON ss.ss_promo_sk = p.p_promo_sk JOIN call_center cc ON s.s_market_id = cc.cc_mkt_id JOIN inventory i ON ss.ss_item_sk = i.inv_item_sk AND i.inv_date_sk = ss.ss_sold_date_sk WHERE ss.ss_sold_time_sk IN (63444, 44081, 71662, 70433) AND i.inv_item_sk IN (15889, 8930) AND i.inv_date_sk = 2450815 AND p.p_cost = 1000.00 AND cc.cc_sq_ft IN (795, 2268, 3514, 1138, 649) AND cc.cc_open_date_sk IN (2450806, 2450952) GROUP BY s.s_store_name ORDER BY total_net_paid DESC;
SELECT ca.ca_state, SUM(ss.ss_quantity) AS total_quantity_sold, AVG(ss.ss_sales_price) AS avg_sales_price, SUM(ss.ss_net_paid) AS total_net_paid, SUM(ss.ss_net_profit) AS total_net_profit, COUNT(DISTINCT ss.ss_ticket_number) AS total_sales_transactions, SUM(CASE WHEN p.p_channel_event = 'N' THEN ss.ss_quantity ELSE 0 END) AS quantity_sold_no_event_channel, SUM(CASE WHEN p.p_channel_email = 'N' THEN ss.ss_quantity ELSE 0 END) AS quantity_sold_no_email_channel, COUNT(DISTINCT i.inv_warehouse_sk) AS distinct_warehouses_stocked, AVG(i.inv_quantity_on_hand) AS avg_quantity_on_hand FROM store_sales ss JOIN customer_address ca ON ss.ss_addr_sk = ca.ca_address_sk LEFT JOIN promotion p ON ss.ss_promo_sk = p.p_promo_sk LEFT JOIN inventory i ON ss.ss_item_sk = i.inv_item_sk WHERE i.inv_warehouse_sk IN (1, 2) AND i.inv_date_sk = 2450815 GROUP BY ca.ca_state ORDER BY total_net_profit DESC, ca.ca_state;
SELECT cpg.cp_department, it.i_category, SUM(cs.cs_quantity) AS total_quantity, AVG(cs.cs_sales_price) AS average_sales_price, COUNT(DISTINCT cs.cs_order_number) AS total_orders, SUM(cs.cs_net_profit) AS total_net_profit FROM catalog_sales cs JOIN item it ON cs.cs_item_sk = it.i_item_sk JOIN catalog_page cpg ON cs.cs_catalog_page_sk = cpg.cp_catalog_page_sk JOIN web_site ws ON cpg.cp_catalog_number = ws.web_mkt_id WHERE it.i_category_id IS NOT NULL AND cpg.cp_department IS NOT NULL AND ws.web_class <> 'Unknown' GROUP BY cpg.cp_department, it.i_category ORDER BY total_net_profit DESC, cpg.cp_department, it.i_category;
SELECT c.c_birth_country, COUNT(DISTINCT c.c_customer_sk) AS total_customers, AVG(w.w_warehouse_sq_ft) AS avg_warehouse_sq_ft FROM customer c JOIN warehouse w ON c.c_birth_country = w.w_country GROUP BY c.c_birth_country ORDER BY total_customers DESC, avg_warehouse_sq_ft DESC;
