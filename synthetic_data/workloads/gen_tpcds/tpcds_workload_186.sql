SELECT p.p_promo_name AS promotion_name, ib.ib_lower_bound AS income_band_lower_bound, ib.ib_upper_bound AS income_band_upper_bound, SUM(ss.ss_quantity) AS total_quantity_sold, SUM(ss.ss_ext_sales_price) AS total_sales, SUM(ss.ss_ext_discount_amt) AS total_discount_amount, AVG(ss.ss_sales_price) AS average_sales_price, COUNT(DISTINCT ss.ss_customer_sk) AS distinct_customers, SUM(CASE WHEN ss.ss_sales_price < ss.ss_list_price THEN 1 ELSE 0 END) AS count_discounted_sales FROM store_sales ss JOIN promotion p ON ss.ss_promo_sk = p.p_promo_sk JOIN income_band ib ON ss.ss_cdemo_sk = ib.ib_income_band_sk JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk WHERE p.p_discount_active = 'N' AND d.d_year IN (1901, 1903, 1906, 1908) AND ss.ss_ext_sales_price IN (2209.06, 2248.08) AND ib.ib_lower_bound IN (0, 90001, 170001, 120001, 50001) AND ib.ib_upper_bound = 160000 GROUP BY p.p_promo_name, ib.ib_lower_bound, ib.ib_upper_bound ORDER BY total_sales DESC, promotion_name, income_band_lower_bound, income_band_upper_bound;
SELECT i.i_category AS category, p.p_channel_dmail AS promo_direct_mail, p.p_channel_email AS promo_email, p.p_channel_catalog AS promo_catalog, COUNT(DISTINCT i.i_item_sk) AS total_items, SUM(ws.ws_quantity) AS total_quantity_sold, AVG(ws.ws_sales_price) AS average_sales_price, SUM(ws.ws_net_paid) AS total_net_paid, SUM(ws.ws_net_profit) AS total_net_profit FROM web_sales ws JOIN item i ON ws.ws_item_sk = i.i_item_sk JOIN promotion p ON ws.ws_promo_sk = p.p_promo_sk GROUP BY i.i_category, p.p_channel_dmail, p.p_channel_email, p.p_channel_catalog ORDER BY total_net_profit DESC, total_quantity_sold DESC;
SELECT sm.sm_type, w.w_county, w.w_warehouse_sq_ft, ca.ca_street_type, cd.cd_credit_rating, cd.cd_purchase_estimate, COUNT(DISTINCT cp.cp_catalog_page_sk) AS num_catalog_pages, SUM(inv.inv_quantity_on_hand) AS total_inventory, AVG(cd.cd_dep_employed_count) AS avg_employed_dependents, COUNT(DISTINCT ca.ca_address_sk) AS num_customer_addresses FROM ship_mode sm JOIN warehouse w ON sm.sm_ship_mode_sk = w.w_warehouse_sk JOIN inventory inv ON w.w_warehouse_sk = inv.inv_warehouse_sk JOIN customer_address ca ON w.w_state = ca.ca_state JOIN customer_demographics cd ON ca.ca_address_sk = cd.cd_demo_sk JOIN catalog_page cp ON cp.cp_department = w.w_county WHERE sm.sm_type IN ('OVERNIGHT', 'LIBRARY', 'NEXT DAY') AND sm.sm_contract IN ('OrDuVy2H', 'I3uCelXtjP', 'Ek') AND w.w_zip = '35709' AND w.w_county = 'Williamson County' AND w.w_warehouse_sq_ft IN ('138504', '294242', '977787') AND ca.ca_street_type IN ('Road', 'Way', 'Ct.') AND ca.ca_address_id IN ('AAAAAAAAOPNAAAAA', 'AAAAAAAAJEDAAAAA', 'AAAAAAAAGEGAAAAA') AND cd.cd_credit_rating IN ('Good', 'High Risk', 'Unknown') AND cd.cd_dep_employed_count = '0' AND cd.cd_purchase_estimate IN ('9000', '5500', '3500') AND cd.cd_demo_sk IN ('20710', '17420', '21031') AND cp.cp_catalog_page_sk IN ('767', '3436', '3795') AND cp.cp_catalog_number IN ('15', '25', '21') AND cp.cp_catalog_page_number IN ('101', '57', '25') AND inv.inv_item_sk IN ('6955', '13411', '10159') AND inv.inv_warehouse_sk IN ('2', '1') GROUP BY sm.sm_type, w.w_county, w.w_warehouse_sq_ft, ca.ca_street_type, cd.cd_credit_rating, cd.cd_purchase_estimate ORDER BY total_inventory DESC, num_catalog_pages DESC, avg_employed_dependents DESC, num_customer_addresses DESC;
SELECT i.i_category, i.i_brand, ca.ca_state, ca.ca_city, SUM(sr.sr_return_amt) AS total_return_amount, AVG(i.i_current_price) AS average_item_price, COUNT(DISTINCT sr.sr_ticket_number) AS total_returns, SUM(CASE WHEN p.p_promo_sk IS NOT NULL THEN sr.sr_return_quantity ELSE 0 END) AS promo_return_quantity, SUM(CASE WHEN p.p_promo_sk IS NULL THEN sr.sr_return_quantity ELSE 0 END) AS no_promo_return_quantity FROM store_returns sr JOIN item i ON sr.sr_item_sk = i.i_item_sk LEFT JOIN promotion p ON i.i_item_sk = p.p_item_sk JOIN customer_address ca ON sr.sr_addr_sk = ca.ca_address_sk WHERE i.i_category_id IN ('4', '2') AND i.i_container <> 'Unknown' GROUP BY i.i_category, i.i_brand, ca.ca_state, ca.ca_city ORDER BY total_return_amount DESC, average_item_price DESC, total_returns DESC;
SELECT ws.web_site_id, ws.web_name, AVG(sr.sr_return_amt_inc_tax) AS avg_return_amount_inc_tax, SUM(sr.sr_return_quantity) AS total_return_quantity, SUM(sr.sr_net_loss) AS total_net_loss, COUNT(DISTINCT inv.inv_item_sk) AS number_of_distinct_items_in_inventory, AVG(inv.inv_quantity_on_hand) AS avg_quantity_on_hand_per_warehouse, COUNT(DISTINCT inv.inv_warehouse_sk) AS number_of_warehouses FROM web_site ws LEFT JOIN store_returns sr ON ws.web_site_sk = sr.sr_store_sk LEFT JOIN inventory inv ON sr.sr_item_sk = inv.inv_item_sk WHERE ws.web_street_number IN ('805', '887', '247', '671', '835') AND inv.inv_date_sk = 2450815 AND sr.sr_hdemo_sk IN ('2871', '5640') AND inv.inv_warehouse_sk IN ('1', '2') GROUP BY ws.web_site_id, ws.web_name ORDER BY avg_return_amount_inc_tax DESC, total_return_quantity DESC, total_net_loss DESC;
SELECT c.c_last_name, c.c_first_name, c.c_email_address, SUM(ss.ss_net_paid) AS total_sales, AVG(ss.ss_quantity) AS avg_quantity_sold, COUNT(DISTINCT ss.ss_ticket_number) AS number_of_transactions, SUM(wr.wr_fee) AS total_return_fees, AVG(wr.wr_return_quantity) AS avg_return_quantity, COUNT(DISTINCT wr.wr_order_number) AS number_of_returns, r.r_reason_desc AS most_common_return_reason FROM store_sales ss JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk LEFT JOIN web_returns wr ON wr.wr_returning_customer_sk = c.c_customer_sk LEFT JOIN reason r ON wr.wr_reason_sk = r.r_reason_sk WHERE c.c_birth_day IN (12, 23, 14, 10, 22, 11) AND r.r_reason_desc IN ('Wrong size', 'unauthoized purchase', 'reason 32') GROUP BY c.c_last_name, c.c_first_name, c.c_email_address, r.r_reason_desc ORDER BY total_sales DESC, total_return_fees DESC;
SELECT ca_state, w_city, wp_type, SUM(cs_net_paid) as total_catalog_sales, AVG(ws_net_paid_inc_ship_tax) as avg_web_sales_inc_ship_tax, COUNT(DISTINCT ws_web_page_sk) as distinct_web_pages_accessed, COUNT(DISTINCT sr_reason_sk) as count_distinct_return_reasons, SUM(sr_return_amt) as total_return_amount, MIN(cs_sales_price) as min_catalog_sales_price, MAX(ws_sales_price) as max_web_sales_price FROM customer_address JOIN catalog_sales ON ca_address_sk = cs_ship_addr_sk JOIN web_sales ON ca_address_sk = ws_bill_addr_sk JOIN warehouse ON cs_warehouse_sk = w_warehouse_sk JOIN web_page ON ws_web_page_sk = wp_web_page_sk LEFT JOIN store_returns ON sr_addr_sk = ca_address_sk WHERE w_city = 'Fairview' AND wp_type IN ('feedback', 'dynamic', 'protected', 'welcome', 'general') AND ws_web_site_sk IN ('22', '17', '24', '18', '2') AND cs_ship_customer_sk IN ('47431', '33123', '91253') GROUP BY ca_state, w_city, wp_type ORDER BY total_catalog_sales DESC, avg_web_sales_inc_ship_tax DESC;
SELECT s.s_store_name, COUNT(DISTINCT ss.ss_ticket_number) AS total_sales_transactions, SUM(ss.ss_quantity) AS total_items_sold, AVG(ss.ss_sales_price) AS average_sales_price, SUM(ss.ss_ext_discount_amt) AS total_discount_amount, SUM(ss.ss_net_paid) AS total_net_sales, SUM(ss.ss_net_paid_inc_tax) AS net_sales_including_tax, SUM(ss.ss_net_profit) AS total_net_profit, COUNT(DISTINCT wr.wr_order_number) AS total_returns_transactions, SUM(wr.wr_return_quantity) AS total_items_returned, AVG(wr.wr_return_amt) AS average_return_amount, SUM(wr.wr_fee) AS total_return_fees, SUM(wr.wr_net_loss) AS total_net_loss FROM store s JOIN store_sales ss ON s.s_store_sk = ss.ss_store_sk LEFT JOIN web_returns wr ON ss.ss_item_sk = wr.wr_item_sk AND ss.ss_ticket_number = wr.wr_order_number WHERE s.s_county = 'Williamson County' AND ss.ss_coupon_amt IN (215.60, 1007.22, 1869.51) GROUP BY s.s_store_name ORDER BY s.s_store_name;
SELECT s.s_store_name, ca.ca_city, cd.cd_marital_status, SUM(ss.ss_quantity) AS total_quantity_sold, AVG(ss.ss_sales_price) AS average_sales_price, COUNT(DISTINCT ss.ss_customer_sk) AS unique_customers, SUM(cr.cr_return_quantity) AS total_quantity_returned, AVG(cr.cr_return_amount) AS average_return_amount, SUM(cr.cr_fee) AS total_return_fees, SUM(cr.cr_store_credit) AS total_store_credit_issued FROM store_sales ss JOIN store s ON ss.ss_store_sk = s.s_store_sk JOIN customer_address ca ON ss.ss_addr_sk = ca.ca_address_sk JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk LEFT JOIN catalog_returns cr ON ss.ss_item_sk = cr.cr_item_sk AND ss.ss_ticket_number = cr.cr_order_number WHERE s.s_company_id = '1' AND s.s_number_employees IN ('271', '297', '218') AND cr.cr_fee IN ('1.88', '20.33', '98.78') AND cr.cr_store_credit IN ('209.99', '238.11', '154.49') AND cr.cr_returning_addr_sk IN ('12346', '30572', '1273') AND ca.ca_street_number IN ('667', '111', '746') AND ca.ca_street_type IN ('Street', 'Dr.', 'Way') AND ca.ca_street_name IN ('Maple 5th', 'Walnut Lee', 'Ash Oak') AND ca.ca_city IN ('Fairview', 'Calhoun', 'Sullivan') AND cd.cd_purchase_estimate IN ('8500', '5000', '6500') AND cd.cd_marital_status IN ('U', 'M', 'D') AND ss.ss_hdemo_sk IN ('2140', '4187', '6514') AND ss.ss_ticket_number IN ('3439', '3527', '3698') GROUP BY s.s_store_name, ca.ca_city, cd.cd_marital_status ORDER BY total_quantity_sold DESC, average_sales_price DESC, unique_customers DESC, total_quantity_returned DESC, average_return_amount DESC, total_return_fees DESC, total_store_credit_issued DESC;
SELECT c.cc_call_center_id AS call_center, c.cc_name AS call_center_name, c.cc_manager AS call_center_manager, i.i_manufact_id AS manufacturer_id, COUNT(ws.ws_order_number) AS total_orders, SUM(ws.ws_quantity) AS total_quantity_sold, AVG(ws.ws_sales_price) AS average_sales_price, SUM(ws.ws_net_profit) AS total_net_profit FROM call_center c JOIN web_sales ws ON c.cc_call_center_sk = ws.ws_warehouse_sk JOIN item i ON ws.ws_item_sk = i.i_item_sk JOIN customer_demographics cd ON ws.ws_bill_cdemo_sk = cd.cd_demo_sk JOIN date_dim dd ON ws.ws_sold_date_sk = dd.d_date_sk WHERE i.i_manufact_id IN (275, 862, 397) AND c.cc_open_date_sk <= dd.d_date_sk AND (c.cc_rec_end_date IS NULL OR c.cc_rec_end_date >= dd.d_date) GROUP BY c.cc_call_center_id, c.cc_name, c.cc_manager, i.i_manufact_id ORDER BY total_net_profit DESC;
SELECT i_category, w_state, COUNT(DISTINCT ws_order_number) AS web_sales_orders, SUM(ws_net_paid) AS total_web_sales_revenue, AVG(ws_quantity) AS avg_web_sales_quantity, SUM(sr_return_amt) AS total_store_returns, AVG(sr_return_quantity) AS avg_store_return_quantity, COUNT(DISTINCT sr_ticket_number) AS store_return_tickets, SUM(cr_return_amount) AS total_catalog_returns, AVG(cr_return_quantity) AS avg_catalog_return_quantity, COUNT(DISTINCT cr_order_number) AS catalog_return_orders FROM web_sales ws JOIN item i ON ws.ws_item_sk = i.i_item_sk JOIN warehouse w ON ws.ws_warehouse_sk = w.w_warehouse_sk LEFT JOIN store_returns sr ON ws.ws_item_sk = sr.sr_item_sk AND ws.ws_order_number = sr.sr_ticket_number LEFT JOIN catalog_returns cr ON ws.ws_item_sk = cr.cr_item_sk AND ws.ws_order_number = cr.cr_order_number WHERE ws.ws_sold_date_sk BETWEEN 20000101 AND 20001231 AND ws.ws_ext_list_price IN ('3366.00', '12.38', '298.41') AND EXISTS ( SELECT 1 FROM inventory WHERE ws.ws_item_sk = inv_item_sk AND inv_warehouse_sk = ws.ws_warehouse_sk AND inv_date_sk BETWEEN 20000101 AND 20001231 AND inv_quantity_on_hand > 0 ) GROUP BY i_category, w_state ORDER BY i_category, w_state;
SELECT cd.cd_gender, cd.cd_marital_status, td.t_shift, COUNT(DISTINCT ss.ss_ticket_number) AS total_sales_transactions, SUM(ss.ss_quantity) AS total_units_sold, SUM(ss.ss_net_paid) AS total_revenue, AVG(ss.ss_net_paid) AS average_revenue_per_transaction, SUM(CASE WHEN p.p_channel_dmail = 'Y' THEN 1 ELSE 0 END) AS total_dmail_promotions, SUM(CASE WHEN p.p_channel_email = 'Y' THEN 1 ELSE 0 END) AS total_email_promotions, SUM(CASE WHEN p.p_channel_tv = 'Y' THEN 1 ELSE 0 END) AS total_tv_promotions FROM store_sales ss JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk JOIN time_dim td ON ss.ss_sold_time_sk = td.t_time_sk LEFT JOIN promotion p ON ss.ss_promo_sk = p.p_promo_sk WHERE ss.ss_hdemo_sk IN ('4855', '5486') GROUP BY cd.cd_gender, cd.cd_marital_status, td.t_shift ORDER BY total_revenue DESC, total_units_sold DESC;
SELECT s.s_store_name, s.s_division_name, c.cc_name, c.cc_manager, hd.hd_buy_potential, COUNT(sr.sr_ticket_number) AS total_returns, SUM(sr.sr_return_amt_inc_tax) AS total_return_amount_inc_tax, AVG(sr.sr_return_quantity) AS avg_return_quantity, SUM(wr.wr_return_amt_inc_tax) AS total_web_return_amount_inc_tax, AVG(wr.wr_return_quantity) AS avg_web_return_quantity, COUNT(DISTINCT cu.c_customer_sk) AS unique_customers_returning, SUM(hd.hd_dep_count) AS total_dependents, AVG(hd.hd_vehicle_count) AS avg_vehicles_per_household FROM store s JOIN store_returns sr ON sr.sr_store_sk = s.s_store_sk JOIN call_center c ON c.cc_mkt_id = s.s_market_id JOIN customer cu ON cu.c_customer_sk = sr.sr_customer_sk JOIN household_demographics hd ON cu.c_current_hdemo_sk = hd.hd_demo_sk JOIN web_returns wr ON wr.wr_returning_customer_sk = cu.c_customer_sk WHERE c.cc_manager IN ('Bob Belcher', 'Felipe Perkins', 'Larry Mccray', 'Mark Hightower') AND hd.hd_buy_potential IN ('501-1000', '>10000', 'Unknown') AND s.s_division_name = 'Unknown' AND wr.wr_returning_hdemo_sk IN (2871, 6633, 6615, 4553) GROUP BY s.s_store_name, s.s_division_name, c.cc_name, c.cc_manager, hd.hd_buy_potential ORDER BY total_return_amount_inc_tax DESC, total_web_return_amount_inc_tax DESC LIMIT 100;
SELECT c.c_customer_id, c.c_email_address, hd.hd_buy_potential, SUM(wr.wr_return_quantity) AS total_return_quantity, AVG(wr.wr_return_amt) AS avg_return_amount, COUNT(DISTINCT wr.wr_order_number) AS num_orders, SUM(wr.wr_return_amt_inc_tax) AS total_return_amount_inc_tax, SUM(wr.wr_fee) AS total_fees, SUM(wr.wr_return_ship_cost) AS total_shipping_cost, SUM(wr.wr_refunded_cash) AS total_refunded_cash, SUM(wr.wr_reversed_charge) AS total_reversed_charges, SUM(wr.wr_account_credit) AS total_account_credits, SUM(wr.wr_net_loss) AS total_net_loss FROM customer c JOIN web_returns wr ON c.c_customer_sk = wr.wr_returning_customer_sk JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk GROUP BY c.c_customer_id, c.c_email_address, hd.hd_buy_potential ORDER BY total_return_amount_inc_tax DESC LIMIT 100;
SELECT p.p_promo_name AS promotion_name, i.ib_lower_bound AS income_band_lower_bound, i.ib_upper_bound AS income_band_upper_bound, COUNT(DISTINCT c.cd_demo_sk) AS number_of_customers, SUM(ss.ss_quantity) AS total_quantity_sold, AVG(ss.ss_sales_price) AS average_sales_price, SUM(ss.ss_net_paid) AS total_net_paid, SUM(ws.ws_net_paid_inc_tax) AS web_total_net_paid_inc_tax, COUNT(DISTINCT cp.cp_catalog_page_sk) AS number_of_catalog_pages_used, COUNT(DISTINCT inv.inv_item_sk) AS number_of_items_sold FROM store_sales ss JOIN promotion p ON ss.ss_promo_sk = p.p_promo_sk JOIN customer_demographics c ON ss.ss_cdemo_sk = c.cd_demo_sk JOIN income_band i ON c.cd_purchase_estimate BETWEEN i.ib_lower_bound AND i.ib_upper_bound JOIN web_sales ws ON ss.ss_item_sk = ws.ws_item_sk AND ss.ss_customer_sk = ws.ws_bill_customer_sk JOIN catalog_page cp ON ws.ws_web_page_sk = cp.cp_catalog_page_sk JOIN inventory inv ON ws.ws_item_sk = inv.inv_item_sk WHERE p.p_discount_active = 'Y' AND ss.ss_sold_date_sk BETWEEN 2451271 AND 2451575 AND cp.cp_start_date_sk BETWEEN 2451088 AND 2451420 AND inv.inv_quantity_on_hand > 0 GROUP BY promotion_name, income_band_lower_bound, income_band_upper_bound ORDER BY total_net_paid DESC, number_of_customers DESC;
SELECT sm.sm_type AS shipping_mode_type, sm.sm_carrier AS carrier, cp.cp_department AS catalog_department, COUNT(DISTINCT wr.wr_order_number) AS number_of_returns, SUM(wr.wr_return_quantity) AS total_returned_quantity, AVG(wr.wr_return_amt) AS average_return_amount, SUM(wr.wr_return_tax) AS total_tax, SUM(wr.wr_return_ship_cost) AS total_shipping_cost, SUM(wr.wr_net_loss) AS total_net_loss FROM web_returns wr JOIN ship_mode sm ON wr.wr_returned_date_sk = sm.sm_ship_mode_sk JOIN catalog_page cp ON wr.wr_web_page_sk = cp.cp_catalog_page_sk WHERE wr.wr_returned_date_sk = 2451368 AND cp.cp_catalog_page_sk IN ('859', '3510', '105', '4419') GROUP BY shipping_mode_type, carrier, catalog_department ORDER BY total_net_loss DESC;
SELECT c.cc_name, c.cc_state, AVG(s.s_number_employees) as avg_store_employees, SUM(sr.sr_return_amt) as total_return_amount, SUM(sr.sr_return_quantity) as total_returned_quantity, COUNT(DISTINCT hd.hd_demo_sk) as unique_household_count, AVG(cd.cd_purchase_estimate) as avg_purchase_estimate FROM call_center c JOIN store s ON c.cc_state = s.s_state AND c.cc_mkt_id = s.s_market_id JOIN store_returns sr ON s.s_store_sk = sr.sr_store_sk JOIN customer_demographics cd ON sr.sr_cdemo_sk = cd.cd_demo_sk JOIN household_demographics hd ON sr.sr_hdemo_sk = hd.hd_demo_sk WHERE c.cc_class = 'small' AND cd.cd_purchase_estimate > 5000 AND hd.hd_income_band_sk IS NOT NULL AND sr.sr_return_ship_cost > 100 AND sr.sr_returned_date_sk IS NOT NULL GROUP BY c.cc_name, c.cc_state ORDER BY total_return_amount DESC, avg_store_employees DESC, unique_household_count DESC;
SELECT sm.sm_code AS shipping_mode, s.s_store_name AS store_name, cc.cc_name AS call_center_name, COUNT(cr.cr_order_number) AS total_returns, SUM(cr.cr_return_amount) AS total_return_amount, AVG(cr.cr_return_quantity) AS avg_return_quantity, COUNT(DISTINCT cr.cr_refunded_customer_sk) AS unique_customers, COUNT(DISTINCT ws.ws_order_number) AS total_web_sales_orders, SUM(ws.ws_net_profit) AS total_web_sales_profit FROM catalog_returns cr JOIN call_center cc ON cr.cr_call_center_sk = cc.cc_call_center_sk JOIN ship_mode sm ON cr.cr_ship_mode_sk = sm.sm_ship_mode_sk JOIN store s ON cc.cc_division = s.s_division_id JOIN web_sales ws ON cr.cr_item_sk = ws.ws_item_sk AND cr.cr_order_number = ws.ws_order_number WHERE cr.cr_returned_date_sk BETWEEN 2450952 AND 2451063 AND sm.sm_code IN ('SEA', 'BIKE', 'AIR', 'SURFACE') AND s.s_hours IN ('8AM-12AM', '8AM-4PM') GROUP BY shipping_mode, store_name, call_center_name ORDER BY total_returns DESC, total_return_amount DESC;
SELECT s.s_state, cd.cd_gender, COUNT(DISTINCT s.s_store_sk) AS total_stores, AVG(s.s_floor_space) AS avg_floor_space, SUM(ss.ss_net_paid) AS total_sales, AVG(ss.ss_ext_discount_amt) AS avg_discount_amount FROM store_sales ss JOIN customer_demographics cd ON cd.cd_demo_sk = ss.ss_cdemo_sk JOIN store s ON s.s_store_sk = ss.ss_store_sk WHERE ss.ss_ext_sales_price > 0 AND cd.cd_gender IN ('M', 'F') AND s.s_state IS NOT NULL GROUP BY s.s_state, cd.cd_gender ORDER BY s.s_state, cd.cd_gender, total_sales DESC;
SELECT c.c_preferred_cust_flag AS customer_pref_status, r.r_reason_desc AS return_reason, ws.web_manager AS website_manager, COUNT(cr.cr_order_number) AS total_returns, SUM(cr.cr_return_amount) AS total_return_amount, AVG(cr.cr_return_amount) AS avg_return_amount, SUM(cr.cr_net_loss) AS total_net_loss FROM catalog_returns cr JOIN customer c ON cr.cr_refunded_customer_sk = c.c_customer_sk JOIN reason r ON cr.cr_reason_sk = r.r_reason_sk JOIN web_site ws ON cr.cr_call_center_sk = ws.web_site_sk WHERE c.c_current_addr_sk IN ('17516', '36852', '18429') AND ws.web_manager IN ('Jason Silva', 'Tommy Jones', 'Moses Hicks') AND r.r_reason_desc IN ('reason 23', 'Parts missing') GROUP BY customer_pref_status, return_reason, website_manager ORDER BY total_return_amount DESC, total_returns DESC;
SELECT ws_site.web_name, ws_site.web_manager, ws_site.web_mkt_class, ws_site.web_mkt_desc, SUM(ws.ws_quantity) AS total_quantity_sold, AVG(ws.ws_sales_price) AS average_sales_price, COUNT(DISTINCT ws.ws_order_number) AS total_orders, SUM(ws.ws_net_profit) AS total_net_profit FROM web_sales ws JOIN web_site ws_site ON ws.ws_web_site_sk = ws_site.web_site_sk WHERE ws.ws_ship_date_sk IN (2451986, 2451883) AND ws_site.web_company_name IN ('ought', 'cally', 'anti', 'able') AND ws_site.web_market_manager IN ('Joe George', 'Frank Cooper', 'Jeffrey Martin') GROUP BY ws_site.web_name, ws_site.web_manager, ws_site.web_mkt_class, ws_site.web_mkt_desc ORDER BY total_net_profit DESC;
SELECT ca_state, cd_education_status, AVG(cs_net_paid) AS avg_sales_amount, SUM(cs_net_paid) AS total_sales_amount, COUNT(DISTINCT cs_bill_customer_sk) AS unique_customers FROM catalog_sales JOIN date_dim ON catalog_sales.cs_sold_date_sk = date_dim.d_date_sk JOIN customer_demographics ON catalog_sales.cs_bill_cdemo_sk = customer_demographics.cd_demo_sk JOIN customer_address ON catalog_sales.cs_bill_addr_sk = customer_address.ca_address_sk WHERE date_dim.d_quarter_name IN ('1901Q4', '1913Q3', '1902Q3') AND date_dim.d_current_quarter = 'N' AND customer_address.ca_county IN ('Claiborne County', 'Scott County', 'Borden County', 'Juneau County') GROUP BY ca_state, cd_education_status ORDER BY ca_state, cd_education_status, total_sales_amount DESC;
SELECT i.inv_date_sk, COUNT(DISTINCT cr.cr_order_number) AS total_returns, SUM(cr.cr_return_quantity) AS total_returned_quantity, AVG(cr.cr_return_amount) AS average_return_amount, SUM(cr.cr_net_loss) AS total_net_loss, COUNT(DISTINCT p.p_promo_sk) AS total_promotions, SUM(p.p_cost) AS total_promotion_cost, AVG(i.inv_quantity_on_hand) AS average_inventory_quantity FROM inventory i LEFT JOIN catalog_returns cr ON i.inv_item_sk = cr.cr_item_sk LEFT JOIN promotion p ON i.inv_item_sk = p.p_item_sk WHERE i.inv_date_sk BETWEEN 2450705 AND 2450709 AND i.inv_item_sk IN (7891, 13309, 15649, 8698, 9958) AND ( p.p_channel_catalog = 'N' OR p.p_channel_catalog IS NULL ) AND ( cr.cr_returning_cdemo_sk IN (909578, 1587504, 1439824, 941784, 229946) OR cr.cr_returning_cdemo_sk IS NULL ) GROUP BY i.inv_date_sk ORDER BY i.inv_date_sk;
SELECT sm.sm_type, sm.sm_carrier, COUNT(DISTINCT cs.cs_order_number) AS total_orders, SUM(cs.cs_quantity) AS total_quantity, AVG(cs.cs_sales_price) AS avg_sales_price, SUM(cs.cs_net_paid) AS total_net_paid, SUM(cs.cs_net_paid_inc_tax) AS total_net_paid_inc_tax, SUM(cs.cs_net_paid_inc_ship) AS total_net_paid_inc_ship, SUM(cs.cs_net_paid_inc_ship_tax) AS total_net_paid_inc_ship_tax, SUM(cs.cs_net_profit) AS total_net_profit, AVG(wp.wp_image_count) AS avg_image_count_on_webpage FROM catalog_sales cs JOIN ship_mode sm ON cs.cs_ship_mode_sk = sm.sm_ship_mode_sk LEFT JOIN web_page wp ON cs.cs_catalog_page_sk = wp.wp_web_page_sk WHERE wp.wp_image_count = 2 GROUP BY sm.sm_type, sm.sm_carrier ORDER BY total_net_paid DESC;
SELECT cc.cc_state, cc.cc_city, cc.cc_name, AVG(ss.ss_net_profit) AS avg_net_profit, SUM(ss.ss_quantity) AS total_quantity_sold, COUNT(DISTINCT ss.ss_store_sk) AS number_of_stores, COUNT(DISTINCT ss.ss_ticket_number) AS number_of_sales_transactions, SUM(cc.cc_employees) AS total_employees_in_call_centers, AVG(cc.cc_tax_percentage) AS avg_tax_percentage_by_state FROM store_sales ss JOIN call_center cc ON ss.ss_store_sk = cc.cc_call_center_sk JOIN time_dim td ON ss.ss_sold_time_sk = td.t_time_sk WHERE ss.ss_sold_date_sk IN (SELECT inv_date_sk FROM inventory WHERE inv_quantity_on_hand IN (816, 142, 984)) AND cc.cc_tax_percentage IN (0.01, 0.12, 0.05, 0.11) AND ss.ss_net_profit IN (5.76, 45.76, 66.12, -885.72, -4074.40) AND ss.ss_hdemo_sk IN (7132, 594, 6065, 5700) GROUP BY cc.cc_state, cc.cc_city, cc.cc_name ORDER BY avg_net_profit DESC;
