SELECT cs.cs_order_number AS order_number, SUM(cs.cs_quantity) AS total_quantity, AVG(cs.cs_sales_price) AS average_sales_price, SUM(cs.cs_net_paid) AS total_net_paid, SUM(cs.cs_net_profit) AS total_net_profit, COUNT(DISTINCT cs.cs_bill_customer_sk) AS unique_customers, ib.ib_lower_bound AS income_lower_bound, ib.ib_upper_bound AS income_upper_bound, SUM(ws.ws_quantity) AS web_total_quantity, AVG(ws.ws_sales_price) AS web_average_sales_price, SUM(ws.ws_net_paid) AS web_total_net_paid, SUM(ws.ws_net_profit) AS web_total_net_profit, COUNT(DISTINCT ws.ws_bill_customer_sk) AS web_unique_customers FROM catalog_sales cs JOIN income_band ib ON cs.cs_bill_hdemo_sk = ib.ib_income_band_sk JOIN web_sales ws ON cs.cs_item_sk = ws.ws_item_sk AND cs.cs_order_number = ws.ws_order_number WHERE cs.cs_ext_tax IN (0.56, 96.57, 30.68, 46.59, 64.13) AND ib.ib_income_band_sk IN (19, 17, 16, 10, 1) GROUP BY cs.cs_order_number, ib.ib_lower_bound, ib.ib_upper_bound ORDER BY total_net_profit DESC, web_total_net_profit DESC LIMIT 100;
SELECT s.s_store_name, s.s_company_name, COUNT(DISTINCT wr.wr_order_number) AS total_returns, SUM(wr.wr_return_amt) AS total_return_amount, AVG(wr.wr_return_quantity) AS average_return_quantity, SUM(wr.wr_return_amt_inc_tax) AS total_return_amount_incl_tax, SUM(wr.wr_fee) AS total_fees, SUM(wr.wr_net_loss) AS total_net_loss, cd.cd_education_status, AVG(cd.cd_purchase_estimate) AS average_purchase_estimate, COUNT(DISTINCT wp.wp_web_page_sk) AS total_web_pages_involved, td.t_shift, SUM(CASE WHEN td.t_am_pm = 'PM' THEN 1 ELSE 0 END) AS returns_in_pm, SUM(CASE WHEN td.t_am_pm = 'AM' THEN 1 ELSE 0 END) AS returns_in_am FROM store s JOIN web_returns wr ON s.s_store_sk = wr.wr_returning_addr_sk JOIN customer_demographics cd ON wr.wr_returning_cdemo_sk = cd.cd_demo_sk JOIN web_page wp ON wr.wr_web_page_sk = wp.wp_web_page_sk JOIN time_dim td ON wr.wr_returned_time_sk = td.t_time_sk WHERE s.s_tax_precentage BETWEEN 0.06 AND 0.08 AND s.s_company_name <> 'Unknown' AND wp.wp_type = 'feedback' AND wp.wp_rec_start_date > '1999-09-04' AND td.t_minute IN (50, 18) GROUP BY s.s_store_name, s.s_company_name, cd.cd_education_status, td.t_shift ORDER BY total_returns DESC, total_return_amount DESC;
SELECT i_category, i_class, COUNT(DISTINCT i_item_sk) AS item_count, AVG(i_current_price) AS avg_current_price, SUM(sr_return_quantity) AS total_return_quantity, SUM(sr_return_amt) AS total_return_amount, AVG(sr_return_amt) AS avg_return_amount, w_state, ca_state, sm_type, COUNT(DISTINCT sr_ticket_number) AS total_returns FROM store_returns JOIN item ON sr_item_sk = i_item_sk JOIN warehouse ON sr_store_sk = w_warehouse_sk JOIN customer_address ON sr_addr_sk = ca_address_sk JOIN ship_mode ON sr_return_time_sk::text LIKE sm_ship_mode_id WHERE sr_returned_date_sk IS NOT NULL AND i_rec_start_date <= CURRENT_DATE AND (i_rec_end_date IS NULL OR i_rec_end_date > CURRENT_DATE) AND w_gmt_offset = '-5.00' AND w_zip = '35709' AND i_manufact IN ('oughtoughtese', 'eingbarought', 'eseation') AND sr_return_time_sk IN (37755, 53252) GROUP BY i_category, i_class, w_state, ca_state, sm_type ORDER BY total_return_amount DESC, total_return_quantity DESC;
SELECT d_year, w_state, p_promo_name, COUNT(DISTINCT cs_order_number) AS total_orders, SUM(cs_quantity) AS total_quantity, AVG(cs_sales_price) AS average_sales_price, SUM(cs_net_profit) AS total_profit FROM catalog_sales JOIN date_dim ON cs_sold_date_sk = d_date_sk JOIN warehouse ON cs_warehouse_sk = w_warehouse_sk JOIN promotion ON cs_promo_sk = p_promo_sk WHERE d_year = 2001 AND w_state IN ('WA', 'CA', 'TX') AND p_promo_id IN ('AAAAAAAAKDAAAAAA', 'AAAAAAAAKJAAAAAA', 'AAAAAAAACKAAAAAA') GROUP BY d_year, w_state, p_promo_name ORDER BY total_profit DESC, average_sales_price DESC LIMIT 10;
SELECT s.s_store_name, s.s_number_employees, AVG(ss.ss_sales_price) AS average_sale_amount, AVG(sr.sr_return_amt) AS average_return_amount, SUM(inv.inv_quantity_on_hand) AS total_inventory, COUNT(DISTINCT ss.ss_ticket_number) AS total_sales_transactions, COUNT(DISTINCT sr.sr_ticket_number) AS total_return_transactions FROM store s LEFT JOIN store_sales ss ON s.s_store_sk = ss.ss_store_sk LEFT JOIN store_returns sr ON s.s_store_sk = sr.sr_store_sk AND ss.ss_item_sk = sr.sr_item_sk LEFT JOIN inventory inv ON ss.ss_item_sk = inv.inv_item_sk AND s.s_store_sk = inv.inv_warehouse_sk WHERE (ss.ss_sold_date_sk IS NOT NULL OR sr.sr_returned_date_sk IS NOT NULL) AND (ss.ss_item_sk IN (14547, 403, 14095, 8557) OR sr.sr_item_sk IN (14547, 403, 14095, 8557)) AND EXISTS ( SELECT 1 FROM household_demographics hd WHERE (ss.ss_hdemo_sk = hd.hd_demo_sk OR sr.sr_hdemo_sk = hd.hd_demo_sk) AND hd.hd_dep_count = 1 ) GROUP BY s.s_store_name, s.s_number_employees ORDER BY s.s_store_name;
SELECT cp_department, cp_type, COUNT(DISTINCT cp_catalog_page_sk) AS num_catalog_pages, SUM(ss_quantity) AS total_quantity_sold, AVG(ss_sales_price) AS average_sales_price, SUM(ss_net_paid_inc_tax) AS total_revenue, SUM(ss_net_profit) AS total_profit, COUNT(DISTINCT ss_customer_sk) AS unique_customers, ib_lower_bound, ib_upper_bound FROM catalog_page JOIN store_sales ON cp_catalog_page_sk = ss_promo_sk JOIN income_band ON ss_hdemo_sk = ib_income_band_sk JOIN time_dim ON ss_sold_time_sk = t_time_sk WHERE cp_start_date_sk IS NOT NULL AND cp_end_date_sk IS NOT NULL AND (cp_type = 'quarterly' OR cp_type = 'monthly') AND t_sub_shift = 'night' AND ib_upper_bound IN (170000, 140000) AND ib_lower_bound >= 120001 GROUP BY cp_department, cp_type, ib_lower_bound, ib_upper_bound ORDER BY total_revenue DESC, total_profit DESC;
SELECT cp.cp_department, cp.cp_catalog_number, sm.sm_carrier, COUNT(*) AS total_returns, SUM(sr.sr_return_quantity) AS total_returned_quantity, AVG(sr.sr_return_amt_inc_tax) AS average_return_amount_inc_tax, SUM(sr.sr_fee) AS total_fees, SUM(sr.sr_net_loss) AS total_net_loss FROM store_returns sr JOIN catalog_page cp ON sr.sr_item_sk = cp.cp_catalog_page_sk JOIN ship_mode sm ON sm.sm_ship_mode_sk = sr.sr_item_sk WHERE cp.cp_catalog_page_number IN (20, 88, 103, 108, 56, 9) AND cp.cp_catalog_page_id IN ('AAAAAAAAMECBAAAA', 'AAAAAAAAPENAAAAA', 'AAAAAAAAHKMAAAAA', 'AAAAAAAADBGAAAAA', 'AAAAAAAADEPAAAAA', 'AAAAAAAALIDAAAAA') AND sm.sm_ship_mode_id IN ('AAAAAAAAABAAAAAA', 'AAAAAAAACBAAAAAA', 'AAAAAAAAJAAAAAAA', 'AAAAAAAAFAAAAAAA', 'AAAAAAAAEBAAAAAA') AND sm.sm_carrier IN ('TBS', 'DIAMOND', 'AIRBORNE', 'GREAT EASTERN', 'LATVIAN') GROUP BY cp.cp_department, cp.cp_catalog_number, sm.sm_carrier;
SELECT s.s_store_name, p.p_promo_name, i.ib_lower_bound, i.ib_upper_bound, SUM(ws.ws_quantity) AS total_quantity_sold, AVG(ws.ws_sales_price) AS average_sales_price, COUNT(DISTINCT ws.ws_order_number) AS unique_orders, SUM(ws.ws_net_paid_inc_tax) AS total_revenue_inc_tax, SUM(CASE WHEN ws.ws_promo_sk IS NOT NULL THEN ws.ws_quantity ELSE 0 END) AS promo_quantity_sold, SUM(CASE WHEN ws.ws_promo_sk IS NOT NULL THEN ws.ws_sales_price ELSE 0 END) AS promo_sales_revenue FROM web_sales ws JOIN store s ON ws.ws_ship_addr_sk = s.s_store_sk LEFT JOIN promotion p ON ws.ws_promo_sk = p.p_promo_sk LEFT JOIN income_band i ON ws.ws_bill_cdemo_sk = i.ib_income_band_sk WHERE s.s_closed_date_sk NOT IN ('2451189', '2450910', '2451044') GROUP BY s.s_store_name, p.p_promo_name, i.ib_lower_bound, i.ib_upper_bound ORDER BY total_revenue_inc_tax DESC, s.s_store_name, p.p_promo_name;
SELECT c.c_customer_id, COUNT(ws.ws_order_number) AS total_orders, SUM(ws.ws_quantity) AS total_units_sold, AVG(ws.ws_sales_price) AS average_sales_price, SUM(ws.ws_net_paid) AS total_net_paid, SUM(ws.ws_net_profit) AS total_net_profit, sm.sm_type AS shipping_mode, EXTRACT(YEAR FROM d_date) AS sales_year FROM web_sales ws JOIN date_dim d_date ON ws.ws_sold_date_sk = d_date.d_date_sk JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk WHERE d_date.d_year = 2020 GROUP BY c.c_customer_id, sm.sm_type, sales_year ORDER BY total_net_paid DESC, total_net_profit DESC;
SELECT ca.ca_city, ca.ca_state, sm.sm_type AS shipping_type, COUNT(DISTINCT cr.cr_order_number) AS total_returns, SUM(cr.cr_return_quantity) AS total_returned_quantity, SUM(cr.cr_return_amount) AS total_returned_amount, AVG(cr.cr_return_amount) AS avg_return_amount, SUM(cs.cs_quantity) AS total_sold_quantity, SUM(cs.cs_sales_price) AS total_sales_amount, AVG(cs.cs_sales_price) AS avg_sales_price, SUM(ss.ss_quantity) AS total_store_sold_quantity, SUM(ss.ss_sales_price) AS total_store_sales_amount, AVG(ss.ss_sales_price) AS avg_store_sales_price FROM catalog_returns cr JOIN customer_address ca ON cr.cr_returning_addr_sk = ca.ca_address_sk JOIN ship_mode sm ON cr.cr_ship_mode_sk = sm.sm_ship_mode_sk JOIN catalog_sales cs ON cr.cr_order_number = cs.cs_order_number AND cr.cr_item_sk = cs.cs_item_sk JOIN store_sales ss ON cs.cs_order_number = ss.ss_ticket_number AND cs.cs_item_sk = ss.ss_item_sk WHERE ca.ca_location_type IN ('single family', 'apartment', 'condo') AND ca.ca_address_sk IN (1045, 2742, 4441, 2983, 912) AND ss.ss_ticket_number IN (3727, 3689, 3508, 3484, 3325, 3364) AND ss.ss_addr_sk = 29811 AND cs.cs_ship_cdemo_sk = 172784 GROUP BY ca.ca_city, ca.ca_state, sm.sm_type ORDER BY total_returned_amount DESC, total_sales_amount DESC, total_store_sales_amount DESC;
SELECT h.hd_income_band_sk, p.p_promo_name, p.p_channel_dmail, p.p_channel_email, p.p_channel_tv, COUNT(DISTINCT s.ss_ticket_number) AS total_sales_transactions, SUM(s.ss_quantity) AS total_units_sold, SUM(s.ss_net_paid) AS total_revenue, AVG(s.ss_sales_price) AS average_sales_price, r.r_reason_desc, COUNT(DISTINCT sr.sr_ticket_number) AS total_return_transactions, SUM(sr.sr_return_quantity) AS total_units_returned, SUM(sr.sr_net_loss) AS total_loss_from_returns FROM store_sales s LEFT JOIN promotion p ON s.ss_promo_sk = p.p_promo_sk LEFT JOIN household_demographics h ON s.ss_hdemo_sk = h.hd_demo_sk LEFT JOIN store_returns sr ON s.ss_ticket_number = sr.sr_ticket_number AND s.ss_item_sk = sr.sr_item_sk LEFT JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk WHERE s.ss_item_sk IN (13423, 9310) GROUP BY h.hd_income_band_sk, p.p_promo_name, p.p_channel_dmail, p.p_channel_email, p.p_channel_tv, r.r_reason_desc ORDER BY total_revenue DESC;
SELECT d_year, d_moy, sm_type, COUNT(DISTINCT cs_order_number) AS total_orders, SUM(cs_net_paid) AS total_revenue, SUM(cs_net_profit) AS total_profit, AVG(cs_quantity) AS average_quantity, AVG(cs_net_paid_inc_tax) AS average_revenue_inc_tax, SUM(cr_return_amount) AS total_return_amount, AVG(cr_return_quantity) AS average_return_quantity, COUNT(DISTINCT wp_web_page_sk) AS total_web_page_visits, COUNT(DISTINCT s_store_sk) AS total_stores, COUNT(DISTINCT cc_call_center_sk) AS total_call_centers FROM date_dim LEFT JOIN catalog_sales ON cs_sold_date_sk = d_date_sk LEFT JOIN ship_mode ON cs_ship_mode_sk = sm_ship_mode_sk LEFT JOIN catalog_returns ON cr_returned_date_sk = d_date_sk LEFT JOIN web_page ON wp_access_date_sk = d_date_sk LEFT JOIN store ON s_store_sk = cs_ship_customer_sk LEFT JOIN call_center ON cc_call_center_sk = cs_call_center_sk LEFT JOIN customer_demographics ON cs_ship_cdemo_sk = cd_demo_sk WHERE d_year = 2001 AND d_moy BETWEEN 1 AND 6 AND cs_net_paid IS NOT NULL AND sm_type IS NOT NULL AND (cc_sq_ft = '3514' OR cc_sq_ft = '4134' OR cc_sq_ft = '1138') AND (cc_rec_end_date = '2000-12-31' OR cc_rec_end_date = '2001-12-31' OR cc_rec_end_date = '2000-01-01') AND (cc_company = '6' OR cc_company = '3' OR cc_company = '1') AND (cr_return_ship_cost = '2.66' OR cr_return_ship_cost = '13.49' OR cr_return_ship_cost = '26.44') AND (cr_catalog_page_sk = '380' OR cr_catalog_page_sk = '219' OR cr_catalog_page_sk = '388') AND (cr_returned_time_sk = '45077' OR cr_returned_time_sk = '77627' OR cr_returned_time_sk = '32496') AND (sm_contract = '2mM8l' OR sm_contract = 'uukTktPYycct8' OR sm_contract = 'fop0bcSd91J26IVpR') AND (sm_ship_mode_sk = '10' OR sm_ship_mode_sk = '6' OR sm_ship_mode_sk = '4') AND (sm_code = 'SEA' OR sm_code = 'BIKE' OR sm_code = 'SURFACE') AND (sm_carrier = 'FEDEX' OR sm_carrier = 'ZHOU' OR sm_carrier = 'PRIVATECARRIER') AND (cs_ext_tax = '89.97' OR cs_ext_tax = '687.10' OR cs_ext_tax = '221.70') AND (cs_ship_hdemo_sk = '2057' OR cs_ship_hdemo_sk = '6324' OR cs_ship_hdemo_sk = '6945') AND (cs_net_paid_inc_ship_tax = '1307.73' OR cs_net_paid_inc_ship_tax = '1740.39' OR cs_net_paid_inc_ship_tax = '1487.69') AND (d_weekend = 'N' OR d_weekend = 'Y') AND (s_gmt_offset = '-5.00') AND (s_store_sk = '1' OR s_store_sk = '12' OR s_store_sk = '9') AND (s_store_name = 'anti' OR s_store_name = 'ese' OR s_store_name = 'eing') AND (wp_access_date_sk = '2452555' OR wp_access_date_sk = '2452645' OR wp_access_date_sk = '2452576') AND (wp_customer_sk = '20213' OR wp_customer_sk = '98376' OR wp_customer_sk = '60150') AND (wp_web_page_id = 'AAAAAAAAEDAAAAAA' OR wp_web_page_id = 'AAAAAAAAHDAAAAAA' OR wp_web_page_id = 'AAAAAAAAOAAAAAAA') AND (wp_web_page_sk = '3' OR wp_web_page_sk = '17' OR wp_web_page_sk = '36') AND (cd_demo_sk = '18975' OR cd_demo_sk = '21210' OR cd_demo_sk = '20876') AND (cd_dep_count = '2' OR cd_dep_count = '1') GROUP BY d_year, d_moy, sm_type ORDER BY d_year, d_moy, sm_type;
SELECT ca_state, COUNT(DISTINCT ss_customer_sk) AS unique_customers, SUM(ss_quantity) AS total_quantity_sold, SUM(ss_net_paid) AS total_net_sales, AVG(ss_net_profit) AS avg_profit_per_sale, SUM(ss_net_paid_inc_tax) - SUM(ss_net_paid) AS total_tax_collected, web_company_name FROM store_sales JOIN customer_address ON store_sales.ss_addr_sk = customer_address.ca_address_sk JOIN web_site ON store_sales.ss_store_sk = web_site.web_site_sk WHERE web_site.web_company_id IN ('5', '1', '4', '6', '2') AND customer_address.ca_country = 'United States' AND EXTRACT(YEAR FROM CURRENT_DATE) - EXTRACT(YEAR FROM web_rec_start_date) <= 10 GROUP BY ca_state, web_company_name ORDER BY total_net_sales DESC, total_quantity_sold DESC;
SELECT ws.ws_web_site_sk, ws.ws_item_sk, i.i_product_name, i.i_category, sm.sm_type AS shipping_type, w.w_state AS warehouse_state, ca.ca_state AS customer_state, COUNT(*) AS total_orders, SUM(ws.ws_quantity) AS total_quantity_sold, AVG(ws.ws_sales_price) AS average_sales_price, SUM(ws.ws_net_paid) AS total_net_paid, SUM(ws.ws_net_profit) AS total_net_profit, AVG(ws.ws_net_profit) AS average_net_profit FROM web_sales ws JOIN item i ON ws.ws_item_sk = i.i_item_sk JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk JOIN warehouse w ON ws.ws_warehouse_sk = w.w_warehouse_sk JOIN customer_address ca ON ws.ws_ship_addr_sk = ca.ca_address_sk WHERE ca.ca_gmt_offset IN ('-8.00', '-10.00', '-5.00', '-9.00', '-7.00') AND (w.w_zip = '35709' OR w.w_zip = '31904') GROUP BY ws.ws_web_site_sk, ws.ws_item_sk, i.i_product_name, i.i_category, sm.sm_type, w.w_state, ca.ca_state ORDER BY total_net_profit DESC, total_orders DESC LIMIT 100;
SELECT dd.d_year, dd.d_quarter_name, sm.sm_type, ca.ca_state, COUNT(DISTINCT cp.cp_catalog_page_sk) AS total_catalog_pages, SUM(CASE WHEN ca.ca_location_type = 'single family' THEN 1 ELSE 0 END) AS single_family_count, SUM(CASE WHEN ca.ca_location_type = 'apartment' THEN 1 ELSE 0 END) AS apartment_count, SUM(CASE WHEN ca.ca_location_type = 'condo' THEN 1 ELSE 0 END) AS condo_count, AVG(ca.ca_gmt_offset) AS avg_gmt_offset FROM catalog_page cp JOIN date_dim dd ON cp.cp_start_date_sk = dd.d_date_sk OR cp.cp_end_date_sk = dd.d_date_sk JOIN customer_address ca ON cp.cp_catalog_page_sk = ca.ca_address_sk JOIN ship_mode sm ON sm.sm_ship_mode_sk = dd.d_date_sk WHERE dd.d_year = 2023 GROUP BY dd.d_year, dd.d_quarter_name, sm.sm_type, ca.ca_state ORDER BY dd.d_year, dd.d_quarter_name, sm.sm_type, ca.ca_state;
SELECT c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address, sum(i.i_current_price) AS total_spent, avg(i.i_wholesale_cost) AS average_wholesale_cost, count(DISTINCT cp.cp_catalog_page_sk) AS number_of_catalog_pages, count(DISTINCT web.web_site_sk) AS number_of_websites_visited, sm.sm_type AS shipping_type, sm.sm_code AS shipping_code FROM customer c JOIN catalog_page cp ON c.c_first_shipto_date_sk = cp.cp_start_date_sk JOIN item i ON i.i_category_id = cp.cp_catalog_number JOIN web_site web ON web.web_open_date_sk = c.c_first_sales_date_sk JOIN ship_mode sm ON sm.sm_ship_mode_sk = web.web_site_sk WHERE i.i_brand_id IN ('6016004', '7006002', '6004007') AND i.i_manufact_id IN ('86', '35', '590') AND web.web_suite_number IN ('Suite 330', 'Suite R', 'Suite Q') AND web.web_open_date_sk IN ('2450798', '2450654', '2450756') AND cp.cp_catalog_page_number IN ('93', '92', '1') AND cp.cp_start_date_sk IN ('2451088', '2451180', '2451271') AND cp.cp_department = 'DEPARTMENT' AND cp.cp_catalog_number IN ('19', '13', '33') AND sm.sm_code IN ('BIKE', 'SURFACE', 'SEA') AND sm.sm_type IN ('REGULAR', 'NEXT DAY', 'LIBRARY') AND c.c_salutation IN ('Ms.', 'Mr.', 'Miss') AND c.c_first_name IN ('Arturo', 'Gudrun', 'Douglas') AND c.c_birth_country IN ('ISLE OF MAN', 'AMERICAN SAMOA', 'EQUATORIAL GUINEA') AND c.c_customer_sk IN ('4875', '3748', '2364') GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address, sm.sm_type, sm.sm_code ORDER BY total_spent DESC LIMIT 100;
SELECT s.s_store_name, SUM(ss.ss_quantity) AS total_quantity_sold, AVG(ss.ss_sales_price) AS average_sales_price, SUM(ss.ss_net_paid) AS total_net_paid, SUM(ss.ss_net_paid_inc_tax) AS total_net_paid_inc_tax, AVG(ss.ss_net_profit) AS average_net_profit, COUNT(DISTINCT p.p_promo_sk) AS number_of_promotions_run, SUM(CASE WHEN p.p_channel_tv = 'N' THEN ss.ss_quantity ELSE 0 END) AS quantity_sold_with_no_tv_promo FROM store_sales ss JOIN store s ON ss.ss_store_sk = s.s_store_sk JOIN promotion p ON ss.ss_promo_sk = p.p_promo_sk JOIN call_center cc ON s.s_market_id = cc.cc_mkt_id JOIN inventory i ON ss.ss_item_sk = i.inv_item_sk AND i.inv_date_sk = ss.ss_sold_date_sk WHERE ss.ss_sold_time_sk IN (63444, 44081, 71662, 70433) AND i.inv_item_sk IN (15889, 8930) AND i.inv_date_sk = 2450815 AND p.p_cost = 1000.00 AND cc.cc_sq_ft IN (795, 2268, 3514, 1138, 649) AND cc.cc_open_date_sk IN (2450806, 2450952) GROUP BY s.s_store_name ORDER BY total_net_paid DESC;
SELECT cd.cd_gender, cd.cd_marital_status, cd.cd_education_status, cd.cd_credit_rating, wsit.web_name, wsit.web_manager, COUNT(DISTINCT ws.ws_order_number) AS total_orders, SUM(ws.ws_quantity) AS total_quantity_sold, SUM(ws.ws_net_paid) AS total_net_paid, SUM(ws.ws_net_profit) AS total_net_profit, AVG(ws.ws_net_profit) AS average_net_profit_per_sale, MAX(ws.ws_net_profit) AS max_net_profit_single_sale, MIN(ws.ws_net_profit) AS min_net_profit_single_sale FROM web_sales ws JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk JOIN web_site wsit ON ws.ws_web_site_sk = wsit.web_site_sk WHERE cd.cd_credit_rating IN ('Low Risk', 'High Risk', 'Good') AND wsit.web_country = 'United States' AND ws.ws_sold_date_sk BETWEEN 2000000 AND 2020000 GROUP BY cd.cd_gender, cd.cd_marital_status, cd.cd_education_status, cd.cd_credit_rating, wsit.web_name, wsit.web_manager ORDER BY total_net_profit DESC, cd.cd_gender, cd.cd_credit_rating;
SELECT ws.web_site_id, ws.web_class, ws.web_name, COUNT(DISTINCT wr.wr_order_number) AS total_returns, SUM(wr.wr_return_quantity) AS total_returned_quantity, AVG(wr.wr_return_amt_inc_tax) AS avg_return_amount_inc_tax, SUM(wr.wr_refunded_cash) AS total_refunded_cash, SUM(sr.sr_return_quantity) AS store_total_returned_quantity, AVG(sr.sr_return_amt_inc_tax) AS store_avg_return_amount_inc_tax, SUM(sr.sr_refunded_cash) AS store_total_refunded_cash FROM web_site ws JOIN web_page wp ON ws.web_site_sk = wp.wp_web_page_sk JOIN web_returns wr ON wp.wp_web_page_sk = wr.wr_web_page_sk LEFT JOIN store_returns sr ON wr.wr_item_sk = sr.sr_item_sk AND wr.wr_refunded_customer_sk = sr.sr_customer_sk WHERE ws.web_class = 'Unknown' AND ws.web_rec_end_date IN ('2001-08-15', '2000-08-15', '1999-08-16') AND wp.wp_rec_start_date IN ('2000-09-03', '2001-09-03', '1997-09-03') AND wp.wp_link_count IN (7, 11, 19) AND wr.wr_return_amt_inc_tax IN (43.31, 378.40, 532.83) AND wr.wr_refunded_cash IN (2425.04, 1694.98, 8.69) AND sr.sr_customer_sk IN (38344, 71012, 20816) AND sr.sr_cdemo_sk IN (1443482, 746161, 1430182) GROUP BY ws.web_site_id, ws.web_class, ws.web_name ORDER BY total_returns DESC, total_refunded_cash DESC;
SELECT w_state, ib_income_band_sk, COUNT(DISTINCT cs_order_number) AS total_orders, SUM(cs_quantity) AS total_quantity, AVG(cs_net_paid) AS average_net_paid, SUM(cs_net_profit) AS total_profit, COUNT(DISTINCT ws_order_number) AS total_web_orders, SUM(ws_quantity) AS total_web_quantity, AVG(ws_net_paid_inc_ship) AS average_web_net_paid_inc_ship, SUM(ws_net_profit) AS total_web_profit, COUNT(DISTINCT wr_order_number) AS total_returns, SUM(wr_return_quantity) AS total_returned_quantity, AVG(wr_return_amt_inc_tax) AS average_return_amount_inc_tax, SUM(wr_net_loss) AS total_net_loss FROM warehouse w JOIN catalog_sales cs ON w.w_warehouse_sk = cs.cs_warehouse_sk JOIN household_demographics hd ON cs.cs_bill_hdemo_sk = hd.hd_demo_sk JOIN income_band ib ON hd.hd_income_band_sk = ib.ib_income_band_sk JOIN web_sales ws ON w.w_warehouse_sk = ws.ws_warehouse_sk JOIN web_returns wr ON ws.ws_order_number = wr.wr_order_number WHERE w.w_county = 'Williamson County' AND w.w_warehouse_sk IN (2, 3) AND cs.cs_ship_addr_sk IN (27775, 21962, 3537, 27769) AND wr.wr_refunded_customer_sk IN (51283, 671, 63734, 16023, 8581, 84835) AND ib.ib_lower_bound IN (80001, 30001, 0, 140001, 110001) GROUP BY w_state, ib_income_band_sk ORDER BY w_state, ib_income_band_sk;
SELECT p.p_promo_name, COUNT(ss.ss_ticket_number) AS total_sales_transactions, AVG(ss.ss_sales_price) AS avg_sales_price, SUM(ss.ss_ext_discount_amt) AS total_discount_amount, SUM(ss.ss_coupon_amt) AS total_coupon_discount, SUM(ss.ss_net_paid) AS total_net_paid, SUM(ss.ss_net_paid_inc_tax) AS total_net_paid_including_tax, SUM(ss.ss_net_profit) AS total_net_profit FROM store_sales ss JOIN promotion p ON ss.ss_promo_sk = p.p_promo_sk WHERE p.p_discount_active = 'Y' AND ss.ss_sold_date_sk BETWEEN p.p_start_date_sk AND p.p_end_date_sk GROUP BY p.p_promo_name ORDER BY total_net_profit DESC, total_sales_transactions DESC;
SELECT web.web_name AS website_name, item.i_category AS product_category, COUNT(DISTINCT sr.sr_ticket_number) AS total_returns, SUM(sr.sr_return_quantity) AS total_returned_quantity, AVG(sr.sr_return_amt) AS average_return_amount, SUM(sr.sr_return_amt) AS total_return_amount, SUM(sr.sr_fee) AS total_fees, SUM(sr.sr_net_loss) AS total_net_loss, td.t_shift AS return_shift FROM store_returns sr JOIN item ON sr.sr_item_sk = item.i_item_sk JOIN web_site web ON sr.sr_reason_sk = web.web_site_sk JOIN time_dim td ON sr.sr_return_time_sk = td.t_time_sk WHERE web.web_site_sk IN ('15', '11', '4', '20') AND item.i_current_price IN ('7.20', '1.29', '90.17', '5.18') AND td.t_shift = 'third' AND sr.sr_hdemo_sk = 3371 AND sr.sr_reversed_charge IN ('481.87', '4.35') GROUP BY web.web_name, item.i_category, td.t_shift ORDER BY total_return_amount DESC;
SELECT w.web_name, w.web_manager, SUM(i.i_current_price) AS total_current_price, AVG(i.i_wholesale_cost) AS average_wholesale_cost, COUNT(i.i_item_sk) AS item_count, SM.sm_type, MAX(i.i_current_price) AS max_price, MIN(i.i_current_price) AS min_price FROM web_site AS w JOIN item AS i ON w.web_site_sk = i.i_manufact_id JOIN ship_mode AS SM ON SM.sm_ship_mode_sk = i.i_item_sk WHERE i.i_rec_start_date <= CURRENT_DATE AND (i.i_rec_end_date IS NULL OR i.i_rec_end_date > CURRENT_DATE) AND SM.sm_type IN ('EXPRESS', 'OVERNIGHT', 'REGULAR') AND i.i_current_price IN (5.40, 8.89) GROUP BY w.web_name, w.web_manager, SM.sm_type ORDER BY total_current_price DESC, item_count DESC;
SELECT c.c_customer_id, c.c_first_name, c.c_last_name, dd.d_year, SUM(ws.ws_ext_sales_price) AS total_sales, AVG(ws.ws_ext_sales_price) AS avg_sales, COUNT(*) AS number_of_sales, SUM(cr.cr_return_amount) AS total_returns, AVG(cr.cr_return_amount) AS avg_returns, COUNT(DISTINCT cr.cr_order_number) AS number_of_returns FROM web_sales ws JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk JOIN date_dim dd ON ws.ws_sold_date_sk = dd.d_date_sk LEFT JOIN catalog_returns cr ON cr.cr_returned_date_sk = dd.d_date_sk AND cr.cr_refunded_customer_sk = c.c_customer_sk WHERE dd.d_year = 2001 GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, dd.d_year ORDER BY total_sales DESC, total_returns DESC LIMIT 100;
SELECT t.t_shift, ib.ib_income_band_sk, COUNT(DISTINCT ws.web_site_sk) AS total_websites, AVG(ws.web_tax_percentage) AS avg_tax_percentage, SUM(CASE WHEN ws.web_class = 'Unknown' THEN 1 ELSE 0 END) AS unknown_class_count, MIN(ib.ib_lower_bound) AS min_income_lower_bound, MAX(ib.ib_upper_bound) AS max_income_upper_bound FROM time_dim t JOIN web_site ws ON t.t_time_sk = ws.web_open_date_sk LEFT JOIN income_band ib ON ws.web_mkt_id = ib.ib_income_band_sk WHERE t.t_time_sk IN (1002, 2003, 4384, 955, 433, 1796) AND ws.web_company_id IN (5, 2, 1) AND ws.web_class != 'Unknown' GROUP BY t.t_shift, ib.ib_income_band_sk ORDER BY t.t_shift, ib.ib_income_band_sk;
