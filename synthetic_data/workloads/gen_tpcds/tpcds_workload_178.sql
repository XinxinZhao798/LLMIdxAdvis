SELECT s.s_state AS store_state, s.s_city AS store_city, SUM(s.s_floor_space) AS total_store_floor_space, SUM(s.s_number_employees) AS total_store_employees, AVG(s.s_tax_precentage) AS avg_store_tax_percentage, COUNT(DISTINCT w.w_warehouse_sk) AS total_warehouses, SUM(w.w_warehouse_sq_ft) AS total_warehouse_sq_ft, AVG(wp.wp_image_count) AS avg_webpage_image_count, AVG(wp.wp_link_count) AS avg_webpage_link_count FROM store s LEFT JOIN warehouse w ON s.s_city = w.w_city AND s.s_state = w.w_state LEFT JOIN web_page wp ON s.s_store_sk = wp.wp_customer_sk WHERE s.s_geography_class = 'Unknown' AND w.w_street_name IN ('View First', 'Wilson Elm', '6th', 'Ash Laurel') AND w.w_warehouse_id IN ('AAAAAAAACAAAAAAA', 'AAAAAAAAFAAAAAAA', 'AAAAAAAADAAAAAAA') AND wp.wp_url = 'http://www.foo.com' AND wp.wp_web_page_sk IN ('33', '24', '36', '14', '7', '49') GROUP BY s.s_state, s.s_city ORDER BY s.s_state, s.s_city;
SELECT ca.ca_state, COUNT(DISTINCT c.c_customer_sk) AS total_customers, AVG(s.s_floor_space) AS average_store_floor_space, SUM(s.s_number_employees) AS total_employees, COUNT(DISTINCT w.web_site_sk) AS total_websites, AVG(w.web_tax_percentage) AS average_web_tax_percentage FROM customer_address ca JOIN customer c ON ca.ca_address_sk = c.c_current_addr_sk JOIN store s ON ca.ca_state = s.s_state JOIN web_site w ON w.web_state = ca.ca_state WHERE c.c_preferred_cust_flag = 'Y' AND c.c_birth_year BETWEEN 1933 AND 1975 AND s.s_company_id = 1 AND w.web_open_date_sk IN ('2450730', '2450747') GROUP BY ca.ca_state ORDER BY total_customers DESC;
SELECT d_year, SUM(ss_quantity) AS total_quantity_sold, AVG(ss_sales_price) AS average_sales_price, COUNT(DISTINCT ss_store_sk) AS number_of_stores, SUM(CASE WHEN ss_promo_sk IN (265, 140) THEN ss_net_paid_inc_tax ELSE 0 END) AS sales_with_special_promotions, SUM(CASE WHEN p_channel_email = 'Y' THEN ss_net_paid ELSE 0 END) AS sales_via_email_promotion FROM store_sales JOIN date_dim ON store_sales.ss_sold_date_sk = date_dim.d_date_sk LEFT JOIN promotion ON store_sales.ss_promo_sk = promotion.p_promo_sk WHERE d_current_month = 'N' AND d_quarter_seq IN (30, 11) AND ss_quantity IN (60, 100) AND promotion.p_promo_sk IN (35, 216, 172) AND promotion.p_item_sk = 10982 GROUP BY d_year ORDER BY d_year;
SELECT dd.d_year, ca.ca_country, ca.ca_state, sm.sm_type, COUNT(DISTINCT hd.hd_demo_sk) AS number_of_households, AVG(hd.hd_vehicle_count) AS avg_vehicles_per_household, SUM(inv.inv_quantity_on_hand) AS total_inventory_on_hand FROM inventory inv JOIN date_dim dd ON inv.inv_date_sk = dd.d_date_sk JOIN customer_address ca ON inv.inv_warehouse_sk = ca.ca_address_sk JOIN household_demographics hd ON ca.ca_address_sk = hd.hd_demo_sk JOIN ship_mode sm ON sm.sm_ship_mode_sk = inv.inv_warehouse_sk WHERE dd.d_current_month = 'N' AND hd.hd_vehicle_count IN (0, 3) GROUP BY dd.d_year, ca.ca_country, ca.ca_state, sm.sm_type ORDER BY total_inventory_on_hand DESC, avg_vehicles_per_household DESC;
SELECT ca.ca_country, r.r_reason_desc, COUNT(cr.cr_order_number) AS return_count, SUM(cr.cr_return_amount) AS total_return_amount, AVG(cr.cr_return_amount) AS avg_return_amount, SUM(cr.cr_return_amt_inc_tax) AS total_return_inc_tax, AVG(cr.cr_return_amt_inc_tax) AS avg_return_inc_tax FROM catalog_returns cr JOIN reason r ON cr.cr_reason_sk = r.r_reason_sk JOIN customer_address ca ON cr.cr_refunded_addr_sk = ca.ca_address_sk WHERE ca.ca_country = 'United States' AND r.r_reason_desc = 'reason 27' GROUP BY ca.ca_country, r.r_reason_desc ORDER BY total_return_amount DESC;
SELECT cd.cd_gender, cd.cd_marital_status, cd.cd_education_status, SUM(cs.cs_quantity) AS total_catalog_quantity, AVG(cs.cs_sales_price) AS avg_catalog_sales_price, COUNT(DISTINCT cs.cs_order_number) AS num_catalog_orders, SUM(ws.ws_quantity) AS total_web_quantity, AVG(ws.ws_sales_price) AS avg_web_sales_price, COUNT(DISTINCT ws.ws_order_number) AS num_web_orders, SUM(cs.cs_net_profit) AS total_catalog_net_profit, SUM(ws.ws_net_profit) AS total_web_net_profit FROM customer_demographics cd LEFT JOIN catalog_sales cs ON cd.cd_demo_sk = cs.cs_bill_cdemo_sk LEFT JOIN web_sales ws ON cd.cd_demo_sk = ws.ws_bill_cdemo_sk WHERE (cs.cs_bill_cdemo_sk IN (182647, 387585) OR ws.ws_ship_mode_sk IN (12, 2, 5)) GROUP BY cd.cd_gender, cd.cd_marital_status, cd.cd_education_status ORDER BY total_catalog_net_profit DESC, total_web_net_profit DESC;
SELECT ca.ca_city, ca.ca_state, COUNT(DISTINCT ca.ca_address_sk) AS num_addresses, AVG(hd.hd_dep_count) AS avg_dependency_count, SUM(hd.hd_vehicle_count) AS total_vehicles, ib.ib_lower_bound, ib.ib_upper_bound, COUNT(DISTINCT sm.sm_ship_mode_sk) AS num_ship_modes, COUNT(DISTINCT r.r_reason_sk) AS num_reasons, SUM(CASE WHEN cp.cp_department = 'Electronics' THEN 1 ELSE 0 END) AS num_electronics_pages, SUM(CASE WHEN sm.sm_type = 'OVERNIGHT' THEN 1 ELSE 0 END) AS overnight_shipments, AVG(CASE WHEN t.t_am_pm = 'PM' THEN t.t_hour END) AS avg_hour_pm FROM customer_address ca JOIN household_demographics hd ON ca.ca_address_sk = hd.hd_demo_sk JOIN income_band ib ON hd.hd_income_band_sk = ib.ib_income_band_sk JOIN ship_mode sm ON sm.sm_carrier = 'UPS' JOIN reason r ON r.r_reason_desc LIKE 'reason %' LEFT JOIN catalog_page cp ON cp.cp_department = ca.ca_city LEFT JOIN time_dim t ON t.t_shift = 'Evening' WHERE r.r_reason_sk IN ('9', '6', '11', '2') AND ib.ib_income_band_sk IN ('20', '6') AND hd.hd_buy_potential = 'Unknown' AND sm.sm_type IN ('LIBRARY', 'OVERNIGHT', 'NEXT DAY') GROUP BY ca.ca_city, ca.ca_state, ib.ib_lower_bound, ib.ib_upper_bound ORDER BY ca.ca_city, ca.ca_state;
SELECT hd.hd_income_band_sk, COUNT(DISTINCT ss.ss_customer_sk) AS num_customers, SUM(ss.ss_quantity) AS total_quantity_sold, AVG(ss.ss_sales_price) AS avg_sales_price, SUM(ss.ss_net_paid) AS total_net_paid, SUM(ss.ss_net_profit) AS total_net_profit FROM store_sales ss JOIN household_demographics hd ON ss.ss_hdemo_sk = hd.hd_demo_sk JOIN income_band ib ON hd.hd_income_band_sk = ib.ib_income_band_sk JOIN promotion p ON ss.ss_promo_sk = p.p_promo_sk JOIN time_dim t ON ss.ss_sold_time_sk = t.t_time_sk WHERE hd.hd_income_band_sk IN (18, 2) AND t.t_hour BETWEEN 8 AND 17 GROUP BY hd.hd_income_band_sk ORDER BY total_net_profit DESC;
SELECT cc_division_name, cc_market_manager, SUM(ws_net_profit) AS total_profit, AVG(ws_quantity) AS average_quantity_sold, COUNT(DISTINCT ws_order_number) AS total_orders, SUM(wr_net_loss) AS total_net_loss, COUNT(DISTINCT wr_order_number) AS total_returns FROM call_center JOIN web_sales ON cc_call_center_sk = ws_warehouse_sk JOIN web_returns ON ws_order_number = wr_order_number WHERE ws_sold_date_sk BETWEEN 2000 AND 3000 AND ws_ship_mode_sk IN (1, 2) AND wr_reason_sk IN (12, 35, 30, 1, 29) AND cc_market_manager IN ('Julius Durham', 'Matthew Clifton', 'Gary Colburn', 'Julius Tran') GROUP BY cc_division_name, cc_market_manager ORDER BY total_profit DESC, total_net_loss ASC;
SELECT p.p_promo_name, cd.cd_gender, cd.cd_marital_status, cd.cd_education_status, COUNT(DISTINCT cs.cs_order_number) AS total_orders, SUM(cs.cs_quantity) AS total_quantity_sold, AVG(cs.cs_net_paid) AS avg_net_paid, SUM(cs.cs_net_paid_inc_tax) AS sum_net_paid_inc_tax, SUM(ws.ws_net_profit) AS sum_web_net_profit, COUNT(DISTINCT wr.wr_order_number) AS total_returns, SUM(wr.wr_return_amt) AS total_return_amount, AVG(wr.wr_fee) AS avg_return_fee FROM catalog_sales cs JOIN promotion p ON cs.cs_promo_sk = p.p_promo_sk JOIN customer_demographics cd ON cs.cs_bill_cdemo_sk = cd.cd_demo_sk JOIN web_sales ws ON cs.cs_order_number = ws.ws_order_number AND cs.cs_item_sk = ws.ws_item_sk LEFT JOIN web_returns wr ON ws.ws_order_number = wr.wr_order_number AND ws.ws_item_sk = wr.wr_item_sk WHERE cd.cd_credit_rating IN ('Good', 'Unknown') AND p.p_discount_active = 'N' AND cs.cs_net_paid_inc_tax NOT IN ('5209.58', '3100.79') AND NOT EXISTS ( SELECT 1 FROM reason r WHERE r.r_reason_sk = wr.wr_reason_sk AND r.r_reason_desc LIKE 'Wrong size' ) GROUP BY p.p_promo_name, cd.cd_gender, cd.cd_marital_status, cd.cd_education_status ORDER BY sum_net_paid_inc_tax DESC, total_orders DESC;
SELECT d_year, d_quarter_name, sm_type AS shipping_type, COUNT(DISTINCT ss_ticket_number) AS num_sales_transactions, SUM(ss_quantity) AS total_sold_quantity, AVG(ss_sales_price) AS average_sales_price, SUM(ss_net_profit) AS total_sales_net_profit, COUNT(DISTINCT sr_ticket_number) AS num_returns_transactions, SUM(sr_return_quantity) AS total_returned_quantity, AVG(sr_return_amt) AS average_return_amount, SUM(sr_net_loss) AS total_returns_net_loss, AVG(hd_dep_count) AS average_dependency_count, AVG(hd_vehicle_count) AS average_vehicle_count, AVG(ib_lower_bound) AS average_income_lower_bound, AVG(ib_upper_bound) AS average_income_upper_bound FROM store_sales JOIN date_dim ON ss_sold_date_sk = d_date_sk JOIN store_returns ON sr_item_sk = ss_item_sk AND sr_returned_date_sk = ss_sold_date_sk JOIN ship_mode ON sm_ship_mode_sk = ss_sold_date_sk JOIN household_demographics ON ss_hdemo_sk = hd_demo_sk JOIN income_band ON hd_income_band_sk = ib_income_band_sk WHERE d_moy IN (2, 4, 6, 8, 12) AND sm_code IN ('SEA', 'BIKE', 'AIR', 'SURFACE') AND sm_carrier IN ('PRIVATECARRIER', 'DIAMOND') GROUP BY d_year, d_quarter_name, shipping_type ORDER BY d_year, d_quarter_name, shipping_type;
SELECT cd.cd_education_status, cd.cd_credit_rating, COUNT(c.c_customer_sk) AS total_customers, AVG(cd.cd_purchase_estimate) AS avg_purchase_estimate, SUM(cd.cd_dep_count) AS total_dependents, SUM(cd.cd_dep_employed_count) AS employed_dependents, SUM(cd.cd_dep_college_count) AS college_dependents FROM customer_demographics cd JOIN customer c ON cd.cd_demo_sk = c.c_current_cdemo_sk LEFT JOIN promotion p ON c.c_current_hdemo_sk = p.p_promo_sk WHERE cd.cd_credit_rating IN ('High Risk', 'Low Risk', 'Good', 'Unknown') AND c.c_last_review_date_sk IN (2452297, 2452588) GROUP BY cd.cd_education_status, cd.cd_credit_rating ORDER BY cd.cd_education_status, cd.cd_credit_rating;
