SELECT dd.d_year, dd.d_quarter_name, SUM(cs.cs_quantity) AS total_catalog_quantity, AVG(cs.cs_sales_price) AS average_catalog_sales_price, SUM(cs.cs_net_profit) AS total_catalog_net_profit, SUM(ws.ws_quantity) AS total_web_quantity, AVG(ws.ws_sales_price) AS average_web_sales_price, SUM(ws.ws_net_profit) AS total_web_net_profit, SUM(cs.cs_quantity) + SUM(ws.ws_quantity) AS total_combined_quantity, AVG(cs.cs_sales_price * cs.cs_quantity + ws.ws_sales_price * ws.ws_quantity) / AVG(cs.cs_quantity + ws.ws_quantity) AS average_combined_sales_price, SUM(cs.cs_net_profit) + SUM(ws.ws_net_profit) AS total_combined_net_profit FROM date_dim dd LEFT JOIN catalog_sales cs ON dd.d_date_sk = cs.cs_sold_date_sk LEFT JOIN web_sales ws ON dd.d_date_sk = ws.ws_sold_date_sk WHERE dd.d_year = 2001 AND dd.d_current_quarter = 'N' GROUP BY dd.d_year, dd.d_quarter_name ORDER BY dd.d_year, dd.d_quarter_name;
SELECT ib.ib_income_band_sk, AVG(ss.ss_sales_price) AS avg_sales_price, SUM(ss.ss_net_profit) AS total_profit, COUNT(DISTINCT cp.cp_catalog_page_sk) AS num_catalog_pages, cp.cp_department FROM store_sales ss JOIN income_band ib ON ss.ss_hdemo_sk = ib.ib_income_band_sk JOIN catalog_page cp ON cp.cp_start_date_sk <= ss.ss_sold_date_sk AND cp.cp_end_date_sk >= ss.ss_sold_date_sk GROUP BY ib.ib_income_band_sk, cp.cp_department ORDER BY ib.ib_income_band_sk, cp.cp_department;
SELECT s.s_store_name, SUM(inv.inv_quantity_on_hand) AS Total_Inventory, AVG(inv.inv_quantity_on_hand) AS Average_Inventory, COUNT(DISTINCT inv.inv_item_sk) AS Unique_Items, COUNT(DISTINCT ca.ca_address_sk) AS Number_of_Customers, SUM(CASE WHEN cd.cd_credit_rating = 'High Risk' THEN cd.cd_purchase_estimate ELSE 0 END) AS High_Risk_Estimated_Purchases, AVG(cd.cd_purchase_estimate) AS Avg_Customer_Purchase_Estimate, SUM(cd.cd_dep_count) AS Total_Dependents, COUNT(DISTINCT sm.sm_ship_mode_sk) AS Shipping_Modes_Used FROM store s JOIN inventory inv ON s.s_store_sk = inv.inv_warehouse_sk JOIN customer_address ca ON ca.ca_city = s.s_city AND ca.ca_state = s.s_state JOIN customer_demographics cd ON ca.ca_address_sk = cd.cd_demo_sk JOIN ship_mode sm ON sm.sm_type = 'AIR' WHERE s.s_market_desc = 'Mysterious employe' AND inv.inv_quantity_on_hand IN (794, 3, 631, 744, 849) AND inv.inv_item_sk IN (10984, 6848, 7628) GROUP BY s.s_store_name ORDER BY Total_Inventory DESC, Number_of_Customers DESC LIMIT 100;
SELECT hd.hd_demo_sk, COUNT(DISTINCT sr.sr_ticket_number) AS total_store_returns, COUNT(DISTINCT wr.wr_order_number) AS total_web_returns, SUM(sr.sr_return_amt) AS total_store_return_amount, AVG(sr.sr_return_amt) AS avg_store_return_amount, SUM(wr.wr_return_amt) AS total_web_return_amount, AVG(wr.wr_return_amt) AS avg_web_return_amount, SUM(CASE WHEN p.p_channel_radio = 'N' AND p.p_channel_demo = 'N' THEN p.p_cost ELSE 0 END) AS non_radio_demo_promo_cost, AVG(CASE WHEN p.p_channel_radio = 'N' AND p.p_channel_demo = 'N' THEN p.p_response_target ELSE NULL END) AS avg_non_radio_demo_response_target FROM household_demographics hd LEFT JOIN store_returns sr ON hd.hd_demo_sk = sr.sr_hdemo_sk LEFT JOIN web_returns wr ON (hd.hd_demo_sk = wr.wr_refunded_hdemo_sk OR hd.hd_demo_sk = wr.wr_returning_hdemo_sk) LEFT JOIN promotion p ON p.p_promo_sk = sr.sr_reason_sk WHERE hd.hd_demo_sk IN (560, 4858) AND (sr.sr_store_sk IN (8, 10) OR sr.sr_store_sk IS NULL) GROUP BY hd.hd_demo_sk ORDER BY hd.hd_demo_sk;
SELECT c.c_customer_id, ca.ca_state, i.i_category, i.i_brand, SUM(i.i_current_price) AS total_revenue, AVG(i.i_wholesale_cost) AS average_wholesale_cost, COUNT(DISTINCT w.w_warehouse_sk) AS number_of_warehouses, COUNT(DISTINCT wp.wp_web_page_sk) AS number_of_web_pages FROM customer AS c JOIN customer_address AS ca ON c.c_current_addr_sk = ca.ca_address_sk JOIN item AS i ON i.i_manufact_id = c.c_customer_sk LEFT JOIN warehouse AS w ON w.w_state = ca.ca_state LEFT JOIN web_page AS wp ON wp.wp_customer_sk = c.c_customer_sk WHERE i.i_brand = 'amalgunivamalg #14' AND i.i_product_name IN ('eingprioughtable', 'eingationese', 'n stoughtation', 'antiationese', 'n stableeseese', 'anticallycally') AND ca.ca_country = 'United States' AND w.w_country = ca.ca_country GROUP BY c.c_customer_id, ca.ca_state, i.i_category, i.i_brand ORDER BY total_revenue DESC;
SELECT w_state, p_promo_id, p_discount_active, COUNT(DISTINCT cr_order_number) AS total_returns, SUM(cr_return_amount) AS total_return_amount, AVG(cr_return_amount) AS avg_return_amount, SUM(cr_return_quantity) AS total_returned_quantity, COUNT(DISTINCT sr_ticket_number) AS total_store_returns, SUM(sr_return_amt) AS total_store_return_amount, AVG(sr_return_amt) AS avg_store_return_amount, SUM(sr_return_quantity) AS total_store_returned_quantity FROM catalog_returns JOIN warehouse ON cr_warehouse_sk = w_warehouse_sk JOIN promotion ON cr_catalog_page_sk = p_promo_sk JOIN store_returns ON cr_item_sk = sr_item_sk AND cr_order_number = sr_ticket_number WHERE w_state = 'TN' AND p_promo_id = 'AAAAAAAAMKAAAAAA' AND p_discount_active = 'N' GROUP BY w_state, p_promo_id, p_discount_active ORDER BY total_return_amount DESC;
SELECT ws.ws_web_site_sk, AVG(ws.ws_sales_price) AS avg_sales_price, COUNT(ws.ws_order_number) AS total_orders, AVG(ws.ws_quantity) AS avg_quantity, SUM(ws.ws_net_paid_inc_tax) AS total_revenue, SUM(ws.ws_net_paid) AS total_net_paid, SUM(ws.ws_coupon_amt) AS total_coupon_amt, AVG(hd.hd_dep_count) AS avg_dependency_count, AVG(hd.hd_vehicle_count) AS avg_vehicle_count, wp.wp_type, COUNT(DISTINCT hd.hd_demo_sk) AS unique_households FROM web_sales ws JOIN web_page wp ON ws.ws_web_page_sk = wp.wp_web_page_sk JOIN household_demographics hd ON ws.ws_ship_hdemo_sk = hd.hd_demo_sk JOIN time_dim td ON ws.ws_sold_time_sk = td.t_time_sk JOIN web_site wsit ON ws.ws_web_site_sk = wsit.web_site_sk WHERE wsit.web_gmt_offset = '-5.00' AND wsit.web_site_sk IN (6, 17, 14) AND td.t_time IN (3552, 4450, 1742) AND ws.ws_sales_price BETWEEN 17.54 AND 205.36 AND ws.ws_item_sk IN (51, 14, 107, 50, 104, 108) GROUP BY ws.ws_web_site_sk, wp.wp_type ORDER BY total_revenue DESC;
SELECT sm.sm_type AS shipping_type, COUNT(DISTINCT cs.cs_order_number) AS total_orders, SUM(cs.cs_quantity) AS total_items_sold, AVG(cs.cs_sales_price) AS average_sales_price, SUM(cs.cs_net_paid) AS total_revenue, SUM(cs.cs_net_profit) AS total_profit, COUNT(DISTINCT wr.wr_order_number) AS total_returns, SUM(wr.wr_return_quantity) AS total_items_returned, AVG(wr.wr_return_amt) AS average_return_amount, SUM(wr.wr_net_loss) AS total_loss FROM catalog_sales cs JOIN ship_mode sm ON cs.cs_ship_mode_sk = sm.sm_ship_mode_sk LEFT JOIN web_returns wr ON cs.cs_order_number = wr.wr_order_number AND cs.cs_item_sk = wr.wr_item_sk JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk WHERE sm.sm_type IN ('REGULAR', 'OVERNIGHT') AND cd.cd_gender IN ('M', 'F') AND cs.cs_quantity IN (91, 62, 46, 68, 45) AND (wr.wr_returned_time_sk = 74117 OR wr.wr_returned_time_sk IS NULL) GROUP BY sm.sm_type ORDER BY total_revenue DESC, total_loss ASC;
SELECT i.i_category AS product_category, AVG(i.i_current_price) AS avg_item_price, COUNT(DISTINCT w.wr_order_number) AS total_orders, SUM(w.wr_return_quantity) AS total_items_returned, SUM(w.wr_return_amt) AS total_amount_returned, SUM(w.wr_net_loss) AS total_net_loss FROM item i JOIN web_returns w ON i.i_item_sk = w.wr_item_sk JOIN time_dim t ON t.t_time_sk = w.wr_returned_time_sk JOIN web_page wp ON w.wr_web_page_sk = wp.wp_web_page_sk JOIN customer c ON w.wr_refunded_customer_sk = c.c_customer_sk WHERE w.wr_return_quantity > 0 AND i.i_category IS NOT NULL AND c.c_last_review_date_sk = 2452428 AND (w.wr_refunded_cdemo_sk IN (1473865, 1053973, 323984, 999712) OR w.wr_return_quantity IN (92, 41)) GROUP BY i.i_category ORDER BY total_net_loss DESC, total_amount_returned DESC;
SELECT cc_state, cc_city, ca_country, COUNT(DISTINCT cc_call_center_sk) AS number_of_call_centers, SUM(cc_employees) AS total_employees, AVG(cc_tax_percentage) AS avg_tax_percentage, SUM(s_number_employees) AS total_store_employees, AVG(s_tax_precentage) AS avg_store_tax, SUM(ws_quantity) AS total_items_sold, SUM(ws_net_paid) AS total_revenue, SUM(ws_net_profit) AS total_profit, AVG(ws_net_profit) AS avg_profit_per_sale, SUM(ws_ext_ship_cost) AS total_shipping_cost FROM call_center JOIN store ON cc_zip = s_zip JOIN web_sales ON ws_ship_addr_sk IN (SELECT ca_address_sk FROM customer_address WHERE ca_zip = cc_zip) JOIN customer_address ON cc_zip = ca_zip WHERE cc_hours IN ('8AM-4PM', '8AM-8AM') AND ws_net_profit NOT IN (-1167.89, -63.88, -192.70, -49.59) AND ca_country = 'United States' AND ca_gmt_offset IN (-8.00, -9.00) GROUP BY cc_state, cc_city, ca_country ORDER BY total_profit DESC;
SELECT i.i_category, i.i_brand, COUNT(DISTINCT ss.ss_ticket_number) AS num_sales, SUM(ss.ss_quantity) AS total_quantity_sold, AVG(ss.ss_sales_price) AS avg_sales_price, SUM(ss.ss_net_paid) AS total_net_paid, SUM(ss.ss_net_paid_inc_tax) AS total_net_paid_inc_tax, SUM(ss.ss_net_profit) AS total_net_profit, hd.hd_dep_count AS avg_dep_count, AVG(hd.hd_vehicle_count) AS avg_vehicle_count, AVG(ib.ib_lower_bound) AS avg_income_lower_bound, AVG(ib.ib_upper_bound) AS avg_income_upper_bound FROM store_sales ss JOIN item i ON ss.ss_item_sk = i.i_item_sk JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk JOIN income_band ib ON hd.hd_income_band_sk = ib.ib_income_band_sk JOIN time_dim t ON ss.ss_sold_time_sk = t.t_time_sk JOIN warehouse w ON ss.ss_addr_sk = w.w_warehouse_sk WHERE i.i_rec_start_date <= '2023-01-01' AND (i.i_rec_end_date IS NULL OR i.i_rec_end_date > '2023-01-01') AND t.t_second IN ('17', '49', '15', '2', '36') AND c.c_last_name IN ('Wing', 'Lemus', 'Guerra') AND w.w_warehouse_sq_ft IN (621234, 294242, 977787, 138504) GROUP BY i.i_category, i.i_brand, hd.hd_dep_count ORDER BY total_net_profit DESC, total_net_paid DESC, i.i_category, i.i_brand;
SELECT i.i_category, i.i_size, hd.hd_buy_potential, COUNT(p.p_promo_sk) AS total_promotions, SUM(p.p_cost) AS total_promo_cost, AVG(p.p_cost) AS average_promo_cost, CASE WHEN p.p_channel_catalog = 'N' THEN 'Not Catalog' ELSE 'Catalog' END AS promo_channel_catalog, SUM(CASE WHEN p.p_discount_active = 'Y' THEN 1 ELSE 0 END) AS active_discounts FROM promotion p JOIN item i ON p.p_item_sk = i.i_item_sk JOIN household_demographics hd ON i.i_size = hd.hd_buy_potential JOIN customer_demographics cd ON hd.hd_income_band_sk = cd.cd_purchase_estimate WHERE i.i_size IN ('economy', 'medium', 'large') AND hd.hd_buy_potential IN ('>10000', 'Unknown', '0-500', '5001-10000', '1001-5000', '501-1000') AND p.p_channel_catalog = 'N' AND i.i_category_id = '8' AND p.p_purpose NOT IN ('Unknown') GROUP BY i.i_category, i.i_size, hd.hd_buy_potential, promo_channel_catalog ORDER BY total_promotions DESC, total_promo_cost DESC;
SELECT ws.ws_web_site_sk, ws_item_sk, web_country, SUM(ws_sales_price) AS total_sales_price, AVG(ws_sales_price) AS avg_sales_price, COUNT(ws_order_number) AS total_orders, SUM(ws_quantity) AS total_quantity_sold, SUM(ws_net_profit) AS total_net_profit, SUM(wr_return_quantity) AS total_return_quantity, SUM(wr_return_amt) AS total_return_amount, AVG(wr_fee) AS avg_return_fee, COUNT(DISTINCT wr_order_number) AS total_returned_orders FROM web_sales ws JOIN web_site wsite ON ws.ws_web_site_sk = wsite.web_site_sk LEFT JOIN web_returns wr ON ws.ws_order_number = wr.wr_order_number AND ws.ws_item_sk = wr.wr_item_sk WHERE wsite.web_country = 'United States' AND ws.ws_net_paid BETWEEN 141.68 AND 2100.98 AND ws.ws_warehouse_sk = 3 GROUP BY ws.ws_web_site_sk, ws_item_sk, web_country ORDER BY total_net_profit DESC, total_sales_price DESC;
SELECT c.c_last_name, c.c_first_name, c.c_email_address, SUM(ss.ss_net_paid) AS total_sales, AVG(ss.ss_quantity) AS avg_quantity_sold, COUNT(DISTINCT ss.ss_ticket_number) AS number_of_transactions, SUM(wr.wr_fee) AS total_return_fees, AVG(wr.wr_return_quantity) AS avg_return_quantity, COUNT(DISTINCT wr.wr_order_number) AS number_of_returns, r.r_reason_desc AS most_common_return_reason FROM store_sales ss JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk LEFT JOIN web_returns wr ON wr.wr_returning_customer_sk = c.c_customer_sk LEFT JOIN reason r ON wr.wr_reason_sk = r.r_reason_sk WHERE c.c_birth_day IN (12, 23, 14, 10, 22, 11) AND r.r_reason_desc IN ('Wrong size', 'unauthoized purchase', 'reason 32') GROUP BY c.c_last_name, c.c_first_name, c.c_email_address, r.r_reason_desc ORDER BY total_sales DESC, total_return_fees DESC;
SELECT ca.ca_state, SUM(ss.ss_quantity) AS total_quantity_sold, AVG(ss.ss_sales_price) AS avg_sales_price, SUM(ss.ss_net_paid) AS total_net_paid, SUM(ss.ss_net_profit) AS total_net_profit, COUNT(DISTINCT ss.ss_ticket_number) AS total_sales_transactions, SUM(CASE WHEN p.p_channel_event = 'N' THEN ss.ss_quantity ELSE 0 END) AS quantity_sold_no_event_channel, SUM(CASE WHEN p.p_channel_email = 'N' THEN ss.ss_quantity ELSE 0 END) AS quantity_sold_no_email_channel, COUNT(DISTINCT i.inv_warehouse_sk) AS distinct_warehouses_stocked, AVG(i.inv_quantity_on_hand) AS avg_quantity_on_hand FROM store_sales ss JOIN customer_address ca ON ss.ss_addr_sk = ca.ca_address_sk LEFT JOIN promotion p ON ss.ss_promo_sk = p.p_promo_sk LEFT JOIN inventory i ON ss.ss_item_sk = i.inv_item_sk WHERE i.inv_warehouse_sk IN (1, 2) AND i.inv_date_sk = 2450815 GROUP BY ca.ca_state ORDER BY total_net_profit DESC, ca.ca_state;
SELECT sm.sm_type AS shipping_type, web.web_site_sk, web.web_name AS website_name, COUNT(DISTINCT ws.ws_order_number) AS total_orders, SUM(ws.ws_net_paid) AS total_revenue, AVG(ws.ws_quantity) AS average_quantity, AVG(ws.ws_ext_discount_amt) AS average_discount, SUM(ws.ws_coupon_amt) AS total_coupon_amount, SUM(ws.ws_net_profit) AS total_profit FROM web_sales ws JOIN web_site web ON ws.ws_web_site_sk = web.web_site_sk JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk WHERE web.web_name IN ('site_3', 'site_4', 'site_1', 'site_0', 'site_2') AND sm.sm_contract IN ('GNJr3g5i7oorKqtX', 'uukTktPYycct8', 'ldhM8IvpzHgdbBgDfI', '2mM8l') AND ws.ws_sold_date_sk BETWEEN 20230101 AND 20231231 GROUP BY sm.sm_type, web.web_site_sk, web.web_name ORDER BY total_revenue DESC;
SELECT cc_state, i_category, SUM(cs_quantity) AS total_quantity, AVG(cs_sales_price) AS avg_sales_price, COUNT(DISTINCT cs_order_number) AS unique_orders, SUM(ss_net_profit) AS total_store_profit, AVG(ss_wholesale_cost) AS avg_store_wholesale_cost, COUNT(DISTINCT ss_ticket_number) AS unique_store_tickets, SUM(inv_quantity_on_hand) AS total_inventory, COUNT(DISTINCT p_promo_sk) AS distinct_promotions FROM call_center JOIN catalog_sales ON cc_call_center_sk = cs_call_center_sk JOIN item ON cs_item_sk = i_item_sk JOIN store_sales ON ss_item_sk = i_item_sk JOIN inventory ON inv_item_sk = i_item_sk JOIN promotion ON (cs_promo_sk = p_promo_sk OR ss_promo_sk = p_promo_sk) JOIN store ON ss_store_sk = s_store_sk WHERE cc_mkt_id IN ('6', '2', '5') AND cc_state = 'TN' AND inv_item_sk IN ('15746', '11656', '6211', '11858') AND i_item_sk IN ('2579', '2638', '2347', '3924', '3976', '4905') AND s_store_sk IN ('8', '11', '6') GROUP BY cc_state, i_category;
SELECT SUM(cr_return_amount) AS total_catalog_returns, AVG(sr_return_amt) AS average_store_returns, COUNT(DISTINCT ss_customer_sk) AS unique_customers_making_purchases, SUM(ss_net_paid_inc_tax) AS total_sales_revenue_inc_tax, SUM(ss_net_profit) AS total_sales_net_profit FROM catalog_returns JOIN store_returns ON cr_item_sk = sr_item_sk AND cr_order_number = sr_ticket_number JOIN store_sales ON cr_item_sk = ss_item_sk AND cr_order_number = ss_ticket_number WHERE cr_refunded_addr_sk IN ('48782', '39638', '44776', '9470') AND cr_catalog_page_sk IN ('238', '365', '2') AND sr_return_tax IN ('34.09', '13.62') GROUP BY cr_refunded_addr_sk;
SELECT cc.cc_name AS call_center_name, w.w_warehouse_name AS warehouse_name, s.s_state AS state, SUM(cs.cs_quantity) AS total_items_sold, AVG(cs.cs_sales_price) AS average_sales_price, COUNT(DISTINCT cs.cs_item_sk) AS number_of_unique_items_sold FROM catalog_sales cs INNER JOIN call_center cc ON cs.cs_call_center_sk = cc.cc_call_center_sk INNER JOIN warehouse w ON cs.cs_warehouse_sk = w.w_warehouse_sk INNER JOIN store s ON cc.cc_division = s.s_division_id WHERE cc.cc_market_manager IN ('Matthew Clifton', 'Gary Colburn') AND s.s_country = 'United States' GROUP BY call_center_name, warehouse_name, state ORDER BY total_items_sold DESC, average_sales_price DESC;
SELECT ca.ca_state, ca.ca_city, sum(cs.cs_quantity) AS total_quantity_sold, avg(cs.cs_sales_price) AS average_sales_price, count(distinct cs.cs_order_number) AS total_orders, cd.cd_education_status, sum(cs.cs_net_profit) AS total_net_profit, count(distinct cs.cs_item_sk) AS unique_items_sold, ib.ib_lower_bound, ib.ib_upper_bound FROM catalog_sales cs JOIN customer_address ca ON cs.cs_ship_addr_sk = ca.ca_address_sk JOIN customer_demographics cd ON cs.cs_ship_cdemo_sk = cd.cd_demo_sk JOIN income_band ib ON cd.cd_purchase_estimate BETWEEN ib.ib_lower_bound AND ib.ib_upper_bound WHERE ca.ca_county = 'Lonoke County' AND (cd.cd_gender = 'M' OR cd.cd_gender = 'F') GROUP BY ca.ca_state, ca.ca_city, cd.cd_education_status, ib.ib_lower_bound, ib.ib_upper_bound ORDER BY ca.ca_state, ca.ca_city, cd.cd_education_status, total_net_profit DESC;
SELECT s_store_name, s_state, COUNT(sr_ticket_number) AS total_returns, SUM(sr_return_amt) AS total_return_amount, AVG(sr_return_quantity) AS average_return_quantity, SUM(ws_net_paid_inc_tax) AS total_sales_inc_tax, AVG(ws_list_price) AS average_list_price, AVG(ws_net_profit) AS average_net_profit FROM store s JOIN store_returns sr ON s.s_store_sk = sr.sr_store_sk JOIN web_sales ws ON sr.sr_item_sk = ws.ws_item_sk JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk WHERE c.c_email_address IN ( 'Adam.Chambers@1fmL5RoSch74.edu', 'William.Kaye@Mx1n74bCJjkc08.edu', 'Imogene.Lewis@813MelxMLZ9gy.com', 'Dorothy.Garza@6Tn1dJ431OQYNTb.org', 'Ora.Spain@CT.edu', 'Denise.Gomez@3GlO.edu' ) AND ws.ws_net_paid_inc_tax IN (15407.14, 2937.00, 988.50, 3439.64, 992.77) AND ws.ws_list_price IN (177.80, 201.11) AND hd.hd_income_band_sk IN (16, 7) AND sr.sr_return_tax IN (215.85, 29.41, 35.05, 67.89) GROUP BY s_store_name, s_state ORDER BY total_return_amount DESC;
SELECT i.i_category, ib.ib_income_band_sk, AVG(cs.cs_sales_price) AS avg_sales_price, SUM(cs.cs_net_paid_inc_ship_tax) AS total_sales, COUNT(DISTINCT cs.cs_order_number) AS total_orders, SUM(cr.cr_return_amount) AS total_returns, COUNT(DISTINCT cr.cr_order_number) AS total_return_orders FROM catalog_sales cs JOIN item i ON cs.cs_item_sk = i.i_item_sk JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk JOIN income_band ib ON c.c_current_cdemo_sk = ib.ib_income_band_sk LEFT JOIN catalog_returns cr ON cs.cs_order_number = cr.cr_order_number WHERE cs.cs_sold_date_sk IS NOT NULL AND ( ib.ib_lower_bound IN (110001, 190001, 30001) OR ib.ib_income_band_sk IN (1, 9, 3) ) GROUP BY i.i_category, ib.ib_income_band_sk ORDER BY total_sales DESC, total_returns DESC;
SELECT w.w_city AS warehouse_city, i.i_manufact AS item_manufacturer, i.i_brand AS item_brand, i.i_category AS item_category, COUNT(DISTINCT i.i_item_sk) AS item_count, AVG(i.i_current_price) AS avg_price, SUM(inv.inv_quantity_on_hand) AS total_quantity, AVG(ca.ca_gmt_offset) AS avg_gmt_offset, cd.cd_education_status AS customer_education_status, COUNT(DISTINCT ca.ca_address_sk) AS customer_address_count FROM inventory inv JOIN item i ON inv.inv_item_sk = i.i_item_sk JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk JOIN customer_address ca ON w.w_state = ca.ca_state JOIN customer_demographics cd ON ca.ca_zip = cd.cd_purchase_estimate::character varying WHERE w.w_city = 'Fairview' AND i.i_manufact = 'ableeseeing' AND i.i_brand = 'edu packbrand #7' AND inv.inv_date_sk BETWEEN 100 AND 200 AND ca.ca_county LIKE 'Fairview%' GROUP BY w.w_city, i.i_manufact, i.i_brand, i.i_category, cd.cd_education_status ORDER BY w.w_city, i.i_manufact, i.i_brand, i.i_category, cd.cd_education_status;
SELECT cc.cc_country, dd.d_year, sm.sm_type, COUNT(DISTINCT cc.cc_call_center_sk) AS num_call_centers, SUM(hd.hd_vehicle_count) AS total_vehicles, AVG(hd.hd_dep_count) AS avg_dep_count, COUNT(DISTINCT cp.cp_catalog_page_sk) AS num_catalog_pages FROM call_center cc JOIN date_dim dd ON cc.cc_open_date_sk = dd.d_date_sk JOIN household_demographics hd ON cc.cc_mkt_id = hd.hd_income_band_sk JOIN catalog_page cp ON cc.cc_division = cp.cp_catalog_number JOIN ship_mode sm ON cc.cc_company = sm.sm_carrier::integer WHERE cc.cc_country = 'United States' AND hd.hd_demo_sk IN ('2794', '432') AND hd.hd_income_band_sk IN ('7', '2', '11', '12') AND dd.d_current_year = 'N' AND cp.cp_catalog_page_id IN ('AAAAAAAACKOAAAAA', 'AAAAAAAAODAAAAAA', 'AAAAAAAAEBMAAAAA', 'AAAAAAAAGLCBAAAA') AND dd.d_same_day_lq = '2419796' GROUP BY cc.cc_country, dd.d_year, sm.sm_type ORDER BY dd.d_year, sm.sm_type;
SELECT d.d_year, d.d_quarter_name, s.s_state, sm.sm_type, COUNT(DISTINCT cs.cs_order_number) AS total_orders, SUM(cs.cs_quantity) AS total_quantity_sold, SUM(cs.cs_net_paid) AS total_revenue, AVG(cs.cs_sales_price) AS average_sales_price, SUM(cs.cs_net_profit) AS total_profit FROM catalog_sales cs JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk JOIN store s ON cs.cs_ship_addr_sk = s.s_store_sk JOIN ship_mode sm ON cs.cs_ship_mode_sk = sm.sm_ship_mode_sk WHERE d.d_year = (SELECT MAX(d_year) FROM date_dim) - 1 AND s.s_rec_end_date IS NULL GROUP BY d.d_year, d.d_quarter_name, s.s_state, sm.sm_type ORDER BY d.d_year, d.d_quarter_name, s.s_state, sm.sm_type;
SELECT dd.d_year, dd.d_quarter_name, sm.sm_type, COUNT(DISTINCT inv.inv_item_sk) AS distinct_items_count, SUM(inv.inv_quantity_on_hand) AS total_quantity, AVG(i.i_wholesale_cost) AS avg_wholesale_cost, AVG(i.i_current_price) AS avg_current_price, (SUM(i.i_current_price * inv.inv_quantity_on_hand) - SUM(i.i_wholesale_cost * inv.inv_quantity_on_hand)) AS total_profit, COUNT(DISTINCT cc.cc_call_center_sk) AS call_centers_count, COUNT(DISTINCT w.w_warehouse_sk) AS warehouses_count, COUNT(DISTINCT ws.web_site_sk) AS web_sites_count FROM inventory inv JOIN item i ON inv.inv_item_sk = i.i_item_sk JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk JOIN date_dim dd ON inv.inv_date_sk = dd.d_date_sk JOIN call_center cc ON cc.cc_open_date_sk <= dd.d_date_sk AND (cc.cc_rec_end_date IS NULL OR cc.cc_rec_end_date >= dd.d_date) JOIN web_site ws ON ws.web_open_date_sk <= dd.d_date_sk AND (ws.web_rec_end_date IS NULL OR ws.web_rec_end_date >= dd.d_date) JOIN ship_mode sm ON sm.sm_code = 'AIR' WHERE dd.d_current_month = 'N' AND w.w_state = 'TN' AND w.w_city = 'Fairview' AND w.w_county = 'Williamson County' AND (cc.cc_class = 'large' OR cc.cc_class = 'medium') AND (i.i_color = 'forest' OR i.i_color = 'navy') AND ws.web_class <> 'Unknown' AND ws.web_gmt_offset = '-5.00' AND ws.web_company_id IN (3, 4, 5) GROUP BY dd.d_year, dd.d_quarter_name, sm.sm_type ORDER BY dd.d_year, dd.d_quarter_name, sm.sm_type;
SELECT ca.ca_state AS customer_state, cp.cp_department AS department, AVG(cr.cr_return_amount) AS avg_return_amount, COUNT(cr.cr_item_sk) AS total_return_count, SUM(cr.cr_net_loss) AS total_net_loss, SUM(p.p_cost) AS total_promotion_cost FROM catalog_returns cr JOIN customer_address ca ON cr.cr_returning_addr_sk = ca.ca_address_sk JOIN catalog_page cp ON cr.cr_catalog_page_sk = cp.cp_catalog_page_sk JOIN promotion p ON cp.cp_catalog_page_sk = p.p_item_sk WHERE cp.cp_department IN ('Electronics', 'Home & Garden', 'Books') AND p.p_cost > 1000 AND cp.cp_end_date_sk IN (2450934, 2451664) AND ca.ca_state = 'CA' AND ca.ca_gmt_offset = -8.00 GROUP BY customer_state, department ORDER BY total_net_loss DESC, total_return_count DESC;
