SELECT cd.cd_education_status, cd.cd_credit_rating, COUNT(c.c_customer_sk) AS total_customers, AVG(cd.cd_purchase_estimate) AS avg_purchase_estimate, SUM(cd.cd_dep_count) AS total_dependents, SUM(cd.cd_dep_employed_count) AS employed_dependents, SUM(cd.cd_dep_college_count) AS college_dependents FROM customer_demographics cd JOIN customer c ON cd.cd_demo_sk = c.c_current_cdemo_sk LEFT JOIN promotion p ON c.c_current_hdemo_sk = p.p_promo_sk WHERE cd.cd_credit_rating IN ('High Risk', 'Low Risk', 'Good', 'Unknown') AND c.c_last_review_date_sk IN (2452297, 2452588) GROUP BY cd.cd_education_status, cd.cd_credit_rating ORDER BY cd.cd_education_status, cd.cd_credit_rating;
SELECT c.c_first_name, c.c_last_name, sm.sm_type AS shipping_type, COUNT(ss.ss_ticket_number) AS total_sales_transactions, SUM(ss.ss_quantity) AS total_quantity_sold, AVG(ss.ss_sales_price) AS average_sales_price, SUM(ss.ss_net_profit) AS total_net_profit, SUM(sr.sr_return_quantity) AS total_returned_quantity, AVG(sr.sr_return_amt) AS average_return_amount, SUM(wr.wr_return_quantity) AS total_web_returned_quantity, AVG(wr.wr_return_amt) AS average_web_return_amount, COUNT(DISTINCT p.p_promo_sk) AS number_of_promotions, SUM(ws.ws_quantity) AS total_web_quantity_sold, AVG(ws.ws_sales_price) AS average_web_sales_price, SUM(ws.ws_net_profit) AS total_web_net_profit FROM customer c LEFT JOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk LEFT JOIN store_returns sr ON c.c_customer_sk = sr.sr_customer_sk LEFT JOIN web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk LEFT JOIN web_returns wr ON c.c_customer_sk = wr.wr_refunded_customer_sk LEFT JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk LEFT JOIN promotion p ON ss.ss_promo_sk = p.p_promo_sk OR ws.ws_promo_sk = p.p_promo_sk WHERE c.c_first_sales_date_sk IN (2450046, 2449304, 2451981, 2451206, 2449744) AND sm.sm_code IN ('SEA', 'BIKE', 'AIR', 'SURFACE') GROUP BY c.c_first_name, c.c_last_name, sm.sm_type ORDER BY total_net_profit DESC, total_web_net_profit DESC LIMIT 100;
SELECT i.i_category, i.i_brand, COUNT(DISTINCT cs_order_number) AS total_orders, SUM(cs_quantity) AS total_quantity_sold, AVG(cs_sales_price) AS average_sales_price, SUM(cs_net_paid) AS total_net_paid, SUM(cs_net_profit) AS total_net_profit, AVG(hd_dep_count) AS average_dependency_count, AVG(hd_vehicle_count) AS average_vehicle_count FROM catalog_sales cs JOIN item i ON cs.cs_item_sk = i.i_item_sk JOIN household_demographics hd ON cs.cs_ship_hdemo_sk = hd.hd_demo_sk WHERE i.i_category = 'Men' AND (i.i_color = 'lawn' OR i.i_color = 'peach' OR i.i_color = 'red') AND cs.cs_catalog_page_sk IN (118, 44) AND hd.hd_demo_sk IN (714, 1213, 4049, 4231, 2781, 3780) GROUP BY i.i_category, i.i_brand ORDER BY total_net_profit DESC, total_orders DESC;
SELECT d_year, p_channel_details, COUNT(DISTINCT ws_order_number) AS web_order_count, SUM(ws_net_paid) AS total_web_sales, SUM(ws_net_profit) AS total_web_profit, AVG(ws_quantity) AS average_quantity_sold, SUM(ss_net_paid) AS total_store_sales, SUM(ss_net_profit) AS total_store_profit, AVG(ss_quantity) AS average_store_quantity_sold FROM web_sales JOIN store_sales ON ws_item_sk = ss_item_sk JOIN date_dim ON ws_sold_date_sk = d_date_sk JOIN promotion ON ws_promo_sk = p_promo_sk WHERE d_year IN (1902, 1903, 1904) AND p_channel_details IS NOT NULL AND (ws_net_paid > 0 OR ss_net_paid > 0) GROUP BY d_year, p_channel_details ORDER BY d_year, p_channel_details;
SELECT dd.d_year AS year, dd.d_moy AS month, dd.d_month_seq AS month_sequence, cp.cp_department AS department, COUNT(cp.cp_catalog_page_sk) AS catalog_page_count, AVG(dd.d_dom) AS average_day_of_month, SUM(CASE WHEN dd.d_weekend = 'Y' THEN 1 ELSE 0 END) AS weekend_days, SUM(CASE WHEN dd.d_holiday = 'Y' THEN 1 ELSE 0 END) AS holiday_days, COUNT(DISTINCT ws.web_site_sk) AS unique_web_sites FROM date_dim dd JOIN catalog_page cp ON dd.d_date_sk BETWEEN cp.cp_start_date_sk AND cp.cp_end_date_sk JOIN web_site ws ON ws.web_open_date_sk <= dd.d_date_sk AND (ws.web_close_date_sk IS NULL OR ws.web_close_date_sk >= dd.d_date_sk) WHERE dd.d_current_month = 'N' AND cp.cp_department = 'DEPARTMENT' AND ws.web_manager IN ('Dwight Aaron', 'Jimmy Pope', 'James Austin', 'Harold Wilson', 'Marshall Conner', 'Charles Castillo') GROUP BY year, month, month_sequence, department ORDER BY year, month_sequence, department;
SELECT ca_state, cp_department, p_promo_name, SUM(ss_quantity) AS total_quantity_sold, AVG(ss_sales_price) AS average_sales_price, COUNT(DISTINCT ss_customer_sk) AS unique_customers, SUM(ss_net_paid) AS total_net_paid, SUM(ss_net_profit) AS total_net_profit FROM store_sales JOIN promotion ON ss_promo_sk = p_promo_sk JOIN customer_address ON ss_addr_sk = ca_address_sk JOIN catalog_page ON ss_item_sk = cp_catalog_page_sk WHERE p_end_date_sk IN ('2450360', '2450791', '2450178', '2450468', '2450825') GROUP BY ca_state, cp_department, p_promo_name ORDER BY ca_state, cp_department, p_promo_name;
SELECT ca.ca_country, ca.ca_state, COUNT(DISTINCT sr.sr_ticket_number) AS num_returns, SUM(sr.sr_return_amt) AS total_return_amount, AVG(sr.sr_return_amt) AS avg_return_amount, SUM(sr.sr_return_quantity) AS total_returned_quantity, SUM(sr.sr_fee) AS total_fees, SUM(sr.sr_net_loss) AS total_net_loss FROM store_returns sr JOIN customer_address ca ON sr.sr_addr_sk = ca.ca_address_sk JOIN store s ON sr.sr_store_sk = s.s_store_sk WHERE ca.ca_country = 'United States' AND s.s_rec_start_date BETWEEN '1997-03-13' AND '2001-03-13' AND s.s_number_employees BETWEEN 236 AND 288 AND sr.sr_returned_date_sk IN ('2452372', '2451953', '2452254') GROUP BY ca.ca_country, ca.ca_state ORDER BY total_return_amount DESC;
SELECT ca_state, i_category, COUNT(DISTINCT sr_customer_sk) AS unique_customers, SUM(sr_return_quantity) AS total_returned_quantity, AVG(sr_return_amt) AS average_return_amount, SUM(sr_return_amt) AS total_return_amount, SUM(sr_fee) AS total_fees_collected, SUM(sr_net_loss) AS total_net_loss FROM store_returns JOIN item ON sr_item_sk = i_item_sk JOIN customer_address ON sr_addr_sk = ca_address_sk WHERE sr_returned_date_sk IS NOT NULL AND sr_store_sk IN (4, 8, 10, 7, 2) AND ca_street_type = 'Cir.' GROUP BY ca_state, i_category ORDER BY ca_state, i_category;
SELECT ib.ib_income_band_sk, ib.ib_lower_bound, ib.ib_upper_bound, COUNT(DISTINCT cs.cs_order_number) AS total_orders, SUM(cs.cs_quantity) AS total_quantity_sold, AVG(cs.cs_sales_price) AS average_sales_price, SUM(cs.cs_net_profit) AS total_net_profit, AVG(hd.hd_dep_count) AS average_dependency_count, AVG(hd.hd_vehicle_count) AS average_vehicle_count, SUM(ws.ws_net_paid_inc_ship) AS total_web_net_paid_inc_ship, AVG(ws.ws_net_paid_inc_ship) AS average_web_net_paid_inc_ship, SUM(ws.ws_quantity) AS total_web_quantity_sold, COUNT(DISTINCT ws.ws_order_number) AS total_web_orders, s.s_country, s.s_tax_precentage, MAX(t.t_time) AS max_time_of_purchase, MIN(t.t_time) AS min_time_of_purchase FROM income_band ib LEFT JOIN household_demographics hd ON ib.ib_income_band_sk = hd.hd_income_band_sk LEFT JOIN catalog_sales cs ON hd.hd_demo_sk = cs.cs_bill_hdemo_sk LEFT JOIN web_sales ws ON hd.hd_demo_sk = ws.ws_bill_hdemo_sk LEFT JOIN store s ON s.s_store_sk = cs.cs_warehouse_sk LEFT JOIN time_dim t ON t.t_time_sk = cs.cs_sold_time_sk WHERE s.s_country = 'United States' AND t.t_am_pm = 'AM' AND s.s_tax_precentage IN (0.08, 0.01) AND ws.ws_net_paid_inc_ship IN (1475.10, 4030.95, 1226.89, 21728.07) AND t.t_second = 36 GROUP BY ib.ib_income_band_sk, s.s_country, s.s_tax_precentage ORDER BY total_net_profit DESC, total_web_net_paid_inc_ship DESC;
SELECT s.s_store_name, count(distinct ss.ss_ticket_number) as total_sales_transactions, sum(ss.ss_quantity) as total_items_sold, sum(ss.ss_net_paid_inc_tax) as total_sales_revenue, sum(cr.cr_return_quantity) as total_items_returned, sum(cr.cr_return_amt_inc_tax) as total_returned_revenue, sum(inv.inv_quantity_on_hand) as total_inventory_quantity FROM store_sales ss JOIN store s ON ss.ss_store_sk = s.s_store_sk LEFT JOIN catalog_returns cr ON ss.ss_item_sk = cr.cr_item_sk AND ss.ss_ticket_number = cr.cr_order_number LEFT JOIN inventory inv ON ss.ss_item_sk = inv.inv_item_sk WHERE s.s_country = 'United States' AND (inv.inv_item_sk = 12400 OR inv.inv_item_sk = 10369 OR inv.inv_item_sk = 8875) AND (ss.ss_ext_list_price = 5535.38 OR ss.ss_ext_list_price = 6147.90 OR ss.ss_ext_list_price = 8470.00 OR ss.ss_ext_list_price = 4720.95 OR ss.ss_ext_list_price = 5696.87 OR ss.ss_ext_list_price = 37.40) AND (cr.cr_return_tax = 123.73 OR cr.cr_return_tax = 44.47 OR cr.cr_return_tax = 115.68 OR cr.cr_return_tax = 4.37) GROUP BY s.s_store_name;
SELECT s_state, s_city, p_channel_demo, p_promo_name, COUNT(DISTINCT sr_ticket_number) AS total_returns, SUM(sr_return_quantity) AS total_returned_quantity, AVG(sr_return_amt) AS average_return_amount, SUM(sr_net_loss) AS total_net_loss, COUNT(DISTINCT ss_ticket_number) AS total_sales, SUM(ss_quantity) AS total_sold_quantity, AVG(ss_sales_price) AS average_sales_price, SUM(ss_net_profit) AS total_net_profit FROM store_returns sr JOIN store s ON sr.sr_store_sk = s.s_store_sk JOIN store_sales ss ON sr.sr_item_sk = ss.ss_item_sk AND sr.sr_ticket_number = ss.ss_ticket_number JOIN promotion p ON ss.ss_promo_sk = p.p_promo_sk GROUP BY s_state, s_city, p_channel_demo, p_promo_name ORDER BY s_state, s_city, p_channel_demo, p_promo_name;
SELECT ib_lower_bound, ib_upper_bound, ca_state, ca_city, AVG(ss_quantity) AS avg_quantity_sold, SUM(ss_net_paid) AS total_net_paid, SUM(ss_net_paid_inc_tax) AS total_net_paid_inc_tax, SUM(ss_net_profit) AS total_net_profit, COUNT(DISTINCT ss_customer_sk) AS unique_customers_count FROM store_sales JOIN customer_address ON store_sales.ss_addr_sk = customer_address.ca_address_sk JOIN household_demographics ON store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk JOIN income_band ON household_demographics.hd_income_band_sk = income_band.ib_income_band_sk WHERE ca_zip IN ('65804', '18828', '28767', '57995') AND ss_sold_time_sk IN ('64456', '55232', '34662', '70640') AND ss_quantity IN (14, 26, 7, 79, 8, 63) GROUP BY ib_lower_bound, ib_upper_bound, ca_state, ca_city ORDER BY ca_state, ca_city, ib_lower_bound, ib_upper_bound;
SELECT i_category, i_brand, COUNT(DISTINCT i_item_sk) AS total_items, SUM(i_current_price) AS total_sales_value, AVG(i_wholesale_cost) AS average_wholesale_cost FROM item WHERE i_units IN ('Dozen', 'Bundle', 'Lb') AND i_manufact IN ('eseantieing', 'ableablepri') GROUP BY i_category, i_brand ORDER BY total_sales_value DESC LIMIT 100;
SELECT cu.c_salutation, wh.w_state, COUNT(DISTINCT cs.cs_order_number) AS total_sales_transactions, SUM(cs.cs_net_paid_inc_tax) AS total_sales_amount, AVG(cs.cs_ext_discount_amt) AS average_discount, COUNT(DISTINCT sr.sr_ticket_number) AS total_return_transactions, SUM(sr.sr_return_amt_inc_tax) AS total_return_amount FROM customer cu LEFT JOIN catalog_sales cs ON cu.c_customer_sk = cs.cs_ship_customer_sk LEFT JOIN store_returns sr ON cu.c_customer_sk = sr.sr_customer_sk LEFT JOIN warehouse wh ON (cs.cs_warehouse_sk = wh.w_warehouse_sk OR sr.sr_store_sk = wh.w_warehouse_sk) LEFT JOIN promotion p ON cs.cs_promo_sk = p.p_promo_sk WHERE (cs.cs_sold_date_sk IN ('2450819', '2450822', '2450817') OR sr.sr_returned_date_sk IN ('2450819', '2450822', '2450817')) AND (cu.c_salutation IN ('Dr.', 'Mr.', 'Sir', 'Ms.', 'Mrs.', 'Miss')) AND (wh.w_city = 'Fairview') AND (wh.w_suite_number IN ('Suite 80', 'Suite 0', 'Suite P', 'Suite 470')) AND (cu.c_last_review_date_sk IN ('2452425', '2452326', '2452389')) AND (sr.sr_reversed_charge IN ('44.04', '12.34') OR sr.sr_reversed_charge IS NULL) GROUP BY cu.c_salutation, wh.w_state ORDER BY total_sales_amount DESC, total_return_amount ASC;
SELECT w_state, COUNT(DISTINCT ss_store_sk) AS number_of_stores, SUM(ss_quantity) AS total_quantity_sold, SUM(ss_net_paid) AS total_net_paid, AVG(ss_wholesale_cost) AS average_wholesale_cost, AVG(ss_ext_discount_amt) AS average_discount_amount, COUNT(CASE WHEN ss_coupon_amt > 50 THEN ss_ticket_number END) AS count_high_coupon_sales FROM store_sales JOIN warehouse ON ss_addr_sk = w_warehouse_sk WHERE w_state = 'TN' AND w_suite_number = 'Suite 470' AND ss_coupon_amt > 50 GROUP BY w_state ORDER BY total_net_paid DESC;
SELECT s_state, s_city, ib_lower_bound, ib_upper_bound, AVG(s_number_employees) AS avg_employees, AVG(s_floor_space) AS avg_floor_space, SUM(w_warehouse_sq_ft) AS total_warehouse_sq_ft, COUNT(DISTINCT cp_catalog_page_sk) AS num_catalog_pages, AVG(hd_vehicle_count) AS avg_vehicle_count FROM store JOIN household_demographics ON (s_store_sk = hd_demo_sk) JOIN income_band ON (hd_income_band_sk = ib_income_band_sk) JOIN warehouse ON (s_zip = w_zip) JOIN catalog_page ON (s_market_id = cp_catalog_number) WHERE s_state = 'TN' AND (s_closed_date_sk IN (2450910, 2451189, 2451044) OR s_closed_date_sk IS NULL) AND hd_dep_count IN (2, 3, 4, 5, 8, 9) AND cp_end_date_sk IN (2451087, 2451114, 2450996, 2451664) AND w_warehouse_sq_ft IN (977787, 294242, 621234, 138504) AND w_warehouse_id IN ('AAAAAAAABAAAAAAA', 'AAAAAAAAEAAAAAAA', 'AAAAAAAADAAAAAAA', 'AAAAAAAAFAAAAAAA', 'AAAAAAAACAAAAAAA') GROUP BY s_state, s_city, ib_lower_bound, ib_upper_bound ORDER BY s_city, ib_lower_bound;
SELECT dd.d_year, dd.d_quarter_name, SUM(ws.ws_net_paid) AS total_net_paid, AVG(ws.ws_quantity) AS average_quantity, COUNT(*) AS sales_transactions, SUM(inv.inv_quantity_on_hand) AS total_inventory, COUNT(DISTINCT ws.ws_item_sk) AS distinct_items_sold, COUNT(DISTINCT s.s_store_sk) AS number_of_stores, SUM(cr.cr_return_amount) AS total_return_amount, AVG(cr.cr_return_quantity) AS average_return_quantity, COUNT(DISTINCT cr.cr_item_sk) AS distinct_items_returned FROM date_dim AS dd JOIN web_sales AS ws ON dd.d_date_sk = ws.ws_sold_date_sk JOIN inventory AS inv ON ws.ws_item_sk = inv.inv_item_sk AND ws.ws_sold_date_sk = inv.inv_date_sk JOIN store AS s ON ws.ws_bill_customer_sk = s.s_store_sk LEFT JOIN catalog_returns AS cr ON ws.ws_item_sk = cr.cr_item_sk AND ws.ws_order_number = cr.cr_order_number WHERE dd.d_current_year = 'N' AND ws.ws_promo_sk IS NOT NULL AND s.s_market_id IN (8, 2, 4, 7) AND inv.inv_warehouse_sk IN (1, 2) GROUP BY dd.d_year, dd.d_quarter_name ORDER BY dd.d_year, dd.d_quarter_name;
SELECT ca_state, r_reason_desc, COUNT(*) AS return_count, SUM(sr_return_amt) AS total_return_amount, AVG(sr_return_quantity) AS average_quantity_returned, SUM(sr_return_amt_inc_tax) AS total_amount_including_tax, SUM(sr_fee) AS total_fees, SUM(sr_return_ship_cost) AS total_shipping_costs, SUM(sr_refunded_cash) AS total_cash_refunded, SUM(sr_reversed_charge) AS total_reversed_charges, SUM(sr_store_credit) AS total_store_credit_issued, SUM(sr_net_loss) AS total_net_loss FROM store_returns JOIN reason ON store_returns.sr_reason_sk = reason.r_reason_sk JOIN customer_address ON store_returns.sr_addr_sk = customer_address.ca_address_sk WHERE (sr_reason_sk IN (13, 15, 26, 31, 21, 27)) AND (sr_reversed_charge IN (269.66, 29.95, 131.41, 123.32, 10.07, 1.54)) AND (sr_item_sk IN (6759, 10097, 13141, 10841, 4022)) GROUP BY ca_state, r_reason_desc ORDER BY ca_state, total_return_amount DESC;
SELECT cd.cd_education_status, cd.cd_marital_status, AVG(cd.cd_purchase_estimate) AS avg_purchase_estimate, COUNT(cd.cd_credit_rating) FILTER (WHERE cd.cd_credit_rating = 'High') AS high_credit_rating_count, COUNT(cd.cd_credit_rating) FILTER (WHERE cd.cd_credit_rating = 'Low') AS low_credit_rating_count, ib.ib_income_band_sk, ib.ib_lower_bound, ib.ib_upper_bound, COUNT(DISTINCT wr.wr_order_number) AS total_return_count, AVG(wr.wr_return_amt_inc_tax) AS avg_return_amount_inc_tax FROM customer_demographics cd JOIN household_demographics hd ON cd.cd_demo_sk = hd.hd_demo_sk JOIN income_band ib ON hd.hd_income_band_sk = ib.ib_income_band_sk LEFT JOIN web_returns wr ON cd.cd_demo_sk = wr.wr_refunded_cdemo_sk WHERE cd.cd_dep_employed_count = 0 AND cd.cd_marital_status IN ('W', 'S', 'D') AND ib.ib_lower_bound IN (180001, 190001, 30001, 50001) GROUP BY cd.cd_education_status, cd.cd_marital_status, ib.ib_income_band_sk, ib.ib_lower_bound, ib.ib_upper_bound ORDER BY avg_purchase_estimate DESC, total_return_count DESC, avg_return_amount_inc_tax DESC;
SELECT w_state, t_shift, sm_type as shipping_type, avg(hd_income_band_sk) as avg_income_band, sum(case when hd_buy_potential = 'High' then 1 else 0 end) as high_buy_potential_count, avg(hd_dep_count) as avg_dependent_count, avg(hd_vehicle_count) as avg_vehicle_count, count(distinct sm_ship_mode_sk) as shipping_mode_count FROM household_demographics hd JOIN warehouse w ON hd.hd_demo_sk = w.w_warehouse_sk JOIN time_dim td ON td.t_time_sk = w.w_warehouse_sk JOIN ship_mode sm ON sm.sm_ship_mode_sk = w.w_warehouse_sk WHERE hd.hd_dep_count IN (2, 3, 6, 9) AND hd.hd_vehicle_count IN (0, 1, 2, 3, 4) AND td.t_shift IS NOT NULL AND sm.sm_type IS NOT NULL GROUP BY w_state, t_shift, sm_type ORDER BY avg_income_band DESC, high_buy_potential_count DESC, avg_vehicle_count DESC;
SELECT s_state, EXTRACT(YEAR FROM s_rec_start_date) AS year_opened, COUNT(*) AS store_count, SUM(ss_net_profit) AS total_net_profit, AVG(hd_dep_count) AS avg_dependency_count, SUM(sr_return_amt) AS total_return_amount, AVG(sr_return_amt) AS avg_return_amount, SUM(sr_net_loss) AS total_net_loss FROM store JOIN store_sales ON s_store_sk = ss_store_sk JOIN household_demographics ON ss_hdemo_sk = hd_demo_sk JOIN store_returns ON s_store_sk = sr_store_sk WHERE s_state IN ('CA', 'TX', 'FL') AND s_closed_date_sk IS NULL AND ss_sold_date_sk BETWEEN 2451189 AND 2451489 AND sr_return_tax > 0 AND hd_buy_potential IN ('>10000', '5001-10000', '1001-5000') GROUP BY s_state, year_opened ORDER BY total_net_profit DESC, total_return_amount DESC;
SELECT cp_department, cd_gender, cd_marital_status, cd_education_status, COUNT(DISTINCT sr_ticket_number) AS total_returns, SUM(sr_return_quantity) AS total_returned_quantity, AVG(sr_return_amt) AS average_return_amount, SUM(sr_return_amt_inc_tax) AS total_return_amount_inc_tax, SUM(sr_fee) AS total_fees, SUM(sr_net_loss) AS total_net_loss FROM catalog_page JOIN store_returns ON cp_catalog_page_sk = sr_returned_date_sk JOIN customer_demographics ON cd_demo_sk = sr_cdemo_sk WHERE cp_department = 'DEPARTMENT' AND (cp_start_date_sk = 2451665 OR cp_start_date_sk = 2451360) GROUP BY cp_department, cd_gender, cd_marital_status, cd_education_status ORDER BY total_returned_quantity DESC;
SELECT cc.cc_call_center_id, cc.cc_name, cc.cc_class, ca.ca_street_type, COUNT(distinct ss.ss_ticket_number) AS total_sales_transactions, SUM(ss.ss_quantity) AS total_quantity_sold, SUM(ss.ss_net_paid) AS total_net_paid, AVG(ss.ss_sales_price) AS avg_sales_price, SUM(ss.ss_net_profit) AS total_net_profit, COUNT(distinct ss.ss_customer_sk) AS unique_customers_served FROM store_sales ss JOIN customer_address ca ON ss.ss_addr_sk = ca.ca_address_sk JOIN call_center cc ON cc.cc_class IN ('small', 'medium', 'large') LEFT JOIN reason r ON r.r_reason_desc = 'reason 31' WHERE ca.ca_street_type IN ('Pkwy', 'Court') AND r.r_reason_sk IS NULL GROUP BY cc.cc_call_center_id, cc.cc_name, cc.cc_class, ca.ca_street_type ORDER BY total_net_profit DESC, total_sales_transactions DESC;
SELECT cs.cs_call_center_sk, cc.cc_name AS call_center_name, cp.cp_catalog_page_id, cp.cp_department, COUNT(cs.cs_order_number) AS total_orders, SUM(cs.cs_quantity) AS total_quantity_sold, AVG(cs.cs_sales_price) AS avg_sales_price, SUM(cs.cs_net_paid) AS total_revenue, SUM(cs.cs_net_profit) AS total_profit, AVG(cs.cs_net_profit) AS avg_profit_per_sale, cd.cd_marital_status, COUNT(DISTINCT cs.cs_bill_customer_sk) AS unique_customers, SUM(inv.inv_quantity_on_hand) AS total_inventory_on_hand FROM catalog_sales cs LEFT JOIN call_center cc ON cs.cs_call_center_sk = cc.cc_call_center_sk LEFT JOIN catalog_page cp ON cs.cs_catalog_page_sk = cp.cp_catalog_page_sk LEFT JOIN customer_demographics cd ON cs.cs_bill_cdemo_sk = cd.cd_demo_sk LEFT JOIN inventory inv ON cs.cs_item_sk = inv.inv_item_sk AND cs_sold_date_sk = inv.inv_date_sk WHERE cc.cc_country = 'United States' AND cs.cs_net_profit > 0 AND inv.inv_date_sk = 2450815 GROUP BY cs.cs_call_center_sk, call_center_name, cp.cp_catalog_page_id, cp.cp_department, cd.cd_marital_status ORDER BY total_revenue DESC, total_profit DESC LIMIT 100;
SELECT i.i_item_id, i.i_item_desc, s.s_state, SUM(ss.ss_quantity) AS total_sales_quantity, AVG(ss.ss_quantity) AS average_sales_quantity, COUNT(DISTINCT ss.ss_ticket_number) AS sales_transactions_count, SUM(sr.sr_return_quantity) AS total_returns_quantity, AVG(sr.sr_return_quantity) AS average_returns_quantity, COUNT(DISTINCT sr.sr_ticket_number) AS returns_transactions_count, SUM(sr.sr_return_amt_inc_tax) AS total_returns_amount_inc_tax, AVG(sr.sr_return_ship_cost) AS average_return_ship_cost FROM store_sales ss JOIN item i ON ss.ss_item_sk = i.i_item_sk JOIN store s ON ss.ss_store_sk = s.s_store_sk JOIN store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_store_sk = sr.sr_store_sk JOIN time_dim t ON ss.ss_sold_time_sk = t.t_time_sk WHERE s.s_market_desc IN ('Events develop i', 'Little expectations include yet forward meetings.') AND i.i_current_price > 10 AND t.t_shift = 'third' AND sr.sr_return_tax > 3.00 GROUP BY i.i_item_id, i.i_item_desc, s.s_state ORDER BY total_sales_quantity DESC, total_returns_quantity DESC LIMIT 100;
SELECT ca.ca_city, ca.ca_state, i.i_category, COUNT(DISTINCT c.c_customer_sk) AS number_of_customers, AVG(i.i_current_price) AS average_item_price, SUM(i.i_wholesale_cost) AS total_wholesale_cost, COUNT(i.i_item_sk) AS items_sold, SUM(CASE WHEN c.c_birth_year = 1928 THEN 1 ELSE 0 END) AS customers_born_1928, SUM(CASE WHEN c.c_birth_year = 1948 THEN 1 ELSE 0 END) AS customers_born_1948, SUM(CASE WHEN c.c_birth_country = 'HUNGARY' THEN 1 ELSE 0 END) AS customers_from_hungary, SUM(CASE WHEN c.c_birth_country = 'GUERNSEY' THEN 1 ELSE 0 END) AS customers_from_guernsey, COUNT(DISTINCT CASE WHEN ca.ca_location_type = 'single family' THEN c.c_customer_sk END) AS single_family_homes, COUNT(DISTINCT CASE WHEN ca.ca_location_type = 'apartment' THEN c.c_customer_sk END) AS apartments, COUNT(DISTINCT CASE WHEN ca.ca_location_type = 'condo' THEN c.c_customer_sk END) AS condos FROM customer c JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk JOIN item i ON c.c_customer_sk = i.i_manager_id WHERE i.i_size IN ('economy', 'large', 'petite') AND i.i_product_name IN ('barbarbarought', 'esecallyesepri') AND ca.ca_city IN ('Watkins', 'Sawyer', 'Ruth', 'Sheffield') GROUP BY ca.ca_city, ca.ca_state, i.i_category ORDER BY ca.ca_state, ca.ca_city, i.i_category;
SELECT web.web_name AS website_name, item.i_category AS product_category, COUNT(DISTINCT sr.sr_ticket_number) AS total_returns, SUM(sr.sr_return_quantity) AS total_returned_quantity, AVG(sr.sr_return_amt) AS average_return_amount, SUM(sr.sr_return_amt) AS total_return_amount, SUM(sr.sr_fee) AS total_fees, SUM(sr.sr_net_loss) AS total_net_loss, td.t_shift AS return_shift FROM store_returns sr JOIN item ON sr.sr_item_sk = item.i_item_sk JOIN web_site web ON sr.sr_reason_sk = web.web_site_sk JOIN time_dim td ON sr.sr_return_time_sk = td.t_time_sk WHERE web.web_site_sk IN ('15', '11', '4', '20') AND item.i_current_price IN ('7.20', '1.29', '90.17', '5.18') AND td.t_shift = 'third' AND sr.sr_hdemo_sk = 3371 AND sr.sr_reversed_charge IN ('481.87', '4.35') GROUP BY web.web_name, item.i_category, td.t_shift ORDER BY total_return_amount DESC;
SELECT ca.ca_state, EXTRACT(YEAR FROM cc.cc_rec_start_date) AS year_started, COUNT(DISTINCT cc.cc_call_center_sk) AS num_call_centers, AVG(cc.cc_employees) AS avg_employees, SUM(sr.sr_return_amt_inc_tax) AS total_return_amount_with_tax, SUM(ws.ws_net_paid_inc_ship_tax) AS total_web_sales_amount_with_ship_tax, AVG(hd.hd_vehicle_count) AS avg_vehicle_count, COUNT(DISTINCT r.r_reason_sk) AS num_unique_reasons FROM call_center cc JOIN store_returns sr ON sr.sr_store_sk = cc.cc_call_center_sk JOIN web_sales ws ON ws.ws_warehouse_sk = cc.cc_call_center_sk JOIN customer_address ca ON ca.ca_address_sk = sr.sr_addr_sk JOIN household_demographics hd ON hd.hd_demo_sk = sr.sr_hdemo_sk JOIN reason r ON r.r_reason_sk = sr.sr_reason_sk JOIN warehouse w ON w.w_warehouse_sk = ws.ws_warehouse_sk WHERE (w.w_warehouse_sq_ft = 621234 OR w.w_warehouse_sq_ft = 294242 OR w.w_warehouse_sq_ft = 977787 OR w.w_warehouse_sq_ft = 138504) AND (w.w_warehouse_sk = 2 OR w.w_warehouse_sk = 1) AND (ws.ws_ext_tax = 127.26 OR ws.ws_ext_tax = 30.44) AND hd.hd_vehicle_count = 3 AND (r.r_reason_sk = 25 OR r.r_reason_sk = 20 OR r.r_reason_sk = 4) GROUP BY ca.ca_state, year_started ORDER BY total_return_amount_with_tax DESC, total_web_sales_amount_with_ship_tax DESC;
SELECT sm.sm_type AS shipping_method, dd.d_year AS year, dd.d_quarter_name AS quarter, SUM(cs.cs_net_paid_inc_ship_tax) AS total_sales, COUNT(DISTINCT cs.cs_order_number) AS total_sales_orders, SUM(cr.cr_net_loss) AS total_returns, COUNT(DISTINCT cr.cr_order_number) AS total_return_orders FROM ship_mode sm LEFT JOIN catalog_sales cs ON sm.sm_ship_mode_sk = cs.cs_ship_mode_sk LEFT JOIN date_dim dd ON cs.cs_sold_date_sk = dd.d_date_sk LEFT JOIN catalog_returns cr ON cs.cs_order_number = cr.cr_order_number WHERE sm.sm_code IN ('AIR', 'SEA', 'SURFACE', 'BIKE') AND dd.d_quarter_seq IN (47, 48) GROUP BY shipping_method, year, quarter ORDER BY year, quarter, shipping_method;
SELECT d.d_year, d.d_quarter_name, SUM(ss_net_profit) AS total_profit, AVG(ss_sales_price) AS average_sales_price, COUNT(DISTINCT ss_customer_sk) AS unique_customers, SUM(wr_return_amt) AS total_returns, COUNT(DISTINCT wr_refunded_customer_sk) AS unique_refunded_customers, COUNT(wr_return_quantity) AS total_returned_items FROM store_sales ss JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk LEFT JOIN web_returns wr ON ss.ss_item_sk = wr.wr_item_sk AND ss.ss_ticket_number = wr.wr_order_number WHERE d.d_year = 2002 AND ss.ss_ext_discount_amt > 0 GROUP BY d.d_year, d.d_quarter_name ORDER BY d.d_year, d.d_quarter_name;
