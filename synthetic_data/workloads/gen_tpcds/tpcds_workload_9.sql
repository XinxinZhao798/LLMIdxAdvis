SELECT i.i_category, SUM(ss.ss_quantity) AS total_quantity_sold, AVG(ss.ss_sales_price) AS average_sales_price, COUNT(DISTINCT ss.ss_customer_sk) AS unique_customers, SUM(wr.wr_return_quantity) AS total_quantity_returned, SUM(wr.wr_return_amt) AS total_return_amount, AVG(inv.inv_quantity_on_hand) AS average_inventory_on_hand FROM item i LEFT JOIN store_sales ss ON ss.ss_item_sk = i.i_item_sk LEFT JOIN web_returns wr ON wr.wr_item_sk = i.i_item_sk LEFT JOIN inventory inv ON inv.inv_item_sk = i.i_item_sk WHERE i.i_category IN ('Electronics', 'Clothing', 'Furniture') AND ss.ss_sold_date_sk BETWEEN 2451453 AND 2451553 AND wr.wr_returned_date_sk BETWEEN 2451453 AND 2451553 AND inv.inv_date_sk BETWEEN 2451453 AND 2451553 GROUP BY i.i_category ORDER BY total_quantity_sold DESC;
SELECT ca.ca_city, ca.ca_state, i.i_category, COUNT(DISTINCT c.c_customer_sk) AS number_of_customers, AVG(i.i_current_price) AS average_item_price, SUM(i.i_wholesale_cost) AS total_wholesale_cost, COUNT(i.i_item_sk) AS items_sold, SUM(CASE WHEN c.c_birth_year = 1928 THEN 1 ELSE 0 END) AS customers_born_1928, SUM(CASE WHEN c.c_birth_year = 1948 THEN 1 ELSE 0 END) AS customers_born_1948, SUM(CASE WHEN c.c_birth_country = 'HUNGARY' THEN 1 ELSE 0 END) AS customers_from_hungary, SUM(CASE WHEN c.c_birth_country = 'GUERNSEY' THEN 1 ELSE 0 END) AS customers_from_guernsey, COUNT(DISTINCT CASE WHEN ca.ca_location_type = 'single family' THEN c.c_customer_sk END) AS single_family_homes, COUNT(DISTINCT CASE WHEN ca.ca_location_type = 'apartment' THEN c.c_customer_sk END) AS apartments, COUNT(DISTINCT CASE WHEN ca.ca_location_type = 'condo' THEN c.c_customer_sk END) AS condos FROM customer c JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk JOIN item i ON c.c_customer_sk = i.i_manager_id WHERE i.i_size IN ('economy', 'large', 'petite') AND i.i_product_name IN ('barbarbarought', 'esecallyesepri') AND ca.ca_city IN ('Watkins', 'Sawyer', 'Ruth', 'Sheffield') GROUP BY ca.ca_city, ca.ca_state, i.i_category ORDER BY ca.ca_state, ca.ca_city, i.i_category;
SELECT c.c_customer_id, c.c_first_name, c.c_last_name, ib.ib_income_band_sk, COUNT(sr.sr_item_sk) AS total_returns, SUM(sr.sr_return_quantity) AS total_returned_quantity, AVG(sr.sr_return_amt) AS avg_return_amount, SUM(sr.sr_return_amt_inc_tax) AS total_return_amount_inc_tax, SUM(sr.sr_net_loss) AS total_net_loss FROM customer c JOIN store_returns sr ON c.c_customer_sk = sr.sr_customer_sk JOIN income_band ib ON c.c_current_hdemo_sk = ib.ib_income_band_sk WHERE sr.sr_return_quantity > 5 AND ib.ib_lower_bound >= 120001 AND (c.c_birth_year BETWEEN 1980 AND 1990) GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, ib.ib_income_band_sk ORDER BY total_net_loss DESC, avg_return_amount DESC LIMIT 100;
SELECT ca_state, cd_education_status, COUNT(DISTINCT c_customer_sk) AS total_customers, SUM(cd_purchase_estimate) AS total_purchase_estimate, AVG(cd_dep_count) AS average_dependents, SUM(CASE WHEN cd_gender = 'F' THEN 1 ELSE 0 END) AS female_customers, SUM(CASE WHEN cd_gender = 'M' THEN 1 ELSE 0 END) AS male_customers, COUNT(DISTINCT r_reason_sk) AS total_return_reasons, COUNT(DISTINCT i_item_sk) AS total_items_sold, SUM(inv_quantity_on_hand) AS total_inventory_quantity, AVG(i_current_price) AS average_item_price FROM customer c JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk JOIN inventory inv ON inv.inv_warehouse_sk = c.c_current_addr_sk JOIN item i ON i.i_item_sk = inv.inv_item_sk LEFT JOIN reason r ON r.r_reason_sk = inv.inv_warehouse_sk WHERE ca.ca_street_number IN ('470', '984', '743') AND cd_education_status IN ('College', 'Unknown', 'Advanced Degree', '2 yr Degree') AND cd_dep_employed_count = '0' AND ca_state IN (SELECT cc_state FROM call_center WHERE cc_street_name IN ('Center Hill', 'Pine Ridge', 'Ash Hill')) GROUP BY ca_state, cd_education_status ORDER BY total_customers DESC, total_purchase_estimate DESC;
SELECT hd.hd_income_band_sk, p.p_channel_details, COUNT(DISTINCT cs.cs_order_number) AS total_orders, SUM(cs.cs_quantity) AS total_quantity, AVG(cs.cs_sales_price) AS average_sales_price, SUM(cs.cs_net_paid) AS total_net_paid, SUM(cs.cs_net_paid_inc_tax) AS total_net_paid_inc_tax, SUM(cs.cs_net_paid_inc_ship) AS total_net_paid_inc_ship, SUM(cs.cs_net_paid_inc_ship_tax) AS total_net_paid_inc_ship_tax, SUM(cs.cs_net_profit) AS total_net_profit FROM catalog_sales cs JOIN household_demographics hd ON cs.cs_bill_hdemo_sk = hd.hd_demo_sk JOIN promotion p ON cs.cs_promo_sk = p.p_promo_sk WHERE hd.hd_income_band_sk IN (12, 6, 4) AND p.p_promo_sk IN (262, 88, 196, 231, 119, 83) AND cs.cs_net_paid IN (499.47, 9920.40) GROUP BY hd.hd_income_band_sk, p.p_channel_details ORDER BY hd.hd_income_band_sk, p.p_channel_details;
SELECT re.r_reason_desc AS return_reason, sm.sm_type AS ship_mode_type, COUNT(DISTINCT cr.cr_order_number) AS total_returns, SUM(cr.cr_return_quantity) AS total_returned_quantity, AVG(cr.cr_return_amount) AS avg_return_amount, SUM(cr.cr_return_amount) AS sum_return_amount, SUM(cr.cr_return_tax) AS sum_return_tax, SUM(cr.cr_return_amt_inc_tax) AS sum_return_amt_inc_tax, SUM(cr.cr_fee) AS sum_fees, SUM(cr.cr_return_ship_cost) AS sum_return_ship_cost, SUM(cr.cr_refunded_cash) AS sum_refunded_cash, SUM(cr.cr_reversed_charge) AS sum_reversed_charge, SUM(cr.cr_store_credit) AS sum_store_credit, SUM(cr.cr_net_loss) AS sum_net_loss, wh.w_warehouse_name AS warehouse_name, st.s_store_name AS store_name FROM catalog_returns cr JOIN reason re ON cr.cr_reason_sk = re.r_reason_sk JOIN ship_mode sm ON cr.cr_ship_mode_sk = sm.sm_ship_mode_sk JOIN warehouse wh ON cr.cr_warehouse_sk = wh.w_warehouse_sk JOIN store st ON cr.cr_returning_customer_sk = st.s_store_sk GROUP BY return_reason, ship_mode_type, warehouse_name, store_name ORDER BY sum_net_loss DESC, total_returned_quantity DESC;
SELECT hd.hd_income_band_sk AS income_band, hd.hd_buy_potential AS buy_potential, COUNT(cs.cs_order_number) AS number_of_transactions, SUM(cs.cs_net_paid) AS total_sales, AVG(cs.cs_sales_price) AS average_sales_price FROM catalog_sales cs JOIN household_demographics hd ON cs.cs_bill_hdemo_sk = hd.hd_demo_sk GROUP BY hd.hd_income_band_sk, hd.hd_buy_potential ORDER BY hd.hd_income_band_sk, hd.hd_buy_potential;
SELECT cc.cc_name, cc.cc_city, cc.cc_state, cc.cc_tax_percentage, AVG(wr.wr_return_amt_inc_tax) AS avg_return_amt_inc_tax, SUM(wr.wr_return_amt) AS total_return_amt, SUM(wr.wr_return_tax) AS total_return_tax, COUNT(DISTINCT wr.wr_returning_customer_sk) AS distinct_returning_customers FROM web_returns wr JOIN customer c ON wr.wr_returning_customer_sk = c.c_customer_sk JOIN call_center cc ON cc.cc_city = c.c_login JOIN catalog_page cp ON wr.wr_web_page_sk = cp.cp_catalog_page_sk WHERE cp.cp_start_date_sk BETWEEN 2451088 AND 2451510 AND wr.wr_return_amt > 0 AND cc.cc_tax_percentage IS NOT NULL GROUP BY cc.cc_name, cc.cc_city, cc.cc_state, cc.cc_tax_percentage ORDER BY total_return_amt DESC, avg_return_amt_inc_tax DESC;
SELECT w.w_state AS warehouse_state, COUNT(DISTINCT ws.ws_order_number) AS total_orders, SUM(ws.ws_net_profit) AS total_net_profit, COUNT(DISTINCT cr.cr_order_number) AS total_returns, AVG(cr.cr_return_amount) AS average_return_amount FROM web_sales ws LEFT JOIN warehouse w ON ws.ws_warehouse_sk = w.w_warehouse_sk LEFT JOIN catalog_returns cr ON ws.ws_item_sk = cr.cr_item_sk AND ws.ws_order_number = cr.cr_order_number WHERE ws.ws_sold_date_sk = 2450976 GROUP BY w.w_state ORDER BY total_net_profit DESC;
SELECT d_year, d_quarter_name, cc_name, SUM(cs_quantity) AS total_quantity_sold, SUM(cs_net_paid) AS total_net_paid, AVG(cs_net_profit) AS average_net_profit, COUNT(DISTINCT cs_order_number) AS number_of_orders, SUM(ws_quantity) AS total_web_quantity_sold, SUM(ws_net_paid) AS total_web_net_paid, AVG(ws_net_profit) AS average_web_net_profit, COUNT(DISTINCT ws_order_number) AS number_of_web_orders, SUM(cr_return_quantity) AS total_return_quantity, SUM(cr_return_amount) AS total_return_amount, AVG(cr_net_loss) AS average_net_loss, COUNT(DISTINCT cr_order_number) AS number_of_returns FROM date_dim JOIN catalog_sales ON cs_sold_date_sk = d_date_sk JOIN web_sales ON ws_sold_date_sk = d_date_sk JOIN catalog_returns ON cr_returned_date_sk = d_date_sk JOIN call_center ON cs_call_center_sk = cc_call_center_sk WHERE d_fy_year IN ('1910', '1903', '1905', '1900') AND (cs_net_paid_inc_ship_tax IN ('289.42', '1479.37') OR ws_net_paid_inc_ship_tax IN ('3079.90', '243.98', '3911.52')) GROUP BY d_year, d_quarter_name, cc_name ORDER BY d_year, d_quarter_name, cc_name;
SELECT cp.cp_department, sm.sm_carrier, SUM(ss.ss_net_paid_inc_tax) AS total_net_sales, AVG(ss.ss_ext_discount_amt) AS average_discount_amount, COUNT(DISTINCT CASE WHEN c.c_preferred_cust_flag = 'Y' AND ss.ss_net_paid > avg_net_paid THEN ss.ss_customer_sk END) AS high_value_customer_count FROM store_sales ss JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk JOIN catalog_page cp ON cp.cp_catalog_number = 7 JOIN ship_mode sm ON sm.sm_carrier IN ('ZHOU', 'DHL', 'GREAT EASTERN', 'USPS', 'PRIVATECARRIER', 'LATVIAN') CROSS JOIN (SELECT AVG(ss_net_paid) as avg_net_paid FROM store_sales) AS avg_sales WHERE ss.ss_store_sk = 7 AND c.c_preferred_cust_flag = 'Y' AND c.c_birth_country IN ('LIECHTENSTEIN', 'ETHIOPIA', 'DENMARK', 'SLOVAKIA') GROUP BY cp.cp_department, sm.sm_carrier ORDER BY total_net_sales DESC, cp.cp_department, sm.sm_carrier;
SELECT ib.ib_income_band_sk, ib.ib_lower_bound, ib.ib_upper_bound, COUNT(DISTINCT ss.ss_customer_sk) AS num_customers, SUM(ss.ss_quantity) AS total_quantity_sold, AVG(ss.ss_sales_price) AS avg_sales_price, SUM(ss.ss_net_profit) AS total_net_profit, SUM(sr.sr_return_quantity) AS total_return_quantity, SUM(sr.sr_return_amt) AS total_return_amount, AVG(sr.sr_fee) AS avg_return_fee, COUNT(DISTINCT wp.wp_web_page_sk) AS num_visited_pages, SUM(wp.wp_link_count) AS total_link_count FROM income_band ib LEFT JOIN store_sales ss ON ib.ib_income_band_sk = ss.ss_cdemo_sk LEFT JOIN store_returns sr ON ss.ss_customer_sk = sr.sr_customer_sk AND sr.sr_reason_sk IN (21, 2, 14, 30) LEFT JOIN web_page wp ON ss.ss_customer_sk = wp.wp_customer_sk AND wp.wp_type IN ('protected', 'ad') WHERE ss.ss_sold_date_sk IN (2451298, 2450872, 2451390, 2451634) AND ib.ib_upper_bound IN (30000, 130000, 90000) AND ib.ib_income_band_sk IN (17, 6) GROUP BY ib.ib_income_band_sk, ib.ib_lower_bound, ib.ib_upper_bound ORDER BY ib.ib_income_band_sk;
SELECT dd.d_year, dd.d_quarter_name, i.i_category, i.i_brand, s.s_store_name, s.s_state, s.s_country, COUNT(distinct ws.ws_order_number) AS total_orders, SUM(ws.ws_quantity) AS total_quantity, SUM(ws.ws_ext_sales_price) AS total_sales, AVG(ws.ws_sales_price) AS avg_sales_price, SUM(ws.ws_net_paid) AS net_paid, SUM(ws.ws_net_paid_inc_tax) AS net_paid_inc_tax, SUM(ws.ws_net_profit) AS net_profit FROM web_sales ws JOIN date_dim dd ON ws.ws_sold_date_sk = dd.d_date_sk JOIN item i ON ws.ws_item_sk = i.i_item_sk JOIN store s ON s.s_store_sk = ws.ws_bill_customer_sk WHERE s.s_country = 'United States' AND dd.d_year = 2001 AND i.i_category IN ('Shoes', 'Sports') AND i.i_rec_start_date BETWEEN '2000-01-01' AND '2001-12-31' AND s.s_tax_precentage IN ('0.06', '0.01', '0.11', '0.03', '0.08') GROUP BY dd.d_year, dd.d_quarter_name, i.i_category, i.i_brand, s.s_store_name, s.s_state, s.s_country ORDER BY total_sales DESC, net_profit DESC;
SELECT sm.sm_type AS shipping_type, i.i_category AS item_category, COUNT(cr.cr_order_number) AS total_returns, SUM(cr.cr_return_amount) AS total_return_amount, AVG(cr.cr_fee) AS average_fee, SUM(cs.cs_quantity) AS total_sold_quantity, AVG(cs.cs_sales_price) AS average_sales_price, SUM(inv.inv_quantity_on_hand) AS total_inventory_quantity FROM catalog_returns cr JOIN item i ON cr.cr_item_sk = i.i_item_sk JOIN ship_mode sm ON cr.cr_ship_mode_sk = sm.sm_ship_mode_sk JOIN catalog_sales cs ON cr.cr_item_sk = cs.cs_item_sk AND cr.cr_order_number = cs.cs_order_number JOIN inventory inv ON i.i_item_sk = inv.inv_item_sk JOIN customer_demographics cd ON cr.cr_returning_cdemo_sk = cd.cd_demo_sk WHERE i.i_units <> 'N/A' AND i.i_product_name IN ('ablecallybarpri', 'ationeingcallyable', 'callyeingpri', 'barantiableese', 'antioughtn stese') AND cd.cd_dep_count BETWEEN 1 AND 2 GROUP BY sm.sm_type, i.i_category ORDER BY total_return_amount DESC, total_sold_quantity DESC;
SELECT i.i_category, i.i_class, cp.cp_department, w.w_state, p.p_channel_dmail, p.p_channel_email, AVG(i.i_wholesale_cost) AS avg_wholesale_cost, SUM(inv.inv_quantity_on_hand) AS total_quantity_on_hand, COUNT(DISTINCT p.p_promo_sk) AS num_promotions FROM item i JOIN catalog_page cp ON i.i_item_sk = cp.cp_catalog_page_sk JOIN inventory inv ON i.i_item_sk = inv.inv_item_sk JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk JOIN promotion p ON i.i_item_sk = p.p_item_sk WHERE w.w_state = 'TN' AND p.p_channel_dmail = 'Y' AND p.p_channel_email = 'Y' GROUP BY i.i_category, i.i_class, cp.cp_department, w.w_state, p.p_channel_dmail, p.p_channel_email HAVING AVG(i.i_wholesale_cost) > 0 ORDER BY avg_wholesale_cost DESC, total_quantity_on_hand DESC;
