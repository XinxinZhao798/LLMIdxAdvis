SELECT cp_department, s_state, sm_type, COUNT(distinct cs_order_number) AS total_orders, SUM(cs_quantity) AS total_quantity, SUM(cs_net_paid) AS total_net_paid, AVG(cs_net_paid) AS avg_order_value, SUM(cs_net_profit) AS total_net_profit, COUNT(distinct hd_demo_sk) AS unique_customers, AVG(hd_vehicle_count) AS avg_vehicles_per_customer, AVG(hd_dep_count) AS avg_dependents_per_customer FROM catalog_sales JOIN catalog_page ON cs_catalog_page_sk = cp_catalog_page_sk JOIN store ON cs_bill_customer_sk = s_store_sk JOIN ship_mode ON cs_ship_mode_sk = sm_ship_mode_sk JOIN household_demographics ON cs_bill_hdemo_sk = hd_demo_sk WHERE cp_start_date_sk <= 2450822 AND cp_end_date_sk >= 2450822 AND s_state = 'TN' AND sm_contract IN ('hGoF18SLDDPBj', 'GNJr3g5i7oorKqtX') AND cs_sold_date_sk BETWEEN 2450815 AND 2450829 AND cs_quantity IN (35, 88, 62, 12, 76) GROUP BY cp_department, s_state, sm_type ORDER BY total_net_paid DESC, total_orders DESC;
SELECT d_year, i_category, SUM(ss_quantity) AS total_quantity_sold, AVG(ss_sales_price) AS average_sales_price, COUNT(DISTINCT ss_customer_sk) AS unique_customers, SUM(ss_net_profit) AS total_profit FROM store_sales JOIN date_dim ON store_sales.ss_sold_date_sk = date_dim.d_date_sk JOIN item ON store_sales.ss_item_sk = item.i_item_sk JOIN promotion ON store_sales.ss_promo_sk = promotion.p_promo_sk WHERE promotion.p_channel_event = 'N' AND item.i_manager_id = 40 AND item.i_container = 'Unknown' AND promotion.p_item_sk IN ('11194', '2314', '17593') AND EXISTS ( SELECT 1 FROM household_demographics WHERE household_demographics.hd_demo_sk = store_sales.ss_hdemo_sk AND household_demographics.hd_buy_potential IN ('>10000', 'Unknown') AND household_demographics.hd_vehicle_count IN ('3', '1', '0', '4', '2') ) GROUP BY d_year, i_category ORDER BY total_profit DESC, total_quantity_sold DESC;
SELECT cc.cc_state, cc.cc_city, cc.cc_name, AVG(ss.ss_net_profit) AS avg_net_profit, SUM(ss.ss_quantity) AS total_quantity_sold, COUNT(DISTINCT ss.ss_store_sk) AS number_of_stores, COUNT(DISTINCT ss.ss_ticket_number) AS number_of_sales_transactions, SUM(cc.cc_employees) AS total_employees_in_call_centers, AVG(cc.cc_tax_percentage) AS avg_tax_percentage_by_state FROM store_sales ss JOIN call_center cc ON ss.ss_store_sk = cc.cc_call_center_sk JOIN time_dim td ON ss.ss_sold_time_sk = td.t_time_sk WHERE ss.ss_sold_date_sk IN (SELECT inv_date_sk FROM inventory WHERE inv_quantity_on_hand IN (816, 142, 984)) AND cc.cc_tax_percentage IN (0.01, 0.12, 0.05, 0.11) AND ss.ss_net_profit IN (5.76, 45.76, 66.12, -885.72, -4074.40) AND ss.ss_hdemo_sk IN (7132, 594, 6065, 5700) GROUP BY cc.cc_state, cc.cc_city, cc.cc_name ORDER BY avg_net_profit DESC;
SELECT d.d_year, d.d_quarter_name, COUNT(DISTINCT c.c_customer_sk) AS total_customers, SUM(inv.inv_quantity_on_hand) AS total_inventory, AVG(wp.wp_link_count) AS avg_link_count, SUM(CASE WHEN c.c_preferred_cust_flag = 'Y' THEN 1 ELSE 0 END) AS preferred_customers_count, SUM(CASE WHEN d.d_holiday = 'Y' THEN 1 ELSE 0 END) AS holiday_count FROM date_dim d JOIN customer c ON c.c_first_sales_date_sk = d.d_date_sk JOIN inventory inv ON inv.inv_date_sk = d.d_date_sk JOIN web_page wp ON wp.wp_access_date_sk = d.d_date_sk WHERE d.d_year = 2021 GROUP BY d.d_year, d.d_quarter_name ORDER BY d.d_year, d.d_quarter_name;
SELECT i_category, i_brand, COUNT(DISTINCT i_item_sk) AS num_items, SUM(i_current_price) AS total_current_price, AVG(i_wholesale_cost) AS average_wholesale_cost, MAX(wp_link_count) AS max_link_count, MIN(wp_char_count) AS min_char_count, AVG(t_hour) AS average_hour_of_day FROM item JOIN web_page ON i_item_sk = wp_customer_sk JOIN time_dim ON wp_access_date_sk = t_time_sk WHERE i_container <> 'Unknown' AND i_brand_id IN ('9001011', '9016005', '6015001', '9005009', '9016001') AND wp_link_count IN ('17', '25', '6', '4', '18', '19') GROUP BY i_category, i_brand ORDER BY total_current_price DESC, average_wholesale_cost DESC LIMIT 100;
SELECT cc.cc_name, cc.cc_city, cc.cc_state, SUM(cr.cr_return_amount) AS total_return_amount, AVG(cr.cr_return_amount) AS avg_return_amount, COUNT(*) AS total_returns, SUM(cr.cr_net_loss) AS total_net_loss, r.r_reason_desc, COUNT(r.r_reason_desc) AS reason_count FROM call_center cc JOIN catalog_returns cr ON cc.cc_call_center_sk = cr.cr_call_center_sk JOIN reason r ON cr.cr_reason_sk = r.r_reason_sk GROUP BY cc.cc_name, cc.cc_city, cc.cc_state, r.r_reason_desc ORDER BY total_net_loss DESC, total_returns DESC;
SELECT sm.sm_type, sm.sm_carrier, COUNT(DISTINCT cs.cs_order_number) AS total_orders, SUM(cs.cs_quantity) AS total_quantity_sold, SUM(cs.cs_net_paid) AS total_net_paid, AVG(cs.cs_sales_price) AS average_sales_price, SUM(cs.cs_net_profit) AS total_net_profit FROM catalog_sales cs JOIN ship_mode sm ON cs.cs_ship_mode_sk = sm.sm_ship_mode_sk JOIN web_page wp ON cs.cs_catalog_page_sk = wp.wp_web_page_sk WHERE wp.wp_char_count IN (701, 1931) AND sm.sm_type = 'OVERNIGHT' AND cs.cs_call_center_sk IN (1, 2, 4) GROUP BY sm.sm_type, sm.sm_carrier ORDER BY total_net_paid DESC;
SELECT w_state, COUNT(DISTINCT c.c_customer_sk) AS num_customers, COUNT(DISTINCT s.s_store_sk) AS num_stores, SUM(i.inv_quantity_on_hand) AS total_inventory, AVG(s.s_number_employees) AS avg_store_employees, AVG(wp.wp_link_count) AS avg_webpage_link_count FROM warehouse w JOIN inventory i ON w.w_warehouse_sk = i.inv_warehouse_sk JOIN web_page wp ON wp.wp_rec_end_date > CURRENT_DATE JOIN store s ON s.s_state = w.w_state JOIN customer c ON c.c_current_addr_sk = s.s_store_sk WHERE i.inv_quantity_on_hand BETWEEN 200 AND 1000 AND wp.wp_max_ad_count BETWEEN 1 AND 3 GROUP BY w_state ORDER BY total_inventory DESC;
SELECT r.r_reason_desc AS promotion_reason, SUM(cs.cs_quantity) AS total_quantity_sold, AVG(cs.cs_sales_price) AS average_sales_price, SUM(cs.cs_ext_discount_amt) AS total_discount_amount, AVG(cs.cs_net_profit) AS average_net_profit_per_item, cd.cd_gender, cd.cd_education_status, COUNT(DISTINCT c.c_customer_sk) AS unique_customers FROM catalog_sales cs JOIN time_dim t ON cs.cs_sold_time_sk = t.t_time_sk JOIN customer_demographics cd ON cs.cs_bill_cdemo_sk = cd.cd_demo_sk JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk JOIN reason r ON cs.cs_promo_sk = r.r_reason_sk WHERE t.t_sub_shift = 'night' AND cs.cs_promo_sk IN (SELECT r_reason_sk FROM reason WHERE r_reason_id IN ('AAAAAAAACAAAAAAA', 'AAAAAAAAKAAAAAAA', 'AAAAAAAAFBAAAAAA', 'AAAAAAAABCAAAAAA', 'AAAAAAAAACAAAAAA', 'AAAAAAAANBAAAAAA')) GROUP BY r.r_reason_desc, cd.cd_gender, cd.cd_education_status ORDER BY total_quantity_sold DESC, average_sales_price DESC;
SELECT s.s_store_name, s.s_city, s.s_state, COUNT(DISTINCT c.c_customer_sk) AS number_of_customers, SUM(cd.cd_purchase_estimate) AS total_purchase_estimate, AVG(cd.cd_dep_count) AS avg_dependents, AVG(cd.cd_dep_employed_count) AS avg_employed_dependents, AVG(cd.cd_dep_college_count) AS avg_college_dependents, AVG(hd.hd_vehicle_count) AS avg_vehicle_count, ib.ib_lower_bound AS income_band_lower_bound, ib.ib_upper_bound AS income_band_upper_bound FROM store s JOIN customer c ON s.s_store_sk = c.c_current_addr_sk JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk JOIN income_band ib ON hd.hd_income_band_sk = ib.ib_income_band_sk WHERE s.s_rec_start_date = '2001-03-13' AND s.s_number_employees IN (229, 271) AND EXISTS ( SELECT 1 FROM web_page wp WHERE wp.wp_customer_sk = c.c_customer_sk AND wp.wp_access_date_sk IN (2452583, 2452648) ) GROUP BY s.s_store_name, s.s_city, s.s_state, ib.ib_lower_bound, ib.ib_upper_bound ORDER BY s.s_store_name, s.s_city, s.s_state;
SELECT cc.cc_name, cc.cc_manager, c.cd_education_status, SUM(ss.ss_quantity) AS total_quantity_sold, AVG(ss.ss_sales_price) AS average_sales_price, COUNT(DISTINCT ss.ss_ticket_number) AS number_of_sales_transactions, COUNT(DISTINCT c.cd_demo_sk) AS number_of_unique_customers FROM store_sales ss JOIN call_center cc ON ss.ss_store_sk = cc.cc_call_center_sk JOIN customer_demographics c ON ss.ss_cdemo_sk = c.cd_demo_sk JOIN time_dim t ON ss.ss_sold_time_sk = t.t_time_sk JOIN catalog_page cp ON ss.ss_promo_sk = cp.cp_catalog_page_sk WHERE cc.cc_manager IN ('Larry Mccray', 'Felipe Perkins') AND cp.cp_type IN ('bi-annual', 'monthly', 'quarterly') AND t.t_hour BETWEEN 0 AND 1 AND c.cd_dep_college_count = 0 AND ss.ss_sold_date_sk IS NOT NULL GROUP BY cc.cc_name, cc.cc_manager, c.cd_education_status ORDER BY total_quantity_sold DESC, average_sales_price DESC;
SELECT r.r_reason_desc AS return_reason, c.c_preferred_cust_flag AS preferred_customer, t.t_am_pm AS purchase_time_period, COUNT(wr.wr_order_number) AS total_returns, SUM(wr.wr_refunded_cash) AS total_refunded_amount, AVG(wr.wr_refunded_cash) AS avg_refunded_amount FROM web_returns wr JOIN reason r ON wr.wr_reason_sk = r.r_reason_sk JOIN customer c ON wr.wr_returning_customer_sk = c.c_customer_sk JOIN catalog_sales cs ON wr.wr_order_number = cs.cs_order_number JOIN time_dim t ON cs.cs_sold_time_sk = t.t_time_sk GROUP BY r.r_reason_desc, c.c_preferred_cust_flag, t.t_am_pm ORDER BY total_refunded_amount DESC, total_returns DESC;
SELECT s.s_store_name, s.s_city, s.s_state, SUM(ws.ws_net_profit) AS total_net_profit, AVG(ws.ws_quantity) AS average_quantity_sold, COUNT(DISTINCT ws.ws_order_number) AS total_orders, SUM(ws.ws_ext_sales_price) AS total_sales, sm.sm_carrier, sm.sm_type, COUNT(DISTINCT ws.ws_item_sk) AS total_items_sold, ib.ib_lower_bound, ib.ib_upper_bound, COUNT(DISTINCT ws.ws_bill_customer_sk) AS total_customers, cp.cp_department, cp.cp_catalog_number, COUNT(DISTINCT cp.cp_catalog_page_sk) AS total_catalog_pages FROM store s JOIN web_sales ws ON s.s_store_sk = ws.ws_warehouse_sk JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk JOIN income_band ib ON ws.ws_bill_cdemo_sk = ib.ib_income_band_sk JOIN catalog_page cp ON ws.ws_web_page_sk = cp.cp_catalog_page_sk JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk WHERE s.s_company_id = '1' AND s.s_county = 'Williamson County' AND ws.ws_ship_addr_sk IN ('9319', '42828', '27709') AND ws.ws_net_profit IN ('1416.80', '918.75', '-485.10') AND sm.sm_carrier IN ('ZOUROS', 'HARMSTORF', 'GERMA') AND sm.sm_ship_mode_sk IN ('11', '3', '9') AND sm.sm_code IN ('BIKE', 'SURFACE', 'AIR') AND w.web_rec_start_date IN ('1999-08-17', '2001-08-16', '2000-08-16') AND w.web_suite_number IN ('Suite 130', 'Suite 150', 'Suite R') AND w.web_tax_percentage IN ('0.01', '0.10', '0.12') AND w.web_company_name IN ('able', 'cally', 'pri') AND ib.ib_upper_bound IN ('110000', '190000', '130000') AND ib.ib_income_band_sk IN ('8', '15', '6') AND ib.ib_lower_bound IN ('20001', '100001', '10001') AND cp.cp_catalog_number IN ('10', '44', '19') AND cp.cp_department = 'DEPARTMENT' AND cp.cp_catalog_page_number IN ('49', '102', '25') AND cp.cp_catalog_page_sk IN ('3484', '375', '1590') GROUP BY s.s_store_name, s.s_city, s.s_state, sm.sm_carrier, sm.sm_type, ib.ib_lower_bound, ib.ib_upper_bound, cp.cp_department, cp.cp_catalog_number ORDER BY total_net_profit DESC, total_sales DESC, total_orders DESC;
SELECT ca_state, SUM(cr_return_amount) AS total_return_amount, AVG(cr_return_amount) AS avg_return_amount, COUNT(*) AS return_count, SUM(ss_net_profit) AS total_store_sales_profit, AVG(ss_net_profit) AS avg_store_sales_profit, COUNT(DISTINCT ss_customer_sk) AS store_customer_count, SUM(ws_net_profit) AS total_web_sales_profit, AVG(ws_net_profit) AS avg_web_sales_profit, COUNT(DISTINCT ws_bill_customer_sk) AS web_customer_count FROM catalog_returns JOIN customer_address ON cr_returning_addr_sk = ca_address_sk JOIN store_sales ON catalog_returns.cr_item_sk = store_sales.ss_item_sk JOIN web_sales ON catalog_returns.cr_item_sk = web_sales.ws_item_sk JOIN promotion ON store_sales.ss_promo_sk = promotion.p_promo_sk AND web_sales.ws_promo_sk = promotion.p_promo_sk JOIN household_demographics ON (catalog_returns.cr_returning_hdemo_sk = household_demographics.hd_demo_sk OR store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk OR web_sales.ws_ship_hdemo_sk = household_demographics.hd_demo_sk) WHERE promotion.p_channel_demo = 'N' AND household_demographics.hd_income_band_sk IN (8, 10) AND household_demographics.hd_buy_potential IN ('>10000', 'Unknown', '0-500', '5001-10000', '1001-5000', '501-1000') AND catalog_returns.cr_reason_sk IN (9, 32, 23, 19) AND promotion.p_end_date_sk IN (2450545, 2450776) GROUP BY ca_state ORDER BY total_return_amount DESC;
SELECT w_warehouse_name, cd_credit_rating, AVG(cr_return_amount) AS avg_return_amount, SUM(cr_return_quantity) AS total_return_quantity, COUNT(DISTINCT cr_order_number) AS total_orders_returned, SUM(cr_net_loss) AS total_net_loss FROM catalog_returns INNER JOIN warehouse ON catalog_returns.cr_warehouse_sk = warehouse.w_warehouse_sk INNER JOIN customer_demographics ON catalog_returns.cr_refunded_cdemo_sk = customer_demographics.cd_demo_sk INNER JOIN household_demographics ON catalog_returns.cr_refunded_hdemo_sk = household_demographics.hd_demo_sk WHERE cr_returned_date_sk IN (2451154, 2451037, 2450875, 2450957, 2450981) AND household_demographics.hd_income_band_sk IN ('12', '7', '9', '5', '16', '3') AND household_demographics.hd_vehicle_count = 3 AND customer_demographics.cd_dep_employed_count = 0 AND catalog_returns.cr_store_credit IN (950.05, 59.82, 39.71) GROUP BY w_warehouse_name, cd_credit_rating ORDER BY total_net_loss DESC, avg_return_amount DESC;
SELECT cc.cc_call_center_id, cc.cc_name, cc.cc_city, cc.cc_state, SUM(ss.ss_net_paid) AS total_sales, AVG(ss.ss_ext_discount_amt) AS avg_discount_amount, COUNT(DISTINCT ss.ss_ticket_number) AS total_tickets, COUNT(DISTINCT p.p_promo_sk) AS total_promotions FROM call_center cc JOIN store_sales ss ON cc.cc_call_center_sk = ss.ss_store_sk JOIN promotion p ON ss.ss_promo_sk = p.p_promo_sk WHERE p.p_channel_dmail = 'Y' AND ss.ss_sold_date_sk BETWEEN p.p_start_date_sk AND p.p_end_date_sk GROUP BY cc.cc_call_center_id, cc.cc_name, cc.cc_city, cc.cc_state ORDER BY total_sales DESC, avg_discount_amount DESC;
SELECT c.c_customer_id, ca.ca_state, i.i_category, i.i_brand, SUM(i.i_current_price) AS total_revenue, AVG(i.i_wholesale_cost) AS average_wholesale_cost, COUNT(DISTINCT w.w_warehouse_sk) AS number_of_warehouses, COUNT(DISTINCT wp.wp_web_page_sk) AS number_of_web_pages FROM customer AS c JOIN customer_address AS ca ON c.c_current_addr_sk = ca.ca_address_sk JOIN item AS i ON i.i_manufact_id = c.c_customer_sk LEFT JOIN warehouse AS w ON w.w_state = ca.ca_state LEFT JOIN web_page AS wp ON wp.wp_customer_sk = c.c_customer_sk WHERE i.i_brand = 'amalgunivamalg #14' AND i.i_product_name IN ('eingprioughtable', 'eingationese', 'n stoughtation', 'antiationese', 'n stableeseese', 'anticallycally') AND ca.ca_country = 'United States' AND w.w_country = ca.ca_country GROUP BY c.c_customer_id, ca.ca_state, i.i_category, i.i_brand ORDER BY total_revenue DESC;
