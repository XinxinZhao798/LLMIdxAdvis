SELECT r.r_name AS region_name, n.n_name AS nation_name, COUNT(l.l_orderkey) AS number_of_orders, SUM(l.l_quantity) AS total_quantity, AVG(l.l_extendedprice) AS average_price, SUM(l.l_extendedprice * (1 - l.l_discount)) AS revenue_after_discount, AVG(l.l_discount) AS average_discount FROM region r JOIN nation n ON r.r_regionkey = n.n_regionkey JOIN lineitem l ON l.l_suppkey = n.n_nationkey WHERE r.r_name IN ('AFRICA', 'EUROPE') AND n.n_nationkey IN (3, 1, 2, 10, 15) AND l.l_shipdate >= DATE '2021-01-01' AND l.l_shipdate < DATE '2022-01-01' GROUP BY r.r_name, n.n_name ORDER BY revenue_after_discount DESC, region_name, nation_name;
SELECT n.n_name AS nation_name, p.p_type AS part_type, sum(l.l_quantity) AS total_quantity, avg(l.l_extendedprice) AS avg_price, count(*) AS lineitem_count, sum(l.l_extendedprice * (1 - l.l_discount)) AS total_revenue FROM nation n JOIN region r ON n.n_regionkey = r.r_regionkey JOIN lineitem l ON l.l_partkey IN (SELECT p_partkey FROM part WHERE p_type IN ('SMALL BURNISHED TIN', 'MEDIUM ANODIZED COPPER', 'LARGE ANODIZED NICKEL') AND p_size IN (30, 35)) JOIN part p ON l.l_partkey = p.p_partkey WHERE n.n_nationkey IN (13, 1, 5, 8) AND l.l_commitdate <= '1995-11-03' GROUP BY nation_name, part_type ORDER BY total_revenue DESC;
SELECT r.r_name AS region_name, COUNT(DISTINCT c.c_custkey) AS num_customers, AVG(c.c_acctbal) AS avg_acct_balance FROM region r JOIN nation n ON r.r_regionkey = n.n_regionkey JOIN customer c ON n.n_nationkey = c.c_nationkey WHERE c.c_mktsegment = 'BUILDING' AND n.n_nationkey IN (17, 19, 6) GROUP BY r.r_name ORDER BY num_customers DESC, avg_acct_balance DESC;
SELECT c.c_mktsegment, COUNT(DISTINCT o.o_orderkey) AS total_orders, SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_sales, AVG(l.l_discount) AS average_discount FROM customer c JOIN orders o ON c.c_custkey = o.o_custkey JOIN lineitem l ON o.o_orderkey = l.l_orderkey JOIN part p ON l.l_partkey = p.p_partkey WHERE p.p_size BETWEEN 1 AND 50 AND l.l_shipdate BETWEEN DATE '1993-01-01' AND DATE '1994-12-31' AND l.l_returnflag = 'N' GROUP BY c.c_mktsegment ORDER BY total_sales DESC;
SELECT r_name AS region, n_name AS nation, COUNT(DISTINCT c_custkey) AS num_customers, SUM(c_acctbal) AS total_balance, AVG(c_acctbal) AS avg_balance, COUNT(DISTINCT o_orderkey) AS num_orders, SUM(o_totalprice) AS total_order_value, AVG(l_quantity) AS avg_lineitem_quantity, SUM(l_extendedprice * (1 - l_discount)) AS total_revenue, SUM(CASE WHEN l_returnflag = 'R' THEN l_quantity ELSE 0 END) AS returned_quantity FROM region JOIN nation ON r_regionkey = n_regionkey JOIN customer ON n_nationkey = c_nationkey JOIN orders ON c_custkey = o_custkey JOIN lineitem ON o_orderkey = l_orderkey WHERE l_shipdate BETWEEN date '2022-01-01' AND date '2022-12-31' GROUP BY region, nation ORDER BY total_order_value DESC, total_revenue DESC;
SELECT c.c_mktsegment, SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_revenue, AVG(l.l_quantity) AS average_quantity, COUNT(DISTINCT c.c_custkey) AS number_of_customers FROM customer c JOIN lineitem l ON c.c_custkey = l.l_suppkey JOIN partsupp ps ON l.l_partkey = ps.ps_partkey AND l.l_suppkey = ps.ps_suppkey WHERE l.l_shipdate BETWEEN date '2022-01-01' AND date '2022-12-31' GROUP BY c.c_mktsegment ORDER BY total_revenue DESC;
SELECT c.c_mktsegment, s.s_nationkey, COUNT(DISTINCT o.o_orderkey) AS order_count, SUM(o.o_totalprice) AS total_sales, AVG(ps.ps_supplycost) AS average_supply_cost, SUM(ps.ps_availqty) AS total_available_quantity FROM customer c JOIN orders o ON c.c_custkey = o.o_custkey JOIN partsupp ps ON o.o_orderkey = ps.ps_partkey JOIN supplier s ON ps.ps_suppkey = s.s_suppkey WHERE o.o_orderdate BETWEEN '1995-01-01' AND '1995-12-31' AND o.o_orderstatus = 'F' GROUP BY c.c_mktsegment, s.s_nationkey ORDER BY total_sales DESC, c.c_mktsegment, s.s_nationkey;
SELECT r.r_name AS region, n.n_name AS nation, COUNT(DISTINCT s.s_suppkey) AS total_suppliers, COUNT(DISTINCT c.c_custkey) AS total_customers, SUM(l.l_quantity) AS total_quantity_ordered, AVG(l.l_extendedprice * (1 - l.l_discount)) AS avg_discounted_price, SUM(p.p_retailprice * l.l_quantity) AS total_retail_price FROM region r JOIN nation n ON n.n_regionkey = r.r_regionkey JOIN supplier s ON s.s_nationkey = n.n_nationkey JOIN customer c ON c.c_nationkey = n.n_nationkey JOIN orders o ON o.o_custkey = c.c_custkey JOIN lineitem l ON l.l_orderkey = o.o_orderkey JOIN partsupp ps ON ps.ps_suppkey = s.s_suppkey AND ps.ps_partkey = l.l_partkey JOIN part p ON p.p_partkey = l.l_partkey WHERE r.r_name IN ('EUROPE', 'AMERICA') AND o.o_orderdate BETWEEN '1995-01-01' AND '1996-12-31' AND p.p_brand IN ('Brand#54', 'Brand#43') AND l.l_shipmode IN ('MAIL', 'SHIP') GROUP BY r.r_name, n.n_name ORDER BY total_quantity_ordered DESC, avg_discounted_price DESC;
SELECT n_name AS nation, COUNT(DISTINCT c_custkey) AS number_of_customers, COUNT(DISTINCT s_suppkey) AS number_of_suppliers, SUM(ps_availqty) AS total_available_quantity, AVG(l_extendedprice * (1 - l_discount)) AS avg_discounted_price, SUM(l_extendedprice * (1 - l_discount)) AS total_revenue FROM nation JOIN supplier ON n_nationkey = s_nationkey JOIN partsupp ON s_suppkey = ps_suppkey JOIN lineitem ON ps_partkey = l_partkey AND ps_suppkey = l_suppkey JOIN orders ON l_orderkey = o_orderkey JOIN customer ON o_custkey = c_custkey AND n_nationkey = c_nationkey WHERE n_name = 'BRAZIL' AND c_acctbal > 0 AND l_shipdate BETWEEN date '1995-01-01' AND date '1996-12-31' GROUP BY n_name ORDER BY total_revenue DESC;
SELECT n.n_name AS nation, COUNT(DISTINCT s.s_suppkey) AS number_of_suppliers, AVG(l.l_discount) AS average_discount, SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_revenue FROM supplier s JOIN nation n ON s.s_nationkey = n.n_nationkey JOIN partsupp ps ON s.s_suppkey = ps.ps_suppkey JOIN lineitem l ON ps.ps_partkey = l.l_partkey AND ps.ps_suppkey = l.l_suppkey JOIN orders o ON l.l_orderkey = o.o_orderkey WHERE l.l_shipdate >= '1994-01-01' AND l.l_shipdate < '1995-01-01' GROUP BY n.n_name ORDER BY total_revenue DESC, n.n_name;
SELECT r.r_name AS region_name, COUNT(DISTINCT c.c_custkey) AS number_of_customers, SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_revenue, AVG(c.c_acctbal) AS average_account_balance FROM region r JOIN customer c ON c.c_nationkey = r.r_regionkey JOIN orders o ON o.o_custkey = c.c_custkey JOIN lineitem l ON l.l_orderkey = o.o_orderkey GROUP BY r.r_name ORDER BY total_revenue DESC;
SELECT s.s_name, s.s_nationkey, COUNT(DISTINCT ps.ps_partkey) AS total_parts_supplied, AVG(ps.ps_supplycost) AS avg_supply_cost, SUM(s.s_acctbal) AS sum_acct_balance, COUNT(l.l_linenumber) AS total_lineitems_supplied FROM supplier s JOIN partsupp ps ON s.s_suppkey = ps.ps_suppkey JOIN lineitem l ON ps.ps_suppkey = l.l_suppkey AND ps.ps_partkey = l.l_partkey WHERE s.s_nationkey = 7 AND ps.ps_partkey IN (1080, 960, 197) AND l.l_shipdate < DATE '1996-06-09' GROUP BY s.s_name, s.s_nationkey ORDER BY total_parts_supplied DESC, avg_supply_cost ASC, sum_acct_balance DESC, total_lineitems_supplied DESC;
SELECT r_name AS region, n_name AS nation, COUNT(DISTINCT s_suppkey) AS num_suppliers, COUNT(DISTINCT c_custkey) AS num_customers, SUM(l_extendedprice * (1 - l_discount)) AS total_revenue, AVG(l_quantity) AS avg_quantity_sold, AVG(l_extendedprice) AS avg_price, AVG(l_discount) AS avg_discount_given FROM region JOIN nation ON r_regionkey = n_regionkey JOIN supplier ON s_nationkey = n_nationkey JOIN customer ON c_nationkey = n_nationkey JOIN orders ON o_custkey = c_custkey JOIN lineitem ON l_orderkey = o_orderkey WHERE o_orderstatus = 'F' AND n_nationkey IN ('18', '5', '17') AND r_regionkey IN ('3', '0', '4', '2') AND o_orderdate BETWEEN date '2022-01-01' AND date '2022-12-31' AND l_shipdate > o_orderdate GROUP BY region, nation ORDER BY total_revenue DESC, region, nation;
SELECT r.r_name AS region_name, COUNT(DISTINCT c.c_custkey) AS number_of_customers, AVG(c.c_acctbal) AS average_account_balance, SUM(p.ps_supplycost * p.ps_availqty) AS total_supply_cost, SUM(l.l_extendedprice * (1 - l.l_discount)) AS revenue_after_discount FROM region r JOIN customer c ON r.r_regionkey = c.c_nationkey JOIN partsupp p ON p.ps_partkey = c.c_custkey JOIN lineitem l ON l.l_suppkey = p.ps_suppkey AND l.l_partkey = p.ps_partkey WHERE r.r_comment LIKE 'ly final courts cajole furiously final excuse' OR r.r_comment LIKE 'ges. thinly even pinto beans ca' OR r.r_comment LIKE 'hs use ironic, even requests. s' GROUP BY r.r_name ORDER BY total_supply_cost DESC LIMIT 1;
SELECT r.r_name AS region, n.n_name AS nation, EXTRACT(YEAR FROM o.o_orderdate) AS order_year, COUNT(DISTINCT o.o_orderkey) AS total_orders, SUM(o.o_totalprice) AS total_revenue, AVG(o.o_totalprice) AS average_order_value FROM orders o JOIN nation n ON o.o_custkey = n.n_nationkey JOIN region r ON n.n_regionkey = r.r_regionkey GROUP BY region, nation, order_year ORDER BY region, nation, order_year;
SELECT n.n_name AS nation, COUNT(s.s_suppkey) AS number_of_suppliers, AVG(s.s_acctbal) AS average_account_balance, SUM(li.l_quantity) AS total_quantity_supplied FROM nation AS n JOIN supplier AS s ON n.n_nationkey = s.s_nationkey JOIN lineitem AS li ON s.s_suppkey = li.l_suppkey WHERE s.s_name IN ('Supplier#000021987', 'Supplier#000020830', 'Supplier#000021117', 'Supplier#000020718', 'Supplier#000021295', 'Supplier#000017813') GROUP BY n.n_name ORDER BY average_account_balance DESC, number_of_suppliers DESC;
SELECT n.n_name, COUNT(o.o_orderkey) AS total_orders, AVG(o.o_totalprice) AS avg_order_price, SUM(ps.ps_supplycost * ps.ps_availqty) AS total_supply_cost, MAX(o.o_orderdate) AS latest_order_date FROM nation n JOIN orders o ON n.n_nationkey = o.o_custkey JOIN partsupp ps ON o.o_orderkey = ps.ps_partkey WHERE n.n_name IN ('IRAQ', 'MOROCCO', 'INDONESIA', 'UNITED KINGDOM', 'RUSSIA', 'SAUDI ARABIA') AND o.o_orderstatus = 'F' AND o.o_orderpriority IN ('1-URGENT', '5-LOW', '3-MEDIUM') GROUP BY n.n_name ORDER BY total_orders DESC, avg_order_price DESC;
SELECT r_name AS region, n_name AS nation, p_brand AS part_brand, COUNT(DISTINCT o_orderkey) AS total_orders, SUM(l_extendedprice) AS total_sales, AVG(l_extendedprice * (1 - l_discount)) AS avg_discounted_sales, SUM(l_quantity) AS total_quantity_sold, AVG(l_quantity) AS avg_quantity_sold FROM region JOIN nation ON r_regionkey = n_regionkey JOIN orders ON n_nationkey = o_custkey JOIN lineitem ON o_orderkey = l_orderkey JOIN part ON l_partkey = p_partkey WHERE o_orderstatus IN ('F', 'O', 'P') AND p_brand IN ('Brand#34', 'Brand#42', 'Brand#15', 'Brand#14', 'Brand#13') AND l_shipinstruct IN ('TAKE BACK RETURN', 'DELIVER IN PERSON', 'COLLECT COD') AND l_shipdate >= '1994-10-27' AND o_shippriority = '0' GROUP BY region, nation, part_brand ORDER BY total_sales DESC, region, nation;
SELECT c.c_mktsegment, CASE WHEN p.p_size <= 10 THEN 'Small' WHEN p.p_size > 10 AND p.p_size <= 20 THEN 'Medium' ELSE 'Large' END AS part_size_range, SUM(l.l_quantity) AS total_quantity, AVG(l.l_extendedprice) AS average_price, COUNT(DISTINCT l.l_orderkey) AS total_orders FROM customer c JOIN lineitem l ON c.c_custkey = l.l_suppkey JOIN part p ON l.l_partkey = p.p_partkey WHERE l.l_shipdate BETWEEN '1995-01-01' AND '1996-12-31' GROUP BY c.c_mktsegment, part_size_range ORDER BY c.c_mktsegment, part_size_range;
SELECT r.r_name AS region_name, n.n_name AS nation_name, COUNT(DISTINCT s.s_suppkey) AS number_of_suppliers, COUNT(DISTINCT c.c_custkey) AS number_of_customers, SUM(o.o_totalprice) AS total_sales, AVG(ps.ps_supplycost) AS average_supply_cost, SUM(ps.ps_availqty) AS total_available_quantity FROM region r JOIN nation n ON r.r_regionkey = n.n_regionkey JOIN supplier s ON n.n_nationkey = s.s_nationkey JOIN partsupp ps ON s.s_suppkey = ps.ps_suppkey JOIN customer c ON n.n_nationkey = c.c_nationkey JOIN orders o ON c.c_custkey = o.o_custkey WHERE r.r_regionkey IN (1, 2) AND s.s_name IN ('Supplier#000018799', 'Supplier#000020578', 'Supplier#000019447', 'Supplier#000021983', 'Supplier#000017876') AND c.c_name IN ('Customer#000027493', 'Customer#000025716', 'Customer#000026515', 'Customer#000028252', 'Customer#000027961', 'Customer#000026576') GROUP BY r.r_name, n.n_name ORDER BY total_sales DESC, region_name, nation_name;
SELECT r_name AS region, p_type AS part_type, COUNT(DISTINCT s_suppkey) AS number_of_suppliers, COUNT(DISTINCT c_custkey) AS number_of_customers, SUM(l_quantity) AS total_quantity_ordered, AVG(l_extendedprice) AS average_order_value, SUM(l_extendedprice * (1 - l_discount)) AS total_revenue, COUNT(DISTINCT o_orderkey) AS number_of_orders FROM region JOIN supplier ON s_nationkey = r_regionkey JOIN lineitem ON l_suppkey = s_suppkey JOIN part ON p_partkey = l_partkey JOIN orders ON o_orderkey = l_orderkey JOIN customer ON c_custkey = o_custkey WHERE o_orderdate BETWEEN '1993-01-01' AND '1996-12-31' AND l_shipdate > l_commitdate AND c_mktsegment = 'BUILDING' GROUP BY region, part_type ORDER BY total_revenue DESC, region, part_type;
SELECT nation.n_name AS supplier_nation, COUNT(DISTINCT supplier.s_suppkey) AS number_of_suppliers, SUM(lineitem.l_quantity) AS total_quantity, AVG(lineitem.l_extendedprice) AS average_price, SUM(lineitem.l_extendedprice * (1 - lineitem.l_discount)) AS total_revenue_after_discount FROM supplier JOIN nation ON supplier.s_nationkey = nation.n_nationkey JOIN lineitem ON supplier.s_suppkey = lineitem.l_suppkey WHERE nation.n_name IN ('CHINA', 'VIETNAM', 'INDONESIA', 'GERMANY', 'SAUDI ARABIA', 'ARGENTINA') AND lineitem.l_linestatus IN ('F', 'O') AND lineitem.l_linenumber IN (5, 3) AND supplier.s_comment IN ( 's nag. slyly pending accounts', 'gular packages. ironic requ', 'ingly bold foxes are quickly regular t', 'l packages boost always slyly', 'otes are quickly final fo', 'ress final theodolites. blithely final pack' ) AND lineitem.l_shipdate BETWEEN '1995-01-01' AND '1996-12-31' GROUP BY supplier_nation ORDER BY total_revenue_after_discount DESC, supplier_nation;
SELECT c_mktsegment, n_name, AVG(o_totalprice) AS avg_order_value, SUM(l_extendedprice * (1 - l_discount)) AS total_sales, COUNT(DISTINCT o_orderkey) AS order_count FROM customer c JOIN orders o ON c.c_custkey = o.o_custkey JOIN nation n ON c.c_nationkey = n.n_nationkey JOIN lineitem l ON o.o_orderkey = l.l_orderkey JOIN part p ON l.l_partkey = p.p_partkey WHERE p.p_container = 'SM CASE' GROUP BY c_mktsegment, n_name ORDER BY total_sales DESC, avg_order_value DESC;
SELECT r_name AS region, c_mktsegment AS market_segment, COUNT(DISTINCT c_custkey) AS total_customers, SUM(l_extendedprice) AS total_sales, AVG(l_extendedprice * (1 - l_discount)) AS avg_discounted_sales, SUM(ps_availqty) AS total_available_quantity, AVG(s_acctbal) AS avg_supplier_balance FROM region JOIN supplier ON s_nationkey = r_regionkey JOIN customer ON c_nationkey = r_regionkey JOIN orders ON o_custkey = c_custkey JOIN lineitem ON l_orderkey = o_orderkey AND l_suppkey = s_suppkey JOIN partsupp ON ps_suppkey = s_suppkey AND ps_partkey = l_partkey WHERE r_name IN ('MIDDLE EAST', 'ASIA', 'EUROPE', 'AMERICA', 'AFRICA') AND o_orderdate BETWEEN date '1995-01-01' AND date '1996-12-31' AND l_returnflag IN ('N', 'A', 'R') GROUP BY r_name, c_mktsegment ORDER BY total_sales DESC, avg_discounted_sales DESC;
SELECT r.r_name AS region, n.n_name AS nation, COUNT(DISTINCT s.s_suppkey) AS total_suppliers, COUNT(DISTINCT c.c_custkey) AS total_customers, AVG(c.c_acctbal) AS average_customer_acctbal, SUM(l.l_extendedprice * (1 - l.l_discount)) AS revenue, AVG(l.l_quantity) AS average_quantity_sold, COUNT(DISTINCT o.o_orderkey) AS total_orders FROM region r JOIN nation n ON r.r_regionkey = n.n_regionkey JOIN customer c ON n.n_nationkey = c.c_nationkey JOIN orders o ON c.c_custkey = o.o_custkey JOIN lineitem l ON o.o_orderkey = l.l_orderkey JOIN supplier s ON n.n_nationkey = s.s_nationkey AND l.l_suppkey = s.s_suppkey GROUP BY r.r_name, n.n_name ORDER BY revenue DESC;
SELECT c_mktsegment, r_name AS region, SUM(l_extendedprice * (1 - l_discount)) AS revenue, AVG(l_quantity) AS average_quantity, COUNT(DISTINCT o_orderkey) AS total_orders, COUNT(DISTINCT s_suppkey) AS unique_suppliers FROM customer JOIN orders ON c_custkey = o_custkey JOIN lineitem ON o_orderkey = l_orderkey JOIN supplier ON s_suppkey = l_suppkey JOIN partsupp ON ps_suppkey = s_suppkey AND ps_partkey = l_partkey JOIN region ON r_regionkey = s_nationkey WHERE l_shipdate BETWEEN '2022-01-01' AND '2022-12-31' AND l_returnflag = 'N' AND o_orderstatus = 'F' GROUP BY c_mktsegment, r_name ORDER BY revenue DESC, c_mktsegment, r_name;
SELECT c.c_mktsegment, COUNT(DISTINCT o.o_orderkey) AS total_orders, AVG(o.o_totalprice) AS avg_order_price, SUM(o.o_totalprice) AS total_order_price, COUNT(DISTINCT ps.ps_suppkey) AS number_of_suppliers FROM customer c JOIN orders o ON c.c_custkey = o.o_custkey JOIN partsupp ps ON o.o_orderkey = ps.ps_partkey WHERE ps.ps_supplycost BETWEEN 50 AND 600 GROUP BY c.c_mktsegment ORDER BY total_order_price DESC;
SELECT c.c_mktsegment, AVG(c.c_acctbal) AS avg_customer_balance, p.p_type, COUNT(DISTINCT p.p_partkey) AS part_count, SUM(ps.ps_availqty) AS total_available_quantity, AVG(ps.ps_supplycost) AS avg_supply_cost FROM customer AS c JOIN partsupp AS ps ON c.c_custkey = ps.ps_suppkey JOIN part AS p ON ps.ps_partkey = p.p_partkey WHERE c.c_acctbal > 4000 AND c.c_comment LIKE '%excuses%' AND p.p_brand = 'Brand#23' AND p.p_size BETWEEN 30 AND 50 GROUP BY c.c_mktsegment, p.p_type ORDER BY avg_customer_balance DESC, part_count DESC;
SELECT r.r_name AS region, n.n_name AS nation, COUNT(DISTINCT s.s_suppkey) AS number_of_suppliers, COUNT(DISTINCT c.c_custkey) AS number_of_customers, SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_sales_value, AVG(l.l_quantity) AS average_quantity_sold, AVG(l.l_extendedprice) AS average_price, AVG(l.l_discount) AS average_discount, SUM(p.p_retailprice * l.l_quantity) AS potential_revenue FROM region r JOIN nation n ON r.r_regionkey = n.n_regionkey JOIN supplier s ON n.n_nationkey = s.s_nationkey JOIN customer c ON n.n_nationkey = c.c_nationkey JOIN orders o ON c.c_custkey = o.o_custkey JOIN lineitem l ON o.o_orderkey = l.l_orderkey JOIN part p ON l.l_partkey = p.p_partkey WHERE p.p_type IN ('ECONOMY POLISHED STEEL', 'SMALL POLISHED COPPER', 'LARGE ANODIZED BRASS', 'STANDARD POLISHED STEEL') AND l.l_shipdate BETWEEN DATE '1995-01-01' AND DATE '1995-12-31' GROUP BY r.r_name, n.n_name ORDER BY total_sales_value DESC, r.r_name, n.n_name;
SELECT n_name, COUNT(DISTINCT s_suppkey) AS number_of_suppliers, SUM(l_quantity) AS total_quantity, AVG(s_acctbal) AS avg_supplier_acct_balance, SUM(l_extendedprice * (1 - l_discount)) AS total_revenue, SUM(CASE WHEN l_returnflag = 'R' THEN l_extendedprice * (1 - l_discount) * (1 + l_tax) ELSE 0 END) AS total_returned_revenue, COUNT(DISTINCT o_orderkey) AS number_of_orders FROM nation JOIN supplier ON n_nationkey = s_nationkey JOIN lineitem ON s_suppkey = l_suppkey JOIN orders ON l_orderkey = o_orderkey WHERE n_comment LIKE '%final%' AND o_orderdate BETWEEN date '2022-01-01' AND date '2022-12-31' AND l_shipdate > o_orderdate GROUP BY n_name ORDER BY total_revenue DESC, n_name;
SELECT r.r_name AS region, AVG(c.c_acctbal) AS average_customer_balance, SUM(s.s_acctbal) AS total_supplier_balance, COUNT(DISTINCT p.p_partkey) AS number_of_unique_parts, SUM(ps.ps_availqty) AS total_available_quantity, AVG(ps.ps_supplycost) AS average_supply_cost FROM region r JOIN supplier s ON s.s_nationkey = r.r_regionkey JOIN customer c ON c.c_nationkey = r.r_regionkey JOIN partsupp ps ON ps.ps_suppkey = s.s_suppkey JOIN part p ON p.p_partkey = ps.ps_partkey WHERE p.p_size IN (40, 21, 11, 6, 48, 37) AND p.p_retailprice BETWEEN 100 AND 1000 AND c.c_name <> 'Customer#000024855' AND ps.ps_supplycost < 356.43 GROUP BY r.r_name ORDER BY total_supplier_balance DESC, average_customer_balance DESC LIMIT 5;
SELECT c.c_mktsegment, p.p_size, COUNT(DISTINCT l.l_orderkey) AS number_of_orders, SUM(l.l_extendedprice * (1 - l_discount)) AS total_revenue, AVG(l.l_discount) AS average_discount FROM customer AS c JOIN lineitem AS l ON c.c_custkey = l.l_suppkey JOIN part AS p ON l.l_partkey = p.p_partkey JOIN region AS r ON c.c_nationkey = r.r_regionkey WHERE c.c_mktsegment = 'AUTOMOBILE' AND r.r_name = 'AMERICA' AND p.p_size BETWEEN 1 AND 5 AND l.l_shipmode IN ('AIR', 'AIR REG') GROUP BY c.c_mktsegment, p.p_size ORDER BY total_revenue DESC;
SELECT r.r_name AS region, n.n_name AS nation, AVG(p.p_retailprice) AS avg_retail_price, SUM(ps.ps_availqty) AS total_avail_qty, SUM(ps.ps_availqty * ps.ps_supplycost) AS total_value FROM nation n JOIN region r ON n.n_regionkey = r.r_regionkey JOIN partsupp ps ON ps.ps_suppkey = n.n_nationkey JOIN part p ON p.p_partkey = ps.ps_partkey GROUP BY r.r_name, n.n_name ORDER BY total_value DESC, avg_retail_price DESC LIMIT 10;
SELECT n.n_name, p.p_brand, p.p_type, AVG(p.p_retailprice) AS avg_retail_price, SUM(l.l_quantity) AS total_quantity_sold, AVG(l.l_discount) AS avg_discount, COUNT(DISTINCT o.o_orderkey) AS number_of_orders FROM nation n JOIN lineitem l ON l.l_suppkey IN (SELECT ps_suppkey FROM partsupp WHERE ps_partkey = l.l_partkey) JOIN orders o ON l.l_orderkey = o.o_orderkey JOIN part p ON l.l_partkey = p.p_partkey WHERE n.n_nationkey IN (SELECT n_nationkey FROM nation WHERE n_name IN ('ETHIOPIA', 'CHINA', 'IRAN', 'EGYPT')) AND p.p_mfgr IN ('Manufacturer#3', 'Manufacturer#1', 'Manufacturer#5', 'Manufacturer#2') AND l.l_discount IN (0.03, 0.04, 0.01, 0.06, 0.00, 0.08) AND l.l_shipdate > CURRENT_DATE - INTERVAL '1 year' GROUP BY n.n_name, p.p_brand, p.p_type ORDER BY total_quantity_sold DESC, avg_retail_price DESC, n.n_name, p.p_brand, p.p_type;
SELECT p.p_type, COUNT(DISTINCT o.o_orderkey) AS total_orders, AVG(o.o_totalprice) AS average_order_value, SUM(ps.ps_availqty) AS total_available_quantity, SUM(ps.ps_supplycost * ps.ps_availqty) AS total_supply_cost, MAX(p.p_retailprice) AS max_retail_price FROM part p JOIN partsupp ps ON p.p_partkey = ps.ps_partkey JOIN orders o ON o.o_orderkey = ps.ps_suppkey WHERE p.p_container IN ('MED CAN', 'WRAP PACK', 'SM BAG', 'SM CASE') AND o.o_orderdate BETWEEN '2022-01-01' AND '2022-12-31' GROUP BY p.p_type ORDER BY total_supply_cost DESC, average_order_value DESC LIMIT 10;
SELECT r.r_name AS region_name, EXTRACT(YEAR FROM o.o_orderdate) AS order_year, COUNT(DISTINCT c.c_custkey) AS number_of_customers, SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_sales, AVG(l.l_quantity) AS average_quantity_sold, SUM(ps.ps_supplycost * l.l_quantity) AS total_supply_cost FROM region r JOIN supplier s ON s.s_nationkey = r.r_regionkey JOIN partsupp ps ON ps.ps_suppkey = s.s_suppkey JOIN part p ON p.p_partkey = ps.ps_partkey JOIN lineitem l ON l.l_partkey = p.p_partkey AND l.l_suppkey = s.s_suppkey JOIN orders o ON o.o_orderkey = l.l_orderkey JOIN customer c ON c.c_custkey = o.o_custkey AND c.c_nationkey = s.s_nationkey WHERE o.o_orderstatus = 'F' AND p.p_type IN ('MEDIUM PLATED STEEL', 'MEDIUM POLISHED NICKEL', 'MEDIUM BURNISHED BRASS', 'PROMO PLATED NICKEL') AND l.l_shipdate BETWEEN '1995-01-01' AND '1995-12-31' GROUP BY region_name, order_year ORDER BY total_sales DESC, region_name, order_year;
SELECT r_name AS region, n_name AS nation, COUNT(DISTINCT s_suppkey) AS number_of_suppliers, COUNT(DISTINCT p_partkey) AS number_of_parts, SUM(l_extendedprice * (1 - l_discount)) AS total_revenue, AVG(l_quantity) AS average_quantity, AVG(l_extendedprice) AS average_price FROM region JOIN nation ON n_regionkey = r_regionkey JOIN supplier ON s_nationkey = n_nationkey JOIN partsupp ON ps_suppkey = s_suppkey JOIN part ON p_partkey = ps_partkey JOIN lineitem ON l_partkey = p_partkey AND l_suppkey = s_suppkey JOIN orders ON o_orderkey = l_orderkey WHERE r_name = 'ASIA' AND p_brand IN ('Brand#45', 'Brand#52', 'Brand#12', 'Brand#22', 'Brand#34', 'Brand#43') GROUP BY region, nation ORDER BY total_revenue DESC, nation;
SELECT c.c_mktsegment, COUNT(DISTINCT o.o_orderkey) AS total_orders, SUM(l.l_quantity) AS total_quantity, AVG(l.l_extendedprice * (1 - l.l_discount)) AS avg_discounted_price, SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_discounted_price, AVG(l.l_discount) AS avg_discount, COUNT(CASE WHEN l.l_returnflag = 'R' THEN 1 END) AS returned_orders, MAX(s.s_acctbal) AS max_supplier_acctbal, MIN(s.s_acctbal) AS min_supplier_acctbal FROM customer c JOIN orders o ON c.c_custkey = o.o_custkey JOIN lineitem l ON o.o_orderkey = l.l_orderkey JOIN supplier s ON l.l_suppkey = s.s_suppkey WHERE c.c_nationkey IN (12, 24, 22, 8, 7) AND l.l_shipinstruct IN ('COLLECT COD', 'TAKE BACK RETURN', 'NONE', 'DELIVER IN PERSON') AND l.l_returnflag IN ('N', 'A', 'R') AND o.o_orderstatus = 'F' GROUP BY c.c_mktsegment ORDER BY total_discounted_price DESC;
SELECT r_name AS region, n_name AS nation, COUNT(DISTINCT o_orderkey) AS number_of_orders, SUM(l_extendedprice) AS total_sales, AVG(l_quantity) AS average_quantity, SUM(l_quantity * l_extendedprice * (1 - l_discount)) AS revenue_after_discount FROM region JOIN nation ON n_regionkey = r_regionkey JOIN orders ON o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31' JOIN lineitem ON l_orderkey = o_orderkey JOIN part ON p_partkey = l_partkey WHERE p_retailprice IN (1106.19, 935.03, 1061.15, 1378.47) AND l_shipdate > l_commitdate GROUP BY region, nation ORDER BY total_sales DESC, number_of_orders DESC;
SELECT r.r_name AS region_name, COUNT(DISTINCT s.s_suppkey) AS total_suppliers, AVG(s.s_acctbal) AS average_account_balance, SUM(o.o_totalprice) AS total_order_value, COUNT(DISTINCT o.o_orderkey) AS total_orders, MIN(o.o_orderdate) AS earliest_order_date, MAX(o.o_orderdate) AS latest_order_date FROM region r JOIN supplier s ON r.r_regionkey = s.s_nationkey LEFT JOIN orders o ON s.s_suppkey = o.o_custkey GROUP BY r.r_name ORDER BY total_order_value DESC, average_account_balance DESC;
SELECT c.c_mktsegment, EXTRACT(YEAR FROM o.o_orderdate) AS order_year, COUNT(DISTINCT c.c_custkey) AS num_customers, COUNT(DISTINCT o.o_orderkey) AS num_orders, SUM(o.o_totalprice) AS total_revenue, AVG(o.o_totalprice) AS avg_order_value, SUM(p.p_retailprice) AS total_parts_value, AVG(p.p_retailprice) AS avg_part_price FROM customer c JOIN orders o ON c.c_custkey = o.o_custkey JOIN part p ON p.p_partkey = ANY (SELECT p_partkey FROM part WHERE p_comment LIKE '%s. instr%' OR p_comment LIKE '%ct furiously%' OR p_comment LIKE '%unusual%' OR p_comment LIKE '%old id%' OR p_comment LIKE '%r requests cajole flu%') WHERE c.c_name IN ('Customer#000023416', 'Customer#000027111', 'Customer#000023731', 'Customer#000025059', 'Customer#000023541', 'Customer#000028235') AND c.c_address IN ('Z8tV2uksV4Ml,yfagECI69f26scpmQWOeN', 'ejMUZ,WG1Q', '2P8wQpwlFa', 'igke6sLYDpoVUMkFod') AND o.o_orderstatus = 'F' GROUP BY c.c_mktsegment, order_year ORDER BY c.c_mktsegment, order_year;
SELECT r.r_name AS region, COUNT(DISTINCT c.c_custkey) AS num_customers, COUNT(DISTINCT s.s_suppkey) AS num_suppliers, COUNT(DISTINCT o.o_orderkey) AS num_orders, SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_revenue, AVG(l.l_quantity) AS avg_quantity, AVG(l.l_extendedprice) AS avg_extendedprice, AVG(l.l_discount) AS avg_discount FROM region r JOIN supplier s ON s.s_nationkey = r.r_regionkey JOIN customer c ON c.c_nationkey = r.r_regionkey JOIN orders o ON o.o_custkey = c.c_custkey JOIN lineitem l ON l.l_orderkey = o.o_orderkey WHERE r.r_name IN ('AFRICA', 'AMERICA') AND o.o_orderstatus = 'F' AND (l.l_returnflag = 'N' OR l.l_returnflag = 'R') AND l.l_shipdate BETWEEN DATE '2020-01-01' AND DATE '2020-12-31' AND l.l_quantity > ( SELECT AVG(l2.l_quantity) * 1.5 FROM lineitem l2 WHERE l2.l_partkey = l.l_partkey ) GROUP BY r.r_name ORDER BY total_revenue DESC;
SELECT r.r_name AS region_name, n.n_name AS nation_name, COUNT(DISTINCT o.o_orderkey) AS number_of_orders, SUM(l.l_quantity) AS total_quantity, AVG(l.l_extendedprice) AS average_price, SUM((l.l_extendedprice * (1 - l.l_discount))) AS revenue, AVG(l.l_discount) AS average_discount, MAX(o.o_totalprice) AS max_order_value FROM region r JOIN nation n ON r.r_regionkey = n.n_regionkey JOIN orders o ON o.o_orderkey IN (SELECT l_orderkey FROM lineitem WHERE l_shipdate BETWEEN '1994-01-01' AND '1994-12-31') JOIN lineitem l ON o.o_orderkey = l.l_orderkey JOIN part p ON l.l_partkey = p.p_partkey WHERE r.r_name IN ('EUROPE', 'AMERICA') AND l.l_receiptdate >= '1994-01-01' AND l.l_receiptdate < DATE '1994-01-01' + INTERVAL '1 year' AND p.p_type IN ('ECONOMY POLISHED STEEL', 'MEDIUM PLATED STEEL') AND o.o_orderpriority IN ('1-URGENT', '2-HIGH') GROUP BY region_name, nation_name ORDER BY revenue DESC, average_price DESC;
SELECT r.r_name AS region, n.n_name AS nation, COUNT(DISTINCT s.s_suppkey) AS number_of_suppliers, COUNT(DISTINCT c.c_custkey) AS number_of_customers, SUM(o.o_totalprice) AS total_sales, AVG(c.c_acctbal) AS average_customer_balance, AVG(s.s_acctbal) AS average_supplier_balance, COUNT(DISTINCT o.o_orderkey) AS number_of_orders FROM region r JOIN nation n ON r.r_regionkey = n.n_regionkey JOIN supplier s ON n.n_nationkey = s.s_nationkey JOIN customer c ON n.n_nationkey = c.c_nationkey JOIN orders o ON c.c_custkey = o.o_custkey WHERE o.o_orderstatus = 'F' AND o.o_orderdate BETWEEN DATE '2022-01-01' AND DATE '2022-12-31' AND o.o_clerk IN ('Clerk#000000428', 'Clerk#000021706', 'Clerk#000006122') GROUP BY r.r_name, n.n_name ORDER BY total_sales DESC, region, nation;
SELECT r.r_name AS region_name, COUNT(DISTINCT s.s_suppkey) AS number_of_suppliers, SUM(o.o_totalprice) AS total_order_value, AVG(s.s_acctbal) AS average_supplier_account_balance FROM region r JOIN nation n ON r.r_regionkey = n.n_regionkey JOIN supplier s ON n.n_nationkey = s.s_nationkey JOIN partsupp ps ON s.s_suppkey = ps.ps_suppkey JOIN orders o ON ps.ps_suppkey = o.o_custkey WHERE r.r_regionkey = 3 AND o.o_shippriority = 0 AND s.s_phone IN ('16-788-260-1555', '22-116-846-1797', '10-306-731-9589') GROUP BY r.r_name ORDER BY total_order_value DESC, average_supplier_account_balance DESC;
SELECT n.n_name AS nation, EXTRACT(YEAR FROM o.o_orderdate) AS order_year, COUNT(DISTINCT o.o_orderkey) AS total_orders, SUM(li.l_extendedprice * (1 - li.l_discount)) AS total_revenue, AVG(li.l_quantity) AS avg_quantity_sold, SUM(ps.ps_supplycost * li.l_quantity) AS total_supply_cost, (SUM(li.l_extendedprice * (1 - li.l_discount)) - SUM(ps.ps_supplycost * li.l_quantity)) AS total_profit FROM orders o JOIN lineitem li ON o.o_orderkey = li.l_orderkey JOIN partsupp ps ON li.l_partkey = ps.ps_partkey AND li.l_suppkey = ps.ps_suppkey JOIN supplier s ON li.l_suppkey = s.s_suppkey JOIN nation n ON s.s_nationkey = n.n_nationkey WHERE o.o_orderdate BETWEEN '1995-01-01' AND '1996-12-31' AND n.n_regionkey IN (1, 2, 3) AND s.s_comment LIKE '%ruthless%' GROUP BY nation, order_year ORDER BY nation, order_year DESC;
SELECT r.r_name AS region, n.n_name AS nation, COUNT(DISTINCT s.s_suppkey) AS total_suppliers, COUNT(DISTINCT c.c_custkey) AS total_customers, COUNT(DISTINCT o.o_orderkey) AS total_orders, AVG(s.s_acctbal) AS avg_supplier_acctbal, AVG(c.c_acctbal) AS avg_customer_acctbal, SUM(o.o_totalprice) AS total_order_value, AVG(ps.ps_supplycost) AS avg_part_supply_cost, SUM(ps.ps_availqty) AS total_available_parts_qty FROM region r JOIN nation n ON r.r_regionkey = n.n_regionkey JOIN supplier s ON n.n_nationkey = s.s_nationkey JOIN customer c ON n.n_nationkey = c.c_nationkey JOIN orders o ON c.c_custkey = o.o_custkey JOIN partsupp ps ON s.s_suppkey = ps.ps_suppkey WHERE o.o_orderstatus = 'O' AND o.o_clerk IN ('Clerk#000008805', 'Clerk#000017121', 'Clerk#000001732', 'Clerk#000008709') AND EXISTS ( SELECT 1 FROM part p WHERE p.p_partkey = ps.ps_partkey AND p.p_brand IN ('Brand#53', 'Brand#52', 'Brand#13', 'Brand#42', 'Brand#24') ) GROUP BY r.r_name, n.n_name ORDER BY total_order_value DESC;
SELECT r_name AS region, p_brand, p_type, p_size, COUNT(DISTINCT s_suppkey) AS number_of_suppliers, SUM(l_quantity) AS total_quantity, AVG(l_extendedprice) AS avg_price, SUM(l_extendedprice * (1 - l_discount)) AS revenue, AVG(ps_supplycost) AS avg_supply_cost FROM region JOIN supplier ON s_nationkey = r_regionkey JOIN partsupp ON ps_suppkey = s_suppkey JOIN part ON p_partkey = ps_partkey JOIN lineitem ON l_partkey = p_partkey AND l_suppkey = s_suppkey WHERE p_size IN (28, 45, 36, 50) AND p_comment IN ('ly unusu', 'careful, regular de', 'blithely fina', 'uests. multi') GROUP BY region, p_brand, p_type, p_size ORDER BY revenue DESC, avg_price DESC;
SELECT s_nationkey, p_brand, p_type, AVG(ps_supplycost) AS average_supply_cost, SUM(l_quantity) AS total_quantity_sold, SUM(l_extendedprice * (1 - l_discount)) AS revenue, COUNT(DISTINCT s_suppkey) AS number_of_suppliers FROM supplier JOIN partsupp ON s_suppkey = ps_suppkey JOIN lineitem ON ps_partkey = l_partkey AND ps_suppkey = l_suppkey JOIN part ON p_partkey = l_partkey WHERE l_shipdate > '1995-01-01' AND (l_commitdate = '1997-05-22' OR l_commitdate = '1996-04-19') AND l_tax = 0.02 AND l_returnflag = 'N' GROUP BY s_nationkey, p_brand, p_type ORDER BY s_nationkey, revenue DESC;
SELECT c.c_mktsegment, s.s_name, COUNT(DISTINCT o.o_orderkey) AS total_orders, SUM(l.l_extendedprice * (1 - l.l_discount)) AS revenue, AVG(l.l_quantity) AS average_quantity, AVG(l.l_extendedprice) AS average_price, AVG(l.l_discount) AS average_discount FROM customer c JOIN orders o ON c.c_custkey = o.o_custkey JOIN lineitem l ON o.o_orderkey = l.l_orderkey JOIN supplier s ON l.l_suppkey = s.s_suppkey WHERE c.c_mktsegment IN ('MACHINERY', 'AUTOMOBILE', 'FURNITURE') AND o.o_orderstatus = 'O' AND s.s_comment LIKE '%fluffily%' AND l.l_shipdate BETWEEN '1995-01-01' AND '1996-12-31' GROUP BY c.c_mktsegment, s.s_name ORDER BY revenue DESC, c.c_mktsegment, s.s_name;
SELECT c.c_mktsegment, p.p_brand, p.p_type, AVG(o.o_totalprice) AS avg_order_total, SUM(o.o_totalprice) AS sum_order_total, COUNT(DISTINCT o.o_orderkey) AS count_orders, COUNT(DISTINCT c.c_custkey) AS count_customers FROM customer c JOIN orders o ON c.c_custkey = o.o_custkey JOIN part p ON p.p_brand = ANY(ARRAY['Brand#12', 'Brand#14', 'Brand#42', 'Brand#55']) WHERE c.c_address LIKE 'Y5wV4FpS1vFtKWyF1iIRyELoIzUEf1ii%' AND p.p_type IN ('PROMO BRUSHED STEEL', 'LARGE BRUSHED NICKEL', 'PROMO ANODIZED NICKEL', 'SMALL BRUSHED STEEL') AND o.o_orderdate BETWEEN date '1995-01-01' AND date '1995-12-31' GROUP BY c.c_mktsegment, p.p_brand, p.p_type ORDER BY sum_order_total DESC, count_orders DESC, c.c_mktsegment, p.p_brand, p.p_type;
SELECT n.n_name AS nation_name, p.p_type AS part_type, COUNT(DISTINCT ps.ps_suppkey) AS unique_suppliers, SUM(ps.ps_availqty) AS total_availability, AVG(ps.ps_supplycost) AS average_supply_cost, MIN(p.p_retailprice) AS min_retail_price, MAX(p.p_retailprice) AS max_retail_price FROM nation AS n JOIN partsupp AS ps ON n.n_nationkey = ps.ps_suppkey JOIN part AS p ON ps.ps_partkey = p.p_partkey WHERE n.n_regionkey IN (1, 4, 0, 2, 3) AND ( p.p_container = 'WRAP PKG' OR p.p_container = 'LG PACK' OR p.p_container = 'LG PKG' OR p.p_container = 'WRAP CAN' OR p.p_container = 'JUMBO PKG' ) GROUP BY n.n_name, p.p_type ORDER BY total_availability DESC, average_supply_cost ASC;
SELECT r_name AS region, c_mktsegment AS market_segment, COUNT(DISTINCT c_custkey) AS total_customers, SUM(l_extendedprice) AS total_sales, AVG(l_extendedprice * (1 - l_discount)) AS avg_discounted_sales, SUM(l_quantity) AS total_quantity_sold FROM customer JOIN lineitem ON c_custkey = l_orderkey JOIN part ON part.p_partkey = lineitem.l_partkey JOIN region ON region.r_regionkey = customer.c_nationkey WHERE l_shipdate BETWEEN '2022-01-01' AND '2022-12-31' AND l_linestatus = 'O' AND p_mfgr IN ('Manufacturer#1', 'Manufacturer#2', 'Manufacturer#3', 'Manufacturer#4', 'Manufacturer#5') AND r_name IN ('MIDDLE EAST', 'ASIA', 'EUROPE', 'AMERICA', 'AFRICA') GROUP BY region, market_segment ORDER BY total_sales DESC, market_segment;
SELECT r.r_name AS region, n.n_name AS nation, COUNT(DISTINCT s.s_suppkey) AS supplier_count, COUNT(DISTINCT c.c_custkey) AS customer_count, SUM(l.l_extendedprice) AS total_sales, AVG(l.l_discount) AS avg_discount, SUM(l.l_quantity) AS total_quantity, COUNT(DISTINCT o.o_orderkey) AS order_count FROM region r JOIN nation n ON r.r_regionkey = n.n_regionkey JOIN supplier s ON n.n_nationkey = s.s_nationkey JOIN partsupp ps ON s.s_suppkey = ps.ps_suppkey JOIN lineitem l ON ps.ps_partkey = l.l_partkey AND ps.ps_suppkey = l.l_suppkey JOIN orders o ON l.l_orderkey = o.o_orderkey JOIN customer c ON o.o_custkey = c.c_custkey AND c.c_nationkey = n.n_nationkey WHERE r.r_name IN ('EUROPE', 'AMERICA') AND l.l_shipdate BETWEEN '1995-01-01' AND '1995-12-31' AND o.o_orderstatus = 'F' GROUP BY r.r_name, n.n_name ORDER BY total_sales DESC, region, nation;
SELECT r_name AS region, n_name AS nation, EXTRACT(YEAR FROM o_orderdate) AS order_year, COUNT(*) AS total_orders, AVG(o_totalprice) AS average_order_price, SUM(l_quantity) AS total_quantity_sold, SUM(l_extendedprice * (1 - l_discount)) AS revenue_after_discount FROM region JOIN nation ON n_regionkey = r_regionkey JOIN orders ON o_custkey = n_nationkey JOIN lineitem ON l_orderkey = o_orderkey WHERE o_orderstatus = 'F' AND l_returnflag = 'N' AND n_name IN ('ARGENTINA', 'EGYPT') AND r_name IN ('region1', 'region2', 'region3', 'region4', 'region5') AND l_shipdate BETWEEN date '2022-01-01' AND date '2022-12-31' GROUP BY region, nation, order_year ORDER BY region, nation, order_year;
SELECT n.n_name AS nation, COUNT(o.o_orderkey) AS total_orders, AVG(l.l_quantity) AS average_quantity, SUM(l.l_extendedprice) AS total_sales, SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_sales_after_discount, SUM(CASE WHEN l.l_returnflag = 'R' THEN 1 ELSE 0 END) AS total_returns FROM nation n JOIN customer c ON n.n_nationkey = c.c_nationkey JOIN orders o ON c.c_custkey = o.o_custkey JOIN lineitem l ON o.o_orderkey = l.l_orderkey GROUP BY n.n_name ORDER BY total_sales DESC;
SELECT r.r_name AS region, c.c_mktsegment AS market_segment, COUNT(DISTINCT o.o_orderkey) AS total_orders, SUM(l.l_extendedprice) AS total_sales, AVG(l.l_extendedprice / l.l_quantity) AS avg_sale_price, AVG(l.l_discount) AS avg_discount_rate, COUNT(DISTINCT s.s_suppkey) AS total_suppliers FROM region r JOIN nation n ON r.r_regionkey = n.n_regionkey JOIN customer c ON n.n_nationkey = c.c_nationkey JOIN orders o ON c.c_custkey = o.o_custkey JOIN lineitem l ON o.o_orderkey = l.l_orderkey JOIN supplier s ON l.l_suppkey = s.s_suppkey WHERE o.o_orderstatus = 'F' AND c.c_mktsegment = 'HOUSEHOLD' GROUP BY region, market_segment ORDER BY total_sales DESC;
SELECT c.c_mktsegment, r.r_name AS region, COUNT(DISTINCT o.o_orderkey) AS total_orders, SUM(l.l_extendedprice * (1 - l.l_discount)) AS revenue, AVG(l.l_quantity) AS average_quantity, AVG(l.l_extendedprice) AS average_price, AVG(l.l_discount) AS average_discount, COUNT(DISTINCT s.s_suppkey) AS total_suppliers FROM customer c JOIN orders o ON c.c_custkey = o.o_custkey JOIN lineitem l ON o.o_orderkey = l.l_orderkey JOIN supplier s ON s.s_suppkey = l.l_suppkey JOIN region r ON s.s_nationkey = r.r_regionkey WHERE o.o_orderdate BETWEEN '1994-01-01' AND '1994-12-31' AND l.l_shipdate > o.o_orderdate GROUP BY c.c_mktsegment, region ORDER BY revenue DESC, c.c_mktsegment, region;
SELECT r_name AS region, n_name AS nation, COUNT(DISTINCT s_suppkey) AS num_suppliers, COUNT(DISTINCT c_custkey) AS num_customers, SUM(l_extendedprice) AS total_sales, AVG(l_extendedprice * (1 - l_discount)) AS avg_discounted_sales, SUM(ps_availqty) AS total_avail_qty, AVG(s_acctbal) AS avg_supplier_acctbal, AVG(c_acctbal) AS avg_customer_acctbal FROM region JOIN nation ON n_regionkey = r_regionkey JOIN supplier ON s_nationkey = n_nationkey JOIN customer ON c_nationkey = n_nationkey JOIN partsupp ON ps_suppkey = s_suppkey JOIN lineitem ON l_suppkey = s_suppkey AND l_partkey = ps_partkey JOIN orders ON o_orderkey = l_orderkey AND o_custkey = c_custkey WHERE r_name IN ('ASIA', 'AFRICA', 'EUROPE', 'AMERICA') AND o_orderpriority IN ('2-HIGH', '5-LOW') AND l_shipdate BETWEEN date '1992-01-01' AND date '1993-01-01' GROUP BY region, nation ORDER BY total_sales DESC, avg_discounted_sales DESC;
SELECT region.r_name AS Region, customer.c_mktsegment AS MarketSegment, COUNT(DISTINCT lineitem.l_orderkey) AS TotalOrders, SUM(lineitem.l_extendedprice * (1 - lineitem.l_discount)) AS TotalSales, AVG(lineitem.l_extendedprice * (1 - lineitem.l_discount)) AS AverageSalePerOrder FROM lineitem JOIN part ON lineitem.l_partkey = part.p_partkey JOIN customer ON customer.c_custkey = lineitem.l_suppkey JOIN nation ON customer.c_nationkey = nation.n_nationkey JOIN region ON nation.n_regionkey = region.r_regionkey WHERE lineitem.l_shipdate BETWEEN '1994-01-01' AND '1994-12-31' AND part.p_size IN (22, 44) AND part.p_type IN ('SMALL PLATED BRASS', 'PROMO ANODIZED TIN') GROUP BY Region, MarketSegment ORDER BY TotalSales DESC, AverageSalePerOrder DESC;
SELECT r.r_name AS region_name, n.n_name AS nation_name, COUNT(DISTINCT o.o_orderkey) AS number_of_orders, AVG(c.c_acctbal) AS average_customer_account_balance, SUM(o.o_totalprice) AS total_sales_value FROM region r JOIN nation n ON r.r_regionkey = n.n_regionkey JOIN customer c ON n.n_nationkey = c.c_nationkey JOIN orders o ON c.c_custkey = o.o_custkey WHERE o.o_totalprice > ( SELECT AVG(o2.o_totalprice) FROM orders o2 ) GROUP BY r.r_name, n.n_name ORDER BY r.r_name, total_sales_value DESC;
SELECT n_name, p_brand, p_type, l_shipmode, AVG(l_discount) AS average_discount, SUM(l_quantity) AS total_quantity, COUNT(*) AS lineitem_count, SUM(l_extendedprice * (1 - l_discount)) AS total_revenue, AVG(l_extendedprice * (1 - l_discount)) AS average_revenue FROM nation JOIN lineitem ON n_nationkey = l_suppkey JOIN orders ON l_orderkey = o_orderkey JOIN part ON l_partkey = p_partkey WHERE n_regionkey = 2 AND l_shipmode IN ('SHIP', 'RAIL', 'TRUCK') AND o_orderdate >= date '2020-01-01' AND o_orderdate < date '2020-01-01' + INTERVAL '1 YEAR' GROUP BY n_name, p_brand, p_type, l_shipmode ORDER BY total_revenue DESC, n_name, p_brand, p_type, l_shipmode LIMIT 10;
SELECT r.r_name AS region_name, n.n_name AS nation_name, COUNT(DISTINCT s.s_suppkey) AS total_suppliers, COUNT(DISTINCT c.c_custkey) AS total_customers, ROUND(AVG(s.s_acctbal), 2) AS avg_supplier_acctbal, ROUND(AVG(c.c_acctbal), 2) AS avg_customer_acctbal, SUM(o.o_totalprice) AS total_order_value, COUNT(DISTINCT o.o_orderkey) AS total_orders FROM region r JOIN nation n ON r.r_regionkey = n.n_regionkey JOIN supplier s ON n.n_nationkey = s.s_nationkey JOIN customer c ON c.c_nationkey = n.n_nationkey JOIN orders o ON c.c_custkey = o.o_custkey WHERE r.r_name IN ('AMERICA', 'EUROPE') AND o.o_orderpriority IN ('1-URGENT', '3-MEDIUM') AND c.c_address IN ('jyIxl9h6Y7wvYTY', 'G20AFhZXIqAi0Cpvw', 'P2tTIy0dj4Xy2YeXlzC,NZlNG0jpFMB7cp', 'svYKhcj9Y992alo') GROUP BY region_name, nation_name ORDER BY total_order_value DESC, total_orders DESC;
SELECT r.r_name AS region, n.n_name AS nation, COUNT(DISTINCT s.s_suppkey) AS supplier_count, COUNT(DISTINCT c.c_custkey) AS customer_count, SUM(ps.ps_availqty) AS total_available_parts, AVG(s.s_acctbal) AS avg_supplier_acct_balance, AVG(c.c_acctbal) AS avg_customer_acct_balance, SUM(l.l_quantity) AS total_quantity_ordered, SUM(l.l_extendedprice * (1 - l.l_discount)) AS revenue_after_discount FROM region r JOIN nation n ON r.r_regionkey = n.n_regionkey JOIN supplier s ON n.n_nationkey = s.s_nationkey JOIN customer c ON n.n_nationkey = c.c_nationkey JOIN partsupp ps ON s.s_suppkey = ps.ps_suppkey JOIN lineitem l ON ps.ps_partkey = l.l_partkey AND ps.ps_suppkey = l.l_suppkey JOIN orders o ON l.l_orderkey = o.o_orderkey AND o.o_custkey = c.c_custkey WHERE n.n_name IN ('CHINA', 'MOROCCO', 'UNITED STATES', 'INDIA', 'KENYA', 'IRAQ') AND l.l_shipdate BETWEEN '1995-01-01' AND '1995-12-31' GROUP BY region, nation ORDER BY revenue_after_discount DESC, region, nation;
SELECT r.r_name AS region, n.n_name AS nation, COUNT(DISTINCT c.c_custkey) AS number_of_customers, SUM(o.o_totalprice) AS total_sales, AVG(c.c_acctbal) AS avg_customer_balance, AVG(l.l_quantity) AS avg_lineitem_quantity, SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_revenue, MAX(p.p_retailprice) AS max_part_retailprice, MIN(ps.ps_supplycost) AS min_supplycost FROM region r JOIN nation n ON r.r_regionkey = n.n_regionkey JOIN customer c ON n.n_nationkey = c.c_nationkey JOIN orders o ON c.c_custkey = o.o_custkey JOIN lineitem l ON o.o_orderkey = l.l_orderkey JOIN part p ON l.l_partkey = p.p_partkey JOIN partsupp ps ON p.p_partkey = ps.ps_partkey AND l.l_suppkey = ps.ps_suppkey WHERE r.r_name IN ('MIDDLE EAST', 'ASIA', 'EUROPE', 'AMERICA') AND o.o_orderpriority IN ('1-URGENT', '5-LOW', '4-NOT SPECIFIED') AND c.c_mktsegment IN ('FURNITURE', 'MACHINERY') GROUP BY region, nation ORDER BY total_sales DESC, total_revenue DESC;
SELECT r.r_name AS region_name, COUNT(DISTINCT c.c_custkey) AS number_of_customers, AVG(c.c_acctbal) AS average_account_balance, COUNT(DISTINCT o.o_orderkey) AS number_of_orders, SUM(o.o_totalprice) AS total_sales, AVG(o.o_totalprice) AS average_order_value FROM region r JOIN customer c ON r.r_regionkey = c.c_nationkey JOIN orders o ON c.c_custkey = o.o_custkey WHERE r.r_regionkey IN (0, 1, 3, 4) AND o.o_orderstatus = 'F' GROUP BY r.r_name ORDER BY total_sales DESC, region_name;
SELECT r_name AS region, n_name AS nation, p_brand, COUNT(DISTINCT s_suppkey) AS number_of_suppliers, COUNT(DISTINCT c_custkey) AS number_of_customers, SUM(l_quantity) AS total_quantity_sold, AVG(l_extendedprice * (1 - l_discount)) AS avg_discounted_price, SUM(l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity) AS total_profit FROM region JOIN nation ON n_regionkey = r_regionkey JOIN supplier ON s_nationkey = n_nationkey JOIN customer ON c_nationkey = n_nationkey JOIN partsupp ON ps_suppkey = s_suppkey JOIN part ON p_partkey = ps_partkey JOIN lineitem ON l_partkey = p_partkey AND l_suppkey = s_suppkey WHERE r_regionkey = 4 AND p_brand IN ('Brand#21', 'Brand#44', 'Brand#43', 'Brand#22', 'Brand#13', 'Brand#33') AND (partsupp.ps_comment LIKE '%furiously%' OR partsupp.ps_comment LIKE '%special deposits%') AND (supplier.s_comment LIKE '%s? ironic accounts%' OR supplier.s_comment LIKE '%ts after the slyly%') GROUP BY region, nation, p_brand ORDER BY total_profit DESC, number_of_customers DESC;
SELECT c.c_mktsegment, AVG(c.c_acctbal) AS avg_acctbal, SUM(li.l_extendedprice) AS total_sales, COUNT(DISTINCT c.c_custkey) AS num_customers, COUNT(DISTINCT li.l_orderkey) AS num_orders, SUM(ps.ps_supplycost * ps.ps_availqty) AS total_supply_cost FROM customer c JOIN lineitem li ON c.c_custkey = li.l_suppkey JOIN partsupp ps ON li.l_partkey = ps.ps_partkey AND li.l_suppkey = ps.ps_suppkey WHERE c.c_nationkey IN (7, 8, 12) AND li.l_shipdate BETWEEN '2022-01-01' AND '2022-12-31' AND li.l_returnflag = 'N' GROUP BY c.c_mktsegment ORDER BY total_sales DESC;
SELECT r_name as region, n_name as nation, count(DISTINCT s_suppkey) as number_of_suppliers, count(DISTINCT c_custkey) as number_of_customers, avg(s_acctbal) as avg_supplier_acctbal, avg(c_acctbal) as avg_customer_acctbal, sum(o_totalprice) as total_sales_volume, count(DISTINCT o_orderkey) as number_of_orders FROM region JOIN nation ON r_regionkey = n_regionkey JOIN supplier ON n_nationkey = s_nationkey JOIN customer ON n_nationkey = c_nationkey JOIN orders ON c_custkey = o_custkey WHERE r_name IN ('AMERICA', 'ASIA') AND n_nationkey IN (19, 18) AND o_orderdate BETWEEN '2022-01-01' AND '2022-12-31' AND s_comment LIKE '%regular%' GROUP BY r_name, n_name ORDER BY total_sales_volume DESC, number_of_suppliers DESC, number_of_customers DESC, avg_supplier_acctbal DESC, avg_customer_acctbal DESC;
SELECT r.r_name AS region, n.n_name AS nation, COUNT(DISTINCT s.s_suppkey) AS num_suppliers, COUNT(DISTINCT c.c_custkey) AS num_customers, SUM(l.l_quantity) AS total_quantity, AVG(l.l_extendedprice) AS avg_price, SUM(l.l_extendedprice * (1 - l.l_discount)) AS revenue, AVG(l.l_discount) AS avg_discount FROM region r JOIN nation n ON r.r_regionkey = n.n_regionkey JOIN supplier s ON n.n_nationkey = s.s_nationkey JOIN partsupp ps ON s.s_suppkey = ps.ps_suppkey JOIN lineitem l ON ps.ps_partkey = l.l_partkey AND ps.ps_suppkey = l.l_suppkey JOIN orders o ON l.l_orderkey = o.o_orderkey JOIN customer c ON o.o_custkey = c.c_custkey AND n.n_nationkey = c.c_nationkey GROUP BY region, nation ORDER BY revenue DESC;
SELECT c.c_name, s.s_name, COUNT(DISTINCT o.o_orderkey) AS total_orders, SUM(o.o_totalprice) AS total_revenue, AVG(o.o_totalprice) AS average_order_value, MAX(c.c_acctbal) AS max_customer_acctbal, MIN(c.c_acctbal) AS min_customer_acctbal, AVG(c.c_acctbal) AS avg_customer_acctbal FROM customer c JOIN orders o ON c.c_custkey = o.o_custkey JOIN supplier s ON c.c_nationkey = s.s_nationkey WHERE c.c_acctbal > 5000 AND o.o_orderdate BETWEEN '2020-01-01' AND '2023-12-31' GROUP BY c.c_name, s.s_name ORDER BY total_revenue DESC, total_orders DESC, c.c_name, s.s_name;
SELECT r.r_name AS region, COUNT(DISTINCT s.s_suppkey) AS supplier_count, COUNT(DISTINCT c.c_custkey) AS customer_count, AVG(c.c_acctbal) AS avg_customer_account_balance, SUM(l.l_quantity) AS total_quantity_ordered, SUM(l.l_extendedprice * (1 - l_discount)) AS total_revenue, AVG(l.l_extendedprice * (1 - l_discount)) AS avg_order_value FROM region r JOIN supplier s ON r.r_regionkey = s.s_nationkey JOIN customer c ON r.r_regionkey = c.c_nationkey JOIN orders o ON c.c_custkey = o.o_custkey JOIN lineitem l ON o.o_orderkey = l.l_orderkey WHERE l.l_shipdate BETWEEN date '2021-01-01' AND date '2021-12-31' AND l.l_returnflag = 'F' GROUP BY r.r_name ORDER BY total_revenue DESC;
SELECT c.c_mktsegment, s.s_nationkey, p.p_brand, p.p_type, SUM(l.l_quantity) AS total_quantity, AVG(l.l_extendedprice) AS avg_price, SUM(l.l_extendedprice * (1 - l.l_discount)) AS revenue, COUNT(DISTINCT c.c_custkey) AS number_of_customers, COUNT(DISTINCT s.s_suppkey) AS number_of_suppliers FROM customer c JOIN lineitem l ON c.c_custkey = l.l_orderkey JOIN part p ON l.l_partkey = p.p_partkey JOIN supplier s ON l.l_suppkey = s.s_suppkey GROUP BY c.c_mktsegment, s.s_nationkey, p.p_brand, p.p_type ORDER BY revenue DESC LIMIT 10;
SELECT r_name AS region, c_mktsegment AS market_segment, SUM(o_totalprice) AS total_sales, AVG(c_acctbal) AS avg_customer_balance, COUNT(DISTINCT c_custkey) AS number_of_customers, COUNT(DISTINCT s_suppkey) AS number_of_suppliers, SUM(l_extendedprice * (1 - l_discount)) AS revenue_after_discount FROM customer JOIN orders ON c_custkey = o_custkey JOIN lineitem ON l_orderkey = o_orderkey JOIN supplier ON s_suppkey = l_suppkey JOIN region ON s_nationkey = r_regionkey GROUP BY region, market_segment ORDER BY total_sales DESC, avg_customer_balance DESC LIMIT 10;
SELECT n.n_name AS nation_name, AVG(c.c_acctbal) AS avg_customer_balance, COUNT(DISTINCT c.c_custkey) AS total_customers, COUNT(DISTINCT p.p_partkey) AS total_parts, SUM(p.p_retailprice) AS total_retail_price FROM nation AS n JOIN customer AS c ON n.n_nationkey = c.c_nationkey JOIN part AS p ON p.p_size IN (4, 24, 41) WHERE n.n_regionkey IN (1, 3, 4) AND c.c_phone LIKE '___-___-___-____' GROUP BY n.n_name ORDER BY avg_customer_balance DESC, total_customers DESC;
SELECT r.r_name AS region_name, COUNT(DISTINCT c.c_custkey) AS number_of_customers, SUM(o.o_totalprice) AS total_sales_volume, AVG(c.c_acctbal) AS average_customer_account_balance, COUNT(CASE WHEN o.o_orderpriority IN ('1-URGENT', '2-HIGH') THEN o.o_orderkey ELSE NULL END) AS high_priority_orders_count FROM region r JOIN customer c ON r.r_regionkey = c.c_nationkey JOIN orders o ON c.c_custkey = o.o_custkey GROUP BY r.r_name HAVING COUNT(o.o_orderkey) > (SELECT AVG(orders_count) FROM (SELECT COUNT(*) AS orders_count FROM orders GROUP BY o_custkey) subquery) ORDER BY total_sales_volume DESC;
SELECT c_nationkey AS nation_key, AVG(c_acctbal) AS avg_customer_acct_balance, AVG(s_acctbal) AS avg_supplier_acct_balance, SUM(l_extendedprice * (1 - l_discount)) AS total_revenue FROM customer JOIN supplier ON customer.c_nationkey = supplier.s_nationkey JOIN orders ON customer.c_custkey = orders.o_custkey JOIN lineitem ON orders.o_orderkey = lineitem.l_orderkey WHERE lineitem.l_shipdate BETWEEN '2023-01-01' AND '2023-12-31' AND lineitem.l_returnflag = 'F' GROUP BY c_nationkey ORDER BY total_revenue DESC;
SELECT r_name AS region, n_name AS nation, COUNT(DISTINCT s_suppkey) AS num_suppliers, COUNT(DISTINCT c_custkey) AS num_customers, SUM(l_extendedprice * (1 - l_discount)) AS revenue, AVG(l_quantity) AS average_quantity, SUM(l_quantity) AS total_quantity FROM region JOIN nation ON r_regionkey = n_regionkey JOIN supplier ON s_nationkey = n_nationkey JOIN customer ON c_nationkey = n_nationkey JOIN orders ON o_custkey = c_custkey JOIN lineitem ON l_orderkey = o_orderkey JOIN part ON p_partkey = l_partkey JOIN partsupp ON ps_partkey = p_partkey AND ps_suppkey = l_suppkey WHERE p_mfgr IN ('Manufacturer#5', 'Manufacturer#4', 'Manufacturer#2') AND l_shipdate BETWEEN '2022-01-01' AND '2022-12-31' GROUP BY region, nation ORDER BY revenue DESC;
SELECT r.r_name AS region_name, c.c_mktsegment AS market_segment, AVG(c.c_acctbal) AS avg_account_balance, COUNT(DISTINCT o.o_orderkey) AS total_orders, COUNT(l.l_orderkey) AS total_line_items, SUM(l.l_extendedprice) AS total_revenue FROM customer c JOIN nation n ON c.c_nationkey = n.n_nationkey JOIN region r ON n.n_regionkey = r.r_regionkey JOIN orders o ON c.c_custkey = o.o_custkey JOIN lineitem l ON o.o_orderkey = l.l_orderkey WHERE r.r_name IN ('ASIA', 'AMERICA', 'MIDDLE EAST', 'EUROPE') AND c.c_mktsegment IN ('FURNITURE', 'AUTOMOBILE') AND l.l_shipdate BETWEEN '1995-01-01' AND '1995-12-31' GROUP BY r.r_name, c.c_mktsegment ORDER BY region_name, market_segment;
SELECT s.s_suppkey AS supplier_key, s.s_name AS supplier_name, COUNT(DISTINCT o.o_orderkey) AS total_orders, AVG(l.l_discount) AS average_discount, SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_revenue FROM supplier s JOIN partsupp ps ON s.s_suppkey = ps.ps_suppkey JOIN lineitem l ON ps.ps_suppkey = l.l_suppkey AND ps.ps_partkey = l.l_partkey JOIN orders o ON l.l_orderkey = o.o_orderkey WHERE l.l_returnflag = 'N' AND l.l_shipinstruct = 'DELIVER IN PERSON' AND EXTRACT(YEAR FROM l.l_shipdate) = EXTRACT(YEAR FROM CURRENT_DATE) GROUP BY s.s_suppkey, s.s_name ORDER BY total_revenue DESC, supplier_name;
SELECT n.n_name AS nation, COUNT(*) AS number_of_suppliers, SUM(ps.ps_availqty) AS total_avail_qty, AVG(s.s_acctbal) AS avg_account_balance, SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_sales_volume FROM supplier s JOIN nation n ON s.s_nationkey = n.n_nationkey JOIN partsupp ps ON s.s_suppkey = ps.ps_suppkey JOIN lineitem l ON ps.ps_partkey = l.l_partkey AND ps.ps_suppkey = l.l_suppkey GROUP BY n.n_name ORDER BY total_sales_volume DESC;
SELECT r.r_name AS region, COUNT(DISTINCT s.s_suppkey) AS num_suppliers, COUNT(DISTINCT c.c_custkey) AS num_customers, SUM(l.l_quantity) AS total_quantity_ordered, AVG(l.l_extendedprice * (1 - l.l_discount)) AS avg_discounted_price, SUM(l.l_extendedprice * (1 - l.l_discount) * (1 + l.l_tax)) AS total_revenue FROM region r JOIN nation n ON r.r_regionkey = n.n_regionkey JOIN supplier s ON n.n_nationkey = s.s_nationkey JOIN partsupp ps ON s.s_suppkey = ps.ps_suppkey JOIN lineitem l ON ps.ps_partkey = l.l_partkey AND ps.ps_suppkey = l.l_suppkey JOIN orders o ON l.l_orderkey = o.o_orderkey JOIN customer c ON o.o_custkey = c.c_custkey AND c.c_nationkey = n.n_nationkey WHERE s.s_suppkey IN ('4385', '3875', '2686') AND c.c_nationkey IN ('3', '18', '0', '11', '21') AND o.o_orderstatus = 'F' GROUP BY r.r_name ORDER BY total_revenue DESC;
SELECT r_name AS region, n_name AS nation, COUNT(DISTINCT s_suppkey) AS number_of_suppliers, AVG(s_acctbal) AS average_account_balance, SUM(l_extendedprice * (1 - l_discount)) AS total_revenue, COUNT(DISTINCT o_orderkey) AS number_of_orders, AVG(o_totalprice) AS average_order_total FROM supplier JOIN nation ON s_nationkey = n_nationkey JOIN region ON n_regionkey = r_regionkey JOIN lineitem ON s_suppkey = l_suppkey JOIN orders ON l_orderkey = o_orderkey WHERE r_name = 'EUROPE' AND o_orderdate BETWEEN '1995-01-01' AND '1995-12-31' AND s_comment LIKE '%across%' AND o_orderstatus = 'O' GROUP BY region, nation ORDER BY total_revenue DESC, average_account_balance DESC;
SELECT r_name AS region, n_name AS nation, COUNT(DISTINCT c_custkey) AS customer_count, AVG(c_acctbal) AS avg_account_balance, SUM(p_retailprice * l_quantity) AS total_sales_value, SUM(CASE WHEN l_returnflag = 'F' THEN l_extendedprice * (1 - l_discount) ELSE 0 END) AS total_final_sales, COUNT(DISTINCT p_partkey) AS part_count FROM region JOIN nation ON n_regionkey = r_regionkey JOIN customer ON c_nationkey = n_nationkey JOIN lineitem ON l_orderkey = c_custkey JOIN part ON p_partkey = l_partkey JOIN partsupp ON ps_partkey = p_partkey AND ps_suppkey = l_suppkey WHERE r_regionkey IN ('0', '1', '2', '4') AND n_name IN ('FRANCE', 'EGYPT', 'CANADA', 'MOROCCO', 'IRAQ', 'BRAZIL') AND l_shipdate >= DATE '2023-01-01' AND l_shipdate < DATE '2023-04-01' GROUP BY r_name, n_name ORDER BY total_sales_value DESC, region, nation;
SELECT r.r_name AS region, COUNT(DISTINCT c.c_custkey) AS num_customers, AVG(c.c_acctbal) AS avg_balance, SUM(o.o_totalprice) AS total_sales, MAX(p.p_retailprice) AS max_part_retail_price, MIN(ps.ps_supplycost) AS min_supply_cost FROM region r JOIN customer c ON c.c_nationkey = r.r_regionkey JOIN orders o ON o.o_custkey = c.c_custkey JOIN partsupp ps ON ps.ps_suppkey = o.o_orderkey JOIN part p ON p.p_partkey = ps.ps_partkey WHERE o.o_orderstatus = 'O' AND p.p_mfgr = 'Manufacturer#4' AND o.o_orderdate BETWEEN '1994-01-01' AND '1994-12-31' GROUP BY r.r_name ORDER BY total_sales DESC;
SELECT c.c_mktsegment, o.o_orderpriority, COUNT(DISTINCT c.c_custkey) AS num_customers, COUNT(DISTINCT o.o_orderkey) AS num_orders, SUM(l.l_quantity) AS total_quantity, AVG(l.l_extendedprice) AS avg_price, SUM(l.l_extendedprice * (1 - l_discount)) AS total_discounted_price, SUM(l.l_extendedprice * (1 - l_discount) * (1 + l_tax)) AS total_charge, AVG(l.l_discount) AS avg_discount FROM customer c JOIN orders o ON c.c_custkey = o.o_custkey JOIN lineitem l ON o.o_orderkey = l.l_orderkey WHERE c.c_mktsegment = 'BUILDING' AND l.l_shipdate BETWEEN '1995-01-01' AND '1995-12-31' GROUP BY c.c_mktsegment, o.o_orderpriority ORDER BY total_discounted_price DESC;
SELECT r_name AS region, n_name AS nation, COUNT(DISTINCT s_suppkey) AS number_of_suppliers, COUNT(DISTINCT c_custkey) AS number_of_customers, SUM(l_extendedprice) AS total_sales, AVG(l_extendedprice * (1 - l_discount)) AS avg_discounted_sales, SUM(ps_supplycost * l_quantity) AS total_supply_cost, (SUM(l_extendedprice * (1 - l_discount)) - SUM(ps_supplycost * l_quantity)) AS total_profit FROM region JOIN nation ON region.r_regionkey = nation.n_regionkey JOIN supplier ON nation.n_nationkey = supplier.s_nationkey JOIN customer ON nation.n_nationkey = customer.c_nationkey JOIN orders ON customer.c_custkey = orders.o_custkey JOIN lineitem ON orders.o_orderkey = lineitem.l_orderkey JOIN partsupp ON lineitem.l_partkey = partsupp.ps_partkey AND lineitem.l_suppkey = partsupp.ps_suppkey WHERE customer.c_custkey IN (1899, 3404, 3033) AND customer.c_nationkey IN (11, 21, 23, 4, 10) GROUP BY region, nation ORDER BY total_profit DESC;
SELECT n.n_name AS nation_name, COUNT(DISTINCT s.s_suppkey) AS total_suppliers, COUNT(DISTINCT c.c_custkey) AS total_customers, SUM(o.o_totalprice) AS total_order_value, AVG(c.c_acctbal) AS average_customer_balance, AVG(s.s_acctbal) AS average_supplier_balance FROM nation n LEFT JOIN supplier s ON n.n_nationkey = s.s_nationkey LEFT JOIN customer c ON n.n_nationkey = c.c_nationkey LEFT JOIN orders o ON c.c_custkey = o.o_custkey WHERE n.n_name IN ('KENYA', 'INDONESIA') AND (s.s_address = 'oBAy6LNZ, wZ2' OR s.s_address = '67A5N8sEkn8' OR s.s_address = ',ZmLYOdRzBBkuNfYwJTfadc,') AND c.c_acctbal = 9847.15 AND (c.c_custkey = '744' OR c.c_custkey = '216') AND o.o_clerk = 'Clerk#000020800' GROUP BY n.n_name ORDER BY total_order_value DESC, average_customer_balance DESC;
SELECT n_regionkey, r_name AS region_name, COUNT(DISTINCT s_suppkey) AS num_suppliers, COUNT(DISTINCT c_custkey) AS num_customers, SUM(l_extendedprice * (1 - l_discount)) AS revenue, AVG(p_retailprice) AS avg_part_price, SUM(ps_availqty) AS total_avail_qty FROM region JOIN nation ON n_regionkey = r_regionkey JOIN supplier ON s_nationkey = n_nationkey JOIN customer ON c_nationkey = n_nationkey JOIN partsupp ON ps_suppkey = s_suppkey JOIN part ON p_partkey = ps_partkey JOIN lineitem ON l_partkey = p_partkey AND l_suppkey = s_suppkey JOIN orders ON o_orderkey = l_orderkey WHERE o_orderstatus = 'F' AND l_shipdate BETWEEN '1995-01-01' AND '1995-12-31' AND p_type IN ('SMALL BRUSHED STEEL', 'LARGE POLISHED COPPER') GROUP BY n_regionkey, region_name ORDER BY revenue DESC, avg_part_price ASC LIMIT 10;
SELECT r.r_name AS region, n.n_name AS nation, c.c_mktsegment AS market_segment, AVG(c.c_acctbal) AS avg_account_balance, SUM(l.l_extendedprice * (1 - l_discount)) AS revenue, COUNT(DISTINCT c.c_custkey) AS number_of_customers, COUNT(DISTINCT l.l_orderkey) AS number_of_orders FROM customer c JOIN nation n ON c.c_nationkey = n.n_nationkey JOIN region r ON n.n_regionkey = r.r_regionkey JOIN lineitem l ON c.c_custkey = l.l_suppkey JOIN part p ON l.l_partkey = p.p_partkey JOIN partsupp ps ON p.p_partkey = ps.ps_partkey AND l.l_suppkey = ps.ps_suppkey WHERE n.n_name IN ('MOZAMBIQUE', 'MOROCCO') AND c.c_comment LIKE '%mong the furiously bold instructions. unusual,%' OR c.c_comment LIKE '%rd the closely regular pinto beans use slyly%' AND c.c_custkey IN ('1407', '2065', '2111', '4161', '3983', '4672') AND l.l_discount = 0.02 AND ps.ps_availqty = 4901 AND ps.ps_comment LIKE '%furiously against the instructions. furiously fi%' OR ps.ps_comment LIKE '%cross the pinto beans wake fluffily between the c%' GROUP BY region, nation, market_segment ORDER BY revenue DESC, avg_account_balance DESC;
SELECT n.n_name AS nation, COUNT(DISTINCT s.s_suppkey) AS num_suppliers, COUNT(DISTINCT c.c_custkey) AS num_customers, SUM(o.o_totalprice) AS total_sales, AVG(l.l_quantity) AS avg_lineitem_quantity, SUM(l.l_extendedprice * (1 - l_discount)) AS total_revenue, COUNT(DISTINCT CASE WHEN l.l_returnflag = 'R' THEN l.l_orderkey ELSE NULL END) AS num_returned_orders FROM nation n JOIN supplier s ON n.n_nationkey = s.s_nationkey JOIN customer c ON n.n_nationkey = c.c_nationkey JOIN orders o ON c.c_custkey = o.o_custkey JOIN lineitem l ON o.o_orderkey = l.l_orderkey WHERE n.n_name IN ('INDIA', 'KENYA', 'ROMANIA', 'IRAQ', 'GERMANY') AND o.o_orderdate BETWEEN date '2022-01-01' AND date '2022-12-31' GROUP BY n.n_name ORDER BY total_revenue DESC;
SELECT n.n_name, COUNT(DISTINCT o.o_orderkey) AS total_orders, SUM(o.o_totalprice) AS total_revenue, AVG(ps.ps_supplycost) AS average_supply_cost, SUM(ps.ps_availqty) AS total_available_quantity FROM nation n JOIN orders o ON n.n_nationkey = o.o_custkey JOIN partsupp ps ON o.o_orderkey = ps.ps_partkey GROUP BY n.n_name ORDER BY total_revenue DESC, n.n_name;
SELECT n.n_name AS nation, COUNT(DISTINCT o.o_orderkey) AS num_of_orders, COUNT(DISTINCT l.l_orderkey) AS num_of_lineitems, SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_revenue, AVG(l.l_quantity) AS avg_quantity, AVG(l.l_extendedprice) AS avg_price, AVG(l.l_discount) AS avg_discount, MAX(l.l_extendedprice) AS max_price, MIN(l.l_extendedprice) AS min_price FROM nation n JOIN supplier s ON n.n_nationkey = s.s_nationkey JOIN customer c ON n.n_nationkey = c.c_nationkey JOIN orders o ON c.c_custkey = o.o_custkey JOIN lineitem l ON o.o_orderkey = l.l_orderkey WHERE n.n_name IN ('ETHIOPIA', 'ROMANIA') AND o.o_clerk IN ('Clerk#000008851', 'Clerk#000013378', 'Clerk#000001659', 'Clerk#000003983') GROUP BY n.n_name ORDER BY total_revenue DESC;
SELECT r_name AS region, n_name AS nation, COUNT(DISTINCT o_orderkey) AS total_orders, SUM(l_extendedprice) AS total_sales, AVG(l_extendedprice * (1 - l_discount)) AS avg_discounted_sales, SUM(l_quantity) AS total_quantity_sold, COUNT(l_orderkey) FILTER (WHERE l_returnflag = 'R') AS returned_orders FROM region JOIN nation ON n_regionkey = r_regionkey JOIN orders ON o_custkey = n_nationkey JOIN lineitem ON l_orderkey = o_orderkey WHERE o_orderstatus = 'F' AND l_shipdate BETWEEN date '1995-01-01' AND date '1995-12-31' GROUP BY r_name, n_name ORDER BY total_sales DESC;
SELECT n_name, r_name, p_type, AVG(l_extendedprice) AS avg_price, SUM(l_extendedprice * (1 - l_discount)) AS revenue, COUNT(DISTINCT s_suppkey) AS supplier_count, COUNT(DISTINCT o_orderkey) AS order_count, COUNT(*) AS lineitem_count FROM nation JOIN region ON n_regionkey = r_regionkey JOIN supplier ON s_nationkey = n_nationkey JOIN lineitem ON l_suppkey = s_suppkey JOIN orders ON o_orderkey = l_orderkey JOIN part ON p_partkey = l_partkey JOIN partsupp ON ps_suppkey = s_suppkey AND ps_partkey = p_partkey WHERE r_name IN ('EUROPE', 'AMERICA') AND l_receiptdate >= '1997-01-01' AND l_receiptdate < '1997-04-01' AND l_discount BETWEEN 0.05 AND 0.07 AND p_size IN (1, 5, 10, 15, 20, 25) AND o_orderdate BETWEEN '1996-01-01' AND '1996-12-31' GROUP BY n_name, r_name, p_type ORDER BY revenue DESC, avg_price DESC LIMIT 10;
SELECT r.r_name AS region_name, c.c_mktsegment AS market_segment, COUNT(DISTINCT o.o_orderkey) AS number_of_orders, SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_sales, AVG(l.l_extendedprice * (1 - l.l_discount)) AS average_sales_per_order FROM region r JOIN nation n ON r.r_regionkey = n.n_regionkey JOIN customer c ON n.n_nationkey = c.c_nationkey JOIN orders o ON c.c_custkey = o.o_custkey JOIN lineitem l ON o.o_orderkey = l.l_orderkey WHERE o.o_orderdate BETWEEN '1995-01-01' AND '1995-12-31' GROUP BY r.r_name, c.c_mktsegment ORDER BY total_sales DESC, region_name, market_segment;
SELECT r.r_name AS region_name, s.s_name AS supplier_name, COUNT(li.l_linenumber) AS total_line_items, SUM(li.l_extendedprice * (1 - li.l_discount)) AS total_revenue, AVG(li.l_discount) AS avg_discount FROM lineitem li JOIN supplier s ON li.l_suppkey = s.s_suppkey JOIN nation n ON s.s_nationkey = n.n_nationkey JOIN region r ON n.n_regionkey = r.r_regionkey WHERE li.l_shipdate BETWEEN '1997-01-06' AND '1997-01-31' GROUP BY r.r_name, s.s_name ORDER BY total_revenue DESC;
SELECT n.n_name AS nation, EXTRACT(YEAR FROM o.o_orderdate) AS order_year, COUNT(DISTINCT o.o_orderkey) AS total_orders, SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_sales, AVG(s.s_acctbal) AS avg_supplier_balance, SUM(ps.ps_availqty) AS total_available_quantity FROM nation n INNER JOIN supplier s ON n.n_nationkey = s.s_nationkey INNER JOIN partsupp ps ON s.s_suppkey = ps.ps_suppkey INNER JOIN lineitem l ON ps.ps_suppkey = l.l_suppkey AND ps.ps_partkey = l.l_partkey INNER JOIN orders o ON l.l_orderkey = o.o_orderkey WHERE n.n_nationkey IN (12, 9, 11, 15) AND l.l_suppkey IN (128236, 197502, 170405, 85908) GROUP BY nation, order_year ORDER BY nation, order_year DESC;
SELECT r.r_name AS region_name, c.c_mktsegment AS market_segment, COUNT(DISTINCT c.c_custkey) AS number_of_customers, SUM(o.o_totalprice) AS total_sales_amount, AVG(o.o_totalprice) AS average_transaction_value FROM region r JOIN nation n ON r.r_regionkey = n.n_regionkey JOIN customer c ON n.n_nationkey = c.c_nationkey JOIN orders o ON c.c_custkey = o.o_custkey GROUP BY r.r_name, c.c_mktsegment ORDER BY total_sales_amount DESC, r.r_name, c.c_mktsegment;
SELECT r.r_name AS region, n.n_name AS nation, COUNT(DISTINCT s.s_suppkey) AS total_suppliers, COUNT(DISTINCT c.c_custkey) AS total_customers, SUM(p.p_retailprice * ps.ps_availqty) AS total_inventory_value, AVG(l.l_extendedprice * (1 - l.l_discount)) AS avg_order_value FROM region r JOIN nation n ON r.r_regionkey = n.n_regionkey JOIN supplier s ON n.n_nationkey = s.s_nationkey JOIN customer c ON n.n_nationkey = c.c_nationkey JOIN partsupp ps ON s.s_suppkey = ps.ps_suppkey JOIN part p ON ps.ps_partkey = p.p_partkey JOIN lineitem l ON p.p_partkey = l.l_partkey AND s.s_suppkey = l.l_suppkey JOIN orders o ON l.l_orderkey = o.o_orderkey AND o.o_custkey = c.c_custkey GROUP BY r.r_name, n.n_name ORDER BY total_inventory_value DESC, avg_order_value DESC LIMIT 10;
SELECT c.c_nationkey, s.s_nationkey, COUNT(DISTINCT o.o_orderkey) AS total_orders, SUM(l.l_quantity) AS total_quantity, AVG(l.l_extendedprice) AS avg_extended_price, SUM(l.l_extendedprice * (1 - l_discount)) AS revenue_after_discount FROM customer c JOIN orders o ON c.c_custkey = o.o_custkey JOIN lineitem l ON o.o_orderkey = l.l_orderkey JOIN supplier s ON l.l_suppkey = s.s_suppkey WHERE c.c_nationkey IN (12, 24, 4) AND s.s_nationkey IN (14, 4, 19, 18, 7) AND o.o_shippriority = 0 GROUP BY c.c_nationkey, s.s_nationkey ORDER BY total_orders DESC, revenue_after_discount DESC;
SELECT r.r_name AS region, COUNT(DISTINCT s.s_suppkey) AS number_of_suppliers, AVG(s.s_acctbal) AS average_account_balance, SUM(l.l_quantity) AS total_quantity_ordered, AVG(l.l_extendedprice * (1 - l.l_discount)) AS average_order_value, COUNT(DISTINCT o.o_orderkey) AS number_of_orders, MAX(o.o_totalprice) AS max_order_price FROM region r JOIN supplier s ON s.s_nationkey = r.r_regionkey JOIN lineitem l ON l.l_suppkey = s.s_suppkey JOIN orders o ON o.o_orderkey = l.l_orderkey WHERE l.l_shipdate BETWEEN '1995-01-01' AND '1995-12-31' AND l.l_returnflag = 'N' GROUP BY r.r_name ORDER BY average_order_value DESC;
SELECT c.c_mktsegment, COUNT(DISTINCT c.c_custkey) AS num_customers, SUM(o.o_totalprice) AS total_sales, AVG(l.l_quantity) AS avg_quantity_sold, AVG(l.l_extendedprice * (1 - l.l_discount)) AS avg_discounted_price, COUNT(DISTINCT p.p_partkey) AS num_parts_sold FROM customer c JOIN orders o ON c.c_custkey = o.o_custkey JOIN lineitem l ON o.o_orderkey = l.l_orderkey JOIN part p ON l.l_partkey = p.p_partkey WHERE c.c_mktsegment = 'MACHINERY' AND o.o_orderdate <= '1996-09-04' AND l.l_shipdate > '1996-09-04' GROUP BY c.c_mktsegment ORDER BY total_sales DESC;
SELECT n.n_name AS nation_name, c.c_mktsegment AS market_segment, SUM(l.l_extendedprice) AS total_sales, AVG(l.l_extendedprice) AS average_sale, COUNT(DISTINCT o.o_orderkey) AS total_orders, AVG(l.l_discount) AS average_discount FROM customer c JOIN orders o ON c.c_custkey = o.o_custkey JOIN lineitem l ON o.o_orderkey = l.l_orderkey JOIN part p ON l.l_partkey = p.p_partkey JOIN supplier s ON l.l_suppkey = s.s_suppkey JOIN nation n ON s.s_nationkey = n.n_nationkey WHERE p.p_mfgr = 'Manufacturer#1' GROUP BY n.n_name, c.c_mktsegment ORDER BY total_sales DESC;
SELECT n.n_name AS nation_name, c.c_mktsegment AS market_segment, COUNT(o.o_orderkey) AS total_orders, SUM(o.o_totalprice) AS total_spent, AVG(o.o_totalprice) AS average_order_value FROM customer c JOIN orders o ON c.c_custkey = o.o_custkey JOIN nation n ON c.c_nationkey = n.n_nationkey WHERE o.o_orderdate >= '2020-01-01' AND o.o_orderdate <= '2020-12-31' GROUP BY nation_name, market_segment ORDER BY total_spent DESC, nation_name, market_segment;
SELECT n.n_name AS nation, COUNT(DISTINCT s.s_suppkey) AS number_of_suppliers, COUNT(DISTINCT c.c_custkey) AS number_of_customers, COUNT(DISTINCT o.o_orderkey) AS number_of_orders, SUM(l.l_extendedprice * (1 - l_discount)) AS total_revenue, AVG(l.l_quantity) AS average_quantity, AVG(l.l_extendedprice) AS average_price, AVG(l.l_discount) AS average_discount FROM nation n JOIN supplier s ON s.s_nationkey = n.n_nationkey JOIN partsupp ps ON ps.ps_suppkey = s.s_suppkey JOIN lineitem l ON l.l_suppkey = s.s_suppkey AND l.l_partkey = ps.ps_partkey JOIN orders o ON o.o_orderkey = l.l_orderkey JOIN customer c ON c.c_custkey = o.o_custkey AND c.c_nationkey = n.n_nationkey GROUP BY n.n_name ORDER BY total_revenue DESC, average_price DESC;
SELECT r.r_name AS region, c.c_mktsegment AS market_segment, COUNT(DISTINCT c.c_custkey) AS number_of_customers, SUM(ps.ps_availqty) AS total_available_quantity, AVG(p.p_retailprice) AS average_retail_price, SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_revenue, AVG(l.l_quantity) AS average_quantity_ordered, COUNT(DISTINCT l.l_orderkey) AS number_of_orders FROM region r JOIN customer c ON r.r_regionkey = c.c_nationkey JOIN partsupp ps ON c.c_custkey = ps.ps_suppkey JOIN part p ON ps.ps_partkey = p.p_partkey JOIN lineitem l ON p.p_partkey = l.l_partkey AND ps.ps_suppkey = l.l_suppkey WHERE r.r_regionkey IN (1, 2, 3) AND l.l_shipdate BETWEEN date '1995-01-01' AND date '1995-12-31' AND l.l_linestatus = 'O' AND p.p_container IN ('JUMBO DRUM', 'SM BAG', 'MED PKG') GROUP BY r.r_name, c.c_mktsegment ORDER BY total_revenue DESC, region, market_segment;
SELECT n.n_name AS nation, r.r_name AS region, COUNT(DISTINCT o.o_orderkey) AS number_of_orders, SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_revenue, AVG(o.o_totalprice) AS average_order_value FROM customer c JOIN orders o ON c.c_custkey = o.o_custkey JOIN lineitem l ON o.o_orderkey = l.l_orderkey JOIN nation n ON c.c_nationkey = n.n_nationkey JOIN region r ON n.n_regionkey = r.r_regionkey WHERE l.l_shipdate BETWEEN '1996-01-01' AND '1997-01-01' GROUP BY n.n_name, r.r_name ORDER BY total_revenue DESC;
SELECT r.r_name AS region_name, n.n_name AS nation_name, p.p_type AS part_type, COUNT(o.o_orderkey) AS total_orders, SUM(l.l_quantity) AS total_quantity, AVG(l.l_extendedprice) AS average_price, SUM(l.l_extendedprice * (1 - l_discount)) AS total_discounted_price, MAX(o.o_totalprice) AS max_order_totalprice FROM region r JOIN nation n ON r.r_regionkey = n.n_regionkey JOIN orders o ON o.o_orderdate >= DATE '2020-01-01' AND o.o_orderdate <= DATE '2020-12-31' JOIN lineitem l ON o.o_orderkey = l.l_orderkey JOIN part p ON l.l_partkey = p.p_partkey WHERE p.p_container IN ('SM BOX', 'WRAP CASE', 'WRAP BAG') AND l.l_shipmode IN ('AIR', 'RAIL', 'TRUCK') AND o.o_shippriority = 0 AND r.r_comment LIKE '%final%' GROUP BY region_name, nation_name, part_type ORDER BY total_orders DESC, total_quantity DESC, average_price DESC LIMIT 10;
SELECT r_name AS region, n_name AS nation, COUNT(DISTINCT c_custkey) AS num_customers, COUNT(DISTINCT o_orderkey) AS num_orders, AVG(c_acctbal) AS avg_customer_balance, SUM(l_extendedprice * (1 - l_discount)) AS revenue, AVG(l_quantity) AS avg_lineitem_quantity FROM region JOIN nation ON n_regionkey = r_regionkey JOIN customer ON c_nationkey = n_nationkey LEFT JOIN orders ON o_custkey = c_custkey LEFT JOIN lineitem ON l_orderkey = o_orderkey WHERE o_orderdate BETWEEN '1993-01-01' AND '1994-01-01' GROUP BY r_name, n_name ORDER BY revenue DESC;
SELECT r.r_name AS region_name, n.n_name AS nation_name, COUNT(DISTINCT c.c_custkey) AS num_customers, SUM(o.o_totalprice) AS total_sales, AVG(c.c_acctbal) AS avg_customer_balance, (SELECT AVG(p.p_retailprice) FROM part p INNER JOIN partsupp ps ON p.p_partkey = ps.ps_partkey WHERE p.p_type LIKE '%BRASS') AS avg_part_price, COUNT(DISTINCT o.o_orderkey) AS num_orders FROM region r JOIN nation n ON r.r_regionkey = n.n_regionkey JOIN customer c ON n.n_nationkey = c.c_nationkey JOIN orders o ON c.c_custkey = o.o_custkey WHERE o.o_orderdate BETWEEN '1995-01-01' AND '1995-12-31' AND c.c_address IN ( 'jxPFbepi6qNtr8Eg3C vB5bauDWGA0AYTO', 'D1ZFwn0v6drnpT2wBmd12yoFZ XggzLck', 'g4sY4Dculyxv4IPXWKRC2o BqwDxq6nQgRv4' ) GROUP BY region_name, nation_name ORDER BY total_sales DESC, avg_customer_balance DESC;
SELECT r.r_name AS region_name, COUNT(DISTINCT s.s_suppkey) AS supplier_count, COUNT(DISTINCT c.c_custkey) AS customer_count, SUM(l.l_extendedprice) AS total_sales, AVG(l.l_discount) AS average_discount, SUM(ps.ps_supplycost * l.l_quantity) AS total_supply_cost, COUNT(DISTINCT o.o_orderkey) AS order_count FROM region r JOIN supplier s ON s.s_nationkey = r.r_regionkey JOIN partsupp ps ON ps.ps_suppkey = s.s_suppkey JOIN lineitem l ON l.l_suppkey = ps.ps_suppkey AND l.l_partkey = ps.ps_partkey JOIN orders o ON o.o_orderkey = l.l_orderkey JOIN customer c ON c.c_custkey = o.o_custkey AND c.c_nationkey = r.r_regionkey GROUP BY r.r_name ORDER BY total_sales DESC LIMIT 1;
SELECT n.n_name AS nation, c.c_mktsegment AS market_segment, COUNT(DISTINCT o_orderkey) AS number_of_orders, SUM(l_extendedprice * (1 - l_discount)) AS revenue, AVG(l_quantity) AS average_quantity, AVG(l_extendedprice) AS average_extended_price, AVG(c_acctbal) AS average_customer_balance FROM nation n JOIN customer c ON n.n_nationkey = c.c_nationkey JOIN orders o ON c.c_custkey = o.o_custkey JOIN lineitem l ON o.o_orderkey = l.l_orderkey WHERE n.n_nationkey IN ('17', '8', '21', '11', '6', '13') AND c.c_mktsegment IN ('HOUSEHOLD', 'AUTOMOBILE', 'BUILDING', 'MACHINERY', 'FURNITURE') AND l.l_linestatus IN ('F', 'O') AND l.l_suppkey IN ('148364', '220519', '56916', '189463', '213150') AND o.o_clerk IN ('Clerk#000021639', 'Clerk#000023701') AND c.c_comment LIKE 'onic pearls are quickly. silent, ironic t%' GROUP BY nation, market_segment ORDER BY revenue DESC, average_customer_balance DESC;
SELECT n.n_name, AVG(s.s_acctbal) AS average_account_balance, SUM(p.p_retailprice) AS total_retail_price, COUNT(DISTINCT s.s_suppkey) AS number_of_suppliers, COUNT(DISTINCT p.p_partkey) AS number_of_parts FROM nation n JOIN supplier s ON n.n_nationkey = s.s_nationkey JOIN part p ON s.s_suppkey IN (346, 182, 2368, 4951, 2290) WHERE p.p_name IN ( 'medium snow light chiffon black', 'maroon metallic honeydew frosted ivory', 'powder seashell almond blanched chiffon', 'plum metallic cyan chiffon linen', 'antique pale magenta chartreuse peach' ) GROUP BY n.n_name ORDER BY average_account_balance DESC, total_retail_price DESC;
SELECT r.r_name AS region_name, COUNT(DISTINCT c.c_custkey) AS number_of_customers, SUM(ps.ps_availqty) AS total_available_quantity, AVG(ps.ps_supplycost) AS average_supply_cost, SUM(l.l_extendedprice * (1 - l_discount)) AS total_revenue, AVG(l.l_quantity) AS average_quantity_sold, COUNT(DISTINCT l.l_orderkey) AS number_of_orders FROM region r JOIN customer c ON c.c_nationkey = r.r_regionkey JOIN lineitem l ON c.c_custkey = l.l_suppkey JOIN partsupp ps ON l.l_partkey = ps.ps_partkey AND l.l_suppkey = ps.ps_suppkey WHERE c.c_acctbal > 0 AND l.l_shipdate BETWEEN '1995-01-01' AND '1995-12-31' AND c.c_mktsegment = 'AUTOMOBILE' GROUP BY r.r_name ORDER BY total_revenue DESC;
SELECT r_name AS region, AVG(s_acctbal) AS average_supplier_account_balance, COUNT(DISTINCT s_suppkey) AS number_of_suppliers, COUNT(DISTINCT p_partkey) AS number_of_parts, SUM(l_extendedprice) AS total_sales, SUM(l_extendedprice * (1 - l_discount)) AS total_sales_after_discount, SUM(l_quantity) AS total_quantity_sold FROM region JOIN supplier ON r_regionkey = s_nationkey JOIN part ON p_partkey IN (SELECT l_partkey FROM lineitem) JOIN lineitem ON l_suppkey = s_suppkey AND l_partkey = p_partkey WHERE r_comment LIKE '%final%' OR p_type LIKE '%BRASS' GROUP BY r_name ORDER BY total_sales_after_discount DESC;
SELECT n.n_regionkey, COUNT(DISTINCT s.s_suppkey) AS num_suppliers, AVG(s.s_acctbal) AS average_acctbal, COUNT(DISTINCT p.p_partkey) AS num_parts, SUM(ps.ps_availqty) AS total_avail_qty, AVG(ps.ps_supplycost) AS average_supply_cost, SUM(o.o_totalprice) AS total_order_price, COUNT(DISTINCT o.o_orderkey) AS num_orders FROM nation n JOIN supplier s ON n.n_nationkey = s.s_nationkey JOIN partsupp ps ON s.s_suppkey = ps.ps_suppkey JOIN part p ON ps.ps_partkey = p.p_partkey LEFT JOIN orders o ON s.s_nationkey = o.o_custkey WHERE s.s_nationkey IN (20, 10, 23, 22, 0, 11) GROUP BY n.n_regionkey ORDER BY n.n_regionkey;
SELECT c.c_name, c.c_mktsegment, AVG(c.c_acctbal) AS avg_customer_balance, COUNT(DISTINCT p.p_partkey) AS part_count, SUM(ps.ps_availqty) AS total_available_quantity, AVG(ps.ps_supplycost) AS avg_supply_cost FROM customer c JOIN partsupp ps ON c.c_custkey = ps.ps_suppkey JOIN part p ON ps.ps_partkey = p.p_partkey WHERE c.c_name IN ('Customer#000027901', 'Customer#000024104') GROUP BY c.c_name, c.c_mktsegment ORDER BY avg_customer_balance DESC, total_available_quantity DESC;
SELECT r.r_name AS region, COUNT(DISTINCT c.c_custkey) AS total_customers, AVG(c.c_acctbal) AS avg_account_balance, SUM(l.l_quantity) AS total_quantity_ordered, SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_sales, AVG(l.l_extendedprice * (1 - l.l_discount)) AS avg_sales_price FROM customer c JOIN lineitem l ON c.c_custkey = l.l_suppkey JOIN part p ON l.l_partkey = p.p_partkey JOIN region r ON c.c_nationkey = r.r_regionkey WHERE l.l_shipdate BETWEEN '1995-01-01' AND '1996-12-31' AND l.l_returnflag = 'N' AND p.p_size BETWEEN 1 AND 5 GROUP BY r.r_name ORDER BY total_sales DESC;
SELECT n.n_name AS nation_name, n.n_regionkey AS region_key, EXTRACT(YEAR FROM o.o_orderdate) AS order_year, COUNT(DISTINCT o.o_orderkey) AS total_orders, SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_revenue, AVG(l.l_quantity) AS average_quantity, SUM(CASE WHEN p.p_type LIKE 'PROMO%' THEN 1 ELSE 0 END) AS promo_parts_count FROM nation n JOIN customer c ON n.n_nationkey = c.c_nationkey JOIN orders o ON c.c_custkey = o.o_custkey JOIN lineitem l ON o.o_orderkey = l.l_orderkey JOIN part p ON l.l_partkey = p.p_partkey WHERE n.n_name IN ('UNITED STATES', 'ETHIOPIA', 'KENYA', 'IRAN') AND o.o_orderdate >= '1993-01-01' AND o.o_orderdate < '1998-01-01' AND l.l_linestatus IN ('F', 'O') AND l.l_tax = 0.03 AND p.p_container IN ('LG DRUM', 'SM JAR') GROUP BY nation_name, region_key, order_year ORDER BY total_revenue DESC, total_orders DESC, nation_name, order_year LIMIT 100;
SELECT r.r_name AS region_name, n.n_name AS nation_name, COUNT(s.s_suppkey) AS number_of_suppliers, AVG(s.s_acctbal) AS average_account_balance, SUM(l.l_quantity) AS total_quantity_ordered, SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_revenue, AVG(l.l_discount) AS average_discount FROM supplier s JOIN nation n ON s.s_nationkey = n.n_nationkey JOIN region r ON n.n_regionkey = r.r_regionkey JOIN lineitem l ON s.s_suppkey = l.l_suppkey GROUP BY r.r_name, n.n_name ORDER BY total_revenue DESC;
SELECT r.r_name AS region_name, SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_revenue, AVG(s.s_acctbal) AS avg_supplier_acctbal, COUNT(DISTINCT ps.ps_partkey) AS total_parts_supplied FROM region r JOIN nation n ON r.r_regionkey = n.n_regionkey JOIN supplier s ON n.n_nationkey = s.s_nationkey JOIN partsupp ps ON s.s_suppkey = ps.ps_suppkey JOIN lineitem l ON ps.ps_partkey = l.l_partkey AND ps.ps_suppkey = l.l_suppkey JOIN orders o ON l.l_orderkey = o.o_orderkey WHERE l.l_shipdate BETWEEN date '1995-01-01' AND date '1995-12-31' GROUP BY r.r_name ORDER BY total_revenue DESC;
SELECT r.r_name AS region_name, COUNT(DISTINCT n.n_nationkey) AS number_of_nations, SUM(ps.ps_availqty) AS total_parts_available, AVG(ps.ps_supplycost) AS average_supply_cost, SUM(o.o_totalprice) AS total_order_value, AVG(p.p_retailprice) AS average_part_retail_price FROM region r JOIN nation n ON r.r_regionkey = n.n_regionkey JOIN partsupp ps ON ps.ps_suppkey = n.n_nationkey JOIN part p ON ps.ps_partkey = p.p_partkey JOIN orders o ON n.n_nationkey = o.o_custkey WHERE r.r_regionkey IN (1, 4, 0, 2, 3) AND o.o_orderstatus = 'F' GROUP BY r.r_name ORDER BY total_order_value DESC, number_of_nations;
SELECT r.r_name AS region_name, n.n_name AS nation_name, COUNT(DISTINCT l.l_orderkey) AS total_orders, SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_revenue, AVG(ps.ps_supplycost) AS average_supply_cost, SUM(l.l_quantity) AS total_quantity FROM region r JOIN nation n ON r.r_regionkey = n.n_regionkey JOIN partsupp ps ON n.n_nationkey = ps.ps_suppkey JOIN lineitem l ON ps.ps_partkey = l.l_partkey AND ps.ps_suppkey = l.l_suppkey WHERE r.r_regionkey IN (0, 1, 3, 4) AND l.l_shipdate BETWEEN date '2023-01-01' AND date '2023-12-31' AND l.l_discount BETWEEN 0.05 AND 0.07 AND l.l_returnflag = 'N' GROUP BY r.r_name, n.n_name ORDER BY total_revenue DESC, average_supply_cost ASC;
SELECT n.n_name AS nation_name, c.c_mktsegment AS customer_market_segment, COUNT(DISTINCT c.c_custkey) AS number_of_customers, AVG(c.c_acctbal) AS average_customer_account_balance, SUM(ps.ps_availqty) AS total_available_parts, AVG(ps.ps_supplycost) AS average_supply_cost FROM customer c JOIN nation n ON c.c_nationkey = n.n_nationkey JOIN supplier s ON s.s_nationkey = n.n_nationkey JOIN partsupp ps ON ps.ps_suppkey = s.s_suppkey WHERE n.n_nationkey IN (13, 23) AND c.c_comment LIKE '%special pinto beans%' AND s.s_name IN ('Supplier#000021082', 'Supplier#000018658', 'Supplier#000020174') GROUP BY n.n_name, c.c_mktsegment ORDER BY average_customer_account_balance DESC;
SELECT r.r_name AS region_name, COUNT(DISTINCT c.c_custkey) AS total_customers, COUNT(DISTINCT o.o_orderkey) AS total_orders, SUM(o.o_totalprice) AS total_order_value, AVG(c.c_acctbal) AS average_customer_acctbal, COUNT(DISTINCT c.c_mktsegment) AS market_segment_count FROM region r JOIN nation n ON r.r_regionkey = n.n_regionkey JOIN customer c ON n.n_nationkey = c.c_nationkey JOIN orders o ON c.c_custkey = o.o_custkey WHERE o.o_orderstatus = 'P' AND o.o_comment NOT LIKE '%special%requests%' GROUP BY r.r_name ORDER BY total_order_value DESC, average_customer_acctbal DESC;
SELECT r_name AS region, COUNT(DISTINCT o_orderkey) AS total_orders, COUNT(DISTINCT l_linenumber) AS total_line_items, SUM(l_extendedprice * (1 - l_discount)) AS total_revenue, AVG(l_quantity) AS average_quantity, SUM(ps_availqty) AS total_available_quantity FROM region JOIN supplier ON s_nationkey = region.r_regionkey JOIN customer ON c_nationkey = region.r_regionkey JOIN orders ON o_custkey = c_custkey JOIN lineitem ON l_orderkey = o_orderkey AND s_suppkey = l_suppkey JOIN partsupp ON ps_suppkey = l_suppkey AND ps_partkey = l_partkey JOIN part ON p_partkey = l_partkey WHERE o_orderdate BETWEEN date '1995-01-01' AND date '1995-12-31' AND l_shipmode IN ('RAIL', 'SHIP') AND p_type IN ('MEDIUM BURNISHED NICKEL', 'ECONOMY POLISHED TIN') GROUP BY region ORDER BY total_revenue DESC LIMIT 5;
SELECT r.r_name AS region_name, p.p_brand AS part_brand, AVG(ps.ps_supplycost) AS avg_supply_cost, SUM(ps.ps_availqty) AS total_available_quantity FROM region r JOIN partsupp ps ON true JOIN part p ON ps.ps_partkey = p.p_partkey JOIN lineitem li ON li.l_partkey = p.p_partkey AND li.l_suppkey = ps.ps_suppkey WHERE p.p_size IN (24, 18) AND ps.ps_supplycost < 300 AND ps.ps_comment NOT LIKE '%Customer%Complaints%' AND r.r_name IN ('AMERICA', 'EUROPE') AND li.l_shipdate BETWEEN '1996-01-01' AND '1996-12-31' GROUP BY r.r_name, p.p_brand ORDER BY avg_supply_cost DESC, total_available_quantity DESC;
SELECT r_name AS region_name, n_name AS nation_name, COUNT(DISTINCT c_custkey) AS number_of_customers, SUM(c_acctbal) AS total_balance, AVG(c_acctbal) AS avg_balance, COUNT(DISTINCT o_orderkey) AS number_of_orders, SUM(l_extendedprice) AS total_sales, SUM(l_extendedprice * (1 - l_discount)) AS total_sales_after_discount, AVG(l_quantity) AS avg_quantity_sold FROM region JOIN nation ON r_regionkey = n_regionkey JOIN customer ON n_nationkey = c_nationkey JOIN orders ON c_custkey = o_custkey JOIN lineitem ON o_orderkey = l_orderkey WHERE o_orderdate BETWEEN '1995-01-01' AND '1995-12-31' AND l_returnflag = 'N' GROUP BY region_name, nation_name ORDER BY total_sales_after_discount DESC, avg_quantity_sold;
SELECT n.n_name, AVG(c.c_acctbal) AS avg_customer_acctbal, AVG(s.s_acctbal) AS avg_supplier_acctbal, c.c_mktsegment, COUNT(o.o_orderkey) AS total_orders, AVG(o.o_totalprice) AS avg_order_value FROM nation n LEFT JOIN customer c ON n.n_nationkey = c.c_nationkey LEFT JOIN supplier s ON n.n_nationkey = s.s_nationkey LEFT JOIN orders o ON c.c_custkey = o.o_custkey WHERE n.n_name = 'JAPAN' AND o.o_orderstatus = 'F' GROUP BY n.n_name, c.c_mktsegment ORDER BY avg_customer_acctbal DESC, avg_supplier_acctbal DESC, total_orders DESC, avg_order_value DESC;
SELECT c.c_custkey, c.c_name, SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_revenue, AVG(l.l_quantity) AS average_quantity, COUNT(*) AS total_orders, p.p_brand, p.p_type FROM customer c JOIN lineitem l ON c.c_custkey = l.l_suppkey JOIN part p ON l.l_partkey = p.p_partkey WHERE c.c_mktsegment = 'AUTOMOBILE' AND l.l_returnflag = 'N' AND l.l_shipmode IN ('AIR', 'RAIL') AND l.l_shipdate BETWEEN '2023-01-01' AND '2023-12-31' GROUP BY c.c_custkey, c.c_name, p.p_brand, p.p_type ORDER BY total_revenue DESC, average_quantity DESC LIMIT 10;
SELECT r_name AS region, n_name AS nation, c_mktsegment AS market_segment, COUNT(DISTINCT o_orderkey) AS total_orders, SUM(l_extendedprice * (1 - l_discount)) AS revenue, AVG(c_acctbal) AS average_account_balance, COUNT(DISTINCT c_custkey) AS number_of_customers FROM region JOIN nation ON r_regionkey = n_regionkey JOIN customer ON n_nationkey = c_nationkey JOIN orders ON c_custkey = o_custkey JOIN lineitem ON o_orderkey = l_orderkey WHERE n_name IN ('VIETNAM', 'CANADA', 'EGYPT', 'INDONESIA') AND o_orderdate BETWEEN '1995-01-01' AND '1995-12-31' AND l_shipdate > o_orderdate GROUP BY r_name, n_name, c_mktsegment ORDER BY revenue DESC, region, nation, market_segment;
SELECT r.r_name AS region, n.n_name AS nation, c.c_mktsegment AS market_segment, COUNT(*) AS customer_count, AVG(c.c_acctbal) AS avg_account_balance, SUM(c.c_acctbal) AS total_account_balance FROM customer c JOIN nation n ON c.c_nationkey = n.n_nationkey JOIN region r ON n.n_regionkey = r.r_regionkey GROUP BY r.r_name, n.n_name, c.c_mktsegment ORDER BY r.r_name, n.n_name, c.c_mktsegment;
SELECT r_name AS region, c_mktsegment AS market_segment, AVG(c_acctbal) AS avg_customer_acct_balance, SUM(l_extendedprice * (1 - l_discount)) AS total_sales_revenue FROM region JOIN nation ON region.r_regionkey = nation.n_regionkey JOIN customer ON nation.n_nationkey = customer.c_nationkey JOIN orders ON customer.c_custkey = orders.o_custkey JOIN lineitem ON orders.o_orderkey = lineitem.l_orderkey WHERE orders.o_orderdate >= date '1995-10-01' AND orders.o_orderdate <= date '1995-12-31' GROUP BY region, market_segment ORDER BY region, total_sales_revenue DESC;
SELECT r.r_name AS region, p.p_brand AS brand, p.p_type AS type, COUNT(DISTINCT l.l_orderkey) AS total_orders, SUM(l.l_quantity) AS total_quantity, AVG(l.l_extendedprice) AS avg_price, SUM(l.l_extendedprice * (1 - l_discount)) AS discounted_total_price, SUM(CASE WHEN l.l_returnflag = 'R' THEN l.l_quantity ELSE 0 END) AS returned_quantity, AVG(l.l_discount) AS avg_discount FROM region r JOIN lineitem l ON r.r_regionkey = l.l_suppkey JOIN part p ON l.l_partkey = p.p_partkey WHERE p.p_mfgr IN ('Manufacturer#1', 'Manufacturer#4') AND p.p_brand IN ('Brand#25', 'Brand#34', 'Brand#43', 'Brand#13') AND l.l_shipmode IN ('AIR', 'RAIL', 'FOB') AND l.l_shipdate BETWEEN '1997-01-01' AND '1997-12-31' GROUP BY region, brand, type ORDER BY total_orders DESC, total_quantity DESC, avg_price;
SELECT r_name AS region, n_name AS nation, COUNT(DISTINCT s_suppkey) AS total_suppliers, COUNT(DISTINCT c_custkey) AS total_customers, SUM(l_extendedprice * (1 - l_discount)) AS total_revenue, AVG(l_quantity) AS avg_quantity, COUNT(DISTINCT o_orderkey) AS total_orders FROM region JOIN nation ON r_regionkey = n_regionkey JOIN supplier ON s_nationkey = n_nationkey JOIN customer ON c_nationkey = n_nationkey JOIN orders ON o_custkey = c_custkey JOIN lineitem ON l_orderkey = o_orderkey AND l_suppkey = s_suppkey GROUP BY region, nation ORDER BY total_revenue DESC LIMIT 1;
SELECT n.n_regionkey, count(distinct s.s_suppkey) AS number_of_suppliers, count(distinct c.c_custkey) AS number_of_customers, sum(s.s_acctbal) AS total_supplier_balance, avg(s.s_acctbal) AS avg_supplier_balance, sum(c.c_acctbal) AS total_customer_balance, avg(c.c_acctbal) AS avg_customer_balance FROM nation n JOIN supplier s ON n.n_nationkey = s.s_nationkey JOIN customer c ON n.n_nationkey = c.c_nationkey WHERE n.n_regionkey IN (1, 4, 0, 2, 3) AND (n.n_comment LIKE '%%%final%%' OR n.n_comment LIKE '%%%express%%') AND c.c_address IN ('eHXlPkQYPK1RVpZ3', '4FUO417jFpF5k0OEV', 'upE8Dl uKRwLj4JJZ wIOTf') AND c.c_nationkey IN (11, 3) AND s.s_address LIKE '6MUoo6a8FO2hg4XasDb1e5TDlD8xvxO%' GROUP BY n.n_regionkey ORDER BY total_supplier_balance DESC, total_customer_balance DESC;
SELECT n.n_name AS nation_name, c.c_mktsegment AS market_segment, COUNT(c.c_custkey) AS total_customers, SUM(c.c_acctbal) AS total_account_balance, AVG(c.c_acctbal) AS average_account_balance FROM customer c JOIN nation n ON c.c_nationkey = n.n_nationkey GROUP BY n.n_name, c.c_mktsegment ORDER BY n.n_name, c.c_mktsegment;
SELECT r.r_name AS region, EXTRACT(YEAR FROM o.o_orderdate) AS order_year, COUNT(DISTINCT o.o_orderkey) AS total_orders, SUM(l.l_quantity) AS total_quantity, AVG(l.l_extendedprice * (1 - l.l_discount)) AS avg_discounted_price, SUM(CASE WHEN l.l_returnflag = 'R' THEN l.l_extendedprice ELSE 0 END) AS total_returned_value FROM region r JOIN orders o ON r.r_regionkey = o.o_custkey JOIN lineitem l ON o.o_orderkey = l.l_orderkey WHERE o.o_orderdate BETWEEN '1992-01-01' AND '1997-12-31' GROUP BY region, order_year ORDER BY region, order_year;
SELECT n.n_name AS Country, c.c_mktsegment AS MarketSegment, AVG(c.c_acctbal) AS AvgCustomerAcctBalance, COUNT(o.o_orderkey) AS TotalOrders, SUM(o.o_totalprice) AS TotalSalesValue FROM customer c JOIN orders o ON c.c_custkey = o.o_custkey JOIN nation n ON c.c_nationkey = n.n_nationkey JOIN region r ON n.n_regionkey = r.r_regionkey GROUP BY n.n_name, c.c_mktsegment ORDER BY n.n_name, c.c_mktsegment;
SELECT c.c_mktsegment, COUNT(DISTINCT c.c_custkey) AS num_customers, AVG(c.c_acctbal) AS avg_customer_balance, SUM(o.o_totalprice) AS total_order_value, AVG(o.o_totalprice) AS avg_order_value, COUNT(DISTINCT o.o_orderkey) AS total_orders, s.s_nationkey, SUM(p.ps_availqty) AS total_parts_available, AVG(p.ps_supplycost) AS avg_supply_cost FROM customer c JOIN orders o ON c.c_custkey = o.o_custkey JOIN partsupp p ON o.o_orderkey = p.ps_partkey JOIN supplier s ON p.ps_suppkey = s.s_suppkey WHERE o.o_totalprice > 15000 AND (s.s_suppkey IN (437, 4167, 1561)) GROUP BY c.c_mktsegment, s.s_nationkey ORDER BY total_order_value DESC, total_parts_available DESC;
SELECT r.r_name AS region, AVG(c.c_acctbal) AS avg_customer_acctbal, SUM(s.s_acctbal) AS sum_supplier_acctbal, COUNT(DISTINCT o.o_orderkey) AS count_orders, SUM(l.l_extendedprice * (1 - l_discount)) AS revenue, AVG(l.l_quantity) AS avg_lineitem_quantity FROM region r JOIN supplier s ON s.s_nationkey = r.r_regionkey JOIN customer c ON c.c_nationkey = r.r_regionkey JOIN orders o ON o.o_custkey = c.c_custkey JOIN lineitem l ON l.l_orderkey = o.o_orderkey WHERE o.o_orderstatus IN ('P', 'O') AND o.o_shippriority = '0' AND s.s_phone IN ('11-296-188-4518', '16-633-465-1576', '12-672-760-8816', '19-997-887-6373', '32-243-388-7528', '13-300-919-9843') GROUP BY r.r_name ORDER BY revenue DESC;
SELECT r.r_name AS region, p.p_type AS product_type, AVG(l.l_extendedprice * (1 - l.l_discount)) AS avg_sale_price_after_discount, SUM(l.l_quantity) AS total_quantity_sold, COUNT(DISTINCT s.s_suppkey) AS unique_suppliers FROM region r JOIN nation n ON r.r_regionkey = n.n_regionkey JOIN supplier s ON n.n_nationkey = s.s_nationkey JOIN partsupp ps ON s.s_suppkey = ps.ps_suppkey JOIN part p ON ps.ps_partkey = p.p_partkey JOIN lineitem l ON p.p_partkey = l.l_partkey AND s.s_suppkey = l.l_suppkey WHERE l.l_shipdate >= DATE '1995-01-01' AND l.l_shipdate < DATE '1995-01-01' + INTERVAL '1' YEAR AND p.p_size BETWEEN 1 AND 15 GROUP BY region, product_type ORDER BY total_quantity_sold DESC, avg_sale_price_after_discount DESC LIMIT 100;
SELECT r.r_name AS region, n.n_name AS nation, COUNT(o.o_orderkey) AS total_orders, SUM(c.c_acctbal) AS total_customer_balance, AVG(l.l_quantity) AS average_quantity_ordered, SUM(l.l_extendedprice * (1 - l_discount) * (1 + l_tax)) AS total_revenue FROM region r JOIN nation n ON r.r_regionkey = n.n_regionkey JOIN customer c ON n.n_nationkey = c.c_nationkey JOIN orders o ON c.c_custkey = o.o_custkey JOIN lineitem l ON o.o_orderkey = l.l_orderkey WHERE r.r_name IN ('MIDDLE EAST', 'ASIA', 'AFRICA') AND (o.o_orderstatus = 'F' OR o.o_orderstatus = 'O') AND o.o_orderdate BETWEEN DATE '1995-01-01' AND DATE '1995-12-31' AND l.l_shipdate > o.o_orderdate GROUP BY r.r_name, n.n_name ORDER BY total_revenue DESC, total_customer_balance DESC LIMIT 10;
SELECT n.n_name AS nation_name, p.p_type AS part_type, COUNT(DISTINCT s.s_suppkey) AS number_of_suppliers, COUNT(DISTINCT c.c_custkey) AS number_of_customers, SUM(li.l_extendedprice * (1 - li.l_discount)) AS total_sales, AVG(ps.ps_supplycost) AS average_supply_cost, AVG(li.l_quantity) AS average_quantity_sold FROM nation n JOIN supplier s ON n.n_nationkey = s.s_nationkey JOIN partsupp ps ON s.s_suppkey = ps.ps_suppkey JOIN part p ON ps.ps_partkey = p.p_partkey JOIN lineitem li ON p.p_partkey = li.l_partkey AND s.s_suppkey = li.l_suppkey JOIN orders o ON li.l_orderkey = o.o_orderkey JOIN customer c ON o.o_custkey = c.c_custkey AND c.c_nationkey = n.n_nationkey WHERE n.n_regionkey IN (1, 2, 4) AND o.o_orderdate BETWEEN '2021-01-01' AND '2021-12-31' AND li.l_shipdate > o.o_orderdate AND c.c_phone LIKE '25-%' GROUP BY nation_name, part_type ORDER BY total_sales DESC, nation_name, part_type;
SELECT n.n_name AS nation_name, c.c_mktsegment AS market_segment, AVG(c.c_acctbal) AS average_account_balance, COUNT(DISTINCT c.c_custkey) AS total_customers, SUM(ps.ps_availqty) AS total_available_quantity, AVG(ps.ps_supplycost) AS average_supply_cost FROM nation n JOIN customer c ON n.n_nationkey = c.c_nationkey JOIN partsupp ps ON c.c_custkey = ps.ps_suppkey WHERE n.n_nationkey IN (23, 4, 11) AND c.c_nationkey IN (20, 14, 9, 13, 5) AND ps.ps_partkey IN (701, 554, 25) GROUP BY n.n_name, c.c_mktsegment ORDER BY average_account_balance DESC, total_customers DESC;
SELECT r.r_name AS region_name, p.p_type AS part_type, AVG(l.l_quantity) AS average_quantity, SUM(l.l_extendedprice * (1 - l.l_discount)) AS net_revenue, COUNT(DISTINCT o.o_orderkey) AS number_of_orders FROM region r JOIN partsupp ps ON r.r_regionkey = ps.ps_suppkey JOIN part p ON ps.ps_partkey = p.p_partkey JOIN lineitem l ON p.p_partkey = l.l_partkey AND ps.ps_suppkey = l.l_suppkey JOIN orders o ON l.l_orderkey = o.o_orderkey WHERE o.o_orderdate BETWEEN date '1994-01-01' AND date '1994-12-31' AND l.l_shipmode IN ('AIR', 'RAIL') GROUP BY r.r_name, p.p_type ORDER BY net_revenue DESC;
SELECT r.r_name AS region_name, COUNT(o.o_orderkey) AS total_orders, AVG(o.o_totalprice) AS average_order_value, SUM(o.o_totalprice) AS total_revenue FROM orders o JOIN supplier s ON o.o_custkey = s.s_suppkey JOIN region r ON s.s_nationkey = r.r_regionkey WHERE o.o_orderstatus = 'F' AND EXTRACT(YEAR FROM o.o_orderdate) = 2021 GROUP BY r.r_name ORDER BY total_revenue DESC;
SELECT n.n_name, SUM(l.l_extendedprice * (1 - l.l_discount)) AS revenue, AVG(s.s_acctbal) AS avg_supplier_acctbal, COUNT(DISTINCT s.s_suppkey) AS num_suppliers, COUNT(DISTINCT p.p_partkey) AS num_parts FROM nation AS n JOIN supplier AS s ON n.n_nationkey = s.s_nationkey JOIN partsupp AS ps ON s.s_suppkey = ps.ps_suppkey JOIN part AS p ON ps.ps_partkey = p.p_partkey JOIN lineitem AS l ON p.p_partkey = l.l_partkey AND s.s_suppkey = l.l_suppkey WHERE p.p_brand IN ('Brand#53', 'Brand#15') AND ps.ps_comment LIKE '%st the blithely busy pinto beans. slyly special d%' AND ps.ps_availqty IN (9088, 4885, 5004) AND s.s_phone = '20-439-700-9492' AND s.s_comment IN ( 'as; quickly final packages nod requests.', 'refully according to the', 'deposits nag furiously. final, final asymptote', 'e carefully unusual dolph', 'ly even asymptotes haggle bold' ) GROUP BY n.n_name ORDER BY revenue DESC, avg_supplier_acctbal DESC LIMIT 100;
SELECT n.n_name AS nation_name, COUNT(DISTINCT s.s_suppkey) AS number_of_suppliers, AVG(ps.ps_supplycost) AS average_supply_cost, SUM(ps.ps_availqty) AS total_available_quantity, AVG(p.p_retailprice) AS average_retail_price FROM nation n JOIN supplier s ON n.n_nationkey = s.s_nationkey JOIN partsupp ps ON s.s_suppkey = ps.ps_suppkey JOIN part p ON ps.ps_partkey = p.p_partkey WHERE n.n_name IN ('ETHIOPIA', 'EGYPT', 'MOZAMBIQUE', 'BRAZIL', 'INDONESIA') GROUP BY n.n_name ORDER BY total_available_quantity DESC, average_supply_cost;
SELECT n.n_name AS nation, AVG(s.s_acctbal) AS average_account_balance, COUNT(DISTINCT ps.ps_partkey) AS total_parts_supplied FROM supplier s JOIN nation n ON s.s_nationkey = n.n_nationkey JOIN region r ON n.n_regionkey = r.r_regionkey JOIN partsupp ps ON s.s_suppkey = ps.ps_suppkey JOIN part p ON ps.ps_partkey = p.p_partkey WHERE r.r_name = 'EUROPE' AND p.p_mfgr IN ('Manufacturer#3', 'Manufacturer#2') GROUP BY n.n_name ORDER BY average_account_balance DESC, total_parts_supplied DESC;
SELECT r.r_name AS region, n.n_name AS nation, c.c_mktsegment AS market_segment, COUNT(DISTINCT c.c_custkey) AS num_customers, AVG(c.c_acctbal) AS avg_account_balance, SUM(l.l_quantity) AS total_quantity_ordered, AVG(l.l_extendedprice * (1 - l.l_discount)) AS avg_discounted_price, COUNT(DISTINCT o.o_orderkey) AS num_orders, SUM(o.o_totalprice) AS total_order_value FROM customer AS c JOIN nation AS n ON c.c_nationkey = n.n_nationkey JOIN region AS r ON n.n_regionkey = r.r_regionkey JOIN orders AS o ON c.c_custkey = o.o_custkey JOIN lineitem AS l ON o.o_orderkey = l.l_orderkey WHERE o.o_orderdate BETWEEN date '1995-01-01' AND date '1995-12-31' AND l.l_shipdate > o.o_orderdate GROUP BY region, nation, market_segment ORDER BY total_order_value DESC, avg_account_balance DESC LIMIT 10;
SELECT n.n_name, AVG(s.s_acctbal) AS avg_supplier_balance, COUNT(DISTINCT c.c_custkey) AS number_of_customers, SUM(l.l_quantity) AS total_quantity_ordered, SUM(l.l_extendedprice * (1 - l_discount)) AS revenue, AVG(p.p_retailprice) AS avg_part_retail_price FROM nation n JOIN supplier s ON s.s_nationkey = n.n_nationkey JOIN customer c ON c.c_nationkey = n.n_nationkey JOIN orders o ON o.o_custkey = c.c_custkey JOIN lineitem l ON l.l_orderkey = o.o_orderkey JOIN part p ON p.p_partkey = l.l_partkey JOIN partsupp ps ON ps.ps_suppkey = l.l_suppkey AND ps.ps_partkey = l.l_partkey WHERE l.l_shipmode IN ('AIR', 'FOB') AND l.l_discount BETWEEN 0.05 AND 0.07 AND o.o_orderdate >= date '1995-01-01' AND o.o_orderdate < date '1996-01-01' AND ps.ps_supplycost < 600.00 GROUP BY n.n_name ORDER BY revenue DESC, avg_supplier_balance DESC LIMIT 5;
SELECT c.c_mktsegment AS market_segment, COUNT(DISTINCT o.o_orderkey) AS number_of_orders, SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_revenue, AVG(c.c_acctbal) AS average_customer_acct_balance, COUNT(DISTINCT s.s_suppkey) AS number_of_suppliers, AVG(p.p_retailprice) AS average_part_price FROM customer c JOIN orders o ON c.c_custkey = o.o_custkey JOIN lineitem l ON o.o_orderkey = l.l_orderkey JOIN part p ON l.l_partkey = p.p_partkey JOIN supplier s ON l.l_suppkey = s.s_suppkey WHERE c.c_mktsegment = 'AUTOMOBILE' AND o.o_orderdate BETWEEN date '2022-01-01' AND date '2022-12-31' AND l.l_shipdate > o.o_orderdate AND p.p_container = 'JUMBO PACK' GROUP BY c.c_mktsegment ORDER BY total_revenue DESC, average_customer_acct_balance DESC LIMIT 10;
SELECT r_name AS region, n_name AS nation, c_mktsegment AS market_segment, COUNT(DISTINCT c_custkey) AS num_customers, SUM(o_totalprice) AS total_sales, AVG(l_quantity) AS average_quantity, AVG(l_extendedprice * (1 - l_discount)) AS average_discounted_price FROM customer JOIN orders ON c_custkey = o_custkey JOIN lineitem ON o_orderkey = l_orderkey JOIN nation ON c_nationkey = n_nationkey JOIN region ON n_regionkey = r_regionkey WHERE o_orderstatus = 'F' AND l_returnflag = 'R' AND o_shippriority = 0 AND o_orderdate BETWEEN '1994-01-01' AND '1994-12-31' GROUP BY region, nation, market_segment ORDER BY total_sales DESC, average_discounted_price DESC;
SELECT r.r_name AS region, n.n_name AS nation, COUNT(DISTINCT s.s_suppkey) AS supplier_count, COUNT(DISTINCT c.c_custkey) AS customer_count, AVG(s.s_acctbal) AS avg_supplier_acctbal, AVG(c.c_acctbal) AS avg_customer_acctbal, SUM(o.o_totalprice) AS total_order_value, AVG(o.o_totalprice) AS avg_order_value, COUNT(DISTINCT o.o_orderkey) AS order_count FROM region r JOIN nation n ON r.r_regionkey = n.n_regionkey JOIN supplier s ON n.n_nationkey = s.s_nationkey JOIN customer c ON n.n_nationkey = c.c_nationkey JOIN orders o ON c.c_custkey = o.o_custkey WHERE n.n_nationkey IN (21, 4, 7, 9, 5, 23) AND r.r_regionkey IN (1, 4, 0, 2, 3) AND o.o_orderdate BETWEEN '1995-01-01' AND '1996-12-31' AND o.o_orderstatus = 'F' GROUP BY r.r_name, n.n_name ORDER BY total_order_value DESC;
SELECT r_name AS region, s_nationkey, n_name AS nation, COUNT(DISTINCT c_custkey) AS num_customers, SUM(l_extendedprice * (1 - l_discount)) AS total_revenue, AVG(l_discount) AS average_discount FROM supplier JOIN nation ON s_nationkey = n_nationkey JOIN region ON n_regionkey = r_regionkey JOIN customer ON c_nationkey = s_nationkey JOIN orders ON c_custkey = o_custkey JOIN lineitem ON l_orderkey = o_orderkey WHERE r_name = 'EUROPE' AND c_mktsegment = 'AUTOMOBILE' AND o_orderdate >= date '1995-01-01' AND o_orderdate < date '1996-01-01' GROUP BY r_name, s_nationkey, n_name ORDER BY total_revenue DESC;
SELECT r_name, AVG(c_acctbal) AS avg_customer_acctbal, SUM(s_acctbal) AS total_supplier_acctbal, COUNT(DISTINCT s_suppkey) AS number_of_suppliers, COUNT(DISTINCT c_custkey) AS number_of_customers, AVG(p_retailprice) AS avg_part_retailprice FROM region JOIN supplier ON r_regionkey = s_nationkey JOIN customer ON r_regionkey = c_nationkey JOIN part ON p_size BETWEEN 1 AND 50 WHERE r_regionkey = 3 AND s_suppkey != 4276 AND (p_type = 'LARGE PLATED STEEL' OR p_type = 'LARGE POLISHED STEEL') AND c_address IN ('GMKHrs5qR3nY5X4SEN01,AaRRDLX', 'OWPmLHF0CVtV7wqL86ZEL4xYMtXATh45AP') GROUP BY r_name ORDER BY avg_customer_acctbal DESC, total_supplier_acctbal DESC;
SELECT n.n_name, c.c_mktsegment, COUNT(DISTINCT o.o_orderkey) AS total_orders, AVG(o.o_totalprice) AS avg_order_value, SUM(o.o_totalprice) AS total_revenue FROM nation n JOIN customer c ON n.n_nationkey = c.c_nationkey JOIN orders o ON c.c_custkey = o.o_custkey WHERE n.n_name IN ('JORDAN', 'MOZAMBIQUE', 'RUSSIA') AND o.o_orderdate BETWEEN '2020-01-01' AND '2020-12-31' GROUP BY n.n_name, c.c_mktsegment ORDER BY total_revenue DESC, n.n_name, c.c_mktsegment;
SELECT n_name AS nation, r_name AS region, COUNT(DISTINCT s_suppkey) AS number_of_suppliers, COUNT(DISTINCT c_custkey) AS number_of_customers, SUM(l_extendedprice * (1 - l_discount)) AS total_sales, AVG(l_quantity) AS average_quantity_sold, AVG(c_acctbal) AS average_customer_balance FROM nation JOIN region ON n_regionkey = r_regionkey JOIN supplier ON s_nationkey = n_nationkey JOIN customer ON c_nationkey = n_nationkey JOIN orders ON o_custkey = c_custkey JOIN lineitem ON l_orderkey = o_orderkey WHERE c_mktsegment = 'BUILDING' AND o_orderdate BETWEEN date '1995-01-01' AND date '1995-12-31' AND l_shipdate > date '1995-12-31' GROUP BY n_name, r_name ORDER BY total_sales DESC, region, nation;
SELECT c.c_mktsegment as customer_market_segment, sum(o.o_totalprice) as total_sales, avg(p.p_retailprice) as average_retail_price, count(DISTINCT c.c_custkey) as number_of_customers, count(DISTINCT s.s_suppkey) as number_of_suppliers, count(DISTINCT o.o_orderkey) as number_of_orders FROM customer c JOIN orders o ON c.c_custkey = o.o_custkey JOIN partsupp ps ON c.c_nationkey = ps.ps_suppkey JOIN supplier s ON ps.ps_suppkey = s.s_suppkey JOIN part p ON ps.ps_partkey = p.p_partkey WHERE o.o_orderstatus = 'F' AND o.o_orderpriority IN ('1-URGENT', '5-LOW') AND (p.p_type = 'LARGE BURNISHED NICKEL' OR p.p_type = 'ECONOMY ANODIZED STEEL') GROUP BY c.c_mktsegment ORDER BY total_sales DESC;
SELECT r.r_name AS region, n.n_name AS nation, COUNT(DISTINCT c.c_custkey) AS num_customers, SUM(c.c_acctbal) AS total_balance, AVG(c.c_acctbal) AS avg_balance, SUM(li.l_extendedprice) AS total_sales, SUM(li.l_extendedprice * (1 - li.l_discount)) AS total_sales_discounted, AVG(li.l_quantity) AS avg_quantity_sold, COUNT(DISTINCT p.p_partkey) AS num_parts_sold, SUM(li.l_quantity * ps.ps_supplycost) AS total_supply_cost FROM customer c JOIN nation n ON c.c_nationkey = n.n_nationkey JOIN region r ON n.n_regionkey = r.r_regionkey JOIN lineitem li ON c.c_custkey = li.l_orderkey JOIN part p ON li.l_partkey = p.p_partkey JOIN partsupp ps ON p.p_partkey = ps.ps_partkey AND li.l_suppkey = ps.ps_suppkey WHERE p.p_brand = 'Brand#51' AND p.p_type IN ('PROMO BURNISHED STEEL', 'STANDARD POLISHED STEEL', 'LARGE BRUSHED STEEL', 'MEDIUM ANODIZED NICKEL', 'SMALL BRUSHED COPPER') AND li.l_discount BETWEEN 0.01 AND 0.10 AND ps.ps_availqty > 2000 AND r.r_name IN ('MIDDLE EAST', 'ASIA', 'EUROPE', 'AMERICA', 'AFRICA') GROUP BY r.r_name, n.n_name ORDER BY total_sales_discounted DESC, avg_balance DESC;
SELECT r.r_name AS region_name, COUNT(DISTINCT s.s_suppkey) AS total_suppliers, AVG(s.s_acctbal) AS average_account_balance, SUM(ps.ps_availqty) AS total_available_quantity FROM region r JOIN supplier s ON s.s_nationkey = r.r_regionkey JOIN partsupp ps ON ps.ps_suppkey = s.s_suppkey WHERE ps.ps_partkey IN (284, 229, 882) GROUP BY r.r_name ORDER BY total_suppliers DESC;
SELECT n.n_name AS nation, c.c_mktsegment AS market_segment, COUNT(DISTINCT o.o_orderkey) AS total_orders, AVG(o.o_totalprice) AS average_order_amount, SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_spend, AVG(l.l_discount) AS average_discount FROM customer c JOIN orders o ON c.c_custkey = o.o_custkey JOIN lineitem l ON o.o_orderkey = l.l_orderkey JOIN nation n ON c.c_nationkey = n.n_nationkey WHERE o.o_orderdate >= date '1994-01-01' AND o.o_orderdate < date '1995-01-01' GROUP BY nation, market_segment ORDER BY total_spend DESC;
SELECT r.r_name AS region, n.n_name AS nation, COUNT(DISTINCT s.s_suppkey) AS total_suppliers, COUNT(DISTINCT c.c_custkey) AS total_customers, SUM(l.l_extendedprice * (1 - l.l_discount)) AS revenue, AVG(l.l_quantity) AS avg_quantity, AVG(ps.ps_supplycost) AS avg_supply_cost FROM region r JOIN nation n ON r.r_regionkey = n.n_regionkey JOIN supplier s ON n.n_nationkey = s.s_nationkey JOIN customer c ON n.n_nationkey = c.c_nationkey JOIN orders o ON c.c_custkey = o.o_custkey JOIN lineitem l ON o.o_orderkey = l.l_orderkey JOIN partsupp ps ON l.l_partkey = ps.ps_partkey AND l.l_suppkey = ps.ps_suppkey JOIN part p ON l.l_partkey = p.p_partkey WHERE p.p_type IN ('PROMO POLISHED TIN', 'MEDIUM POLISHED TIN', 'PROMO BRUSHED BRASS', 'MEDIUM PLATED TIN') AND l.l_quantity IN (46.00, 21.00, 35.00, 41.00, 33.00, 3.00) AND ps.ps_availqty IN (9864, 6700, 2213) AND o.o_orderstatus IN ('F', 'O') AND o.o_clerk IN ('Clerk#000004518', 'Clerk#000013763', 'Clerk#000007228') GROUP BY r.r_name, n.n_name ORDER BY revenue DESC, region, nation;
SELECT r_name AS region, n_name AS nation, COUNT(DISTINCT s_suppkey) AS num_suppliers, COUNT(DISTINCT c_custkey) AS num_customers, SUM(l_extendedprice * (1 - l_discount)) AS total_sales, AVG(l_quantity) AS average_quantity_sold, AVG(ps_supplycost) AS average_supply_cost FROM region JOIN nation ON r_regionkey = n_regionkey JOIN supplier ON n_nationkey = s_nationkey JOIN customer ON n_nationkey = c_nationkey JOIN orders ON c_custkey = o_custkey JOIN lineitem ON o_orderkey = l_orderkey JOIN partsupp ON s_suppkey = ps_suppkey AND l_partkey = ps_partkey WHERE l_shipdate BETWEEN date '1994-01-01' AND date '1994-12-31' AND o_orderstatus = 'F' GROUP BY region, nation ORDER BY total_sales DESC;
SELECT r_name AS region, COUNT(DISTINCT c.c_custkey) AS number_of_customers, SUM(o.o_totalprice) AS total_sales, AVG(l.l_quantity) AS average_quantity_ordered, SUM((l.l_extendedprice * (1 - l.l_discount))) AS revenue, COUNT(DISTINCT o.o_orderkey) AS number_of_orders FROM region JOIN customer c ON c.c_nationkey = region.r_regionkey JOIN orders o ON o.o_custkey = c.c_custkey JOIN lineitem l ON l.l_orderkey = o.o_orderkey WHERE r_name IN ('MIDDLE EAST', 'ASIA', 'EUROPE', 'AMERICA', 'AFRICA') AND o.o_shippriority = 0 AND o.o_totalprice > 20000 GROUP BY r_name ORDER BY total_sales DESC;
SELECT n.n_name AS nation_name, COUNT(DISTINCT s.s_suppkey) AS total_suppliers, COUNT(DISTINCT p.p_partkey) AS total_parts, COUNT(DISTINCT o.o_orderkey) AS total_orders, SUM(l.l_extendedprice) AS total_sales, AVG(l.l_quantity) AS average_quantity_sold, SUM(l.l_extendedprice * (1 - l.l_discount)) AS revenue_after_discount FROM nation n JOIN supplier s ON n.n_nationkey = s.s_nationkey JOIN partsupp ps ON s.s_suppkey = ps.ps_suppkey JOIN part p ON ps.ps_partkey = p.p_partkey JOIN lineitem l ON p.p_partkey = l.l_partkey AND ps.ps_suppkey = l.l_suppkey JOIN orders o ON l.l_orderkey = o.o_orderkey WHERE o.o_orderstatus = 'F' AND p.p_mfgr IN ('Manufacturer#4', 'Manufacturer#5') AND l.l_shipdate BETWEEN '1995-01-01' AND '1996-01-01' GROUP BY n.n_name ORDER BY total_sales DESC LIMIT 10;
SELECT n.n_name AS nation_name, p.p_brand AS part_brand, COUNT(DISTINCT s.s_suppkey) AS num_suppliers, COUNT(DISTINCT o.o_orderkey) AS num_orders, SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_sales_volume, AVG(c.c_acctbal) AS avg_customer_acctbal FROM nation AS n JOIN supplier AS s ON n.n_nationkey = s.s_nationkey JOIN partsupp AS ps ON s.s_suppkey = ps.ps_suppkey JOIN part AS p ON ps.ps_partkey = p.p_partkey JOIN lineitem AS l ON p.p_partkey = l.l_partkey AND s.s_suppkey = l.l_suppkey JOIN orders AS o ON l.l_orderkey = o.o_orderkey JOIN customer AS c ON o.o_custkey = c.c_custkey AND n.n_nationkey = c.c_nationkey WHERE p.p_brand IN ('Brand#53', 'Brand#13') AND o.o_shippriority = '0' GROUP BY nation_name, part_brand ORDER BY total_sales_volume DESC, avg_customer_acctbal DESC;
SELECT c.c_mktsegment, p.p_brand, EXTRACT(YEAR FROM o.o_orderdate) AS order_year, COUNT(DISTINCT o.o_orderkey) AS total_orders, SUM(l.l_quantity) AS total_quantity, AVG(l.l_extendedprice * (1 - l_discount)) AS avg_discounted_price, SUM(l.l_extendedprice * (1 - l_discount) * (1 + l_tax)) AS total_taxed_price FROM customer c JOIN orders o ON c.c_custkey = o.o_custkey JOIN lineitem l ON o.o_orderkey = l.l_orderkey JOIN part p ON l.l_partkey = p.p_partkey WHERE c.c_acctbal > 0 AND p.p_mfgr IN ('Manufacturer#1', 'Manufacturer#2', 'Manufacturer#3') AND l.l_returnflag = 'N' AND o.o_orderstatus = 'O' AND o.o_orderpriority NOT IN ('1-URGENT', '2-HIGH') GROUP BY c.c_mktsegment, p.p_brand, order_year ORDER BY total_taxed_price DESC, total_quantity DESC, avg_discounted_price DESC, c.c_mktsegment, p.p_brand, order_year;
SELECT p.p_type, AVG(p.p_retailprice) AS avg_retail_price, SUM(ps.ps_availqty) AS total_available_quantity, COUNT(DISTINCT o.o_orderkey) AS number_of_orders, SUM(o.o_totalprice) AS total_order_value FROM part p JOIN partsupp ps ON p.p_partkey = ps.ps_partkey JOIN orders o ON ps.ps_partkey = o.o_orderkey WHERE p.p_type IN ('LARGE ANODIZED TIN', 'STANDARD BRUSHED STEEL', 'PROMO ANODIZED NICKEL', 'STANDARD BURNISHED TIN', 'MEDIUM ANODIZED NICKEL') AND p.p_comment LIKE '%regular%' AND o.o_orderdate BETWEEN DATE '2022-01-01' AND DATE '2022-12-31' GROUP BY p.p_type ORDER BY avg_retail_price DESC;
SELECT r_name AS region, n_name AS nation, COUNT(DISTINCT o_orderkey) AS total_orders, SUM(l_extendedprice * (1 - l_discount)) AS total_revenue, AVG(l_quantity) AS average_quantity, AVG(l_extendedprice) AS average_price, SUM(CASE WHEN l_returnflag = 'R' THEN 1 ELSE 0 END) AS returned_orders FROM region JOIN nation ON region.r_regionkey = nation.n_regionkey JOIN orders ON nation.n_nationkey = o_custkey JOIN lineitem ON orders.o_orderkey = lineitem.l_orderkey GROUP BY region, nation ORDER BY total_revenue DESC;
SELECT p.p_size AS part_size, EXTRACT(YEAR FROM o.o_orderdate) AS order_year, COUNT(DISTINCT o.o_orderkey) AS total_orders, AVG(l.l_quantity) AS average_quantity, SUM(l.l_extendedprice) AS total_sales, AVG(l.l_discount) AS average_discount, (SUM(l.l_extendedprice * (1 - l.l_discount)) / SUM(l.l_extendedprice)) * 100 AS effective_discount_percentage FROM orders o JOIN lineitem l ON o.o_orderkey = l.l_orderkey JOIN part p ON l.l_partkey = p.p_partkey WHERE o.o_orderdate BETWEEN '2020-01-01' AND '2023-01-01' AND l.l_discount > 0 GROUP BY p.p_size, EXTRACT(YEAR FROM o.o_orderdate) ORDER BY effective_discount_percentage DESC, part_size, order_year;
SELECT r_name AS region, n_name AS nation, COUNT(DISTINCT s_suppkey) AS num_suppliers, COUNT(DISTINCT c_custkey) AS num_customers, AVG(s_acctbal) AS avg_supplier_acctbal, AVG(c_acctbal) AS avg_customer_acctbal, SUM(l_extendedprice * (1 - l_discount)) AS revenue FROM region JOIN nation ON r_regionkey = n_regionkey JOIN supplier ON s_nationkey = n_nationkey JOIN customer ON c_nationkey = n_nationkey JOIN orders ON o_custkey = c_custkey JOIN lineitem ON l_orderkey = o_orderkey WHERE o_orderstatus = 'O' AND l_shipdate BETWEEN '2023-01-01' AND '2023-12-31' GROUP BY region, nation ORDER BY revenue DESC;
SELECT p.p_brand, c.c_mktsegment, SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_sales, AVG(l.l_discount) AS average_discount, SUM(l.l_quantity) AS total_quantity FROM part p JOIN lineitem l ON p.p_partkey = l.l_partkey JOIN orders o ON l.l_orderkey = o.o_orderkey JOIN customer c ON o.o_custkey = c.c_custkey GROUP BY p.p_brand, c.c_mktsegment ORDER BY p.p_brand, c.c_mktsegment;
SELECT s.s_nationkey, COUNT(DISTINCT s.s_suppkey) AS total_suppliers, COUNT(DISTINCT c.c_custkey) AS total_customers, COUNT(DISTINCT p.p_partkey) AS total_parts, AVG(ps.ps_availqty) AS average_available_quantity, SUM(ps.ps_supplycost) AS total_supply_cost, AVG(ps.ps_supplycost) AS average_supply_cost FROM supplier s JOIN partsupp ps ON s.s_suppkey = ps.ps_suppkey JOIN part p ON ps.ps_partkey = p.p_partkey JOIN customer c ON s.s_nationkey = c.c_nationkey WHERE p.p_size = 27 AND p.p_name IN ('saddle moccasin navy tan lace', 'cornflower rose slate forest black', 'peru floral burnished goldenrod salmon', 'navajo linen mint sandy cream', 'floral black orange snow steel', 'medium blue azure tomato aquamarine') AND ps.ps_comment IN ('s are blithely around the final, quiet platelets.', 'c packages mold. carefully regular excuses along', 's cajole alongside of the express instructions. u', 'ly. ideas cajole ironic deposits. bold deposits a', 'old ideas. quickly final accounts nag above the q', 'longside of the slyly bold sheaves! packages wake') AND ps.ps_suppkey IN ('180562', '180707', '180598', '171', '120438') GROUP BY s.s_nationkey ORDER BY total_supply_cost DESC;
SELECT n.n_name AS nation_name, AVG(ps.ps_supplycost) AS avg_supply_cost, SUM(ps.ps_availqty) AS total_avail_qty, COUNT(o.o_orderkey) AS order_count, AVG(o.o_totalprice) AS avg_order_price FROM nation n JOIN partsupp ps ON n.n_nationkey = ps.ps_suppkey LEFT JOIN orders o ON n.n_nationkey = o.o_custkey AND o.o_orderdate >= '2020-01-01' AND o.o_orderdate < '2021-01-01' WHERE ps.ps_availqty IN (1805, 7621, 9995, 1615, 669) GROUP BY n.n_name ORDER BY n.n_name;
SELECT r.r_name AS region_name, COUNT(DISTINCT s.s_suppkey) AS total_suppliers, COUNT(DISTINCT o.o_orderkey) AS total_orders, AVG(o.o_totalprice) AS avg_order_total_price, SUM(li.l_quantity) AS total_quantity_supplied FROM supplier s JOIN partsupp ps ON s.s_suppkey = ps.ps_suppkey JOIN lineitem li ON ps.ps_partkey = li.l_partkey AND ps.ps_suppkey = li.l_suppkey JOIN orders o ON li.l_orderkey = o.o_orderkey JOIN customer c ON o.o_custkey = c.c_custkey JOIN region r ON c.c_nationkey = s.s_nationkey WHERE s.s_acctbal > 0 GROUP BY r.r_name ORDER BY total_quantity_supplied DESC, avg_order_total_price DESC;
SELECT s_name, s_address, p_type, AVG(l_quantity) AS average_quantity, SUM(l_extendedprice) AS total_sales, COUNT(DISTINCT l_orderkey) AS number_of_orders, SUM(CASE WHEN l_discount > 0 THEN l_extendedprice * (1 - l_discount) ELSE 0 END) AS discounted_sales FROM supplier JOIN lineitem ON supplier.s_suppkey = lineitem.l_suppkey JOIN part ON lineitem.l_partkey = part.p_partkey WHERE s_acctbal > 5000 AND p_mfgr = 'Manufacturer#5' AND l_shipdate BETWEEN '2022-01-01' AND '2022-12-31' GROUP BY s_name, s_address, p_type ORDER BY total_sales DESC, s_name LIMIT 10;
SELECT c.c_custkey, c.c_name, AVG(ps.ps_availqty) AS avg_parts_availability, SUM(l.l_quantity) AS total_quantity_ordered, SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_revenue, COUNT(l.l_orderkey) AS total_orders FROM customer AS c JOIN lineitem AS l ON c.c_custkey = l.l_orderkey JOIN partsupp AS ps ON (l.l_partkey = ps.ps_partkey AND l.l_suppkey = ps.ps_suppkey) WHERE ps.ps_availqty BETWEEN 5000 AND 10000 GROUP BY c.c_custkey, c.c_name ORDER BY total_revenue DESC, total_orders DESC;
SELECT r.r_name AS region, COUNT(DISTINCT ps.ps_suppkey) AS number_of_suppliers, SUM(ps.ps_availqty) AS total_availability, AVG(ps.ps_supplycost) AS average_supply_cost, SUM(l.l_quantity) AS total_quantity_ordered, SUM(l.l_extendedprice * (1 - l_discount)) AS total_revenue, SUM(CASE WHEN l.l_returnflag = 'R' THEN 1 ELSE 0 END) AS return_count FROM region r JOIN partsupp ps ON r.r_regionkey = ps.ps_suppkey % 5 JOIN lineitem l ON ps.ps_partkey = l.l_partkey AND ps.ps_suppkey = l.l_suppkey WHERE r.r_regionkey = 3 AND l.l_shipdate BETWEEN '2022-01-01' AND '2022-12-31' AND l.l_returnflag IN ('N', 'R') GROUP BY r.r_name ORDER BY total_revenue DESC;
SELECT r_name AS region, n_name AS nation, p_type AS product_type, EXTRACT(YEAR FROM o_orderdate) AS order_year, COUNT(DISTINCT o_orderkey) AS total_orders, SUM(l_extendedprice) AS total_sales, AVG(l_extendedprice) AS avg_sales, SUM(l_quantity) AS total_quantity_sold, AVG(l_discount) AS avg_discount_given, SUM(l_extendedprice * (1 - l_discount)) AS revenue_after_discount, SUM(l_extendedprice * (1 - l_discount) * (1 + l_tax)) AS revenue_after_tax_and_discount FROM region JOIN nation ON r_regionkey = n_regionkey JOIN supplier ON n_nationkey = s_nationkey JOIN partsupp ON s_suppkey = ps_suppkey JOIN part ON ps_partkey = p_partkey JOIN lineitem ON p_partkey = l_partkey AND ps_suppkey = l_suppkey JOIN orders ON l_orderkey = o_orderkey JOIN customer ON o_custkey = c_custkey WHERE c_mktsegment = 'MACHINERY' AND r_name IN ('EUROPE', 'ASIA') AND o_orderdate BETWEEN '2020-01-01' AND '2020-12-31' AND l_shipmode IN ('AIR', 'RAIL') GROUP BY region, nation, product_type, order_year ORDER BY total_sales DESC, avg_sales DESC LIMIT 10;
SELECT s.s_name, s.s_address, AVG(s.s_acctbal) AS average_balance, COUNT(DISTINCT p.p_partkey) AS part_count, SUM(l.l_quantity) AS total_quantity, SUM(l.l_extendedprice * (1 - l_discount)) AS total_revenue, AVG(l.l_extendedprice * (1 - l_discount)) AS average_revenue_per_part FROM supplier s JOIN lineitem l ON s.s_suppkey = l.l_suppkey JOIN part p ON l.l_partkey = p.p_partkey WHERE l.l_shipdate BETWEEN '1995-01-01' AND '1995-12-31' AND l.l_returnflag IN ('N', 'A', 'R') AND p.p_brand = 'Brand#14' GROUP BY s.s_name, s.s_address ORDER BY total_revenue DESC, s.s_name LIMIT 10;
SELECT r.r_name AS region_name, COUNT(DISTINCT s.s_suppkey) AS supplier_count, COUNT(DISTINCT c.c_custkey) AS customer_count, AVG(s.s_acctbal) AS avg_supplier_acctbal, AVG(c.c_acctbal) AS avg_customer_acctbal, SUM(l.l_extendedprice * (1 - l.l_discount)) AS revenue, AVG(p.p_retailprice) AS avg_part_retailprice FROM region r JOIN supplier s ON r.r_regionkey = s.s_nationkey JOIN customer c ON r.r_regionkey = c.c_nationkey JOIN orders o ON c.c_custkey = o.o_custkey JOIN lineitem l ON o.o_orderkey = l.l_orderkey JOIN part p ON l.l_partkey = p.p_partkey JOIN partsupp ps ON p.p_partkey = ps.ps_partkey AND s.s_suppkey = ps.ps_suppkey WHERE p.p_size IN (8, 32) AND p.p_container IN ('WRAP BAG', 'MED JAR') AND l.l_shipinstruct IN ('COLLECT COD', 'TAKE BACK RETURN') AND l.l_commitdate BETWEEN '1997-07-01' AND '1997-07-31' GROUP BY r.r_name ORDER BY revenue DESC, avg_part_retailprice DESC;
SELECT s.s_nationkey, COUNT(DISTINCT s.s_suppkey) AS total_suppliers, AVG(s.s_acctbal) AS average_account_balance, SUM(ps.ps_supplycost) AS total_supply_cost FROM supplier s JOIN partsupp ps ON s.s_suppkey = ps.ps_suppkey GROUP BY s.s_nationkey ORDER BY total_supply_cost DESC;
SELECT r.r_name AS region_name, COUNT(DISTINCT s.s_suppkey) AS total_suppliers, AVG(s.s_acctbal) AS avg_account_balance, SUM(o.o_totalprice) AS total_order_value, COUNT(DISTINCT o.o_orderkey) AS total_orders FROM supplier s JOIN region r ON s.s_nationkey = r.r_regionkey JOIN orders o ON s.s_suppkey = o.o_custkey WHERE r.r_regionkey IN (0, 1, 4) AND o.o_orderstatus = 'F' GROUP BY r.r_name ORDER BY total_order_value DESC;
SELECT r.r_name AS region, n.n_name AS nation, COUNT(DISTINCT c.c_custkey) AS number_of_customers, SUM(o.o_totalprice) AS total_sales, AVG(ps.ps_supplycost) AS average_supply_cost, SUM(l.l_quantity) AS total_quantity_sold, AVG(l.l_extendedprice * (1 - l_discount)) AS average_discounted_price FROM region r JOIN nation n ON r.r_regionkey = n.n_regionkey JOIN supplier s ON s.s_nationkey = n.n_nationkey JOIN partsupp ps ON ps.ps_suppkey = s.s_suppkey JOIN part p ON ps.ps_partkey = p.p_partkey JOIN lineitem l ON p.p_partkey = l.l_partkey AND ps.ps_suppkey = l.l_suppkey JOIN orders o ON l.l_orderkey = o.o_orderkey JOIN customer c ON o.o_custkey = c.c_custkey WHERE p.p_container IN ('JUMBO CAN', 'SM BOX', 'SM PACK', 'MED BAG', 'JUMBO PACK', 'JUMBO CASE') AND o.o_orderdate BETWEEN '1995-01-01' AND '1995-12-31' AND r.r_name IN ('MIDDLE EAST', 'ASIA', 'EUROPE', 'AMERICA', 'AFRICA') GROUP BY r.r_name, n.n_name ORDER BY total_sales DESC;
SELECT n.n_name AS nation, c.c_mktsegment AS market_segment, AVG(c.c_acctbal) AS average_account_balance, SUM(p.p_retailprice) AS total_retail_price, COUNT(DISTINCT c.c_custkey) AS number_of_customers FROM customer c JOIN nation n ON c.c_nationkey = n.n_nationkey JOIN part p ON c.c_custkey = p.p_partkey WHERE n.n_comment LIKE '%final%' OR n.n_comment LIKE '%express%' AND c.c_acctbal > 6000 AND p.p_partkey IN (1118, 1480, 2263, 1264) GROUP BY nation, market_segment ORDER BY average_account_balance DESC, total_retail_price DESC;
SELECT n.n_name AS nation_name, COUNT(DISTINCT s.s_suppkey) AS number_of_suppliers, COUNT(DISTINCT c.c_custkey) AS number_of_customers, SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_sales_value, AVG(l.l_quantity) AS average_quantity_sold, AVG(l.l_extendedprice) AS average_sales_price, AVG(l.l_discount) AS average_discount FROM supplier s JOIN nation n ON s.s_nationkey = n.n_nationkey JOIN partsupp ps ON s.s_suppkey = ps.ps_suppkey JOIN lineitem l ON ps.ps_partkey = l.l_partkey AND ps.ps_suppkey = l.l_suppkey JOIN orders o ON l.l_orderkey = o.o_orderkey JOIN customer c ON o.o_custkey = c.c_custkey AND c.c_nationkey = n.n_nationkey GROUP BY n.n_name ORDER BY total_sales_value DESC;
SELECT r.r_name AS region, n.n_name AS nation, COUNT(DISTINCT c.c_custkey) AS total_customers, SUM(l.l_extendedprice * (1 - l.l_discount)) AS revenue, AVG(s.s_acctbal) AS average_supplier_balance, SUM(ps.ps_availqty * ps.ps_supplycost) AS total_parts_value FROM region r JOIN nation n ON r.r_regionkey = n.n_regionkey JOIN supplier s ON n.n_nationkey = s.s_nationkey JOIN partsupp ps ON s.s_suppkey = ps.ps_suppkey JOIN lineitem l ON ps.ps_partkey = l.l_partkey AND ps.ps_suppkey = l.l_suppkey JOIN orders o ON l.l_orderkey = o.o_orderkey JOIN customer c ON o.o_custkey = c.c_custkey AND n.n_nationkey = c.c_nationkey WHERE r.r_name IN ('MIDDLE EAST', 'ASIA') AND l.l_tax BETWEEN 0.05 AND 0.07 AND o.o_orderdate >= '2020-01-01' AND o.o_orderdate < '2021-01-01' GROUP BY r.r_name, n.n_name ORDER BY revenue DESC, average_supplier_balance DESC;
SELECT r.r_name AS region_name, AVG(l.l_quantity) AS average_quantity, AVG(l.l_discount) AS average_discount, COUNT(DISTINCT o.o_orderkey) AS number_of_orders FROM region r JOIN orders o ON o.o_orderkey IN (SELECT l_orderkey FROM lineitem WHERE l_shipdate BETWEEN '1997-01-01' AND '1997-12-31') JOIN lineitem l ON l.l_orderkey = o.o_orderkey JOIN part p ON p.p_partkey = l.l_partkey JOIN partsupp ps ON ps.ps_partkey = p.p_partkey AND ps.ps_suppkey = l.l_suppkey WHERE p.p_size IN (15, 27, 30) AND r.r_regionkey IN (2, 4) AND l.l_shipdate BETWEEN '1997-01-01' AND '1997-12-31' GROUP BY r.r_name ORDER BY average_quantity DESC, average_discount DESC;
SELECT r_name AS region, n_name AS nation, COUNT(DISTINCT s_suppkey) AS num_suppliers, COUNT(DISTINCT c_custkey) AS num_customers, SUM(l_extendedprice * (1 - l_discount)) AS revenue, AVG(s_acctbal) AS avg_supplier_acctbal, AVG(c_acctbal) AS avg_customer_acctbal, AVG(p_retailprice) AS avg_part_retailprice, SUM(ps_availqty) AS total_partsupply_quantity, AVG(ps_supplycost) AS avg_partsupply_cost FROM region JOIN nation ON r_regionkey = n_regionkey JOIN supplier ON n_nationkey = s_nationkey JOIN customer ON n_nationkey = c_nationkey JOIN partsupp ON s_suppkey = ps_suppkey JOIN part ON ps_partkey = p_partkey JOIN lineitem ON l_suppkey = s_suppkey AND l_partkey = p_partkey JOIN orders ON o_orderkey = l_orderkey WHERE n_name IN ('KENYA', 'RUSSIA') AND l_shipdate BETWEEN '2020-01-01' AND '2020-12-31' AND o_orderstatus = 'F' AND l_returnflag = 'N' GROUP BY region, nation ORDER BY revenue DESC, avg_supplier_acctbal DESC, avg_customer_acctbal DESC;
SELECT r.r_name AS region, n.n_name AS nation, COUNT(DISTINCT ps.ps_suppkey) AS total_suppliers, SUM(l.l_extendedprice) AS total_sales, AVG(l.l_discount) AS average_discount, SUM(l.l_quantity) AS total_quantity FROM region r JOIN nation n ON r.r_regionkey = n.n_regionkey JOIN partsupp ps ON n.n_nationkey = ps.ps_suppkey JOIN lineitem l ON ps.ps_partkey = l.l_partkey AND ps.ps_suppkey = l.l_suppkey WHERE l.l_shipdate BETWEEN '2022-01-01' AND '2022-12-31' GROUP BY r.r_name, n.n_name ORDER BY total_sales DESC;
SELECT r_name AS region, n_name AS nation, COUNT(o_orderkey) AS total_orders, AVG(o_totalprice) AS avg_order_price, SUM(ps_availqty) AS total_available_parts, AVG(ps_supplycost) AS avg_part_supply_cost FROM orders JOIN nation ON o_custkey = n_nationkey JOIN region ON n_regionkey = r_regionkey JOIN supplier ON n_nationkey = s_nationkey JOIN partsupp ON s_suppkey = ps_suppkey GROUP BY r_name, n_name ORDER BY total_orders DESC, avg_order_price DESC LIMIT 10;
SELECT s.s_name, r.r_name AS region, COUNT(DISTINCT o.o_orderkey) AS total_orders, SUM(li.l_extendedprice) AS total_sales, AVG(li.l_quantity) AS avg_quantity_sold, SUM(li.l_extendedprice * (1 - li.l_discount)) AS revenue_after_discount, SUM(CASE WHEN li.l_shipmode = 'MAIL' THEN l_quantity ELSE 0 END) AS quantity_shipped_by_mail, SUM(CASE WHEN li.l_returnflag = 'R' THEN 1 ELSE 0 END) AS total_returns FROM supplier s JOIN customer c ON s.s_nationkey = c.c_nationkey JOIN orders o ON c.c_custkey = o.o_custkey JOIN lineitem li ON o.o_orderkey = li.l_orderkey JOIN part p ON li.l_partkey = p.p_partkey JOIN region r ON s.s_nationkey = r.r_regionkey WHERE li.l_shipmode IN ('FOB', 'MAIL', 'TRUCK') AND o.o_orderstatus IN ('F', 'O', 'P') AND li.l_tax IN (0.02, 0.07) AND p.p_type IN ('STANDARD ANODIZED COPPER', 'SMALL BRUSHED NICKEL', 'PROMO ANODIZED TIN', 'SMALL PLATED TIN') AND p.p_partkey IN (718, 4647, 4547, 3249, 4189) GROUP BY s.s_name, region ORDER BY total_sales DESC LIMIT 10;
SELECT r.r_name AS region, n.n_name AS nation, COUNT(DISTINCT c.c_custkey) AS number_of_customers, SUM(o.o_totalprice) AS total_sales, AVG(c.c_acctbal) AS average_customer_balance, AVG(l.l_quantity) AS average_quantity_ordered, SUM(l.l_extendedprice * (1 - l_discount)) AS revenue_after_discounts FROM customer c JOIN orders o ON c.c_custkey = o.o_custkey JOIN lineitem l ON o.o_orderkey = l.l_orderkey JOIN nation n ON c.c_nationkey = n.n_nationkey JOIN region r ON n.n_regionkey = r.r_regionkey WHERE r.r_name IN ('EUROPE', 'MIDDLE EAST', 'AFRICA', 'AMERICA') AND n.n_name = 'ETHIOPIA' AND n.n_nationkey IN ('21', '8') AND o.o_clerk IN ('Clerk#000015232', 'Clerk#000006604', 'Clerk#000022753', 'Clerk#000000797') AND o.o_custkey = '588251' AND EXISTS (SELECT 1 FROM part WHERE l.l_partkey = p_partkey AND p_comment LIKE '%dolphins%') GROUP BY r.r_name, n.n_name ORDER BY total_sales DESC, average_customer_balance DESC;
SELECT r.r_name AS region_name, COUNT(DISTINCT s.s_suppkey) AS supplier_count, COUNT(DISTINCT c.c_custkey) AS customer_count, AVG(c.c_acctbal) AS avg_customer_acctbal, SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_revenue, AVG(p.p_retailprice) AS avg_part_retailprice FROM region r JOIN supplier s ON r.r_regionkey = s.s_nationkey JOIN partsupp ps ON s.s_suppkey = ps.ps_suppkey JOIN part p ON ps.ps_partkey = p.p_partkey JOIN lineitem l ON p.p_partkey = l.l_partkey AND s.s_suppkey = l.l_suppkey JOIN orders o ON l.l_orderkey = o.o_orderkey JOIN customer c ON o.o_custkey = c.c_custkey AND c.c_nationkey = s.s_nationkey WHERE r.r_regionkey IN (1, 4, 0, 2, 3) AND p.p_size IN (36, 16, 18, 50, 22) AND l.l_shipmode IN ('AIR', 'SHIP') AND l.l_returnflag = 'N' AND c.c_phone LIKE '29-827-271-6785%' AND o.o_orderdate BETWEEN DATE '1995-01-01' AND DATE '1995-12-31' GROUP BY r.r_name ORDER BY total_revenue DESC;
SELECT r_name AS region, n_name AS nation, COUNT(DISTINCT s_suppkey) AS number_of_suppliers, COUNT(DISTINCT c_custkey) AS number_of_customers, AVG(s_acctbal) AS average_supplier_account_balance, AVG(c_acctbal) AS average_customer_account_balance, SUM(l_extendedprice) AS total_sales, SUM(l_extendedprice * (1 - l_discount)) AS total_sales_discounted, COUNT(DISTINCT o_orderkey) AS number_of_orders, AVG(l_quantity) AS average_quantity_ordered FROM region JOIN nation ON n_regionkey = r_regionkey JOIN supplier ON s_nationkey = n_nationkey JOIN customer ON c_nationkey = n_nationkey JOIN orders ON o_custkey = c_custkey JOIN lineitem ON l_orderkey = o_orderkey AND l_suppkey = s_suppkey GROUP BY region, nation ORDER BY total_sales DESC, number_of_orders DESC;
SELECT r_name AS region, p_type AS part_type, COUNT(DISTINCT s_suppkey) AS total_suppliers, COUNT(DISTINCT c_custkey) AS total_customers, SUM(l_extendedprice) AS sales_value, AVG(l_quantity) AS average_quantity, SUM(l_quantity * l_discount) AS total_discount_amount FROM region JOIN supplier ON s_nationkey = r_regionkey JOIN partsupp ON ps_suppkey = s_suppkey JOIN part ON ps_partkey = p_partkey JOIN lineitem ON l_partkey = p_partkey AND l_suppkey = s_suppkey JOIN orders ON o_orderkey = l_orderkey JOIN customer ON c_custkey = o_custkey AND c_nationkey = r_regionkey WHERE r_name IN ('EUROPE', 'AMERICA') AND p_type = 'SMALL BURNISHED STEEL' AND p_size IN (13, 16, 37) AND o_orderdate BETWEEN '2021-01-01' AND '2021-12-31' AND o_orderpriority IN ('1-URGENT', '3-MEDIUM') GROUP BY r_name, p_type ORDER BY sales_value DESC;
SELECT n.n_name AS nation, o.o_orderpriority AS order_priority, COUNT(DISTINCT o.o_orderkey) AS number_of_orders, SUM(l.l_quantity) AS total_quantity, SUM(l.l_extendedprice * (1 - l_discount)) AS total_revenue, AVG(l.l_quantity) AS average_quantity_per_order, AVG(l.l_extendedprice * (1 - l_discount)) AS average_revenue_per_order FROM nation AS n JOIN orders AS o ON n.n_nationkey = o.o_custkey JOIN lineitem AS l ON o.o_orderkey = l.l_orderkey WHERE n.n_name IN ('CHINA', 'INDONESIA') AND o.o_orderdate BETWEEN '1996-01-01' AND '1996-12-31' AND o.o_shippriority = '0' GROUP BY nation, order_priority ORDER BY total_revenue DESC;
SELECT r.r_name AS region, n.n_name AS nation, COUNT(DISTINCT s.s_suppkey) AS supplier_count, COUNT(DISTINCT c.c_custkey) AS customer_count, SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_revenue, AVG(l.l_quantity) AS average_quantity, AVG(l.l_extendedprice) AS average_price FROM region r JOIN nation n ON r.r_regionkey = n.n_regionkey JOIN supplier s ON n.n_nationkey = s.s_nationkey JOIN partsupp ps ON s.s_suppkey = ps.ps_suppkey JOIN lineitem l ON ps.ps_partkey = l.l_partkey AND ps.ps_suppkey = l.l_suppkey JOIN orders o ON l.l_orderkey = o.o_orderkey JOIN customer c ON o.o_custkey = c.c_custkey AND c.c_nationkey = n.n_nationkey WHERE r.r_name IN ('EUROPE', 'ASIA') AND o.o_orderdate BETWEEN DATE '1995-01-01' AND DATE '1995-12-31' AND l.l_shipdate > o.o_orderdate GROUP BY r.r_name, n.n_name ORDER BY total_revenue DESC, region, nation;
SELECT n.n_name AS nation_name, c.c_mktsegment AS market_segment, AVG(c.c_acctbal) AS avg_account_balance, COUNT(DISTINCT o.o_orderkey) AS total_orders, SUM(l.l_extendedprice * (1 - l_discount)) AS total_revenue FROM nation n JOIN customer c ON n.n_nationkey = c.c_nationkey JOIN orders o ON c.c_custkey = o.o_custkey JOIN lineitem l ON o.o_orderkey = l.l_orderkey WHERE n.n_regionkey = 2 AND o.o_orderstatus = 'F' AND l.l_shipdate BETWEEN '1995-01-01' AND '1996-12-31' GROUP BY nation_name, market_segment ORDER BY nation_name, market_segment;
SELECT r_name AS region, n_name AS nation, COUNT(DISTINCT s_suppkey) AS number_of_suppliers, COUNT(DISTINCT c_custkey) AS number_of_customers, SUM(l_extendedprice) AS total_sales, AVG(l_extendedprice * (1 - l_discount)) AS avg_discounted_sales, SUM(l_quantity) AS total_quantity_sold, AVG(l_quantity) AS avg_quantity_sold FROM region JOIN nation ON r_regionkey = n_regionkey JOIN supplier ON n_nationkey = s_nationkey JOIN customer ON n_nationkey = c_nationkey JOIN orders ON c_custkey = o_custkey JOIN lineitem ON o_orderkey = l_orderkey AND s_suppkey = l_suppkey GROUP BY region, nation ORDER BY total_sales DESC, avg_discounted_sales DESC LIMIT 10;
SELECT n.n_name AS nation, COUNT(DISTINCT c.c_custkey) AS number_of_customers, SUM(o.o_totalprice) AS total_sales, AVG(c.c_acctbal) AS average_account_balance FROM nation n JOIN customer c ON n.n_nationkey = c.c_nationkey JOIN orders o ON c.c_custkey = o.o_custkey JOIN region r ON n.n_regionkey = r.r_regionkey WHERE r.r_name = 'ASIA' AND o.o_totalprice > (SELECT AVG(o2.o_totalprice) FROM orders o2) GROUP BY n.n_name ORDER BY total_sales DESC, average_account_balance DESC;
SELECT r.r_name AS region_name, n.n_name AS nation_name, COUNT(s.s_suppkey) AS number_of_suppliers, SUM(ps.ps_availqty) AS total_availability, AVG(s.s_acctbal) AS average_account_balance, SUM(l.l_quantity) AS total_quantity_ordered, SUM((l.l_extendedprice * (1 - l.l_discount)) * (1 + l.l_tax)) AS total_revenue, AVG(l.l_discount) AS average_discount FROM region r JOIN nation n ON r.r_regionkey = n.n_regionkey JOIN supplier s ON n.n_nationkey = s.s_nationkey JOIN partsupp ps ON s.s_suppkey = ps.ps_suppkey JOIN lineitem l ON ps.ps_suppkey = l.l_suppkey AND ps.ps_partkey = l.l_partkey GROUP BY r.r_name, n.n_name ORDER BY total_revenue DESC, region_name, nation_name;
SELECT r.r_name AS region_name, c.c_mktsegment AS market_segment, COUNT(DISTINCT l.l_orderkey) AS number_of_orders, SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_sales, AVG(l.l_discount) AS average_discount, SUM(l.l_quantity) AS total_quantity_sold FROM region r JOIN customer c ON r.r_regionkey = c.c_nationkey JOIN lineitem l ON c.c_custkey = l.l_orderkey WHERE l.l_shipdate >= '2020-01-01' AND l.l_shipdate < '2021-01-01' GROUP BY r.r_name, c.c_mktsegment ORDER BY total_sales DESC, region_name, market_segment;
SELECT n.n_name AS nation_name, COUNT(DISTINCT ps.ps_partkey) AS total_parts_supplied, AVG(p.p_size) AS average_part_size, AVG(l.l_discount) AS average_discount FROM nation AS n JOIN partsupp AS ps ON n.n_nationkey = ps.ps_suppkey JOIN part AS p ON ps.ps_partkey = p.p_partkey JOIN lineitem AS l ON ps.ps_partkey = l.l_partkey AND ps.ps_suppkey = l.l_suppkey JOIN orders AS o ON l.l_orderkey = o.o_orderkey GROUP BY n.n_name ORDER BY n.n_name;
SELECT r.r_name AS region, c.c_mktsegment AS market_segment, COUNT(DISTINCT c.c_custkey) AS number_of_customers, SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_revenue, AVG(l.l_quantity) AS average_quantity_sold, AVG(ps.ps_supplycost) AS average_supply_cost, MAX(c.c_acctbal) AS max_customer_balance FROM region r JOIN customer c ON r.r_regionkey = c.c_nationkey JOIN lineitem l ON c.c_custkey = l.l_orderkey JOIN partsupp ps ON l.l_partkey = ps.ps_partkey AND l.l_suppkey = ps.ps_suppkey WHERE l.l_receiptdate BETWEEN '1993-01-01' AND '1998-12-31' GROUP BY r.r_name, c.c_mktsegment ORDER BY total_revenue DESC, average_quantity_sold DESC;
SELECT r_name AS region, c_mktsegment AS market_segment, COUNT(DISTINCT s_suppkey) AS number_of_suppliers, COUNT(DISTINCT c_custkey) AS number_of_customers, SUM(o_totalprice) AS total_sales, AVG(o_totalprice) AS avg_order_value, COUNT(DISTINCT o_orderkey) AS number_of_orders FROM region JOIN supplier ON supplier.s_nationkey = region.r_regionkey JOIN customer ON customer.c_nationkey = region.r_regionkey JOIN orders ON orders.o_custkey = customer.c_custkey WHERE r_regionkey = 0 GROUP BY r_name, c_mktsegment ORDER BY total_sales DESC;
SELECT r.r_name AS region_name, COUNT(DISTINCT s.s_suppkey) AS total_suppliers, COUNT(DISTINCT c.c_custkey) AS total_customers, SUM(o.o_totalprice) AS total_order_value, AVG(l.l_extendedprice * (1 - l_discount)) AS avg_discounted_price, COUNT(DISTINCT CASE WHEN l.l_receiptdate > o.o_orderdate THEN l.l_orderkey END) AS late_deliveries FROM region r JOIN supplier s ON s.s_nationkey = r.r_regionkey JOIN partsupp ps ON s.s_suppkey = ps.ps_suppkey JOIN lineitem l ON ps.ps_partkey = l.l_partkey AND ps.ps_suppkey = l.l_suppkey JOIN orders o ON l.l_orderkey = o.o_orderkey JOIN customer c ON o.o_custkey = c.c_custkey AND c.c_nationkey = s.s_nationkey GROUP BY r.r_name ORDER BY total_order_value DESC;
SELECT c.c_mktsegment, COUNT(DISTINCT c.c_custkey) AS num_customers, SUM(o.o_totalprice) AS total_sales, AVG(p.ps_supplycost) AS avg_supply_cost, MAX(o.o_totalprice) AS max_order_value, MIN(o.o_totalprice) AS min_order_value FROM customer c JOIN orders o ON c.c_custkey = o.o_custkey JOIN partsupp p ON p.ps_partkey = o.o_orderkey WHERE c.c_acctbal > 0 AND o.o_orderstatus = 'F' AND p.ps_availqty > 1000 GROUP BY c.c_mktsegment ORDER BY total_sales DESC;
SELECT n.n_name AS nation, COUNT(DISTINCT s.s_suppkey) AS number_of_suppliers, COUNT(DISTINCT c.c_custkey) AS number_of_customers, AVG(s.s_acctbal) AS avg_supplier_acctbal, AVG(c.c_acctbal) AS avg_customer_acctbal, SUM(li.l_quantity) AS total_quantity_sold, SUM(li.l_extendedprice * (1 - li.l_discount)) AS revenue_after_discount FROM nation n JOIN supplier s ON n.n_nationkey = s.s_nationkey JOIN customer c ON n.n_nationkey = c.c_nationkey JOIN lineitem li ON s.s_suppkey = li.l_suppkey WHERE n.n_name IN ('SAUDI ARABIA', 'MOROCCO', 'INDIA') AND li.l_shipdate BETWEEN '2022-01-01' AND '2022-12-31' GROUP BY n.n_name ORDER BY revenue_after_discount DESC;
SELECT r.r_name AS region, COUNT(DISTINCT c.c_custkey) AS num_customers, COUNT(DISTINCT p.p_partkey) AS num_parts, SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_revenue, AVG(l.l_quantity) AS avg_quantity_sold, AVG(ps.ps_supplycost) AS avg_supply_cost FROM region r JOIN customer c ON r.r_regionkey = c.c_nationkey JOIN lineitem l ON c.c_custkey = l.l_suppkey JOIN part p ON l.l_partkey = p.p_partkey JOIN partsupp ps ON p.p_partkey = ps.ps_partkey AND l.l_suppkey = ps.ps_suppkey WHERE r.r_name IN ('MIDDLE EAST', 'ASIA', 'EUROPE', 'AMERICA', 'AFRICA') AND p.p_container IN ('SM BOX', 'LG BAG') AND ps.ps_supplycost IN (631.31, 848.83) AND l.l_receiptdate BETWEEN '1994-01-01' AND '1997-12-31' GROUP BY r.r_name ORDER BY total_revenue DESC;
SELECT r.r_name as Region, n.n_name as Nation, COUNT(p.p_partkey) as TotalParts, AVG(p.p_retailprice) as AvgRetailPrice, SUM(o.o_totalprice) as TotalOrderPrice, COUNT(DISTINCT o.o_orderkey) as TotalOrders, MAX(o.o_totalprice) as MaxOrderPrice, MIN(o.o_totalprice) as MinOrderPrice FROM region r JOIN nation n ON r.r_regionkey = n.n_regionkey JOIN orders o ON o.o_orderdate BETWEEN '2020-01-01' AND '2020-12-31' JOIN part p ON p.p_size BETWEEN 30 AND 50 GROUP BY r.r_name, n.n_name ORDER BY TotalOrderPrice DESC, AvgRetailPrice DESC;
SELECT n.n_name AS nation_name, c.c_mktsegment AS market_segment, COUNT(c.c_custkey) AS customer_count, AVG(c.c_acctbal) AS avg_account_balance, SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_sales FROM customer c JOIN nation n ON c.c_nationkey = n.n_nationkey JOIN lineitem l ON c.c_custkey = l.l_orderkey GROUP BY nation_name, market_segment ORDER BY nation_name, market_segment;
SELECT n.n_name, c.c_mktsegment, AVG(c.c_acctbal) AS avg_acct_balance, COUNT(c.c_custkey) AS customer_count, SUM(li.l_extendedprice * (1 - li.l_discount)) AS total_sales FROM customer c JOIN nation n ON c.c_nationkey = n.n_nationkey JOIN lineitem li ON c.c_custkey = li.l_suppkey WHERE c.c_comment LIKE '%y across the accounts. even deposits try to cajo%' AND c.c_mktsegment IN ('HOUSEHOLD', 'BUILDING', 'AUTOMOBILE') GROUP BY n.n_name, c.c_mktsegment ORDER BY n.n_name, c.c_mktsegment;
SELECT r.r_name AS region_name, avg(c.c_acctbal) AS average_account_balance, sum(ps.ps_availqty) AS total_available_quantity, sum(p.p_retailprice * ps.ps_availqty) AS total_inventory_value, count(DISTINCT c.c_custkey) AS number_of_customers, count(DISTINCT p.p_partkey) AS number_of_parts FROM region r JOIN customer c ON c.c_nationkey = r.r_regionkey JOIN partsupp ps ON ps.ps_suppkey = c.c_custkey JOIN part p ON p.p_partkey = ps.ps_partkey WHERE r.r_name IN ('AFRICA', 'AMERICA') AND p.p_brand IN ('Brand#54', 'Brand#35', 'Brand#44') AND c.c_acctbal > 0 GROUP BY r.r_name ORDER BY total_inventory_value DESC;
SELECT s.s_nationkey, COUNT(DISTINCT o.o_orderkey) AS total_orders, SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_sales_volume, AVG(l.l_discount) AS average_discount, MIN(s.s_acctbal) AS min_supplier_account_balance, MAX(s.s_acctbal) AS max_supplier_account_balance FROM supplier s JOIN lineitem l ON s.s_suppkey = l.l_suppkey JOIN orders o ON l.l_orderkey = o.o_orderkey WHERE o.o_orderstatus = 'F' AND l.l_shipdate <= CURRENT_DATE AND s.s_nationkey IN (9, 2) GROUP BY s.s_nationkey ORDER BY total_sales_volume DESC;
SELECT n.n_name AS nation_name, p.p_type AS part_type, AVG(ps.ps_supplycost) AS avg_supply_cost, SUM(ps.ps_availqty) AS total_avail_qty, COUNT(DISTINCT p.p_partkey) AS num_parts FROM nation n JOIN partsupp ps ON n.n_nationkey = ps.ps_suppkey JOIN part p ON ps.ps_partkey = p.p_partkey WHERE n.n_name IN ('RUSSIA', 'INDONESIA', 'ETHIOPIA') AND p.p_type LIKE '%Widget%' AND p.p_size BETWEEN 10 AND 20 GROUP BY n.n_name, p.p_type ORDER BY avg_supply_cost DESC, total_avail_qty DESC;
SELECT c.c_mktsegment, p.p_brand, o.o_orderstatus, AVG(o.o_totalprice) AS avg_order_price, SUM(o.o_totalprice) AS total_sales, COUNT(DISTINCT c.c_custkey) AS unique_customers, COUNT(DISTINCT o.o_orderkey) AS total_orders FROM customer c JOIN orders o ON c.c_custkey = o.o_custkey JOIN supplier s ON c.c_nationkey = s.s_nationkey JOIN part p ON p.p_mfgr = 'Manufacturer#5' WHERE c.c_mktsegment IN ('MACHINERY', 'FURNITURE', 'BUILDING') AND o.o_orderstatus IN ('F', 'O') AND p.p_name IN ('drab almond powder chartreuse midnight', 'floral salmon saddle frosted wheat', 'sky cream cornflower magenta mint', 'maroon puff sandy lemon bisque') GROUP BY c.c_mktsegment, p.p_brand, o.o_orderstatus ORDER BY total_sales DESC, avg_order_price DESC, unique_customers DESC, total_orders DESC;
SELECT c.c_mktsegment, s.s_nationkey, count(*) AS total_orders, sum(l.l_extendedprice) AS total_revenue, avg(l.l_extendedprice) AS avg_order_value, sum(l.l_quantity) AS total_quantity, avg(l.l_discount) AS avg_discount FROM customer c JOIN lineitem l ON c.c_custkey = l.l_orderkey JOIN supplier s ON s.s_suppkey = l.l_suppkey JOIN part p ON p.p_partkey = l.l_partkey WHERE c.c_acctbal > 5000 AND s.s_acctbal < 8000 AND l.l_shipdate BETWEEN '1995-01-01' AND '1995-12-31' AND p.p_brand = 'Brand#22' GROUP BY c.c_mktsegment, s.s_nationkey ORDER BY total_revenue DESC, total_orders DESC;
SELECT s_name, s_address, AVG(p_retailprice) AS avg_retail_price, SUM(l_extendedprice) AS total_sales, COUNT(DISTINCT o_orderkey) AS total_orders FROM supplier JOIN partsupp ON supplier.s_suppkey = partsupp.ps_suppkey JOIN part ON partsupp.ps_partkey = part.p_partkey JOIN lineitem ON partsupp.ps_partkey = lineitem.l_partkey AND partsupp.ps_suppkey = lineitem.l_suppkey JOIN orders ON lineitem.l_orderkey = orders.o_orderkey WHERE lineitem.l_shipdate BETWEEN '1995-01-01' AND '1995-12-31' AND lineitem.l_discount BETWEEN 0.05 AND 0.07 AND lineitem.l_quantity < 24 GROUP BY s_name, s_address ORDER BY total_sales DESC, s_name LIMIT 10;
SELECT r.r_name AS region_name, EXTRACT(YEAR FROM l.l_shipdate) AS year_shipped, COUNT(*) AS total_items_sold, SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_sales, AVG(l.l_discount) AS average_discount FROM lineitem l JOIN supplier s ON l.l_suppkey = s.s_suppkey JOIN region r ON s.s_nationkey = r.r_regionkey GROUP BY r.r_name, EXTRACT(YEAR FROM l.l_shipdate) ORDER BY r.r_name, EXTRACT(YEAR FROM l.l_shipdate);
SELECT reg.r_name AS region_name, COUNT(DISTINCT cust.c_custkey) AS customer_count, AVG(cust.c_acctbal) AS average_customer_balance, COUNT(DISTINCT ord.o_orderkey) AS order_count, SUM(ord.o_totalprice) AS total_order_price FROM region reg JOIN nation nat ON reg.r_regionkey = nat.n_regionkey JOIN customer cust ON nat.n_nationkey = cust.c_nationkey JOIN orders ord ON cust.c_custkey = ord.o_custkey WHERE reg.r_regionkey = 2 AND ord.o_orderstatus = 'F' GROUP BY reg.r_name ORDER BY reg.r_name;
SELECT r.r_name AS region, n.n_name AS nation, COUNT(DISTINCT s.s_suppkey) AS total_suppliers, COUNT(DISTINCT p.p_partkey) AS total_parts, SUM(ps.ps_availqty) AS total_availability, AVG(ps.ps_supplycost) AS average_supply_cost, SUM(l.l_extendedprice) AS total_sales, AVG(l.l_quantity) AS average_quantity_sold, SUM(l.l_extendedprice * (1 - l_discount)) AS total_revenue_after_discount FROM region r JOIN nation n ON r.r_regionkey = n.n_regionkey JOIN supplier s ON n.n_nationkey = s.s_nationkey JOIN partsupp ps ON s.s_suppkey = ps.ps_suppkey JOIN part p ON ps.ps_partkey = p.p_partkey JOIN lineitem l ON p.p_partkey = l.l_partkey AND s.s_suppkey = l.l_suppkey JOIN orders o ON l.l_orderkey = o.o_orderkey WHERE p.p_type IN ('ECONOMY PLATED NICKEL', 'STANDARD BURNISHED NICKEL', 'SMALL BRUSHED STEEL') AND n.n_nationkey IN (10, 9, 11) AND o.o_orderdate BETWEEN date '1993-01-01' AND date '1994-01-01' GROUP BY r.r_name, n.n_name ORDER BY total_revenue_after_discount DESC, total_sales DESC;
SELECT r.r_name AS region, o.o_orderpriority AS order_priority, COUNT(DISTINCT o.o_orderkey) AS number_of_orders, SUM(l.l_quantity) AS total_quantity, AVG(l.l_extendedprice) AS avg_price, SUM(l.l_extendedprice * (1 - l_discount)) AS revenue_after_discount, SUM(CASE WHEN l.l_receiptdate > l.l_commitdate THEN 1 ELSE 0 END) AS late_receipts_count FROM orders o JOIN lineitem l ON o.o_orderkey = l.l_orderkey JOIN partsupp ps ON l.l_partkey = ps.ps_partkey AND l.l_suppkey = ps.ps_suppkey JOIN region r ON ps.ps_suppkey::varchar LIKE r.r_regionkey::varchar || '%' WHERE o.o_orderdate BETWEEN date '1993-01-01' AND date '1994-01-01' AND l.l_shipmode IN ('MAIL', 'SHIP') GROUP BY region, order_priority ORDER BY revenue_after_discount DESC, total_quantity DESC, number_of_orders DESC LIMIT 10;
SELECT p.p_type, AVG(ps.ps_supplycost) AS avg_supply_cost, COUNT(DISTINCT l.l_orderkey) AS num_orders, SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_revenue, SUM(CASE WHEN l.l_returnflag = 'R' THEN 1 ELSE 0 END) AS num_returns FROM part p JOIN partsupp ps ON p.p_partkey = ps.ps_partkey JOIN lineitem l ON p.p_partkey = l.l_partkey JOIN orders o ON l.l_orderkey = o.o_orderkey WHERE p.p_size BETWEEN 1 AND 15 AND l.l_shipdate BETWEEN date '1997-01-01' AND date '1997-12-31' AND o.o_orderdate >= date '1996-01-01' GROUP BY p.p_type ORDER BY total_revenue DESC, avg_supply_cost DESC
SELECT n_name AS nation, p_type AS part_type, AVG(l_discount) AS avg_discount, SUM(l_extendedprice) AS total_sales, COUNT(DISTINCT o_orderkey) AS number_of_orders, SUM(ps_supplycost * ps_availqty) AS total_supply_cost FROM lineitem JOIN orders ON l_orderkey = o_orderkey JOIN customer ON o_custkey = c_custkey JOIN nation ON c_nationkey = n_nationkey JOIN partsupp ON l_partkey = ps_partkey AND l_suppkey = ps_suppkey JOIN part ON l_partkey = p_partkey JOIN supplier ON l_suppkey = s_suppkey AND s_nationkey = n_nationkey WHERE l_shipdate BETWEEN date '1995-01-01' AND date '1995-12-31' AND p_size IN (17, 37) AND s_comment LIKE '%regular%' GROUP BY nation, part_type ORDER BY total_sales DESC, avg_discount ASC LIMIT 10;
SELECT r_name AS region, n_name AS nation, COUNT(DISTINCT s_suppkey) AS total_suppliers, COUNT(DISTINCT c_custkey) AS total_customers, SUM(l_extendedprice) AS total_sales, AVG(l_quantity) AS avg_quantity_sold, SUM(l_extendedprice * (1 - l_discount)) AS revenue_after_discount, SUM(CASE WHEN l_returnflag = 'R' THEN l_extendedprice * (1 - l_discount) ELSE 0 END) AS revenue_returned_items FROM region JOIN nation ON r_regionkey = n_regionkey JOIN supplier ON s_nationkey = n_nationkey JOIN customer ON c_nationkey = n_nationkey JOIN lineitem ON (s_suppkey = l_suppkey AND c_custkey = l_orderkey) GROUP BY region, nation ORDER BY total_sales DESC, revenue_after_discount DESC;
SELECT r.r_name AS region, n.n_name AS nation, COUNT(DISTINCT c.c_custkey) AS num_customers, COUNT(DISTINCT s.s_suppkey) AS num_suppliers, SUM(o.o_totalprice) AS total_order_value, AVG(l.l_extendedprice * (1 - l.l_discount)) AS avg_discounted_price, SUM(l.l_quantity) AS total_quantity_sold FROM region r JOIN nation n ON r.r_regionkey = n.n_regionkey JOIN customer c ON n.n_nationkey = c.c_nationkey JOIN orders o ON c.c_custkey = o.o_custkey JOIN lineitem l ON o.o_orderkey = l.l_orderkey JOIN supplier s ON n.n_nationkey = s.s_nationkey JOIN partsupp ps ON s.s_suppkey = ps.ps_suppkey AND l.l_partkey = ps.ps_partkey AND l.l_suppkey = ps.ps_suppkey GROUP BY r.r_name, n.n_name ORDER BY total_order_value DESC, avg_discounted_price DESC;
SELECT r.r_name AS region, n.n_name AS nation, COUNT(DISTINCT s.s_suppkey) AS total_suppliers, COUNT(DISTINCT c.c_custkey) AS total_customers, AVG(s.s_acctbal) AS avg_supplier_acctbal, AVG(c.c_acctbal) AS avg_customer_acctbal, SUM(l.l_extendedprice * (1 - l.l_discount)) AS revenue FROM region r JOIN nation n ON r.r_regionkey = n.n_regionkey JOIN supplier s ON n.n_nationkey = s.s_nationkey JOIN customer c ON n.n_nationkey = c.c_nationkey JOIN orders o ON c.c_custkey = o.o_custkey JOIN lineitem l ON o.o_orderkey = l.l_orderkey WHERE l.l_shipdate BETWEEN DATE '2022-01-01' AND DATE '2022-12-31' GROUP BY r.r_name, n.n_name ORDER BY revenue DESC LIMIT 5;
SELECT r_name AS region, n_name AS nation, COUNT(s_suppkey) AS supplier_count, AVG(s_acctbal) AS avg_account_balance, SUM(c_acctbal) AS total_customer_balance, COUNT(DISTINCT o_orderkey) AS total_orders, AVG(o_totalprice) AS avg_order_totalprice, MAX(p_retailprice) AS max_part_retailprice, MIN(p_retailprice) AS min_part_retailprice FROM region JOIN nation ON n_regionkey = r_regionkey JOIN supplier ON s_nationkey = n_nationkey JOIN customer ON c_nationkey = n_nationkey JOIN orders ON o_custkey = c_custkey JOIN part ON p_size BETWEEN 1 AND 5 WHERE n_nationkey IN (1, 20, 0) AND s_name IN ('Supplier#000017451', 'Supplier#000019689', 'Supplier#000017898', 'Supplier#000020289') AND p_mfgr IN ('Manufacturer#3', 'Manufacturer#4') AND p_type = 'STANDARD BURNISHED TIN' AND o_orderstatus = 'F' GROUP BY region, nation ORDER BY region, nation;
SELECT r.r_name AS region_name, COUNT(DISTINCT c.c_custkey) AS total_customers, AVG(c.c_acctbal) AS avg_account_balance, SUM(p.p_retailprice) AS sum_retail_price, AVG(ps.ps_supplycost) AS avg_supply_cost, COUNT(DISTINCT o.o_orderkey) AS total_orders, SUM(o.o_totalprice) AS sum_order_total, EXTRACT(YEAR FROM o.o_orderdate) AS order_year FROM region r JOIN customer c ON r.r_regionkey = c.c_nationkey JOIN orders o ON c.c_custkey = o.o_custkey JOIN partsupp ps ON ps.ps_suppkey = o.o_orderkey JOIN part p ON p.p_partkey = ps.ps_partkey WHERE r.r_regionkey IN (1, 3) AND o.o_orderstatus = 'F' AND ps.ps_supplycost < 500.00 GROUP BY region_name, order_year ORDER BY region_name, order_year;
SELECT r_name AS region, p_type AS part_type, COUNT(DISTINCT s_suppkey) AS number_of_suppliers, SUM(l_extendedprice) AS total_sales, AVG(s_acctbal) AS avg_supplier_acct_balance, SUM(ps_availqty) AS total_available_quantity, AVG(l_quantity) AS avg_quantity_ordered FROM region JOIN nation ON nation.n_regionkey = region.r_regionkey JOIN supplier ON supplier.s_nationkey = nation.n_nationkey JOIN partsupp ON partsupp.ps_suppkey = supplier.s_suppkey JOIN part ON part.p_partkey = partsupp.ps_partkey JOIN lineitem ON lineitem.l_partkey = part.p_partkey AND lineitem.l_suppkey = partsupp.ps_suppkey WHERE region.r_name = 'AMERICA' AND part.p_type IN ('PROMO BRUSHED COPPER', 'STANDARD PLATED STEEL', 'ECONOMY PLATED COPPER', 'STANDARD ANODIZED COPPER', 'SMALL ANODIZED STEEL') GROUP BY region, part_type ORDER BY total_sales DESC;
SELECT n.n_name AS nation, COUNT(o.o_orderkey) AS total_orders, SUM(l.l_extendedprice) AS total_revenue, SUM(l.l_extendedprice * (1 - l.l_discount)) AS discounted_revenue, AVG(l.l_quantity) AS average_quantity, AVG(l.l_extendedprice) AS average_price, AVG(c.c_acctbal) AS average_customer_balance FROM nation n JOIN customer c ON n.n_nationkey = c.c_nationkey JOIN orders o ON c.c_custkey = o.o_custkey JOIN lineitem l ON o.o_orderkey = l.l_orderkey WHERE n.n_regionkey = 3 AND o.o_orderstatus = 'F' AND l.l_shipdate >= DATE '2022-01-01' AND l.l_shipdate < DATE '2022-12-31' GROUP BY n.n_name ORDER BY total_revenue DESC;
SELECT r.r_name AS region, n.n_name AS nation, COUNT(DISTINCT s.s_suppkey) AS total_suppliers, SUM(l.l_extendedprice * (1 - l.l_discount)) AS revenue, AVG(l.l_quantity) AS average_quantity, AVG(l.l_extendedprice) AS average_price, COUNT(DISTINCT o.o_orderkey) AS total_orders FROM region r JOIN nation n ON r.r_regionkey = n.n_regionkey JOIN supplier s ON n.n_nationkey = s.s_nationkey JOIN partsupp ps ON s.s_suppkey = ps.ps_suppkey JOIN lineitem l ON ps.ps_partkey = l.l_partkey AND ps.ps_suppkey = l.l_suppkey JOIN orders o ON l.l_orderkey = o.o_orderkey WHERE r.r_name IN ('EUROPE', 'ASIA') AND o.o_orderpriority IN ('1-URGENT', '2-HIGH') AND l.l_shipinstruct = 'DELIVER IN PERSON' AND l.l_shipmode IN ('AIR', 'RAIL') GROUP BY r.r_name, n.n_name ORDER BY revenue DESC;
SELECT r_name AS region, n_name AS nation, COUNT(DISTINCT c_custkey) AS num_customers, COUNT(DISTINCT s_suppkey) AS num_suppliers, AVG(c_acctbal) AS avg_customer_acctbal, SUM(l_extendedprice * (1 - l_discount)) AS revenue, AVG(l_quantity) AS avg_quantity_sold FROM region JOIN nation ON n_regionkey = r_regionkey JOIN customer ON c_nationkey = n_nationkey JOIN orders ON o_custkey = c_custkey JOIN lineitem ON l_orderkey = o_orderkey JOIN supplier ON s_nationkey = n_nationkey JOIN partsupp ON ps_suppkey = s_suppkey WHERE n_regionkey IN ('2', '0', '3', '1') AND o_shippriority = '0' AND l_shipdate BETWEEN '2022-01-01' AND '2022-12-31' GROUP BY region, nation ORDER BY revenue DESC, region, nation LIMIT 10;
SELECT r_name AS region, n_name AS nation, COUNT(DISTINCT s_suppkey) AS total_suppliers, COUNT(DISTINCT c_custkey) AS total_customers, SUM(p_retailprice) AS total_parts_retail_price, AVG(ps_supplycost) AS avg_supply_cost, SUM(l_extendedprice * (1 - l_discount)) AS total_sales, AVG(l_quantity) AS avg_lineitem_quantity, COUNT(DISTINCT o_orderkey) AS total_orders FROM region JOIN nation ON r_regionkey = n_regionkey JOIN supplier ON n_nationkey = s_nationkey JOIN customer ON n_nationkey = c_nationkey JOIN partsupp ON s_suppkey = ps_suppkey JOIN part ON ps_partkey = p_partkey JOIN lineitem ON p_partkey = l_partkey AND s_suppkey = l_suppkey JOIN orders ON l_orderkey = o_orderkey AND c_custkey = o_custkey GROUP BY region, nation ORDER BY total_sales DESC, region, nation;
SELECT s.s_name, r.r_name AS region_name, SUM(li.l_extendedprice * (1 - li.l_discount)) AS total_revenue, AVG(ps.ps_supplycost) AS avg_supply_cost, COUNT(*) AS total_lineitem_count FROM supplier AS s JOIN region AS r ON s.s_nationkey = r.r_regionkey JOIN partsupp AS ps ON s.s_suppkey = ps.ps_suppkey JOIN part AS p ON ps.ps_partkey = p.p_partkey JOIN lineitem AS li ON p.p_partkey = li.l_partkey AND s.s_suppkey = li.l_suppkey WHERE r.r_name = 'EUROPE' AND p.p_size = 15 AND ps.ps_availqty > 5000 AND li.l_shipdate BETWEEN '1995-01-01' AND '1995-12-31' GROUP BY s.s_name, r.r_name ORDER BY total_revenue DESC;
SELECT r_name, COUNT(DISTINCT o_orderkey) AS total_orders, SUM(l_quantity) AS total_quantity, AVG(l_extendedprice) AS avg_price, SUM(l_extendedprice * (1 - l_discount) * (1 + l_tax)) AS total_revenue FROM region JOIN orders ON r_regionkey = o_orderkey % 5 JOIN lineitem ON o_orderkey = l_orderkey WHERE r_regionkey IN (1, 4, 0, 2, 3) AND l_shipdate BETWEEN '1995-01-01' AND '1996-12-31' AND o_orderstatus = 'F' GROUP BY r_name ORDER BY total_revenue DESC;
SELECT c.c_mktsegment, s.s_nationkey, COUNT(DISTINCT c.c_custkey) AS total_customers, SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_revenue, AVG(l.l_quantity) AS average_quantity, AVG(l.l_extendedprice) AS average_extended_price FROM customer c JOIN lineitem l ON c.c_custkey = l.l_suppkey JOIN supplier s ON l.l_suppkey = s.s_suppkey WHERE l.l_shipdate BETWEEN '1995-01-01' AND '1995-12-31' AND c.c_acctbal > 0 AND s.s_comment LIKE '%care%' GROUP BY c.c_mktsegment, s.s_nationkey ORDER BY total_revenue DESC, total_customers;
SELECT r.r_name AS region, n.n_name AS nation, COUNT(DISTINCT s.s_suppkey) AS num_suppliers, COUNT(DISTINCT c.c_custkey) AS num_customers, SUM(l.l_extendedprice * (1 - l.l_discount)) AS revenue, AVG(l.l_quantity) AS avg_quantity_sold, AVG(ps.ps_supplycost) AS avg_supply_cost FROM region r JOIN nation n ON r.r_regionkey = n.n_regionkey JOIN supplier s ON n.n_nationkey = s.s_nationkey JOIN customer c ON n.n_nationkey = c.c_nationkey JOIN orders o ON c.c_custkey = o.o_custkey JOIN lineitem l ON o.o_orderkey = l.l_orderkey JOIN partsupp ps ON l.l_partkey = ps.ps_partkey AND l.l_suppkey = ps.ps_suppkey WHERE r.r_name = 'ASIA' AND l.l_shipdate BETWEEN '1992-01-01' AND '1997-12-31' AND l.l_partkey IN ('2286', '1465', '695', '3828') GROUP BY r.r_name, n.n_name ORDER BY revenue DESC;
SELECT r.r_name AS region, COUNT(DISTINCT c.c_custkey) AS num_customers, COUNT(DISTINCT s.s_suppkey) AS num_suppliers, COUNT(DISTINCT o.o_orderkey) AS num_orders, SUM(p.p_retailprice * l.l_quantity) AS total_revenue, AVG(l.l_extendedprice * (1 - l.l_discount)) AS avg_disc_price, SUM(l.l_quantity) AS total_quantity, AVG(s.s_acctbal) AS avg_supplier_acctbal, AVG(c.c_acctbal) AS avg_customer_acctbal FROM region r JOIN supplier s ON s.s_nationkey = r.r_regionkey JOIN partsupp ps ON ps.ps_suppkey = s.s_suppkey JOIN part p ON p.p_partkey = ps.ps_partkey JOIN lineitem l ON l.l_partkey = p.p_partkey AND l.l_suppkey = s.s_suppkey JOIN orders o ON o.o_orderkey = l.l_orderkey JOIN customer c ON c.c_custkey = o.o_custkey WHERE p.p_container IN ('SM BAG', 'WRAP BAG', 'JUMBO PKG', 'MED BOX', 'SM BOX', 'SM DRUM') AND p.p_type IN ('LARGE ANODIZED NICKEL', 'MEDIUM ANODIZED TIN', 'ECONOMY BRUSHED TIN', 'PROMO ANODIZED COPPER', 'SMALL BRUSHED NICKEL') AND o.o_orderstatus = 'O' GROUP BY r.r_name ORDER BY total_revenue DESC;
SELECT r_name AS region, COUNT(DISTINCT c_custkey) AS total_customers, COUNT(DISTINCT o_orderkey) AS total_orders, SUM(l_extendedprice * (1 - l_discount)) AS total_revenue, AVG(l_quantity) AS average_quantity, AVG(l_extendedprice) AS average_order_value FROM region JOIN customer ON c_nationkey = r_regionkey JOIN orders ON o_custkey = c_custkey JOIN lineitem ON l_orderkey = o_orderkey WHERE l_shipmode IN ('SHIP', 'RAIL', 'TRUCK', 'FOB') AND l_shipdate BETWEEN '1996-01-01' AND '1996-12-31' GROUP BY r_name ORDER BY total_revenue DESC;
SELECT n.n_name AS nation_name, p.p_type AS part_type, COUNT(DISTINCT c.c_custkey) AS number_of_customers, SUM(p.p_retailprice * ps.ps_availqty) AS total_retail_value, AVG(ps.ps_supplycost) AS average_supply_cost, AVG(c.c_acctbal) AS average_customer_balance FROM nation n JOIN customer c ON n.n_nationkey = c.c_nationkey JOIN partsupp ps ON c.c_custkey = ps.ps_suppkey JOIN part p ON ps.ps_partkey = p.p_partkey GROUP BY nation_name, part_type ORDER BY total_retail_value DESC, average_supply_cost ASC LIMIT 10;
SELECT n.n_name AS nation, EXTRACT(YEAR FROM o.o_orderdate) AS order_year, COUNT(DISTINCT o.o_orderkey) AS total_orders, SUM(l.l_extendedprice) AS total_sales, AVG(l.l_extendedprice * (1 - l.l_discount)) AS avg_discounted_sales, SUM(l.l_quantity) AS total_quantity_sold, AVG(s.s_acctbal) AS avg_supplier_balance, AVG(c.c_acctbal) AS avg_customer_balance FROM nation n JOIN supplier s ON n.n_nationkey = s.s_nationkey JOIN partsupp ps ON s.s_suppkey = ps.ps_suppkey JOIN lineitem l ON ps.ps_partkey = l.l_partkey AND ps.ps_suppkey = l.l_suppkey JOIN orders o ON l.l_orderkey = o.o_orderkey JOIN customer c ON o.o_custkey = c.c_custkey WHERE n.n_name IN ('INDONESIA', 'JAPAN', 'ALGERIA', 'UNITED STATES', 'EGYPT', 'UNITED KINGDOM') AND c.c_phone IN ('30-866-194-9271', '33-773-557-6633', '29-216-836-3600') AND s.s_phone IN ('33-137-305-9447', '10-804-579-6434', '12-918-764-7526', '30-514-592-2334') AND o.o_orderdate >= '2020-01-01' GROUP BY nation, order_year ORDER BY nation, order_year DESC;
SELECT r.r_name AS region, COUNT(DISTINCT s.s_suppkey) AS total_suppliers, COUNT(DISTINCT c.c_custkey) AS total_customers, SUM(l.l_extendedprice * (1 - l.l_discount)) AS revenue, AVG(l.l_quantity) AS average_quantity, AVG(l.l_extendedprice) AS average_extended_price FROM region r JOIN nation n ON r.r_regionkey = n.n_regionkey JOIN supplier s ON n.n_nationkey = s.s_nationkey JOIN lineitem l ON s.s_suppkey = l.l_suppkey JOIN orders o ON l.l_orderkey = o.o_orderkey JOIN customer c ON o.o_custkey = c.c_custkey AND c.c_nationkey = n.n_nationkey WHERE o.o_orderpriority IN ('1-URGENT', '2-HIGH') AND l.l_shipdate BETWEEN DATE '1995-03-09' AND DATE '1995-03-09' + INTERVAL '1' YEAR AND s.s_suppkey IN ('951', '3041') AND s.s_address = 'aX3I7CNDAaUJZVx' GROUP BY region ORDER BY revenue DESC;
SELECT n.n_name, c.c_mktsegment, COUNT(DISTINCT c.c_custkey) AS total_customers, AVG(c.c_acctbal) AS average_account_balance, SUM(ps.ps_availqty) AS total_available_quantity, AVG(ps.ps_supplycost) AS average_supply_cost FROM nation n JOIN customer c ON n.n_nationkey = c.c_nationkey JOIN partsupp ps ON c.c_nationkey = ps.ps_suppkey WHERE n.n_regionkey IN (1, 2, 3) AND c.c_acctbal > 5000 AND ps.ps_supplycost < 700 GROUP BY n.n_name, c.c_mktsegment ORDER BY total_customers DESC, average_account_balance DESC;
SELECT r.r_name AS region_name, n.n_name AS nation_name, COUNT(p.p_partkey) AS total_parts, AVG(p.p_retailprice) AS average_retail_price, SUM(p.p_size) AS total_size FROM nation AS n JOIN region AS r ON n.n_regionkey = r.r_regionkey JOIN part AS p ON p.p_mfgr = 'Manufacturer#1' OR p.p_mfgr = 'Manufacturer#4' WHERE n.n_name IN ('ETHIOPIA', 'JAPAN', 'VIETNAM', 'JORDAN', 'IRAQ', 'RUSSIA') AND r.r_name IN ('MIDDLE EAST', 'EUROPE') AND p.p_comment LIKE 'r ideas cajole%' OR p.p_comment LIKE 'above the ironic, regu%' GROUP BY region_name, nation_name ORDER BY average_retail_price DESC, total_parts DESC;
SELECT n_name AS nation, COUNT(DISTINCT c_custkey) AS number_of_customers, AVG(c_acctbal) AS average_account_balance, SUM(o_totalprice) AS total_order_value FROM nation JOIN customer ON n_nationkey = c_nationkey JOIN orders ON c_custkey = o_custkey WHERE n_name IN ('IRAQ', 'GERMANY') AND o_orderdate BETWEEN '1995-01-01' AND '1995-12-31' GROUP BY n_name ORDER BY total_order_value DESC, average_account_balance DESC;
SELECT r.r_name AS region, n.n_name AS nation, AVG(s.s_acctbal) AS avg_supplier_balance, COUNT(DISTINCT s.s_suppkey) AS total_suppliers, COUNT(DISTINCT c.c_custkey) AS total_customers, SUM(p.p_retailprice * ps.ps_availqty) AS total_parts_value, SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_sales, AVG(l.l_quantity) AS avg_lineitem_quantity, COUNT(DISTINCT o.o_orderkey) AS total_orders FROM region r JOIN nation n ON r.r_regionkey = n.n_regionkey JOIN supplier s ON n.n_nationkey = s.s_nationkey JOIN customer c ON n.n_nationkey = c.c_nationkey JOIN partsupp ps ON s.s_suppkey = ps.ps_suppkey JOIN part p ON ps.ps_partkey = p.p_partkey JOIN lineitem l ON p.p_partkey = l.l_partkey AND s.s_suppkey = l.l_suppkey JOIN orders o ON l.l_orderkey = o.o_orderkey AND c.c_custkey = o.o_custkey GROUP BY r.r_name, n.n_name ORDER BY total_sales DESC, avg_supplier_balance DESC LIMIT 10;
SELECT r.r_name AS region_name, COUNT(DISTINCT s.s_suppkey) AS total_suppliers, SUM(ps.ps_availqty) AS total_available_quantity, AVG(ps.ps_supplycost) AS average_supply_cost, SUM(s.s_acctbal) AS total_supplier_balance FROM region r INNER JOIN nation n ON r.r_regionkey = n.n_regionkey INNER JOIN supplier s ON n.n_nationkey = s.s_nationkey INNER JOIN partsupp ps ON s.s_suppkey = ps.ps_suppkey GROUP BY r.r_name ORDER BY total_available_quantity DESC, average_supply_cost
SELECT r.r_name AS region_name, n.n_name AS nation_name, COUNT(DISTINCT s.s_suppkey) AS number_of_suppliers, COUNT(DISTINCT c.c_custkey) AS number_of_customers, SUM(l.l_extendedprice) AS total_sales_value, AVG(l.l_quantity) AS average_quantity_sold, SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_revenue_after_discount, AVG(l.l_discount) AS average_discount_given FROM region r JOIN nation n ON r.r_regionkey = n.n_regionkey JOIN supplier s ON n.n_nationkey = s.s_nationkey JOIN customer c ON n.n_nationkey = c.c_nationkey JOIN orders o ON c.c_custkey = o.o_custkey JOIN lineitem l ON o.o_orderkey = l.l_orderkey WHERE r.r_regionkey = 2 AND n.n_comment LIKE '%ven packages wake quickly. regu%' AND ( s.s_comment LIKE '%t the closely ironic packages. fluff%' OR s.s_comment LIKE '%accounts after the furious%' OR s.s_comment LIKE '%ecial deposits cajole slyly even ideas. furious%' OR s.s_comment LIKE '%ns. ironic ideas cajole. sl%' OR s.s_comment LIKE '%nto beans. stealthily final%' ) GROUP BY r.r_name, n.n_name ORDER BY total_sales_value DESC;
SELECT c.c_mktsegment, EXTRACT(YEAR FROM o.o_orderdate) AS order_year, COUNT(DISTINCT o.o_orderkey) AS total_orders, SUM(o.o_totalprice) AS total_revenue, AVG(o.o_totalprice) AS average_order_value, SUM(s.s_acctbal) AS total_supplier_balance, COUNT(DISTINCT s.s_suppkey) AS total_suppliers FROM customer c JOIN orders o ON c.c_custkey = o.o_custkey JOIN supplier s ON c.c_nationkey = s.s_nationkey WHERE o.o_orderstatus = 'F' AND c.c_mktsegment IN ('HOUSEHOLD', 'BUILDING', 'FURNITURE', 'AUTOMOBILE') AND o.o_orderdate BETWEEN '2020-01-01' AND '2023-01-01' GROUP BY c.c_mktsegment, order_year ORDER BY total_revenue DESC, c.c_mktsegment, order_year;
SELECT r.r_name AS region_name, c.c_mktsegment AS market_segment, COUNT(c.c_custkey) AS customer_count, SUM(c.c_acctbal) AS total_account_balance, AVG(c.c_acctbal) AS average_account_balance FROM customer AS c JOIN partsupp AS ps ON c.c_nationkey = ps.ps_partkey JOIN region AS r ON ps.ps_suppkey = r.r_regionkey GROUP BY region_name, market_segment ORDER BY region_name, market_segment;
SELECT c.c_mktsegment, COUNT(DISTINCT o.o_orderkey) AS total_orders, AVG(c.c_acctbal) AS avg_acct_balance, SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_revenue FROM customer c JOIN orders o ON c.c_custkey = o.o_custkey JOIN lineitem l ON o.o_orderkey = l.l_orderkey WHERE c.c_acctbal > 0.00 AND l.l_shipinstruct = 'DELIVER IN PERSON' GROUP BY c.c_mktsegment ORDER BY total_revenue DESC;
SELECT r.r_name AS region, COUNT(DISTINCT s.s_suppkey) AS total_suppliers, AVG(ps.ps_supplycost) AS average_supply_cost, SUM(ps.ps_availqty) AS total_quantity_available FROM supplier s INNER JOIN nation n ON s.s_nationkey = n.n_nationkey INNER JOIN region r ON n.n_regionkey = r.r_regionkey INNER JOIN partsupp ps ON s.s_suppkey = ps.ps_suppkey GROUP BY r.r_name ORDER BY average_supply_cost DESC, total_quantity_available DESC;
SELECT r_name AS region, n_name AS nation, COUNT(DISTINCT s_suppkey) AS number_of_suppliers, COUNT(DISTINCT c_custkey) AS number_of_customers, SUM(l_extendedprice * (1 - l_discount)) AS total_sales, AVG(ps_supplycost) AS average_supply_cost, AVG(l_quantity) AS average_quantity_sold, COUNT(DISTINCT o_orderkey) AS number_of_orders FROM region JOIN nation ON r_regionkey = n_regionkey JOIN supplier ON n_nationkey = s_nationkey JOIN customer ON n_nationkey = c_nationkey JOIN orders ON c_custkey = o_custkey JOIN lineitem ON o_orderkey = l_orderkey JOIN partsupp ON l_partkey = ps_partkey AND l_suppkey = ps_suppkey WHERE r_name = 'AMERICA' AND l_shipinstruct IN ('COLLECT COD', 'TAKE BACK RETURN') AND o_orderdate BETWEEN '1995-01-01' AND '1995-12-31' AND l_linestatus = 'F' GROUP BY region, nation ORDER BY total_sales DESC;
SELECT n.n_name AS nation, COUNT(o.o_orderkey) AS total_orders, AVG(o.o_totalprice) AS avg_order_value, SUM(c.c_acctbal) AS total_customer_balance, COUNT(DISTINCT c.c_custkey) AS num_customers FROM nation n JOIN customer c ON n.n_nationkey = c.c_nationkey JOIN orders o ON c.c_custkey = o.o_custkey WHERE n.n_regionkey IN (3, 2, 0) AND o.o_orderstatus = 'F' GROUP BY n.n_name ORDER BY total_orders DESC, avg_order_value DESC;
SELECT n.n_name AS nation, COUNT(DISTINCT s.s_suppkey) AS number_of_suppliers, COUNT(DISTINCT c.c_custkey) AS number_of_customers, AVG(s.s_acctbal) AS avg_supplier_acctbal, AVG(c.c_acctbal) AS avg_customer_acctbal FROM nation n LEFT JOIN supplier s ON n.n_nationkey = s.s_nationkey LEFT JOIN customer c ON n.n_nationkey = c.c_nationkey WHERE c.c_mktsegment = 'HOUSEHOLD' GROUP BY n.n_name ORDER BY n.n_name;
SELECT r.r_name AS region, n.n_name AS nation, COUNT(DISTINCT s.s_suppkey) AS num_suppliers, SUM(s.s_acctbal) AS total_acct_balance, AVG(l.l_quantity) AS avg_quantity_sold, SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_revenue, COUNT(DISTINCT o.o_orderkey) AS num_orders FROM region r JOIN nation n ON r.r_regionkey = n.n_regionkey JOIN supplier s ON n.n_nationkey = s.s_nationkey JOIN lineitem l ON s.s_suppkey = l.l_suppkey JOIN orders o ON l.l_orderkey = o.o_orderkey WHERE r.r_regionkey = 3 AND o.o_shippriority = 0 AND s.s_acctbal > 1000 AND n.n_name IN ('INDONESIA', 'ETHIOPIA', 'EGYPT', 'KENYA', 'INDIA') GROUP BY region, nation ORDER BY total_revenue DESC;
SELECT r_name AS region, n_name AS nation, c_mktsegment AS market_segment, COUNT(DISTINCT c_custkey) AS num_customers, SUM(l_extendedprice * (1 - l_discount)) AS total_revenue, AVG(c_acctbal) AS avg_account_balance, SUM(ps_availqty) AS total_available_quantity FROM customer JOIN nation ON customer.c_nationkey = nation.n_nationkey JOIN region ON nation.n_regionkey = region.r_regionkey JOIN lineitem ON customer.c_custkey IN (SELECT c_custkey FROM customer WHERE c_comment LIKE '%blithely%') JOIN partsupp ON lineitem.l_partkey = partsupp.ps_partkey AND lineitem.l_suppkey = partsupp.ps_suppkey WHERE c_mktsegment IN ('HOUSEHOLD', 'AUTOMOBILE', 'MACHINERY') AND nation.n_regionkey IN (1, 2) AND l_receiptdate >= '1996-09-16' AND ps_supplycost = 696.10 GROUP BY region, nation, market_segment ORDER BY total_revenue DESC, avg_account_balance DESC;
SELECT n.n_name, AVG(c.c_acctbal) AS average_account_balance, COUNT(DISTINCT c.c_custkey) AS total_customers, SUM(p.p_retailprice) AS total_retail_price, COUNT(DISTINCT p.p_partkey) AS total_parts FROM nation AS n JOIN customer AS c ON n.n_nationkey = c.c_nationkey JOIN part AS p ON c.c_custkey = p.p_partkey WHERE n.n_nationkey IN (1, 9, 20, 22, 23) GROUP BY n.n_name ORDER BY average_account_balance DESC, total_retail_price DESC;
SELECT r.r_name AS region, n.n_name AS nation, COUNT(DISTINCT s.s_suppkey) AS supplier_count, AVG(s.s_acctbal) AS average_account_balance, SUM(o.o_totalprice) AS total_sales, AVG(p.p_retailprice) AS average_part_price FROM region r JOIN nation n ON r.r_regionkey = n.n_regionkey JOIN supplier s ON n.n_nationkey = s.s_nationkey JOIN orders o ON s.s_suppkey = o.o_custkey JOIN part p ON o.o_orderkey = p.p_partkey WHERE r.r_name IN ('EUROPE', 'AMERICA') AND o.o_orderdate BETWEEN '1995-01-01' AND '1995-12-31' AND p.p_container IN ('JUMBO BOX', 'LG PACK') AND p.p_type LIKE '%STEEL' GROUP BY r.r_name, n.n_name ORDER BY total_sales DESC, average_account_balance DESC LIMIT 10;
SELECT r_name AS region, n_name AS nation, COUNT(DISTINCT c_custkey) AS num_customers, COUNT(DISTINCT s_suppkey) AS num_suppliers, SUM(l_quantity) AS total_quantity_ordered, AVG(l_extendedprice) AS average_order_price, SUM(l_extendedprice * (1 - l_discount)) AS revenue_after_discount FROM region JOIN nation ON n_regionkey = r_regionkey JOIN supplier ON s_nationkey = n_nationkey JOIN customer ON c_nationkey = n_nationkey JOIN orders ON o_custkey = c_custkey JOIN lineitem ON l_orderkey = o_orderkey JOIN part ON l_partkey = p_partkey WHERE o_orderpriority = '5-LOW' AND o_orderstatus = 'F' AND p_retailprice IN (1426.52, 1454.54, 1027.11, 1681.77, 1790.88, 1465.56) AND n_nationkey IN (7, 4) AND r_regionkey IN (1, 4, 0, 2, 3) GROUP BY region, nation ORDER BY revenue_after_discount DESC;
SELECT r.r_name AS region_name, n.n_name AS nation_name, COUNT(DISTINCT ps.ps_suppkey) AS number_of_suppliers, AVG(ps.ps_supplycost) AS average_supply_cost, SUM(ps.ps_availqty) AS total_available_quantity FROM region r JOIN nation n ON r.r_regionkey = n.n_regionkey JOIN partsupp ps ON n.n_nationkey = ps.ps_suppkey GROUP BY r.r_name, n.n_name ORDER BY r.r_name, n.n_name;
SELECT r.r_name AS region, n.n_name AS nation, COUNT(DISTINCT s.s_suppkey) AS number_of_suppliers, SUM(o.o_totalprice) AS total_order_value, AVG(s.s_acctbal) AS average_account_balance, COUNT(DISTINCT o.o_orderkey) AS number_of_orders FROM region r JOIN nation n ON r.r_regionkey = n.n_regionkey JOIN supplier s ON n.n_nationkey = s.s_nationkey JOIN orders o ON o.o_orderdate = '1998-03-10' AND o.o_shippriority = 0 WHERE n.n_name IN ('PERU', 'CHINA', 'UNITED KINGDOM', 'ARGENTINA') AND s.s_phone IN ('29-801-508-2424', '34-464-540-2356', '15-284-743-3951') GROUP BY region, nation ORDER BY total_order_value DESC, average_account_balance DESC;
SELECT r_name AS region, n_name AS nation, COUNT(DISTINCT ps_suppkey) AS supplier_count, SUM(ps_availqty) AS total_avail_qty, AVG(ps_supplycost) AS avg_supply_cost, SUM(l_extendedprice) AS total_extended_price, SUM(l_extendedprice * (1 - l_discount)) AS total_discounted_price, AVG(l_quantity) AS avg_quantity_ordered FROM region JOIN nation ON n_regionkey = r_regionkey JOIN partsupp ON ps_suppkey = n_nationkey JOIN lineitem ON l_partkey = ps_partkey AND l_suppkey = ps_suppkey WHERE r_comment LIKE '%final%' AND l_shipdate BETWEEN '2022-01-01' AND '2022-12-31' GROUP BY region, nation ORDER BY total_discounted_price DESC LIMIT 10;
SELECT r.r_name AS region, COUNT(DISTINCT s.s_suppkey) AS number_of_suppliers, COUNT(DISTINCT c.c_custkey) AS number_of_customers, COUNT(DISTINCT p.p_partkey) AS number_of_parts, SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_revenue, AVG(l.l_quantity) AS average_quantity, AVG(l.l_extendedprice) AS average_extendedprice, AVG(l.l_discount) AS average_discount FROM region r JOIN supplier s ON r.r_regionkey = s.s_nationkey JOIN partsupp ps ON s.s_suppkey = ps.ps_suppkey JOIN part p ON ps.ps_partkey = p.p_partkey JOIN lineitem l ON p.p_partkey = l.l_partkey AND ps.ps_suppkey = l.l_suppkey JOIN orders o ON l.l_orderkey = o.o_orderkey JOIN customer c ON o.o_custkey = c.c_custkey AND s.s_nationkey = c.c_nationkey GROUP BY r.r_name ORDER BY total_revenue DESC;
SELECT n.n_name AS nation_name, COUNT(DISTINCT c.c_custkey) AS number_of_customers, SUM(o.o_totalprice) AS total_sales, AVG(o.o_totalprice) AS average_order_value, COUNT(DISTINCT o.o_orderkey) AS number_of_orders FROM nation AS n JOIN customer AS c ON n.n_nationkey = c.c_nationkey JOIN orders AS o ON c.c_custkey = o.o_custkey WHERE n.n_regionkey IN (1, 4, 0, 2, 3) AND n.n_name = 'FRANCE' AND o.o_orderdate BETWEEN '1995-01-01' AND '1996-12-31' GROUP BY n.n_name ORDER BY total_sales DESC;
SELECT r_name AS region, n_name AS nation, COUNT(DISTINCT c_custkey) AS num_customers, COUNT(DISTINCT s_suppkey) AS num_suppliers, SUM(l_extendedprice) AS total_sales, AVG(l_extendedprice * (1 - l_discount)) AS avg_discounted_sales, SUM(l_quantity) AS total_quantity_sold, AVG(p_retailprice) AS avg_retail_price FROM region JOIN nation ON r_regionkey = n_regionkey JOIN supplier ON s_nationkey = n_nationkey JOIN customer ON c_nationkey = n_nationkey JOIN orders ON o_custkey = c_custkey JOIN lineitem ON l_orderkey = o_orderkey JOIN part ON p_partkey = l_partkey JOIN partsupp ON ps_partkey = p_partkey AND ps_suppkey = s_suppkey WHERE r_name IN ('MIDDLE EAST', 'ASIA', 'EUROPE') AND o_orderstatus = 'F' AND l_shipmode IN ('AIR', 'RAIL') AND p_type IN ('SMALL BURNISHED BRASS', 'LARGE ANODIZED STEEL', 'STANDARD PLATED COPPER') AND l_returnflag = 'R' GROUP BY r_name, n_name ORDER BY total_sales DESC, num_customers DESC, num_suppliers DESC;
SELECT r_name AS region, n_name AS nation, COUNT(DISTINCT s_suppkey) AS number_of_suppliers, AVG(s_acctbal) AS average_account_balance, SUM(o_totalprice) AS total_order_value, COUNT(DISTINCT o_orderkey) AS number_of_orders, AVG(ps_supplycost) AS average_supply_cost, SUM(ps_availqty) AS total_available_quantity FROM region JOIN nation ON r_regionkey = n_regionkey JOIN supplier ON s_nationkey = n_nationkey JOIN partsupp ON s_suppkey = ps_suppkey JOIN orders ON s_nationkey = o_custkey WHERE r_name IN ('ASIA', 'AMERICA') AND o_orderpriority IN ('1-URGENT', '2-HIGH') AND n_name IN ('UNITED STATES', 'JAPAN') GROUP BY region, nation ORDER BY total_order_value DESC, number_of_suppliers DESC;
SELECT r.r_name AS region, c.c_mktsegment AS market_segment, COUNT(DISTINCT c.c_custkey) AS number_of_customers, AVG(c.c_acctbal) AS average_account_balance, SUM(o.o_totalprice) AS total_sales, COUNT(DISTINCT o.o_orderkey) AS number_of_orders, AVG(p.p_retailprice) AS average_retail_price_of_parts_ordered FROM customer c JOIN orders o ON c.c_custkey = o.o_custkey JOIN part p ON o.o_orderkey = p.p_partkey JOIN region r ON c.c_nationkey = r.r_regionkey WHERE c.c_acctbal > 6000 AND r.r_name IN ('MIDDLE EAST', 'ASIA', 'EUROPE', 'AMERICA', 'AFRICA') AND o.o_orderdate BETWEEN '1993-01-01' AND '1998-12-31' AND c.c_mktsegment IN ('BUILDING', 'HOUSEHOLD', 'AUTOMOBILE') GROUP BY r.r_name, c.c_mktsegment ORDER BY total_sales DESC, average_account_balance DESC;
SELECT r.r_name AS region, c.c_mktsegment AS market_segment, COUNT(DISTINCT c.c_custkey) AS number_of_customers, SUM(c.c_acctbal) AS total_balance, AVG(c.c_acctbal) AS average_balance, SUM(ps.ps_availqty) AS total_available_parts, AVG(ps.ps_supplycost) AS average_supply_cost, COUNT(DISTINCT ps.ps_partkey) AS number_of_parts FROM region r JOIN customer c ON r.r_regionkey = c.c_nationkey JOIN partsupp ps ON c.c_custkey = ps.ps_suppkey WHERE r.r_name IN ('MIDDLE EAST', 'AFRICA', 'AMERICA', 'EUROPE') AND ps.ps_availqty > 1000 GROUP BY r.r_name, c.c_mktsegment ORDER BY total_balance DESC, average_supply_cost ASC;
SELECT r.r_name AS region_name, COUNT(DISTINCT o.o_orderkey) AS total_orders, SUM(o.o_totalprice) AS total_sales, AVG(ps.ps_supplycost) AS average_supply_cost, SUM(ps.ps_availqty) AS total_available_quantity FROM region r JOIN orders o ON r.r_regionkey = o.o_custkey JOIN partsupp ps ON o.o_orderkey = ps.ps_partkey WHERE r.r_name IN ('AMERICA', 'EUROPE', 'ASIA') AND o.o_orderstatus = 'F' AND o.o_orderdate BETWEEN '1995-01-01' AND '1996-12-31' GROUP BY r.r_name ORDER BY total_sales DESC;
SELECT r.r_name AS region, COUNT(DISTINCT n.n_nationkey) AS number_of_nations, SUM(c.c_acctbal) AS total_cust_balance, AVG(s.s_acctbal) AS avg_supp_balance, COUNT(DISTINCT l.l_orderkey) AS number_of_orders, SUM(l.l_extendedprice * (1 - l.l_discount)) AS revenue, AVG(l.l_quantity) AS avg_quantity_sold FROM region r JOIN nation n ON r.r_regionkey = n.n_regionkey JOIN supplier s ON n.n_nationkey = s.s_nationkey JOIN customer c ON n.n_nationkey = c.c_nationkey JOIN orders o ON c.c_custkey = o.o_custkey AND o.o_orderstatus = 'F' JOIN lineitem l ON o.o_orderkey = l.l_orderkey WHERE r.r_regionkey IN (1, 4, 0, 2, 3) AND l.l_shipdate >= '1997-01-01' AND l.l_shipdate < '1998-01-01' GROUP BY region ORDER BY revenue DESC;
SELECT c.c_mktsegment AS customer_market_segment, COUNT(DISTINCT c.c_custkey) AS number_of_customers, COUNT(l.l_orderkey) AS number_of_orders, SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_spent, AVG(l.l_discount) AS average_discount FROM customer c JOIN lineitem l ON c.c_custkey = l.l_suppkey JOIN partsupp ps ON l.l_partkey = ps.ps_partkey AND l.l_suppkey = ps.ps_suppkey JOIN supplier s ON ps.ps_suppkey = s.s_suppkey JOIN part p ON l.l_partkey = p.p_partkey WHERE s.s_nationkey = 1 GROUP BY c.c_mktsegment ORDER BY total_spent DESC;
SELECT r_name AS region, n_name AS nation, COUNT(DISTINCT s_suppkey) AS total_suppliers, COUNT(DISTINCT c_custkey) AS total_customers, SUM(l_extendedprice * (1 - l_discount)) AS total_revenue, AVG(l_quantity) AS average_quantity_sold, AVG(ps_supplycost) AS average_supply_cost, SUM(ps_availqty) AS total_available_quantity, MAX(p_retailprice) AS maximum_retail_price FROM region JOIN nation ON n_regionkey = r_regionkey JOIN supplier ON s_nationkey = n_nationkey JOIN customer ON c_nationkey = n_nationkey JOIN orders ON o_custkey = c_custkey JOIN lineitem ON l_orderkey = o_orderkey JOIN part ON p_partkey = l_partkey JOIN partsupp ON ps_partkey = p_partkey AND ps_suppkey = s_suppkey WHERE p_type IN ('LARGE ANODIZED NICKEL', 'ECONOMY BURNISHED TIN') AND ps_supplycost BETWEEN 178.72 AND 930.08 AND n_nationkey IN (11, 8, 22) AND l_commitdate BETWEEN '1994-01-01' AND '1998-12-31' GROUP BY region, nation ORDER BY total_revenue DESC;
SELECT r.r_name AS region_name, n.n_name AS nation_name, COUNT(DISTINCT o.o_orderkey) AS total_orders, AVG(o.o_totalprice) AS avg_order_value, SUM(ps.ps_availqty) AS total_avail_qty FROM region r JOIN nation n ON r.r_regionkey = n.n_regionkey JOIN supplier s ON n.n_nationkey = s.s_nationkey JOIN partsupp ps ON s.s_suppkey = ps.ps_suppkey JOIN lineitem l ON ps.ps_partkey = l.l_partkey AND ps.ps_suppkey = l.l_suppkey JOIN orders o ON l.l_orderkey = o.o_orderkey WHERE o.o_shippriority <> '0' AND o.o_orderpriority IN ('2-HIGH', '5-LOW') GROUP BY r.r_name, n.n_name ORDER BY total_orders DESC, avg_order_value DESC, total_avail_qty DESC;
SELECT n_name, c_mktsegment, COUNT(DISTINCT o_orderkey) AS total_orders, SUM(l_extendedprice) AS total_sales, AVG(l_extendedprice * (1 - l_discount)) AS avg_discounted_sales, SUM(l_quantity) AS total_quantity FROM customer JOIN orders ON c_custkey = o_custkey JOIN lineitem ON o_orderkey = l_orderkey JOIN nation ON c_nationkey = n_nationkey WHERE o_orderdate BETWEEN date '1994-01-01' AND date '1995-01-01' AND l_shipdate > o_orderdate AND c_mktsegment IN ('HOUSEHOLD', 'AUTOMOBILE', 'BUILDING', 'MACHINERY', 'FURNITURE') GROUP BY n_name, c_mktsegment ORDER BY total_sales DESC, n_name, c_mktsegment;
SELECT c.c_mktsegment, p.p_brand, SUM(l.l_extendedprice * (1 - l.l_discount)) AS revenue, AVG(ps.ps_supplycost) AS avg_supply_cost, COUNT(distinct o.o_orderkey) AS total_orders FROM customer c JOIN orders o ON c.c_custkey = o.o_custkey JOIN lineitem l ON o.o_orderkey = l.l_orderkey JOIN part p ON l.l_partkey = p.p_partkey JOIN partsupp ps ON p.p_partkey = ps.ps_partkey AND l.l_suppkey = ps.ps_suppkey WHERE c.c_mktsegment IN ('MACHINERY', 'HOUSEHOLD') AND p.p_brand IN ('Brand#54', 'Brand#22', 'Brand#41', 'Brand#32') AND l.l_shipdate BETWEEN '1995-01-01' AND '1995-12-31' GROUP BY c.c_mktsegment, p.p_brand ORDER BY revenue DESC, avg_supply_cost;
SELECT r.r_name AS region, n.n_name AS nation, COUNT(DISTINCT c.c_custkey) AS number_of_customers, SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_revenue, AVG(l.l_quantity) AS average_quantity, AVG(l.l_extendedprice) AS average_extended_price, AVG(l.l_discount) AS average_discount FROM customer c JOIN nation n ON c.c_nationkey = n.n_nationkey JOIN region r ON n.n_regionkey = r.r_regionkey JOIN lineitem l ON c.c_custkey = l.l_orderkey JOIN part p ON l.l_partkey = p.p_partkey WHERE r.r_name IN ('MIDDLE EAST', 'ASIA', 'EUROPE', 'AMERICA', 'AFRICA') AND l.l_shipdate BETWEEN '1995-01-01' AND '1996-12-31' AND l.l_linestatus = 'F' GROUP BY r.r_name, n.n_name ORDER BY total_revenue DESC, r.r_name, n.n_name;
SELECT n.n_name AS nation_name, p.p_type AS part_type, AVG(p.p_retailprice) AS avg_retail_price, SUM(ps.ps_availqty) AS total_available_quantity, SUM(ps.ps_supplycost * ps.ps_availqty) AS total_supply_cost FROM nation n JOIN partsupp ps ON n.n_nationkey = ps.ps_suppkey JOIN part p ON ps.ps_partkey = p.p_partkey WHERE n.n_regionkey = 1 AND n.n_name IN ('ROMANIA', 'IRAQ', 'KENYA', 'MOZAMBIQUE', 'UNITED STATES', 'PERU') AND p.p_type IN ('MEDIUM PLATED BRASS', 'ECONOMY POLISHED STEEL') AND p.p_retailprice IN (1583.67, 1573.66) AND ps.ps_availqty IN (8638, 3354, 3324) GROUP BY nation_name, part_type ORDER BY avg_retail_price DESC, total_available_quantity DESC;
SELECT r_name AS region, n_name AS nation, c_mktsegment AS market_segment, COUNT(DISTINCT s_suppkey) AS num_suppliers, COUNT(DISTINCT c_custkey) AS num_customers, COUNT(DISTINCT o_orderkey) AS num_orders, SUM(o_totalprice) AS total_order_value, AVG(s_acctbal) AS avg_supplier_acctbal, AVG(c_acctbal) AS avg_customer_acctbal FROM region JOIN nation ON r_regionkey = n_regionkey JOIN supplier ON s_nationkey = n_nationkey JOIN customer ON c_nationkey = n_nationkey LEFT JOIN orders ON o_custkey = c_custkey WHERE r_name IN ('EUROPE', 'AMERICA') AND c_mktsegment IN ('HOUSEHOLD', 'MACHINERY') AND o_orderdate BETWEEN '1995-01-01' AND '1996-12-31' AND o_orderstatus = 'F' GROUP BY r_name, n_name, c_mktsegment ORDER BY total_order_value DESC, num_orders DESC, region, nation;
SELECT s.s_name, s.s_address, COUNT(o.o_orderkey) AS total_orders, AVG(o.o_totalprice) AS average_order_value, SUM(p.p_retailprice) AS total_retail_price_of_ordered_parts FROM supplier s JOIN orders o ON s.s_suppkey = o.o_custkey AND o.o_orderdate = '1996-05-30' JOIN part p ON p.p_type IN ('PROMO PLATED NICKEL', 'MEDIUM PLATED NICKEL', 'ECONOMY POLISHED BRASS') GROUP BY s.s_name, s.s_address ORDER BY total_orders DESC, average_order_value DESC LIMIT 10;
SELECT r.r_name AS region, n.n_name AS nation, COUNT(DISTINCT s.s_suppkey) AS total_suppliers, COUNT(DISTINCT o.o_orderkey) AS total_orders, SUM(l.l_quantity) AS total_quantity, AVG(l.l_extendedprice) AS avg_extendedprice, SUM(l.l_extendedprice * (1 - l_discount)) AS revenue FROM region r JOIN nation n ON r.r_regionkey = n.n_regionkey JOIN supplier s ON n.n_nationkey = s.s_nationkey JOIN lineitem l ON s.s_suppkey = l.l_suppkey JOIN orders o ON l.l_orderkey = o.o_orderkey JOIN part p ON l.l_partkey = p.p_partkey WHERE n.n_nationkey IN (1, 6, 8) AND l.l_shipdate BETWEEN '1995-01-01' AND '1995-12-31' AND l.l_returnflag = 'N' GROUP BY r.r_name, n.n_name ORDER BY revenue DESC;
SELECT c.c_mktsegment, SUM(l.l_extendedprice) AS total_sales, AVG(l.l_extendedprice * (1 - l.l_discount)) AS avg_discounted_sales, COUNT(DISTINCT o.o_orderkey) AS total_orders, SUM(p.p_retailprice * l.l_quantity) AS potential_revenue, AVG(ps.ps_supplycost) AS avg_supply_cost, COUNT(DISTINCT s.s_suppkey) AS total_suppliers FROM customer c JOIN orders o ON c.c_custkey = o.o_custkey JOIN lineitem l ON o.o_orderkey = l.l_orderkey JOIN partsupp ps ON l.l_partkey = ps.ps_partkey AND l.l_suppkey = ps.ps_suppkey JOIN part p ON l.l_partkey = p.p_partkey JOIN supplier s ON l.l_suppkey = s.s_suppkey WHERE c.c_nationkey = s.s_nationkey AND o.o_orderstatus = 'F' AND l.l_discount BETWEEN 0.05 AND 0.07 AND l.l_shipdate >= '1995-01-01' AND l.l_shipdate < '1995-01-01'::date + INTERVAL '1 year' AND p.p_size BETWEEN 1 AND 15 AND ps.ps_availqty > 9000 GROUP BY c.c_mktsegment ORDER BY total_sales DESC;
SELECT r.r_name AS region, COUNT(DISTINCT li.l_orderkey) AS number_of_orders, SUM(li.l_extendedprice) AS total_revenue, AVG(li.l_quantity) AS avg_quantity, SUM(li.l_extendedprice * (1 - li.l_discount) * (1 + li.l_tax)) AS total_revenue_after_discount_and_tax FROM region r JOIN partsupp ps ON r.r_regionkey = ps.ps_suppkey JOIN lineitem li ON ps.ps_partkey = li.l_partkey AND ps.ps_suppkey = li.l_suppkey WHERE r.r_name = 'EUROPE' AND li.l_returnflag = 'N' AND li.l_shipdate BETWEEN '2022-01-01' AND '2022-12-31' GROUP BY r.r_name ORDER BY total_revenue DESC;
SELECT r.r_name AS region_name, COUNT(c.c_custkey) AS number_of_customers, SUM(c.c_acctbal) AS total_balance, AVG(c.c_acctbal) AS average_balance, COUNT(p.p_partkey) AS number_of_parts, SUM(ps.ps_availqty) AS total_available_quantity, AVG(ps.ps_supplycost) AS average_supply_cost, SUM(ps.ps_supplycost * ps.ps_availqty) AS total_value_of_supply FROM customer c JOIN region r ON c.c_nationkey = r.r_regionkey JOIN partsupp ps ON ps.ps_suppkey = c.c_custkey JOIN part p ON ps.ps_partkey = p.p_partkey GROUP BY r.r_name ORDER BY total_balance DESC;
SELECT n.n_name AS nation, AVG(c.c_acctbal) AS avg_customer_balance, COUNT(DISTINCT c.c_custkey) AS num_customers, SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_sales_volume, COUNT(DISTINCT o.o_orderkey) AS num_orders, COUNT(DISTINCT p.p_partkey) AS num_parts_sold FROM nation n JOIN customer c ON n.n_nationkey = c.c_nationkey JOIN orders o ON c.c_custkey = o.o_custkey JOIN lineitem l ON o.o_orderkey = l.l_orderkey JOIN part p ON l.l_partkey = p.p_partkey WHERE o.o_orderdate BETWEEN date '1995-01-01' AND date '1995-12-31' AND l.l_shipdate > o.o_orderdate GROUP BY n.n_name ORDER BY total_sales_volume DESC;
SELECT p.p_brand, o.o_orderpriority, SUM(l.l_extendedprice) AS total_extended_price, AVG(l.l_discount) AS average_discount, COUNT(DISTINCT o.o_orderkey) AS order_count FROM part AS p JOIN lineitem AS l ON p.p_partkey = l.l_partkey JOIN orders AS o ON l.l_orderkey = o.o_orderkey WHERE o.o_custkey IN ('1483163', '1269031') AND o.o_shippriority = '0' AND p.p_size BETWEEN 30 AND 50 GROUP BY p.p_brand, o.o_orderpriority ORDER BY total_extended_price DESC, average_discount ASC, order_count DESC;
SELECT n.n_name AS nation_name, COUNT(o.o_orderkey) AS total_orders, SUM(l.l_quantity) AS total_quantity, AVG(l.l_extendedprice) AS avg_price, SUM(l.l_extendedprice * (1 - l.l_discount)) AS revenue, AVG(l.l_discount) AS avg_discount FROM nation n JOIN customer c ON n.n_nationkey = c.c_nationkey JOIN orders o ON c.c_custkey = o.o_custkey JOIN lineitem l ON o.o_orderkey = l.l_orderkey GROUP BY n.n_name ORDER BY revenue DESC;
SELECT n.n_name, c.c_mktsegment, COUNT(o.o_orderkey) AS total_orders, AVG(l.l_quantity) AS average_quantity, SUM(l.l_extendedprice * (1 - l.l_discount)) AS revenue, SUM(ps.ps_supplycost * l.l_quantity) AS total_supply_cost, (SUM(l.l_extendedprice * (1 - l.l_discount)) - SUM(ps.ps_supplycost * l.l_quantity)) AS profit FROM nation n JOIN supplier s ON s.s_nationkey = n.n_nationkey JOIN partsupp ps ON s.s_suppkey = ps.ps_suppkey JOIN lineitem l ON ps.ps_partkey = l.l_partkey AND ps.ps_suppkey = l.l_suppkey JOIN orders o ON l.l_orderkey = o.o_orderkey JOIN customer c ON o.o_custkey = c.c_custkey AND c.c_nationkey = n.n_nationkey WHERE n.n_regionkey IN (1, 3, 0) AND l.l_receiptdate BETWEEN '1994-01-01' AND '1997-12-31' AND c.c_comment LIKE 'slyly regular requests. slyly%' GROUP BY n.n_name, c.c_mktsegment ORDER BY revenue DESC, n.n_name, c.c_mktsegment;
SELECT c.c_mktsegment AS market_segment, COUNT(DISTINCT s.s_suppkey) AS total_suppliers, SUM(ps.ps_supplycost * ps.ps_availqty) AS total_supply_cost, AVG(s.s_acctbal) AS average_supplier_acct_balance FROM customer c JOIN supplier s ON s.s_nationkey = c.c_nationkey JOIN partsupp ps ON ps.ps_suppkey = s.s_suppkey JOIN part p ON ps.ps_partkey = p.p_partkey WHERE p.p_size BETWEEN 1 AND 15 AND p.p_type LIKE 'ECONOMY%' AND s.s_name IN ('Supplier#000017662', 'Supplier#000022239', 'Supplier#000019280', 'Supplier#000017786') AND c.c_mktsegment IN ('BUILDING', 'HOUSEHOLD', 'FURNITURE') GROUP BY c.c_mktsegment ORDER BY total_supply_cost DESC;
SELECT p_brand, p_type, p_size, SUM(l_quantity) AS total_quantity, AVG(l_extendedprice) AS avg_price, AVG(l_discount) AS avg_discount, COUNT(DISTINCT o_orderkey) AS number_of_orders FROM part JOIN lineitem ON p_partkey = l_partkey JOIN orders ON o_orderkey = l_orderkey WHERE p_retailprice BETWEEN 900 AND 2000 AND o_orderpriority IN ('1-URGENT', '2-HIGH') AND p_size IN (1, 2, 3, 4, 5, 6) AND l_shipmode IN ('MAIL', 'SHIP') AND l_returnflag = 'N' GROUP BY p_brand, p_type, p_size ORDER BY number_of_orders DESC, total_quantity DESC, avg_price, avg_discount, p_brand, p_type, p_size;
SELECT r.r_name AS region, n.n_name AS nation, COUNT(DISTINCT c.c_custkey) AS num_customers, COUNT(DISTINCT o.o_orderkey) AS num_orders, SUM(o.o_totalprice) AS total_sales, AVG(c.c_acctbal) AS avg_customer_balance, MAX(p.p_retailprice) AS max_part_price FROM region r LEFT JOIN nation n ON r.r_regionkey = n.n_regionkey LEFT JOIN customer c ON n.n_nationkey = c.c_nationkey LEFT JOIN orders o ON c.c_custkey = o.o_custkey LEFT JOIN partsupp ps ON ps.ps_suppkey = c.c_custkey LEFT JOIN part p ON ps.ps_partkey = p.p_partkey WHERE r.r_regionkey IN (1, 4, 0, 2, 3) AND c.c_nationkey IN (1, 15, 8) AND o.o_orderdate BETWEEN '2022-01-01' AND '2022-12-31' GROUP BY r.r_name, n.n_name ORDER BY total_sales DESC, avg_customer_balance DESC LIMIT 10;
SELECT r_name AS region, n_name AS nation, COUNT(DISTINCT c_custkey) AS num_customers, SUM(c_acctbal) AS total_balance, AVG(c_acctbal) AS avg_balance, SUM(l_extendedprice) AS total_sales, SUM(l_extendedprice * (1 - l_discount)) AS discounted_total_sales, AVG(l_extendedprice) AS avg_sales_price, COUNT(DISTINCT o_orderkey) AS num_orders, AVG(o_totalprice) AS avg_order_value, COUNT(*) AS line_items_count FROM region JOIN nation ON n_regionkey = r_regionkey JOIN customer ON c_nationkey = n_nationkey JOIN orders ON o_custkey = c_custkey JOIN lineitem ON l_orderkey = o_orderkey WHERE r_comment LIKE '%final%' AND o_shippriority = 0 AND c_comment NOT LIKE '%theodolites%' AND l_shipdate BETWEEN '1995-01-01' AND '1995-12-31' GROUP BY region, nation ORDER BY total_sales DESC, avg_order_value DESC LIMIT 10;
SELECT r_name, c_mktsegment, COUNT(DISTINCT o_orderkey) AS total_orders, SUM(l_extendedprice * (1 - l_discount)) AS total_revenue, AVG(l_quantity) AS average_quantity, AVG(l_extendedprice * (1 - l_discount)) AS average_revenue_per_order FROM region JOIN customer ON c_nationkey = r_regionkey JOIN orders ON o_custkey = c_custkey JOIN lineitem ON l_orderkey = o_orderkey GROUP BY r_name, c_mktsegment ORDER BY total_revenue DESC, total_orders DESC;
SELECT n.n_name AS nation_name, p.p_type AS part_type, AVG(ps.ps_supplycost) AS avg_supply_cost, SUM(ps.ps_availqty) AS total_availability, COUNT(DISTINCT p.p_partkey) AS unique_parts_count FROM nation n JOIN partsupp ps ON n.n_nationkey = ps.ps_suppkey JOIN part p ON ps.ps_partkey = p.p_partkey WHERE ps.ps_availqty > 3000 AND p.p_size BETWEEN 30 AND 50 GROUP BY nation_name, part_type ORDER BY avg_supply_cost DESC, total_availability DESC LIMIT 10;
SELECT r_name AS region, n_name AS nation, COUNT(DISTINCT s_suppkey) AS supplier_count, COUNT(DISTINCT c_custkey) AS customer_count, SUM(p_retailprice) AS total_retail_price, AVG(l_quantity) AS average_quantity, SUM(l_extendedprice * (1 - l_discount)) AS revenue, COUNT(DISTINCT o_orderkey) AS order_count FROM region JOIN nation ON n_regionkey = r_regionkey JOIN supplier ON s_nationkey = n_nationkey JOIN customer ON c_nationkey = n_nationkey JOIN orders ON o_custkey = c_custkey JOIN lineitem ON l_orderkey = o_orderkey JOIN part ON p_partkey = l_partkey JOIN partsupp ON ps_partkey = p_partkey AND ps_suppkey = s_suppkey WHERE l_receiptdate <= '1994-10-13' AND (p_comment LIKE '%riously%' OR p_comment LIKE '%carefully regular%' OR p_comment LIKE '%across the stea%') AND NOT (o_orderkey IN ('8390', '7488')) AND NOT (c_custkey = '2314') GROUP BY r_name, n_name ORDER BY revenue DESC, region, nation;
SELECT r.r_name AS region_name, COUNT(DISTINCT s.s_suppkey) AS number_of_suppliers, COUNT(DISTINCT c.c_custkey) AS number_of_customers, COUNT(DISTINCT o.o_orderkey) AS number_of_orders, AVG(s.s_acctbal) AS average_supplier_balance, AVG(c.c_acctbal) AS average_customer_balance, SUM(o.o_totalprice) AS total_sales, AVG(p.p_retailprice) AS average_part_retail_price FROM region r JOIN supplier s ON r.r_regionkey = s.s_nationkey JOIN partsupp ps ON s.s_suppkey = ps.ps_suppkey JOIN part p ON ps.ps_partkey = p.p_partkey JOIN orders o ON s.s_suppkey = o.o_custkey JOIN customer c ON o.o_custkey = c.c_custkey WHERE r.r_regionkey = 3 AND o.o_orderstatus IN ('F', 'P') AND ps.ps_supplycost BETWEEN 350 AND 450 GROUP BY r.r_name ORDER BY total_sales DESC;
SELECT r_name AS region, n_name AS nation, COUNT(DISTINCT s_suppkey) AS number_of_suppliers, COUNT(DISTINCT c_custkey) AS number_of_customers, SUM(l_extendedprice) AS total_sales, AVG(l_extendedprice * (1 - l_discount)) AS avg_discounted_sales, SUM(l_quantity) AS total_units_sold FROM region JOIN nation ON r_regionkey = n_regionkey JOIN supplier ON n_nationkey = s_nationkey JOIN customer ON n_nationkey = c_nationkey JOIN orders ON c_custkey = o_custkey JOIN lineitem ON o_orderkey = l_orderkey WHERE r_name IN ('AMERICA', 'ASIA', 'EUROPE') AND l_shipdate BETWEEN date '2022-01-01' AND date '2022-12-31' AND o_orderstatus = 'F' GROUP BY region, nation ORDER BY total_sales DESC, region, nation;
SELECT n.n_name AS nation, EXTRACT(YEAR FROM o.o_orderdate) AS order_year, COUNT(DISTINCT o.o_orderkey) AS num_orders, SUM(o.o_totalprice) AS total_sales, AVG(c.c_acctbal) AS avg_customer_balance, SUM(ps.ps_availqty) AS total_avail_qty, AVG(ps.ps_supplycost) AS avg_supplycost FROM nation n JOIN customer c ON n.n_nationkey = c.c_nationkey JOIN orders o ON c.c_custkey = o.o_custkey JOIN partsupp ps ON c.c_custkey = ps.ps_suppkey WHERE o.o_orderstatus = 'F' AND o.o_orderdate BETWEEN '1996-01-01' AND '1996-12-31' GROUP BY nation, order_year ORDER BY total_sales DESC, nation, order_year;
SELECT r_name AS region, n_name AS nation, COUNT(DISTINCT s_suppkey) AS number_of_suppliers, AVG(s_acctbal) AS average_account_balance, SUM(l_extendedprice * (1 - l_discount)) AS total_sales, AVG(ps_supplycost) AS average_supply_cost, COUNT(DISTINCT p_partkey) AS number_of_parts_sold FROM region JOIN nation ON n_regionkey = r_regionkey JOIN supplier ON s_nationkey = n_nationkey JOIN partsupp ON ps_suppkey = s_suppkey JOIN part ON p_partkey = ps_partkey JOIN lineitem ON l_partkey = p_partkey AND l_suppkey = s_suppkey JOIN orders ON o_orderkey = l_orderkey WHERE r_name IN ('MIDDLE EAST', 'EUROPE', 'ASIA', 'AMERICAS') AND l_shipdate BETWEEN '1995-01-01' AND '1995-12-31' AND o_orderstatus = 'F' GROUP BY region, nation ORDER BY total_sales DESC, average_account_balance DESC, region, nation;
SELECT r.r_name AS region, n.n_name AS nation, COUNT(DISTINCT s.s_suppkey) AS total_suppliers, COUNT(DISTINCT c.c_custkey) AS total_customers, COUNT(DISTINCT p.p_partkey) AS total_parts, SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_revenue, AVG(l.l_quantity) AS average_quantity, AVG(l.l_extendedprice) AS average_extended_price, AVG(ps.ps_supplycost) AS average_supply_cost FROM region r JOIN nation n ON n.n_regionkey = r.r_regionkey JOIN supplier s ON s.s_nationkey = n.n_nationkey JOIN customer c ON c.c_nationkey = n.n_nationkey JOIN orders o ON o.o_custkey = c.c_custkey JOIN lineitem l ON l.l_orderkey = o.o_orderkey JOIN partsupp ps ON ps.ps_suppkey = l.l_suppkey AND ps.ps_partkey = l.l_partkey JOIN part p ON p.p_partkey = l.l_partkey WHERE l.l_shipmode IN ('RAIL', 'SHIP') AND p.p_type IN ('STANDARD ANODIZED NICKEL', 'SMALL ANODIZED COPPER', 'SMALL BRUSHED COPPER', 'STANDARD PLATED TIN') AND l.l_shipdate BETWEEN '1993-01-01' AND '1993-12-31' GROUP BY r.r_name, n.n_name ORDER BY total_revenue DESC, total_suppliers DESC;
SELECT r_name AS region, n_name AS nation, COUNT(DISTINCT s_suppkey) AS total_suppliers, COUNT(DISTINCT c_custkey) AS total_customers, SUM(l_extendedprice) AS total_sales_volume, AVG(l_quantity) AS average_quantity_sold, SUM(l_extendedprice * (1 - l_discount)) AS total_revenue_after_discount, COUNT(DISTINCT o_orderkey) AS total_orders FROM region JOIN nation ON n_regionkey = r_regionkey JOIN supplier ON s_nationkey = n_nationkey JOIN customer ON c_nationkey = n_nationkey JOIN orders ON o_custkey = c_custkey JOIN lineitem ON l_orderkey = o_orderkey AND l_suppkey = s_suppkey WHERE o_orderstatus = 'O' AND n_name IN ('JAPAN', 'INDIA', 'MOZAMBIQUE', 'FRANCE', 'UNITED KINGDOM') AND l_shipdate BETWEEN '1995-01-01' AND '1996-12-31' GROUP BY region, nation ORDER BY total_revenue_after_discount DESC, total_sales_volume DESC LIMIT 10;
SELECT r_name AS region, n_name AS nation, p_brand, p_type, COUNT(l_orderkey) AS number_of_orders, SUM(l_quantity) AS total_quantity, AVG(l_extendedprice) AS average_price, AVG(l_discount) AS average_discount, SUM(l_extendedprice * (1 - l_discount)) AS revenue FROM region JOIN nation ON r_regionkey = n_regionkey JOIN orders ON o_orderkey IN (SELECT l_orderkey FROM lineitem) JOIN lineitem ON l_orderkey = o_orderkey JOIN part ON l_partkey = p_partkey WHERE n_name IN ('BRAZIL', 'RUSSIA', 'VIETNAM', 'INDIA', 'ROMANIA', 'ALGERIA') AND p_brand IN ('Brand#55', 'Brand#31', 'Brand#33') AND o_shippriority = '0' AND l_discount = '0.00' AND l_linestatus IN ('F', 'O') GROUP BY region, nation, p_brand, p_type ORDER BY revenue DESC;
SELECT s.s_name, COUNT(o.o_orderkey) AS total_orders, AVG(o.o_totalprice) AS avg_order_price, SUM(ps.ps_availqty) AS total_avail_parts, MIN(ps.ps_supplycost) AS min_supply_cost, MAX(s.s_acctbal) AS max_account_balance FROM supplier s JOIN partsupp ps ON s.s_suppkey = ps.ps_suppkey JOIN orders o ON s.s_suppkey = o.o_custkey WHERE o.o_orderstatus = 'O' AND o.o_shippriority = 0 AND s.s_address IN ('vIS,CFR8,QLS6JnDbpedV9TRZIoKkYE8ZCh', 'm8wU2L8G aE75X', 'OzCurSnBB5qM,B', 'K,hmPLSSf7xBdppVkX2HqylLT,aZC') AND s.s_acctbal IN (877.77, 8641.38) AND ps.ps_partkey IN (522, 203) GROUP BY s.s_name ORDER BY max_account_balance DESC, total_orders DESC, avg_order_price DESC LIMIT 100;
SELECT r.r_name AS region, n.n_name AS nation, COUNT(DISTINCT s.s_suppkey) AS number_of_suppliers, COUNT(DISTINCT c.c_custkey) AS number_of_customers, SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_sales_value, AVG(p.p_retailprice) AS average_part_retail_price, AVG(l.l_quantity) AS average_quantity_ordered, COUNT(DISTINCT o.o_orderkey) AS number_of_orders FROM region r JOIN nation n ON r.r_regionkey = n.n_regionkey JOIN supplier s ON n.n_nationkey = s.s_nationkey JOIN partsupp ps ON s.s_suppkey = ps.ps_suppkey JOIN part p ON ps.ps_partkey = p.p_partkey JOIN lineitem l ON p.p_partkey = l.l_partkey AND s.s_suppkey = l.l_suppkey JOIN orders o ON l.l_orderkey = o.o_orderkey JOIN customer c ON o.o_custkey = c.c_custkey AND n.n_nationkey = c.c_nationkey WHERE r.r_regionkey = 1 AND p.p_size IN (2, 30) AND l.l_shipinstruct = 'COLLECT COD' AND l.l_commitdate < l.l_receiptdate AND p.p_retailprice BETWEEN 1000 AND 2000 GROUP BY r.r_name, n.n_name ORDER BY total_sales_value DESC, average_part_retail_price DESC;
SELECT n.n_name, COUNT(*) AS number_of_orders, SUM(l.l_quantity) AS total_quantity, AVG(l.l_extendedprice) AS average_price, SUM(l.l_extendedprice * (1 - l.l_discount)) AS revenue, AVG(l.l_discount) AS average_discount, MAX(ps.ps_availqty) AS max_available_quantity FROM nation n JOIN lineitem l ON n.n_nationkey = l.l_suppkey JOIN partsupp ps ON l.l_partkey = ps.ps_partkey AND l.l_suppkey = ps.ps_suppkey WHERE n.n_name = 'KENYA' AND l.l_shipdate BETWEEN '2020-01-01' AND '2020-12-31' GROUP BY n.n_name ORDER BY revenue DESC, average_price DESC;
SELECT n.n_name AS nation_name, c.c_mktsegment AS market_segment, COUNT(DISTINCT l.l_orderkey) AS number_of_transactions, SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_sales_amount, AVG(l.l_extendedprice * (1 - l.l_discount)) AS average_sales_amount, SUM(l.l_quantity) AS total_quantity, AVG(ps.ps_supplycost) AS average_supply_cost FROM lineitem l JOIN partsupp ps ON l.l_partkey = ps.ps_partkey AND l.l_suppkey = ps.ps_suppkey JOIN customer c ON c.c_custkey = CAST(SUBSTRING(l.l_shipinstruct, LENGTH(l.l_shipinstruct) - 9) AS INTEGER) JOIN nation n ON c.c_nationkey = n.n_nationkey WHERE c.c_mktsegment IN ('BUILDING', 'AUTOMOBILE', 'HOUSEHOLD', 'MACHINERY') AND l.l_shipdate BETWEEN '2020-01-01' AND '2020-12-31' GROUP BY n.n_name, c.c_mktsegment ORDER BY total_sales_amount DESC, nation_name, market_segment;
SELECT c_mktsegment, COUNT(DISTINCT o_orderkey) AS total_orders, AVG(o_totalprice) AS avg_order_value, SUM(ps_availqty) AS total_parts_available, AVG(ps_supplycost) AS avg_part_supply_cost, COUNT(DISTINCT partsupp.ps_partkey) AS unique_parts_ordered FROM customer JOIN orders ON customer.c_custkey = orders.o_custkey JOIN partsupp ON partsupp.ps_suppkey = orders.o_orderkey JOIN part ON part.p_partkey = partsupp.ps_partkey WHERE customer.c_acctbal > 1000 AND orders.o_orderdate BETWEEN date '2020-01-01' AND date '2020-12-31' GROUP BY customer.c_mktsegment ORDER BY total_orders DESC, avg_order_value DESC;
SELECT n_name AS nation_name, r_name AS region_name, COUNT(DISTINCT s_suppkey) AS total_suppliers, COUNT(DISTINCT o_orderkey) AS total_orders, SUM(l_extendedprice * (1 - l_discount)) AS total_revenue, AVG(p_retailprice) AS average_retail_price, AVG(l_quantity) AS average_quantity_sold FROM nation JOIN region ON n_regionkey = r_regionkey JOIN supplier ON s_nationkey = n_nationkey JOIN partsupp ON ps_suppkey = s_suppkey JOIN part ON p_partkey = ps_partkey JOIN lineitem ON l_partkey = p_partkey AND l_suppkey = s_suppkey JOIN orders ON o_orderkey = l_orderkey WHERE o_orderstatus = 'F' AND l_shipdate BETWEEN '1995-01-01' AND '1996-12-31' AND p_size IN (46, 2, 5) GROUP BY nation_name, region_name ORDER BY total_revenue DESC, average_retail_price DESC LIMIT 10;
SELECT r_name AS region, n_name AS nation, COUNT(DISTINCT s_suppkey) AS number_of_suppliers, SUM(p.p_retailprice) AS total_retail_price, AVG(ps.ps_supplycost) AS average_supply_cost, SUM(l.l_quantity) AS total_quantity_sold, SUM(l.l_extendedprice * (1 - l.l_discount)) AS revenue, AVG(l.l_extendedprice * (1 - l.l_discount)) AS average_revenue_per_order FROM region JOIN nation ON r_regionkey = n_regionkey JOIN supplier ON s_nationkey = n_nationkey JOIN partsupp ps ON s_suppkey = ps.ps_suppkey JOIN part p ON ps.ps_partkey = p.p_partkey JOIN lineitem l ON ps.ps_partkey = l.l_partkey AND ps.ps_suppkey = l.l_suppkey JOIN orders o ON l.l_orderkey = o.o_orderkey WHERE p.p_brand IN ('Brand#51', 'Brand#13') AND o.o_orderstatus = 'F' AND l.l_shipdate BETWEEN '1994-01-01' AND '1995-01-01' GROUP BY r_name, n_name ORDER BY revenue DESC, average_revenue_per_order DESC LIMIT 10;
SELECT c_name, c_mktsegment, AVG(c_acctbal) AS avg_customer_balance, COUNT(DISTINCT l_orderkey) AS total_orders, SUM(l_quantity) AS total_quantity_ordered, SUM(l_extendedprice * (1 - l_discount)) AS total_revenue, AVG(l_extendedprice * (1 - l_discount)) AS avg_order_value FROM customer JOIN lineitem ON c_custkey = (l_orderkey % 10000) JOIN part ON l_partkey = p_partkey JOIN partsupp ON l_partkey = ps_partkey AND l_suppkey = ps_suppkey WHERE c_address LIKE '%XEBusH2eUDr1zma6D67Cj98tVVd%' AND p_type LIKE '%BRASS' AND ps_availqty > 3000 AND l_shipdate BETWEEN '1995-01-01' AND '1995-12-31' AND l_returnflag = 'N' GROUP BY c_name, c_mktsegment ORDER BY total_revenue DESC, avg_customer_balance DESC LIMIT 10;
SELECT n.n_name AS nation_name, r.r_name AS region_name, COUNT(DISTINCT c.c_custkey) AS num_customers, COUNT(DISTINCT o.o_orderkey) AS num_orders, SUM(o.o_totalprice) AS total_order_value, AVG(ps.ps_supplycost) AS avg_part_supply_cost, SUM(ps.ps_availqty) AS total_available_parts FROM nation n JOIN region r ON n.n_regionkey = r.r_regionkey JOIN customer c ON n.n_nationkey = c.c_nationkey JOIN orders o ON c.c_custkey = o.o_custkey JOIN partsupp ps ON ps.ps_suppkey IN (SELECT s.s_suppkey FROM supplier s WHERE s.s_nationkey = n.n_nationkey) WHERE o.o_orderpriority IN ('2-HIGH', '1-URGENT') AND r.r_regionkey BETWEEN 1 AND 3 AND o.o_orderdate >= date '2021-01-01' AND o.o_orderdate <= date '2021-12-31' GROUP BY nation_name, region_name ORDER BY total_order_value DESC, nation_name, region_name;
SELECT r_name AS region, n_name AS nation, p_brand, MAX(p_retailprice) AS max_retail_price, MIN(p_retailprice) AS min_retail_price, AVG(l_quantity) AS avg_quantity_sold, SUM(l_extendedprice * (1 - l_discount)) AS total_sales, COUNT(DISTINCT l_orderkey) AS number_of_orders FROM lineitem JOIN part ON lineitem.l_partkey = part.p_partkey JOIN nation ON nation.n_nationkey = ( SELECT n_nationkey FROM nation n2 WHERE n2.n_regionkey = part.p_partkey LIMIT 1 ) JOIN region ON nation.n_regionkey = region.r_regionkey GROUP BY region, nation, p_brand ORDER BY total_sales DESC;
SELECT r_name AS region, n_name AS nation, COUNT(s_suppkey) AS number_of_suppliers, SUM(ps_availqty) AS total_available_parts, AVG(s_acctbal) AS average_account_balance, SUM(ps_supplycost * ps_availqty) AS total_supply_cost FROM region JOIN nation ON r_regionkey = n_regionkey JOIN supplier ON n_nationkey = s_nationkey JOIN partsupp ON s_suppkey = ps_suppkey GROUP BY region, nation ORDER BY total_supply_cost DESC, average_account_balance DESC LIMIT 10;
SELECT c.c_mktsegment, EXTRACT(YEAR FROM o.o_orderdate) AS order_year, COUNT(DISTINCT o.o_orderkey) AS total_orders, SUM(l.l_quantity) AS total_quantity, AVG(l.l_extendedprice * (1 - l.l_discount)) AS avg_discounted_price, SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_revenue, AVG(ps.ps_supplycost) AS avg_supply_cost FROM customer c JOIN orders o ON c.c_custkey = o.o_custkey JOIN lineitem l ON o.o_orderkey = l.l_orderkey JOIN partsupp ps ON l.l_partkey = ps.ps_partkey AND l.l_suppkey = ps.ps_suppkey WHERE o.o_orderdate BETWEEN '1994-01-01' AND '1997-12-31' AND o.o_clerk IN ('Clerk#000013110', 'Clerk#000019634', 'Clerk#000022938', 'Clerk#000000992') GROUP BY c.c_mktsegment, order_year ORDER BY c.c_mktsegment, order_year;
SELECT r.r_name AS region, n.n_name AS nation, COUNT(DISTINCT s.s_suppkey) AS number_of_suppliers, AVG(s.s_acctbal) AS average_account_balance, SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_sales_value, AVG(p.p_retailprice) AS average_part_retail_price, COUNT(DISTINCT o.o_orderkey) AS number_of_orders FROM region r JOIN nation n ON r.r_regionkey = n.n_regionkey JOIN supplier s ON n.n_nationkey = s.s_nationkey JOIN partsupp ps ON s.s_suppkey = ps.ps_suppkey JOIN part p ON ps.ps_partkey = p.p_partkey JOIN lineitem l ON ps.ps_partkey = l.l_partkey AND ps.ps_suppkey = l.l_suppkey JOIN orders o ON l.l_orderkey = o.o_orderkey WHERE o.o_orderdate BETWEEN date '1995-01-01' AND date '1995-12-31' AND l.l_shipdate > o.o_orderdate AND ps.ps_suppkey <> 60835 GROUP BY region, nation ORDER BY total_sales_value DESC, region, nation;
SELECT r_name AS region, p_type AS part_type, AVG(ps_supplycost) AS avg_supply_cost, SUM(ps_availqty) AS total_available_quantity, COUNT(DISTINCT s_suppkey) AS number_of_suppliers, COUNT(DISTINCT c_custkey) AS number_of_customers, AVG(o_totalprice) AS avg_order_total_price FROM region JOIN supplier ON s_nationkey IN (4, 22, 6) JOIN partsupp ON s_suppkey = ps_suppkey JOIN part ON ps_partkey = p_partkey AND p_size IN (7, 21, 43, 23, 19) JOIN orders ON o_orderdate BETWEEN '1992-01-01' AND '1995-12-31' JOIN customer ON c_custkey = o_custkey WHERE s_comment LIKE '%al requests are furiously a%' OR s_comment LIKE '%refully. ironic, even accounts hag%' AND p_retailprice IN (935.03, 1779.87, 1705.79, 1448.53) GROUP BY region, part_type ORDER BY avg_supply_cost DESC, total_available_quantity DESC;
SELECT r.r_name AS region_name, COUNT(DISTINCT s.s_suppkey) AS total_suppliers, COUNT(DISTINCT p.p_partkey) AS total_parts, AVG(s.s_acctbal) AS average_supplier_acctbal, SUM(o.o_totalprice) AS total_order_price, AVG(o.o_totalprice) AS average_order_price FROM region r JOIN supplier s ON s.s_nationkey = r.r_regionkey JOIN part p ON p.p_size = r.r_regionkey JOIN orders o ON o.o_orderkey = p.p_partkey WHERE r.r_name IN ('ASIA', 'AFRICA') AND p.p_retailprice IN (1396.48, 991.08, 966.05) AND r.r_comment LIKE '%final%' GROUP BY r.r_name ORDER BY total_order_price DESC;
SELECT r.r_name AS region, c.c_mktsegment AS market_segment, COUNT(DISTINCT o.o_orderkey) AS total_orders, SUM(l.l_extendedprice * (1 - l.l_discount)) AS revenue, AVG(l.l_quantity) AS average_quantity, AVG(l.l_extendedprice) AS average_price_per_order FROM customer c JOIN orders o ON c.c_custkey = o.o_custkey JOIN lineitem l ON o.o_orderkey = l.l_orderkey JOIN supplier s ON s.s_suppkey = l.l_suppkey JOIN region r ON s.s_nationkey = r.r_regionkey WHERE l.l_shipdate BETWEEN '2022-01-01' AND '2022-12-31' AND o.o_orderstatus = 'F' GROUP BY region, market_segment ORDER BY revenue DESC, region, market_segment;
SELECT r.r_name AS region_name, n.n_name AS nation_name, COUNT(s.s_suppkey) AS number_of_suppliers, SUM(s.s_acctbal) AS total_balance, AVG(s.s_acctbal) AS average_balance FROM region r JOIN nation n ON r.r_regionkey = n.n_regionkey JOIN supplier s ON n.n_nationkey = s.s_nationkey GROUP BY region_name, nation_name ORDER BY region_name, nation_name;
SELECT r_name AS region, n_name AS nation, COUNT(DISTINCT s_suppkey) AS total_suppliers, COUNT(DISTINCT c_custkey) AS total_customers, AVG(s_acctbal) AS average_supplier_balance, AVG(c_acctbal) AS average_customer_balance, SUM(l_extendedprice * (1 - l_discount)) AS total_sales_volume, AVG(l_quantity) AS average_quantity_sold FROM region JOIN nation ON n_regionkey = r_regionkey JOIN supplier ON s_nationkey = n_nationkey JOIN customer ON c_nationkey = n_nationkey JOIN lineitem ON l_suppkey = s_suppkey JOIN orders ON o_orderkey = l_orderkey AND o_custkey = c_custkey JOIN part ON p_partkey = l_partkey WHERE l_shipdate BETWEEN '1995-01-01' AND '1995-12-31' AND r_name IN ('EUROPE', 'AMERICA') GROUP BY region, nation ORDER BY total_sales_volume DESC;
SELECT n.n_name AS nation, c.c_mktsegment AS market_segment, AVG(c.c_acctbal) AS avg_customer_acct_balance, SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_sales_value, AVG(ps.ps_supplycost) AS avg_supply_cost, AVG(ps.ps_availqty) AS avg_avail_qty FROM nation n JOIN customer c ON n.n_nationkey = c.c_nationkey JOIN orders o ON c.c_custkey = o.o_custkey JOIN lineitem l ON o.o_orderkey = l.l_orderkey JOIN partsupp ps ON l.l_partkey = ps.ps_partkey AND l.l_suppkey = ps.ps_suppkey JOIN supplier s ON ps.ps_suppkey = s.s_suppkey AND s.s_nationkey = n.n_nationkey WHERE c.c_mktsegment = 'AUTOMOBILE' AND o.o_orderdate >= date '2020-01-01' AND o.o_orderdate < date '2021-01-01' AND l.l_shipmode IN ('AIR', 'RAIL') GROUP BY n.n_name, c.c_mktsegment ORDER BY total_sales_value DESC;
SELECT r.r_name AS region, n.n_name AS nation, COUNT(DISTINCT s.s_suppkey) AS number_of_suppliers, COUNT(DISTINCT c.c_custkey) AS number_of_customers, SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_revenue, AVG(l.l_quantity) AS average_quantity, AVG(p.p_retailprice) AS average_part_price FROM region r JOIN nation n ON r.r_regionkey = n.n_regionkey JOIN supplier s ON n.n_nationkey = s.s_nationkey JOIN partsupp ps ON s.s_suppkey = ps.ps_suppkey JOIN part p ON ps.ps_partkey = p.p_partkey JOIN lineitem l ON p.p_partkey = l.l_partkey AND s.s_suppkey = l.l_suppkey JOIN orders o ON l.l_orderkey = o.o_orderkey JOIN customer c ON o.o_custkey = c.c_custkey AND n.n_nationkey = c.c_nationkey WHERE r.r_regionkey IN (2, 0) AND l.l_shipdate BETWEEN '2020-01-01' AND '2020-12-31' GROUP BY r.r_name, n.n_name ORDER BY total_revenue DESC;
SELECT r_name AS region, n_name AS nation, COUNT(DISTINCT c_custkey) AS number_of_customers, AVG(c_acctbal) AS average_account_balance, SUM(l_extendedprice * (1 - l_discount)) AS total_revenue, COUNT(DISTINCT o_orderkey) AS number_of_orders FROM region JOIN nation ON r_regionkey = n_regionkey JOIN customer ON n_nationkey = c_nationkey JOIN orders ON c_custkey = o_custkey JOIN lineitem ON o_orderkey = l_orderkey WHERE r_name IN ('EUROPE', 'AMERICA') AND o_orderdate BETWEEN DATE '1995-01-01' AND DATE '1995-12-31' AND l_shipdate > o_orderdate GROUP BY region, nation ORDER BY total_revenue DESC;
SELECT n_name, COUNT(DISTINCT o_orderkey) AS total_orders, SUM(l_extendedprice) AS total_sales, AVG(l_quantity) AS average_quantity, SUM(l_extendedprice * (1 - l_discount)) AS revenue_after_discount, COUNT(DISTINCT c_custkey) AS unique_customers FROM nation JOIN customer ON n_nationkey = c_nationkey JOIN orders ON c_custkey = o_custkey JOIN lineitem ON o_orderkey = l_orderkey WHERE n_name IN ('INDONESIA', 'RUSSIA', 'BRAZIL') AND o_orderdate BETWEEN date '2022-01-01' AND date '2022-12-31' AND l_shipdate > o_orderdate GROUP BY n_name ORDER BY total_sales DESC, n_name;
SELECT n.n_name AS nation, COUNT(DISTINCT s.s_suppkey) AS number_of_suppliers, COUNT(DISTINCT c.c_custkey) AS number_of_customers, AVG(s.s_acctbal) AS avg_supplier_acctbal, AVG(c.c_acctbal) AS avg_customer_acctbal, SUM(o.o_totalprice) AS total_order_value, AVG(ps.ps_supplycost) AS avg_supply_cost, AVG(p.p_retailprice) AS avg_retail_price, COUNT(DISTINCT o.o_orderkey) AS number_of_orders FROM nation n INNER JOIN supplier s ON n.n_nationkey = s.s_nationkey INNER JOIN customer c ON n.n_nationkey = c.c_nationkey INNER JOIN orders o ON c.c_custkey = o.o_custkey INNER JOIN partsupp ps ON s.s_suppkey = ps.ps_suppkey INNER JOIN part p ON ps.ps_partkey = p.p_partkey WHERE n.n_regionkey IN (1, 2, 3) AND o.o_orderstatus = 'F' AND c.c_comment LIKE '%final instructions%' AND (ps.ps_comment LIKE '%express instructions%' OR ps.ps_comment LIKE '%blithely busy pinto beans%' OR ps.ps_comment LIKE '%blithely regular packages%') GROUP BY n.n_name ORDER BY total_order_value DESC;
SELECT r.r_name AS region, n.n_name AS nation, SUBSTRING(cast(o.o_orderdate as varchar),1,7) AS order_month, COUNT(DISTINCT o.o_orderkey) AS total_orders, SUM(l.l_extendedprice) AS total_sales, AVG(l.l_quantity) AS average_quantity, SUM(l.l_extendedprice * (1 - l_discount)) AS revenue_after_discount FROM region r JOIN nation n ON r.r_regionkey = n.n_regionkey JOIN supplier s ON n.n_nationkey = s.s_nationkey JOIN partsupp ps ON s.s_suppkey = ps.ps_suppkey JOIN part p ON ps.ps_partkey = p.p_partkey JOIN lineitem l ON l.l_partkey = p.p_partkey AND l.l_suppkey = s.s_suppkey JOIN orders o ON l.l_orderkey = o.o_orderkey WHERE p.p_type IN ('ECONOMY BRUSHED COPPER', 'PROMO POLISHED STEEL', 'PROMO ANODIZED COPPER', 'MEDIUM BRUSHED TIN') AND p.p_mfgr IN ('Manufacturer#5', 'Manufacturer#2', 'Manufacturer#3', 'Manufacturer#4') AND o.o_totalprice BETWEEN 100000 AND 400000 AND s.s_address IN ('XBvROEYEBG9LUlP', 'szG atwAEBGGHTN0bZt72') AND s.s_phone IN ('16-583-227-2011', '18-557-214-4977', '27-903-896-5359', '25-284-265-9211', '28-499-998-7660') GROUP BY region, nation, order_month ORDER BY total_sales DESC, region, nation, order_month LIMIT 10;
SELECT r.r_name AS region_name, COUNT(DISTINCT s.s_suppkey) AS number_of_suppliers, SUM(p.ps_availqty) AS total_available_quantity, AVG(p.ps_supplycost) AS average_supply_cost, SUM(p.ps_supplycost * p.ps_availqty) AS total_supply_value FROM region r JOIN supplier s ON s.s_nationkey = r.r_regionkey JOIN partsupp p ON p.ps_suppkey = s.s_suppkey GROUP BY r.r_name ORDER BY total_supply_value DESC;
SELECT r.r_name AS region_name, n.n_name AS nation_name, COUNT(s.s_suppkey) AS number_of_suppliers, AVG(s.s_acctbal) AS average_account_balance, SUM(p.ps_availqty) AS total_available_quantity, AVG(p.ps_supplycost) AS average_supply_cost FROM region r JOIN nation n ON r.r_regionkey = n.n_regionkey JOIN supplier s ON n.n_nationkey = s.s_nationkey JOIN partsupp p ON s.s_suppkey = p.ps_suppkey GROUP BY r.r_name, n.n_name ORDER BY r.r_name, n.n_name;
SELECT r.r_name AS region, COUNT(DISTINCT s.s_suppkey) AS total_suppliers, AVG(s.s_acctbal) AS average_account_balance, SUM(ps.ps_availqty) AS total_available_quantity, AVG(ps.ps_supplycost) AS average_supply_cost, COUNT(DISTINCT l.l_orderkey) AS total_orders, SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_revenue, SUM(CASE WHEN l.l_returnflag = 'F' THEN l.l_quantity ELSE 0 END) AS total_finalized_quantity, SUM(CASE WHEN l.l_returnflag = 'O' THEN l.l_quantity ELSE 0 END) AS total_open_quantity FROM region r JOIN supplier s ON r.r_regionkey = s.s_nationkey JOIN partsupp ps ON s.s_suppkey = ps.ps_suppkey JOIN lineitem l ON ps.ps_partkey = l.l_partkey AND ps.ps_suppkey = l.l_suppkey WHERE s.s_acctbal > 0 AND l.l_linestatus IN ('F', 'O') AND l.l_shipdate >= '2022-01-01' AND l.l_shipdate < '2023-01-01' GROUP BY r.r_name ORDER BY total_revenue DESC;
SELECT r.r_name AS region, n.n_name AS nation, COUNT(DISTINCT s.s_suppkey) AS total_suppliers, COUNT(DISTINCT c.c_custkey) AS total_customers, SUM(l.l_extendedprice * (1 - l.l_discount)) AS revenue, AVG(l.l_quantity) AS average_quantity, AVG(l.l_extendedprice) AS average_extendedprice, SUM(ps.ps_availqty) AS total_available_quantity FROM region r JOIN nation n ON r.r_regionkey = n.n_regionkey JOIN supplier s ON n.n_nationkey = s.s_nationkey JOIN customer c ON n.n_nationkey = c.c_nationkey JOIN orders o ON c.c_custkey = o.o_custkey JOIN lineitem l ON o.o_orderkey = l.l_orderkey JOIN partsupp ps ON l.l_partkey = ps.ps_partkey AND l.l_suppkey = ps.ps_suppkey JOIN part p ON ps.ps_partkey = p.p_partkey WHERE r.r_name IN ('EUROPE', 'AMERICA') AND p.p_brand IN ('Brand#44', 'Brand#21') AND o.o_orderdate BETWEEN DATE '1995-01-01' AND DATE '1995-12-31' AND l.l_shipdate > o.o_orderdate GROUP BY r.r_name, n.n_name ORDER BY revenue DESC, total_suppliers DESC;
SELECT r.r_name AS region_name, p.p_type AS part_type, AVG(ps.ps_supplycost) AS avg_supply_cost, SUM(ps.ps_availqty) AS total_avail_qty FROM partsupp ps INNER JOIN part p ON ps.ps_partkey = p.p_partkey INNER JOIN nation n ON n.n_nationkey = ps.ps_suppkey INNER JOIN region r ON r.r_regionkey = n.n_regionkey WHERE p.p_type IN ('LARGE ANODIZED BRASS', 'PROMO PLATED BRASS', 'PROMO BURNISHED BRASS', 'PROMO BURNISHED TIN') AND p.p_retailprice > 100.00 GROUP BY r.r_name, p.p_type ORDER BY r.r_name, avg_supply_cost DESC;
SELECT r.r_name AS region_name, n.n_name AS nation_name, COUNT(DISTINCT c.c_custkey) AS number_of_customers, AVG(c.c_acctbal) AS average_account_balance, SUM(o.o_totalprice) AS total_sales, COUNT(DISTINCT o.o_orderkey) AS number_of_orders, AVG(p.p_retailprice) AS average_part_retail_price, SUM(ps.ps_availqty) AS total_available_quantity FROM region r JOIN nation n ON r.r_regionkey = n.n_regionkey JOIN customer c ON n.n_nationkey = c.c_nationkey JOIN orders o ON c.c_custkey = o.o_custkey JOIN partsupp ps ON ps.ps_suppkey = o.o_custkey JOIN part p ON ps.ps_partkey = p.p_partkey WHERE r.r_regionkey IN (0, 3, 4) AND p.p_brand = 'Brand#35' AND c.c_acctbal IN (9742.44, 3324.85, 8172.98) AND n.n_nationkey IN (0, 2) GROUP BY region_name, nation_name ORDER BY total_sales DESC;
SELECT r.r_name AS region_name, n.n_name AS nation_name, COUNT(DISTINCT c.c_custkey) AS customer_count, COUNT(DISTINCT s.s_suppkey) AS supplier_count, AVG(c.c_acctbal) AS avg_customer_acctbal, SUM(o.o_totalprice) AS total_sales, AVG(o.o_totalprice) AS avg_order_value FROM customer c JOIN nation n ON c.c_nationkey = n.n_nationkey JOIN region r ON n.n_regionkey = r.r_regionkey JOIN orders o ON c.c_custkey = o.o_custkey JOIN supplier s ON n.n_nationkey = s.s_nationkey WHERE r.r_regionkey IN (1, 0, 2) AND n.n_name <> 'MOROCCO' AND o.o_orderdate BETWEEN '2022-01-01' AND '2022-12-31' GROUP BY r.r_name, n.n_name ORDER BY total_sales DESC, avg_order_value DESC, region_name, nation_name;
SELECT s_name, s_nationkey, c_mktsegment, sum(ps_availqty) AS total_available_quantity, avg(ps_supplycost) AS average_supply_cost, count(l_orderkey) AS number_of_orders, sum(l_extendedprice * (1 - l_discount)) AS total_revenue FROM supplier JOIN partsupp ON supplier.s_suppkey = partsupp.ps_suppkey JOIN lineitem ON partsupp.ps_partkey = lineitem.l_partkey AND partsupp.ps_suppkey = lineitem.l_suppkey JOIN customer ON supplier.s_nationkey = customer.c_nationkey WHERE lineitem.l_orderkey IN ('2144', '3621', '3808', '2951', '3712', '4199') GROUP BY s_name, s_nationkey, c_mktsegment ORDER BY total_revenue DESC, total_available_quantity DESC LIMIT 10;
SELECT r_name AS region, n_name AS nation, COUNT(o_orderkey) AS total_orders, SUM(o_totalprice) AS total_revenue, AVG(o_totalprice) AS average_order_value, MAX(o_totalprice) AS max_order_value, MIN(o_totalprice) AS min_order_value FROM region JOIN nation ON n_regionkey = r_regionkey JOIN orders ON o_custkey = n_nationkey WHERE o_orderstatus = 'F' AND o_shippriority = 0 AND o_orderdate BETWEEN '1995-01-01' AND '1995-12-31' GROUP BY r_name, n_name ORDER BY total_revenue DESC, region, nation;
SELECT r_name AS region, n_name AS nation, COUNT(DISTINCT c_custkey) AS num_customers, COUNT(DISTINCT o_orderkey) AS num_orders, SUM(l_extendedprice * (1 - l_discount)) AS total_revenue, AVG(c_acctbal) AS average_account_balance, SUM(l_quantity) AS total_quantity_ordered FROM region JOIN nation ON r_regionkey = n_regionkey JOIN customer ON n_nationkey = c_nationkey JOIN orders ON c_custkey = o_custkey JOIN lineitem ON o_orderkey = l_orderkey WHERE o_orderstatus = 'O' AND n_nationkey IN (4, 15, 14) AND l_shipdate BETWEEN '1995-01-01' AND '1995-12-31' GROUP BY r_name, n_name ORDER BY total_revenue DESC, num_orders DESC;
SELECT s.s_name, s.s_nationkey, AVG(s.s_acctbal) AS average_account_balance, SUM(ps.ps_supplycost * ps.ps_availqty) AS total_supply_cost, COUNT(DISTINCT l.l_orderkey) AS total_orders, SUM(l.l_extendedprice * (1 - l_discount)) AS total_revenue FROM supplier s JOIN partsupp ps ON s.s_suppkey = ps.ps_suppkey JOIN lineitem l ON ps.ps_partkey = l.l_partkey AND ps.ps_suppkey = l.l_suppkey WHERE s.s_acctbal > 1000 AND ps.ps_partkey IN (831, 585, 1034, 533, 1053, 695) GROUP BY s.s_name, s.s_nationkey ORDER BY total_revenue DESC, average_account_balance DESC LIMIT 10;
SELECT r.r_name AS region, AVG(ps.ps_supplycost) AS average_supply_cost, SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_revenue, COUNT(DISTINCT s.s_suppkey) AS number_of_suppliers, COUNT(DISTINCT p.p_partkey) AS number_of_parts FROM region r JOIN supplier s ON s.s_nationkey = r.r_regionkey JOIN partsupp ps ON s.s_suppkey = ps.ps_suppkey JOIN part p ON ps.ps_partkey = p.p_partkey JOIN lineitem l ON p.p_partkey = l.l_partkey AND s.s_suppkey = l.l_suppkey WHERE p.p_mfgr IN ('Manufacturer#1', 'Manufacturer#2', 'Manufacturer#3') AND l.l_shipinstruct = 'TAKE BACK RETURN' AND r.r_comment IN ('ly final courts cajole furiously final excuse', 'ges. thinly even pinto beans ca', 'hs use ironic, even requests. s') GROUP BY r.r_name ORDER BY total_revenue DESC;
SELECT r.r_name AS region, n.n_name AS nation, COUNT(p.p_partkey) AS number_of_parts, AVG(p.p_retailprice) AS average_retail_price, SUM(p.p_retailprice) AS total_retail_value, MAX(p.p_size) AS max_part_size, MIN(p.p_size) AS min_part_size FROM region r JOIN nation n ON r.r_regionkey = n.n_regionkey JOIN part p ON p.p_size BETWEEN 1 AND 15 WHERE n.n_comment LIKE '%final%' AND p.p_type LIKE '%STEEL' GROUP BY r.r_name, n.n_name ORDER BY total_retail_value DESC, average_retail_price DESC;
SELECT r.r_name AS region, COUNT(DISTINCT c.c_custkey) AS number_of_customers, AVG(c.c_acctbal) AS average_account_balance, SUM(l.l_quantity) AS total_quantity_ordered, AVG(l.l_extendedprice * (1 - l.l_discount)) AS average_invoice_amount, COUNT(DISTINCT l.l_orderkey) AS number_of_orders, COUNT(*) AS line_items_count FROM region r JOIN customer c ON r.r_regionkey = c.c_nationkey JOIN lineitem l ON c.c_custkey = l.l_suppkey WHERE r.r_name IN ('MIDDLE EAST', 'ASIA', 'EUROPE', 'AMERICA', 'AFRICA') AND l.l_shipinstruct IN ('COLLECT COD', 'TAKE BACK RETURN', 'DELIVER IN PERSON') AND c.c_custkey IN (4012, 2486, 3487, 1377, 379) AND c.c_acctbal IN (103.69, 9782.34, 6041.59, 3390.85) AND l.l_shipdate BETWEEN '2022-01-01' AND '2022-12-31' GROUP BY r.r_name ORDER BY average_account_balance DESC;
SELECT r.r_name AS region, n.n_name AS nation, COUNT(DISTINCT c.c_custkey) AS total_customers, COUNT(DISTINCT s.s_suppkey) AS total_suppliers, SUM(o.o_totalprice) AS total_sales, AVG(c.c_acctbal) AS average_customer_balance, AVG(s.s_acctbal) AS average_supplier_balance, COUNT(DISTINCT o.o_orderkey) AS total_orders, SUM(ps.ps_availqty) AS total_parts_available FROM region r JOIN nation n ON r.r_regionkey = n.n_regionkey JOIN customer c ON n.n_nationkey = c.c_nationkey JOIN supplier s ON n.n_nationkey = s.s_nationkey JOIN orders o ON c.c_custkey = o.o_custkey JOIN partsupp ps ON s.s_suppkey = ps.ps_suppkey WHERE r.r_name IN ('Europe', 'Asia') AND o.o_orderdate BETWEEN '2022-01-01' AND '2022-12-31' AND c.c_mktsegment = 'AUTOMOBILE' GROUP BY r.r_name, n.n_name ORDER BY total_sales DESC, region, nation;
SELECT n.n_name, COUNT(DISTINCT s.s_suppkey) AS number_of_suppliers, SUM(l.l_extendedprice * (1 - l.l_discount)) AS revenue, AVG(l.l_quantity) AS average_quantity, AVG(s.s_acctbal) AS average_account_balance FROM nation n JOIN supplier s ON s.s_nationkey = n.n_nationkey JOIN partsupp ps ON ps.ps_suppkey = s.s_suppkey JOIN lineitem l ON l.l_suppkey = s.s_suppkey AND l.l_partkey = ps.ps_partkey WHERE n.n_regionkey IN (2, 3, 4) AND s.s_acctbal > -1000 AND l.l_shipdate BETWEEN '2022-01-01' AND '2022-12-31' GROUP BY n.n_name HAVING COUNT(DISTINCT s.s_suppkey) > 5 ORDER BY revenue DESC;
SELECT c.c_name, s.s_name, p.p_type, SUM(l.l_extendedprice) AS total_sales, AVG(l.l_discount) AS average_discount, COUNT(*) AS number_of_orders FROM customer c JOIN lineitem l ON c.c_custkey = l.l_orderkey JOIN supplier s ON l.l_suppkey = s.s_suppkey JOIN part p ON l.l_partkey = p.p_partkey JOIN partsupp ps ON p.p_partkey = ps.ps_partkey AND s.s_suppkey = ps.ps_suppkey WHERE c.c_nationkey = 16 AND l.l_shipdate BETWEEN '1993-01-01' AND '1995-12-31' AND l.l_tax IN (0.08, 0.07, 0.06, 0.01, 0.05) AND ps.ps_supplycost BETWEEN 120.01 AND 730.56 AND c.c_name IN ('Customer#000025485', 'Customer#000028082', 'Customer#000027586', 'Customer#000025037') GROUP BY c.c_name, s.s_name, p.p_type ORDER BY total_sales DESC, average_discount;
SELECT r.r_name AS region, COUNT(DISTINCT s.s_suppkey) AS number_of_suppliers, AVG(s.s_acctbal) AS average_account_balance, SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_sales, AVG(p.p_retailprice) AS average_retail_price FROM region r JOIN supplier s ON s.s_nationkey = r.r_regionkey JOIN partsupp ps ON ps.ps_suppkey = s.s_suppkey JOIN part p ON p.p_partkey = ps.ps_partkey JOIN lineitem l ON l.l_partkey = ps.ps_partkey AND l.l_suppkey = ps.ps_suppkey JOIN orders o ON o.o_orderkey = l.l_orderkey WHERE r.r_name = 'EUROPE' AND o.o_orderdate BETWEEN '1995-01-01' AND '1995-12-31' AND l.l_returnflag = 'N' GROUP BY r.r_name ORDER BY total_sales DESC;
SELECT c.c_mktsegment, s.s_name, AVG(ps.ps_supplycost) AS avg_supplycost, SUM(l.l_extendedprice * (1 - l.l_discount)) AS revenue, COUNT(DISTINCT o.o_orderkey) AS total_orders FROM customer c JOIN orders o ON c.c_custkey = o.o_custkey JOIN lineitem l ON o.o_orderkey = l.l_orderkey JOIN partsupp ps ON l.l_partkey = ps.ps_partkey AND l.l_suppkey = ps.ps_suppkey JOIN supplier s ON ps.ps_suppkey = s.s_suppkey WHERE c.c_mktsegment IN ('BUILDING', 'AUTOMOBILE') AND s.s_acctbal > 0 AND ps.ps_comment LIKE '%slyly unusual ideas cajole alongside of the busy id%' AND o.o_orderdate BETWEEN '1992-01-01' AND '1998-12-31' GROUP BY c.c_mktsegment, s.s_name ORDER BY revenue DESC, s.s_name LIMIT 10;
SELECT n.n_name, p.p_brand, p.p_type, p.p_size, AVG(p.p_retailprice) AS avg_retail_price, SUM(ps.ps_availqty) AS total_avail_qty, AVG(ps.ps_supplycost) AS avg_supply_cost, COUNT(DISTINCT ps.ps_suppkey) AS supplier_count FROM nation n JOIN partsupp ps ON n.n_nationkey = ps.ps_suppkey JOIN part p ON ps.ps_partkey = p.p_partkey WHERE p.p_brand IN ('Brand#24', 'Brand#45', 'Brand#12', 'Brand#33') GROUP BY n.n_name, p.p_brand, p.p_type, p.p_size ORDER BY avg_retail_price DESC, total_avail_qty DESC;
SELECT li.l_suppkey AS SupplierKey, COUNT(DISTINCT li.l_partkey) AS UniquePartsSupplied, SUM(li.l_quantity) AS TotalQuantitySupplied, SUM(psup.ps_supplycost * li.l_quantity) AS TotalSupplyCost, AVG(psup.ps_supplycost) AS AverageSupplyCostPerPart FROM lineitem li INNER JOIN partsupp psup ON li.l_partkey = psup.ps_partkey AND li.l_suppkey = psup.ps_suppkey INNER JOIN orders o ON li.l_orderkey = o.o_orderkey WHERE o.o_shippriority > 0 AND o.o_orderdate >= date '2022-01-01' AND o.o_orderdate <= date '2022-12-31' GROUP BY li.l_suppkey ORDER BY TotalSupplyCost DESC, TotalQuantitySupplied DESC LIMIT 10;
SELECT s.s_name AS supplier_name, p.p_type AS part_type, c.c_mktsegment AS customer_market_segment, AVG(l.l_quantity) AS avg_quantity_sold, SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_sales_value, COUNT(DISTINCT l.l_orderkey) AS number_of_orders FROM supplier s JOIN partsupp ps ON s.s_suppkey = ps.ps_suppkey JOIN part p ON ps.ps_partkey = p.p_partkey JOIN lineitem l ON l.l_partkey = ps.ps_partkey AND l.l_suppkey = ps.ps_suppkey JOIN customer c ON c.c_nationkey = s.s_nationkey WHERE p.p_type = 'SMALL BRUSHED NICKEL' AND p.p_size BETWEEN 3 AND 46 AND l.l_shipdate >= date '1995-01-01' AND l.l_shipdate < date '1996-01-01' AND c.c_mktsegment = 'AUTOMOBILE' AND s.s_address IN ('8DpgGlySUvFOkCl', 'QuAFZ I2px9aanSMKHHyLL', 'xp1tjragqFS8uakB9CL9AC4UXTrOGKnFqgobEB9', 'KGG6eZpBUXryIkVPkF2l bZTI') GROUP BY supplier_name, part_type, customer_market_segment ORDER BY total_sales_value DESC, supplier_name;
SELECT r.r_name AS region, n.n_name AS nation, c.c_mktsegment AS market_segment, count(DISTINCT o.o_orderkey) AS total_orders, sum(l.l_extendedprice * (1 - l.l_discount)) AS total_revenue, avg(l.l_quantity) AS avg_quantity, avg(l.l_extendedprice) AS avg_price, avg(l.l_discount) AS avg_discount FROM orders o JOIN customer c ON c.c_custkey = o.o_custkey JOIN nation n ON n.n_nationkey = c.c_nationkey JOIN region r ON r.r_regionkey = n.n_regionkey JOIN lineitem l ON l.l_orderkey = o.o_orderkey WHERE o.o_orderdate >= date '1995-01-01' AND o.o_orderdate < date '1996-01-01' AND l.l_shipdate > o.o_orderdate AND r.r_name = 'EUROPE' GROUP BY region, nation, market_segment ORDER BY total_revenue DESC, total_orders DESC;
SELECT r.r_name AS region, COUNT(DISTINCT s.s_suppkey) AS total_suppliers, SUM(l.l_quantity) AS total_quantity, AVG(l.l_extendedprice) AS avg_price, AVG(l.l_discount) AS avg_discount, SUM(l.l_extendedprice * (1 - l_discount)) AS total_revenue FROM region r JOIN supplier s ON r.r_regionkey = s.s_nationkey JOIN lineitem l ON s.s_suppkey = l.l_suppkey JOIN orders o ON l.l_orderkey = o.o_orderkey WHERE o.o_orderpriority IN ('3-MEDIUM', '5-LOW', '4-NOT SPECIFIED') AND o.o_orderdate > CURRENT_DATE - INTERVAL '1 year' GROUP BY r.r_name ORDER BY total_revenue DESC, avg_price DESC;
SELECT r_name AS region, n_name AS nation, COUNT(l_orderkey) AS total_orders, SUM(l_extendedprice) AS total_sales, AVG(l_extendedprice * (1 - l_discount)) AS avg_discounted_sales, SUM(l_quantity) AS total_quantity, AVG(ps_supplycost) AS avg_supply_cost, SUM(ps_availqty) AS total_available_quantity FROM region JOIN nation ON r_regionkey = n_regionkey JOIN partsupp ON ps_suppkey = n_nationkey JOIN lineitem ON l_partkey = ps_partkey GROUP BY region, nation ORDER BY total_sales DESC, total_orders DESC;
SELECT r.r_name AS region, COUNT(DISTINCT o.o_orderkey) AS total_orders, SUM(l.l_quantity) AS total_quantity, AVG(l.l_extendedprice) AS avg_price, SUM((l.l_extendedprice * (1 - l.l_discount)) * (1 + l.l_tax)) AS revenue, AVG(ps.ps_supplycost) AS avg_supply_cost, COUNT(DISTINCT l.l_partkey) AS num_parts, COUNT(DISTINCT l.l_suppkey) AS num_suppliers FROM region r JOIN partsupp ps ON r.r_regionkey = ps.ps_suppkey JOIN lineitem l ON ps.ps_partkey = l.l_partkey AND ps.ps_suppkey = l.l_suppkey JOIN orders o ON l.l_orderkey = o.o_orderkey WHERE r.r_name IN ('MIDDLE EAST', 'ASIA', 'EUROPE', 'AMERICA', 'AFRICA') AND o.o_orderstatus = 'F' GROUP BY r.r_name ORDER BY revenue DESC;
SELECT c_mktsegment, avg(c_acctbal) AS avg_customer_balance, sum(l_extendedprice) AS total_sales, sum(l_extendedprice * (1 - l_discount)) AS total_revenue_after_discount, sum(l_quantity) AS total_quantity_sold, count(DISTINCT c_custkey) AS number_of_customers, count(DISTINCT o_orderkey) AS number_of_orders FROM customer JOIN orders ON c_custkey = o_custkey JOIN lineitem ON o_orderkey = l_orderkey WHERE c_phone IN ('20-575-839-6001', '29-715-109-4065', '24-296-834-6966', '17-307-523-6875', '32-719-964-8079') AND c_mktsegment IN ('AUTOMOBILE', 'MACHINERY', 'HOUSEHOLD', 'BUILDING') AND l_shipdate > o_orderdate GROUP BY c_mktsegment ORDER BY total_revenue_after_discount DESC;
SELECT r.r_name AS region, n.n_name AS nation, COUNT(DISTINCT s.s_suppkey) AS number_of_suppliers, COUNT(DISTINCT c.c_custkey) AS number_of_customers, SUM(ps.ps_availqty) AS total_available_quantity, AVG(s.s_acctbal) AS average_supplier_account_balance, AVG(c.c_acctbal) AS average_customer_account_balance, SUM(l.l_extendedprice * (1 - l_discount)) AS total_revenue, SUM(CASE WHEN c.c_mktsegment = 'HOUSEHOLD' THEN l.l_quantity ELSE 0 END) AS household_segment_quantity, SUM(CASE WHEN p.p_brand = 'Brand#51' THEN l.l_extendedprice * (1 - l_discount) ELSE 0 END) AS brand_51_revenue FROM region r JOIN nation n ON r.r_regionkey = n.n_regionkey JOIN supplier s ON n.n_nationkey = s.s_nationkey JOIN customer c ON n.n_nationkey = c.c_nationkey JOIN partsupp ps ON s.s_suppkey = ps.ps_suppkey JOIN lineitem l ON ps.ps_partkey = l.l_partkey AND ps.ps_suppkey = l.l_suppkey JOIN part p ON l.l_partkey = p.p_partkey WHERE r.r_regionkey IN (1, 4, 0, 2, 3) AND c.c_mktsegment IN ('HOUSEHOLD', 'MACHINERY', 'AUTOMOBILE', 'BUILDING') AND l.l_shipdate BETWEEN date '2022-01-01' AND date '2022-12-31' GROUP BY r.r_name, n.n_name ORDER BY total_revenue DESC, region, nation;
SELECT n.n_name AS nation_name, c.c_mktsegment AS market_segment, COUNT(DISTINCT c.c_custkey) AS customer_count, SUM(li.l_quantity) AS total_quantity, AVG(c.c_acctbal) AS average_account_balance, SUM(li.l_extendedprice * (1 - li.l_discount)) AS total_discounted_sales FROM customer c JOIN nation n ON c.c_nationkey = n.n_nationkey JOIN lineitem li ON c.c_custkey = CAST(SUBSTRING(li.l_shipmode, 1, POSITION('-' IN li.l_shipmode) - 1) AS INTEGER) WHERE n.n_regionkey = 0 AND li.l_receiptdate BETWEEN '1996-01-01' AND '1997-12-31' AND li.l_returnflag = 'A' AND c.c_comment LIKE '%final%' GROUP BY nation_name, market_segment ORDER BY total_discounted_sales DESC, average_account_balance DESC;
SELECT s_nationkey, p_brand, p_type, SUM(l_extendedprice) AS total_revenue, AVG(l_quantity) AS average_quantity, COUNT(DISTINCT l_orderkey) AS number_of_orders, COUNT(DISTINCT l_suppkey) AS number_of_suppliers FROM supplier JOIN lineitem ON supplier.s_suppkey = lineitem.l_suppkey JOIN partsupp ON lineitem.l_suppkey = partsupp.ps_suppkey AND lineitem.l_partkey = partsupp.ps_partkey JOIN part ON partsupp.ps_partkey = part.p_partkey WHERE lineitem.l_returnflag = 'N' AND part.p_container IN ('MED BOX', 'LG CAN', 'JUMBO CASE') AND lineitem.l_discount BETWEEN 0.01 AND 0.09 AND NOT (supplier.s_comment LIKE '%Customer%Complaints%' AND part.p_brand = 'Brand#45') GROUP BY s_nationkey, p_brand, p_type ORDER BY total_revenue DESC, s_nationkey, p_brand, p_type;
SELECT n.n_name AS nation, c.c_mktsegment AS market_segment, SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_revenue, AVG(c.c_acctbal) AS average_customer_acctbal, COUNT(DISTINCT o.o_orderkey) AS total_orders FROM nation n JOIN customer c ON c.c_nationkey = n.n_nationkey JOIN orders o ON o.o_custkey = c.c_custkey JOIN lineitem l ON l.l_orderkey = o.o_orderkey WHERE o.o_orderdate >= DATE '1995-01-01' AND o.o_orderdate < DATE '1995-02-01' GROUP BY n.n_name, c.c_mktsegment ORDER BY total_revenue DESC, n.n_name, c.c_mktsegment;
SELECT n.n_name AS nation, c.c_mktsegment AS market_segment, COUNT(DISTINCT o.o_orderkey) AS total_orders, AVG(o.o_totalprice) AS average_order_price, SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_revenue, AVG(l.l_quantity) AS average_quantity_sold FROM customer AS c JOIN orders AS o ON c.c_custkey = o.o_custkey JOIN lineitem AS l ON o.o_orderkey = l.l_orderkey JOIN nation AS n ON c.c_nationkey = n.n_nationkey WHERE l.l_shipinstruct = 'DELIVER IN PERSON' AND c.c_phone LIKE '31-%' AND l.l_shipdate BETWEEN '1995-01-01' AND '1996-12-31' GROUP BY nation, market_segment ORDER BY total_revenue DESC, average_order_price DESC;
SELECT r.r_name AS region_name, EXTRACT(YEAR FROM o.o_orderdate) AS order_year, COUNT(DISTINCT l.l_orderkey) AS total_orders, SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_sales, AVG(l.l_discount) AS average_discount, COUNT(DISTINCT ps.ps_suppkey) AS number_of_suppliers, AVG(ps.ps_supplycost) AS average_supply_cost FROM region r JOIN partsupp ps ON ps.ps_suppkey = r.r_regionkey JOIN lineitem l ON l.l_suppkey = ps.ps_suppkey AND l.l_partkey = ps.ps_partkey JOIN orders o ON l.l_orderkey = o.o_orderkey WHERE EXTRACT(YEAR FROM o.o_orderdate) = 2023 GROUP BY r.r_name, order_year ORDER BY r.r_name, total_sales DESC;
SELECT r.r_name AS region, COUNT(DISTINCT s.s_suppkey) AS total_suppliers, COUNT(DISTINCT c.c_custkey) AS total_customers, COUNT(DISTINCT o.o_orderkey) AS total_orders, AVG(s.s_acctbal) AS avg_supplier_acctbal, AVG(c.c_acctbal) AS avg_customer_acctbal, SUM(o.o_totalprice) AS total_revenue FROM region r JOIN supplier s ON s.s_nationkey = r.r_regionkey JOIN customer c ON c.c_nationkey = r.r_regionkey JOIN orders o ON o.o_custkey = c.c_custkey WHERE c.c_mktsegment = 'BUILDING' AND r.r_name IN ('MIDDLE EAST', 'ASIA', 'EUROPE', 'AMERICA', 'AFRICA') GROUP BY r.r_name ORDER BY total_revenue DESC, total_customers DESC;
SELECT n.n_name AS nation_name, COUNT(DISTINCT c.c_custkey) AS customer_count, COUNT(DISTINCT s.s_suppkey) AS supplier_count, AVG(c.c_acctbal) AS avg_customer_acctbal, SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_sales, MAX(o.o_totalprice) AS max_order_totalprice FROM nation n JOIN customer c ON n.n_nationkey = c.c_nationkey JOIN supplier s ON n.n_nationkey = s.s_nationkey JOIN orders o ON c.c_custkey = o.o_custkey JOIN lineitem l ON o.o_orderkey = l.l_orderkey WHERE n.n_name IN ('INDIA', 'MOROCCO', 'VIETNAM') AND l.l_shipdate BETWEEN '2020-01-01' AND '2020-12-31' GROUP BY n.n_name ORDER BY total_sales DESC, nation_name;
SELECT r.r_name AS region, n.n_name AS nation, COUNT(c.c_custkey) AS number_of_customers, AVG(c.c_acctbal) AS average_account_balance, SUM(p.p_retailprice) AS total_retail_price_of_parts, COUNT(DISTINCT p.p_type) AS number_of_unique_part_types FROM region r JOIN nation n ON r.r_regionkey = n.n_regionkey JOIN customer c ON n.n_nationkey = c.c_nationkey JOIN part p ON p.p_size BETWEEN 1 AND 5 WHERE r.r_name IN ('EUROPE', 'ASIA', 'AMERICA') AND c.c_mktsegment IN ('AUTOMOBILE', 'BUILDING') AND p.p_type LIKE '%BRUSHED%' AND p.p_container IN ('SMALL BOX', 'LARGE BOX') GROUP BY r.r_name, n.n_name ORDER BY total_retail_price_of_parts DESC, average_account_balance DESC, number_of_customers DESC;
SELECT s_name, p_brand, p_type, AVG(ps_supplycost) AS average_supply_cost, SUM(ps_availqty) AS total_available_quantity, COUNT(DISTINCT o_orderkey) AS number_of_orders, SUM(o_totalprice) AS total_order_value FROM supplier JOIN partsupp ON s_suppkey = ps_suppkey JOIN part ON ps_partkey = p_partkey LEFT JOIN orders ON s_suppkey = o_custkey WHERE ps_supplycost > 500 AND p_type LIKE 'ECONOMY%' AND o_orderstatus = 'F' GROUP BY s_name, p_brand, p_type HAVING SUM(ps_availqty) > 1000 ORDER BY total_order_value DESC, average_supply_cost;
SELECT n.n_name AS nation, COUNT(DISTINCT ps.ps_partkey) AS distinct_parts_count, AVG(ps.ps_supplycost) AS average_supply_cost, SUM(ps.ps_availqty) AS total_available_quantity FROM nation n JOIN partsupp ps ON ps.ps_suppkey = n.n_nationkey JOIN part p ON p.p_partkey = ps.ps_partkey GROUP BY n.n_name ORDER BY average_supply_cost DESC, total_available_quantity DESC;
SELECT r.r_name as region, n.n_name as nation, p.p_brand, COUNT(DISTINCT o.o_orderkey) as num_orders, SUM(l.l_extendedprice * (1 - l.l_discount)) as total_revenue, AVG(c.c_acctbal) as avg_customer_balance FROM region r JOIN nation n ON r.r_regionkey = n.n_regionkey JOIN supplier s ON n.n_nationkey = s.s_nationkey JOIN customer c ON n.n_nationkey = c.c_nationkey JOIN orders o ON c.c_custkey = o.o_custkey JOIN lineitem l ON o.o_orderkey = l.l_orderkey JOIN part p ON l.l_partkey = p.p_partkey WHERE r.r_name IN ('AMERICA', 'ASIA') AND p.p_brand IN ('Brand#35', 'Brand#55') AND o.o_orderdate >= DATE '1993-01-01' AND o.o_orderdate < DATE '1994-01-01' AND c.c_comment LIKE '%ironic%' AND l.l_shipdate > l.l_commitdate GROUP BY r.r_name, n.n_name, p.p_brand ORDER BY total_revenue DESC, region, nation, p.p_brand;
SELECT r_name AS region, n_name AS nation, COUNT(DISTINCT s_suppkey) AS number_of_suppliers, COUNT(DISTINCT c_custkey) AS number_of_customers, SUM(l_extendedprice * (1 - l_discount)) AS total_sales, AVG(l_quantity) AS average_quantity_sold, AVG(c_acctbal) AS average_customer_balance FROM region JOIN nation ON n_regionkey = r_regionkey JOIN supplier ON s_nationkey = n_nationkey JOIN customer ON c_nationkey = n_nationkey JOIN orders ON o_custkey = c_custkey JOIN lineitem ON l_orderkey = o_orderkey AND l_suppkey = s_suppkey GROUP BY region, nation ORDER BY total_sales DESC LIMIT 5;
SELECT r.r_name AS region_name, COUNT(DISTINCT s.s_suppkey) AS number_of_suppliers, COUNT(DISTINCT n.n_nationkey) AS number_of_nations, AVG(s.s_acctbal) AS avg_supplier_acct_balance, AVG(ps.ps_supplycost) AS avg_supply_cost, SUM(ps.ps_availqty) AS total_available_quantity FROM region r JOIN nation n ON r.r_regionkey = n.n_regionkey JOIN supplier s ON n.n_nationkey = s.s_nationkey JOIN partsupp ps ON s.s_suppkey = ps.ps_suppkey GROUP BY r.r_name ORDER BY r.r_name;
SELECT r.r_name AS region, n.n_name AS nation, p.p_type AS part_type, COUNT(DISTINCT s.s_suppkey) AS total_suppliers, COUNT(DISTINCT o.o_orderkey) AS total_orders, SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_revenue, AVG(l.l_quantity) AS average_quantity, AVG(l.l_extendedprice) AS average_price, MAX(s.s_acctbal) AS max_supplier_acctbal FROM region r JOIN nation n ON r.r_regionkey = n.n_regionkey JOIN supplier s ON n.n_nationkey = s.s_nationkey JOIN partsupp ps ON s.s_suppkey = ps.ps_suppkey JOIN part p ON ps.ps_partkey = p.p_partkey JOIN lineitem l ON p.p_partkey = l.l_partkey AND s.s_suppkey = l.l_suppkey JOIN orders o ON l.l_orderkey = o.o_orderkey WHERE o.o_orderstatus = 'F' AND l.l_linestatus = 'F' AND p.p_type IN ('SMALL BRUSHED BRASS', 'ECONOMY PLATED COPPER', 'LARGE BRUSHED STEEL') GROUP BY region, nation, part_type ORDER BY total_revenue DESC, region, nation, part_type;
SELECT r_name AS region, n_name AS nation, COUNT(DISTINCT s_suppkey) AS supplier_count, COUNT(DISTINCT c_custkey) AS customer_count, AVG(s_acctbal) AS avg_supplier_acctbal, AVG(c_acctbal) AS avg_customer_acctbal, SUM(ps_availqty) AS total_partsupply_quantity, SUM(o_totalprice) AS total_order_value FROM region JOIN nation ON r_regionkey = n_regionkey JOIN supplier ON n_nationkey = s_nationkey JOIN customer ON n_nationkey = c_nationkey JOIN partsupp ON s_suppkey = ps_suppkey JOIN orders ON c_custkey = o_custkey WHERE s_phone IN ('28-923-811-2946', '32-666-395-9711', '22-163-107-5664', '28-252-244-8841') AND c_mktsegment = 'FURNITURE' AND o_orderdate BETWEEN '1995-01-01' AND '1995-12-31' GROUP BY r_name, n_name ORDER BY total_order_value DESC, avg_supplier_acctbal DESC;
SELECT r.r_name AS region_name, COUNT(DISTINCT c.c_custkey) AS total_customers, SUM(li.l_extendedprice * (1 - li.l_discount)) AS total_revenue, AVG(li.l_extendedprice * (1 - li.l_discount)) AS avg_revenue_per_order FROM region r JOIN nation n ON r.r_regionkey = n.n_regionkey JOIN customer c ON n.n_nationkey = c.c_nationkey JOIN orders o ON c.c_custkey = o.o_custkey JOIN lineitem li ON o.o_orderkey = li.l_orderkey WHERE EXTRACT(YEAR FROM o.o_orderdate) = 2020 GROUP BY r.r_name ORDER BY total_revenue DESC;
SELECT r_name AS region_name, COUNT(DISTINCT s_suppkey) AS number_of_suppliers, AVG(s_acctbal) AS average_account_balance, COUNT(DISTINCT p_partkey) AS number_of_parts, SUM(l_quantity) AS total_quantity_sold, AVG(l_extendedprice * (1 - l_discount)) AS average_discounted_price, MAX(ps_supplycost) AS max_supply_cost FROM region JOIN nation ON n_regionkey = r_regionkey JOIN supplier ON s_nationkey = n_nationkey JOIN partsupp ON ps_suppkey = s_suppkey JOIN part ON p_partkey = ps_partkey JOIN lineitem ON l_partkey = p_partkey AND l_suppkey = s_suppkey WHERE r_name IN ('EUROPE', 'AMERICA') AND p_type LIKE '%COPPER' AND l_shipdate BETWEEN '1995-01-01' AND '1995-12-31' GROUP BY r_name ORDER BY average_account_balance DESC, total_quantity_sold DESC;
SELECT r.r_name AS region, c.c_mktsegment AS market_segment, EXTRACT(YEAR FROM o_orderdate) AS order_year, COUNT(DISTINCT o_orderkey) AS total_orders, SUM(l_extendedprice * (1 - l_discount)) AS total_revenue, AVG(l_quantity) AS average_quantity, AVG(l_extendedprice) AS average_price, SUM(l_extendedprice * l_discount) AS total_discount_value FROM region r JOIN supplier s ON s.s_nationkey = r.r_regionkey JOIN lineitem l ON l.l_suppkey = s.s_suppkey JOIN orders o ON l.l_orderkey = o.o_orderkey JOIN customer c ON o.o_custkey = c.c_custkey WHERE o.o_orderstatus IN ('F', 'O', 'P') AND l.l_shipdate BETWEEN '1995-01-01' AND '1996-12-31' GROUP BY region, market_segment, order_year ORDER BY region, market_segment, order_year;
SELECT r_name AS region, n_name AS nation, COUNT(DISTINCT c_custkey) AS num_customers, AVG(c_acctbal) AS avg_customer_acctbal, SUM(ps.ps_availqty) AS total_parts_avail, AVG(ps.ps_supplycost) AS avg_part_supply_cost, COUNT(DISTINCT s_suppkey) AS num_suppliers, SUM(o.o_totalprice) AS total_order_value, AVG(o.o_totalprice) AS avg_order_value FROM region JOIN nation ON nation.n_regionkey = region.r_regionkey JOIN customer ON customer.c_nationkey = nation.n_nationkey JOIN orders o ON o.o_custkey = customer.c_custkey JOIN supplier ON supplier.s_nationkey = nation.n_nationkey JOIN partsupp ps ON supplier.s_suppkey = ps.ps_suppkey JOIN part ON part.p_partkey = ps.ps_partkey WHERE o.o_orderstatus = 'O' AND customer.c_mktsegment <> 'AUTOMOBILE' AND part.p_type IN ('SMALL PLATED COPPER', 'PROMO PLATED NICKEL') AND supplier.s_nationkey IN (4, 17) GROUP BY region, nation ORDER BY total_order_value DESC, avg_customer_acctbal DESC LIMIT 10;
SELECT r.r_name AS Region, n.n_name AS Nation, COUNT(DISTINCT s.s_suppkey) AS Total_Suppliers, COUNT(DISTINCT c.c_custkey) AS Total_Customers, COUNT(DISTINCT o.o_orderkey) AS Total_Orders, SUM(l.l_extendedprice * (1 - l.l_discount)) AS Total_Revenue, AVG(l.l_quantity) AS Avg_Quantity, AVG(l.l_extendedprice) AS Avg_Price, AVG(l.l_discount) AS Avg_Discount FROM region r JOIN nation n ON r.r_regionkey = n.n_regionkey JOIN supplier s ON n.n_nationkey = s.s_nationkey JOIN partsupp ps ON s.s_suppkey = ps.ps_suppkey JOIN lineitem l ON ps.ps_suppkey = l.l_suppkey JOIN orders o ON l.l_orderkey = o.o_orderkey JOIN customer c ON o.o_custkey = c.c_custkey AND c.c_nationkey = n.n_nationkey WHERE r.r_comment LIKE '%%final%%' AND ps.ps_comment LIKE '%%quickly%%' AND n.n_comment LIKE '%%even%%' AND l.l_shipdate BETWEEN '1995-01-01' AND '1995-12-31' GROUP BY Region, Nation ORDER BY Total_Revenue DESC;
SELECT r_name AS region, n_name AS nation, COUNT(DISTINCT c_custkey) AS number_of_customers, AVG(c_acctbal) AS average_account_balance, SUM(l_extendedprice * (1 - l_discount)) AS total_sales, COUNT(DISTINCT o_orderkey) AS number_of_orders, AVG(p_retailprice) AS average_retail_price_of_parts, SUM(ps_availqty) AS total_available_quantity FROM region JOIN nation ON n_regionkey = r_regionkey JOIN customer ON c_nationkey = n_nationkey JOIN orders ON o_custkey = c_custkey JOIN lineitem ON l_orderkey = o_orderkey JOIN part ON p_partkey = l_partkey JOIN partsupp ON ps_partkey = l_partkey AND ps_suppkey = l_suppkey WHERE r_name IN ('AMERICA', 'EUROPE', 'ASIA') AND l_shipdate BETWEEN '1995-01-01' AND '1995-12-31' AND o_orderstatus = 'F' GROUP BY r_name, n_name ORDER BY total_sales DESC, average_account_balance DESC LIMIT 10;
SELECT r_name AS region, n_name AS nation, COUNT(DISTINCT s_suppkey) AS supplier_count, COUNT(DISTINCT c_custkey) AS customer_count, AVG(s_acctbal) AS avg_supplier_acctbal, AVG(c_acctbal) AS avg_customer_acctbal, SUM(l_extendedprice * (1 - l_discount)) AS total_revenue FROM region JOIN nation ON n_regionkey = r_regionkey JOIN supplier ON s_nationkey = n_nationkey JOIN customer ON c_nationkey = n_nationkey JOIN orders ON o_custkey = c_custkey JOIN lineitem ON l_orderkey = o_orderkey WHERE l_shipdate >= '1992-01-01' AND l_shipdate < '1993-01-01' AND l_returnflag = 'N' GROUP BY region, nation ORDER BY total_revenue DESC, region, nation LIMIT 10;
SELECT r.r_name AS region, p.p_brand AS brand, COUNT(DISTINCT l_orderkey) AS total_orders, SUM(l_extendedprice * (1 - l_discount)) AS revenue, AVG(l_quantity) AS average_quantity, AVG(l_extendedprice) AS average_price, AVG(l_discount) AS average_discount FROM region r JOIN lineitem l ON r.r_regionkey = CAST(SUBSTRING(l.l_comment FROM 1 FOR 1) AS integer) JOIN part p ON l.l_partkey = p.p_partkey WHERE l.l_shipdate BETWEEN '2020-01-01' AND '2020-12-31' AND l.l_discount BETWEEN 0.05 AND 0.10 AND l.l_linestatus = 'O' GROUP BY r.r_name, p.p_brand ORDER BY revenue DESC, total_orders DESC LIMIT 5;
SELECT c.c_mktsegment, r.r_name AS region, SUM(l.l_extendedprice * (1 - l.l_discount)) AS revenue, AVG(l.l_quantity) AS avg_quantity, AVG(l.l_extendedprice) AS avg_price, AVG(l.l_discount) AS avg_discount, COUNT(DISTINCT c.c_custkey) AS num_customers, COUNT(DISTINCT o.o_orderkey) AS num_orders FROM customer c JOIN orders o ON c.c_custkey = o.o_custkey JOIN lineitem l ON o.o_orderkey = l.l_orderkey JOIN supplier s ON l.l_suppkey = s.s_suppkey JOIN region r ON s.s_nationkey = c.c_nationkey GROUP BY c.c_mktsegment, region ORDER BY revenue DESC;
SELECT r.r_name AS region, n.n_name AS nation, AVG(p.p_retailprice) AS avg_retail_price, SUM(ps.ps_availqty) AS total_avail_qty, SUM(ps.ps_supplycost * ps.ps_availqty) AS total_supply_cost, COUNT(DISTINCT p.p_partkey) AS num_parts FROM region r JOIN nation n ON r.r_regionkey = n.n_regionkey JOIN partsupp ps ON ps.ps_suppkey = n.n_nationkey JOIN part p ON ps.ps_partkey = p.p_partkey WHERE r.r_name IN ('AMERICA', 'EUROPE', 'ASIA') AND n.n_name IN ('CANADA', 'ROMANIA', 'SAUDI ARABIA') AND p.p_mfgr IN ('Manufacturer#1', 'Manufacturer#2', 'Manufacturer#3') GROUP BY r.r_name, n.n_name ORDER BY total_supply_cost DESC, avg_retail_price DESC;
SELECT r.r_name AS region_name, SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_revenue, AVG(c.c_acctbal) AS average_customer_acctbal, COUNT(DISTINCT s.s_suppkey) AS number_of_suppliers, COUNT(DISTINCT c.c_custkey) AS number_of_customers FROM region r JOIN nation n ON r.r_regionkey = n.n_regionkey JOIN supplier s ON n.n_nationkey = s.s_nationkey JOIN partsupp ps ON s.s_suppkey = ps.ps_suppkey JOIN part p ON ps.ps_partkey = p.p_partkey JOIN lineitem l ON p.p_partkey = l.l_partkey AND ps.ps_suppkey = l.l_suppkey JOIN orders o ON l.l_orderkey = o.o_orderkey JOIN customer c ON o.o_custkey = c.c_custkey WHERE c.c_mktsegment IN ('MACHINERY', 'AUTOMOBILE') AND r.r_name IN (SELECT r_name FROM region WHERE r_comment LIKE '%final%') GROUP BY r.r_name ORDER BY total_revenue DESC, average_customer_acctbal DESC;
SELECT n.n_name AS nation, AVG(c.c_acctbal) AS avg_account_balance, COUNT(c.c_custkey) AS total_customers, SUM(c.c_acctbal) AS total_account_balance FROM customer c JOIN orders o ON c.c_custkey = o.o_custkey JOIN nation n ON c.c_nationkey = n.n_nationkey JOIN region r ON n.n_regionkey = r.r_regionkey WHERE r.r_name = 'Europe' AND o.o_orderdate >= DATE '2020-01-01' AND o.o_orderdate < DATE '2020-01-01' + INTERVAL '1 YEAR' GROUP BY n.n_name ORDER BY avg_account_balance DESC;
SELECT n.n_name, COUNT(DISTINCT s.s_suppkey) AS total_suppliers, COUNT(DISTINCT c.c_custkey) AS total_customers, SUM(l.l_quantity) AS total_quantity_ordered, AVG(l.l_extendedprice) AS average_order_value, SUM(l.l_extendedprice * (1 - l.l_discount)) AS revenue_after_discount, AVG(ps.ps_supplycost) AS average_supply_cost, COUNT(DISTINCT o.o_orderkey) AS total_orders FROM nation n JOIN supplier s ON s.s_nationkey = n.n_nationkey JOIN customer c ON c.c_nationkey = n.n_nationkey JOIN orders o ON o.o_custkey = c.c_custkey JOIN lineitem l ON l.l_orderkey = o.o_orderkey JOIN partsupp ps ON ps.ps_suppkey = l.l_suppkey WHERE ps.ps_suppkey IN ('180437', '120024', '60401') GROUP BY n.n_name ORDER BY revenue_after_discount DESC;
SELECT r.r_name AS region, COUNT(DISTINCT n.n_nationkey) AS number_of_nations, SUM(l.l_quantity) AS total_quantity, AVG(ps.ps_supplycost) AS average_supply_cost, SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_revenue, COUNT(*) AS number_of_line_items FROM region r JOIN nation n ON r.r_regionkey = n.n_regionkey JOIN partsupp ps ON n.n_nationkey = ps.ps_suppkey JOIN lineitem l ON ps.ps_partkey = l.l_partkey AND ps.ps_suppkey = l.l_suppkey GROUP BY r.r_name ORDER BY total_revenue DESC;
SELECT r_name AS region, n_name AS nation, COUNT(o_orderkey) AS total_orders, SUM(l_extendedprice) AS total_sales, AVG(l_quantity) AS avg_quantity_sold, SUM(l_extendedprice * (1 - l_discount)) AS total_revenue_after_discount FROM region JOIN nation ON n_regionkey = r_regionkey JOIN supplier ON s_nationkey = n_nationkey JOIN lineitem ON l_suppkey = s_suppkey JOIN orders ON o_orderkey = l_orderkey JOIN customer ON c_custkey = o_custkey JOIN part ON p_partkey = l_partkey WHERE l_shipdate BETWEEN '1995-01-01' AND '1996-12-31' AND c_mktsegment = 'AUTOMOBILE' AND p_brand = 'Brand#12' GROUP BY region, nation ORDER BY total_revenue_after_discount DESC, region, nation;
SELECT r_name AS region, COUNT(DISTINCT c_custkey) AS number_of_customers, AVG(c_acctbal) AS average_account_balance, SUM(p_retailprice) AS total_retail_price, COUNT(DISTINCT p_partkey) AS number_of_parts, p_brand, p_type FROM customer JOIN nation ON c_nationkey = n_nationkey JOIN region ON n_regionkey = r_regionkey JOIN orders ON o_custkey = c_custkey JOIN lineitem ON l_orderkey = o_orderkey JOIN part ON p_partkey = l_partkey WHERE r_regionkey = 1 AND p_brand IN ('Brand#55', 'Brand#12', 'Brand#45', 'Brand#24', 'Brand#22') AND p_type IN ('PROMO BRUSHED COPPER', 'ECONOMY ANODIZED TIN', 'STANDARD PLATED STEEL', 'MEDIUM ANODIZED BRASS') GROUP BY r_name, p_brand, p_type ORDER BY total_retail_price DESC, number_of_customers DESC;
SELECT r.r_name AS region, n.n_name AS nation, COUNT(c.c_custkey) AS number_of_customers, SUM(c.c_acctbal) AS total_account_balance, AVG(c.c_acctbal) AS average_account_balance, COUNT(DISTINCT p.p_partkey) AS number_of_parts, SUM(ps.ps_availqty) AS total_available_quantity, AVG(ps.ps_supplycost) AS average_supply_cost FROM customer c JOIN nation n ON c.c_nationkey = n.n_nationkey JOIN region r ON n.n_regionkey = r.r_regionkey JOIN partsupp ps ON c.c_custkey = ps.ps_suppkey JOIN part p ON ps.ps_partkey = p.p_partkey GROUP BY r.r_name, n.n_name ORDER BY total_account_balance DESC, average_supply_cost ASC;
SELECT r_name AS region, n_name AS nation, COUNT(s_suppkey) AS number_of_suppliers, SUM(ps_availqty) AS total_available_quantity, AVG(s_acctbal) AS average_account_balance, SUM(l_extendedprice) AS total_sales, AVG(l_discount) AS average_discount, COUNT(DISTINCT o_orderkey) AS number_of_orders FROM region JOIN nation ON r_regionkey = n_regionkey JOIN supplier ON s_nationkey = n_nationkey JOIN partsupp ON s_suppkey = ps_suppkey JOIN lineitem ON ps_suppkey = l_suppkey AND ps_partkey = l_partkey JOIN orders ON l_orderkey = o_orderkey WHERE l_shipdate BETWEEN date '2022-01-01' AND date '2022-12-31' AND ps_partkey IN (939, 569, 662, 583, 981, 1107) GROUP BY r_name, n_name ORDER BY total_sales DESC, region, nation;
SELECT c_mktsegment, AVG(c_acctbal) AS average_account_balance, SUM(o_totalprice) AS total_order_value FROM customer JOIN orders ON c_custkey = o_custkey JOIN nation ON c_nationkey = n_nationkey JOIN region ON n_regionkey = r_regionkey WHERE r_name = 'EUROPE' GROUP BY c_mktsegment ORDER BY average_account_balance DESC, total_order_value DESC;
SELECT r_name AS region, n_name AS nation, COUNT(DISTINCT c_custkey) AS total_customers, SUM(o_totalprice) AS total_sales, AVG(c_acctbal) AS average_account_balance, COUNT(DISTINCT o_orderkey) AS total_orders, MAX(o_totalprice) AS max_order_value FROM region JOIN nation ON n_regionkey = r_regionkey JOIN customer ON c_nationkey = n_nationkey JOIN orders ON o_custkey = c_custkey WHERE r_name IN ('MIDDLE EAST', 'ASIA', 'EUROPE', 'AMERICA', 'AFRICA') AND n_name IN ('INDIA', 'CHINA', 'KENYA', 'IRAN') AND o_orderstatus = 'F' GROUP BY r_name, n_name ORDER BY total_sales DESC, average_account_balance DESC, total_customers DESC;
SELECT r_name AS region, n_name AS nation, COUNT(DISTINCT s_suppkey) AS number_of_suppliers, COUNT(DISTINCT c_custkey) AS number_of_customers, SUM(ps_availqty) AS total_available_quantity, AVG(l_extendedprice * (1 - l_discount)) AS average_revenue, SUM(CASE WHEN l_returnflag = 'R' THEN l_quantity ELSE 0 END) AS returned_quantity FROM region JOIN nation ON r_regionkey = n_regionkey JOIN supplier ON n_nationkey = s_nationkey JOIN customer ON n_nationkey = c_nationkey JOIN partsupp ON s_suppkey = ps_suppkey JOIN lineitem ON s_suppkey = l_suppkey AND ps_partkey = l_partkey JOIN orders ON l_orderkey = o_orderkey AND c_custkey = o_custkey WHERE r_name IN ('EUROPE', 'AMERICA', 'MIDDLE EAST') AND o_orderdate BETWEEN date '1995-01-01' AND date '1996-12-31' GROUP BY region, nation ORDER BY average_revenue DESC;
SELECT r.r_name AS region_name, COUNT(DISTINCT s.s_suppkey) AS number_of_suppliers, AVG(s.s_acctbal) AS avg_supplier_acct_balance, SUM(l.l_extendedprice * (1 - l_discount)) AS total_spending, COUNT(DISTINCT ps.ps_partkey) AS number_of_parts_supplied FROM region r JOIN supplier s ON s.s_nationkey = r.r_regionkey JOIN partsupp ps ON s.s_suppkey = ps.ps_suppkey JOIN lineitem l ON ps.ps_partkey = l.l_partkey AND ps.ps_suppkey = l.l_suppkey WHERE l.l_linestatus = 'O' GROUP BY r.r_name ORDER BY total_spending DESC;
SELECT n_name AS nation_name, COUNT(s_suppkey) AS number_of_suppliers, SUM(l_quantity) AS total_quantity, AVG(s_acctbal) AS average_account_balance, SUM(l_extendedprice * (1 - l_discount)) AS total_revenue, MAX(o_totalprice) AS max_order_price FROM nation JOIN supplier ON n_nationkey = s_nationkey JOIN lineitem ON s_suppkey = l_suppkey JOIN orders ON l_orderkey = o_orderkey WHERE n_comment LIKE '%unusual%' AND o_orderstatus = 'O' AND l_shipdate BETWEEN date '2022-01-01' AND date '2022-12-31' GROUP BY nation_name ORDER BY total_revenue DESC, average_account_balance DESC LIMIT 10;
SELECT r_name AS region, COUNT(DISTINCT c_custkey) AS number_of_customers, COUNT(DISTINCT o_orderkey) AS number_of_orders, SUM(l_extendedprice * (1 - l_discount)) AS total_revenue, AVG(l_extendedprice * (1 - l_discount)) AS avg_order_value, SUM(l_quantity) AS total_quantity_sold, AVG(l_quantity) AS avg_quantity_per_order FROM region JOIN customer ON c_nationkey = r_regionkey JOIN orders ON o_custkey = c_custkey JOIN lineitem ON l_orderkey = o_orderkey WHERE r_regionkey IN (3, 4, 0) AND l_receiptdate >= '1995-01-01' AND l_receiptdate <= '1998-12-31' GROUP BY r_name ORDER BY total_revenue DESC;
SELECT r.r_name AS region, EXTRACT(YEAR FROM o.o_orderdate) AS order_year, COUNT(DISTINCT o.o_orderkey) AS number_of_orders, SUM(l.l_quantity) AS total_quantity, AVG(l.l_extendedprice) AS average_price, SUM(l.l_extendedprice * (1 - l.l_discount)) AS revenue, AVG(l.l_discount) AS average_discount FROM region r JOIN supplier s ON s.s_nationkey = r.r_regionkey JOIN lineitem l ON l.l_suppkey = s.s_suppkey JOIN orders o ON o.o_orderkey = l.l_orderkey WHERE r.r_regionkey IN (1, 4, 0, 2, 3) AND (s.s_phone = '16-774-964-3208' OR s.s_phone = '32-729-386-1256' OR s.s_phone = '28-846-303-1561') AND (l.l_shipinstruct = 'COLLECT COD' OR l.l_shipinstruct = 'TAKE BACK RETURN') AND o.o_orderstatus IN ('F', 'O', 'P') GROUP BY region, order_year ORDER BY revenue DESC, region, order_year;
SELECT r.r_name AS region, n.n_name AS nation, COUNT(DISTINCT c.c_custkey) AS number_of_customers, COUNT(DISTINCT s.s_suppkey) AS number_of_suppliers, AVG(c.c_acctbal) AS average_customer_acctbal, AVG(s.s_acctbal) AS average_supplier_acctbal, SUM(p.p_retailprice) AS total_retail_price FROM region r INNER JOIN nation n ON r.r_regionkey = n.n_regionkey INNER JOIN customer c ON n.n_nationkey = c.c_nationkey INNER JOIN supplier s ON n.n_nationkey = s.s_nationkey INNER JOIN part p ON p.p_size BETWEEN 30 AND 50 WHERE n.n_nationkey IN (3, 24, 17, 14, 22) AND c.c_acctbal > 2500 AND s.s_phone LIKE '25-%' GROUP BY r.r_name, n.n_name ORDER BY total_retail_price DESC, average_customer_acctbal DESC LIMIT 10;
SELECT n.n_name AS nation, p.p_brand AS brand, COUNT(DISTINCT o.o_orderkey) AS number_of_orders, SUM(ps.ps_availqty) AS total_available_quantity, AVG(ps.ps_supplycost) AS average_supply_cost, SUM(o.o_totalprice) AS total_order_value, AVG(o.o_totalprice) AS average_order_value FROM nation n JOIN orders o ON n.n_nationkey = o.o_custkey JOIN partsupp ps ON o.o_orderkey = ps.ps_suppkey JOIN part p ON ps.ps_partkey = p.p_partkey WHERE n.n_name IN ('INDONESIA', 'BRAZIL') AND p.p_container IN ('LG DRUM', 'WRAP JAR', 'MED PKG', 'JUMBO BOX') AND p.p_type IN ('STANDARD BURNISHED STEEL', 'LARGE PLATED BRASS') AND o.o_orderstatus IN ('F', 'O') GROUP BY nation, brand ORDER BY total_order_value DESC;
SELECT n.n_name AS nation_name, COUNT(li.l_orderkey) AS total_orders, SUM(li.l_extendedprice) AS total_extended_price, AVG(li.l_quantity) AS average_quantity, SUM(li.l_extendedprice * (1 - li.l_discount)) AS total_revenue_after_discount, SUM(CASE WHEN li.l_returnflag = 'R' THEN 1 ELSE 0 END) AS total_returns FROM nation n JOIN partsupp ps ON n.n_nationkey = ps.ps_suppkey JOIN lineitem li ON ps.ps_partkey = li.l_partkey AND ps.ps_suppkey = li.l_suppkey WHERE n.n_regionkey IN (1, 2, 0, 4) AND ps.ps_supplycost BETWEEN 13.66 AND 761.23 AND li.l_shipdate BETWEEN '1995-01-01' AND '1995-12-31' GROUP BY n.n_name ORDER BY total_revenue_after_discount DESC, total_orders DESC;
SELECT r.r_name AS region, n.n_name AS nation, COUNT(DISTINCT c.c_custkey) AS number_of_customers, SUM(o.o_totalprice) AS total_sales, AVG(c.c_acctbal) AS average_customer_balance, AVG(p.p_retailprice) AS average_part_retail_price, SUM(ps.ps_availqty) AS total_available_parts_quantity, AVG(ps.ps_supplycost) AS average_part_supply_cost FROM region r JOIN nation n ON r.r_regionkey = n.n_regionkey JOIN customer c ON n.n_nationkey = c.c_nationkey JOIN orders o ON c.c_custkey = o.o_custkey JOIN partsupp ps ON ps.ps_partkey = o.o_orderkey JOIN part p ON ps.ps_partkey = p.p_partkey WHERE r.r_name IN ('AMERICA', 'EUROPE') AND o.o_orderdate BETWEEN '2020-01-01' AND '2020-12-31' AND p.p_mfgr IN ('Manufacturer#1', 'Manufacturer#2', 'Manufacturer#3', 'Manufacturer#4', 'Manufacturer#5') GROUP BY r.r_name, n.n_name ORDER BY total_sales DESC, average_customer_balance DESC;
SELECT r.r_name AS region_name, c.c_mktsegment AS market_segment, COUNT(DISTINCT o.o_orderkey) AS number_of_orders, SUM(l.l_extendedprice) AS total_sales, AVG(l.l_quantity) AS average_quantity, AVG(l.l_extendedprice * (1 - l.l_discount)) AS average_discounted_price FROM region r JOIN customer c ON c.c_nationkey = r.r_regionkey JOIN orders o ON o.o_custkey = c.c_custkey JOIN lineitem l ON l.l_orderkey = o.o_orderkey GROUP BY r.r_name, c.c_mktsegment ORDER BY total_sales DESC, r.r_name, c.c_mktsegment;
SELECT n_name AS nation, p_type AS part_type, AVG(l_quantity) AS average_quantity, SUM(l_extendedprice * (1 - l_discount)) AS total_revenue, COUNT(DISTINCT o_orderkey) AS total_orders FROM nation JOIN customer ON n_nationkey = c_nationkey JOIN orders ON c_custkey = o_custkey JOIN lineitem ON o_orderkey = l_orderkey JOIN part ON l_partkey = p_partkey JOIN partsupp ON p_partkey = ps_partkey AND l_suppkey = ps_suppkey JOIN supplier ON s_suppkey = l_suppkey WHERE p_size IN (30, 22, 19) AND s_acctbal BETWEEN 5000 AND 10000 AND o_orderdate BETWEEN '1995-01-01' AND '1995-12-31' AND l_shipmode IN ('AIR', 'RAIL') GROUP BY nation, part_type ORDER BY total_revenue DESC, nation, part_type;
SELECT c_mktsegment, r_name AS region_name, COUNT(DISTINCT c_custkey) AS number_of_customers, AVG(c_acctbal) AS average_account_balance, COUNT(o_orderkey) AS number_of_orders, SUM(o_totalprice) AS total_sales FROM customer JOIN nation ON customer.c_nationkey = nation.n_nationkey JOIN region ON nation.n_regionkey = region.r_regionkey LEFT JOIN orders ON customer.c_custkey = orders.o_custkey WHERE region.r_name IN ('EUROPE', 'AMERICA', 'ASIA') AND orders.o_orderdate BETWEEN '2022-01-01' AND '2022-12-31' GROUP BY c_mktsegment, region_name ORDER BY c_mktsegment, total_sales DESC;
SELECT n_name AS nation, COUNT(DISTINCT s_suppkey) AS supplier_count, COUNT(DISTINCT c_custkey) AS customer_count, SUM(p_retailprice) AS total_retail_price, AVG(ps_supplycost) AS avg_supply_cost, SUM(l_extendedprice * (1 - l_discount)) AS revenue, AVG(l_quantity) AS average_quantity FROM nation JOIN supplier ON nation.n_nationkey = supplier.s_nationkey JOIN customer ON nation.n_nationkey = customer.c_nationkey JOIN partsupp ON supplier.s_suppkey = partsupp.ps_suppkey JOIN part ON partsupp.ps_partkey = part.p_partkey JOIN lineitem ON part.p_partkey = lineitem.l_partkey AND supplier.s_suppkey = lineitem.l_suppkey WHERE nation.n_regionkey IN (1, 4, 0, 2, 3) AND part.p_mfgr = 'Manufacturer#2' AND part.p_size IN (44, 12, 39) AND lineitem.l_quantity IN (1.00, 12.00, 48.00, 25.00, 36.00, 2.00) AND supplier.s_name IN ('Supplier#000019035', 'Supplier#000018943', 'Supplier#000018505', 'Supplier#000021574', 'Supplier#000021189') GROUP BY nation.n_name ORDER BY revenue DESC, nation ASC;
SELECT c.c_mktsegment AS market_segment, AVG(c.c_acctbal) AS avg_customer_acctbal, COUNT(DISTINCT o.o_orderkey) AS total_orders_count, AVG(o.o_totalprice) AS avg_order_totalprice FROM customer AS c JOIN orders AS o ON c.c_custkey = o.o_custkey JOIN nation AS n ON c.c_nationkey = n.n_nationkey WHERE n.n_name = 'UNITED STATES' AND o.o_orderpriority IN ('1-URGENT', '2-HIGH') GROUP BY c.c_mktsegment ORDER BY avg_customer_acctbal DESC, total_orders_count DESC;
SELECT r_name AS region, COUNT(DISTINCT s_suppkey) AS total_suppliers, COUNT(DISTINCT p_partkey) AS total_parts, ROUND(AVG(o_totalprice), 2) AS avg_order_value, COUNT(DISTINCT o_orderkey) AS total_orders FROM region JOIN supplier ON s_suppkey IN (SELECT ps_suppkey FROM partsupp WHERE ps_availqty > 1000) JOIN partsupp ON supplier.s_suppkey = partsupp.ps_suppkey JOIN part ON partsupp.ps_partkey = part.p_partkey AND part.p_type IN ('LARGE PLATED COPPER', 'PROMO BRUSHED COPPER') JOIN lineitem ON partsupp.ps_partkey = lineitem.l_partkey AND partsupp.ps_suppkey = lineitem.l_suppkey JOIN orders ON lineitem.l_orderkey = orders.o_orderkey WHERE lineitem.l_commitdate >= '1994-01-01' AND lineitem.l_commitdate < '1995-01-01' AND lineitem.l_quantity < 30 GROUP BY r_name ORDER BY avg_order_value DESC;
SELECT r_name AS region, n_name AS nation, COUNT(DISTINCT s_suppkey) AS number_of_suppliers, COUNT(DISTINCT c_custkey) AS number_of_customers, AVG(s_acctbal) AS avg_supplier_acctbal, AVG(c_acctbal) AS avg_customer_acctbal, SUM(l_extendedprice * (1 - l_discount)) AS total_sales_volume FROM region JOIN nation ON n_regionkey = r_regionkey JOIN supplier ON s_nationkey = n_nationkey JOIN customer ON c_nationkey = n_nationkey JOIN orders ON o_custkey = c_custkey JOIN lineitem ON l_orderkey = o_orderkey JOIN part ON l_partkey = p_partkey WHERE r_name IN ('EUROPE', 'AMERICA') AND o_orderdate BETWEEN date '1993-01-01' AND date '1993-12-31' AND p_size IN (7, 42) AND p_name LIKE ANY (ARRAY['%peach%', '%cyan%', '%orange%', '%aquamarine%', '%sienna%']) GROUP BY region, nation ORDER BY total_sales_volume DESC;
SELECT c.c_mktsegment, AVG(c.c_acctbal) AS avg_acct_balance, COUNT(o.o_orderkey) AS num_orders_above_threshold FROM customer c JOIN orders o ON c.c_custkey = o.o_custkey WHERE o.o_totalprice > 100000 GROUP BY c.c_mktsegment ORDER BY avg_acct_balance DESC;
SELECT p_brand, p_type, p_size, AVG(l_quantity) AS avg_quantity, AVG(l_extendedprice) AS avg_extended_price, SUM(l_extendedprice * (1 - l_discount)) AS total_revenue, COUNT(*) AS total_orders FROM lineitem JOIN part ON lineitem.l_partkey = part.p_partkey GROUP BY p_brand, p_type, p_size ORDER BY total_revenue DESC, p_brand, p_type, p_size;
SELECT r.r_name AS region_name, EXTRACT(YEAR FROM o.o_orderdate) AS order_year, COUNT(distinct o.o_orderkey) AS total_orders, AVG(o.o_totalprice) AS average_order_price, SUM(p.p_size) AS total_parts_size, AVG(p.p_retailprice) AS average_part_price FROM region r JOIN orders o ON r.r_regionkey = o.o_orderkey % 5 JOIN part p ON o.o_orderkey = p.p_partkey % 5 WHERE r.r_name LIKE 'E%' AND o.o_orderstatus = 'F' AND p.p_name IN ( 'coral magenta orange powder cyan', 'navy blanched cornflower medium drab', 'tomato misty almond cornflower papaya', 'firebrick tomato midnight violet thistle', 'medium aquamarine drab dark azure' ) GROUP BY region_name, order_year ORDER BY total_orders DESC, average_order_price DESC;
SELECT r_name AS region, n_name AS nation, COUNT(DISTINCT c_custkey) AS customer_count, COUNT(DISTINCT s_suppkey) AS supplier_count, AVG(c_acctbal) AS average_customer_account_balance, AVG(s_acctbal) AS average_supplier_account_balance, SUM(o_totalprice) AS total_order_value, COUNT(DISTINCT o_orderkey) AS total_orders FROM region JOIN nation ON r_regionkey = n_regionkey JOIN customer ON n_nationkey = c_nationkey JOIN supplier ON n_nationkey = s_nationkey LEFT JOIN orders ON c_custkey = o_custkey WHERE c_mktsegment = 'BUILDING' AND o_orderdate >= date '1993-01-01' AND o_orderdate < date '1994-01-01' AND o_orderstatus = 'F' GROUP BY r_name, n_name ORDER BY total_order_value DESC, region, nation;
SELECT r.r_name AS region, n.n_name AS nation, c.c_mktsegment AS market_segment, COUNT(DISTINCT o.o_orderkey) AS total_orders, SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_revenue, AVG(l.l_quantity) AS average_quantity, AVG(c.c_acctbal) AS average_account_balance FROM region r JOIN nation n ON r.r_regionkey = n.n_regionkey JOIN customer c ON n.n_nationkey = c.c_nationkey JOIN orders o ON c.c_custkey = o.o_custkey JOIN lineitem l ON o.o_orderkey = l.l_orderkey WHERE r.r_name IN ('EUROPE', 'ASIA', 'MIDDLE EAST') AND o.o_orderdate >= date '1995-01-01' AND o.o_orderdate < date '1996-01-01' AND c.c_acctbal > 0 AND l.l_shipdate <= o.o_orderdate + interval '90 days' GROUP BY r.r_name, n.n_name, c.c_mktsegment ORDER BY total_revenue DESC, average_account_balance DESC LIMIT 10;
SELECT n.n_name AS nation_name, COUNT(DISTINCT o.o_orderkey) AS total_orders, SUM(l.l_extendedprice) AS total_sales, AVG(l.l_discount) AS average_discount, SUM(l.l_quantity) AS total_quantity_sold FROM nation n JOIN orders o ON n.n_nationkey = o.o_custkey JOIN lineitem l ON o.o_orderkey = l.l_orderkey WHERE o.o_orderstatus = 'F' AND o.o_orderpriority IN ('1-URGENT', '2-HIGH') GROUP BY n.n_name ORDER BY total_sales DESC, average_discount DESC;
SELECT r.r_name AS region, n.n_name AS nation, COUNT(o.o_orderkey) AS total_orders, SUM(o.o_totalprice) AS total_revenue, AVG(o.o_totalprice) AS avg_order_value, SUM(ps.ps_availqty) AS total_available_qty, AVG(ps.ps_supplycost) AS avg_supply_cost, COUNT(DISTINCT p.p_partkey) AS num_parts FROM region r JOIN nation n ON r.r_regionkey = n.n_regionkey JOIN orders o ON o.o_custkey = n.n_nationkey JOIN partsupp ps ON ps.ps_suppkey = o.o_custkey JOIN part p ON p.p_partkey = ps.ps_partkey WHERE n.n_name IN ('IRAN', 'EGYPT', 'GERMANY', 'PERU', 'CANADA', 'UNITED KINGDOM') AND r.r_regionkey = 4 AND (ps.ps_comment LIKE '%pending pinto beans%' OR ps.ps_comment LIKE '%yly unusual ideas%') AND p.p_comment LIKE '%es print slyly alw%' GROUP BY r.r_name, n.n_name ORDER BY total_revenue DESC LIMIT 10;
SELECT c.c_mktsegment, COUNT(DISTINCT c.c_custkey) AS num_customers, COUNT(DISTINCT li.l_orderkey) AS num_orders, SUM(li.l_quantity * li.l_extendedprice) AS total_order_value, AVG(li.l_discount) AS avg_discount FROM customer c JOIN lineitem li ON c.c_custkey = li.l_suppkey JOIN partsupp ps ON li.l_partkey = ps.ps_partkey AND li.l_suppkey = ps.ps_suppkey WHERE c.c_mktsegment IN ('BUILDING', 'FURNITURE') AND ps.ps_suppkey IN ('120733', '120292') AND li.l_orderkey IN ('2660', '3874') GROUP BY c.c_mktsegment ORDER BY total_order_value DESC;
SELECT n.n_name AS nation_name, COUNT(DISTINCT s.s_suppkey) AS number_of_suppliers, COUNT(DISTINCT o.o_orderkey) AS number_of_orders, AVG(l.l_quantity) AS average_lineitem_quantity, SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_revenue, AVG(l.l_extendedprice * (1 - l.l_discount)) AS average_revenue_per_lineitem, SUM(CASE WHEN l.l_returnflag = 'R' THEN 1 ELSE 0 END) AS returned_lineitems_count FROM nation n JOIN supplier s ON s.s_nationkey = n.n_nationkey JOIN lineitem l ON l.l_suppkey = s.s_suppkey JOIN part p ON p.p_partkey = l.l_partkey JOIN orders o ON o.o_orderkey = l.l_orderkey WHERE o.o_orderstatus = 'F' AND l.l_shipinstruct IN ('COLLECT COD', 'TAKE BACK RETURN') AND l.l_discount BETWEEN 0.05 AND 0.10 AND p.p_brand IN ('Brand#35', 'Brand#14') AND p.p_size IN (10, 39, 44, 8, 2, 38) GROUP BY n.n_name ORDER BY total_revenue DESC, nation_name;
SELECT n.n_name AS nation_name, AVG(c.c_acctbal) AS avg_account_balance, SUM(ps.ps_availqty) AS total_available_quantity, COUNT(DISTINCT c.c_custkey) AS number_of_customers, SUM(CASE WHEN ps.ps_supplycost > 500 THEN ps.ps_availqty ELSE 0 END) AS high_cost_availability FROM nation AS n JOIN customer AS c ON n.n_nationkey = c.c_nationkey JOIN partsupp AS ps ON c.c_nationkey = ps.ps_suppkey WHERE n.n_name IN ('INDIA', 'CHINA', 'IRAQ', 'FRANCE', 'SAUDI ARABIA', 'MOZAMBIQUE') AND ps.ps_supplycost IN (621.85, 339.49, 459.63) AND ps.ps_suppkey IN (61208, 180186) GROUP BY nation_name ORDER BY avg_account_balance DESC, total_available_quantity DESC;
SELECT n.n_name AS nation, EXTRACT(YEAR FROM o.o_orderdate) AS order_year, COUNT(*) AS total_orders, SUM(o.o_totalprice) AS total_revenue, AVG(s.s_acctbal) AS average_supplier_balance, COUNT(DISTINCT s.s_suppkey) AS number_of_suppliers FROM orders o JOIN supplier s ON o.o_custkey = s.s_suppkey JOIN nation n ON s.s_nationkey = n.n_nationkey WHERE o.o_orderstatus = 'F' GROUP BY nation, order_year ORDER BY nation, order_year DESC;
SELECT r.r_name AS region_name, c.c_mktsegment AS market_segment, AVG(c.c_acctbal) AS average_account_balance, SUM(ps.ps_supplycost) AS total_supply_cost, COUNT(DISTINCT l.l_orderkey) AS total_orders, SUM(l.l_extendedprice * (1 - l_discount)) AS revenue FROM region r JOIN customer c ON c.c_nationkey = r.r_regionkey JOIN partsupp ps ON ps.ps_suppkey = c.c_custkey JOIN lineitem l ON l.l_suppkey = ps.ps_suppkey AND l.l_partkey = ps.ps_partkey WHERE r.r_name = 'EUROPE' AND c.c_address LIKE 'YlQxhRBm,bV0K9FefkpyODChB%' AND l.l_shipdate BETWEEN '1995-01-01' AND '1995-12-31' AND l.l_orderkey IN (2464, 1221, 513, 3751) GROUP BY region_name, market_segment ORDER BY total_supply_cost DESC, revenue DESC, average_account_balance DESC;
SELECT r.r_name AS region, n.n_name AS nation, COUNT(s.s_suppkey) AS number_of_suppliers, SUM(ps.ps_availqty) AS total_available_parts, AVG(s.s_acctbal) AS average_account_balance, SUM(ps.ps_supplycost * ps.ps_availqty) AS total_supply_cost, string_agg(DISTINCT s.s_comment, '; ') AS supplier_comments FROM region r JOIN nation n ON r.r_regionkey = n.n_regionkey JOIN supplier s ON n.n_nationkey = s.s_nationkey JOIN partsupp ps ON s.s_suppkey = ps.ps_suppkey GROUP BY r.r_name, n.n_name ORDER BY total_supply_cost DESC, average_account_balance DESC;
SELECT c_mktsegment, COUNT(DISTINCT c_custkey) AS num_customers, SUM(ps_availqty) AS total_avail_parts, AVG(l_extendedprice * (1 - l_discount)) AS avg_order_value, SUM((l_extendedprice * (1 - l_discount)) * (1 + l_tax)) AS total_revenue FROM customer JOIN lineitem ON c_custkey = l_orderkey JOIN partsupp ON lineitem.l_partkey = partsupp.ps_partkey AND lineitem.l_suppkey = partsupp.ps_suppkey WHERE c_mktsegment IN ('BUILDING', 'AUTOMOBILE', 'MACHINERY', 'HOUSEHOLD') AND l_shipdate BETWEEN '2020-01-01' AND '2020-12-31' AND l_returnflag = 'N' GROUP BY c_mktsegment ORDER BY total_revenue DESC;
SELECT r_name AS region, c_mktsegment AS market_segment, COUNT(DISTINCT o_orderkey) AS num_orders, SUM(l_quantity) AS total_quantity, AVG(l_extendedprice) AS avg_price, SUM(l_extendedprice * (1 - l_discount)) AS revenue FROM region JOIN supplier ON s_nationkey = r_regionkey JOIN partsupp ON ps_suppkey = s_suppkey JOIN lineitem ON l_suppkey = s_suppkey AND l_partkey = ps_partkey JOIN orders ON o_orderkey = l_orderkey JOIN customer ON c_custkey = o_custkey AND c_nationkey = s_nationkey WHERE c_acctbal > 8117.27 AND c_nationkey IN (20, 0) GROUP BY r_name, c_mktsegment ORDER BY revenue DESC, avg_price DESC;
SELECT r.r_name AS region, n.n_name AS nation, EXTRACT(YEAR FROM o.o_orderdate) AS order_year, COUNT(DISTINCT o.o_orderkey) as total_orders, SUM(l.l_extendedprice * (1 - l.l_discount)) AS revenue, AVG(l.l_quantity) as average_quantity, SUM(p.p_retailprice * l.l_quantity) AS potential_revenue FROM region r JOIN nation n ON r.r_regionkey = n.n_regionkey JOIN supplier s ON n.n_nationkey = s.s_nationkey JOIN partsupp ps ON s.s_suppkey = ps.ps_suppkey JOIN part p ON ps.ps_partkey = p.p_partkey JOIN lineitem l ON ps.ps_partkey = l.l_partkey AND ps.ps_suppkey = l.l_suppkey JOIN orders o ON l.l_orderkey = o.o_orderkey JOIN customer c ON o.o_custkey = c.c_custkey AND c.c_nationkey = s.s_nationkey WHERE r.r_name IN ('EUROPE', 'ASIA') AND l.l_shipdate BETWEEN '2022-01-01' AND '2022-12-31' GROUP BY region, nation, order_year ORDER BY revenue DESC, region, nation, order_year;
SELECT r.r_name AS region, n.n_name AS nation, c.c_mktsegment AS market_segment, COUNT(DISTINCT c.c_custkey) AS customer_count, SUM(l.l_quantity) AS total_quantity_ordered, AVG(l.l_extendedprice * (1 - l.l_discount)) AS average_order_value, SUM(p.ps_supplycost * l.l_quantity) AS total_supply_cost FROM region r JOIN nation n ON r.r_regionkey = n.n_regionkey JOIN customer c ON n.n_nationkey = c.c_nationkey JOIN lineitem l ON c.c_custkey = l.l_orderkey JOIN partsupp p ON l.l_partkey = p.ps_partkey AND l.l_suppkey = p.ps_suppkey WHERE c.c_mktsegment IN ('BUILDING', 'HOUSEHOLD') AND l.l_linestatus IN ('F', 'O') AND l.l_commitdate BETWEEN '1993-05-16' AND '1996-09-04' AND p.ps_supplycost IN (950.12, 506.08) GROUP BY r.r_name, n.n_name, c.c_mktsegment ORDER BY average_order_value DESC;
SELECT r_name AS region, n_name AS nation, count(DISTINCT s_suppkey) AS num_suppliers, count(DISTINCT c_custkey) AS num_customers, sum(l_extendedprice) AS total_sales, avg(l_extendedprice * (1 - l_discount)) AS avg_discounted_sales, count(DISTINCT o_orderkey) AS num_orders FROM region JOIN nation ON n_regionkey = r_regionkey JOIN supplier ON s_nationkey = n_nationkey JOIN customer ON c_nationkey = n_nationkey JOIN orders ON o_custkey = c_custkey JOIN lineitem ON l_orderkey = o_orderkey AND l_suppkey = s_suppkey GROUP BY region, nation ORDER BY total_sales DESC, region, nation;
SELECT r.r_name AS region_name, n.n_name AS nation_name, EXTRACT(YEAR FROM o.o_orderdate) AS order_year, AVG(o.o_totalprice) AS avg_sales, COUNT(DISTINCT o.o_orderkey) AS total_orders, SUM(c.c_acctbal) AS total_customer_balance FROM region r JOIN nation n ON r.r_regionkey = n.n_regionkey JOIN customer c ON n.n_nationkey = c.c_nationkey JOIN orders o ON c.c_custkey = o.o_custkey GROUP BY region_name, nation_name, order_year ORDER BY region_name, nation_name, order_year;
SELECT r.r_name AS region, c.c_mktsegment AS market_segment, COUNT(DISTINCT o.o_orderkey) AS number_of_orders, SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_revenue, AVG(l.l_quantity) AS average_quantity, AVG(l.l_extendedprice) AS average_price, AVG(l.l_discount) AS average_discount FROM region r JOIN customer c ON c.c_nationkey = r.r_regionkey JOIN orders o ON o.o_custkey = c.c_custkey JOIN lineitem l ON l.l_orderkey = o.o_orderkey WHERE r.r_name IN ('MIDDLE EAST', 'ASIA', 'AMERICA', 'EUROPE') AND o.o_totalprice BETWEEN 59929.64 AND 225384.31 AND c.c_phone IN ('10-988-830-1911', '18-631-108-5096', '13-295-598-4577', '16-508-758-2274') AND l.l_shipdate BETWEEN '1995-01-01' AND '1996-12-31' AND l.l_returnflag = 'N' GROUP BY region, market_segment ORDER BY total_revenue DESC, number_of_orders DESC;
SELECT r_name, o_orderstatus, COUNT(*) AS total_orders, SUM(ps_availqty) AS total_partsupply_qty, AVG(ps_supplycost) AS avg_partsupply_cost, MIN(o_totalprice) AS min_order_price, MAX(o_totalprice) AS max_order_price FROM region JOIN orders ON o_custkey = r_regionkey JOIN partsupp ON ps_suppkey = r_regionkey WHERE o_orderdate BETWEEN '2022-01-01' AND '2022-12-31' AND r_regionkey IN (1, 4, 0, 2, 3) GROUP BY r_name, o_orderstatus ORDER BY r_name, o_orderstatus;
SELECT n_name AS nation, COUNT(DISTINCT s_suppkey) AS number_of_suppliers, SUM(ps_availqty) AS total_available_quantity, AVG(s_acctbal) AS avg_supplier_account_balance, SUM(l_extendedprice * (1 - l_discount)) AS total_revenue, AVG(l_quantity) AS avg_quantity_sold FROM nation JOIN supplier ON n_nationkey = s_nationkey JOIN partsupp ON s_suppkey = ps_suppkey JOIN lineitem ON ps_suppkey = l_suppkey AND ps_partkey = l_partkey JOIN orders ON l_orderkey = o_orderkey WHERE o_orderdate BETWEEN '1996-01-01' AND '1996-12-31' AND l_shipmode IN ('AIR', 'RAIL') AND o_orderpriority = '1-URGENT' GROUP BY nation ORDER BY total_revenue DESC;
SELECT r_name AS region, n_name AS nation, COUNT(DISTINCT s_suppkey) AS suppliers_count, COUNT(DISTINCT c_custkey) AS customers_count, AVG(s_acctbal) AS avg_supplier_acctbal, AVG(c_acctbal) AS avg_customer_acctbal, SUM(l_extendedprice * (1 - l_discount)) AS total_sales, AVG(l_quantity) AS avg_quantity_sold, COUNT(DISTINCT o_orderkey) AS total_orders FROM region JOIN nation ON r_regionkey = n_regionkey JOIN supplier ON s_nationkey = n_nationkey JOIN customer ON c_nationkey = n_nationkey JOIN orders ON o_custkey = c_custkey JOIN lineitem ON l_orderkey = o_orderkey WHERE l_shipdate BETWEEN '1994-01-01' AND '1994-12-31' AND l_returnflag = 'F' GROUP BY region, nation ORDER BY total_sales DESC, region, nation;
SELECT r.r_name AS region_name, COUNT(DISTINCT s.s_suppkey) AS number_of_suppliers, SUM(o.o_totalprice) AS total_sales, AVG(o.o_totalprice) AS average_transaction_size FROM region r JOIN supplier s ON s.s_nationkey = r.r_regionkey JOIN orders o ON o.o_custkey = s.s_suppkey WHERE o.o_orderdate > '1995-01-01' GROUP BY r.r_name ORDER BY total_sales DESC, average_transaction_size DESC;
SELECT r.r_name AS region, c.c_mktsegment AS market_segment, COUNT(DISTINCT c.c_custkey) AS number_of_customers, AVG(c.c_acctbal) AS average_customer_account_balance, SUM(o.o_totalprice) AS total_sales FROM customer c JOIN orders o ON c.c_custkey = o.o_custkey JOIN nation n ON c.c_nationkey = n.n_nationkey JOIN region r ON n.n_regionkey = r.r_regionkey GROUP BY r.r_name, c.c_mktsegment ORDER BY total_sales DESC, average_customer_account_balance DESC;
SELECT r.r_name AS region_name, COUNT(DISTINCT s.s_suppkey) AS supplier_count, COUNT(DISTINCT c.c_custkey) AS customer_count, SUM(l.l_extendedprice) AS total_sales, AVG(l.l_discount) AS average_discount, SUM(ps.ps_availqty) AS total_available_parts FROM region r JOIN supplier s ON r.r_regionkey = s.s_nationkey JOIN partsupp ps ON s.s_suppkey = ps.ps_suppkey JOIN lineitem l ON ps.ps_suppkey = l.l_suppkey AND ps.ps_partkey = l.l_partkey JOIN orders o ON l.l_orderkey = o.o_orderkey JOIN customer c ON o.o_custkey = c.c_custkey WHERE l.l_shipdate BETWEEN '1994-01-01' AND '1994-12-31' AND l.l_linestatus = 'F' GROUP BY r.r_name ORDER BY total_sales DESC;
SELECT r.r_name AS region_name, COUNT(DISTINCT s.s_suppkey) AS number_of_suppliers, COUNT(DISTINCT c.c_custkey) AS number_of_customers, AVG(s.s_acctbal) AS avg_supplier_acctbal, AVG(c.c_acctbal) AS avg_customer_acctbal, SUM(o.o_totalprice) AS total_sales, COUNT(o.o_orderkey) AS number_of_orders, AVG(o.o_totalprice) AS avg_order_value, MAX(o.o_totalprice) AS max_order_value, MIN(o.o_totalprice) AS min_order_value FROM region r JOIN supplier s ON s.s_nationkey = r.r_regionkey JOIN customer c ON c.c_nationkey = r.r_regionkey JOIN orders o ON o.o_custkey = c.c_custkey WHERE r.r_regionkey IN (1, 4, 0, 2, 3) AND o.o_orderdate BETWEEN '2020-01-01' AND '2020-12-31' AND o.o_orderstatus = 'F' GROUP BY r.r_name ORDER BY total_sales DESC;
SELECT n.n_name AS nation_name, EXTRACT(YEAR FROM o.o_orderdate) AS order_year, COUNT(DISTINCT o.o_orderkey) AS total_orders, SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_sales, AVG(l.l_discount) AS average_discount FROM nation n JOIN orders o ON n.n_nationkey = o.o_custkey JOIN lineitem l ON o.o_orderkey = l.l_orderkey WHERE l.l_tax <> 0.08 GROUP BY nation_name, order_year ORDER BY nation_name, order_year;
SELECT c.c_mktsegment, o.o_orderpriority, COUNT(*) AS order_count, SUM(o.o_totalprice) AS total_sales, AVG(o.o_totalprice) AS average_sale_amount FROM customer c JOIN orders o ON c.c_custkey = o.o_custkey WHERE o.o_totalprice > 50000 GROUP BY c.c_mktsegment, o.o_orderpriority ORDER BY c.c_mktsegment, o.o_orderpriority;
SELECT n_name, c_mktsegment, COUNT(DISTINCT o_orderkey) AS total_orders, SUM(l_extendedprice * (1 - l_discount)) AS revenue, AVG(l_extendedprice * (1 - l_discount)) AS avg_revenue, AVG(l_quantity) AS avg_quantity FROM nation JOIN customer ON nation.n_nationkey = customer.c_nationkey JOIN orders ON customer.c_custkey = orders.o_custkey JOIN lineitem ON orders.o_orderkey = lineitem.l_orderkey WHERE n_regionkey IN (1, 2, 3) AND o_orderdate BETWEEN date '2022-01-01' AND date '2022-12-31' AND l_shipdate > o_orderdate GROUP BY n_name, c_mktsegment ORDER BY revenue DESC, n_name, c_mktsegment;
SELECT r.r_name AS region, COUNT(o.o_orderkey) AS number_of_orders, AVG(o.o_totalprice) AS average_order_total, SUM(o.o_totalprice) AS sum_order_totals FROM region r JOIN nation n ON r.r_regionkey = n.n_regionkey JOIN supplier s ON n.n_nationkey = s.s_nationkey JOIN partsupp ps ON s.s_suppkey = ps.ps_suppkey JOIN lineitem l ON ps.ps_partkey = l.l_partkey AND ps.ps_suppkey = l.l_suppkey JOIN orders o ON l.l_orderkey = o.o_orderkey WHERE o.o_orderdate >= (SELECT MAX(o_orderdate) FROM orders) - INTERVAL '3 months' GROUP BY r.r_name ORDER BY average_order_total DESC;
SELECT r.r_name AS region, c.c_mktsegment AS market_segment, COUNT(DISTINCT c.c_custkey) AS total_customers, SUM(l.l_quantity) AS total_quantity_sold, AVG(l.l_extendedprice) AS avg_price, SUM(l.l_extendedprice * (1 - l_discount)) AS revenue_after_discount FROM region r JOIN customer c ON r.r_regionkey = c.c_nationkey JOIN lineitem l ON c.c_custkey = l.l_suppkey JOIN part p ON l.l_partkey = p.p_partkey WHERE p.p_size IN (4, 5, 14) AND p.p_container IN ('SM DRUM', 'JUMBO PACK') AND l.l_shipdate BETWEEN '1995-01-01' AND '1995-12-31' GROUP BY r.r_name, c.c_mktsegment ORDER BY revenue_after_discount DESC, total_quantity_sold DESC;
SELECT n_name, p_brand, p_type, p_size, avg(ps_supplycost) AS average_supply_cost, sum(l_extendedprice) AS total_sales_value, sum(l_extendedprice * (1 - l_discount)) AS total_sales_after_discount, count(DISTINCT o_orderkey) AS number_of_orders, count(DISTINCT l_suppkey) AS number_of_suppliers FROM nation JOIN supplier ON n_nationkey = s_nationkey JOIN partsupp ON s_suppkey = ps_suppkey JOIN part ON ps_partkey = p_partkey JOIN lineitem ON p_partkey = l_partkey AND ps_suppkey = l_suppkey JOIN orders ON l_orderkey = o_orderkey WHERE n_nationkey IN (1, 8, 9) AND l_commitdate BETWEEN '1995-06-22' AND '1997-02-19' AND l_receiptdate BETWEEN '1996-06-02' AND '1998-10-08' AND p_brand IN ('Brand#12', 'Brand#35', 'Brand#34', 'Brand#13', 'Brand#24') AND p_mfgr = 'Manufacturer#1' GROUP BY n_name, p_brand, p_type, p_size ORDER BY total_sales_after_discount DESC;
SELECT r_name AS region, n_name AS nation, COUNT(c_custkey) AS num_customers, SUM(c_acctbal) AS total_account_balance, AVG(c_acctbal) AS average_account_balance, SUM(l_extendedprice * (1 - l_discount)) AS sales_volume, COUNT(DISTINCT o_orderkey) AS num_orders, COUNT(l_orderkey) AS num_lineitems, AVG(l_quantity) AS average_quantity_sold FROM region JOIN nation ON r_regionkey = n_regionkey JOIN customer ON n_nationkey = c_nationkey JOIN orders ON c_custkey = o_custkey JOIN lineitem ON o_orderkey = l_orderkey WHERE n_name IN ('CHINA', 'FRANCE', 'INDONESIA', 'JAPAN') AND o_orderdate BETWEEN '1993-01-01' AND '1997-12-31' AND (o_orderstatus = 'F' OR o_orderstatus = 'O') GROUP BY r_name, n_name ORDER BY sales_volume DESC, num_customers DESC;
SELECT r_name AS region, n_name AS nation, COUNT(DISTINCT s_suppkey) AS num_suppliers, COUNT(DISTINCT c_custkey) AS num_customers, COUNT(DISTINCT o_orderkey) AS num_orders, SUM(l_extendedprice * (1 - l_discount)) AS total_revenue, AVG(c_acctbal) AS avg_customer_acctbal, AVG(s_acctbal) AS avg_supplier_acctbal, AVG(l_quantity) AS avg_quantity_sold, MAX(p_retailprice) AS max_part_retailprice FROM region JOIN nation ON n_regionkey = r_regionkey JOIN supplier ON s_nationkey = n_nationkey JOIN customer ON c_nationkey = n_nationkey JOIN orders ON o_custkey = c_custkey JOIN lineitem ON l_orderkey = o_orderkey AND l_suppkey = s_suppkey JOIN part ON p_partkey = l_partkey GROUP BY region, nation ORDER BY total_revenue DESC, region, nation;
SELECT r.r_name AS region, COUNT(DISTINCT c.c_custkey) AS num_customers, AVG(c.c_acctbal) AS avg_account_balance, SUM(p.p_retailprice) AS total_retail_price, COUNT(DISTINCT p.p_partkey) AS num_parts FROM region r JOIN customer c ON r.r_regionkey = c.c_nationkey JOIN part p ON c.c_custkey = p.p_partkey GROUP BY r.r_name ORDER BY total_retail_price DESC;
SELECT r_name AS region, n_name AS nation, EXTRACT(YEAR FROM o_orderdate) AS order_year, COUNT(DISTINCT o_orderkey) AS number_of_orders, SUM(l_extendedprice * (1 - l_discount)) AS total_revenue, AVG(l_quantity) AS average_quantity, SUM(l_quantity) AS total_quantity FROM region JOIN nation ON n_regionkey = r_regionkey JOIN customer ON c_nationkey = n_nationkey JOIN orders ON o_custkey = c_custkey JOIN lineitem ON l_orderkey = o_orderkey WHERE c_nationkey IN (6, 0, 4, 1, 10) AND c_comment LIKE '%packages. furiously bold fox%' AND o_orderdate BETWEEN DATE '1995-01-01' AND DATE '1996-12-31' GROUP BY region, nation, order_year ORDER BY total_revenue DESC, number_of_orders DESC, region, nation, order_year;
SELECT r_name AS region_name, n_name AS nation_name, COUNT(DISTINCT c_custkey) AS number_of_customers, COUNT(DISTINCT s_suppkey) AS number_of_suppliers, SUM(l_extendedprice) AS total_sales, AVG(l_extendedprice * (1 - l_discount)) AS avg_discounted_sales, SUM(l_quantity) AS total_quantity_sold FROM region JOIN nation ON n_regionkey = r_regionkey JOIN supplier ON s_nationkey = n_nationkey JOIN customer ON c_nationkey = n_nationkey JOIN lineitem ON s_suppkey = l_suppkey WHERE l_shipdate BETWEEN '2023-01-01' AND '2023-12-31' GROUP BY r_name, n_name ORDER BY total_sales DESC, region_name, nation_name;
SELECT r_name AS region, p_brand, COUNT(DISTINCT s_suppkey) AS number_of_suppliers, SUM(ps_availqty) AS total_available_quantity, AVG(ps_supplycost) AS average_supply_cost, SUM(l_extendedprice * (1 - l_discount)) AS total_revenue, AVG(l_quantity) AS average_quantity_sold FROM region JOIN supplier ON s_nationkey = r_regionkey JOIN partsupp ON s_suppkey = ps_suppkey JOIN part ON ps_partkey = p_partkey JOIN lineitem ON l_partkey = p_partkey AND l_suppkey = s_suppkey GROUP BY r_name, p_brand ORDER BY total_revenue DESC, average_supply_cost ASC LIMIT 5;
SELECT s.s_name AS supplier_name, COUNT(DISTINCT o.o_orderkey) AS total_orders, SUM(l.l_quantity) AS total_quantity, AVG(l.l_extendedprice) AS average_price, SUM(l.l_extendedprice * (1 - l.l_discount)) AS revenue, AVG(ps.ps_supplycost) AS average_supply_cost, MAX(l.l_quantity) AS max_quantity_sold, MIN(l.l_quantity) AS min_quantity_sold FROM supplier s JOIN lineitem l ON s.s_suppkey = l.l_suppkey JOIN orders o ON l.l_orderkey = o.o_orderkey JOIN partsupp ps ON l.l_partkey = ps.ps_partkey AND l.l_suppkey = ps.ps_suppkey WHERE l.l_shipmode IN ('AIR', 'REG AIR', 'RAIL', 'FOB') AND l.l_shipdate BETWEEN '1992-08-01' AND '1998-06-08' AND o.o_orderkey IN (7234, 15847, 1669) AND o.o_clerk IN ('Clerk#000007317', 'Clerk#000014363', 'Clerk#000020555', 'Clerk#000015715', 'Clerk#000023577', 'Clerk#000016730') AND ps.ps_partkey IN (925, 16, 773, 414, 236, 959) GROUP BY s.s_name ORDER BY total_orders DESC, revenue DESC LIMIT 10;
SELECT c.c_name, p.p_brand, o.o_orderdate, SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_sales, AVG(l.l_quantity) AS avg_quantity, COUNT(DISTINCT o.o_orderkey) AS num_orders FROM customer c JOIN orders o ON c.c_custkey = o.o_custkey JOIN lineitem l ON o.o_orderkey = l.l_orderkey JOIN part p ON l.l_partkey = p.p_partkey WHERE c.c_mktsegment = 'BUILDING' AND o.o_orderdate < DATE '1995-03-15' AND l.l_shipdate > DATE '1995-03-15' GROUP BY c.c_name, p.p_brand, o.o_orderdate ORDER BY total_sales DESC, c.c_name, p.p_brand LIMIT 10;
SELECT r.r_name AS region_name, COUNT(DISTINCT s.s_suppkey) AS number_of_suppliers, SUM(ps.ps_availqty) AS total_available_quantity, AVG(ps.ps_supplycost) AS average_supply_cost, MIN(p.p_retailprice) AS minimum_retail_price, MAX(p.p_retailprice) AS maximum_retail_price FROM region r JOIN supplier s ON s.s_nationkey = r.r_regionkey JOIN partsupp ps ON ps.ps_suppkey = s.s_suppkey JOIN part p ON p.p_partkey = ps.ps_partkey GROUP BY r.r_name ORDER BY r.r_name;
SELECT r_name, p_type, COUNT(DISTINCT c_custkey) AS num_customers, SUM(l_extendedprice) AS total_sales, AVG(l_quantity) AS avg_quantity_sold, AVG(l_extendedprice * (1 - l_discount)) AS avg_discounted_price FROM region JOIN customer ON c_nationkey = r_regionkey JOIN lineitem ON l_suppkey = c_custkey JOIN part ON p_partkey = l_partkey WHERE r_name IN ('EUROPE', 'AMERICA', 'AFRICA') AND p_type IN ('LARGE ANODIZED NICKEL', 'ECONOMY BRUSHED STEEL', 'MEDIUM PLATED BRASS', 'ECONOMY ANODIZED NICKEL', 'STANDARD BURNISHED COPPER') AND l_linestatus IN ('F', 'O') GROUP BY r_name, p_type ORDER BY r_name, total_sales DESC;
SELECT r.r_name AS region_name, EXTRACT(YEAR FROM l.l_shipdate) AS year_shipped, COUNT(DISTINCT s.s_suppkey) AS number_of_suppliers, SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_revenue, AVG(ps.ps_supplycost) AS average_supply_cost, SUM(l.l_quantity) AS total_quantity FROM region r JOIN supplier s ON r.r_regionkey = s.s_nationkey JOIN partsupp ps ON s.s_suppkey = ps.ps_suppkey JOIN lineitem l ON ps.ps_partkey = l.l_partkey AND ps.ps_suppkey = l.l_suppkey WHERE r.r_regionkey IN (3, 1) AND ps.ps_supplycost BETWEEN 300 AND 1000 AND r.r_comment LIKE '%final%' GROUP BY region_name, year_shipped ORDER BY total_revenue DESC, average_supply_cost ASC;
SELECT n_name, c_mktsegment, COUNT(DISTINCT c_custkey) AS total_customers, AVG(c_acctbal) AS average_account_balance, SUM(o_totalprice) AS total_sales_value, COUNT(DISTINCT o_orderkey) AS total_orders FROM nation JOIN customer ON nation.n_nationkey = customer.c_nationkey JOIN orders ON customer.c_custkey = orders.o_custkey WHERE c_mktsegment IN ('HOUSEHOLD', 'AUTOMOBILE', 'BUILDING', 'MACHINERY', 'FURNITURE') AND o_orderstatus = 'F' GROUP BY n_name, c_mktsegment ORDER BY total_sales_value DESC, n_name, c_mktsegment;
SELECT region.r_name AS region_name, nation.n_name AS nation_name, COUNT(supplier.s_suppkey) AS supplier_count, AVG(supplier.s_acctbal) AS average_account_balance, SUM(partsupp.ps_availqty) AS total_available_quantity, AVG(partsupp.ps_supplycost) AS average_supply_cost FROM region JOIN nation ON region.r_regionkey = nation.n_regionkey JOIN supplier ON nation.n_nationkey = supplier.s_nationkey JOIN partsupp ON supplier.s_suppkey = partsupp.ps_suppkey GROUP BY region.r_name, nation.n_name ORDER BY region_name, nation_name;
SELECT r_name, COUNT(DISTINCT ps_partkey) AS num_parts, SUM(ps_availqty) AS total_availability, AVG(ps_supplycost) AS avg_supply_cost, SUM(l_extendedprice * (1 - l_discount)) AS total_revenue, AVG(l_quantity) AS avg_quantity_sold FROM region JOIN partsupp ON r_regionkey = ps_suppkey % 5 JOIN lineitem ON ps_partkey = l_partkey AND ps_suppkey = l_suppkey WHERE r_regionkey IN (1, 3) AND l_shipdate BETWEEN date '2022-01-01' AND date '2022-12-31' AND l_discount BETWEEN 0.05 AND 0.07 AND l_quantity BETWEEN 5 AND 25 GROUP BY r_name ORDER BY total_revenue DESC;
SELECT r_name AS region_name, n_name AS nation_name, COUNT(DISTINCT s_suppkey) AS number_of_suppliers, SUM(l_extendedprice) AS total_sales, AVG(l_quantity) AS avg_quantity_sold, SUM(l_extendedprice * (1 - l_discount)) AS total_revenue_after_discount FROM region JOIN nation ON r_regionkey = n_regionkey JOIN supplier ON s_nationkey = n_nationkey JOIN lineitem ON l_suppkey = s_suppkey JOIN orders ON o_orderkey = l_orderkey JOIN part ON p_partkey = l_partkey WHERE r_name IN ('AFRICA', 'EUROPE', 'AMERICA', 'MIDDLE EAST') AND o_shippriority = '0' AND (n_nationkey = '7' OR n_nationkey = '16') AND (p_comment LIKE '%g dependenc%' OR p_partkey IN ('3221', '674', '3988', '1591', '3091')) AND o_orderdate BETWEEN '1995-01-01' AND '1996-12-31' AND (r_comment LIKE '%ly final courts cajole furiously final excuse%' OR r_comment LIKE '%ges. thinly even pinto beans ca%' OR r_comment LIKE '%hs use ironic, even requests. s%') GROUP BY r_name, n_name ORDER BY total_revenue_after_discount DESC, region_name, nation_name;
SELECT r.r_name AS region_name, COUNT(DISTINCT ps.ps_suppkey) AS number_of_suppliers, SUM(o.o_totalprice) AS total_sales, AVG(ps.ps_supplycost) AS average_supply_cost FROM region r JOIN partsupp ps ON r.r_regionkey = ps.ps_partkey JOIN orders o ON ps.ps_partkey = o.o_orderkey WHERE r.r_regionkey IN (1, 3, 4) AND r.r_name IN ('MIDDLE EAST', 'AFRICA', 'ASIA') AND o.o_orderstatus = 'F' GROUP BY r.r_name ORDER BY total_sales DESC;
SELECT n.n_name AS nation_name, c.c_mktsegment AS market_segment, COUNT(DISTINCT c.c_custkey) AS num_customers, SUM(l.l_quantity) AS total_quantity_ordered, AVG(l.l_extendedprice) AS avg_price, SUM(l.l_extendedprice * (1 - l_discount)) AS revenue_after_discount, AVG(ps.ps_supplycost) AS avg_supply_cost FROM customer c JOIN nation n ON c.c_nationkey = n.n_nationkey JOIN lineitem l ON c.c_custkey = l.l_suppkey JOIN partsupp ps ON l.l_partkey = ps.ps_partkey AND l.l_suppkey = ps.ps_suppkey WHERE c.c_mktsegment IN ('HOUSEHOLD', 'AUTOMOBILE', 'BUILDING', 'MACHINERY', 'FURNITURE') AND l.l_receiptdate BETWEEN '1994-01-01' AND '1998-12-31' AND l.l_commitdate < l.l_receiptdate AND ps.ps_supplycost IN (498.24, 99.63, 961.19, 162.95) AND ps.ps_partkey IN (1041, 906) GROUP BY nation_name, market_segment ORDER BY revenue_after_discount DESC, nation_name, market_segment;
SELECT r.r_name AS region_name, AVG(s.s_acctbal) AS avg_supplier_acctbal, COUNT(DISTINCT s.s_suppkey) AS total_suppliers, COUNT(DISTINCT p.p_partkey) AS total_parts, SUM(li.l_quantity) AS total_quantity_sold, SUM(li.l_extendedprice * (1 - li.l_discount)) AS total_sales_value, AVG(ps.ps_supplycost) AS avg_supply_cost FROM region r JOIN supplier s ON s.s_nationkey = r.r_regionkey JOIN partsupp ps ON ps.ps_suppkey = s.s_suppkey JOIN part p ON p.p_partkey = ps.ps_partkey JOIN lineitem li ON li.l_partkey = p.p_partkey AND li.l_suppkey = s.s_suppkey GROUP BY r.r_name ORDER BY total_sales_value DESC;
SELECT n.n_name AS nation_name, COUNT(DISTINCT c.c_custkey) AS number_of_customers, AVG(c.c_acctbal) AS average_account_balance, SUM(l.l_extendedprice * (1 - l.l_discount) * (1 + l.l_tax)) AS total_sales, ts.p_name AS top_selling_part, MAX(p.p_retailprice) AS max_retail_price FROM nation n JOIN customer c ON n.n_nationkey = c.c_nationkey JOIN lineitem l ON c.c_custkey = l.l_suppkey JOIN part p ON l.l_partkey = p.p_partkey JOIN partsupp ps ON p.p_partkey = ps.ps_partkey AND l.l_suppkey = ps.ps_suppkey LEFT JOIN ( SELECT li.l_suppkey AS suppkey, p.p_name, SUM(li.l_extendedprice * (1 - li.l_discount) * (1 + li.l_tax)) AS part_total_sales FROM part p JOIN lineitem li ON p.p_partkey = li.l_partkey GROUP BY li.l_suppkey, p.p_name ORDER BY part_total_sales DESC ) ts ON c.c_custkey = ts.suppkey WHERE n.n_regionkey IN (1, 4, 0, 2, 3) AND p.p_partkey IN (548, 4547, 1069, 1334) AND ps.ps_suppkey IN (60314, 60468, 120804, 1134, 120294) AND l.l_extendedprice > 39086.50 GROUP BY nation_name, ts.p_name ORDER BY total_sales DESC, average_account_balance DESC LIMIT 10;
SELECT reg.r_name AS region_name, COUNT(DISTINCT nat.n_nationkey) AS number_of_nations, AVG(sup.s_acctbal) AS avg_supplier_acct_balance, SUM(psup.ps_supplycost * psup.ps_availqty) AS total_parts_supply_cost FROM region reg JOIN nation nat ON reg.r_regionkey = nat.n_regionkey JOIN supplier sup ON nat.n_nationkey = sup.s_nationkey JOIN partsupp psup ON sup.s_suppkey = psup.ps_suppkey WHERE reg.r_name IN ('EUROPE', 'AMERICA') AND sup.s_acctbal > ( SELECT AVG(s_acctbal) FROM supplier WHERE s_nationkey = sup.s_nationkey ) GROUP BY reg.r_name ORDER BY total_parts_supply_cost DESC;
SELECT n.n_name AS nation, EXTRACT(YEAR FROM o.o_orderdate) AS order_year, COUNT(DISTINCT s.s_suppkey) AS number_of_suppliers, AVG(l.l_quantity) AS average_quantity_ordered, SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_revenue FROM supplier s JOIN nation n ON s.s_nationkey = n.n_nationkey JOIN lineitem l ON s.s_suppkey = l.l_suppkey JOIN orders o ON l.l_orderkey = o.o_orderkey JOIN customer c ON o.o_custkey = c.c_custkey JOIN part p ON l.l_partkey = p.p_partkey WHERE n.n_regionkey IN (4, 2) AND p.p_size BETWEEN 25 AND 31 AND o.o_orderdate BETWEEN DATE '2020-01-01' AND DATE '2020-12-31' AND o.o_clerk IN ('Clerk#000005453', 'Clerk#000013807', 'Clerk#000023271') GROUP BY nation, order_year ORDER BY total_revenue DESC, order_year;
SELECT r.r_name AS region, n.n_name AS nation, EXTRACT(YEAR FROM o.o_orderdate) AS order_year, COUNT(DISTINCT o.o_orderkey) AS number_of_orders, SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_revenue, AVG(l.l_quantity) AS average_quantity, AVG(c.c_acctbal) AS average_customer_balance, SUM(p.p_retailprice * l.l_quantity) AS total_parts_value FROM region r JOIN nation n ON r.r_regionkey = n.n_regionkey JOIN supplier s ON n.n_nationkey = s.s_nationkey JOIN lineitem l ON s.s_suppkey = l.l_suppkey JOIN orders o ON l.l_orderkey = o.o_orderkey JOIN customer c ON o.o_custkey = c.c_custkey JOIN part p ON l.l_partkey = p.p_partkey WHERE l.l_receiptdate >= '1994-01-01' AND l.l_receiptdate < '1995-01-01' AND l.l_returnflag = 'A' AND c.c_acctbal > 4000 AND s.s_comment LIKE '%quiet%' GROUP BY region, nation, order_year ORDER BY total_revenue DESC, region, nation, order_year;
SELECT r.r_name AS region, COUNT(DISTINCT s.s_suppkey) AS total_suppliers, COUNT(DISTINCT c.c_custkey) AS total_customers, COUNT(DISTINCT p.p_partkey) AS total_parts, SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_revenue, AVG(l.l_quantity) AS average_quantity, AVG(l.l_extendedprice) AS average_extended_price, SUM(ps.ps_availqty) AS total_available_quantity FROM region r JOIN supplier s ON s.s_nationkey = r.r_regionkey JOIN customer c ON c.c_nationkey = r.r_regionkey JOIN orders o ON o.o_custkey = c.c_custkey JOIN lineitem l ON l.l_orderkey = o.o_orderkey JOIN part p ON p.p_partkey = l.l_partkey JOIN partsupp ps ON ps.ps_partkey = p.p_partkey AND ps.ps_suppkey = l.l_suppkey WHERE r.r_regionkey = 1 AND l.l_shipdate BETWEEN '2022-01-01' AND '2022-12-31' AND o.o_orderstatus = 'F' GROUP BY r.r_name ORDER BY total_revenue DESC;
SELECT r_name AS region_name, n_name AS nation_name, p_brand, COUNT(DISTINCT ps_suppkey) AS number_of_suppliers, SUM(l_quantity) AS total_quantity_ordered, AVG(p_retailprice) AS average_retail_price, SUM(l_extendedprice * (1 - l_discount)) AS total_revenue FROM region JOIN nation ON n_regionkey = r_regionkey JOIN partsupp ON ps_suppkey = n_nationkey JOIN part ON p_partkey = ps_partkey JOIN lineitem ON l_partkey = p_partkey AND l_suppkey = ps_suppkey WHERE p_brand IN ('Brand#35', 'Brand#41') AND n_comment LIKE 'ven packages wake quickly. regu%' OR n_comment LIKE 'ously. final, express gifts cajole a%' GROUP BY region_name, nation_name, p_brand ORDER BY total_revenue DESC, average_retail_price ASC;
SELECT c_mktsegment, EXTRACT(YEAR FROM l_shipdate) AS ship_year, COUNT(DISTINCT c_custkey) AS number_of_customers, SUM(l_extendedprice * (1 - l_discount)) AS total_sales, AVG(l_quantity) AS average_quantity, SUM(ps_supplycost * l_quantity) AS total_supply_cost FROM customer JOIN lineitem ON c_custkey = l_orderkey JOIN partsupp ON lineitem.l_partkey = partsupp.ps_partkey AND lineitem.l_suppkey = partsupp.ps_suppkey WHERE l_shipdate BETWEEN date '1995-01-01' AND date '1996-12-31' GROUP BY c_mktsegment, ship_year ORDER BY total_sales DESC, ship_year, c_mktsegment;
SELECT r.r_name AS region, n.n_name AS nation, c.c_mktsegment AS market_segment, COUNT(DISTINCT c.c_custkey) AS num_customers, AVG(c.c_acctbal) AS avg_acct_balance, SUM(ps.ps_availqty) AS total_avail_qty, AVG(ps.ps_supplycost) AS avg_supply_cost, COUNT(DISTINCT o.o_orderkey) AS num_orders, SUM(o.o_totalprice) AS total_order_value FROM region r JOIN nation n ON r.r_regionkey = n.n_regionkey JOIN customer c ON n.n_nationkey = c.c_nationkey JOIN orders o ON c.c_custkey = o.o_custkey JOIN partsupp ps ON ps.ps_suppkey = o.o_custkey WHERE c.c_mktsegment IN ('AUTOMOBILE', 'FURNITURE') AND o.o_orderdate >= '1996-01-01' AND o.o_orderdate < '1996-02-01' GROUP BY region, nation, market_segment ORDER BY total_order_value DESC, avg_acct_balance DESC LIMIT 10;
SELECT r.r_name AS region_name, COUNT(DISTINCT c.c_custkey) AS num_customers, SUM(l.l_quantity) AS total_quantity_sold, AVG(l.l_extendedprice * (1 - l.l_discount)) AS avg_purchased_amount, SUM(CASE WHEN l.l_returnflag = 'R' THEN l.l_quantity ELSE 0 END) AS returned_quantity, SUM(CASE WHEN l.l_returnflag = 'R' THEN l.l_extendedprice * (1 - l.l_discount) ELSE 0 END) AS amount_returned FROM region r JOIN customer c ON r.r_regionkey = c.c_nationkey JOIN lineitem l ON c.c_custkey = l.l_orderkey WHERE r.r_name IN ('MIDDLE EAST', 'AFRICA', 'ASIA', 'AMERICA') AND l.l_receiptdate BETWEEN '1993-01-01' AND '1998-12-31' GROUP BY region_name ORDER BY total_quantity_sold DESC;
SELECT r.r_name AS region, n.n_name AS nation, COUNT(s.s_suppkey) AS total_suppliers, COUNT(c.c_custkey) AS total_customers, SUM(ps.ps_availqty) AS total_parts_available, AVG(s.s_acctbal) AS avg_supplier_acctbal, AVG(c.c_acctbal) AS avg_customer_acctbal, SUM(l.l_extendedprice * (1 - l.l_discount)) AS revenue, COUNT(DISTINCT o.o_orderkey) AS total_orders, COUNT(DISTINCT l.l_partkey) AS total_parts_ordered FROM region r JOIN nation n ON n.n_regionkey = r.r_regionkey JOIN supplier s ON s.s_nationkey = n.n_nationkey JOIN customer c ON c.c_nationkey = n.n_nationkey JOIN partsupp ps ON ps.ps_suppkey = s.s_suppkey JOIN lineitem l ON l.l_suppkey = s.s_suppkey AND l.l_partkey = ps.ps_partkey JOIN orders o ON o.o_orderkey = l.l_orderkey AND o.o_custkey = c.c_custkey GROUP BY r.r_name, n.n_name ORDER BY revenue DESC, total_suppliers DESC, total_customers DESC;
SELECT n.n_name AS nation, AVG(c.c_acctbal) AS avg_customer_balance, COUNT(DISTINCT o.o_orderkey) AS total_orders, SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_revenue FROM customer c JOIN nation n ON c.c_nationkey = n.n_nationkey JOIN orders o ON c.c_custkey = o.o_custkey JOIN lineitem l ON o.o_orderkey = l.l_orderkey JOIN part p ON l.l_partkey = p.p_partkey WHERE c.c_mktsegment = 'BUILDING' AND l.l_shipmode IN ('TRUCK', 'AIR') AND l.l_shipdate BETWEEN '2021-01-01' AND '2021-12-31' GROUP BY n.n_name ORDER BY total_revenue DESC, avg_customer_balance DESC LIMIT 10;
SELECT n.n_name AS nation, COUNT(DISTINCT s.s_suppkey) AS num_suppliers, AVG(l.l_quantity) AS avg_quantity, SUM(l.l_extendedprice) AS total_extended_price, SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_discounted_price, SUM(CASE WHEN l.l_returnflag = 'R' THEN 1 ELSE 0 END) AS num_returns FROM nation n JOIN supplier s ON n.n_nationkey = s.s_nationkey JOIN lineitem l ON s.s_suppkey = l.l_suppkey WHERE n.n_name IN ('RUSSIA', 'UNITED STATES') AND l.l_shipdate BETWEEN date '1995-01-01' AND date '1995-12-31' GROUP BY n.n_name ORDER BY total_discounted_price DESC;
SELECT r_name AS region, n_name AS nation, COUNT(DISTINCT s_suppkey) AS num_suppliers, COUNT(DISTINCT c_custkey) AS num_customers, AVG(s_acctbal) AS avg_supplier_acctbal, AVG(c_acctbal) AS avg_customer_acctbal, SUM(l_extendedprice * (1 - l_discount)) AS total_revenue FROM region JOIN nation ON n_regionkey = r_regionkey JOIN supplier ON s_nationkey = n_nationkey JOIN customer ON c_nationkey = n_nationkey JOIN orders ON o_custkey = c_custkey JOIN lineitem ON l_orderkey = o_orderkey WHERE r_regionkey IN (4, 1, 0) AND n_name = 'VIETNAM' AND l_shipdate BETWEEN DATE '1995-01-01' AND DATE '1996-01-01' GROUP BY r_name, n_name ORDER BY total_revenue DESC;
SELECT r.r_name AS region_name, COUNT(c.c_custkey) AS total_customers, AVG(c.c_acctbal) AS average_account_balance, SUM(ps.ps_availqty) AS total_available_parts, AVG(ps.ps_supplycost) AS average_supply_cost FROM region r JOIN customer c ON c.c_nationkey = r.r_regionkey JOIN partsupp ps ON ps.ps_suppkey = c.c_custkey GROUP BY r.r_name ORDER BY total_customers DESC;
SELECT n.n_name AS nation_name, COUNT(DISTINCT s.s_suppkey) AS number_of_suppliers, COUNT(DISTINCT c.c_custkey) AS number_of_customers, SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_revenue, AVG(l.l_quantity) AS avg_quantity_sold, SUM(l.l_quantity) AS total_quantity_sold FROM nation n JOIN supplier s ON n.n_nationkey = s.s_nationkey JOIN customer c ON n.n_nationkey = c.c_nationkey JOIN lineitem l ON s.s_suppkey = l.l_suppkey WHERE n.n_regionkey IN (1, 4, 0, 2, 3) AND l.l_shipdate BETWEEN '1994-01-01' AND '1994-12-31' AND l.l_receiptdate >= '1994-02-04' AND l.l_comment LIKE '%olites wak%' GROUP BY n.n_name ORDER BY total_revenue DESC;
SELECT r_name AS region_name, n_name AS nation_name, COUNT(s_suppkey) AS number_of_suppliers, AVG(s_acctbal) AS average_supplier_account_balance, SUM(c_acctbal) AS total_customer_account_balance, COUNT(DISTINCT o_orderkey) AS number_of_orders, SUM(l_extendedprice * (1 - l_discount)) AS total_revenue, AVG(l_quantity) AS average_quantity_ordered FROM region JOIN nation ON n_regionkey = r_regionkey JOIN supplier ON s_nationkey = n_nationkey JOIN customer ON c_nationkey = n_nationkey JOIN orders ON o_custkey = c_custkey JOIN lineitem ON l_orderkey = o_orderkey WHERE c_mktsegment = 'MACHINERY' AND o_orderdate >= '1992-01-01' AND o_orderdate < '1998-01-01' AND s_phone LIKE '23-140-878-9586%' GROUP BY region_name, nation_name ORDER BY total_revenue DESC;
SELECT EXTRACT(YEAR FROM o_orderdate) AS order_year, COUNT(DISTINCT o_orderkey) AS total_orders, SUM(l_extendedprice) AS total_revenue, AVG(l_extendedprice * (1 - l_discount)) AS avg_discounted_revenue, SUM(l_quantity) AS total_quantity_sold, AVG(ps_supplycost) AS avg_supply_cost, SUM(ps_availqty) AS total_available_quantity FROM orders JOIN lineitem ON o_orderkey = l_orderkey JOIN partsupp ON l_partkey = ps_partkey AND l_suppkey = ps_suppkey WHERE o_orderstatus = 'F' AND l_returnflag = 'N' AND l_shipdate BETWEEN '2022-01-01' AND '2022-12-31' AND ps_suppkey IN ('180465', '1179', '120006', '180387') AND ps_comment LIKE '%slyly%' GROUP BY order_year ORDER BY total_revenue DESC, avg_discounted_revenue DESC;
SELECT r.r_name AS region, COUNT(DISTINCT o.o_orderkey) AS total_orders, AVG(o.o_shippriority) AS avg_ship_priority, SUM(l.l_quantity) AS total_quantity_shipped, AVG(l.l_discount) AS avg_discount_offered FROM region r JOIN nation n ON r.r_regionkey = n.n_regionkey JOIN supplier s ON s.s_nationkey = n.n_nationkey JOIN partsupp ps ON ps.ps_suppkey = s.s_suppkey JOIN part p ON p.p_partkey = ps.ps_partkey JOIN lineitem l ON l.l_partkey = p.p_partkey AND l.l_suppkey = ps.ps_suppkey JOIN orders o ON o.o_orderkey = l.l_orderkey WHERE p.p_brand IN ('Brand#23', 'Brand#34') AND p.p_container IN ('SM BAG', 'JUMBO CAN') AND o.o_orderdate >= '2020-01-01'::date AND o.o_orderdate < '2021-01-01'::date GROUP BY r.r_name ORDER BY r.r_name;
SELECT c.c_mktsegment, c.c_nationkey, count(DISTINCT c.c_custkey) AS total_customers, sum(c.c_acctbal) AS total_balance, avg(c.c_acctbal) AS average_balance, sum(ps.ps_availqty) AS total_available_quantity, sum(ps.ps_supplycost * ps.ps_availqty) AS total_supply_cost_value FROM customer c JOIN partsupp ps ON c.c_custkey = ps.ps_suppkey JOIN supplier s ON ps.ps_suppkey = s.s_suppkey WHERE s.s_nationkey = c.c_nationkey AND ps.ps_availqty > 100 AND c.c_acctbal > 0 AND s.s_acctbal > 0 GROUP BY c.c_mktsegment, c.c_nationkey ORDER BY total_supply_cost_value DESC, total_customers DESC;
SELECT r_name AS region, extract(YEAR FROM o_orderdate) AS order_year, count(DISTINCT o_orderkey) AS total_orders, sum(l_extendedprice * (1 - l_discount)) AS revenue, avg(l_extendedprice * (1 - l_discount)) AS average_revenue_per_order, sum(c_acctbal) AS total_customer_balance, avg(s_acctbal) AS average_supplier_balance FROM region JOIN nation ON n_regionkey = r_regionkey JOIN customer ON c_nationkey = n_nationkey JOIN orders ON o_custkey = c_custkey JOIN lineitem ON l_orderkey = o_orderkey JOIN supplier ON s_nationkey = n_nationkey AND s_suppkey = l_suppkey WHERE l_shipdate >= '1995-01-01' AND l_shipdate < '1996-01-01' AND r_name IN ('MIDDLE EAST', 'ASIA', 'EUROPE', 'AMERICA', 'AFRICA') GROUP BY region, order_year ORDER BY revenue DESC, region, order_year;
SELECT r.r_name AS region_name, c.c_mktsegment AS market_segment, COUNT(DISTINCT o.o_orderkey) AS total_orders, COUNT(DISTINCT c.c_custkey) AS unique_customers, SUM(o.o_totalprice) AS total_sales, AVG(o.o_totalprice) AS average_order_value FROM region r JOIN nation n ON r.r_regionkey = n.n_regionkey JOIN customer c ON n.n_nationkey = c.c_nationkey JOIN orders o ON c.c_custkey = o.o_custkey GROUP BY r.r_name, c.c_mktsegment ORDER BY r.r_name, c.c_mktsegment;
SELECT r.r_name AS region, n.n_name AS nation, c.c_name AS customer_name, c.c_mktsegment AS market_segment, COUNT(o.o_orderkey) AS number_of_orders, AVG(o.o_totalprice) AS average_order_value, SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_revenue, AVG(l.l_quantity) AS average_quantity_ordered FROM region r JOIN nation n ON r.r_regionkey = n.n_regionkey JOIN customer c ON n.n_nationkey = c.c_nationkey JOIN orders o ON c.c_custkey = o.o_custkey JOIN lineitem l ON o.o_orderkey = l.l_orderkey WHERE r.r_name IN ('AFRICA', 'EUROPE', 'AMERICA', 'MIDDLE EAST') AND c.c_mktsegment IN ('HOUSEHOLD', 'AUTOMOBILE', 'BUILDING', 'MACHINERY', 'FURNITURE') AND l.l_shipdate BETWEEN '1995-01-01' AND '1996-12-31' GROUP BY region, nation, customer_name, market_segment ORDER BY total_revenue DESC, average_order_value DESC LIMIT 100;
SELECT r.r_name AS region, c.c_mktsegment AS market_segment, COUNT(DISTINCT o.o_orderkey) AS total_orders, SUM(l.l_quantity) AS total_quantity, AVG(l.l_extendedprice) AS avg_price, SUM(l.l_extendedprice * (1 - l.l_discount)) AS revenue_after_discount, SUM(CASE WHEN l.l_returnflag = 'R' THEN l.l_quantity ELSE 0 END) AS returned_quantity, COUNT(CASE WHEN l.l_shipinstruct = 'DELIVER IN PERSON' THEN 1 END) AS personal_deliveries FROM region r JOIN customer c ON c.c_nationkey = r.r_regionkey JOIN orders o ON o.o_custkey = c.c_custkey JOIN lineitem l ON l.l_orderkey = o.o_orderkey WHERE r.r_regionkey = 1 AND o.o_orderdate BETWEEN date '1995-01-01' AND date '1996-12-31' AND l.l_shipmode IN ('RAIL', 'TRUCK') GROUP BY region, market_segment ORDER BY revenue_after_discount DESC;
SELECT n.n_name AS nation, AVG(s.s_acctbal) AS average_account_balance, COUNT(DISTINCT s.s_suppkey) AS number_of_suppliers, SUM(ps.ps_availqty) AS total_available_quantity, SUM(ps.ps_supplycost * ps.ps_availqty) AS total_supply_cost FROM nation AS n JOIN supplier AS s ON n.n_nationkey = s.s_nationkey JOIN partsupp AS ps ON s.s_suppkey = ps.ps_suppkey JOIN part AS p ON ps.ps_partkey = p.p_partkey WHERE p.p_size IN (5, 26) AND ps.ps_comment LIKE '%final%' AND s.s_phone IN ('10-235-972-1443', '18-693-682-4752', '10-146-485-1160') AND p.p_name LIKE '%lavender%' GROUP BY n.n_name ORDER BY total_supply_cost DESC, average_account_balance DESC;
SELECT r_name AS region, n_name AS nation, COUNT(DISTINCT c_custkey) AS number_of_customers, SUM(c_acctbal) AS total_account_balance, AVG(c_acctbal) AS avg_account_balance, SUM(l_extendedprice * (1 - l_discount)) AS revenue, AVG(l_quantity) AS avg_quantity_sold, COUNT(DISTINCT o_orderkey) AS number_of_orders FROM region JOIN nation ON n_regionkey = r_regionkey JOIN customer ON c_nationkey = n_nationkey JOIN orders ON o_custkey = c_custkey JOIN lineitem ON l_orderkey = o_orderkey JOIN part ON part.p_partkey = lineitem.l_partkey WHERE r_name IN ('EUROPE', 'AMERICA') AND o_orderdate BETWEEN DATE '1995-01-01' AND DATE '1996-12-31' AND part.p_type IN ('ECONOMY POLISHED COPPER', 'LARGE BURNISHED NICKEL', 'PROMO PLATED NICKEL', 'STANDARD BRUSHED BRASS', 'STANDARD POLISHED COPPER') AND part.p_mfgr IN ('Manufacturer#4', 'Manufacturer#1', 'Manufacturer#2', 'Manufacturer#5') GROUP BY region, nation ORDER BY revenue DESC;
SELECT n.n_name AS nation, AVG(c.c_acctbal) AS avg_customer_acctbal, AVG(s.s_acctbal) AS avg_supplier_acctbal, COUNT(DISTINCT o.o_orderkey) AS total_orders, COUNT(DISTINCT c.c_custkey) AS total_customers, COUNT(DISTINCT s.s_suppkey) AS total_suppliers FROM customer c JOIN orders o ON c.c_custkey = o.o_custkey JOIN lineitem l ON o.o_orderkey = l.l_orderkey JOIN supplier s ON l.l_suppkey = s.s_suppkey JOIN nation n ON c.c_nationkey = n.n_nationkey AND s.s_nationkey = n.n_nationkey WHERE c.c_mktsegment = 'MACHINERY' GROUP BY n.n_name ORDER BY avg_customer_acctbal DESC, avg_supplier_acctbal DESC;
SELECT r.r_name AS region_name, COUNT(DISTINCT o.o_orderkey) AS number_of_orders, SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_sales_revenue, AVG(l.l_extendedprice * (1 - l.l_discount)) AS average_sales_per_order FROM customer c JOIN orders o ON c.c_custkey = o.o_custkey JOIN lineitem l ON o.o_orderkey = l.l_orderkey JOIN supplier s ON l.l_suppkey = s.s_suppkey JOIN region r ON s.s_nationkey = c.c_nationkey WHERE c.c_mktsegment = 'FURNITURE' AND o.o_orderdate BETWEEN DATE '2022-01-01' AND DATE '2022-12-31' GROUP BY r.r_name ORDER BY total_sales_revenue DESC;
SELECT r.r_name AS region, COUNT(DISTINCT s.s_suppkey) AS num_suppliers, COUNT(DISTINCT c.c_custkey) AS num_customers, AVG(s.s_acctbal) AS avg_supplier_acctbal, AVG(c.c_acctbal) AS avg_customer_acctbal, SUM(ps.ps_availqty) AS total_avail_parts, SUM(li.l_quantity) AS total_ordered_quantity, SUM(li.l_extendedprice * (1 - li.l_discount)) AS total_revenue FROM region r JOIN supplier s ON s.s_nationkey = r.r_regionkey JOIN customer c ON c.c_nationkey = r.r_regionkey JOIN partsupp ps ON ps.ps_suppkey = s.s_suppkey JOIN lineitem li ON li.l_suppkey = s.s_suppkey AND li.l_partkey = ps.ps_partkey JOIN orders o ON o.o_orderkey = li.l_orderkey AND o.o_custkey = c.c_custkey GROUP BY r.r_name ORDER BY total_revenue DESC, region;
SELECT r.r_name AS region, COUNT(DISTINCT n.n_nationkey) AS number_of_nations, SUM(oi.total_price) AS total_sales, AVG(s.s_acctbal) AS average_supplier_account_balance FROM region r JOIN nation n ON r.r_regionkey = n.n_regionkey JOIN supplier s ON n.n_nationkey = s.s_nationkey JOIN ( SELECT l.l_suppkey, o.o_orderdate, SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_price FROM lineitem l JOIN orders o ON l.l_orderkey = o.o_orderkey WHERE l.l_shipdate BETWEEN '1995-01-01' AND '1995-12-31' AND o.o_orderstatus = 'F' GROUP BY l.l_suppkey, o.o_orderdate ) AS oi ON s.s_suppkey = oi.l_suppkey WHERE r.r_comment LIKE '%final%' GROUP BY region ORDER BY total_sales DESC, average_supplier_account_balance DESC LIMIT 5;
SELECT r_name AS region, n_name AS nation, COUNT(DISTINCT s_suppkey) AS number_of_suppliers, COUNT(DISTINCT o_orderkey) AS number_of_orders, SUM(l_extendedprice) AS total_sales_volume, AVG(l_quantity) AS average_quantity_per_lineitem, SUM((l_extendedprice * (1 - l_discount)) * (1 + l_tax)) AS total_revenue_after_discount_and_tax FROM region JOIN nation ON r_regionkey = n_regionkey JOIN supplier ON s_nationkey = n_nationkey JOIN lineitem ON l_suppkey = s_suppkey JOIN orders ON o_orderkey = l_orderkey JOIN part ON p_partkey = l_partkey WHERE r_regionkey IN (1, 2, 3, 4, 0) AND p_mfgr IN ('Manufacturer#1', 'Manufacturer#2', 'Manufacturer#3', 'Manufacturer#4', 'Manufacturer#5') AND (p_comment LIKE '%e the blit%' OR p_comment LIKE '%endencies%' OR p_comment LIKE '%inal, regu%') AND o_orderdate BETWEEN '1993-01-01' AND '1993-12-31' GROUP BY region, nation ORDER BY total_sales_volume DESC, total_revenue_after_discount_and_tax DESC;
SELECT c.c_mktsegment, COUNT(DISTINCT c.c_custkey) AS num_customers, ROUND(AVG(c.c_acctbal), 2) AS avg_account_balance, SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_revenue, SUM(CASE WHEN l.l_returnflag = 'R' THEN l.l_quantity ELSE 0 END) AS total_returned_qty, MAX(p.ps_supplycost) AS max_supply_cost FROM customer c JOIN lineitem l ON c.c_custkey = (SELECT c_custkey FROM customer WHERE c_address LIKE 'irb0,DeCT7gSK5%' LIMIT 1) JOIN partsupp p ON p.ps_partkey = l.l_partkey AND p.ps_suppkey = l.l_suppkey WHERE l.l_shipdate BETWEEN '2020-01-01' AND '2020-12-31' AND p.ps_partkey IN ('655', '716', '1105', '395', '311') GROUP BY c.c_mktsegment ORDER BY total_revenue DESC;
SELECT r_name AS region, n_name AS country, COUNT(DISTINCT s_suppkey) AS supplier_count, COUNT(DISTINCT c_custkey) AS customer_count, AVG(s_acctbal) AS avg_supplier_acctbal, AVG(c_acctbal) AS avg_customer_acctbal, SUM(l_extendedprice * (1 - l_discount)) AS total_sales_volume FROM region JOIN nation ON r_regionkey = n_regionkey JOIN supplier ON n_nationkey = s_nationkey JOIN customer ON n_nationkey = c_nationkey JOIN orders ON c_custkey = o_custkey JOIN lineitem ON o_orderkey = l_orderkey WHERE n_name IN ('ROMANIA', 'BRAZIL', 'INDIA') AND l_shipinstruct IN ('COLLECT COD', 'TAKE BACK RETURN', 'NONE', 'DELIVER IN PERSON') AND l_shipdate BETWEEN date '2022-01-01' AND date '2022-12-31' GROUP BY region, country ORDER BY total_sales_volume DESC;
SELECT n.n_name AS nation, c.c_mktsegment AS market_segment, AVG(c.c_acctbal) AS avg_customer_balance, SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_spending, COUNT(DISTINCT s.s_suppkey) AS number_of_suppliers, COUNT(DISTINCT p.p_partkey) AS number_of_parts FROM customer c JOIN nation n ON c.c_nationkey = n.n_nationkey JOIN orders o ON c.c_custkey = o.o_custkey JOIN lineitem l ON o.o_orderkey = l.l_orderkey JOIN partsupp ps ON l.l_partkey = ps.ps_partkey AND l.l_suppkey = ps.ps_suppkey JOIN supplier s ON ps.ps_suppkey = s.s_suppkey AND s.s_nationkey = n.n_nationkey JOIN part p ON ps.ps_partkey = p.p_partkey WHERE n.n_regionkey IN ('3', '1') AND l.l_shipmode IN ('AIR', 'MAIL', 'SHIP', 'FOB', 'RAIL', 'TRUCK') GROUP BY n.n_name, c.c_mktsegment ORDER BY total_spending DESC, avg_customer_balance DESC LIMIT 10;
SELECT r.r_name AS region_name, COUNT(DISTINCT s.s_suppkey) AS total_suppliers, COUNT(DISTINCT p.p_partkey) AS total_parts, COUNT(DISTINCT o.o_orderkey) AS total_orders, AVG(s.s_acctbal) AS average_supplier_balance, AVG(p.p_retailprice) AS average_part_price, SUM(o.o_totalprice) AS total_revenue FROM region r JOIN supplier s ON r.r_regionkey = s.s_nationkey JOIN orders o ON s.s_suppkey = o.o_custkey JOIN part p ON p.p_size IN (19, 37) WHERE r.r_name = 'ASIA' AND p.p_name IN ( 'deep dim dodger navajo peru', 'navajo red mint misty papaya', 'rosy slate antique dodger sky', 'turquoise seashell misty navajo thistle' ) GROUP BY region_name ORDER BY total_revenue DESC;
SELECT n.n_name AS nation_name, COUNT(DISTINCT o.o_orderkey) AS total_orders, SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_revenue, AVG(l.l_quantity) AS avg_quantity, AVG(l.l_extendedprice) AS avg_price, AVG(l.l_discount) AS avg_discount, MAX(p.p_retailprice) AS max_part_price FROM nation n JOIN orders o ON o.o_orderdate >= '1995-01-01' AND o.o_orderdate < '1996-01-01' JOIN lineitem l ON l.l_orderkey = o.o_orderkey JOIN part p ON p.p_partkey = l.l_partkey JOIN partsupp ps ON ps.ps_partkey = l.l_partkey AND ps.ps_suppkey = l.l_suppkey WHERE n.n_nationkey = o.o_custkey AND n.n_name IN ('BRAZIL', 'CHINA', 'ROMANIA') AND n.n_regionkey IN (1, 3, 4, 0) GROUP BY nation_name ORDER BY total_revenue DESC;
SELECT n.n_name AS nation_name, COUNT(o.o_orderkey) AS total_orders, SUM(o.o_totalprice) AS total_revenue, AVG(ps.ps_supplycost) AS average_supply_cost, SUM(ps.ps_availqty) AS total_parts_available FROM orders o JOIN nation n ON o.o_custkey = n.n_nationkey JOIN partsupp ps ON o.o_orderkey = ps.ps_partkey JOIN part p ON ps.ps_partkey = p.p_partkey WHERE o.o_orderstatus = 'O' AND o.o_shippriority = 0 AND p.p_size BETWEEN 1 AND 50 GROUP BY n.n_name HAVING SUM(o.o_totalprice) > 100000 ORDER BY total_revenue DESC, nation_name;
SELECT r.r_name AS region_name, COUNT(DISTINCT n.n_nationkey) AS total_nations, SUM(ps.ps_availqty) AS total_available_quantity, AVG(ps.ps_supplycost) AS average_supply_cost, MIN(ps.ps_supplycost) AS minimum_supply_cost, MAX(ps.ps_supplycost) AS maximum_supply_cost FROM region r JOIN nation n ON r.r_regionkey = n.n_regionkey JOIN partsupp ps ON ps.ps_suppkey = n.n_nationkey GROUP BY r.r_name ORDER BY total_available_quantity DESC;
SELECT c.c_mktsegment, r.r_name AS region, COUNT(DISTINCT c.c_custkey) AS num_customers, AVG(c.c_acctbal) AS avg_customer_acctbal, SUM(l.l_extendedprice) AS total_sales, COUNT(DISTINCT l.l_partkey) AS num_unique_parts_purchased, AVG(l.l_discount) AS avg_discount_received FROM customer c JOIN supplier s ON c.c_nationkey = s.s_nationkey JOIN lineitem l ON s.s_suppkey = l.l_suppkey JOIN part p ON l.l_partkey = p.p_partkey JOIN region r ON c.c_nationkey = r.r_regionkey WHERE r.r_name = 'EUROPE' AND c.c_mktsegment = 'BUILDING' AND p.p_brand = 'Brand#13' GROUP BY c.c_mktsegment, r.r_name ORDER BY total_sales DESC;
SELECT r.r_name AS Region, c.c_mktsegment AS MarketSegment, COUNT(c.c_custkey) AS NumberOfCustomers, AVG(c.c_acctbal) AS AverageAccountBalance, SUM(l.l_extendedprice * (1 - l.l_discount)) AS TotalSpending FROM customer c JOIN nation n ON c.c_nationkey = n.n_nationkey JOIN region r ON n.n_regionkey = r.r_regionkey LEFT JOIN lineitem l ON c.c_custkey = l.l_orderkey WHERE c.c_acctbal > 0 AND l.l_shipdate BETWEEN date '2020-01-01' AND date '2020-12-31' GROUP BY Region, MarketSegment ORDER BY TotalSpending DESC, AverageAccountBalance DESC;
SELECT r.r_name AS region, n.n_name AS nation, COUNT(DISTINCT c.c_custkey) AS customer_count, COUNT(DISTINCT s.s_suppkey) AS supplier_count, SUM(ps.ps_availqty) AS total_avail_qty, AVG(ps.ps_supplycost) AS avg_supply_cost, SUM(l.l_extendedprice * (1 - l.l_discount)) AS revenue, AVG(l.l_quantity) AS avg_quantity_sold FROM region r JOIN nation n ON r.r_regionkey = n.n_regionkey JOIN supplier s ON n.n_nationkey = s.s_nationkey JOIN partsupp ps ON s.s_suppkey = ps.ps_suppkey JOIN lineitem l ON ps.ps_partkey = l.l_partkey AND ps.ps_suppkey = l.l_suppkey JOIN orders o ON l.l_orderkey = o.o_orderkey JOIN customer c ON o.o_custkey = c.c_custkey AND c.c_nationkey = n.n_nationkey WHERE r.r_name <> 'REGION NAME TO EXCLUDE' AND l.l_shipdate BETWEEN '2023-01-01' AND '2023-12-31' AND (ps.ps_supplycost = 387.63 OR ps.ps_supplycost = 353.01) AND ps.ps_availqty = 4669 AND (o.o_comment LIKE '%pinto beans wake furiously reg%' OR o.o_comment LIKE '%counts will use. carefully regular pinto beans%') AND c.c_address <> 'd9 fWSCFsPQ49YjEsfqtJ8Cemmix7nfTkRS8nU r' AND n.n_nationkey NOT IN (14, 1, 22) AND n.n_comment NOT LIKE '%ously. final, express gifts cajole a%' GROUP BY r.r_name, n.n_name ORDER BY revenue DESC, region, nation;
SELECT s.s_name, p.p_brand, COUNT(DISTINCT l.l_orderkey) AS total_orders, SUM(l.l_quantity) AS total_quantity, AVG(l.l_extendedprice) AS avg_price, SUM(l.l_extendedprice * (1 - l.l_discount)) AS revenue_after_discount FROM supplier s JOIN lineitem l ON s.s_suppkey = l.l_suppkey JOIN part p ON l.l_partkey = p.p_partkey WHERE s.s_nationkey IN (11, 24, 14, 16) AND l.l_shipdate BETWEEN '2022-01-01' AND '2022-12-31' AND p.p_retailprice > 1800 GROUP BY s.s_name, p.p_brand ORDER BY revenue_after_discount DESC, total_orders DESC LIMIT 10;
SELECT n.n_name AS nation_name, SUM(s.s_acctbal) AS total_supplier_balance, AVG(c.c_acctbal) AS avg_customer_balance, COUNT(DISTINCT p.p_partkey) AS num_parts, SUM(ps.ps_availqty) AS total_available_quantity, AVG(l.l_extendedprice * (1 - l.l_discount)) AS avg_discounted_price, COUNT(DISTINCT o.o_orderkey) AS num_orders FROM nation n JOIN supplier s ON n.n_nationkey = s.s_nationkey JOIN customer c ON n.n_nationkey = c.c_nationkey JOIN partsupp ps ON s.s_suppkey = ps.ps_suppkey JOIN part p ON ps.ps_partkey = p.p_partkey JOIN lineitem l ON ps.ps_partkey = l.l_partkey AND ps.ps_suppkey = l.l_suppkey JOIN orders o ON l.l_orderkey = o.o_orderkey AND c.c_custkey = o.o_custkey WHERE n.n_name = 'GERMANY' AND l.l_shipdate BETWEEN DATE '1995-01-01' AND DATE '1996-12-31' AND p.p_type LIKE '%STEEL' GROUP BY n.n_name ORDER BY total_supplier_balance DESC, avg_customer_balance DESC, num_parts DESC, total_available_quantity DESC, avg_discounted_price DESC, num_orders DESC LIMIT 1;
SELECT r_name AS region, n_name AS nation, COUNT(DISTINCT l_orderkey) AS total_orders, SUM(l_quantity) AS total_quantity, AVG(l_extendedprice) AS avg_price, SUM(l_extendedprice * (1 - l_discount)) AS total_discounted_price, SUM(CASE WHEN l_tax = '0.00' THEN l_extendedprice * (1 - l_discount) END) AS total_tax_free_sales, SUM(CASE WHEN l_tax > '0.00' THEN l_extendedprice * (1 - l_discount) END) AS total_taxed_sales, COUNT(CASE WHEN l_returnflag = 'R' THEN 1 END) AS returns_count FROM region JOIN nation ON n_regionkey = r_regionkey JOIN lineitem ON l_suppkey = n_nationkey WHERE n_name IN ('ROMANIA', 'UNITED KINGDOM', 'UNITED STATES', 'ALGERIA') AND (l_shipdate BETWEEN '1995-01-01' AND '1996-12-31' OR l_receiptdate BETWEEN '1995-01-01' AND '1996-12-31') GROUP BY r_name, n_name ORDER BY total_orders DESC, total_quantity DESC;
SELECT n.n_name, c.c_mktsegment, AVG(c.c_acctbal) AS average_account_balance, COUNT(DISTINCT c.c_custkey) AS number_of_customers, SUM(ps.ps_availqty) AS total_available_quantity, AVG(ps.ps_supplycost) AS average_supply_cost, SUM(p.p_retailprice * ps.ps_availqty) AS total_retail_value FROM nation n JOIN customer c ON c.c_nationkey = n.n_nationkey JOIN partsupp ps ON ps.ps_partkey IN (SELECT p_partkey FROM part WHERE p_name IN ('forest mint goldenrod saddle hot', 'wheat almond blue cream ivory')) JOIN part p ON p.p_partkey = ps.ps_partkey GROUP BY n.n_name, c.c_mktsegment ORDER BY n.n_name, c.c_mktsegment;
SELECT c.c_mktsegment, p.p_brand, COUNT(DISTINCT o.o_orderkey) as total_orders, AVG(o.o_totalprice) as avg_order_value, SUM(o.o_totalprice) as total_revenue, MIN(o.o_totalprice) as min_order_value, MAX(o.o_totalprice) as max_order_value FROM customer c JOIN orders o ON c.c_custkey = o.o_custkey JOIN part p ON p.p_size = o.o_shippriority WHERE c.c_mktsegment IN ('MACHINERY', 'BUILDING') AND p.p_brand IN ('Brand#11', 'Brand#53', 'Brand#34') AND o.o_orderstatus = 'F' GROUP BY c.c_mktsegment, p.p_brand ORDER BY total_revenue DESC, c.c_mktsegment, p.p_brand;
SELECT r.r_name AS region_name, COUNT(DISTINCT s.s_suppkey) AS number_of_suppliers, AVG(s.s_acctbal) AS avg_supplier_acct_balance, AVG(p.p_size) AS avg_part_size FROM supplier s JOIN nation n ON s.s_nationkey = n.n_nationkey JOIN region r ON n.n_regionkey = r.r_regionkey JOIN lineitem li ON s.s_suppkey = li.l_suppkey JOIN part p ON li.l_partkey = p.p_partkey WHERE li.l_shipmode IN ('AIR', 'REG AIR') GROUP BY r.r_name ORDER BY avg_supplier_acct_balance DESC, number_of_suppliers DESC;
SELECT r_name AS region, n_name AS nation, COUNT(DISTINCT s_suppkey) AS supplier_count, COUNT(DISTINCT c_custkey) AS customer_count, SUM(s_acctbal) AS total_supplier_balance, AVG(s_acctbal) AS average_supplier_balance, SUM(c_acctbal) AS total_customer_balance, AVG(c_acctbal) AS average_customer_balance, SUM(ps_availqty) AS total_parts_available, AVG(ps_supplycost) AS average_supply_cost, SUM(l_extendedprice) AS total_sales, SUM(l_extendedprice * (1 - l_discount)) AS total_discounted_sales, AVG(l_quantity) AS average_quantity_sold, COUNT(DISTINCT p_partkey) AS part_count FROM region JOIN nation ON r_regionkey = n_regionkey JOIN supplier ON n_nationkey = s_nationkey JOIN customer ON n_nationkey = c_nationkey JOIN partsupp ON s_suppkey = ps_suppkey JOIN lineitem ON ps_partkey = l_partkey AND ps_suppkey = l_suppkey JOIN part ON p_partkey = l_partkey WHERE s_nationkey IN (8, 17, 5, 9) AND s_address IN ('iRMUcv4DhTAmNMGPMauw,WxwEDthLr3pYUMnfZD', 'Rb0LA4sA0x') AND l_shipdate BETWEEN DATE '1995-01-01' AND DATE '1996-12-31' GROUP BY region, nation ORDER BY total_sales DESC;
SELECT n.n_name AS nation_name, AVG(s.s_acctbal) AS average_account_balance, SUM(ps.ps_supplycost) AS total_supply_cost, COUNT(DISTINCT s.s_suppkey) AS number_of_suppliers, COUNT(DISTINCT p.p_partkey) AS number_of_parts, COUNT(DISTINCT o.o_orderkey) AS number_of_orders FROM nation n JOIN supplier s ON n.n_nationkey = s.s_nationkey JOIN partsupp ps ON s.s_suppkey = ps.ps_suppkey JOIN part p ON ps.ps_partkey = p.p_partkey JOIN orders o ON o.o_orderdate BETWEEN DATE '1995-01-01' AND DATE '1996-12-31' WHERE p.p_brand IN ('Brand#22', 'Brand#24') AND n.n_nationkey IN (16, 17, 0, 24) AND o.o_shippriority = 0 AND ps.ps_comment LIKE ANY (ARRAY['%tions. furiously even theodolites haggle. furious%', '%ages after the blithely final ideas thrash carefu%', '%kly blithely regular packages. regular accounts p%']) GROUP BY nation_name ORDER BY total_supply_cost DESC;
SELECT s.s_name AS supplier_name, r.r_name AS region_name, COUNT(DISTINCT ps.ps_partkey) AS total_parts_provided, AVG(l.l_extendedprice / l.l_quantity) AS avg_purchase_size, SUM(l.l_quantity) AS total_quantity_purchased, SUM(l.l_extendedprice) AS total_purchase_value FROM supplier s JOIN region r ON s.s_nationkey = r.r_regionkey JOIN partsupp ps ON s.s_suppkey = ps.ps_suppkey JOIN lineitem l ON ps.ps_suppkey = l.l_suppkey AND ps.ps_partkey = l.l_partkey JOIN orders o ON l.l_orderkey = o.o_orderkey WHERE o.o_orderdate >= '1995-01-01' AND o.o_orderdate < '1996-01-01' GROUP BY s.s_name, r.r_name ORDER BY total_purchase_value DESC, supplier_name;
SELECT r.r_name AS region, c.c_mktsegment AS market_segment, EXTRACT(YEAR FROM o.o_orderdate) AS order_year, COUNT(DISTINCT o.o_orderkey) AS total_orders, SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_sales_volume, AVG(l.l_extendedprice * (1 - l.l_discount)) AS avg_purchase_size FROM customer c JOIN orders o ON c.c_custkey = o.o_custkey JOIN lineitem l ON o.o_orderkey = l.l_orderkey JOIN nation n ON c.c_nationkey = n.n_nationkey JOIN region r ON n.n_regionkey = r.r_regionkey WHERE o.o_orderstatus IN ('F', 'O') AND EXTRACT(YEAR FROM o.o_orderdate) = 1995 GROUP BY region, market_segment, order_year ORDER BY total_sales_volume DESC, avg_purchase_size DESC;
SELECT p.p_size, p.p_brand, AVG(ps.ps_supplycost) AS average_supply_cost, SUM(ps.ps_availqty) AS total_available_quantity, AVG(s.s_acctbal) AS average_supplier_account_balance, c.c_mktsegment, COUNT(DISTINCT s.s_suppkey) AS number_of_suppliers, COUNT(DISTINCT c.c_custkey) AS number_of_customers FROM part p JOIN partsupp ps ON p.p_partkey = ps.ps_partkey JOIN supplier s ON ps.ps_suppkey = s.s_suppkey JOIN customer c ON s.s_nationkey = c.c_nationkey WHERE p.p_size IN (11, 36, 13, 26, 12, 46) AND c.c_mktsegment = 'MACHINERY' AND s.s_comment LIKE '%slyly ruthless%' GROUP BY p.p_size, p.p_brand, c.c_mktsegment ORDER BY p.p_size, p.p_brand, c.c_mktsegment;
SELECT r_name AS region, n_name AS nation, COUNT(DISTINCT s_suppkey) AS number_of_suppliers, COUNT(DISTINCT c_custkey) AS number_of_customers, AVG(s_acctbal) AS avg_supplier_acctbal, AVG(c_acctbal) AS avg_customer_acctbal, SUM(l_extendedprice * (1 - l_discount)) AS total_sales_value FROM region JOIN nation ON r_regionkey = n_regionkey JOIN supplier ON n_nationkey = s_nationkey JOIN customer ON n_nationkey = c_nationkey JOIN orders ON c_custkey = o_custkey JOIN lineitem ON o_orderkey = l_orderkey WHERE o_orderstatus = 'F' AND l_shipdate <= '2023-01-01' AND l_returnflag = 'N' GROUP BY r_name, n_name ORDER BY total_sales_value DESC, region, nation;
SELECT r_name AS region_name, n_name AS nation_name, COUNT(DISTINCT o_orderkey) AS total_orders, SUM(c_acctbal) AS total_customer_balance, AVG(l_extendedprice * (1 - l_discount)) AS avg_order_value, SUM(l_quantity) AS total_parts_ordered FROM region JOIN nation ON r_regionkey = n_regionkey JOIN customer ON n_nationkey = c_nationkey JOIN orders ON c_custkey = o_custkey JOIN lineitem ON o_orderkey = l_orderkey JOIN part ON p_partkey = l_partkey WHERE r_regionkey IN (1, 2, 3) AND l_linestatus = 'O' AND p_comment LIKE '%ular p%' GROUP BY region_name, nation_name ORDER BY total_orders DESC, total_customer_balance DESC, avg_order_value DESC;
SELECT s.s_name, p.p_brand, l.l_shipmode, COUNT(DISTINCT l.l_orderkey) AS total_orders, SUM(l.l_extendedprice) AS total_sales, AVG(l.l_extendedprice * (1 - l_discount)) AS avg_discounted_price, SUM(CASE WHEN l.l_returnflag = 'R' THEN l.l_quantity ELSE 0 END) AS total_returned_qty, AVG(l.l_discount) AS avg_discount_rate, COUNT(*) AS total_lineitems FROM supplier s JOIN lineitem l ON s.s_suppkey = l.l_suppkey JOIN part p ON l.l_partkey = p.p_partkey WHERE l.l_shipdate BETWEEN '1995-01-01' AND '1995-12-31' AND l.l_shipmode IN ('AIR', 'TRUCK') AND s.s_phone LIKE '15-%' GROUP BY s.s_name, p.p_brand, l.l_shipmode ORDER BY total_sales DESC, s.s_name, p.p_brand;
SELECT r.r_name AS region_name, n.n_name AS nation_name, AVG(c.c_acctbal) AS avg_customer_balance, COUNT(DISTINCT c.c_custkey) AS number_of_customers, SUM(l.l_quantity) AS total_quantity_ordered, SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_revenue, AVG(l.l_extendedprice * (1 - l.l_discount)) AS avg_order_value FROM customer c JOIN nation n ON c.c_nationkey = n.n_nationkey JOIN region r ON n.n_regionkey = r.r_regionkey JOIN lineitem l ON c.c_custkey = l.l_suppkey JOIN part p ON l.l_partkey = p.p_partkey WHERE l.l_shipdate BETWEEN DATE '2022-01-01' AND DATE '2022-12-31' AND p.p_retailprice > 1500 GROUP BY region_name, nation_name ORDER BY total_revenue DESC;
SELECT r.r_name AS region, c.c_mktsegment AS market_segment, COUNT(DISTINCT o.o_orderkey) AS total_orders, SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_revenue, AVG(l.l_extendedprice * (1 - l.l_discount)) AS avg_revenue_per_order, COUNT(DISTINCT c.c_custkey) AS total_customers, SUM(l.l_extendedprice * (1 - l.l_discount)) / COUNT(DISTINCT c.c_custkey) AS avg_revenue_per_customer FROM region r JOIN nation n ON r.r_regionkey = n.n_regionkey JOIN customer c ON n.n_nationkey = c.c_nationkey JOIN orders o ON c.c_custkey = o.o_custkey JOIN lineitem l ON o.o_orderkey = l.l_orderkey WHERE o.o_orderpriority = '5-LOW' AND l.l_shipmode IN ('TRUCK', 'SHIP') GROUP BY r.r_name, c.c_mktsegment ORDER BY total_revenue DESC, avg_revenue_per_customer DESC;
SELECT n.n_name AS nation, AVG(ps.ps_supplycost) AS avg_supply_cost, SUM(ps.ps_availqty) AS total_available_quantity, COUNT(DISTINCT s.s_suppkey) AS number_of_suppliers, COUNT(DISTINCT p.p_partkey) AS number_of_parts FROM nation n JOIN supplier s ON n.n_nationkey = s.s_nationkey JOIN partsupp ps ON s.s_suppkey = ps.ps_suppkey JOIN part p ON ps.ps_partkey = p.p_partkey GROUP BY n.n_name ORDER BY avg_supply_cost DESC, total_available_quantity DESC;
SELECT c.c_mktsegment, COUNT(DISTINCT o.o_orderkey) AS total_orders, SUM(l.l_extendedprice) AS total_sales, AVG(l.l_quantity) AS average_quantity, AVG(l.l_extendedprice * (1 - l.l_discount)) AS average_discounted_price, SUM(CASE WHEN l.l_returnflag = 'R' THEN 1 ELSE 0 END) AS total_returns FROM customer c JOIN orders o ON c.c_custkey = o.o_custkey JOIN lineitem l ON o.o_orderkey = l.l_orderkey WHERE c.c_mktsegment IN ('BUILDING', 'MACHINERY', 'AUTOMOBILE') AND l.l_shipdate >= DATE '1995-01-01' AND l.l_shipdate < DATE '1996-01-01' GROUP BY c.c_mktsegment ORDER BY total_sales DESC;
SELECT n_name, COUNT(DISTINCT s_suppkey) AS total_suppliers, COUNT(DISTINCT c_custkey) AS total_customers, AVG(s_acctbal) AS average_supplier_acctbal, AVG(c_acctbal) AS average_customer_acctbal, SUM(l_extendedprice * (1 - l_discount)) AS revenue, MAX(o_totalprice) AS max_order_totalprice, MIN(ps_supplycost) AS min_partsupp_supplycost FROM nation JOIN supplier ON s_nationkey = n_nationkey JOIN customer ON c_nationkey = n_nationkey JOIN partsupp ON s_suppkey = ps_suppkey JOIN lineitem ON l_suppkey = ps_suppkey AND l_partkey = ps_partkey JOIN orders ON l_orderkey = o_orderkey WHERE l_shipdate BETWEEN '1995-01-01' AND '1995-12-31' AND o_orderpriority = '5-LOW' AND s_address IN ('98bqrrD5wRGOSB IAv9sT2', 'iC6sb9XOc1FuPrbtTqNRuMsMNay', 'piOimoavqzHBqI0GCxAmXPQvoyCvLhzK2,l9V') AND s_acctbal BETWEEN 1000 AND 6000 AND l_receiptdate IN ('1994-03-05', '1995-12-11', '1996-03-12', '1997-07-02') GROUP BY n_name ORDER BY revenue DESC, average_supplier_acctbal DESC, average_customer_acctbal DESC LIMIT 10;
SELECT r.r_name AS region_name, COUNT(DISTINCT s.s_suppkey) AS number_of_suppliers, SUM(ps.ps_availqty) AS total_available_quantity, AVG(ps.ps_supplycost) AS average_supply_cost, SUM(l.l_extendedprice * (1 - l_discount)) AS total_revenue, AVG(l.l_quantity) AS average_quantity_ordered FROM region r JOIN supplier s ON r.r_regionkey = s.s_nationkey JOIN partsupp ps ON s.s_suppkey = ps.ps_suppkey JOIN lineitem l ON ps.ps_partkey = l.l_partkey AND ps.ps_suppkey = l.l_suppkey GROUP BY r.r_name ORDER BY total_revenue DESC;
SELECT s_name, p_brand, SUM(l_extendedprice) AS total_sales, AVG(l_quantity) AS average_quantity_sold, COUNT(DISTINCT o_orderkey) AS number_of_orders, AVG(o_totalprice) AS average_order_value, MAX(p_retailprice) AS max_retail_price, MIN(s_acctbal) AS min_supplier_account_balance FROM supplier JOIN lineitem ON s_suppkey = l_suppkey JOIN part ON p_partkey = l_partkey JOIN orders ON o_orderkey = l_orderkey WHERE s_phone = '32-923-170-9487' AND o_clerk IN ('Clerk#000000421', 'Clerk#000009610', 'Clerk#000022774') AND p_retailprice IN (1616.71, 1175.26, 1624.71) AND o_orderdate BETWEEN '1995-01-01' AND '1995-12-31' GROUP BY s_name, p_brand ORDER BY total_sales DESC, average_quantity_sold DESC LIMIT 10;
SELECT c.c_name, COUNT(DISTINCT ps.ps_partkey) AS parts_count, SUM(ps.ps_availqty) AS total_available_quantity, AVG(ps.ps_supplycost) AS average_supply_cost, SUM(ps.ps_supplycost * ps.ps_availqty) AS total_value FROM customer c JOIN partsupp ps ON c.c_custkey = ps.ps_suppkey JOIN supplier s ON ps.ps_suppkey = s.s_suppkey WHERE c.c_acctbal > 0 AND ps.ps_supplycost > 500 AND s.s_nationkey = c.c_nationkey GROUP BY c.c_name HAVING COUNT(DISTINCT ps.ps_partkey) > 5 ORDER BY total_value DESC, c.c_name LIMIT 10;
SELECT r_name AS region, COUNT(DISTINCT s_suppkey) AS number_of_suppliers, COUNT(DISTINCT p_partkey) AS number_of_parts, SUM(l_quantity) AS total_quantity, AVG(ps_supplycost) AS average_supply_cost, SUM(l_extendedprice * (1 - l_discount)) AS total_revenue FROM region JOIN supplier ON s_nationkey = r_regionkey JOIN partsupp ON ps_suppkey = s_suppkey JOIN part ON ps_partkey = p_partkey JOIN lineitem ON l_partkey = p_partkey AND l_suppkey = s_suppkey JOIN orders ON l_orderkey = o_orderkey WHERE o_orderstatus = 'F' AND l_shipmode IN ('AIR', 'RAIL', 'TRUCK') AND s_comment LIKE '%packages%' GROUP BY region ORDER BY total_revenue DESC, region;
SELECT r.r_name AS region, n.n_name AS nation, COUNT(DISTINCT s.s_suppkey) AS number_of_suppliers, COUNT(DISTINCT c.c_custkey) AS number_of_customers, SUM(l.l_quantity) AS total_quantity_ordered, AVG(l.l_extendedprice * (1 - l.l_discount)) AS avg_discounted_price, SUM(p.p_retailprice * l.l_quantity) AS total_retail_price, COUNT(DISTINCT o.o_orderkey) AS number_of_orders FROM region r JOIN nation n ON r.r_regionkey = n.n_regionkey JOIN supplier s ON n.n_nationkey = s.s_nationkey JOIN partsupp ps ON s.s_suppkey = ps.ps_suppkey JOIN part p ON ps.ps_partkey = p.p_partkey JOIN lineitem l ON ps.ps_partkey = l.l_partkey AND ps.ps_suppkey = l.l_suppkey JOIN orders o ON l.l_orderkey = o.o_orderkey JOIN customer c ON o.o_custkey = c.c_custkey AND n.n_nationkey = c.c_nationkey GROUP BY region, nation ORDER BY total_quantity_ordered DESC, avg_discounted_price DESC;
SELECT n.n_name AS nation_name, r.r_name AS region_name, COUNT(DISTINCT s.s_suppkey) AS total_suppliers, COUNT(DISTINCT c.c_custkey) AS total_customers, SUM(li.l_extendedprice) AS total_sales, AVG(li.l_quantity) AS average_quantity_sold, SUM(ps.ps_supplycost * li.l_quantity) AS total_supply_cost FROM nation n JOIN region r ON n.n_regionkey = r.r_regionkey JOIN supplier s ON s.s_nationkey = n.n_nationkey JOIN customer c ON c.c_nationkey = n.n_nationkey JOIN orders o ON o.o_custkey = c.c_custkey JOIN lineitem li ON li.l_orderkey = o.o_orderkey JOIN partsupp ps ON ps.ps_partkey = li.l_partkey AND ps.ps_suppkey = li.l_suppkey WHERE c.c_mktsegment = 'AUTOMOBILE' AND li.l_shipdate BETWEEN '2020-01-01' AND '2020-12-31' GROUP BY n.n_name, r.r_name ORDER BY total_sales DESC, nation_name, region_name;
SELECT r.r_name AS region, n.n_name AS nation, COUNT(c.c_custkey) AS num_customers, AVG(c.c_acctbal) AS avg_account_balance, SUM(p.p_retailprice) AS total_retail_price, COUNT(p.p_partkey) AS num_parts FROM region r JOIN nation n ON r.r_regionkey = n.n_regionkey JOIN customer c ON n.n_nationkey = c.c_nationkey JOIN part p ON p.p_size BETWEEN 1 AND 5 WHERE r.r_name IN ('EUROPE', 'AMERICA') AND c.c_mktsegment IN ('AUTOMOBILE', 'BUILDING') AND p.p_type LIKE 'ECONOMY%' AND n.n_comment LIKE '%final%' GROUP BY r.r_name, n.n_name ORDER BY total_retail_price DESC, avg_account_balance DESC, num_customers DESC;
SELECT c.c_mktsegment, o.o_orderpriority, SUM(l.l_extendedprice * (1 - l.l_discount)) AS revenue, AVG(l.l_quantity) AS average_quantity, AVG(l.l_extendedprice) AS average_extendedprice, AVG(l.l_discount) AS average_discount, COUNT(*) AS count_orders FROM customer c JOIN orders o ON c.c_custkey = o.o_custkey JOIN lineitem l ON o.o_orderkey = l.l_orderkey WHERE c.c_acctbal > 4000.00 AND o.o_orderdate >= DATE '2023-01-01' AND o.o_orderdate < DATE '2023-01-01' + INTERVAL '3 months' AND l.l_returnflag = 'N' GROUP BY c.c_mktsegment, o.o_orderpriority ORDER BY revenue DESC, c.c_mktsegment, o.o_orderpriority;
SELECT r.r_name AS region_name, COUNT(DISTINCT s.s_suppkey) AS number_of_suppliers, AVG(s.s_acctbal) AS avg_account_balance, SUM(o.o_totalprice) AS total_sales, COUNT(DISTINCT o.o_orderkey) AS number_of_orders, MAX(o.o_totalprice) AS max_order_value, MIN(o.o_totalprice) AS min_order_value FROM region AS r JOIN supplier AS s ON s.s_nationkey = r.r_regionkey JOIN orders AS o ON o.o_custkey = s.s_suppkey WHERE o.o_orderstatus IN ('F', 'P') AND s.s_address LIKE '1hFY4cxmBsHd zr3j5WoGDbH3bQx%' AND r.r_name IN ('ASIA', 'AMERICA', 'EUROPE', 'AFRICA') AND o.o_clerk IN ('Clerk#000003154', 'Clerk#000009681', 'Clerk#000022126', 'Clerk#000010059') GROUP BY r.r_name ORDER BY total_sales DESC;
SELECT p_brand, AVG(l_extendedprice * (1 - l_discount)) AS avg_sale_price, SUM(l_quantity) AS total_quantity_sold, COUNT(DISTINCT o_custkey) AS customer_count FROM part JOIN lineitem ON part.p_partkey = lineitem.l_partkey JOIN orders ON lineitem.l_orderkey = orders.o_orderkey JOIN customer ON orders.o_custkey = customer.c_custkey WHERE orders.o_orderstatus = 'F' AND lineitem.l_shipdate >= date '2023-01-01' AND lineitem.l_shipdate < date '2023-01-01' + interval '1' YEAR GROUP BY p_brand ORDER BY avg_sale_price DESC, total_quantity_sold DESC;
SELECT r_name AS region, n_name AS nation, COUNT(DISTINCT s_suppkey) AS total_suppliers, COUNT(DISTINCT c_custkey) AS total_customers, SUM(l_extendedprice * (1 - l_discount)) AS total_sales, AVG(l_quantity) AS average_quantity, AVG(s_acctbal) AS average_supplier_account_balance, AVG(c_acctbal) AS average_customer_account_balance FROM region JOIN nation ON n_regionkey = r_regionkey JOIN supplier ON s_nationkey = n_nationkey JOIN customer ON c_nationkey = n_nationkey JOIN orders ON o_custkey = c_custkey JOIN lineitem ON l_orderkey = o_orderkey WHERE r_name IN ('EUROPE', 'ASIA') AND o_orderdate BETWEEN date '2022-01-01' AND date '2022-12-31' AND l_shipdate > o_orderdate GROUP BY r_name, n_name ORDER BY total_sales DESC, region, nation;
SELECT r.r_name AS region, COUNT(DISTINCT s.s_suppkey) AS num_suppliers, COUNT(DISTINCT c.c_custkey) AS num_customers, AVG(s.s_acctbal) AS avg_supplier_acctbal, AVG(c.c_acctbal) AS avg_customer_acctbal, SUM(l.l_extendedprice * (1 - l.l_discount)) AS revenue, AVG(l.l_quantity) AS avg_lineitem_quantity FROM region r JOIN supplier s ON r.r_regionkey = s.s_nationkey JOIN customer c ON r.r_regionkey = c.c_nationkey JOIN orders o ON c.c_custkey = o.o_custkey JOIN lineitem l ON o.o_orderkey = l.l_orderkey WHERE r.r_regionkey = 1 AND l.l_shipdate BETWEEN date '1995-01-01' AND date '1995-12-31' GROUP BY r.r_name ORDER BY revenue DESC;
SELECT c.c_mktsegment AS market_segment, COUNT(DISTINCT c.c_custkey) AS number_of_customers, SUM(l.l_quantity) AS total_quantity_sold, AVG(l.l_discount) AS average_discount, SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_sales_after_discount FROM customer AS c JOIN lineitem AS l ON c.c_custkey = l.l_suppkey JOIN part AS p ON l.l_partkey = p.p_partkey WHERE p.p_brand = 'Brand#15' GROUP BY c.c_mktsegment ORDER BY total_sales_after_discount DESC;
SELECT n.n_name AS nation, c.c_mktsegment AS market_segment, AVG(c.c_acctbal) AS avg_acctbal FROM customer c JOIN nation n ON c.c_nationkey = n.n_nationkey JOIN region r ON n.n_regionkey = r.r_regionkey WHERE c.c_acctbal > 0 AND r.r_name = 'EUROPE' GROUP BY nation, market_segment ORDER BY avg_acctbal DESC;
SELECT r.r_name AS region_name, COUNT(DISTINCT c.c_custkey) AS number_of_customers, SUM(o.o_totalprice) AS total_sales, AVG(l.l_quantity) AS average_quantity_sold, (SUM(l.l_extendedprice * (1 - l.l_discount)) / SUM(l.l_extendedprice)) AS average_discount_effect FROM customer c JOIN orders o ON c.c_custkey = o.o_custkey JOIN lineitem l ON o.o_orderkey = l.l_orderkey JOIN supplier s ON l.l_suppkey = s.s_suppkey JOIN region r ON c.c_nationkey = s.s_nationkey WHERE c.c_acctbal > 0 AND o.o_orderdate BETWEEN '2020-01-01' AND '2020-12-31' AND r.r_regionkey IN (1, 2, 3) GROUP BY r.r_name ORDER BY total_sales DESC;
SELECT s.s_name, SUM(ps.ps_supplycost * ps.ps_availqty) AS total_supply_cost, AVG(ps.ps_supplycost) AS average_supply_cost, COUNT(DISTINCT p.p_partkey) AS number_of_parts_supplied, COUNT(DISTINCT o.o_orderkey) AS number_of_orders, SUM(o.o_totalprice) AS total_order_value FROM supplier s JOIN partsupp ps ON s.s_suppkey = ps.ps_suppkey JOIN part p ON ps.ps_partkey = p.p_partkey LEFT JOIN orders o ON s.s_suppkey = o.o_custkey WHERE ps.ps_availqty > 9000 AND (ps.ps_partkey IN (506, 672)) GROUP BY s.s_suppkey, s.s_name ORDER BY total_supply_cost DESC, number_of_orders DESC;
SELECT r.r_name AS region_name, n.n_name AS nation_name, COUNT(DISTINCT c.c_custkey) AS total_customers, COUNT(DISTINCT o.o_orderkey) AS total_orders, ROUND(AVG(c.c_acctbal), 2) AS avg_customer_acctbal, SUM(l.l_extendedprice * (1 - l.l_discount)) AS revenue, SUM(l.l_quantity) AS total_quantity_sold, AVG(l.l_extendedprice * (1 - l.l_discount)) AS avg_order_value FROM region r JOIN nation n ON r.r_regionkey = n.n_regionkey JOIN customer c ON n.n_nationkey = c.c_nationkey JOIN orders o ON c.c_custkey = o.o_custkey JOIN lineitem l ON o.o_orderkey = l.l_orderkey WHERE r.r_name IN ('MIDDLE EAST', 'ASIA', 'EUROPE', 'AMERICA', 'AFRICA') AND l.l_shipdate BETWEEN '1993-07-01' AND '1994-07-01' AND l.l_receiptdate > l.l_commitdate AND o.o_orderstatus = 'F' GROUP BY region_name, nation_name ORDER BY revenue DESC, region_name, nation_name;
SELECT r.r_name AS region_name, COUNT(DISTINCT n.n_nationkey) AS number_of_nations, COUNT(DISTINCT s.s_suppkey) AS number_of_suppliers, COUNT(DISTINCT c.c_custkey) AS number_of_customers, COUNT(DISTINCT o.o_orderkey) AS number_of_orders, SUM(o.o_totalprice) AS total_sales, AVG(ps.ps_supplycost) AS average_supply_cost, SUM(ps.ps_availqty) AS total_available_quantity FROM region r JOIN nation n ON r.r_regionkey = n.n_regionkey JOIN supplier s ON n.n_nationkey = s.s_nationkey JOIN customer c ON n.n_nationkey = c.c_nationkey JOIN orders o ON c.c_custkey = o.o_custkey JOIN partsupp ps ON s.s_suppkey = ps.ps_suppkey WHERE r.r_regionkey IN ('3', '0', '1', '4') AND o.o_shippriority = '0' AND c.c_phone IN ('10-953-280-1391', '32-698-608-5791', '31-777-277-3266', '14-280-698-7549', '20-256-425-2001', '33-483-676-9755') AND c.c_nationkey IN ('17', '3') AND ps.ps_availqty = '4238' GROUP BY r.r_name ORDER BY total_sales DESC;
SELECT r_name AS region, n_name AS nation, COUNT(DISTINCT s_suppkey) AS number_of_suppliers, COUNT(DISTINCT c_custkey) AS number_of_customers, SUM(l_extendedprice) AS total_sales, AVG(l_extendedprice * (1 - l_discount)) AS avg_undiscounted_sales, AVG(l_quantity) AS avg_quantity_sold, COUNT(DISTINCT o_orderkey) AS number_of_orders FROM region JOIN nation ON n_regionkey = r_regionkey JOIN supplier ON s_nationkey = n_nationkey JOIN partsupp ON ps_suppkey = s_suppkey JOIN lineitem ON l_suppkey = s_suppkey AND l_partkey = ps_partkey JOIN orders ON o_orderkey = l_orderkey JOIN customer ON c_custkey = o_custkey AND c_nationkey = n_nationkey GROUP BY region, nation ORDER BY total_sales DESC, region, nation;
SELECT r.r_name AS region, n.n_name AS nation, COUNT(DISTINCT s.s_suppkey) AS number_of_suppliers, COUNT(DISTINCT c.c_custkey) AS number_of_customers, SUM(o.o_totalprice) AS total_order_value, AVG(c.c_acctbal) AS average_customer_balance FROM region r JOIN nation n ON r.r_regionkey = n.n_regionkey JOIN supplier s ON n.n_nationkey = s.s_nationkey JOIN customer c ON n.n_nationkey = c.c_nationkey JOIN orders o ON c.c_custkey = o.o_custkey WHERE r.r_regionkey IN (1, 3) AND c.c_nationkey IN (1, 15, 24) AND c.c_address LIKE '6Ne5LIx2IIB7uNeUzo3DCsTBgz vMig3Op38vmIG' AND r.r_comment LIKE 'ges. thinly even pinto beans ca%' GROUP BY r.r_name, n.n_name ORDER BY total_order_value DESC, average_customer_balance DESC;
SELECT r_name AS region, p_type, COUNT(DISTINCT o_orderkey) AS total_orders, SUM(o_totalprice) AS total_revenue, AVG(ps_supplycost) AS average_supply_cost, SUM(ps_availqty) AS total_available_quantity FROM region JOIN orders ON region.r_regionkey = (orders.o_orderkey % 5) JOIN partsupp ON orders.o_orderkey = (partsupp.ps_suppkey % 5) JOIN part ON partsupp.ps_partkey = part.p_partkey WHERE p_type IN ('PROMO ANODIZED STEEL', 'MEDIUM BURNISHED COPPER', 'ECONOMY POLISHED COPPER', 'SMALL BURNISHED TIN', 'LARGE PLATED STEEL', 'ECONOMY BURNISHED TIN') AND o_orderdate BETWEEN DATE '2022-01-01' AND DATE '2022-12-31' GROUP BY region, p_type ORDER BY total_revenue DESC;
SELECT c.c_mktsegment, AVG(c.c_acctbal) AS avg_customer_acctbal, SUM(o.o_totalprice) AS sum_total_order_price, COUNT(DISTINCT c.c_custkey) AS number_of_customers, COUNT(o.o_orderkey) AS number_of_orders FROM customer AS c JOIN orders AS o ON c.c_custkey = o.o_custkey JOIN nation AS n ON c.c_nationkey = n.n_nationkey JOIN region AS r ON n.n_regionkey = r.r_regionkey WHERE r.r_name = 'EUROPE' GROUP BY c.c_mktsegment ORDER BY sum_total_order_price DESC, avg_customer_acctbal DESC;
SELECT n.n_name AS nation, p.p_type AS part_type, AVG(ps.ps_supplycost) AS avg_supply_cost, SUM(l.l_quantity) AS total_quantity, SUM(l.l_extendedprice * (1 - l_discount)) AS total_revenue, COUNT(DISTINCT s.s_suppkey) AS number_of_suppliers FROM nation n JOIN supplier s ON s.s_nationkey = n.n_nationkey JOIN partsupp ps ON s.s_suppkey = ps.ps_suppkey JOIN part p ON ps.ps_partkey = p.p_partkey JOIN lineitem l ON ps.ps_partkey = l.l_partkey AND ps.ps_suppkey = l.l_suppkey WHERE s.s_name IN ('Supplier#000022340', 'Supplier#000018268', 'Supplier#000019413') AND l.l_shipdate BETWEEN DATE '2022-01-01' AND DATE '2022-12-31' GROUP BY nation, part_type ORDER BY total_revenue DESC, avg_supply_cost ASC;
SELECT r.r_name AS region_name, n.n_name AS nation_name, AVG(c.c_acctbal) AS avg_customer_acctbal, COUNT(DISTINCT o.o_orderkey) AS total_orders, AVG(l.l_quantity) AS avg_lineitem_quantity, AVG(l.l_extendedprice) AS avg_lineitem_extendedprice FROM region r JOIN nation n ON r.r_regionkey = n.n_regionkey JOIN customer c ON n.n_nationkey = c.c_nationkey JOIN orders o ON c.c_custkey = o.o_custkey JOIN lineitem l ON o.o_orderkey = l.l_orderkey WHERE EXTRACT(YEAR FROM l.l_shipdate) = 2022 GROUP BY r.r_name, n.n_name ORDER BY r.r_name, n.n_name;
SELECT r_name AS region, n_name AS nation, COUNT(DISTINCT c_custkey) AS customer_count, SUM(o_totalprice) AS total_sales, AVG(s_acctbal) AS avg_supplier_balance, AVG(c_acctbal) AS avg_customer_balance FROM region JOIN nation ON r_regionkey = n_regionkey JOIN customer ON n_nationkey = c_nationkey JOIN orders ON c_custkey = o_custkey JOIN supplier ON n_nationkey = s_nationkey WHERE o_orderdate BETWEEN DATE '2022-01-01' AND DATE '2022-12-31' AND c_mktsegment = 'BUILDING' GROUP BY region, nation ORDER BY total_sales DESC, avg_supplier_balance DESC;
SELECT n.n_name AS nation, COUNT(DISTINCT s.s_suppkey) AS number_of_suppliers, SUM(l.l_quantity) AS total_quantity, AVG(l.l_extendedprice * (1 - l_discount)) AS avg_revenue, SUM((l.l_extendedprice * (1 - l_discount)) * (1 + l_tax)) AS total_taxed_revenue FROM nation n JOIN supplier s ON n.n_nationkey = s.s_nationkey JOIN lineitem l ON s.s_suppkey = l.l_suppkey WHERE l.l_receiptdate BETWEEN '1994-01-01' AND '1995-12-31' AND l.l_shipinstruct IN ('COLLECT COD', 'DELIVER IN PERSON') AND s.s_acctbal > 0 GROUP BY nation ORDER BY total_taxed_revenue DESC, avg_revenue DESC LIMIT 10;
SELECT r.r_name AS region, n.n_name AS nation, COUNT(DISTINCT c.c_custkey) AS number_of_customers, AVG(c.c_acctbal) AS average_account_balance, SUM(l.l_quantity) AS total_quantity_ordered, SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_revenue, AVG(l.l_extendedprice * (1 - l.l_discount)) AS average_order_value FROM customer c JOIN nation n ON c.c_nationkey = n.n_nationkey JOIN region r ON n.n_regionkey = r.r_regionkey JOIN lineitem l ON c.c_custkey = l.l_suppkey WHERE l.l_shipdate >= DATE '2023-01-01' AND l.l_shipdate < DATE '2024-01-01' AND l.l_quantity >= 23 AND l.l_quantity <= 25 AND c.c_acctbal BETWEEN 4000 AND 10000 GROUP BY r.r_name, n.n_name ORDER BY total_revenue DESC;
SELECT r_name AS region, n_name AS nation, COUNT(DISTINCT s_suppkey) AS number_of_suppliers, COUNT(DISTINCT c_custkey) AS number_of_customers, SUM(l_extendedprice * (1 - l_discount)) AS total_sales, AVG(l_quantity) AS average_quantity_sold, AVG(l_extendedprice) AS average_price, AVG(l_discount) AS average_discount FROM region JOIN nation ON region.r_regionkey = nation.n_regionkey JOIN supplier ON nation.n_nationkey = supplier.s_nationkey JOIN customer ON nation.n_nationkey = customer.c_nationkey JOIN orders ON customer.c_custkey = orders.o_custkey JOIN lineitem ON orders.o_orderkey = lineitem.l_orderkey JOIN part ON lineitem.l_partkey = part.p_partkey JOIN partsupp ON part.p_partkey = partsupp.ps_partkey AND supplier.s_suppkey = partsupp.ps_suppkey WHERE orders.o_orderstatus = 'O' AND lineitem.l_discount BETWEEN 0.05 AND 0.07 AND lineitem.l_tax IN (0.02, 0.04, 0.07) AND supplier.s_nationkey IN (4, 8, 17) AND partsupp.ps_supplycost BETWEEN 143.30 AND 287.80 GROUP BY region, nation ORDER BY total_sales DESC;
SELECT r.r_name AS region, n.n_name AS nation, COUNT(DISTINCT s.s_suppkey) AS number_of_suppliers, COUNT(DISTINCT c.c_custkey) AS number_of_customers, SUM(o.o_totalprice) AS total_order_value, AVG(c.c_acctbal) AS average_customer_balance, AVG(s.s_acctbal) AS average_supplier_balance, MAX(ps.ps_availqty) AS max_parts_available FROM region r JOIN nation n ON r.r_regionkey = n.n_regionkey JOIN supplier s ON n.n_nationkey = s.s_nationkey JOIN customer c ON n.n_nationkey = c.c_nationkey JOIN orders o ON c.c_custkey = o.o_custkey JOIN partsupp ps ON s.s_suppkey = ps.ps_suppkey WHERE r.r_regionkey IN (1, 2, 4) AND n.n_name IN ('ARGENTINA', 'ROMANIA', 'IRAQ') AND o.o_shippriority = 0 AND c.c_comment LIKE '%ckages according to the quickl%' GROUP BY region, nation ORDER BY total_order_value DESC, average_customer_balance DESC;
SELECT r.r_name, p.p_type, COUNT(DISTINCT l.l_orderkey) AS number_of_orders, SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_revenue, AVG(l.l_quantity) AS average_quantity, AVG(l.l_extendedprice) AS average_price, AVG(l.l_discount) AS average_discount FROM region r JOIN partsupp ps ON ps.ps_suppkey = r.r_regionkey JOIN part p ON ps.ps_partkey = p.p_partkey JOIN lineitem l ON l.l_partkey = p.p_partkey AND l.l_suppkey = ps.ps_suppkey WHERE r.r_regionkey IN (0, 3, 4) AND l.l_shipdate BETWEEN '1995-01-01' AND '1995-12-31' GROUP BY r.r_name, p.p_type ORDER BY total_revenue DESC, r.r_name, p.p_type;
SELECT c_mktsegment, p_brand, EXTRACT(YEAR FROM o_orderdate) AS order_year, COUNT(DISTINCT o_orderkey) AS number_of_orders, SUM(o_totalprice) AS total_revenue, AVG(p_retailprice) AS average_part_price, SUM(ps_availqty) AS total_available_quantity, AVG(ps_supplycost) AS average_supply_cost FROM customer JOIN orders ON c_custkey = o_custkey JOIN partsupp ON c_custkey = ps_suppkey JOIN part ON ps_partkey = p_partkey WHERE p_retailprice IN (1108.20, 993.08, 1179.27, 1470.56) AND p_comment LIKE '%ise. ca%' AND o_orderstatus = 'F' GROUP BY c_mktsegment, p_brand, order_year ORDER BY c_mktsegment, p_brand, order_year;
SELECT r.r_name AS region_name, n.n_name AS nation_name, COUNT(s.s_suppkey) AS number_of_suppliers, AVG(s.s_acctbal) AS average_account_balance, SUM(s.s_acctbal) AS total_account_balance FROM region r JOIN nation n ON r.r_regionkey = n.n_regionkey JOIN supplier s ON n.n_nationkey = s.s_nationkey GROUP BY r.r_name, n.n_name ORDER BY r.r_name, n.n_name;
SELECT r.r_name AS region, COUNT(DISTINCT c.c_custkey) AS number_of_customers, AVG(c.c_acctbal) AS average_account_balance, SUM(o.o_totalprice) AS total_order_value, COUNT(DISTINCT o.o_orderkey) AS number_of_orders, SUM(l.l_quantity) AS total_parts_ordered, AVG(l.l_extendedprice * (1 - l_discount)) AS average_discounted_price FROM region r JOIN customer c ON c.c_nationkey = r.r_regionkey JOIN orders o ON o.o_custkey = c.c_custkey JOIN lineitem l ON l.l_orderkey = o.o_orderkey WHERE c.c_acctbal > 0 AND o.o_totalprice > 100000 AND l.l_shipdate BETWEEN '1995-01-01' AND '1995-12-31' GROUP BY region ORDER BY total_order_value DESC, average_account_balance DESC;
SELECT r.r_name AS region, n.n_name AS nation, COUNT(DISTINCT s.s_suppkey) AS number_of_suppliers, COUNT(DISTINCT c.c_custkey) AS number_of_customers, AVG(s.s_acctbal) AS average_supplier_account_balance, AVG(c.c_acctbal) AS average_customer_account_balance, SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_sales_value, AVG(l.l_quantity) AS average_quantity_sold FROM region r JOIN nation n ON r.r_regionkey = n.n_regionkey JOIN supplier s ON n.n_nationkey = s.s_nationkey JOIN customer c ON n.n_nationkey = c.c_nationkey JOIN orders o ON c.c_custkey = o.o_custkey JOIN lineitem l ON o.o_orderkey = l.l_orderkey WHERE r.r_regionkey IN (1, 4, 0, 2, 3) AND c.c_mktsegment IN ('MACHINERY', 'BUILDING', 'AUTOMOBILE', 'FURNITURE') AND l.l_shipdate BETWEEN '2020-01-01' AND '2020-12-31' GROUP BY r.r_name, n.n_name ORDER BY total_sales_value DESC, region, nation;
SELECT r.r_name AS region_name, COUNT(DISTINCT s.s_suppkey) AS number_of_suppliers, AVG(s.s_acctbal) AS average_account_balance, COUNT(DISTINCT o.o_orderkey) AS number_of_orders, SUM(o.o_totalprice) AS total_revenue, AVG(o.o_totalprice) AS average_order_value FROM region r JOIN supplier s ON s.s_nationkey = r.r_regionkey JOIN orders o ON o.o_custkey = s.s_suppkey WHERE r.r_regionkey IN (0, 1) AND s.s_name IN ('Supplier#000017873', 'Supplier#000020897', 'Supplier#000017819', 'Supplier#000019623', 'Supplier#000017534') AND s.s_nationkey IN (21, 12, 2, 8) AND o.o_orderdate = '1993-03-19' AND o.o_shippriority = 0 AND r.r_comment IN ('ly final courts cajole furiously final excuse', 'ges. thinly even pinto beans ca', 'hs use ironic, even requests. s') GROUP BY r.r_name ORDER BY total_revenue DESC;
SELECT r.r_name AS region, COUNT(DISTINCT s.s_suppkey) AS supplier_count, SUM(li.l_extendedprice * (1 - li.l_discount)) AS total_sales, AVG(c.c_acctbal) AS avg_customer_acctbal, COUNT(DISTINCT o.o_orderkey) AS order_count FROM region r JOIN nation n ON r.r_regionkey = n.n_regionkey JOIN supplier s ON n.n_nationkey = s.s_nationkey JOIN partsupp ps ON s.s_suppkey = ps.ps_suppkey JOIN part p ON ps.ps_partkey = p.p_partkey JOIN lineitem li ON p.p_partkey = li.l_partkey AND ps.ps_suppkey = li.l_suppkey JOIN orders o ON li.l_orderkey = o.o_orderkey AND o.o_orderdate BETWEEN '1995-01-01' AND '1995-12-31' JOIN customer c ON o.o_custkey = c.c_custkey AND c.c_mktsegment = 'AUTOMOBILE' GROUP BY r.r_name ORDER BY total_sales DESC;
SELECT reg.r_name AS region_name, nat.n_name AS nation_name, COUNT(DISTINCT cust.c_custkey) AS num_customers, COUNT(DISTINCT supp.s_suppkey) AS num_suppliers, COUNT(DISTINCT ord.o_orderkey) AS num_orders, SUM(li.l_extendedprice * (1 - li.l_discount)) AS total_revenue, AVG(li.l_quantity) AS avg_quantity, AVG(supp.s_acctbal) AS avg_supplier_acctbal, SUM(CASE WHEN li.l_returnflag = 'R' THEN li.l_extendedprice * (1 - li.l_discount) ELSE 0 END) AS total_returned_revenue FROM region AS reg JOIN nation AS nat ON reg.r_regionkey = nat.n_regionkey JOIN customer AS cust ON nat.n_nationkey = cust.c_nationkey JOIN orders AS ord ON cust.c_custkey = ord.o_custkey JOIN lineitem AS li ON ord.o_orderkey = li.l_orderkey JOIN supplier AS supp ON nat.n_nationkey = supp.s_nationkey JOIN part AS p ON li.l_partkey = p.p_partkey WHERE reg.r_regionkey IN (2, 4, 0) AND p.p_partkey IN (712, 4744, 1322, 2404) AND li.l_linestatus IN ('F', 'O') AND ord.o_orderdate BETWEEN date '1995-01-01' AND date '1995-12-31' GROUP BY reg.r_name, nat.n_name ORDER BY total_revenue DESC;
SELECT r_name AS region, COUNT(DISTINCT s_suppkey) AS total_suppliers, COUNT(DISTINCT c_custkey) AS total_customers, SUM(l_extendedprice) AS total_sales, AVG(l_quantity) AS average_quantity_sold, SUM(l_extendedprice * (1 - l_discount)) AS revenue_after_discount FROM region JOIN supplier ON region.r_regionkey = supplier.s_nationkey JOIN partsupp ON supplier.s_suppkey = partsupp.ps_suppkey JOIN lineitem ON partsupp.ps_partkey = lineitem.l_partkey AND partsupp.ps_suppkey = lineitem.l_suppkey JOIN part ON lineitem.l_partkey = part.p_partkey JOIN orders ON lineitem.l_orderkey = orders.o_orderkey JOIN customer ON orders.o_custkey = customer.c_custkey WHERE customer.c_acctbal > 5000 AND part.p_retailprice > 1000 AND lineitem.l_shipdate BETWEEN '1995-01-01' AND '1996-12-31' GROUP BY region.r_name ORDER BY total_sales DESC LIMIT 1;
SELECT r.r_name AS region_name, EXTRACT(YEAR FROM o.o_orderdate) AS order_year, COUNT(DISTINCT c.c_custkey) AS number_of_customers, SUM(l.l_quantity) AS total_quantity_sold, AVG(l.l_extendedprice) AS average_price, SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_revenue_after_discount, AVG((l.l_extendedprice * (1 - l.l_discount)) / l.l_quantity) AS average_price_per_unit FROM region r JOIN customer c ON c.c_nationkey = r.r_regionkey JOIN orders o ON o.o_custkey = c.c_custkey JOIN lineitem l ON l.l_orderkey = o.o_orderkey WHERE r.r_name IN ('AMERICA', 'EUROPE') AND o.o_orderdate BETWEEN '1995-01-01' AND '1996-12-31' AND c.c_mktsegment = 'AUTOMOBILE' GROUP BY region_name, order_year ORDER BY region_name, order_year;
SELECT r.r_name AS region, COUNT(DISTINCT c.c_custkey) AS number_of_customers, AVG(c.c_acctbal) AS average_account_balance, SUM(ps.ps_availqty) AS total_available_quantity, AVG(ps.ps_supplycost) AS average_supply_cost FROM region r JOIN customer c ON r.r_regionkey = c.c_nationkey JOIN partsupp ps ON c.c_custkey = ps.ps_suppkey WHERE c.c_mktsegment = 'BUILDING' AND ps.ps_supplycost BETWEEN 200 AND 600 GROUP BY r.r_name ORDER BY average_account_balance DESC, total_available_quantity DESC;
SELECT r.r_name AS region_name, c.c_mktsegment AS market_segment, AVG(c.c_acctbal) AS avg_account_balance, COUNT(c.c_custkey) AS customer_count, SUM(c.c_acctbal) AS total_account_balance FROM customer c JOIN nation n ON c.c_nationkey = n.n_nationkey JOIN region r ON n.n_regionkey = r.r_regionkey GROUP BY r.r_name, c.c_mktsegment ORDER BY region_name, market_segment;
SELECT n.n_name AS nation, c.c_mktsegment AS market_segment, AVG(c.c_acctbal) AS avg_customer_acctbal, SUM(o.o_totalprice) AS total_order_value, COUNT(DISTINCT c.c_custkey) AS num_customers, COUNT(DISTINCT o.o_orderkey) AS num_orders FROM customer c JOIN nation n ON c.c_nationkey = n.n_nationkey JOIN orders o ON c.c_custkey = o.o_custkey GROUP BY n.n_name, c.c_mktsegment ORDER BY n.n_name, c.c_mktsegment, avg_customer_acctbal DESC, total_order_value DESC;
SELECT n.n_name AS nation_name, COUNT(s.s_suppkey) AS total_suppliers, AVG(s.s_acctbal) AS avg_account_balance, SUM(ps.ps_availqty) AS total_parts_quantity, AVG(ps.ps_supplycost) AS avg_supply_cost FROM nation n JOIN region r ON n.n_regionkey = r.r_regionkey JOIN supplier s ON n.n_nationkey = s.s_nationkey JOIN partsupp ps ON s.s_suppkey = ps.ps_suppkey WHERE r.r_name = 'EUROPE' GROUP BY n.n_name ORDER BY avg_account_balance DESC, total_suppliers DESC;
SELECT n.n_name AS nation, COUNT(s.s_suppkey) AS number_of_suppliers, SUM(ps.ps_availqty) AS total_available_quantity, AVG(ps.ps_supplycost) AS average_supply_cost, SUM(s.s_acctbal) AS total_account_balance FROM nation AS n INNER JOIN supplier AS s ON n.n_nationkey = s.s_nationkey INNER JOIN partsupp AS ps ON s.s_suppkey = ps.ps_suppkey GROUP BY n.n_name ORDER BY total_available_quantity DESC, average_supply_cost ASC;
SELECT r.r_name AS region_name, COUNT(DISTINCT p.p_partkey) AS number_of_parts, AVG(p.p_retailprice) AS average_retail_price, SUM(ps.ps_availqty) AS total_available_quantity, SUM(ps.ps_supplycost) AS total_supply_cost, AVG(ps.ps_supplycost) AS average_supply_cost FROM region r JOIN partsupp ps ON ps.ps_partkey = ps.ps_partkey JOIN part p ON p.p_partkey = ps.ps_partkey GROUP BY r.r_name ORDER BY total_supply_cost DESC;
SELECT r.r_name AS region_name, n.n_name AS nation_name, COUNT(s.s_suppkey) AS number_of_suppliers, SUM(p.ps_availqty) AS total_available_quantity, AVG(p.ps_supplycost) AS average_supply_cost, SUM(p.ps_availqty * p.ps_supplycost) AS total_value FROM region r JOIN nation n ON r.r_regionkey = n.n_regionkey JOIN supplier s ON n.n_nationkey = s.s_nationkey JOIN partsupp p ON s.s_suppkey = p.ps_suppkey GROUP BY r.r_name, n.n_name ORDER BY r.r_name, n.n_name;
SELECT r.r_name AS region, c.c_mktsegment AS market_segment, COUNT(DISTINCT c.c_custkey) AS number_of_customers, AVG(c.c_acctbal) AS average_account_balance, SUM(ps.ps_availqty) AS total_available_quantity, AVG(ps.ps_supplycost) AS average_supply_cost FROM customer c JOIN nation n ON c.c_nationkey = n.n_nationkey JOIN region r ON n.n_regionkey = r.r_regionkey JOIN partsupp ps ON ps.ps_suppkey = c.c_custkey WHERE c.c_acctbal > 7000 AND r.r_name IN ('ASIA', 'MIDDLE EAST', 'AMERICA') AND c.c_mktsegment IN ('HOUSEHOLD', 'AUTOMOBILE', 'BUILDING', 'MACHINERY', 'FURNITURE') AND ps.ps_supplycost < (SELECT AVG(ps_supplycost) FROM partsupp) GROUP BY region, market_segment ORDER BY region, market_segment;
SELECT r.r_name AS region_name, COUNT(DISTINCT o.o_orderkey) AS total_orders, SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_sales, AVG(l.l_discount) AS average_discount FROM region r JOIN nation n ON r.r_regionkey = n.n_regionkey JOIN orders o ON o.o_custkey = n.n_nationkey JOIN lineitem l ON o.o_orderkey = l.l_orderkey JOIN part p ON l.l_partkey = p.p_partkey WHERE p.p_retailprice > 1300.00 AND EXTRACT(YEAR FROM o.o_orderdate) = 2023 GROUP BY r.r_name ORDER BY total_sales DESC;
SELECT c.c_mktsegment, COUNT(DISTINCT o.o_orderkey) AS number_of_orders, SUM(l.l_quantity) AS total_quantity, AVG(o.o_totalprice) AS average_order_total, SUM(l.l_extendedprice * (1 - l_discount)) AS total_revenue FROM customer c JOIN orders o ON c.c_custkey = o.o_custkey JOIN lineitem l ON o.o_orderkey = l.l_orderkey WHERE o.o_orderdate >= DATE '2022-01-01' AND o.o_orderdate < DATE '2022-07-01' GROUP BY c.c_mktsegment ORDER BY total_revenue DESC;
SELECT r_name AS region, n_name AS nation, AVG(s_acctbal) AS average_supplier_balance, SUM(ps_availqty) AS total_parts_available, COUNT(DISTINCT s_suppkey) AS number_of_suppliers, COUNT(DISTINCT p_partkey) AS number_of_parts, ROUND(SUM(o_totalprice), 2) AS total_order_value FROM region JOIN nation ON r_regionkey = n_regionkey JOIN supplier ON n_nationkey = s_nationkey JOIN partsupp ON s_suppkey = ps_suppkey JOIN part ON ps_partkey = p_partkey JOIN orders ON s_nationkey = o_custkey WHERE r_name IN ('AMERICA', 'EUROPE') AND n_name IN ('IRAQ', 'JORDAN', 'BRAZIL') AND o_orderdate BETWEEN DATE '2020-01-01' AND DATE '2020-12-31' GROUP BY region, nation ORDER BY total_order_value DESC, region, nation;
SELECT r.r_name AS region_name, COUNT(DISTINCT s.s_suppkey) AS number_of_suppliers, COUNT(DISTINCT p.p_partkey) AS number_of_parts, AVG(ps.ps_supplycost) AS average_supply_cost, SUM(ps.ps_availqty) AS total_available_quantity, mps.most_common_size FROM region r JOIN nation n ON r.r_regionkey = n.n_nationkey JOIN supplier s ON s.s_nationkey = n.n_nationkey JOIN partsupp ps ON s.s_suppkey = ps.ps_suppkey JOIN part p ON ps.ps_partkey = p.p_partkey LEFT JOIN ( SELECT ps_inner.ps_suppkey, p_inner.p_size AS most_common_size, ROW_NUMBER() OVER(PARTITION BY ps_inner.ps_suppkey ORDER BY COUNT(*) DESC) AS rn FROM partsupp ps_inner JOIN part p_inner ON ps_inner.ps_partkey = p_inner.p_partkey GROUP BY ps_inner.ps_suppkey, p_inner.p_size ) mps ON s.s_suppkey = mps.ps_suppkey AND mps.rn = 1 GROUP BY r.r_name, mps.most_common_size ORDER BY average_supply_cost DESC, total_available_quantity DESC;
SELECT n.n_name AS nation, COUNT(DISTINCT ps.ps_partkey) AS unique_parts_supplied, SUM(ps.ps_availqty) AS total_quantity_supplied, AVG(ps.ps_supplycost) AS average_supply_cost FROM nation n JOIN supplier s ON n.n_nationkey = s.s_nationkey JOIN partsupp ps ON s.s_suppkey = ps.ps_suppkey JOIN customer c ON n.n_nationkey = c.c_nationkey JOIN orders o ON c.c_custkey = o.o_custkey JOIN lineitem l ON o.o_orderkey = l.l_orderkey AND ps.ps_partkey = l.l_partkey AND ps.ps_suppkey = l.l_suppkey WHERE c.c_mktsegment = 'AUTOMOBILE' GROUP BY n.n_name ORDER BY total_quantity_supplied DESC, average_supply_cost ASC;
SELECT r.r_name AS Region, COUNT(DISTINCT s.s_suppkey) AS Total_Suppliers, AVG(ps.ps_supplycost) AS Average_Supply_Cost, SUM(ps.ps_availqty) AS Total_Available_Quantity, COUNT(DISTINCT o.o_orderkey) AS Total_Orders, AVG(o.o_totalprice) AS Average_Order_Total, SUM(CASE WHEN o.o_orderstatus = 'F' THEN 1 ELSE 0 END) AS Fulfilled_Orders_Count, SUM(CASE WHEN o.o_orderstatus = 'O' THEN o.o_totalprice ELSE 0 END) AS Open_Orders_Total_Value, MAX(s.s_acctbal) AS Max_Supplier_Account_Balance FROM region r LEFT JOIN supplier s ON r.r_regionkey = s.s_nationkey LEFT JOIN partsupp ps ON s.s_suppkey = ps.ps_suppkey LEFT JOIN orders o ON o.o_orderdate >= '2022-01-01' WHERE r.r_regionkey IN (1, 4) AND s.s_phone IN ('26-898-447-7420', '28-980-733-2696', '32-643-563-7052', '23-876-118-1331') AND o.o_orderstatus IN ('F', 'O') GROUP BY r.r_name ORDER BY Total_Suppliers DESC, Average_Supply_Cost ASC;
SELECT r.r_name AS region_name, COUNT(DISTINCT s.s_suppkey) AS number_of_suppliers, AVG(s.s_acctbal) AS average_account_balance, SUM(o.o_totalprice) AS total_sales, COUNT(DISTINCT o.o_orderkey) AS number_of_orders FROM region r JOIN supplier s ON s.s_nationkey = r.r_regionkey JOIN orders o ON o.o_custkey = s.s_suppkey WHERE r.r_name = 'ASIA' AND o.o_orderdate BETWEEN '1995-01-01' AND '1996-12-31' AND o.o_orderstatus = 'F' GROUP BY r.r_name ORDER BY total_sales DESC;
SELECT r.r_name AS region, COUNT(DISTINCT s.s_suppkey) AS number_of_suppliers, AVG(s.s_acctbal) AS average_account_balance, SUM(p.ps_availqty) AS total_available_quantity, AVG(p.ps_supplycost) AS average_supply_cost, SUM(l.l_quantity) AS total_quantity_ordered, SUM(l.l_extendedprice * (1 - l_discount)) AS total_revenue, COUNT(DISTINCT l.l_orderkey) AS number_of_orders FROM region r JOIN supplier s ON s.s_nationkey = r.r_regionkey JOIN partsupp p ON p.ps_suppkey = s.s_suppkey JOIN lineitem l ON l.l_suppkey = p.ps_suppkey AND l.l_partkey = p.ps_partkey WHERE r.r_name IN ('MIDDLE EAST', 'ASIA', 'EUROPE', 'AMERICA', 'AFRICA') AND s.s_acctbal BETWEEN 1500 AND 7000 AND l.l_shipinstruct = 'COLLECT COD' AND l.l_shipdate BETWEEN '1993-01-01' AND '1993-12-31' GROUP BY r.r_name ORDER BY total_revenue DESC;
SELECT r.r_name AS region, p.p_brand, p.p_type, EXTRACT(YEAR FROM o.o_orderdate) AS order_year, COUNT(DISTINCT o.o_orderkey) AS total_orders, SUM(l.l_quantity) AS total_quantity, AVG(l.l_extendedprice * (1 - l.l_discount)) AS avg_discounted_price, SUM(l.l_extendedprice * (1 - l.l_discount) * (1 + l.l_tax)) AS total_taxed_price FROM region r JOIN supplier s ON s.s_nationkey = r.r_regionkey JOIN lineitem l ON l.l_suppkey = s.s_suppkey JOIN part p ON p.p_partkey = l.l_partkey JOIN orders o ON o.o_orderkey = l.l_orderkey JOIN customer c ON c.c_custkey = o.o_custkey WHERE c.c_mktsegment = 'AUTOMOBILE' AND p.p_container IN ('WRAP DRUM', 'JUMBO PACK') AND o.o_orderdate BETWEEN '1997-01-01' AND '1997-12-31' AND l.l_shipdate > o.o_orderdate GROUP BY region, p.p_brand, p.p_type, order_year ORDER BY total_taxed_price DESC, avg_discounted_price DESC LIMIT 10;
SELECT r.r_name AS region, AVG(c.c_acctbal) AS avg_customer_acct_balance, SUM(li.total_revenue) AS total_supplier_revenue FROM region r JOIN nation n ON r.r_regionkey = n.n_regionkey JOIN customer c ON n.n_nationkey = c.c_nationkey JOIN supplier s ON n.n_nationkey = s.s_nationkey JOIN ( SELECT l_suppkey, SUM(l_extendedprice * (1 - l_discount)) AS total_revenue FROM lineitem WHERE l_shipdate BETWEEN '1993-01-01' AND '1997-12-31' GROUP BY l_suppkey ) AS li ON s.s_suppkey = li.l_suppkey GROUP BY r.r_name ORDER BY total_supplier_revenue DESC, avg_customer_acct_balance DESC;
SELECT r_name AS region, n_name AS nation, COUNT(DISTINCT c_custkey) AS num_customers, COUNT(DISTINCT o_orderkey) AS num_orders, SUM(l_extendedprice) AS total_sales, AVG(l_extendedprice * (1 - l_discount)) AS avg_discounted_sales, SUM(l_quantity) AS total_quantity_sold, AVG(c_acctbal) AS avg_customer_balance FROM region JOIN nation ON n_regionkey = r_regionkey JOIN customer ON c_nationkey = n_nationkey JOIN orders ON o_custkey = c_custkey JOIN lineitem ON l_orderkey = o_orderkey JOIN part ON l_partkey = p_partkey WHERE r_name IN ('EUROPE', 'ASIA', 'MIDDLE EAST') AND o_orderdate BETWEEN '1994-01-01' AND '1994-12-31' AND part.p_type IN ('SMALL PLATED STEEL', 'ECONOMY PLATED COPPER', 'PROMO BRUSHED STEEL', 'PROMO BURNISHED TIN') AND o_orderpriority = '3-MEDIUM' GROUP BY r_name, n_name ORDER BY total_sales DESC, avg_discounted_sales DESC;
SELECT r.r_name AS region_name, COUNT(DISTINCT c.c_custkey) AS number_of_customers, COUNT(DISTINCT s.s_suppkey) AS number_of_suppliers, SUM(l.l_quantity) AS total_quantity_ordered, AVG(l.l_extendedprice) AS average_order_price, SUM(l.l_extendedprice * (1 - l.l_discount)) AS revenue_after_discount, COUNT(DISTINCT o.o_orderkey) AS number_of_orders FROM region r JOIN supplier s ON s.s_nationkey = r.r_regionkey JOIN customer c ON c.c_nationkey = r.r_regionkey JOIN orders o ON o.o_custkey = c.c_custkey JOIN lineitem l ON l.l_orderkey = o.o_orderkey WHERE r.r_name = 'AFRICA' AND l.l_shipdate BETWEEN '1995-01-01' AND '1995-12-31' AND o.o_shippriority = '0' GROUP BY r.r_name ORDER BY revenue_after_discount DESC;
SELECT r.r_name AS region, c.c_mktsegment AS market_segment, COUNT(DISTINCT o.o_orderkey) AS total_orders, SUM(l.l_extendedprice) AS total_sales, AVG(l.l_quantity) AS average_quantity, SUM(l.l_extendedprice * (1 - l_discount)) AS total_discounted_sales FROM region r JOIN customer c ON r.r_regionkey = c.c_nationkey JOIN orders o ON c.c_custkey = o.o_custkey JOIN lineitem l ON o.o_orderkey = l.l_orderkey WHERE l.l_shipdate BETWEEN date '2022-01-01' AND date '2022-12-31' AND l.l_returnflag = 'R' AND c.c_mktsegment <> 'AUTOMOBILE' GROUP BY region, market_segment ORDER BY total_sales DESC, region, market_segment;
SELECT r_name AS region, n_name AS nation, COUNT(DISTINCT c_custkey) AS num_customers, COUNT(DISTINCT s_suppkey) AS num_suppliers, SUM(l_extendedprice * (1 - l_discount)) AS total_revenue, AVG(l_quantity) AS avg_quantity_sold, AVG(c_acctbal) AS avg_customer_acctbal, AVG(s_acctbal) AS avg_supplier_acctbal FROM region JOIN nation ON n_regionkey = r_regionkey JOIN customer ON c_nationkey = n_nationkey JOIN supplier ON s_nationkey = n_nationkey JOIN lineitem ON (c_custkey = l_orderkey AND s_suppkey = l_suppkey) WHERE l_shipdate BETWEEN '1995-01-01' AND '1995-12-31' AND r_name IN ('EUROPE', 'AMERICA', 'ASIA') GROUP BY r_name, n_name ORDER BY total_revenue DESC, avg_quantity_sold DESC LIMIT 10;
SELECT r.r_name AS region_name, n.n_name AS nation_name, COUNT(DISTINCT o.o_orderkey) AS total_orders, SUM(l.l_extendedprice * (1 - l.l_discount)) AS revenue, AVG(l.l_quantity) AS average_quantity, AVG(l.l_extendedprice) AS average_price, SUM(l.l_discount) AS total_discount_amount, COUNT(DISTINCT ps.ps_suppkey) AS unique_suppliers FROM region r JOIN nation n ON r.r_regionkey = n.n_regionkey JOIN partsupp ps ON n.n_nationkey = ps.ps_suppkey JOIN lineitem l ON ps.ps_partkey = l.l_partkey AND ps.ps_suppkey = l.l_suppkey JOIN orders o ON l.l_orderkey = o.o_orderkey WHERE r.r_regionkey IN (4, 2) AND (r.r_comment LIKE '%ly final courts cajole furiously final excuse%' OR r.r_comment LIKE '%ges. thinly even pinto beans ca%' OR r.r_comment LIKE '%hs use ironic, even requests. s%') AND (n.n_comment LIKE '%efully alongside of the slyly final dependencies.%' OR n.n_comment LIKE '%refully final requests. regular, ironi%' OR n.n_comment LIKE '%s. ironic, unusual asymptotes wake blithely r%') AND l.l_discount IN (0.04, 0.05, 0.06) AND ps.ps_suppkey IN (566, 61050, 185, 915, 120234, 120073) AND ps.ps_availqty IN (3300, 2083, 4195, 6409, 8281) GROUP BY r.r_name, n.n_name ORDER BY revenue DESC;
SELECT r.r_name AS region, n.n_name AS nation, COUNT(c.c_custkey) AS number_of_customers, SUM(c.c_acctbal) AS total_account_balance, AVG(c.c_acctbal) AS average_account_balance, COUNT(ps.ps_partkey) AS number_of_parts, SUM(ps.ps_availqty) AS total_available_parts, AVG(ps.ps_supplycost) AS average_supply_cost FROM region r JOIN nation n ON r.r_regionkey = n.n_regionkey JOIN customer c ON n.n_nationkey = c.c_nationkey JOIN partsupp ps ON ps.ps_suppkey = c.c_custkey WHERE n.n_name IN ('FRANCE', 'IRAN', 'JAPAN', 'MOZAMBIQUE', 'UNITED KINGDOM') AND (n.n_comment LIKE '%final%' OR n.n_comment LIKE '%quickly%') GROUP BY r.r_name, n.n_name ORDER BY total_account_balance DESC, average_supply_cost DESC, nation;
SELECT r.r_name AS region_name, n.n_name AS nation_name, s.s_name AS supplier_name, COUNT(DISTINCT l.l_orderkey) AS total_orders, AVG(l.l_quantity) AS average_quantity, SUM(l.l_extendedprice) AS total_extended_price FROM region r JOIN nation n ON r.r_regionkey = n.n_regionkey JOIN supplier s ON n.n_nationkey = s.s_nationkey JOIN lineitem l ON s.s_suppkey = l.l_suppkey WHERE n.n_regionkey = '1' AND l.l_receiptdate BETWEEN '1997-01-01' AND '1997-12-31' AND l.l_returnflag = 'A' GROUP BY r.r_name, n.n_name, s.s_name ORDER BY total_extended_price DESC, region_name, nation_name, supplier_name;
SELECT r_name AS region, n_name AS nation, COUNT(DISTINCT c_custkey) AS number_of_customers, AVG(c_acctbal) AS average_account_balance, SUM(l_extendedprice * (1 - l_discount)) AS total_sales, SUM(CASE WHEN l_shipdate > CURRENT_DATE THEN l_quantity ELSE 0 END) AS future_shipments_quantity FROM customer JOIN nation ON c_nationkey = n_nationkey JOIN region ON n_regionkey = r_regionkey JOIN lineitem ON c_custkey = l_orderkey JOIN part ON l_partkey = p_partkey JOIN partsupp ON p_partkey = ps_partkey AND l_suppkey = ps_suppkey WHERE c_mktsegment = 'BUILDING' AND p_container IN ('JUMBO BAG', 'JUMBO CAN', 'WRAP PKG') AND l_shipmode IN ('AIR', 'RAIL') GROUP BY region, nation ORDER BY total_sales DESC, average_account_balance DESC;
SELECT r.r_name AS region, n.n_name AS nation, COUNT(DISTINCT c.c_custkey) AS customer_count, AVG(c.c_acctbal) AS avg_account_balance, SUM(CASE WHEN o.o_orderstatus = 'F' THEN 1 ELSE 0 END) AS finished_orders_count, SUM(l.l_quantity) AS total_quantity_ordered, SUM(l.l_extendedprice * (1 - l_discount)) AS total_revenue, AVG(l.l_discount) AS avg_discount FROM region r JOIN nation n ON r.r_regionkey = n.n_regionkey JOIN customer c ON n.n_nationkey = c.c_nationkey JOIN orders o ON c.c_custkey = o.o_custkey JOIN lineitem l ON o.o_orderkey = l.l_orderkey WHERE c.c_mktsegment IN ('HOUSEHOLD', 'AUTOMOBILE', 'BUILDING', 'MACHINERY', 'FURNITURE') AND l.l_shipdate BETWEEN '1995-01-01' AND '1995-12-31' AND l.l_returnflag = 'N' GROUP BY region, nation ORDER BY total_revenue DESC, avg_account_balance DESC;
SELECT n.n_name, AVG(c.c_acctbal) AS avg_customer_balance, SUM(o.o_totalprice) AS total_sales, COUNT(DISTINCT c.c_custkey) AS number_of_customers, COUNT(DISTINCT p.p_partkey) AS number_of_parts_sold, SUM(ps.ps_availqty) AS total_parts_available FROM nation n JOIN customer c ON n.n_nationkey = c.c_nationkey JOIN orders o ON c.c_custkey = o.o_custkey JOIN partsupp ps ON ps.ps_suppkey = o.o_orderkey JOIN part p ON p.p_partkey = ps.ps_partkey WHERE p.p_container IN ('LG CASE', 'JUMBO PKG') AND p.p_brand IN ('Brand#25', 'Brand#51') AND o.o_clerk IN ('Clerk#000010208', 'Clerk#000008953') AND o.o_orderstatus = 'F' GROUP BY n.n_name ORDER BY total_sales DESC, avg_customer_balance DESC LIMIT 10;
SELECT r_name AS region, n_name AS nation, COUNT(DISTINCT s_suppkey) AS number_of_suppliers, COUNT(DISTINCT c_custkey) AS number_of_customers, AVG(s_acctbal) AS average_supplier_account_balance, AVG(c_acctbal) AS average_customer_account_balance, SUM(l_extendedprice * (1 - l_discount)) AS total_sales, AVG(l_quantity) AS average_quantity_sold, SUM(CASE WHEN l_returnflag = 'R' THEN l_extendedprice * (1 - l_discount) ELSE 0 END) AS total_returned_sales FROM region JOIN nation ON n_regionkey = r_regionkey JOIN supplier ON s_nationkey = n_nationkey JOIN customer ON c_nationkey = n_nationkey JOIN orders ON o_custkey = c_custkey JOIN lineitem ON l_orderkey = o_orderkey AND l_suppkey = s_suppkey GROUP BY r_name, n_name ORDER BY total_sales DESC, region, nation;
SELECT r.r_name AS region_name, AVG(c.c_acctbal) AS avg_customer_acctbalance FROM region r JOIN nation n ON r.r_regionkey = n.n_regionkey JOIN customer c ON n.n_nationkey = c.c_nationkey JOIN orders o ON c.c_custkey = o.o_custkey WHERE o.o_clerk IN ('Clerk#000011957', 'Clerk#000000938') GROUP BY r.r_name ORDER BY avg_customer_acctbalance DESC;
SELECT c_mktsegment, AVG(c_acctbal) AS avg_acctbal, SUM(l_extendedprice) AS total_sales, COUNT(DISTINCT c_custkey) AS num_customers, COUNT(DISTINCT l_orderkey) AS num_orders, SUM(l_quantity) AS total_quantity_sold, AVG(l_discount) AS avg_discount_given FROM customer JOIN lineitem ON c_custkey = l_orderkey JOIN partsupp ON lineitem.l_partkey = partsupp.ps_partkey AND lineitem.l_suppkey = partsupp.ps_suppkey WHERE l_shipdate BETWEEN '1995-01-01' AND '1995-12-31' AND l_returnflag = 'N' GROUP BY c_mktsegment ORDER BY total_sales DESC, avg_acctbal DESC;
SELECT r.r_name AS region_name, c.c_mktsegment AS customer_market_segment, COUNT(DISTINCT o.o_orderkey) AS total_orders, SUM(o.o_totalprice) AS total_order_value, AVG(l.l_discount) AS average_discount, COUNT(DISTINCT s.s_suppkey) AS total_suppliers FROM orders o INNER JOIN customer c ON o.o_custkey = c.c_custkey INNER JOIN nation n ON c.c_nationkey = n.n_nationkey INNER JOIN region r ON n.n_regionkey = r.r_regionkey INNER JOIN lineitem l ON o.o_orderkey = l.l_orderkey INNER JOIN supplier s ON s.s_nationkey = n.n_nationkey WHERE l.l_returnflag <> 'N' AND c.c_mktsegment IN ('BUILDING', 'AUTOMOBILE', 'MACHINERY') AND l.l_shipdate IN ('1997-12-27', '1996-01-22', '1997-03-09', '1994-05-11', '1998-04-17') GROUP BY r.r_name, c.c_mktsegment ORDER BY total_order_value DESC, average_discount ASC;
SELECT r.r_name AS region, p.p_brand AS brand, COUNT(*) AS number_of_orders, SUM(l_extendedprice) AS total_sales, AVG(l_extendedprice * (1 - l_discount)) AS avg_discounted_sales, SUM(l_quantity) AS total_quantity, AVG(l_quantity) AS average_quantity, SUM(CASE WHEN l_tax > 0 THEN l_extendedprice * l_tax ELSE 0 END) AS total_tax_collected FROM lineitem l JOIN part p ON l.l_partkey = p.p_partkey JOIN region r ON p.p_brand LIKE 'Brand#%' WHERE l.l_shipdate BETWEEN '1995-01-01' AND '1995-12-31' AND l.l_returnflag = 'N' GROUP BY r.r_name, p.p_brand ORDER BY total_sales DESC, avg_discounted_sales DESC;
SELECT r_name AS region_name, n_name AS nation_name, COUNT(DISTINCT s_suppkey) AS number_of_suppliers, COUNT(DISTINCT c_custkey) AS number_of_customers, SUM(l_extendedprice * (1 - l_discount)) AS total_revenue, AVG(c_acctbal) AS avg_customer_acct_balance, AVG(s_acctbal) AS avg_supplier_acct_balance FROM region JOIN nation ON n_regionkey = r_regionkey JOIN supplier ON s_nationkey = n_nationkey JOIN customer ON c_nationkey = n_nationkey JOIN orders ON o_custkey = c_custkey JOIN lineitem ON l_orderkey = o_orderkey WHERE r_regionkey IN (1, 4, 0, 2, 3) AND s_nationkey IN (1, 6, 9) AND c_nationkey IN (21, 2, 12, 14, 24) AND n_nationkey IN (0, 3, 4, 16, 13, 1) AND o_orderdate BETWEEN '1993-01-01' AND '1994-01-01' GROUP BY region_name, nation_name ORDER BY total_revenue DESC;
SELECT r.r_name AS region, c.c_mktsegment AS market_segment, COUNT(DISTINCT c.c_custkey) AS number_of_customers, SUM(l.l_extendedprice) AS total_sales, AVG(l.l_discount) AS average_discount FROM customer c JOIN nation n ON c.c_nationkey = n.n_nationkey JOIN region r ON n.n_regionkey = r.r_regionkey JOIN lineitem l ON c.c_custkey = l.l_suppkey JOIN part p ON l.l_partkey = p.p_partkey WHERE p.p_brand = 'Brand#12' GROUP BY r.r_name, c.c_mktsegment ORDER BY total_sales DESC;
SELECT r_name AS region, n_name AS nation, COUNT(DISTINCT c_custkey) AS number_of_customers, AVG(c_acctbal) AS average_account_balance, SUM(o_totalprice) AS total_sales, AVG(l_quantity) AS average_quantity_sold, SUM(l_extendedprice * (1 - l_discount)) AS total_revenue_after_discount FROM customer JOIN nation ON customer.c_nationkey = nation.n_nationkey JOIN region ON nation.n_regionkey = region.r_regionkey JOIN orders ON customer.c_custkey = orders.o_custkey JOIN lineitem ON orders.o_orderkey = lineitem.l_orderkey WHERE customer.c_nationkey IN (19, 20, 13, 8) AND customer.c_phone IN ('32-687-204-1304', '24-237-840-4358', '28-329-169-7438', '12-813-837-3306', '26-676-401-7091', '27-137-497-2778') AND lineitem.l_shipdate >= DATE '1995-01-01' AND lineitem.l_shipdate < DATE '1996-01-01' GROUP BY region, nation ORDER BY total_sales DESC, region, nation;
SELECT r.r_name AS region, COUNT(DISTINCT o.o_orderkey) AS number_of_orders, SUM(l.l_extendedprice) AS total_sales, AVG(l.l_discount) AS average_discount, AVG(l.l_tax) AS average_tax FROM region r JOIN nation n ON r.r_regionkey = n.n_nationkey JOIN supplier s ON n.n_nationkey = s.s_nationkey JOIN lineitem l ON s.s_suppkey = l.l_suppkey JOIN orders o ON l.l_orderkey = o.o_orderkey WHERE o.o_orderstatus = 'F' AND l.l_shipdate BETWEEN DATE '2022-01-01' AND DATE '2022-12-31' GROUP BY r.r_name ORDER BY total_sales DESC;
SELECT n.n_name, SUM(ps.ps_availqty) AS total_availability, AVG(ps.ps_supplycost) AS average_supplycost, COUNT(DISTINCT s.s_suppkey) AS number_of_suppliers, COUNT(DISTINCT p.p_partkey) AS number_of_parts, SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_revenue, AVG(l.l_quantity) AS average_quantity_sold FROM nation n JOIN supplier s ON n.n_nationkey = s.s_nationkey JOIN partsupp ps ON s.s_suppkey = ps.ps_suppkey JOIN part p ON ps.ps_partkey = p.p_partkey JOIN lineitem l ON p.p_partkey = l.l_partkey AND s.s_suppkey = l.l_suppkey JOIN orders o ON l.l_orderkey = o.o_orderkey WHERE o.o_orderdate >= '2020-01-01' AND o.o_orderdate < '2021-01-01' AND l.l_shipdate > l.l_commitdate GROUP BY n.n_name ORDER BY total_revenue DESC;
SELECT n.n_name AS nation, l.l_shipmode, SUM(l.l_extendedprice * (1 - l_discount)) AS total_revenue, AVG(l.l_quantity) AS average_quantity, COUNT(*) AS total_orders FROM nation n JOIN supplier s ON n.n_nationkey = s.s_nationkey JOIN lineitem l ON s.s_suppkey = l.l_suppkey WHERE l.l_shipmode IN ('AIR', 'SHIP') AND l.l_shipdate >= '1995-01-01' AND l.l_shipdate < '1995-01-01'::date + INTERVAL '1 year' GROUP BY n.n_name, l.l_shipmode ORDER BY total_revenue DESC, n.n_name, l.l_shipmode;
SELECT r.r_name AS region, p.p_type AS part_type, SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_sales, AVG(l.l_extendedprice * (1 - l.l_discount)) AS average_sales, COUNT(*) AS num_of_transactions FROM lineitem l INNER JOIN part p ON l.l_partkey = p.p_partkey INNER JOIN region r ON r.r_regionkey = p.p_partkey % 5 WHERE l.l_shipdate BETWEEN '2021-01-01' AND '2021-12-31' AND p.p_type IN ('ECONOMY POLISHED NICKEL', 'MEDIUM BURNISHED STEEL', 'PROMO BURNISHED COPPER', 'PROMO POLISHED STEEL', 'SMALL PLATED BRASS', 'STANDARD BRUSHED STEEL') GROUP BY r.r_name, p.p_type ORDER BY total_sales DESC;
SELECT p.ps_suppkey AS supplier_key, COUNT(DISTINCT o.o_orderkey) AS total_orders, SUM(l.l_quantity) AS total_quantity_sold, AVG(l.l_discount) AS average_discount_given, AVG(p.ps_supplycost) AS average_supply_cost FROM partsupp p JOIN lineitem l ON p.ps_partkey = l.l_partkey AND p.ps_suppkey = l.l_suppkey JOIN orders o ON l.l_orderkey = o.o_orderkey WHERE l.l_discount IN (0.05, 0.09, 0.03, 0.04) AND l.l_suppkey IN (114785, 202901, 3477, 147130, 101380) GROUP BY p.ps_suppkey ORDER BY total_quantity_sold DESC, average_discount_given;
SELECT s_nationkey, c_mktsegment, COUNT(DISTINCT o_orderkey) AS num_orders, SUM(l_extendedprice * (1 - l_discount)) AS revenue, AVG(l_quantity) AS avg_quantity, AVG(l_extendedprice) AS avg_price, AVG(l_discount) AS avg_discount, COUNT(*) AS lineitem_count FROM supplier, orders, lineitem, customer WHERE s_suppkey = l_suppkey AND l_orderkey = o_orderkey AND o_custkey = c_custkey AND s_nationkey IN (21, 12) AND s_phone IN ('18-343-591-7200', '27-424-904-2482') GROUP BY s_nationkey, c_mktsegment ORDER BY revenue DESC;
SELECT r_name AS region, n_name AS nation, EXTRACT(YEAR FROM o_orderdate) AS order_year, COUNT(DISTINCT o_orderkey) AS total_orders, SUM(l_extendedprice * (1 - l_discount)) AS revenue, AVG(l_quantity) AS average_quantity, AVG(s_acctbal) AS average_supplier_account_balance FROM region JOIN nation ON n_regionkey = r_regionkey JOIN supplier ON s_nationkey = n_nationkey JOIN lineitem ON l_suppkey = s_suppkey JOIN orders ON o_orderkey = l_orderkey WHERE r_name IN ('AMERICA', 'ASIA') AND o_orderdate BETWEEN '1993-01-01' AND '1994-12-31' GROUP BY region, nation, order_year ORDER BY region, nation, order_year DESC;
SELECT r_name AS region, n_name AS nation, EXTRACT(YEAR FROM o_orderdate) AS order_year, COUNT(DISTINCT o_orderkey) AS total_orders, SUM(l_extendedprice * (1 - l_discount)) AS total_revenue, AVG(l_quantity) AS average_quantity_sold, SUM(l_quantity) AS total_quantity_sold FROM region JOIN nation ON r_regionkey = n_regionkey JOIN supplier ON s_nationkey = n_nationkey JOIN partsupp ON ps_suppkey = s_suppkey JOIN part ON p_partkey = ps_partkey JOIN lineitem ON l_partkey = p_partkey AND l_suppkey = s_suppkey JOIN orders ON o_orderkey = l_orderkey JOIN customer ON c_custkey = o_custkey AND c_nationkey = n_nationkey WHERE r_name IN ('AFRICA', 'MIDDLE EAST', 'AMERICA') AND o_shippriority = 0 AND o_orderdate BETWEEN DATE '1995-01-01' AND DATE '1996-12-31' AND l_quantity IN (30.00, 12.00, 40.00, 13.00, 47.00) GROUP BY region, nation, order_year ORDER BY total_revenue DESC, region, nation, order_year;
SELECT n.n_name, AVG(c.c_acctbal) AS avg_customer_balance, SUM(l.l_quantity) AS total_quantity_ordered, COUNT(DISTINCT o.o_orderkey) AS number_of_orders, SUM(l.l_extendedprice * (1 - l_discount)) AS revenue_after_discount FROM nation n JOIN customer c ON n.n_nationkey = c.c_nationkey JOIN orders o ON c.c_custkey = o.o_custkey JOIN lineitem l ON o.o_orderkey = l.l_orderkey WHERE n.n_name IN ('ARGENTINA', 'JORDAN', 'IRAQ', 'RUSSIA') AND n.n_regionkey IN (1, 0, 2) AND c.c_mktsegment IN ('HOUSEHOLD', 'AUTOMOBILE', 'BUILDING', 'MACHINERY', 'FURNITURE') AND l.l_suppkey = 183863 AND l.l_linenumber IN (6, 2, 1, 7, 4) AND o.o_clerk = 'Clerk#000001496' GROUP BY n.n_name ORDER BY revenue_after_discount DESC;
SELECT n.n_name, SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_revenue, AVG(l.l_quantity) AS average_quantity, COUNT(DISTINCT o.o_orderkey) AS total_orders, MAX(p.p_retailprice) AS max_part_retailprice FROM nation AS n JOIN customer AS c ON n.n_nationkey = c.c_nationkey JOIN orders AS o ON c.c_custkey = o.o_custkey JOIN lineitem AS l ON o.o_orderkey = l.l_orderkey JOIN part AS p ON l.l_partkey = p.p_partkey WHERE n.n_regionkey BETWEEN 1 AND 3 AND o.o_orderstatus = 'F' AND l.l_shipmode = 'TRUCK' AND p.p_brand IN ('Brand#53', 'Brand#24') AND l.l_shipdate BETWEEN '1995-01-01' AND '1995-12-31' GROUP BY n.n_name ORDER BY total_revenue DESC, n.n_name LIMIT 5;
SELECT r.r_name AS region_name, n.n_name AS nation_name, o.o_orderpriority AS order_priority, COUNT(DISTINCT o.o_orderkey) AS number_of_orders, SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_sales, AVG(l.l_extendedprice * (1 - l.l_discount)) AS average_sales_per_order FROM orders o JOIN lineitem l ON o.o_orderkey = l.l_orderkey JOIN nation n ON o.o_custkey = n.n_nationkey JOIN region r ON n.n_regionkey = r.r_regionkey WHERE o.o_orderdate BETWEEN '1995-01-01' AND '1995-12-31' AND o.o_orderpriority = '3-MEDIUM' GROUP BY r.r_name, n.n_name, o.o_orderpriority ORDER BY total_sales DESC;
SELECT n.n_name AS nation_name, p.p_brand AS part_brand, p.p_size AS part_size, COUNT(DISTINCT o.o_orderkey) AS total_orders, SUM(l.l_quantity) AS total_quantity, AVG(l.l_extendedprice) AS avg_price_before_discount, SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_revenue_after_discount FROM nation n JOIN orders o ON o.o_orderstatus = 'F' JOIN lineitem l ON o.o_orderkey = l.l_orderkey JOIN part p ON l.l_partkey = p.p_partkey WHERE n.n_nationkey = o.o_custkey AND n.n_name IN ('UNITED KINGDOM', 'INDONESIA') AND p.p_brand IN ('Brand#13', 'Brand#34', 'Brand#22', 'Brand#42') AND p.p_size IN (24, 13, 30, 17, 50) GROUP BY nation_name, part_brand, part_size ORDER BY total_revenue_after_discount DESC, nation_name, part_brand, part_size;
SELECT n.n_name AS nation, COUNT(DISTINCT c.c_custkey) AS number_of_customers, SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_sales, AVG(l.l_discount) AS average_discount FROM nation n JOIN customer c ON n.n_nationkey = c.c_nationkey JOIN lineitem l ON c.c_custkey = l.l_orderkey WHERE c.c_mktsegment = 'BUILDING' AND l.l_shipdate BETWEEN '1995-01-01' AND '1995-12-31' GROUP BY n.n_name ORDER BY total_sales DESC;
SELECT n_name, COUNT(DISTINCT s_suppkey) AS total_suppliers, COUNT(DISTINCT p_partkey) AS total_parts, SUM(l_extendedprice * (1 - l_discount)) AS revenue, AVG(ps_supplycost) AS average_supply_cost, AVG(l_quantity) AS average_quantity_ordered FROM nation JOIN supplier ON nation.n_nationkey = supplier.s_nationkey JOIN partsupp ON supplier.s_suppkey = partsupp.ps_suppkey JOIN part ON partsupp.ps_partkey = part.p_partkey JOIN lineitem ON part.p_partkey = lineitem.l_partkey AND supplier.s_suppkey = lineitem.l_suppkey JOIN orders ON lineitem.l_orderkey = orders.o_orderkey WHERE part.p_container = 'LG DRUM' AND lineitem.l_shipdate BETWEEN '1993-09-23' AND '1995-07-20' GROUP BY n_name ORDER BY revenue DESC;
SELECT r_name AS region, EXTRACT(YEAR FROM o_orderdate) AS order_year, COUNT(DISTINCT o_orderkey) AS total_orders, SUM(l_extendedprice * (1 - l_discount)) AS revenue, AVG(l_quantity) AS average_quantity, SUM(ps_supplycost * l_quantity) AS total_supply_cost, (SUM(l_extendedprice * (1 - l_discount)) - SUM(ps_supplycost * l_quantity)) AS profit FROM region JOIN nation ON n_regionkey = r_regionkey JOIN supplier ON s_nationkey = n_nationkey JOIN partsupp ON ps_suppkey = s_suppkey JOIN lineitem ON l_suppkey = s_suppkey AND l_partkey = ps_partkey JOIN orders ON o_orderkey = l_orderkey WHERE o_orderdate BETWEEN '1994-01-01' AND '1995-12-31' AND l_discount BETWEEN 0.05 AND 0.10 AND l_shipdate > o_orderdate AND o_orderstatus = 'F' GROUP BY region, order_year ORDER BY profit DESC, region, order_year;
SELECT c.c_mktsegment, o.o_orderpriority, COUNT(DISTINCT c.c_custkey) AS num_customers, COUNT(DISTINCT o.o_orderkey) AS num_orders, SUM(l.l_extendedprice) AS total_sales, AVG(l.l_quantity) AS avg_quantity_sold, SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_revenue_after_discount FROM customer c JOIN orders o ON c.c_custkey = o.o_custkey JOIN lineitem l ON o.o_orderkey = l.l_orderkey WHERE o.o_orderstatus = 'F' AND o.o_shippriority = '0' AND l.l_shipdate BETWEEN date '2022-01-01' AND date '2022-12-31' AND o.o_comment LIKE '%packages%' GROUP BY c.c_mktsegment, o.o_orderpriority ORDER BY total_revenue_after_discount DESC;
SELECT r.r_name AS region, n.n_name AS nation, COUNT(DISTINCT c.c_custkey) AS number_of_customers, COUNT(DISTINCT s.s_suppkey) AS number_of_suppliers, AVG(c.c_acctbal) AS average_customer_account_balance, SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_revenue, AVG(l.l_discount) AS average_discount, COUNT(DISTINCT l.l_orderkey) AS number_of_orders FROM customer c JOIN nation n ON c.c_nationkey = n.n_nationkey JOIN region r ON n.n_regionkey = r.r_regionkey JOIN supplier s ON n.n_nationkey = s.s_nationkey JOIN lineitem l ON s.s_suppkey = l.l_suppkey WHERE c.c_mktsegment = 'MACHINERY' AND l.l_shipdate BETWEEN '2022-01-01' AND '2022-12-31' GROUP BY r.r_name, n.n_name ORDER BY total_revenue DESC;
SELECT r_name AS region, n_name AS nation, COUNT(DISTINCT s_suppkey) AS total_suppliers, COUNT(DISTINCT c_custkey) AS total_customers, AVG(s_acctbal) AS avg_supplier_acctbal, AVG(c_acctbal) AS avg_customer_acctbal, SUM(l_extendedprice * (1 - l_discount)) AS revenue, AVG(l_quantity) AS avg_lineitem_quantity FROM region JOIN nation ON r_regionkey = n_regionkey JOIN supplier ON s_nationkey = n_nationkey JOIN customer ON c_nationkey = n_nationkey JOIN orders ON o_custkey = c_custkey JOIN lineitem ON l_orderkey = o_orderkey JOIN partsupp ON ps_suppkey = s_suppkey AND ps_partkey = l_partkey WHERE r_name IN ('EUROPE', 'AMERICA') AND o_orderdate BETWEEN date '1995-01-01' AND date '1995-12-31' AND l_shipdate > o_orderdate GROUP BY r_name, n_name ORDER BY revenue DESC, region, nation;
SELECT s.s_name, s.s_address, AVG(p.p_retailprice) AS avg_retail_price, SUM(ps.ps_availqty) AS total_available_quantity, COUNT(DISTINCT o.o_orderkey) AS total_orders FROM supplier s JOIN partsupp ps ON s.s_suppkey = ps.ps_suppkey JOIN part p ON ps.ps_partkey = p.p_partkey LEFT JOIN orders o ON s.s_suppkey = o.o_custkey WHERE s.s_name IN ('Supplier#000021306', 'Supplier#000019093', 'Supplier#000022195', 'Supplier#000019781', 'Supplier#000021557', 'Supplier#000020709') AND s.s_address IN ('yTzCadWg0r27Fsy', ',ZmLYOdRzBBkuNfYwJTfadc,', 'xiFtlR0zcwFzMZZxDa8nYqiwxCaz5BCiRlWVNe B') AND o.o_custkey::text = '1755247' GROUP BY s.s_name, s.s_address ORDER BY avg_retail_price DESC, total_available_quantity DESC;
SELECT r.r_name AS region_name, COUNT(DISTINCT s.s_suppkey) AS number_of_suppliers, AVG(s.s_acctbal) AS average_account_balance, SUM(ps.ps_availqty) AS total_available_quantity, AVG(ps.ps_supplycost) AS average_supply_cost, COUNT(DISTINCT o.o_orderkey) AS number_of_orders, SUM(o.o_totalprice) AS total_order_value, AVG(o.o_totalprice) AS average_order_value FROM region r JOIN supplier s ON r.r_regionkey = s.s_nationkey JOIN partsupp ps ON s.s_suppkey = ps.ps_suppkey LEFT JOIN orders o ON s.s_nationkey = o.o_custkey GROUP BY r.r_name ORDER BY r.r_name;
SELECT r.r_name, n.n_name, COUNT(DISTINCT s.s_suppkey) AS number_of_suppliers, SUM(ps.ps_availqty) AS total_available_quantity, AVG(s.s_acctbal) AS average_account_balance, SUM(ps.ps_supplycost * ps.ps_availqty) AS total_supply_cost_value FROM region r JOIN nation n ON r.r_regionkey = n.n_regionkey JOIN supplier s ON n.n_nationkey = s.s_nationkey JOIN partsupp ps ON s.s_suppkey = ps.ps_suppkey JOIN part p ON ps.ps_partkey = p.p_partkey WHERE p.p_container IN ('WRAP JAR', 'JUMBO CASE', 'WRAP PKG') AND r.r_comment LIKE '%final courts cajole furiously final%' GROUP BY r.r_name, n.n_name ORDER BY total_supply_cost_value DESC, r.r_name, n.n_name;
SELECT n.n_name AS nation_name, AVG(c.c_acctbal) AS average_account_balance, COUNT(DISTINCT c.c_custkey) AS number_of_customers, p.p_brand, SUM(ps.ps_availqty) AS total_available_quantity, AVG(ps.ps_supplycost) AS average_supply_cost, SUM(p.p_retailprice * ps.ps_availqty) AS total_retail_value FROM nation n JOIN customer c ON n.n_nationkey = c.c_nationkey JOIN partsupp ps ON ps.ps_suppkey = c.c_custkey JOIN part p ON ps.ps_partkey = p.p_partkey WHERE n.n_nationkey IN (23, 7, 17, 9, 24, 13) AND p.p_size = 1 AND p.p_brand IN ('Brand#42', 'Brand#11', 'Brand#45') GROUP BY n.n_name, p.p_brand ORDER BY nation_name, p.p_brand;
SELECT p.p_brand, COUNT(DISTINCT o.o_orderkey) AS total_orders, AVG(l.l_quantity) AS avg_quantity_ordered, AVG(o.o_totalprice) AS avg_order_total_price FROM part p JOIN partsupp ps ON p.p_partkey = ps.ps_partkey JOIN lineitem l ON p.p_partkey = l.l_partkey JOIN orders o ON l.l_orderkey = o.o_orderkey WHERE ps.ps_suppkey = 682 AND l.l_receiptdate > '1997-11-01' GROUP BY p.p_brand ORDER BY total_orders DESC, avg_order_total_price DESC;
SELECT r.r_name AS region, n.n_name AS nation, COUNT(DISTINCT s.s_suppkey) AS total_suppliers, COUNT(DISTINCT c.c_custkey) AS total_customers, AVG(s.s_acctbal) AS avg_supplier_acctbal, AVG(c.c_acctbal) AS avg_customer_acctbal, SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_sales_volume, AVG(l.l_extendedprice * (1 - l.l_discount)) AS avg_sales_price FROM region r JOIN nation n ON r.r_regionkey = n.n_regionkey JOIN supplier s ON n.n_nationkey = s.s_nationkey JOIN customer c ON n.n_nationkey = c.c_nationkey JOIN orders o ON c.c_custkey = o.o_custkey JOIN lineitem l ON o.o_orderkey = l.l_orderkey WHERE n.n_name IN ('UNITED STATES', 'GERMANY') AND l.l_shipmode IN ('REG AIR', 'MAIL') AND l.l_shipdate BETWEEN date '1995-01-01' AND date '1996-12-31' GROUP BY region, nation ORDER BY total_sales_volume DESC, region, nation;
SELECT r.r_name AS region_name, n.n_name AS nation_name, EXTRACT(YEAR FROM o.o_orderdate) AS order_year, COUNT(DISTINCT o.o_orderkey) AS number_of_orders, SUM(l.l_quantity) AS total_quantity, AVG(l.l_extendedprice) AS average_price, SUM(l.l_extendedprice * (1 - l_discount)) AS revenue_after_discount FROM region r JOIN nation n ON r.r_regionkey = n.n_regionkey JOIN orders o ON o.o_custkey = n.n_nationkey JOIN lineitem l ON l.l_orderkey = o.o_orderkey WHERE o.o_orderstatus = 'F' GROUP BY region_name, nation_name, order_year ORDER BY region_name, nation_name, order_year DESC;
SELECT r.r_name AS region_name, COUNT(DISTINCT s.s_suppkey) AS supplier_count, COUNT(DISTINCT p.p_partkey) AS part_count, COUNT(DISTINCT o.o_orderkey) AS order_count, SUM(l.l_quantity) AS total_quantity, AVG(l.l_extendedprice) AS avg_price, SUM(l.l_extendedprice * (1 - l_discount)) AS revenue, AVG(l.l_discount) AS avg_discount FROM region r JOIN supplier s ON s.s_nationkey = r.r_regionkey JOIN lineitem l ON l.l_suppkey = s.s_suppkey JOIN orders o ON l.l_orderkey = o.o_orderkey JOIN part p ON l.l_partkey = p.p_partkey WHERE r.r_regionkey IN (1, 4, 0, 2, 3) AND p.p_size IN (47, 6, 29, 28) AND s.s_comment LIKE '%deas are slyly regular sheaves. ideas a%' AND l.l_returnflag IN ('N', 'A', 'R') AND o.o_orderdate BETWEEN '1994-01-01' AND '1995-01-01' GROUP BY r.r_name ORDER BY revenue DESC;
SELECT r.r_name AS region, n.n_name AS nation, COUNT(DISTINCT s.s_suppkey) AS number_of_suppliers, COUNT(DISTINCT c.c_custkey) AS number_of_customers, SUM(li.l_extendedprice * (1 - li.l_discount)) AS total_sales, AVG(li.l_quantity) AS average_quantity_sold, AVG(li.l_extendedprice) AS average_sales_price, AVG(s.s_acctbal) AS average_supplier_balance, AVG(c.c_acctbal) AS average_customer_balance FROM region r JOIN nation n ON r.r_regionkey = n.n_regionkey JOIN supplier s ON n.n_nationkey = s.s_nationkey JOIN customer c ON n.n_nationkey = c.c_nationkey JOIN orders o ON c.c_custkey = o.o_custkey JOIN lineitem li ON o.o_orderkey = li.l_orderkey WHERE r.r_regionkey IN (1, 2, 3) AND o.o_orderdate >= DATE '2020-01-01' AND o.o_orderdate < DATE '2021-01-01' GROUP BY r.r_name, n.n_name ORDER BY total_sales DESC;
SELECT r.r_name AS region, COUNT(DISTINCT s.s_suppkey) AS total_suppliers, COUNT(DISTINCT c.c_custkey) AS total_customers, SUM(ps.ps_availqty) AS total_available_quantity, AVG(ps.ps_supplycost) AS average_supply_cost, SUM(l.l_quantity) AS total_quantity_ordered, AVG(l.l_extendedprice * (1 - l_discount)) AS average_discounted_price, SUM(o.o_totalprice) AS total_orders_value FROM region r JOIN supplier s ON r.r_regionkey = s.s_nationkey JOIN partsupp ps ON s.s_suppkey = ps.ps_suppkey JOIN lineitem l ON ps.ps_partkey = l.l_partkey AND ps.ps_suppkey = l.l_suppkey JOIN orders o ON l.l_orderkey = o.o_orderkey JOIN customer c ON o.o_custkey = c.c_custkey AND s.s_nationkey = c.c_nationkey WHERE l.l_shipdate BETWEEN '1995-01-01' AND '1996-12-31' AND c.c_acctbal > 5000 AND l.l_quantity < 30 GROUP BY r.r_name ORDER BY total_orders_value DESC LIMIT 1;
SELECT p.p_brand, r.r_name AS region_name, SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_sales, AVG(l.l_discount) AS average_discount, COUNT(*) AS total_items_sold FROM part p JOIN lineitem l ON p.p_partkey = l.l_partkey JOIN region r ON r.r_regionkey = p.p_partkey % 5 WHERE l.l_shipdate > date '1992-01-01' AND l.l_quantity > 30 GROUP BY p.p_brand, r.r_name ORDER BY total_sales DESC, region_name, p.p_brand;
SELECT r.r_name AS region_name, COUNT(DISTINCT o.o_orderkey) AS number_of_orders, SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_sales, AVG(l.l_extendedprice * (1 - l.l_discount)) AS avg_sales FROM region r JOIN nation n ON r.r_regionkey = n.n_regionkey JOIN supplier s ON n.n_nationkey = s.s_nationkey JOIN partsupp ps ON s.s_suppkey = ps.ps_suppkey JOIN part p ON ps.ps_partkey = p.p_partkey AND p.p_brand = 'Brand#32' JOIN lineitem l ON p.p_partkey = l.l_partkey AND ps.ps_suppkey = l.l_suppkey JOIN orders o ON l.l_orderkey = o.o_orderkey WHERE o.o_orderdate >= '2020-01-01' AND o.o_orderdate <= '2020-12-31' AND l.l_shipinstruct = 'DELIVER IN PERSON' GROUP BY r.r_name ORDER BY total_sales DESC;
SELECT r.r_name AS region, c.c_mktsegment AS market_segment, COUNT(DISTINCT c.c_custkey) AS number_of_customers, AVG(l.l_extendedprice * (1 - l.l_discount)) AS avg_spending_per_order, SUM(l.l_quantity) AS total_parts_ordered, AVG(p.p_retailprice) AS avg_part_retail_price FROM region r JOIN customer c ON r.r_regionkey = c.c_nationkey JOIN lineitem l ON c.c_custkey = l.l_suppkey JOIN part p ON l.l_partkey = p.p_partkey WHERE p.p_size = 35 AND l.l_shipdate BETWEEN '1995-01-01' AND '1996-12-31' AND c.c_mktsegment IN ('HOUSEHOLD', 'BUILDING', 'MACHINERY') GROUP BY r.r_name, c.c_mktsegment ORDER BY r.r_name, c.c_mktsegment;
SELECT n.n_name AS nation, EXTRACT(YEAR FROM l.l_shipdate) AS ship_year, COUNT(*) AS total_orders, SUM(l.l_extendedprice) AS total_revenue, SUM(l.l_extendedprice * (1 - l.l_discount)) AS revenue_after_discount, AVG(l.l_quantity) AS avg_quantity, AVG(l.l_extendedprice) AS avg_price, AVG(l.l_discount) AS avg_discount FROM nation n JOIN supplier s ON n.n_nationkey = s.s_nationkey JOIN lineitem l ON s.s_suppkey = l.l_suppkey WHERE l.l_returnflag IN ('A', 'N') AND l.l_discount BETWEEN 0.04 AND 0.09 AND s.s_acctbal BETWEEN -452.51 AND 2658.57 AND n.n_nationkey IN (3, 23, 17, 9, 21, 11) GROUP BY nation, ship_year ORDER BY nation, ship_year DESC;
SELECT r.r_name AS region_name, p.p_type AS part_type, AVG(p.p_retailprice) AS avg_retail_price, SUM(li.l_quantity) AS total_quantity_sold, COUNT(DISTINCT li.l_orderkey) AS number_of_orders, SUM(li.l_extendedprice * (1 - li.l_discount) * (1 + li.l_tax)) AS total_sales_value FROM region r JOIN partsupp ps ON r.r_regionkey = ps.ps_suppkey JOIN part p ON ps.ps_partkey = p.p_partkey JOIN lineitem li ON p.p_partkey = li.l_partkey AND ps.ps_suppkey = li.l_suppkey WHERE r.r_name IN ('MIDDLE EAST', 'ASIA', 'EUROPE', 'AMERICA', 'AFRICA') AND li.l_shipmode = 'REG AIR' AND li.l_shipdate BETWEEN '2021-01-01' AND '2021-12-31' GROUP BY r.r_name, p.p_type ORDER BY total_sales_value DESC, avg_retail_price DESC LIMIT 100;
SELECT r.r_name AS region_name, s.s_name AS supplier_name, COUNT(l.l_orderkey) AS number_of_orders, SUM(l.l_quantity) AS total_quantity, AVG(l.l_extendedprice * (1 - l_discount)) AS average_discounted_price, SUM(l.l_extendedprice * (1 - l_discount) * (1 + l_tax)) AS total_revenue FROM region r JOIN supplier s ON r.r_regionkey = s.s_nationkey JOIN lineitem l ON s.s_suppkey = l.l_suppkey WHERE r.r_name = 'EUROPE' AND l.l_shipmode IN ('REG AIR', 'AIR', 'FOB', 'MAIL', 'RAIL') GROUP BY r.r_name, s.s_name ORDER BY total_revenue DESC;
SELECT n.n_name AS nation_name, c.c_mktsegment AS market_segment, COUNT(o.o_orderkey) AS total_orders, SUM(o.o_totalprice) AS total_sales_volume, AVG(o.o_totalprice) AS average_order_value FROM orders o JOIN customer c ON o.o_custkey = c.c_custkey JOIN nation n ON c.c_nationkey = n.n_nationkey WHERE o.o_orderstatus = 'F' GROUP BY nation_name, market_segment ORDER BY total_sales_volume DESC, nation_name, market_segment;
SELECT r.r_name AS region, COUNT(DISTINCT s.s_suppkey) AS total_suppliers, COUNT(DISTINCT c.c_custkey) AS total_customers, AVG(p.p_retailprice) AS average_part_price, SUM(l.l_extendedprice * (1 - l.l_discount)) AS revenue FROM region r JOIN nation n ON r.r_regionkey = n.n_regionkey JOIN supplier s ON n.n_nationkey = s.s_nationkey JOIN customer c ON n.n_nationkey = c.c_nationkey JOIN partsupp ps ON s.s_suppkey = ps.ps_suppkey JOIN part p ON ps.ps_partkey = p.p_partkey JOIN lineitem l ON p.p_partkey = l.l_partkey AND s.s_suppkey = l.l_suppkey JOIN orders o ON l.l_orderkey = o.o_orderkey AND c.c_custkey = o.o_custkey WHERE r.r_name IN ('EUROPE', 'ASIA') AND o.o_orderdate >= DATE '2020-01-01' AND o.o_orderdate < DATE '2020-01-01' + INTERVAL '1' YEAR GROUP BY r.r_name ORDER BY revenue DESC;
SELECT r.r_name AS region_name, n.n_name AS nation_name, EXTRACT(YEAR FROM o.o_orderdate) AS order_year, COUNT(DISTINCT o.o_orderkey) AS number_of_orders, SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_sales_volume, AVG(l.l_discount) AS average_discount FROM region r JOIN nation n ON r.r_regionkey = n.n_regionkey JOIN customer c ON n.n_nationkey = c.c_nationkey JOIN orders o ON c.c_custkey = o.o_custkey JOIN lineitem l ON o.o_orderkey = l.l_orderkey WHERE r.r_name IN ('AFRICA', 'EUROPE', 'ASIA') AND o.o_orderpriority = '2-HIGH' GROUP BY region_name, nation_name, order_year ORDER BY region_name, nation_name, order_year;
SELECT r.r_name AS region_name, EXTRACT(YEAR FROM o.o_orderdate) AS order_year, COUNT(DISTINCT o.o_orderkey) AS number_of_orders, SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_sales, AVG(l.l_discount) AS average_discount, AVG(l.l_quantity) AS average_quantity FROM region r JOIN nation n ON r.r_regionkey = n.n_regionkey JOIN customer c ON n.n_nationkey = c.c_nationkey JOIN orders o ON c.c_custkey = o.o_custkey JOIN lineitem l ON o.o_orderkey = l.l_orderkey WHERE o.o_orderpriority = '3-MEDIUM' AND l.l_shipmode IN ('AIR', 'RAIL', 'TRUCK') GROUP BY region_name, order_year ORDER BY total_sales DESC, region_name, order_year;
SELECT s_name, p_brand, p_type, p_size, AVG(ps_supplycost) AS avg_supply_cost, SUM(l_extendedprice) AS total_sales, SUM(l_quantity) AS total_quantity_sold, COUNT(DISTINCT l_orderkey) AS number_of_orders FROM supplier JOIN partsupp ON supplier.s_suppkey = partsupp.ps_suppkey JOIN part ON partsupp.ps_partkey = part.p_partkey JOIN lineitem ON part.p_partkey = lineitem.l_partkey AND supplier.s_suppkey = lineitem.l_suppkey WHERE partsupp.ps_availqty > 4000 AND lineitem.l_shipdate BETWEEN DATE '2022-01-01' AND DATE '2022-12-31' GROUP BY s_name, p_brand, p_type, p_size ORDER BY total_sales DESC, avg_supply_cost LIMIT 10;
SELECT s_name, c_mktsegment, p_brand, p_type, SUM(ps_availqty) AS total_available_quantity, AVG(ps_supplycost) AS average_supply_cost, COUNT(DISTINCT l_orderkey) AS total_orders, SUM(l_extendedprice * (1 - l_discount)) AS total_revenue, MAX(o_totalprice) AS max_order_total_price FROM supplier JOIN partsupp ON s_suppkey = ps_suppkey JOIN part ON ps_partkey = p_partkey JOIN lineitem ON l_partkey = p_partkey AND l_suppkey = s_suppkey JOIN orders ON l_orderkey = o_orderkey JOIN customer ON o_custkey = c_custkey AND s_nationkey = c_nationkey WHERE l_shipmode = 'RAIL' AND c_nationkey IN (21, 0, 17, 23, 14) AND (o_comment LIKE '%unusual%' OR o_comment LIKE '%final%') GROUP BY s_name, c_mktsegment, p_brand, p_type ORDER BY total_revenue DESC, total_available_quantity DESC LIMIT 10;
SELECT n_name AS nation_name, p_type, COUNT(*) AS total_orders, SUM(l_quantity) AS total_quantity, AVG(l_extendedprice) AS average_extended_price, SUM(l_extendedprice * (1 - l_discount)) AS total_revenue, AVG(l_discount) AS average_discount FROM nation JOIN supplier ON nation.n_nationkey = supplier.s_nationkey JOIN lineitem ON supplier.s_suppkey = lineitem.l_suppkey JOIN part ON lineitem.l_partkey = part.p_partkey GROUP BY nation_name, p_type ORDER BY total_revenue DESC, nation_name;
SELECT r_name AS region, n_name AS nation, c_mktsegment AS market_segment, SUM(s_acctbal) AS total_supplier_balance, AVG(c_acctbal) AS avg_customer_balance, COUNT(DISTINCT s_suppkey) AS number_of_suppliers, COUNT(DISTINCT c_custkey) AS number_of_customers, SUM(ps_availqty) AS total_available_quantity, AVG(l_discount) AS avg_lineitem_discount, SUM(l_extendedprice) AS total_revenue, SUM(l_extendedprice * (1 - l_discount)) AS total_discounted_revenue FROM region JOIN nation ON r_regionkey = n_regionkey JOIN supplier ON n_nationkey = s_nationkey JOIN customer ON n_nationkey = c_nationkey JOIN partsupp ON s_suppkey = ps_suppkey JOIN lineitem ON ps_partkey = l_partkey AND ps_suppkey = l_suppkey WHERE l_shipdate >= date '2022-01-01' AND l_shipdate < date '2022-01-01' + interval '1 year' AND l_discount BETWEEN 0.02 AND 0.05 GROUP BY region, nation, market_segment ORDER BY total_discounted_revenue DESC, total_supplier_balance DESC, avg_customer_balance;
SELECT r.r_name AS region, COUNT(DISTINCT c.c_custkey) AS number_of_customers, AVG(c.c_acctbal) AS average_account_balance, SUM(ps.ps_availqty) AS total_available_parts, SUM(o.o_totalprice) AS total_order_value, COUNT(DISTINCT o.o_orderkey) AS number_of_orders FROM customer c JOIN region r ON c.c_nationkey = r.r_regionkey JOIN orders o ON c.c_custkey = o.o_custkey JOIN partsupp ps ON ps.ps_suppkey = c.c_custkey WHERE c.c_comment LIKE '%accounts%' AND o.o_orderstatus IN ('F', 'O', 'P') AND o.o_orderdate BETWEEN '2022-01-01' AND '2022-12-31' GROUP BY r.r_name ORDER BY total_order_value DESC, region;
SELECT r_name AS region, n_name AS nation, COUNT(DISTINCT s_suppkey) AS number_of_suppliers, COUNT(DISTINCT c_custkey) AS number_of_customers, SUM(l_extendedprice * (1 - l_discount)) AS total_sales, AVG(l_quantity) AS avg_quantity_sold, AVG(p_retailprice) AS avg_part_retail_price FROM region JOIN nation ON r_regionkey = n_regionkey JOIN supplier ON n_nationkey = s_nationkey JOIN customer ON n_nationkey = c_nationkey JOIN orders ON c_custkey = o_custkey JOIN lineitem ON o_orderkey = l_orderkey JOIN part ON l_partkey = p_partkey JOIN partsupp ON p_partkey = ps_partkey AND s_suppkey = ps_suppkey WHERE n_name IN ('JAPAN', 'PERU', 'KENYA', 'CHINA', 'FRANCE', 'UNITED KINGDOM') AND l_shipdate BETWEEN '2022-01-01' AND '2022-12-31' GROUP BY r_name, n_name ORDER BY total_sales DESC;
SELECT r_name AS region_name, p_type AS part_type, COUNT(DISTINCT s_suppkey) AS number_of_suppliers, SUM(ps_availqty) AS total_available_quantity, AVG(l_extendedprice * (1 - l_discount)) AS average_discounted_price, SUM(l_quantity) AS total_quantity_ordered FROM region JOIN supplier ON region.r_regionkey = supplier.s_nationkey JOIN partsupp ON supplier.s_suppkey = partsupp.ps_suppkey JOIN part ON partsupp.ps_partkey = part.p_partkey JOIN lineitem ON part.p_partkey = lineitem.l_partkey JOIN orders ON lineitem.l_orderkey = orders.o_orderkey WHERE r_name IN ('AMERICA', 'ASIA') AND l_shipdate BETWEEN '1995-01-01' AND '1995-12-31' GROUP BY region_name, part_type ORDER BY average_discounted_price DESC, total_quantity_ordered DESC;
SELECT r.r_name AS region_name, n.n_name AS nation_name, COUNT(DISTINCT s.s_suppkey) AS number_of_suppliers, COUNT(DISTINCT c.c_custkey) AS number_of_customers, SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_sales_value, AVG(l.l_quantity) AS average_quantity_sold, AVG(ps.ps_supplycost) AS average_supply_cost FROM region r JOIN nation n ON r.r_regionkey = n.n_regionkey JOIN supplier s ON n.n_nationkey = s.s_nationkey JOIN customer c ON n.n_nationkey = c.c_nationkey JOIN partsupp ps ON s.s_suppkey = ps.ps_suppkey JOIN lineitem l ON ps.ps_partkey = l.l_partkey AND ps.ps_suppkey = l.l_suppkey WHERE r.r_name IN ('MIDDLE EAST', 'ASIA', 'EUROPE', 'AMERICA', 'AFRICA') AND l.l_shipdate BETWEEN '1992-01-01' AND '1994-12-31' AND l.l_returnflag = 'N' GROUP BY region_name, nation_name ORDER BY total_sales_value DESC;
SELECT c.c_mktsegment AS customer_segment, EXTRACT(YEAR FROM l.l_shipdate) AS year_shipped, SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_revenue, AVG(l.l_discount) AS average_discount, COUNT(DISTINCT l.l_orderkey) AS number_of_orders FROM customer AS c JOIN lineitem AS l ON c.c_custkey = l.l_suppkey JOIN part AS p ON l.l_partkey = p.p_partkey JOIN partsupp AS ps ON l.l_partkey = ps.ps_partkey AND l.l_suppkey = ps.ps_suppkey WHERE p.p_container IN ('LG BAG', 'JUMBO DRUM', 'MED JAR', 'WRAP PKG', 'LG PKG', 'MED BAG') AND p.p_brand IN ('Brand#11', 'Brand#31', 'Brand#45', 'Brand#43', 'Brand#13') GROUP BY customer_segment, year_shipped ORDER BY customer_segment, year_shipped;
SELECT n.n_name, COUNT(o.o_orderkey) AS total_orders, SUM(o.o_totalprice) AS total_revenue, AVG(c.c_acctbal) AS average_account_balance, COUNT(DISTINCT c.c_custkey) AS unique_customers FROM nation AS n JOIN customer AS c ON n.n_nationkey = c.c_nationkey JOIN orders AS o ON c.c_custkey = o.o_custkey WHERE n.n_nationkey IN (24, 17, 2, 18, 11) AND o.o_orderstatus = 'P' GROUP BY n.n_name ORDER BY total_revenue DESC;
SELECT s_nationkey, COUNT(DISTINCT s_suppkey) AS total_suppliers, AVG(s_acctbal) AS average_balance, SUM(o_totalprice) AS total_order_value, COUNT(DISTINCT o_orderkey) AS total_orders, p_brand, AVG(p_retailprice) AS average_retail_price, COUNT(DISTINCT p_partkey) AS total_parts FROM supplier JOIN orders ON s_suppkey = o_custkey JOIN part ON p_size = s_nationkey WHERE o_orderstatus IN ('F', 'O') AND s_phone LIKE '25-349-496-8423%' GROUP BY s_nationkey, p_brand ORDER BY total_order_value DESC, average_balance DESC;
SELECT r.r_name AS region, n.n_name AS nation, COUNT(DISTINCT s.s_suppkey) AS num_suppliers, COUNT(DISTINCT p.p_partkey) AS num_parts, SUM(ps.ps_availqty) AS total_avail_qty, AVG(ps.ps_supplycost) AS avg_supply_cost, SUM(l.l_extendedprice * (1 - l_discount)) AS total_revenue, AVG(l.l_quantity) AS avg_quantity_sold, COUNT(DISTINCT o.o_orderkey) AS num_orders FROM region r JOIN nation n ON r.r_regionkey = n.n_regionkey JOIN supplier s ON n.n_nationkey = s.s_nationkey JOIN partsupp ps ON s.s_suppkey = ps.ps_suppkey JOIN part p ON ps.ps_partkey = p.p_partkey JOIN lineitem l ON ps.ps_partkey = l.l_partkey AND ps.ps_suppkey = l.l_suppkey JOIN orders o ON l.l_orderkey = o.o_orderkey WHERE o.o_orderdate BETWEEN date '1995-01-01' AND date '1995-12-31' AND l.l_shipdate <= date '1996-01-01' GROUP BY region, nation ORDER BY total_revenue DESC, region, nation;
SELECT r.r_name AS region, c.c_mktsegment AS market_segment, COUNT(DISTINCT c.c_custkey) AS number_of_customers, SUM(l_extendedprice) AS total_sales, AVG(l_quantity) AS average_quantity_sold, SUM(l_extendedprice * (1 - l_discount)) AS revenue_after_discount FROM customer c JOIN region r ON c.c_nationkey = r.r_regionkey JOIN lineitem l ON l_suppkey IN ( SELECT s_suppkey FROM supplier s WHERE s.s_nationkey = c.c_nationkey ) WHERE c.c_mktsegment IN ('HOUSEHOLD', 'AUTOMOBILE', 'BUILDING', 'MACHINERY', 'FURNITURE') AND l.l_shipdate BETWEEN date '2022-01-01' AND date '2022-12-31' GROUP BY r.r_name, c.c_mktsegment ORDER BY total_sales DESC;
SELECT c.c_mktsegment, p.p_brand, SUM(l.l_extendedprice * (1 - l.l_discount)) AS revenue, AVG(l.l_quantity) AS avg_quantity, COUNT(DISTINCT c.c_custkey) AS num_customers FROM customer c JOIN lineitem l ON c.c_custkey = l.l_suppkey JOIN part p ON l.l_partkey = p.p_partkey JOIN partsupp ps ON l.l_partkey = ps.ps_partkey AND l.l_suppkey = ps.ps_suppkey WHERE l.l_shipdate >= DATE '1996-06-01' AND l.l_shipdate < DATE '1996-06-01' + INTERVAL '1' YEAR AND p.p_retailprice BETWEEN 1000.09 AND 1796.89 AND p.p_comment LIKE '%quickly%' GROUP BY c.c_mktsegment, p.p_brand ORDER BY revenue DESC, c.c_mktsegment, p.p_brand;
SELECT s.s_nationkey, COUNT(DISTINCT s.s_suppkey) AS number_of_suppliers, COUNT(DISTINCT p.p_partkey) AS number_of_parts, AVG(ps.ps_supplycost) AS average_supply_cost, SUM(ps.ps_availqty) AS total_available_quantity, AVG(o.o_totalprice) AS average_order_total, COUNT(DISTINCT o.o_orderkey) AS number_of_orders FROM supplier s JOIN partsupp ps ON s.s_suppkey = ps.ps_suppkey JOIN part p ON ps.ps_partkey = p.p_partkey JOIN orders o ON s.s_nationkey = o.o_custkey WHERE s.s_nationkey IN (23, 14, 11) AND o.o_orderstatus = 'F' GROUP BY s.s_nationkey ORDER BY average_order_total DESC;
SELECT r_name AS region_name, p_brand, AVG(p_retailprice) AS avg_retail_price, SUM(l_quantity) AS total_quantity_sold, SUM(l_extendedprice * (1 - l_discount)) AS total_revenue, COUNT(DISTINCT l_orderkey) AS number_of_orders FROM region JOIN partsupp ON ps_suppkey::text LIKE r_regionkey::text || '%' JOIN part ON p_partkey = ps_partkey JOIN lineitem ON l_partkey = p_partkey AND l_suppkey = ps_suppkey WHERE r_name = 'EUROPE' AND l_shipdate BETWEEN '2020-01-01' AND '2020-12-31' GROUP BY r_name, p_brand ORDER BY total_revenue DESC, avg_retail_price DESC LIMIT 10;
SELECT r_name AS region, n_name AS nation, COUNT(DISTINCT c_custkey) AS total_customers, COUNT(DISTINCT s_suppkey) AS total_suppliers, SUM(l_extendedprice * (1 - l_discount)) AS total_sales_volume, AVG(l_quantity) AS average_quantity_sold FROM region JOIN nation ON r_regionkey = n_regionkey JOIN customer ON n_nationkey = c_nationkey JOIN orders ON c_custkey = o_custkey JOIN lineitem ON o_orderkey = l_orderkey JOIN supplier ON s_nationkey = n_nationkey WHERE o_orderstatus = 'F' AND l_shipdate >= DATE '2022-01-01' AND l_shipdate < DATE '2022-01-01' + INTERVAL '1 YEAR' GROUP BY region, nation ORDER BY total_sales_volume DESC, region, nation;
SELECT r_name AS region, COUNT(DISTINCT c_custkey) AS num_customers, COUNT(DISTINCT o_orderkey) AS num_orders, ROUND(AVG(c_acctbal), 2) AS avg_customer_acctbal, ROUND(SUM(l_extendedprice * (1 - l_discount)), 2) AS total_revenue, ROUND(AVG(l_extendedprice * (1 - l_discount)), 2) AS avg_order_value FROM region JOIN nation ON r_regionkey = n_regionkey JOIN customer ON n_nationkey = c_nationkey JOIN orders ON c_custkey = o_custkey JOIN lineitem ON o_orderkey = l_orderkey WHERE EXTRACT(ISODOW FROM o_orderdate) < 6 AND c_acctbal > ( SELECT AVG(c_acctbal) FROM customer WHERE c_acctbal > 0 ) GROUP BY r_name ORDER BY total_revenue DESC;
SELECT r_name AS region, n_name AS nation, COUNT(DISTINCT c_custkey) AS number_of_customers, AVG(c_acctbal) AS average_account_balance, SUM(l_extendedprice * (1 - l_discount)) AS revenue, AVG(l_quantity) AS average_quantity_sold FROM region JOIN nation ON r_regionkey = n_regionkey JOIN customer ON n_nationkey = c_nationkey JOIN orders ON c_custkey = o_custkey JOIN lineitem ON o_orderkey = l_orderkey JOIN part ON l_partkey = p_partkey WHERE n_name IN ('CANADA', 'UNITED KINGDOM', 'PERU', 'IRAN') AND r_comment LIKE 'ges. thinly even pinto beans ca%' AND c_nationkey IN (2, 12, 8) AND p_size IN (43, 45, 28) AND p_brand NOT IN ('Brand#32', 'Brand#45') AND l_shipdate BETWEEN '1995-01-01' AND '1995-12-31' GROUP BY region, nation ORDER BY revenue DESC, region, nation;
SELECT r.r_name AS region_name, COUNT(DISTINCT s.s_suppkey) AS number_of_suppliers, SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_sales, AVG(l.l_discount) AS average_discount FROM region r JOIN nation n ON r.r_regionkey = n.n_regionkey JOIN supplier s ON n.n_nationkey = s.s_nationkey JOIN lineitem l ON s.s_suppkey = l.l_suppkey JOIN orders o ON l.l_orderkey = o.o_orderkey WHERE o.o_orderpriority = '1-URGENT' GROUP BY r.r_name ORDER BY total_sales DESC;
SELECT r_name AS region, COUNT(DISTINCT s_suppkey) AS num_suppliers, COUNT(DISTINCT c_custkey) AS num_customers, COUNT(DISTINCT o_orderkey) AS num_orders, SUM(o_totalprice) AS total_sales, AVG(s_acctbal) AS avg_supplier_acctbal, AVG(c_acctbal) AS avg_customer_acctbal, AVG(p_retailprice) AS avg_part_retailprice, SUM(ps_availqty) AS total_parts_availqty, SUM(ps_supplycost * ps_availqty) AS total_parts_value FROM region JOIN supplier ON s_nationkey = r_regionkey JOIN customer ON c_nationkey = r_regionkey JOIN orders ON o_custkey = c_custkey JOIN partsupp ON ps_suppkey = s_suppkey JOIN part ON p_partkey = ps_partkey WHERE p_mfgr = 'Manufacturer#3' AND (s_acctbal BETWEEN 500 AND 10000) AND c_mktsegment = 'AUTOMOBILE' AND o_orderstatus = 'F' AND (p_comment LIKE '%uests. a%' OR p_comment LIKE '%old asymptotes%' OR p_comment LIKE '%y. express reques%' OR p_comment LIKE '%pending requests aft%') GROUP BY r_name ORDER BY total_sales DESC, avg_supplier_acctbal DESC;
SELECT r.r_name AS region_name, p.p_brand AS brand, p.p_type AS product_type, AVG(p.p_retailprice) AS average_retail_price, SUM(ps.ps_availqty) AS total_available_quantity, AVG(ps.ps_supplycost) AS average_supply_cost, COUNT(DISTINCT p.p_partkey) AS unique_parts_count FROM region r JOIN partsupp ps ON ps.ps_suppkey = r.r_regionkey JOIN part p ON ps.ps_partkey = p.p_partkey GROUP BY r.r_name, p.p_brand, p.p_type ORDER BY r.r_name, p.p_brand, p.p_type;
SELECT s.s_name AS supplier_name, n.n_name AS nation_name, COUNT(DISTINCT p.p_partkey) AS distinct_parts_count, AVG(l.l_extendedprice * (1 - l.l_discount)) AS avg_discounted_revenue FROM supplier s JOIN nation n ON s.s_nationkey = n.n_nationkey JOIN lineitem l ON s.s_suppkey = l.l_suppkey JOIN part p ON l.l_partkey = p.p_partkey WHERE p.p_brand IN ('Brand#45', 'Brand#33', 'Brand#25') GROUP BY s.s_suppkey, s.s_name, n.n_name ORDER BY avg_discounted_revenue DESC, s.s_name;
SELECT r.r_name AS region_name, n.n_name AS nation_name, c.c_mktsegment AS market_segment, COUNT(DISTINCT o.o_orderkey) AS order_count, AVG(c.c_acctbal) AS avg_customer_acct_balance, SUM(o.o_totalprice) AS total_order_value FROM region r JOIN nation n ON r.r_regionkey = n.n_regionkey JOIN customer c ON n.n_nationkey = c.c_nationkey JOIN orders o ON c.c_custkey = o.o_custkey GROUP BY r.r_name, n.n_name, c.c_mktsegment ORDER BY r.r_name, n.n_name, c.c_mktsegment, total_order_value DESC;
SELECT r_name AS region, n_name AS nation, COUNT(DISTINCT s_suppkey) AS total_suppliers, COUNT(DISTINCT c_custkey) AS total_customers, ROUND(AVG(s_acctbal), 2) AS avg_supplier_acctbal, ROUND(AVG(c_acctbal), 2) AS avg_customer_acctbal, SUM(ps_availqty) AS total_avail_qty, ROUND(SUM(l_extendedprice * (1 - l_discount)), 2) AS total_revenue, ROUND(SUM(CASE WHEN l_returnflag = 'R' THEN l_extendedprice * (1 - l_discount) ELSE 0 END), 2) AS returned_revenue FROM region JOIN nation ON region.r_regionkey = nation.n_regionkey JOIN supplier ON nation.n_nationkey = supplier.s_nationkey JOIN customer ON nation.n_nationkey = customer.c_nationkey JOIN partsupp ON supplier.s_suppkey = partsupp.ps_suppkey JOIN lineitem ON partsupp.ps_partkey = lineitem.l_partkey AND partsupp.ps_suppkey = lineitem.l_suppkey JOIN orders ON lineitem.l_orderkey = orders.o_orderkey AND customer.c_custkey = orders.o_custkey GROUP BY region, nation ORDER BY total_revenue DESC;
SELECT r.r_name AS region, c.c_mktsegment AS market_segment, COUNT(DISTINCT c.c_custkey) AS customer_count, SUM(c.c_acctbal) AS total_account_balance, AVG(c.c_acctbal) AS average_account_balance, SUM(ps.ps_availqty) AS total_available_quantity, AVG(ps.ps_supplycost) AS average_supply_cost, SUM(ps.ps_supplycost * ps.ps_availqty) AS total_value_of_supplies FROM customer c JOIN region r ON c.c_nationkey = r.r_regionkey JOIN partsupp ps ON c.c_custkey = ps.ps_suppkey GROUP BY r.r_name, c.c_mktsegment ORDER BY r.r_name, c.c_mktsegment;
SELECT n.n_name AS Nation, c.c_mktsegment AS MarketSegment, COUNT(DISTINCT c.c_custkey) AS NumberOfCustomers, SUM(l.l_quantity) AS TotalQuantityPurchased, AVG(l.l_extendedprice * (1 - l.l_discount)) AS AvgPurchaseSizeAfterDiscount, SUM(l.l_extendedprice * (1 - l.l_discount)) AS TotalValueAfterDiscount FROM customer c JOIN nation n ON c.c_nationkey = n.n_nationkey JOIN lineitem l ON c.c_custkey = l.l_orderkey JOIN partsupp ps ON l.l_partkey = ps.ps_partkey AND l.l_suppkey = ps.ps_suppkey WHERE c.c_acctbal > 0 AND l.l_discount BETWEEN 0.01 AND 0.09 AND l.l_tax BETWEEN 0.01 AND 0.07 AND ps.ps_availqty IN (1315, 850, 8293, 6212, 2536) GROUP BY Nation, MarketSegment ORDER BY TotalValueAfterDiscount DESC, NumberOfCustomers DESC;
SELECT r.r_name AS region_name, COUNT(li.l_orderkey) AS lineitem_count, SUM(li.l_extendedprice * (1 - li.l_discount)) AS total_revenue, AVG(li.l_quantity) AS average_quantity FROM region r JOIN supplier s ON r.r_regionkey = s.s_nationkey JOIN lineitem li ON s.s_suppkey = li.l_suppkey JOIN part p ON li.l_partkey = p.p_partkey JOIN orders o ON li.l_orderkey = o.o_orderkey WHERE p.p_size = 5 AND p.p_container = 'WRAP CAN' AND o.o_orderstatus IN ('F', 'O') AND o.o_totalprice >= 85505.69 GROUP BY r.r_name ORDER BY total_revenue DESC, region_name;
SELECT c.c_mktsegment, p.p_brand, AVG(p.p_retailprice) AS avg_retail_price, SUM(ps.ps_availqty) AS total_avail_qty, COUNT(DISTINCT s.s_suppkey) AS num_suppliers, COUNT(DISTINCT c.c_custkey) AS num_customers FROM customer c JOIN partsupp ps ON c.c_nationkey = ps.ps_suppkey JOIN part p ON ps.ps_partkey = p.p_partkey JOIN supplier s ON ps.ps_suppkey = s.s_suppkey WHERE p.p_size = 21 AND ps.ps_supplycost BETWEEN 632.14 AND 636.79 AND s.s_phone IN ('27-159-277-1309', '10-733-472-3950') GROUP BY c.c_mktsegment, p.p_brand ORDER BY avg_retail_price DESC, total_avail_qty DESC;
SELECT r.r_name AS region, c.c_mktsegment AS market_segment, COUNT(DISTINCT o.o_orderkey) AS total_orders, SUM(l.l_quantity) AS total_quantity_sold, SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_revenue FROM region r JOIN nation n ON r.r_regionkey = n.n_regionkey JOIN customer c ON n.n_nationkey = c.c_nationkey JOIN orders o ON c.c_custkey = o.o_custkey AND o.o_orderstatus = 'F' JOIN lineitem l ON o.o_orderkey = l.l_orderkey WHERE o.o_orderdate >= DATE '2022-10-01' AND o.o_orderdate < DATE '2023-01-01' GROUP BY r.r_name, c.c_mktsegment ORDER BY r.r_name, total_revenue DESC;
SELECT r.r_name AS region_name, n.n_name AS nation_name, SUM(s.s_acctbal) AS total_balance, AVG(ps.ps_supplycost) AS avg_supply_cost, COUNT(DISTINCT s.s_suppkey) AS num_suppliers, SUM(l.l_quantity) AS total_quantity_ordered, AVG(l.l_extendedprice * (1 - l.l_discount)) AS avg_discounted_price FROM region r JOIN nation n ON r.r_regionkey = n.n_regionkey JOIN supplier s ON n.n_nationkey = s.s_nationkey JOIN partsupp ps ON s.s_suppkey = ps.ps_suppkey JOIN lineitem l ON ps.ps_partkey = l.l_partkey AND ps.ps_suppkey = l.l_suppkey WHERE r.r_name IN ('EUROPE', 'ASIA') AND l.l_returnflag = 'N' AND l.l_linestatus = 'O' AND l.l_shipdate >= date '1995-01-01' AND l.l_shipdate < date '1996-01-01' GROUP BY r.r_name, n.n_name ORDER BY region_name, total_balance DESC;
SELECT n.n_name AS nation, c.c_mktsegment AS market_segment, EXTRACT(YEAR FROM o.o_orderdate) AS order_year, COUNT(*) AS total_orders, SUM(o.o_totalprice) AS total_revenue, AVG(o.o_totalprice) AS avg_order_value FROM customer AS c JOIN orders AS o ON c.c_custkey = o.o_custkey JOIN nation AS n ON c.c_nationkey = n.n_nationkey GROUP BY nation, market_segment, order_year ORDER BY nation, market_segment, order_year;
SELECT r.r_name AS region, n.n_name AS nation, COUNT(s.s_suppkey) AS number_of_suppliers, AVG(s.s_acctbal) AS average_account_balance, SUM(ps.ps_availqty) AS total_available_quantity, AVG(ps.ps_supplycost) AS average_supply_cost FROM region r JOIN nation n ON n.n_regionkey = r.r_regionkey JOIN supplier s ON s.s_nationkey = n.n_nationkey JOIN partsupp ps ON ps.ps_suppkey = s.s_suppkey GROUP BY r.r_name, n.n_name ORDER BY region, nation;
SELECT r_name AS region, n_name AS nation, COUNT(DISTINCT ps_partkey) AS num_parts, SUM(ps_availqty) AS total_available_quantity, AVG(ps_supplycost) AS average_supply_cost, SUM(ps_supplycost * ps_availqty) AS total_value FROM partsupp JOIN nation ON partsupp.ps_suppkey = nation.n_nationkey JOIN region ON nation.n_regionkey = region.r_regionkey GROUP BY region, nation ORDER BY total_value DESC;
SELECT r_name AS region, n_name AS nation, COUNT(DISTINCT s_suppkey) AS total_suppliers, COUNT(DISTINCT c_custkey) AS total_customers, AVG(s_acctbal) AS avg_supplier_acctbal, AVG(c_acctbal) AS avg_customer_acctbal, SUM(l_extendedprice * (1 - l_discount)) AS total_sales_volume, SUM(CASE WHEN l_returnflag = 'R' THEN l_extendedprice * (1 - l_discount) ELSE 0 END) AS total_returned_volume, COUNT(DISTINCT o_orderkey) AS total_orders FROM region JOIN nation ON r_regionkey = n_regionkey JOIN supplier ON s_nationkey = n_nationkey JOIN customer ON c_nationkey = n_nationkey JOIN lineitem ON s_suppkey = l_suppkey JOIN orders ON o_orderkey = l_orderkey AND o_custkey = c_custkey GROUP BY region, nation ORDER BY total_sales_volume DESC;
SELECT c.c_name, c.c_acctbal, SUM(l.l_quantity) AS total_quantity, AVG(l.l_extendedprice) AS avg_price, COUNT(DISTINCT p.p_partkey) AS num_parts_bought FROM customer c JOIN lineitem l ON c.c_custkey = (l.l_orderkey / 10000)::int JOIN part p ON l.l_partkey = p.p_partkey JOIN partsupp ps ON p.p_partkey = ps.ps_partkey AND l.l_suppkey = ps.ps_suppkey JOIN supplier s ON ps.ps_suppkey = s.s_suppkey WHERE c.c_nationkey IN (4, 9, 3, 1) AND p.p_brand IN ('Brand#44', 'Brand#15', 'Brand#51', 'Brand#24', 'Brand#12', 'Brand#55') AND p.p_size IN (30, 23, 37, 42, 34, 16) AND l.l_shipdate BETWEEN '1995-01-01' AND '1996-12-31' AND ps.ps_comment LIKE 'furiously against the instructions. furiously fi%' GROUP BY c.c_name, c.c_acctbal ORDER BY total_quantity DESC, avg_price DESC LIMIT 10;
SELECT r.r_name AS region_name, count(DISTINCT c.c_custkey) AS number_of_customers, sum(p.ps_availqty) AS total_available_quantity, sum(l.l_extendedprice * (1 - l.l_discount)) AS total_sales, avg(l.l_quantity) AS average_quantity_sold FROM region r JOIN customer c ON r.r_regionkey = c.c_nationkey JOIN partsupp p ON c.c_custkey = p.ps_suppkey JOIN lineitem l ON p.ps_partkey = l.l_partkey AND p.ps_suppkey = l.l_suppkey WHERE l.l_shipdate BETWEEN '2022-01-01' AND '2022-12-31' AND p.ps_suppkey IN (121057, 180897) GROUP BY region_name ORDER BY total_sales DESC;
SELECT r.r_name AS region, p.p_type AS part_type, AVG(l.l_discount) AS average_discount, COUNT(*) AS number_of_orders, SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_revenue FROM region r JOIN nation n ON r.r_regionkey = n.n_regionkey JOIN partsupp ps ON n.n_nationkey = ps.ps_suppkey JOIN part p ON ps.ps_partkey = p.p_partkey JOIN lineitem l ON p.p_partkey = l.l_partkey WHERE l.l_shipdate > '1995-12-31' AND p.p_brand IN ('Brand#35', 'Brand#54', 'Brand#34', 'Brand#33', 'Brand#21') GROUP BY region, part_type HAVING COUNT(*) > 5 ORDER BY region, average_discount DESC;
SELECT r.r_name AS region, COUNT(DISTINCT s.s_suppkey) AS number_of_suppliers, COUNT(DISTINCT o.o_orderkey) AS number_of_orders, AVG(s.s_acctbal) AS average_account_balance, SUM(p.ps_availqty) AS total_parts_available, AVG(p.ps_supplycost) AS average_supply_cost, SUM(o.o_totalprice) AS total_order_value, AVG(o.o_totalprice) AS average_order_value FROM region r JOIN supplier s ON s.s_nationkey = r.r_regionkey JOIN partsupp p ON p.ps_suppkey = s.s_suppkey JOIN orders o ON o.o_custkey = s.s_nationkey WHERE r.r_name IN ('ASIA', 'EUROPE', 'AMERICA') AND o.o_orderstatus IN ('F', 'O', 'P') GROUP BY r.r_name ORDER BY total_order_value DESC;
SELECT n.n_name AS nation_name, COUNT(DISTINCT s.s_suppkey) AS total_suppliers, COUNT(DISTINCT p.p_partkey) AS total_parts, SUM(l.l_quantity) AS total_quantity_sold, AVG(l.l_extendedprice) AS avg_sale_price, SUM(l.l_extendedprice * (1 - l_discount)) AS total_discounted_sales_value, AVG(l.l_discount) AS avg_discount_given, COUNT(DISTINCT o.o_orderkey) AS total_orders_processed FROM nation n JOIN supplier s ON n.n_nationkey = s.s_nationkey JOIN partsupp ps ON s.s_suppkey = ps.ps_suppkey JOIN part p ON ps.ps_partkey = p.p_partkey JOIN lineitem l ON p.p_partkey = l.l_partkey AND s.s_suppkey = l.l_suppkey JOIN orders o ON l.l_orderkey = o.o_orderkey WHERE o.o_orderdate BETWEEN '2022-01-01' AND '2022-12-31' AND l.l_shipdate > o.o_orderdate AND n.n_regionkey IN (1, 2, 3) GROUP BY n.n_name ORDER BY total_quantity_sold DESC, avg_sale_price DESC LIMIT 5;
SELECT r.r_name AS region, n.n_name AS nation, c.c_mktsegment AS market_segment, COUNT(DISTINCT c.c_custkey) AS number_of_customers, AVG(c.c_acctbal) AS average_account_balance, SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_sales_value FROM customer c JOIN nation n ON c.c_nationkey = n.n_nationkey JOIN region r ON n.n_regionkey = r.r_regionkey JOIN lineitem l ON c.c_custkey = l.l_suppkey WHERE c.c_mktsegment IN ('HOUSEHOLD', 'AUTOMOBILE', 'BUILDING', 'MACHINERY', 'FURNITURE') AND n.n_nationkey IN (21, 23, 3) AND l.l_shipdate BETWEEN '1995-01-01' AND '1995-12-31' GROUP BY region, nation, market_segment ORDER BY total_sales_value DESC, average_account_balance DESC;
SELECT s_name, c_name, COUNT(o_orderkey) AS total_orders, SUM(l_quantity) AS total_quantity, AVG(l_extendedprice) AS average_price, SUM(l_extendedprice * (1 - l_discount)) AS revenue, AVG(l_discount) AS average_discount, MAX(p_retailprice) AS max_retail_price, MIN(ps_supplycost) AS min_supply_cost FROM supplier JOIN partsupp ON supplier.s_suppkey = partsupp.ps_suppkey JOIN part ON partsupp.ps_partkey = part.p_partkey JOIN lineitem ON part.p_partkey = lineitem.l_partkey AND partsupp.ps_suppkey = lineitem.l_suppkey JOIN orders ON lineitem.l_orderkey = orders.o_orderkey JOIN customer ON orders.o_custkey = customer.c_custkey WHERE customer.c_nationkey IN (14, 21, 19, 16) AND orders.o_shippriority = 0 AND part.p_type = 'SMALL ANODIZED TIN' AND lineitem.l_quantity IN (45.00, 1.00, 36.00, 24.00, 9.00, 26.00) AND orders.o_totalprice = 138888.94 GROUP BY s_name, c_name ORDER BY revenue DESC, total_orders DESC, s_name, c_name;
SELECT n.n_name AS nation_name, COUNT(s.s_suppkey) AS number_of_suppliers, AVG(s.s_acctbal) AS average_account_balance, SUM(ps.ps_availqty) AS total_available_quantity, AVG(ps.ps_supplycost) AS average_supply_cost FROM nation AS n JOIN supplier AS s ON n.n_nationkey = s.s_nationkey JOIN partsupp AS ps ON s.s_suppkey = ps.ps_suppkey GROUP BY n.n_name ORDER BY average_account_balance DESC, nation_name;
SELECT c.c_mktsegment, COUNT(DISTINCT c.c_custkey) AS num_customers, COUNT(DISTINCT o.o_orderkey) AS num_orders, AVG(o.o_totalprice) AS avg_order_value, SUM(ps.ps_availqty) AS total_available_quantity, AVG(ps.ps_supplycost) AS avg_supply_cost FROM customer c JOIN orders o ON c.c_custkey = o.o_custkey JOIN partsupp ps ON o.o_orderkey = ps.ps_partkey WHERE o.o_orderdate BETWEEN '1994-01-01' AND '1996-12-31' AND o.o_orderstatus = 'F' GROUP BY c.c_mktsegment ORDER BY num_customers DESC, avg_order_value DESC;
SELECT r_name AS region, n_name AS nation, COUNT(DISTINCT c_custkey) AS customer_count, AVG(c_acctbal) AS avg_customer_balance, SUM(l_extendedprice * (1 - l_discount)) AS total_revenue, MAX(o_totalprice) AS max_order_value FROM region JOIN nation ON r_regionkey = n_regionkey JOIN customer ON n_nationkey = c_nationkey JOIN orders ON c_custkey = o_custkey JOIN lineitem ON o_orderkey = l_orderkey WHERE c_mktsegment = 'MACHINERY' AND o_orderpriority = '1-URGENT' AND l_shipinstruct = 'NONE' AND o_orderdate >= date '1995-01-01' AND o_orderdate < date '1995-01-01' + interval '1 year' GROUP BY region, nation ORDER BY total_revenue DESC, avg_customer_balance DESC LIMIT 10;
SELECT r_name AS region, n_name AS nation, c_mktsegment AS market_segment, COUNT(DISTINCT c_custkey) AS num_customers, SUM(l_extendedprice * (1 - l_discount)) AS revenue, AVG(l_quantity) AS avg_quantity_sold, COUNT(DISTINCT o_orderkey) AS num_orders FROM region JOIN nation ON n_regionkey = r_regionkey JOIN customer ON c_nationkey = n_nationkey JOIN orders ON o_custkey = c_custkey JOIN lineitem ON l_orderkey = o_orderkey WHERE c_mktsegment IN ('HOUSEHOLD', 'AUTOMOBILE', 'BUILDING', 'MACHINERY', 'FURNITURE') AND o_orderstatus IN ('F', 'O', 'P') AND l_shipdate BETWEEN '1995-01-01' AND '1995-12-31' GROUP BY region, nation, market_segment ORDER BY revenue DESC, region, nation, market_segment;
SELECT n_name AS nation, AVG(c_acctbal) AS avg_customer_balance, SUM(s_acctbal) AS total_supplier_balance, COUNT(DISTINCT o_orderkey) AS total_orders, SUM(l_extendedprice * (1 - l_discount)) AS revenue, AVG(p_retailprice) AS avg_part_retail_price FROM nation JOIN supplier ON n_nationkey = s_nationkey JOIN customer ON n_nationkey = c_nationkey JOIN orders ON o_custkey = c_custkey JOIN lineitem ON l_orderkey = o_orderkey JOIN part ON l_partkey = p_partkey JOIN partsupp ON ps_partkey = l_partkey AND ps_suppkey = l_suppkey WHERE n_regionkey IN (1, 4, 0, 2, 3) AND n_nationkey IN (18, 7, 17, 13) AND s_acctbal > 0 AND p_brand IN ('Brand#24', 'Brand#44') AND ps_suppkey IN (60452, 180565, 120646, 376, 920, 61065) AND ps_availqty > 4500 AND l_shipdate BETWEEN '1994-01-01' AND '1995-01-01' GROUP BY nation ORDER BY revenue DESC, avg_customer_balance DESC;
SELECT r.r_name AS region, COUNT(DISTINCT c.c_custkey) AS number_of_customers, COUNT(DISTINCT s.s_suppkey) AS number_of_suppliers, AVG(c.c_acctbal) AS average_customer_balance, SUM(o.o_totalprice) AS total_sales, SUM(ps.ps_availqty * ps.ps_supplycost) AS total_parts_value FROM region r JOIN nation n ON r.r_regionkey = n.n_regionkey JOIN supplier s ON n.n_nationkey = s.s_nationkey JOIN customer c ON n.n_nationkey = c.c_nationkey JOIN orders o ON c.c_custkey = o.o_custkey JOIN partsupp ps ON s.s_suppkey = ps.ps_suppkey WHERE r.r_name IN ('MIDDLE EAST', 'ASIA', 'EUROPE', 'AMERICA', 'AFRICA') AND ps.ps_partkey = 912 AND s.s_acctbal BETWEEN 5000 AND 9000 GROUP BY r.r_name ORDER BY total_sales DESC;
SELECT s.s_name AS supplier_name, o.o_orderpriority AS order_priority, COUNT(DISTINCT l.l_orderkey) AS total_orders, SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_revenue, AVG(l.l_discount) AS average_discount, SUM(l.l_quantity) AS total_quantity FROM supplier s JOIN nation n ON s.s_nationkey = n.n_nationkey JOIN partsupp ps ON s.s_suppkey = ps.ps_suppkey JOIN lineitem l ON ps.ps_partkey = l.l_partkey AND ps.ps_suppkey = l.l_suppkey JOIN orders o ON l.l_orderkey = o.o_orderkey WHERE n.n_name = 'GERMANY' AND o.o_orderdate BETWEEN date '2022-01-01' AND date '2022-12-31' AND o.o_orderpriority IN ('5-LOW', '4-NOT SPECIFIED', '2-HIGH') GROUP BY supplier_name, order_priority ORDER BY total_revenue DESC, supplier_name, order_priority;
SELECT c.c_mktsegment, s.s_nationkey, p.p_brand, SUM(l.l_extendedprice * (1 - l.l_discount)) AS revenue, AVG(l.l_quantity) AS average_quantity, COUNT(DISTINCT l.l_orderkey) AS count_orders FROM customer c JOIN lineitem l ON c.c_custkey = l.l_orderkey JOIN part p ON l.l_partkey = p.p_partkey JOIN supplier s ON l.l_suppkey = s.s_suppkey WHERE c.c_address IN ('P6zNDMefxN', 'eEsDHOObVMbUeOB1', 'jnlXUaNoejf4qeCkcdvTN8s1bNl44CkaOf', 'pHMkOf,,5l8') AND s.s_suppkey IN ('4438', '1480', '850') AND s.s_nationkey IN ('0', '16', '9', '22', '4', '7') AND l.l_shipdate BETWEEN '1994-01-01' AND '1994-12-31' GROUP BY c.c_mktsegment, s.s_nationkey, p.p_brand ORDER BY revenue DESC, c.c_mktsegment, s.s_nationkey, p.p_brand;
SELECT r.r_name AS region, c.c_mktsegment AS market_segment, COUNT(DISTINCT l.l_orderkey) AS total_orders, SUM(l.l_quantity) AS total_quantity_ordered, AVG(l.l_extendedprice) AS average_order_value, SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_spent FROM customer c JOIN nation n ON c.c_nationkey = n.n_nationkey JOIN region r ON n.n_regionkey = r.r_regionkey JOIN lineitem l ON c.c_custkey = l.l_orderkey GROUP BY r.r_name, c.c_mktsegment ORDER BY r.r_name, total_spent DESC;
SELECT c.c_mktsegment, AVG(c.c_acctbal) AS average_account_balance, SUM(o.o_totalprice) AS total_sales, COUNT(DISTINCT s.s_suppkey) AS supplier_count, n.n_name AS nation_name FROM customer c JOIN orders o ON c.c_custkey = o.o_custkey JOIN lineitem l ON o.o_orderkey = l.l_orderkey JOIN supplier s ON l.l_suppkey = s.s_suppkey JOIN nation n ON s.s_nationkey = n.n_nationkey WHERE o.o_orderdate >= '2020-01-01' AND o.o_orderdate < '2021-01-01' GROUP BY c.c_mktsegment, n.n_name ORDER BY c.c_mktsegment, total_sales DESC;
SELECT r_name AS region, n_name AS nation, COUNT(DISTINCT s_suppkey) AS number_of_suppliers, COUNT(DISTINCT c_custkey) AS number_of_customers, AVG(s_acctbal) AS avg_supplier_acctbal, AVG(c_acctbal) AS avg_customer_acctbal, SUM(l_quantity) AS total_quantity_ordered, SUM(l_extendedprice * (1 - l_discount)) AS total_revenue, AVG(l_extendedprice * (1 - l_discount)) AS avg_order_value FROM region JOIN nation ON n_regionkey = r_regionkey JOIN supplier ON s_nationkey = n_nationkey JOIN customer ON c_nationkey = n_nationkey JOIN orders ON o_custkey = c_custkey JOIN lineitem ON l_orderkey = o_orderkey AND l_suppkey = s_suppkey WHERE n_nationkey IN (8, 9) AND l_discount IN (0.06, 0.02) AND l_partkey = 1051150 GROUP BY region, nation ORDER BY total_revenue DESC;
SELECT c.c_mktsegment, s.s_nationkey, COUNT(DISTINCT o.o_orderkey) AS total_orders, SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_sales_volume, AVG(l.l_extendedprice * (1 - l.l_discount)) AS avg_sales_volume, SUM(l.l_quantity) AS total_quantity FROM customer c JOIN orders o ON c.c_custkey = o.o_custkey JOIN lineitem l ON o.o_orderkey = l.l_orderkey JOIN supplier s ON l.l_suppkey = s.s_suppkey WHERE o.o_orderdate BETWEEN '1995-01-01' AND '1995-12-31' GROUP BY c.c_mktsegment, s.s_nationkey ORDER BY c.c_mktsegment, s.s_nationkey;
SELECT r.r_name AS region, c.c_mktsegment AS market_segment, COUNT(DISTINCT o.o_orderkey) AS total_orders, SUM(l.l_extendedprice * (1 - l.l_discount)) AS revenue, AVG(l.l_quantity) AS average_quantity, AVG(p.p_retailprice) AS average_retail_price FROM region r JOIN customer c ON r.r_regionkey = c.c_nationkey JOIN orders o ON c.c_custkey = o.o_custkey JOIN lineitem l ON o.o_orderkey = l.l_orderkey JOIN part p ON l.l_partkey = p.p_partkey WHERE c.c_mktsegment IN ('BUILDING', 'MACHINERY') AND o.o_clerk IN ('Clerk#000001519', 'Clerk#000020568', 'Clerk#000005169', 'Clerk#000019213', 'Clerk#000002367') AND o.o_shippriority = 0 AND r.r_name IN ('AMERICA', 'MIDDLE EAST', 'EUROPE', 'ASIA') AND p.p_retailprice BETWEEN 1200 AND 1550 GROUP BY r.r_name, c.c_mktsegment ORDER BY revenue DESC;
SELECT r_name AS region, n_name AS nation, COUNT(DISTINCT c_custkey) AS number_of_customers, COUNT(DISTINCT s_suppkey) AS number_of_suppliers, SUM(l_extendedprice * (1 - l_discount)) AS revenue, AVG(l_quantity) AS average_quantity, AVG(l_extendedprice) AS average_price, AVG(l_discount) AS average_discount FROM region JOIN nation ON r_regionkey = n_regionkey JOIN customer ON c_nationkey = n_nationkey JOIN orders ON c_custkey = o_custkey JOIN lineitem ON o_orderkey = l_orderkey JOIN supplier ON s_nationkey = n_nationkey AND l_suppkey = s_suppkey GROUP BY region, nation ORDER BY revenue DESC, average_quantity DESC LIMIT 10;
SELECT r_name AS region, n_name AS nation, c_mktsegment AS market_segment, COUNT(DISTINCT c_custkey) AS number_of_customers, AVG(c_acctbal) AS avg_account_balance, SUM(l_extendedprice * (1 - l_discount)) AS total_sales FROM customer JOIN nation ON c_nationkey = n_nationkey JOIN region ON n_regionkey = r_regionkey JOIN lineitem ON c_custkey = l_orderkey WHERE r_comment LIKE '%final%' AND n_comment LIKE '%final, express gifts cajole a%' AND c_acctbal > 0 AND l_shipdate BETWEEN '1995-01-01' AND '1995-12-31' GROUP BY region, nation, market_segment ORDER BY total_sales DESC, avg_account_balance DESC;
SELECT r.r_name AS region, n.n_name AS nation, COUNT(DISTINCT c.c_custkey) AS num_customers, SUM(c.c_acctbal) AS total_customer_balance, AVG(p.p_retailprice) AS avg_part_retail_price, SUM(l.l_extendedprice * (1 - l_discount)) AS total_sales, COUNT(DISTINCT o.o_orderkey) AS num_orders FROM customer c JOIN nation n ON c.c_nationkey = n.n_nationkey JOIN region r ON n.n_regionkey = r.r_regionkey JOIN orders o ON c.c_custkey = o.o_custkey JOIN lineitem l ON o.o_orderkey = l.l_orderkey JOIN part p ON l.l_partkey = p.p_partkey WHERE n.n_nationkey = 22 AND l.l_shipdate BETWEEN '1995-01-01' AND '1995-12-31' GROUP BY r.r_name, n.n_name ORDER BY total_sales DESC, region, nation;
SELECT r.r_name AS region_name, p.p_type AS part_type, COUNT(DISTINCT c.c_custkey) AS total_customers, SUM(l.l_extendedprice) AS total_sales, AVG(l.l_quantity) AS avg_quantity_sold, SUM(l.l_extendedprice * (1 - l.l_discount)) AS revenue_after_discount FROM region r JOIN customer c ON c.c_nationkey = r.r_regionkey JOIN lineitem l ON l.l_orderkey = c.c_custkey JOIN part p ON p.p_partkey = l.l_partkey WHERE r.r_name IN ('AFRICA', 'MIDDLE EAST') AND l.l_shipdate BETWEEN '1994-01-01' AND '1995-01-01' AND p.p_name IN ('linen goldenrod hot papaya pale', 'rose salmon peru gainsboro tan') GROUP BY region_name, part_type ORDER BY total_sales DESC;
SELECT r_name AS region, n_name AS nation, COUNT(DISTINCT s_suppkey) AS number_of_suppliers, COUNT(DISTINCT c_custkey) AS number_of_customers, SUM(ps_availqty) AS total_available_quantity, AVG(s_acctbal) AS avg_supplier_acctbal, AVG(c_acctbal) AS avg_customer_acctbal, SUM(l_extendedprice * (1 - l_discount)) AS total_revenue, AVG(l_quantity) AS avg_quantity_sold FROM region JOIN nation ON r_regionkey = n_regionkey JOIN supplier ON s_nationkey = n_nationkey JOIN customer ON c_nationkey = n_nationkey JOIN partsupp ON s_suppkey = ps_suppkey JOIN lineitem ON l_suppkey = s_suppkey AND l_partkey = ps_partkey WHERE r_regionkey IN (1, 2, 4) AND ps_suppkey IN ('121031', '120304') AND s_address IN ('s,fan,VoI4tUAGGH1gI4bgEb794k', '90qRn8EpBglfWnkjVP5', 'srXPQd19EypYn,xGNUH9PaDXJqSHo', 'QkfYlLgz351M,w', '69rnn0LIo8CqkmiPmkbzgOKeMtgWFnXssK9', 'zUH7haRVvYGOxm9NI48Wvrie5') AND (l_shipmode IN ('AIR', 'AIR REG') AND l_shipinstruct = 'DELIVER IN PERSON') GROUP BY region, nation ORDER BY total_revenue DESC;
SELECT r.r_name AS region, n.n_name AS nation, COUNT(DISTINCT s.s_suppkey) AS total_suppliers, COUNT(DISTINCT c.c_custkey) AS total_customers, AVG(s.s_acctbal) AS avg_supplier_acct_balance, AVG(c.c_acctbal) AS avg_customer_acct_balance, SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_sales_volume, AVG(l.l_quantity) AS avg_quantity_sold FROM region r JOIN nation n ON r.r_regionkey = n.n_regionkey JOIN supplier s ON n.n_nationkey = s.s_nationkey JOIN customer c ON n.n_nationkey = c.c_nationkey JOIN orders o ON c.c_custkey = o.o_custkey JOIN lineitem l ON o.o_orderkey = l.l_orderkey WHERE r.r_name IN ('EUROPE', 'ASIA') AND c.c_mktsegment = 'AUTOMOBILE' AND o.o_orderpriority = '1-URGENT' AND l.l_shipmode IN ('AIR', 'RAIL') GROUP BY r.r_name, n.n_name ORDER BY total_sales_volume DESC, avg_supplier_acct_balance DESC, avg_customer_acct_balance DESC LIMIT 10;
SELECT n.n_name, p.p_type, AVG(s.s_acctbal) AS avg_account_balance, COUNT(DISTINCT s.s_suppkey) AS number_of_suppliers, SUM(p.p_retailprice) AS total_retail_price, AVG(p.p_size) AS average_part_size FROM supplier s JOIN nation n ON s.s_nationkey = n.n_nationkey JOIN part p ON p.p_size BETWEEN 30 AND 50 WHERE n.n_name IN ('GERMANY', 'BRAZIL', 'UNITED KINGDOM') AND p.p_type LIKE '%BRASS' AND n.n_comment LIKE '%efully alongside of the slyly final dependencies.%' GROUP BY n.n_name, p.p_type ORDER BY avg_account_balance DESC, total_retail_price DESC;
SELECT n.n_name AS nation_name, SUM(l.l_extendedprice) AS total_sales, AVG(l.l_discount) AS average_discount, COUNT(DISTINCT c.c_custkey) AS number_of_customers, COUNT(DISTINCT s.s_suppkey) AS number_of_suppliers FROM nation n JOIN customer c ON n.n_nationkey = c.c_nationkey JOIN supplier s ON n.n_nationkey = s.s_nationkey JOIN lineitem l ON l.l_suppkey = s.s_suppkey JOIN part p ON l.l_partkey = p.p_partkey WHERE n.n_regionkey IN (4, 2, 1, 0) AND l.l_shipdate BETWEEN '2020-01-01' AND '2020-12-31' AND p.p_mfgr = 'Manufacturer#3' GROUP BY n.n_name ORDER BY total_sales DESC;
SELECT r.r_name AS region_name, AVG(ps.ps_supplycost) AS average_supply_cost, SUM(ps.ps_availqty) AS total_available_quantity, COUNT(DISTINCT n.n_nationkey) AS number_of_nations FROM region r LEFT JOIN nation n ON n.n_regionkey = r.r_regionkey LEFT JOIN partsupp ps ON ps.ps_suppkey = n.n_nationkey GROUP BY r.r_name ORDER BY average_supply_cost DESC;
SELECT r_name AS region, n_name AS nation, COUNT(DISTINCT c_custkey) AS total_customers, SUM(s_acctbal) AS total_supplier_balance, AVG(l_quantity) AS average_lineitem_quantity, SUM(l_extendedprice * (1 - l_discount)) AS total_revenue, COUNT(DISTINCT l_suppkey) AS unique_suppliers FROM region JOIN nation ON region.r_regionkey = nation.n_regionkey JOIN customer ON nation.n_nationkey = customer.c_nationkey JOIN supplier ON customer.c_nationkey = supplier.s_nationkey JOIN lineitem ON supplier.s_suppkey = lineitem.l_suppkey WHERE customer.c_nationkey IN (20, 16, 5, 17, 9, 7) AND customer.c_comment LIKE 'requests above the ironic, pending t%' AND supplier.s_acctbal IN (5655.21, 2792.45, 6073.68) AND nation.n_name IN ('UNITED STATES', 'FRANCE', 'VIETNAM', 'MOZAMBIQUE') AND nation.n_nationkey IN (3, 12, 15, 23, 5) AND l_shipdate BETWEEN DATE '1994-01-01' AND DATE '1995-01-01' GROUP BY region, nation ORDER BY total_revenue DESC;
SELECT c.c_name, p.p_brand, COUNT(DISTINCT o.o_orderkey) AS total_orders, SUM(l.l_quantity) AS total_quantity, AVG(l.l_extendedprice * (1 - l.l_discount)) AS avg_discounted_price, SUM(CASE WHEN l.l_returnflag = 'R' THEN l.l_quantity ELSE 0 END) AS returned_quantity FROM customer c JOIN orders o ON c.c_custkey = o.o_custkey JOIN lineitem l ON o.o_orderkey = l.l_orderkey JOIN part p ON l.l_partkey = p.p_partkey WHERE c.c_nationkey IN (3, 9, 15, 8, 6, 17) AND o.o_orderdate BETWEEN '1994-01-01' AND '1996-12-31' AND p.p_brand = 'Brand#31' GROUP BY c.c_name, p.p_brand ORDER BY avg_discounted_price DESC, total_orders DESC, c.c_name LIMIT 10;
SELECT r_name AS region, n_name AS nation, COUNT(DISTINCT s_suppkey) AS number_of_suppliers, AVG(s_acctbal) AS average_account_balance, SUM(ps_availqty) AS total_available_quantity, AVG(ps_supplycost) AS average_supply_cost FROM region JOIN nation ON n_regionkey = r_regionkey JOIN supplier ON s_nationkey = n_nationkey JOIN partsupp ON s_suppkey = ps_suppkey WHERE n_nationkey IN (8, 11, 4) AND n_name IN ('IRAN', 'ETHIOPIA') GROUP BY r_name, n_name ORDER BY average_account_balance DESC, total_available_quantity DESC;
SELECT p.p_type, AVG(p.p_retailprice) AS avg_retailprice, SUM(ps.ps_availqty) AS total_avail_qty, AVG(ps.ps_supplycost) AS avg_supply_cost, COUNT(DISTINCT o.o_orderkey) AS num_orders, SUM(o.o_totalprice) AS total_order_price FROM part p JOIN partsupp ps ON p.p_partkey = ps.ps_partkey JOIN orders o ON ps.ps_partkey = o.o_orderkey WHERE p.p_size BETWEEN 1 AND 20 AND o.o_orderstatus = 'F' AND o.o_shippriority = 0 AND o.o_totalprice > 50000 GROUP BY p.p_type ORDER BY total_order_price DESC, avg_retailprice LIMIT 10;
SELECT r.r_name AS region_name, COUNT(DISTINCT s.s_suppkey) AS total_suppliers, COUNT(DISTINCT n.n_nationkey) AS total_nations, SUM(s.s_acctbal) AS total_account_balance, AVG(s.s_acctbal) AS average_account_balance FROM region r JOIN nation n ON r.r_regionkey = n.n_regionkey JOIN supplier s ON n.n_nationkey = s.s_nationkey GROUP BY r.r_name ORDER BY total_account_balance DESC;
SELECT r.r_name AS region, n.n_name AS nation, COUNT(DISTINCT s.s_suppkey) AS number_of_suppliers, COUNT(DISTINCT o.o_orderkey) AS number_of_orders, SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_revenue, AVG(s.s_acctbal) AS average_supplier_account_balance, AVG(l.l_quantity) AS average_quantity_ordered FROM region r JOIN nation n ON r.r_regionkey = n.n_regionkey JOIN supplier s ON n.n_nationkey = s.s_nationkey JOIN partsupp ps ON s.s_suppkey = ps.ps_suppkey JOIN lineitem l ON ps.ps_partkey = l.l_partkey AND ps.ps_suppkey = l.l_suppkey JOIN orders o ON l.l_orderkey = o.o_orderkey WHERE n.n_name IN ('ETHIOPIA', 'MOROCCO') AND s.s_nationkey IN (3, 21) AND o.o_totalprice > 150000 AND o.o_orderdate BETWEEN date '1995-01-01' AND date '1995-12-31' GROUP BY r.r_name, n.n_name ORDER BY total_revenue DESC, region, nation;
SELECT n.n_name AS nation_name, COUNT(c.c_custkey) AS number_of_customers, AVG(c.c_acctbal) AS average_account_balance, SUM(CASE WHEN c.c_acctbal > 0 THEN c.c_acctbal ELSE 0 END) AS total_positive_account_balance, COUNT(DISTINCT p.p_partkey) AS number_of_distinct_parts, AVG(p.p_retailprice) AS average_retail_price FROM nation AS n JOIN customer AS c ON n.n_nationkey = c.c_nationkey LEFT JOIN orders AS o ON c.c_custkey = o.o_custkey LEFT JOIN lineitem AS l ON o.o_orderkey = l.l_orderkey LEFT JOIN part AS p ON l.l_partkey = p.p_partkey WHERE n.n_comment NOT LIKE '%regu%' AND c.c_comment NOT LIKE '%quickly%' AND c.c_acctbal BETWEEN -913.70 AND 4943.58 GROUP BY n.n_name ORDER BY number_of_customers DESC, average_account_balance DESC;
SELECT r.r_name AS region, n.n_name AS nation, COUNT(DISTINCT s.s_suppkey) AS number_of_suppliers, COUNT(DISTINCT c.c_custkey) AS number_of_customers, AVG(s.s_acctbal) AS average_supplier_acctbal, AVG(c.c_acctbal) AS average_customer_acctbal, SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_sales_volume, AVG(l.l_quantity) AS average_quantity_sold, COUNT(DISTINCT p.p_partkey) AS number_of_parts_sold, COUNT(DISTINCT o.o_orderkey) AS number_of_orders FROM region r JOIN nation n ON r.r_regionkey = n.n_regionkey JOIN supplier s ON n.n_nationkey = s.s_nationkey JOIN customer c ON n.n_nationkey = c.c_nationkey JOIN orders o ON c.c_custkey = o.o_custkey JOIN lineitem l ON o.o_orderkey = l.l_orderkey JOIN part p ON l.l_partkey = p.p_partkey WHERE l.l_shipdate BETWEEN '1995-01-01' AND '1995-12-31' AND l.l_returnflag = 'O' GROUP BY r.r_name, n.n_name ORDER BY total_sales_volume DESC, average_customer_acctbal DESC;
SELECT r.r_name AS region_name, COUNT(DISTINCT c.c_custkey) AS number_of_customers, AVG(c.c_acctbal) AS average_account_balance, COUNT(DISTINCT p.p_partkey) AS number_of_parts, SUM(ps.ps_availqty) AS total_available_quantity, AVG(ps.ps_supplycost) AS average_supply_cost, SUM(ps.ps_supplycost * ps.ps_availqty) AS total_inventory_value FROM region r JOIN customer c ON r.r_regionkey = c.c_nationkey JOIN partsupp ps ON c.c_custkey = ps.ps_suppkey JOIN part p ON ps.ps_partkey = p.p_partkey WHERE r.r_regionkey IN (1, 4, 0, 2, 3) AND p.p_mfgr IN ('Manufacturer#5', 'Manufacturer#4', 'Manufacturer#2', 'Manufacturer#1', 'Manufacturer#3') AND c.c_nationkey = 0 AND c.c_comment IN ( 'ely: bravely regular accounts acr', 'y ironic pinto beans cajole deposits.', 'lyly silent platelets sleep epitaphs. f', 'lay boldly? blithely final deposits are', 'le quickly. quickly enticing excu' ) AND ps.ps_supplycost IN (184.83, 329.63, 916.51, 486.89) GROUP BY r.r_name ORDER BY total_inventory_value DESC;
SELECT r.r_name AS region_name, AVG(ps.ps_availqty) AS average_available_quantity, SUM(ps.ps_supplycost) AS total_supply_cost, COUNT(DISTINCT s.s_suppkey) AS number_of_suppliers, COUNT(DISTINCT n.n_nationkey) AS number_of_nations FROM region r JOIN nation n ON r.r_regionkey = n.n_regionkey JOIN supplier s ON n.n_nationkey = s.s_nationkey JOIN partsupp ps ON s.s_suppkey = ps.ps_suppkey GROUP BY r.r_name ORDER BY total_supply_cost DESC;
SELECT r.r_name AS region_name, n.n_name AS nation_name, COUNT(DISTINCT p.p_partkey) AS number_of_parts, SUM(ps.ps_availqty) AS total_available_quantity, AVG(p.p_retailprice) AS average_retail_price, SUM(l.l_extendedprice * (1 - l_discount)) AS total_revenue, MAX(l.l_discount) AS max_discount, MIN(l.l_quantity) AS min_quantity FROM region r JOIN nation n ON r.r_regionkey = n.n_regionkey JOIN partsupp ps ON ps.ps_suppkey = n.n_nationkey JOIN part p ON ps.ps_partkey = p.p_partkey JOIN lineitem l ON l.l_partkey = ps.ps_partkey WHERE n.n_regionkey IN (1, 2, 0, 4) AND (n.n_name = 'ETHIOPIA' OR n.n_name = 'IRAN') AND p.p_retailprice > 900 AND ps.ps_availqty < 5000 GROUP BY region_name, nation_name ORDER BY total_revenue DESC, average_retail_price DESC, region_name, nation_name;
SELECT r_name AS region, n_name AS nation, COUNT(DISTINCT c_custkey) AS total_customers, SUM(o_totalprice) AS total_sales, AVG(s_acctbal) AS avg_supplier_acct_balance, MAX(p_retailprice) AS max_part_retail_price FROM customer c JOIN orders o ON c.c_custkey = o.o_custkey JOIN nation n ON c.c_nationkey = n.n_nationkey JOIN region r ON n.n_regionkey = r.r_regionkey JOIN supplier s ON s.s_nationkey = n.n_nationkey JOIN partsupp ps ON s.s_suppkey = ps.ps_suppkey JOIN part p ON ps.ps_partkey = p.p_partkey WHERE r.r_regionkey IN ('1', '4') AND c.c_mktsegment IN ('MACHINERY', 'AUTOMOBILE') AND ps.ps_supplycost = '37.33' AND ( c.c_comment LIKE '%y pending foxes sleep blithely at the furi%' OR c.c_comment LIKE '%y final deposits wake slyly quickly express re%' OR c.c_comment LIKE '%t the thinly unusual packages sublate after t%' OR c.c_comment LIKE '%, bold requests haggle silently speci%' ) GROUP BY region, nation ORDER BY total_sales DESC, avg_supplier_acct_balance DESC;
SELECT r_name AS region, n_name AS nation, p_type AS part_type, COUNT(o_orderkey) AS total_orders, SUM(o_totalprice) AS total_revenue, AVG(s_acctbal) AS avg_supplier_balance, AVG(c_acctbal) AS avg_customer_balance, MAX(p_retailprice) AS max_part_price FROM region JOIN nation ON n_regionkey = r_regionkey JOIN supplier ON s_nationkey = n_nationkey JOIN customer ON c_nationkey = n_nationkey JOIN orders ON o_custkey = c_custkey JOIN partsupp ON s_suppkey = ps_suppkey JOIN part ON ps_partkey = p_partkey AND p_type LIKE 'ECONOMY%' WHERE s_address IN ( '9MPIA XjX sq4qqEuSXOZ4ddQmshAu', 'ex9ebYOJALhQaD4g6BPgZNM', '86kwTdciYI', '6ERwB4KuIYLZoyNlg4eAS3r,g50', '80Ot6yWxXVnjoNInk1c9hL5JOTz3EctqZAM8okE', 'Il8mWAfUCLIqCEXgljJkZ3LmbNywC3' ) AND o_orderstatus = 'F' AND o_clerk IN ('Clerk#000010256', 'Clerk#000007081') GROUP BY region, nation, part_type ORDER BY total_revenue DESC;
SELECT r.r_name AS region, n.n_name AS nation, COUNT(DISTINCT s.s_suppkey) AS total_suppliers, SUM(ps.ps_availqty) AS total_avail_qty, AVG(ps.ps_supplycost) AS avg_supply_cost, SUM(l.l_extendedprice * (1 - l.l_discount)) AS revenue, COUNT(DISTINCT o.o_orderkey) AS total_orders, AVG(o.o_totalprice) AS avg_order_total FROM region r JOIN nation n ON r.r_regionkey = n.n_regionkey JOIN supplier s ON n.n_nationkey = s.s_nationkey JOIN partsupp ps ON s.s_suppkey = ps.ps_suppkey JOIN lineitem l ON ps.ps_partkey = l.l_partkey AND ps.ps_suppkey = l.l_suppkey JOIN orders o ON l.l_orderkey = o.o_orderkey WHERE r.r_name IN ('AMERICA', 'EUROPE') AND o.o_orderdate BETWEEN '1995-01-01' AND '1995-12-31' AND l.l_shipdate > l.l_commitdate GROUP BY region, nation ORDER BY revenue DESC, region, nation;
SELECT c.c_name, c.c_acctbal, c.c_mktsegment, SUM(l.l_quantity) AS total_quantity, AVG(l.l_extendedprice * (1 - l.l_discount)) AS avg_purchased_amount, COUNT(DISTINCT o.o_orderkey) AS number_of_orders FROM customer c JOIN orders o ON c.c_custkey = o.o_custkey JOIN lineitem l ON o.o_orderkey = l.l_orderkey WHERE o.o_orderstatus = 'F' AND l.l_receiptdate >= '1997-01-01' AND l.l_receiptdate < '1998-01-01' GROUP BY c.c_custkey, c.c_name, c.c_acctbal, c.c_mktsegment ORDER BY avg_purchased_amount DESC, total_quantity DESC LIMIT 10;
SELECT r_name AS region, n_name AS nation, COUNT(c_custkey) AS number_of_customers, AVG(c_acctbal) AS average_account_balance, SUM(ps_availqty) AS total_available_quantity, AVG(ps_supplycost) AS average_supply_cost FROM customer JOIN nation ON customer.c_nationkey = nation.n_nationkey JOIN region ON nation.n_regionkey = region.r_regionkey JOIN partsupp ON customer.c_custkey = partsupp.ps_suppkey GROUP BY region, nation ORDER BY region, nation;
SELECT r.r_name AS region, COUNT(DISTINCT s.s_suppkey) AS number_of_suppliers, COUNT(DISTINCT c.c_custkey) AS number_of_customers, COUNT(DISTINCT o.o_orderkey) AS number_of_orders, SUM(l.l_extendedprice) AS total_revenue, AVG(l.l_extendedprice * (1 - l.l_discount)) AS avg_discounted_revenue, SUM(l.l_quantity) AS total_quantity_sold, AVG(p.p_retailprice) AS avg_retail_price, SUM(ps.ps_supplycost * l.l_quantity) AS total_supply_cost FROM region r JOIN nation n ON n.n_regionkey = r.r_regionkey JOIN supplier s ON s.s_nationkey = n.n_nationkey JOIN partsupp ps ON ps.ps_suppkey = s.s_suppkey JOIN part p ON p.p_partkey = ps.ps_partkey JOIN lineitem l ON l.l_partkey = p.p_partkey AND l.l_suppkey = s.s_suppkey JOIN orders o ON o.o_orderkey = l.l_orderkey JOIN customer c ON c.c_custkey = o.o_custkey AND c.c_nationkey = n.n_nationkey WHERE r.r_name IN ('AFRICA', 'EUROPE') AND p.p_type IN ('PROMO POLISHED NICKEL', 'ECONOMY BRUSHED COPPER') AND l.l_shipinstruct IN ('COLLECT COD', 'TAKE BACK RETURN') AND l.l_tax BETWEEN 0.01 AND 0.07 GROUP BY r.r_name ORDER BY total_revenue DESC;
SELECT r.r_name AS region, n.n_name AS nation, COUNT(DISTINCT s.s_suppkey) AS number_of_suppliers, COUNT(DISTINCT c.c_custkey) AS number_of_customers, SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_revenue, AVG(l.l_quantity) AS average_quantity_sold, SUM(ps.ps_availqty) AS total_available_quantity FROM region r JOIN nation n ON r.r_regionkey = n.n_regionkey JOIN supplier s ON n.n_nationkey = s.s_nationkey JOIN partsupp ps ON s.s_suppkey = ps.ps_suppkey JOIN part p ON ps.ps_partkey = p.p_partkey JOIN lineitem l ON p.p_partkey = l.l_partkey AND s.s_suppkey = l.l_suppkey JOIN orders o ON l.l_orderkey = o.o_orderkey JOIN customer c ON o.o_custkey = c.c_custkey AND c.c_nationkey = n.n_nationkey WHERE p.p_type IN ('ECONOMY BURNISHED NICKEL', 'ECONOMY POLISHED TIN', 'STANDARD BRUSHED NICKEL') AND l.l_shipdate BETWEEN '2020-01-01' AND '2020-12-31' GROUP BY r.r_name, n.n_name ORDER BY total_revenue DESC;
SELECT r.r_name AS region_name, COUNT(DISTINCT s.s_suppkey) AS num_suppliers, COUNT(DISTINCT c.c_custkey) AS num_customers, SUM(s.s_acctbal) AS total_supplier_balance, AVG(c.c_acctbal) AS avg_customer_balance, AVG(s.s_acctbal) AS avg_supplier_balance, SUM(c.c_acctbal) AS total_customer_balance FROM region r JOIN supplier s ON r.r_regionkey = s.s_nationkey JOIN customer c ON r.r_regionkey = c.c_nationkey GROUP BY r.r_name ORDER BY total_supplier_balance DESC, total_customer_balance DESC;
SELECT r.r_name AS region, n.n_name AS nation, COUNT(DISTINCT s.s_suppkey) AS number_of_suppliers, COUNT(DISTINCT c.c_custkey) AS number_of_customers, SUM(l.l_quantity) AS total_quantity_sold, AVG(l.l_extendedprice * (1 - l.l_discount)) AS average_discounted_price, SUM(l.l_extendedprice * (1 - l.l_discount) * (1 + l.l_tax)) AS total_sales_with_tax FROM region r JOIN nation n ON r.r_regionkey = n.n_regionkey JOIN supplier s ON n.n_nationkey = s.s_nationkey JOIN customer c ON n.n_nationkey = c.c_nationkey JOIN lineitem l ON s.s_suppkey = l.l_suppkey WHERE c.c_mktsegment IN ('MACHINERY', 'HOUSEHOLD') AND r.r_regionkey IN (3, 2, 0) AND l.l_shipdate BETWEEN '2022-01-01' AND '2022-12-31' GROUP BY r.r_name, n.n_name ORDER BY total_sales_with_tax DESC, region, nation;
SELECT r_name AS region, n_name AS nation, count(DISTINCT s_suppkey) AS number_of_suppliers, count(DISTINCT c_custkey) AS number_of_customers, sum(ps_availqty) AS total_available_parts_quantity, avg(s_acctbal) AS average_supplier_account_balance, avg(c_acctbal) AS average_customer_account_balance, sum(l_extendedprice * (1 - l_discount)) AS total_revenue FROM region JOIN nation ON n_regionkey = r_regionkey JOIN supplier ON s_nationkey = n_nationkey JOIN customer ON c_nationkey = n_nationkey JOIN partsupp ON ps_suppkey = s_suppkey JOIN lineitem ON l_suppkey = s_suppkey AND l_partkey = ps_partkey WHERE r_regionkey = 1 AND s_suppkey IN (4655, 1401, 4606, 3746) AND ps_comment LIKE '%can nag deposits%' GROUP BY r_name, n_name ORDER BY total_revenue DESC;
SELECT r_name AS region, n_name AS nation, COUNT(DISTINCT c_custkey) AS num_customers, AVG(c_acctbal) AS avg_account_balance, SUM(l_extendedprice * (1 - l_discount)) AS revenue, AVG(l_quantity) AS avg_quantity_sold, COUNT(*) AS lineitem_count FROM region JOIN nation ON n_regionkey = r_regionkey JOIN customer ON c_nationkey = n_nationkey JOIN lineitem ON l_orderkey = c_custkey WHERE r_regionkey IN (0, 1) AND l_shipdate BETWEEN '1995-02-23' AND '1998-06-06' AND c_acctbal > 0 GROUP BY region, nation ORDER BY revenue DESC;
SELECT n.n_name, COUNT(DISTINCT s.s_suppkey) AS number_of_suppliers, SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_revenue, AVG(ps.ps_supplycost) AS average_supply_cost, SUM(l.l_quantity) AS total_quantity_ordered FROM nation n JOIN supplier s ON s.s_nationkey = n.n_nationkey JOIN partsupp ps ON s.s_suppkey = ps.ps_suppkey JOIN lineitem l ON ps.ps_partkey = l.l_partkey AND ps.ps_suppkey = l.l_suppkey WHERE n.n_nationkey IN (12, 16, 8, 11) AND l.l_orderkey IN (2406, 1761, 837, 772, 1764) GROUP BY n.n_name ORDER BY total_revenue DESC;
SELECT r.r_name AS region, avg(c.c_acctbal) AS avg_customer_acct_balance, avg(s.s_acctbal) AS avg_supplier_acct_balance, count(DISTINCT o.o_orderkey) AS total_orders, avg(o.o_totalprice) AS avg_order_total_price FROM region r INNER JOIN customer c ON c.c_nationkey = r.r_regionkey INNER JOIN supplier s ON s.s_nationkey = r.r_regionkey INNER JOIN orders o ON o.o_custkey = c.c_custkey INNER JOIN lineitem l ON l.l_orderkey = o.o_orderkey INNER JOIN part p ON p.p_partkey = l.l_partkey AND p.p_size = 17 GROUP BY r.r_name ORDER BY avg_customer_acct_balance DESC, avg_supplier_acct_balance DESC;
SELECT r_name AS region_name, n_name AS nation_name, COUNT(DISTINCT s_suppkey) AS total_suppliers, COUNT(DISTINCT c_custkey) AS total_customers, COUNT(DISTINCT o_orderkey) AS total_orders, SUM(l_extendedprice * (1 - l_discount)) AS revenue, AVG(l_quantity) AS average_quantity, AVG(l_extendedprice) AS average_extended_price, SUM(CASE WHEN l_shipdate <= l_commitdate THEN l_quantity ELSE 0 END) AS on_time_delivery_qty, SUM(CASE WHEN l_shipdate > l_commitdate THEN l_quantity ELSE 0 END) AS delayed_delivery_qty FROM region JOIN nation ON n_regionkey = r_regionkey JOIN supplier ON s_nationkey = n_nationkey JOIN customer ON c_nationkey = n_nationkey JOIN orders ON o_custkey = c_custkey JOIN lineitem ON l_orderkey = o_orderkey JOIN part ON part.p_partkey = lineitem.l_partkey WHERE r_name IN ('AMERICA', 'ASIA') AND o_shippriority = '0' AND part.p_container IN ('JUMBO CASE', 'MED PACK') AND l_shipmode = 'AIR' GROUP BY r_name, n_name ORDER BY revenue DESC, region_name, nation_name;
SELECT p.p_size, l.l_shipmode, AVG(l.l_discount) AS average_discount, COUNT(*) AS total_line_items, SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_revenue FROM lineitem l JOIN part p ON l.l_partkey = p.p_partkey JOIN supplier s ON l.l_suppkey = s.s_suppkey WHERE p.p_retailprice >= 1000 AND l.l_shipmode IN ('TRUCK', 'REG AIR', 'SHIP', 'RAIL') GROUP BY p.p_size, l.l_shipmode ORDER BY p.p_size, l.l_shipmode;
SELECT p.p_type, r.r_name, AVG(s.s_acctbal) AS average_supplier_acct_balance, COUNT(DISTINCT s.s_suppkey) AS total_suppliers, AVG(p.p_retailprice) AS average_part_retail_price FROM part p JOIN supplier s ON s.s_nationkey = p.p_partkey JOIN region r ON r.r_regionkey = s.s_nationkey WHERE p.p_size > 15 AND r.r_name IN ('EUROPE', 'AMERICA') GROUP BY p.p_type, r.r_name ORDER BY average_supplier_acct_balance DESC, total_suppliers DESC;
SELECT s.s_name, AVG(ps.ps_supplycost) AS avg_supply_cost, SUM(ps.ps_availqty) AS total_avail_qty, COUNT(DISTINCT o.o_orderkey) AS number_of_orders, SUM(o.o_totalprice) AS total_order_value, COUNT(DISTINCT o_custkey) AS number_of_customers FROM supplier s JOIN partsupp ps ON s.s_suppkey = ps.ps_suppkey JOIN orders o ON s.s_suppkey = o.o_custkey WHERE s.s_nationkey IN (2, 22) AND o.o_orderpriority IN ('1-URGENT', '2-HIGH') AND ps.ps_supplycost BETWEEN 267.12 AND 811.56 AND o.o_orderdate >= '2022-01-01' AND o.o_orderdate < '2023-01-01' GROUP BY s.s_name ORDER BY total_order_value DESC, avg_supply_cost ASC;
SELECT r_name AS region, n_name AS nation, c_mktsegment AS market_segment, COUNT(DISTINCT c_custkey) AS number_of_customers, SUM(l_extendedprice) AS total_sales, AVG(l_quantity) AS average_quantity_sold, SUM(CASE WHEN p_brand = 'Brand#44' THEN l_extendedprice * (1 - l_discount) ELSE 0 END) AS brand_44_sales, COUNT(DISTINCT o_orderkey) AS number_of_orders, AVG(o_totalprice) AS average_order_value, SUM(l_extendedprice * (1 - l_discount)) AS total_revenue, SUM(l_extendedprice * (1 - l_discount)) / COUNT(DISTINCT o_orderkey) AS average_revenue_per_order FROM region JOIN nation ON n_regionkey = r_regionkey JOIN customer ON c_nationkey = n_nationkey JOIN orders ON o_custkey = c_custkey JOIN lineitem ON l_orderkey = o_orderkey JOIN part ON p_partkey = l_partkey WHERE l_shipdate BETWEEN date '1995-01-01' AND date '1995-12-31' AND c_address IN ('EYkHDTB4Qg3oUcxFX', 'uHFP0GT1T61K7SzAN8gwrhpPISwGoq3WZa7gs2il', 'Kpm7kCGZbm,THUzLJCW588 ZGw0f1W,5ac1yy') AND p_brand IN ('Brand#44', 'Brand#22') GROUP BY region, nation, market_segment ORDER BY total_revenue DESC, region, nation, market_segment;
SELECT r.r_name AS region_name, COUNT(DISTINCT s.s_suppkey) AS total_suppliers, COUNT(DISTINCT p.p_partkey) AS total_parts, AVG(ps.ps_supplycost) AS average_supply_cost, SUM(ps.ps_availqty) AS total_available_quantity, AVG(p.p_retailprice) AS average_retail_price FROM region r JOIN supplier s ON s.s_nationkey = r.r_regionkey JOIN partsupp ps ON ps.ps_suppkey = s.s_suppkey JOIN part p ON p.p_partkey = ps.ps_partkey GROUP BY r.r_name ORDER BY total_suppliers DESC, region_name;
SELECT c.c_mktsegment, COUNT(DISTINCT c.c_custkey) AS total_customers, AVG(c.c_acctbal) AS avg_account_balance, SUM(l.l_quantity) AS total_quantity_ordered, SUM(l.l_extendedprice * (1 - l_discount)) AS revenue_after_discount, AVG(l.l_extendedprice * (1 - l_discount)) AS avg_order_value, COUNT(DISTINCT l.l_orderkey) AS total_orders FROM customer c JOIN lineitem l ON c.c_custkey = l.l_orderkey WHERE c.c_nationkey IN (4, 24, 16, 0, 17) AND l.l_shipdate BETWEEN date '1995-01-01' AND date '1995-12-31' GROUP BY c.c_mktsegment ORDER BY revenue_after_discount DESC;
SELECT r.r_name AS region, p.p_type AS part_type, COUNT(DISTINCT s.s_suppkey) AS supplier_count, COUNT(DISTINCT c.c_custkey) AS customer_count, SUM(l.l_extendedprice) AS total_sales_value, AVG(l.l_quantity) AS average_quantity_sold, (SUM(l.l_extendedprice * (1 - l.l_discount)) / SUM(l.l_extendedprice)) * 100 AS average_discount_percentage FROM region r JOIN supplier s ON s.s_nationkey = r.r_regionkey JOIN partsupp ps ON ps.ps_suppkey = s.s_suppkey JOIN part p ON ps.ps_partkey = p.p_partkey JOIN lineitem l ON l.l_partkey = p.p_partkey AND l.l_suppkey = s.s_suppkey JOIN customer c ON c.c_nationkey = s.s_nationkey WHERE p.p_mfgr = 'Manufacturer#5' AND (p.p_type IN ('MEDIUM BRUSHED TIN', 'ECONOMY BRUSHED NICKEL', 'LARGE BRUSHED BRASS', 'ECONOMY PLATED BRASS')) AND l.l_shipdate BETWEEN '2020-01-01' AND '2020-12-31' GROUP BY r.r_name, p.p_type ORDER BY total_sales_value DESC;
SELECT n.n_name, p.p_type, COUNT(DISTINCT o.o_orderkey) AS number_of_orders, SUM(l.l_quantity) AS total_quantity, AVG(l.l_extendedprice * (1 - l.l_discount)) AS avg_discounted_price, SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_revenue, MAX(o.o_totalprice) AS max_order_value FROM nation AS n JOIN orders AS o ON o.o_clerk IN ('Clerk#000017551', 'Clerk#000015437', 'Clerk#000017513') JOIN lineitem AS l ON o.o_orderkey = l.l_orderkey JOIN part AS p ON l.l_partkey = p.p_partkey WHERE n.n_nationkey IN (22, 23, 20) AND o.o_orderstatus = 'F' AND o.o_orderdate BETWEEN date '1995-01-01' AND date '1996-12-31' GROUP BY n.n_name, p.p_type ORDER BY total_revenue DESC, n.n_name, p.p_type;
SELECT n.n_name AS nation_name, p.p_type AS part_type, EXTRACT(YEAR FROM o.o_orderdate) AS order_year, AVG(l.l_extendedprice * (1 - l.l_discount)) AS avg_spending FROM customer c JOIN orders o ON c.c_custkey = o.o_custkey JOIN lineitem l ON o.o_orderkey = l.l_orderkey JOIN part p ON l.l_partkey = p.p_partkey JOIN nation n ON c.c_nationkey = n.n_nationkey WHERE o.o_orderdate BETWEEN '1995-01-01' AND '1996-12-31' GROUP BY nation_name, part_type, order_year ORDER BY nation_name, avg_spending DESC;
SELECT r.r_name AS region, n.n_name AS nation, COUNT(DISTINCT c.c_custkey) AS num_customers, COUNT(o.o_orderkey) AS num_orders, SUM(o.o_totalprice) AS total_sales, AVG(o.o_totalprice) AS avg_order_value FROM region r JOIN nation n ON r.r_regionkey = n.n_regionkey JOIN customer c ON n.n_nationkey = c.c_nationkey JOIN orders o ON c.c_custkey = o.o_custkey GROUP BY r.r_name, n.n_name ORDER BY r.r_name, total_sales DESC;
SELECT n.n_name AS nation_name, r.r_name AS region_name, AVG(ps.ps_supplycost) AS avg_supply_cost, SUM(ps.ps_availqty) AS total_available_quantity, COUNT(DISTINCT s.s_suppkey) AS number_of_suppliers FROM nation AS n JOIN region AS r ON n.n_regionkey = r.r_regionkey JOIN supplier AS s ON n.n_nationkey = s.s_nationkey JOIN partsupp AS ps ON s.s_suppkey = ps.ps_suppkey GROUP BY n.n_name, r.r_name ORDER BY r.r_name, n.n_name;
SELECT n.n_name AS nation_name, COUNT(DISTINCT s.s_suppkey) AS total_suppliers, SUM(l.l_quantity) AS total_quantity, AVG(l.l_extendedprice) AS average_price, SUM(l.l_extendedprice * (1 - l_discount)) AS revenue_after_discount FROM supplier s JOIN nation n ON s.s_nationkey = n.n_nationkey JOIN lineitem l ON s.s_suppkey = l.l_suppkey WHERE n.n_regionkey = 4 AND l.l_shipdate BETWEEN '1995-01-01' AND '1995-12-31' GROUP BY n.n_name ORDER BY revenue_after_discount DESC;
SELECT r.r_name AS region, n.n_name AS nation, COUNT(DISTINCT s.s_suppkey) AS num_suppliers, COUNT(DISTINCT c.c_custkey) AS num_customers, SUM(p.p_retailprice) AS total_retail_price, AVG(l.l_quantity) AS average_quantity_ordered, SUM(l.l_extendedprice * (1 - l_discount)) AS total_revenue, COUNT(DISTINCT o.o_orderkey) AS num_orders FROM region r JOIN nation n ON r.r_regionkey = n.n_regionkey JOIN supplier s ON n.n_nationkey = s.s_nationkey JOIN customer c ON n.n_nationkey = c.c_nationkey JOIN orders o ON c.c_custkey = o.o_custkey JOIN lineitem l ON o.o_orderkey = l.l_orderkey JOIN part p ON l.l_partkey = p.p_partkey WHERE r.r_name IN ('MIDDLE EAST', 'AFRICA') AND o.o_orderdate >= '2020-01-01' AND o.o_orderdate < '2021-01-01' AND l.l_returnflag = 'N' GROUP BY r.r_name, n.n_name ORDER BY total_revenue DESC, num_customers DESC LIMIT 10;
SELECT r.r_name AS region_name, c.c_mktsegment AS market_segment, COUNT(DISTINCT l.l_orderkey) AS total_orders, SUM(l.l_quantity) AS total_quantity_ordered, AVG(l.l_discount) AS average_discount_received FROM region r JOIN customer c ON r.r_regionkey = c.c_nationkey JOIN lineitem l ON c.c_custkey = l.l_suppkey GROUP BY r.r_name, c.c_mktsegment ORDER BY r.r_name, c.c_mktsegment, total_quantity_ordered DESC;
SELECT p.p_type, SUM(l.l_extendedprice) AS total_sales_volume, AVG(l.l_discount) AS avg_discount, COUNT(*) AS lineitem_count FROM lineitem l INNER JOIN orders o ON l.l_orderkey = o.o_orderkey INNER JOIN supplier s ON l.l_suppkey = s.s_suppkey INNER JOIN nation n ON s.s_nationkey = n.n_nationkey INNER JOIN region r ON n.n_regionkey = r.r_regionkey INNER JOIN part p ON l.l_partkey = p.p_partkey WHERE r.r_name = 'MIDDLE EAST' GROUP BY p.p_type ORDER BY total_sales_volume DESC;
SELECT r.r_name AS region_name, c.c_mktsegment AS market_segment, COUNT(DISTINCT l.l_orderkey) AS order_count, SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_sales, AVG(l.l_discount) AS average_discount FROM lineitem l JOIN customer c ON l.l_orderkey = c.c_custkey JOIN supplier s ON l.l_suppkey = s.s_suppkey JOIN nation n ON c.c_nationkey = n.n_nationkey JOIN region r ON n.n_regionkey = r.r_regionkey GROUP BY r.r_name, c.c_mktsegment ORDER BY total_sales DESC, average_discount ASC;
SELECT n.n_name AS nation, COUNT(DISTINCT c.c_custkey) AS num_customers, AVG(c.c_acctbal) AS avg_account_balance, SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_revenue, COUNT(l.l_orderkey) AS num_orders FROM nation n JOIN customer c ON c.c_nationkey = n.n_nationkey JOIN orders o ON o.o_custkey = c.c_custkey JOIN lineitem l ON l.l_orderkey = o.o_orderkey WHERE n.n_comment LIKE '%efully alongside of the slyly final dependencies.%' AND o.o_shippriority = 0 AND l.l_tax IN (0.02, 0.07, 0.05, 0.01) AND c.c_phone IN ('22-845-781-3450', '20-697-924-2662', '29-363-137-9479', '32-857-129-2892') GROUP BY nation ORDER BY total_revenue DESC;
SELECT r.r_name AS region_name, n.n_name AS nation_name, COUNT(DISTINCT l.l_orderkey) AS total_orders, SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_revenue, AVG(l.l_extendedprice * (1 - l.l_discount)) AS avg_revenue_per_order, SUM(l.l_quantity) AS total_quantity_sold, AVG(p.p_retailprice) AS avg_part_retail_price FROM region r JOIN nation n ON r.r_regionkey = n.n_regionkey JOIN partsupp ps ON ps.ps_suppkey = ANY(ARRAY[60385, 120516]) JOIN part p ON p.p_partkey = ps.ps_partkey JOIN lineitem l ON l.l_partkey = p.p_partkey AND l.l_suppkey = ps.ps_suppkey WHERE p.p_brand = 'Brand#13' AND p.p_mfgr IN ('Manufacturer#2', 'Manufacturer#5', 'Manufacturer#4', 'Manufacturer#1') AND r.r_regionkey IN (1, 4, 0, 2, 3) AND l.l_shipdate BETWEEN '1995-01-01' AND '1995-12-31' GROUP BY region_name, nation_name ORDER BY total_revenue DESC, region_name, nation_name;
SELECT r.r_name AS region, n.n_name AS nation, COUNT(DISTINCT s.s_suppkey) AS number_of_suppliers, COUNT(DISTINCT c.c_custkey) AS number_of_customers, COUNT(DISTINCT p.p_partkey) AS number_of_parts, SUM(l.l_quantity) AS total_quantity_ordered, AVG(l.l_extendedprice * (1 - l.l_discount)) AS avg_order_value, SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_order_value FROM region r JOIN nation n ON r.r_regionkey = n.n_regionkey JOIN supplier s ON n.n_nationkey = s.s_nationkey JOIN partsupp ps ON s.s_suppkey = ps.ps_suppkey JOIN part p ON ps.ps_partkey = p.p_partkey JOIN lineitem l ON p.p_partkey = l.l_partkey AND s.s_suppkey = l.l_suppkey JOIN orders o ON l.l_orderkey = o.o_orderkey JOIN customer c ON o.o_custkey = c.c_custkey AND c.c_nationkey = n.n_nationkey WHERE r.r_name IN ('MIDDLE EAST', 'AFRICA') AND l.l_shipdate BETWEEN '1994-01-01' AND '1994-12-30' AND n.n_name IN ('UNITED KINGDOM', 'CHINA', 'JAPAN', 'IRAN') GROUP BY r.r_name, n.n_name ORDER BY total_order_value DESC, avg_order_value DESC, number_of_suppliers DESC, number_of_customers DESC;
SELECT r.r_name AS region, n.n_name AS nation, COUNT(DISTINCT s.s_suppkey) AS total_suppliers, COUNT(DISTINCT c.c_custkey) AS total_customers, AVG(s.s_acctbal) AS avg_supplier_acctbal, AVG(c.c_acctbal) AS avg_customer_acctbal, SUM(l.l_extendedprice * (1 - l.l_discount)) AS revenue FROM region r JOIN nation n ON r.r_regionkey = n.n_regionkey JOIN supplier s ON n.n_nationkey = s.s_nationkey JOIN customer c ON n.n_nationkey = c.c_nationkey JOIN lineitem l ON s.s_suppkey = l.l_suppkey WHERE r.r_name IN ('MIDDLE EAST', 'EUROPE', 'AMERICA') AND l.l_shipdate BETWEEN '2023-01-01' AND '2023-12-31' GROUP BY r.r_name, n.n_name ORDER BY revenue DESC, region, nation;
SELECT c.c_mktsegment, COUNT(DISTINCT c.c_custkey) AS num_customers, SUM(l.l_quantity) AS total_quantity, AVG(l.l_extendedprice) AS avg_price, SUM(l.l_extendedprice * (1 - l.l_discount)) AS revenue_after_discount, AVG(l.l_discount) AS avg_discount FROM customer c JOIN lineitem l ON c.c_custkey = l.l_suppkey JOIN supplier s ON l.l_suppkey = s.s_suppkey WHERE s.s_comment LIKE '%final%' OR s.s_comment LIKE '%instructions%' OR s.s_comment LIKE '%pinto beans%' AND l.l_shipdate BETWEEN '1995-01-01' AND '1995-12-31' AND c.c_acctbal > 0 GROUP BY c.c_mktsegment ORDER BY revenue_after_discount DESC;
SELECT r.r_name AS region_name, c.c_mktsegment AS market_segment, p.p_brand AS part_brand, COUNT(DISTINCT c.c_custkey) AS num_customers, SUM(p.p_retailprice) AS total_retail_price, AVG(ps.ps_supplycost) AS avg_supply_cost, SUM(ps.ps_availqty) AS total_available_quantity FROM customer c JOIN partsupp ps ON c.c_custkey = ps.ps_suppkey JOIN part p ON ps.ps_partkey = p.p_partkey JOIN region r ON c.c_nationkey = r.r_regionkey WHERE p.p_brand IN ('Brand#34', 'Brand#31', 'Brand#35') AND c.c_mktsegment IN ('HOUSEHOLD', 'AUTOMOBILE', 'BUILDING', 'MACHINERY', 'FURNITURE') GROUP BY r.r_name, c.c_mktsegment, p.p_brand ORDER BY total_retail_price DESC, avg_supply_cost DESC;
SELECT n.n_name AS nation, p.p_size AS part_size, l.l_shipmode AS ship_mode, COUNT(DISTINCT o.o_orderkey) AS num_orders, SUM(l.l_quantity) AS total_quantity, SUM(l.l_extendedprice) AS total_sales, SUM(l.l_extendedprice * (1 - l_discount)) AS total_sales_discounted, AVG(l.l_discount) AS average_discount FROM nation n JOIN partsupp ps ON n.n_nationkey = ps.ps_suppkey JOIN part p ON ps.ps_partkey = p.p_partkey JOIN lineitem l ON p.p_partkey = l.l_partkey AND ps.ps_suppkey = l.l_suppkey JOIN orders o ON l.l_orderkey = o.o_orderkey WHERE n.n_name IN ('RUSSIA', 'CANADA', 'UNITED STATES', 'JORDAN', 'KENYA') AND p.p_type IN ('LARGE POLISHED BRASS', 'STANDARD BURNISHED STEEL', 'STANDARD POLISHED BRASS', 'MEDIUM PLATED NICKEL') AND l.l_shipmode IN ('AIR', 'TRUCK', 'RAIL') GROUP BY nation, part_size, ship_mode ORDER BY total_sales_discounted DESC;
